

Pseudo-Differential Operators 
Theory and Applications 
Vol.  
 
 
 
 
 
 
 
 
Managing Editor 
 
M.W. Wong (York University, Canada) 
 
 
 
Editorial Board 
 
Luigi Rodino (Università di Torino, Italy) 
Bert-Wolfgang Schulze (Universität Potsdam, Germany) 
Johannes Sjöstrand (Université de Bourgogne, Dijon, France) 
Sundaram Thangavelu (Indian Institute of Science at Bangalore, India) 
Maciej Zworski (University of California at Berkeley, USA) 
 
 
 
 
 
 
 
Pseudo-Differential Operators: Theory and Applications is a series of  
moderately priced graduate-level textbooks and monographs appea- 
ling to students and experts alike. Pseudo-differential operators are 
understood in a very broad sense and include such topics as harmonic 
analysis, PDE, geometry, mathematical physics, microlocal analysis, 
time-frequency analysis, imaging and computations. Modern trends 
and novel applications in mathematics, natural sciences, medicine,  
scientific computing, and engineering are highlighted. 
 
 
 
 
 
 
7

    Maurice A. de Gosson
Symplectic Methods
in Harmonic Analysis 
and in Mathematical Physics

 
 
 
 
 
www.birkhauser-science.com
Springer Basel AG is part of Springer Science+Business Media  
Printed on acid-free paper  
2010 Mathematics Subject Classification: 
ISBN 978-3-7643-9991-7 
 e-ISBN 978-3-
-
-4 
DOI 10.1007/978-3-
-
-   
© Springer Basel AG 2011 
the copyright owner must be obtained. 
on microfilms or in other ways, and storage in data banks. For any kind of use whatsoever, permission from
concerned, specifically the rights of translation, reprinting, re-use of illustrations, broadcasting, reproduction 
 This work is subject to copyright. All rights are reserved, whether the whole or part of the material is  
Library of Congress Control Number: 2011934363
35S, 81Q, 81S, 53D, 46B, 37J05, 70H05, 70 15
H
7643 9992
7643 9992 4
Maurice A. de Gosson 
Nordbergstraße 15 
1090 Vienna 
Austria 
maurice.degosson@gmail.com, maurice.de.gosson@univie.ac.at 
Faculty of Mathematics, NuHAG
University of Vienna
Cover design: deblik, Berlin

Contents
Foreword . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
xiii
Preface . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
xv
Description of the book . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
xv
Prologue . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
xxi
Some notation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
xxi
The space S(Rn) and its dual S′(Rn) . . . . . . . . . . . . . . . . . . . . . . . .
xxii
The Fourier transform . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . xxiii
Part I
Symplectic Mechanics
1
Hamiltonian Mechanics in a Nutshell
1.1
Hamilton’s equations . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
3
1.1.1
Deﬁnition of Hamiltonian systems . . . . . . . . . . . . . . . . . .
3
1.1.2
A simple existence and uniqueness result . . . . . . . . . . . . .
4
1.2
Hamiltonian ﬁelds and ﬂows . . . . . . . . . . . . . . . . . . . . . . . . . . .
6
1.2.1
The Hamilton vector ﬁeld . . . . . . . . . . . . . . . . . . . . . . . .
6
1.2.2
The symplectic character of Hamiltonian ﬂows . . . . . . . . .
8
1.2.3
Poisson brackets . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
10
1.3
Additional topics . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
11
1.3.1
Hamilton–Jacobi theory . . . . . . . . . . . . . . . . . . . . . . . . .
11
1.3.2
The invariant volume form . . . . . . . . . . . . . . . . . . . . . . .
13
1.3.3
The problem of “Quantization” . . . . . . . . . . . . . . . . . . . .
16
2
The Symplectic Group
2.1
Symplectic matrices . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
20
2.1.1
Deﬁnition of the symplectic group . . . . . . . . . . . . . . . . . .
20
2.1.2
Symplectic block-matrices . . . . . . . . . . . . . . . . . . . . . . . .
20
2.1.3
The aﬃne symplectic group . . . . . . . . . . . . . . . . . . . . . . .
21
2.2
Symplectic forms . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
22
2.2.1
The notion of symplectic form . . . . . . . . . . . . . . . . . . . . .
22
v

vi
Contents
2.2.2
Diﬀerential formulation . . . . . . . . . . . . . . . . . . . . . . . . . .
23
2.3
The unitary groups U(n, C) and U(2n, R) . . . . . . . . . . . . . . . . . .
25
2.3.1
A useful monomorphism . . . . . . . . . . . . . . . . . . . . . . . . .
25
2.3.2
Symplectic rotations . . . . . . . . . . . . . . . . . . . . . . . . . . . .
25
2.3.3
Diagonalization and polar decomposition . . . . . . . . . . . . .
26
2.4
Symplectic bases and Lagrangian planes . . . . . . . . . . . . . . . . . . .
28
2.4.1
Deﬁnition of a symplectic basis . . . . . . . . . . . . . . . . . . . .
28
2.4.2
The Lagrangian Grassmannian . . . . . . . . . . . . . . . . . . . .
29
3
Free Symplectic Matrices
3.1
Generating functions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
31
3.1.1
Deﬁnition of a free symplectic matrix . . . . . . . . . . . . . . . .
31
3.1.2
The notion of generating function . . . . . . . . . . . . . . . . . .
33
3.1.3
Application to the Hamilton–Jacobi equation . . . . . . . . . .
35
3.2
A factorization result . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
38
3.2.1
Statement and proof . . . . . . . . . . . . . . . . . . . . . . . . . . . .
38
3.2.2
Application: generators of Sp(2n, R) . . . . . . . . . . . . . . . . .
39
4
The Group of Hamiltonian Symplectomorphisms
4.1
The group Symp(2n, R) . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
41
4.1.1
Deﬁnition and examples . . . . . . . . . . . . . . . . . . . . . . . . .
41
4.2
Hamiltonian symplectomorphisms . . . . . . . . . . . . . . . . . . . . . . .
43
4.2.1
Symplectic covariance of Hamiltonian ﬂows . . . . . . . . . . . .
43
4.2.2
The group Ham(2n, R) . . . . . . . . . . . . . . . . . . . . . . . . . .
44
4.3
The symplectic Lie algebra . . . . . . . . . . . . . . . . . . . . . . . . . . . .
47
4.3.1
Matrix characterization of sp(2n, R) . . . . . . . . . . . . . . . . .
48
4.3.2
The exponential mapping . . . . . . . . . . . . . . . . . . . . . . . .
49
5
Symplectic Capacities
5.1
Gromov’s theorem and symplectic capacities . . . . . . . . . . . . . . . .
51
5.1.1
Statement of Gromov’s theorem . . . . . . . . . . . . . . . . . . . .
51
5.1.2
Proof of Gromov’s theorem in the aﬃne case . . . . . . . . . .
52
5.2
The notion of symplectic capacity . . . . . . . . . . . . . . . . . . . . . . .
55
5.2.1
Deﬁnition and existence . . . . . . . . . . . . . . . . . . . . . . . . .
55
5.2.2
The symplectic capacity of an ellipsoid . . . . . . . . . . . . . . .
59
5.3
Other symplectic capacities . . . . . . . . . . . . . . . . . . . . . . . . . . . .
61
5.3.1
The Hofer–Zehnder capacity . . . . . . . . . . . . . . . . . . . . . .
61
5.3.2
The Ekeland–Hofer capacities . . . . . . . . . . . . . . . . . . . . .
62

Contents
vii
6
Uncertainty Principles
6.1
The Robertson–Schr¨odinger inequalities . . . . . . . . . . . . . . . . . . .
66
6.1.1
The covariance matrix . . . . . . . . . . . . . . . . . . . . . . . . . .
66
6.1.2
A strong version of the Robertson–Schr¨odinger
uncertainty principle . . . . . . . . . . . . . . . . . . . . . . . . . . . .
67
6.1.3
Symplectic capacity and the strong
uncertainty principle . . . . . . . . . . . . . . . . . . . . . . . . . . . .
70
6.2
Hardy’s uncertainty principle . . . . . . . . . . . . . . . . . . . . . . . . . .
71
6.2.1
Two useful lemmas . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
72
6.2.2
Proof of the multi-dimensional Hardy
uncertainty principle . . . . . . . . . . . . . . . . . . . . . . . . . . . .
74
6.2.3
Geometric interpretation . . . . . . . . . . . . . . . . . . . . . . . . .
76
Part II
Harmonic Analysis in Symplectic Spaces
7
The Metaplectic Group
7.1
The metaplectic representation . . . . . . . . . . . . . . . . . . . . . . . . .
79
7.1.1
A preliminary remark, and a caveat . . . . . . . . . . . . . . . . .
80
7.1.2
Quadratic Fourier transforms . . . . . . . . . . . . . . . . . . . . . .
80
7.2
The projection πMp . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
84
7.2.1
Precise statement . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
84
7.2.2
Dependence on ℏ. . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
85
7.3
Construction of πMp . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
87
7.3.1
The group Diﬀ(1)(n) . . . . . . . . . . . . . . . . . . . . . . . . . . . .
87
7.3.2
Construction of the projection . . . . . . . . . . . . . . . . . . . . .
89
8
Heisenberg–Weyl and Grossmann–Royer Operators
8.1
Dynamical motivation, and deﬁnition . . . . . . . . . . . . . . . . . . . . .
91
8.1.1
The displacement Hamiltonian . . . . . . . . . . . . . . . . . . . . .
91
8.1.2
The Heisenberg–Weyl operators . . . . . . . . . . . . . . . . . . . .
93
8.1.3
The symplectic covariance property of
the HW operators . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
95
8.2
The Heisenberg group . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
96
8.2.1
The canonical commutation relations . . . . . . . . . . . . . . . .
97
8.2.2
Heisenberg group and Schr¨odinger representation . . . . . . .
98
8.2.3
The Stone–von Neumann theorem . . . . . . . . . . . . . . . . . .
100
8.3
The Grossmann–Royer operators . . . . . . . . . . . . . . . . . . . . . . . .
102
8.3.1
The symplectic Fourier transform . . . . . . . . . . . . . . . . . .
102
8.3.2
Deﬁnition of the Grossmann–Royer operators . . . . . . . . . .
104
8.3.3
Symplectic covariance . . . . . . . . . . . . . . . . . . . . . . . . . . .
106

viii
Contents
8.4
Weyl–Heisenberg frames . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
107
8.4.1
The notion of frame . . . . . . . . . . . . . . . . . . . . . . . . . . . .
108
8.4.2
Weyl–Heisenberg frames . . . . . . . . . . . . . . . . . . . . . . . . .
111
8.4.3
A useful “dictionary” . . . . . . . . . . . . . . . . . . . . . . . . . . .
113
9
Cross-ambiguity and Wigner Functions
9.1
The cross-ambiguity function . . . . . . . . . . . . . . . . . . . . . . . . . . .
117
9.1.1
Deﬁnition of A(ψ, φ) . . . . . . . . . . . . . . . . . . . . . . . . . . . .
117
9.1.2
Elementary properties of the cross-ambiguity function . . . .
119
9.2
The cross-Wigner transform . . . . . . . . . . . . . . . . . . . . . . . . . . .
120
9.2.1
Deﬁnition and ﬁrst properties of W(ψ, φ) . . . . . . . . . . . . .
120
9.2.2
Translations of Wigner transforms . . . . . . . . . . . . . . . . . .
122
9.3
Relations between A(ψ, φ), W(ψ, φ), and the STFT . . . . . . . . . .
123
9.3.1
Two simple formulas . . . . . . . . . . . . . . . . . . . . . . . . . . . .
123
9.3.2
The short-time Fourier transform . . . . . . . . . . . . . . . . . . .
125
9.3.3
The Cohen class . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
126
9.4
The Moyal identity . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
128
9.4.1
Statement and proof . . . . . . . . . . . . . . . . . . . . . . . . . . . .
128
9.4.2
An inversion formula . . . . . . . . . . . . . . . . . . . . . . . . . . . .
130
9.5
Continuity and growth properties . . . . . . . . . . . . . . . . . . . . . . .
132
9.5.1
Continuity of A(ψ, φ) and W(ψ, φ) . . . . . . . . . . . . . . . . . .
132
9.5.2
Decay properties of A(ψ, φ) and W(ψ, φ) . . . . . . . . . . . . .
134
10 The Weyl Correspondence
10.1 The Weyl correspondence . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
137
10.1.1 First deﬁnitions and properties . . . . . . . . . . . . . . . . . . . .
137
10.1.2 Deﬁnition using the Wigner transform . . . . . . . . . . . . . . .
140
10.1.3 Probabilistic interpretation . . . . . . . . . . . . . . . . . . . . . . .
142
10.1.4 The kernel of a Weyl operator . . . . . . . . . . . . . . . . . . . . .
144
10.2 Adjoints and products . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
146
10.2.1 The adjoint of a Weyl operator . . . . . . . . . . . . . . . . . . . .
146
10.2.2 Composition formulas . . . . . . . . . . . . . . . . . . . . . . . . . . .
147
10.3 Symplectic covariance of Weyl operators . . . . . . . . . . . . . . . . . . .
150
10.3.1 Statement and proof of the symplectic
covariance property . . . . . . . . . . . . . . . . . . . . . . . . . . . .
150
10.3.2 Covariance under aﬃne symplectomorphisms . . . . . . . . . .
151
10.4 Weyl operators as pseudo-diﬀerential operators . . . . . . . . . . . . . .
152
10.4.1 The notion of pseudo-diﬀerential operator . . . . . . . . . . . . .
153
10.4.2 The kernel of a Weyl operator revisited . . . . . . . . . . . . . .
155
10.4.3 Justiﬁcation in the case a ∈Sm . . . . . . . . . . . . . . . . . . . .
156

Contents
ix
10.5 Regularity results for Weyl operators . . . . . . . . . . . . . . . . . . . . .
158
10.5.1 Some general results . . . . . . . . . . . . . . . . . . . . . . . . . . . .
158
10.5.2 Symbols in Lq spaces . . . . . . . . . . . . . . . . . . . . . . . . . . .
160
11 Coherent States and Anti-Wick Quantization
11.1 Coherent states . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
163
11.1.1 A physical motivation . . . . . . . . . . . . . . . . . . . . . . . . . . .
163
11.1.2 Properties of coherent states . . . . . . . . . . . . . . . . . . . . . .
164
11.2 Wigner transforms of Gaussians . . . . . . . . . . . . . . . . . . . . . . . . .
169
11.2.1 Some explicit formulas . . . . . . . . . . . . . . . . . . . . . . . . . .
169
11.2.2 The cross-Wigner transform of a pair of Gaussians . . . . . .
171
11.3 Squeezed coherent states . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
172
11.3.1 Deﬁnition and characterization . . . . . . . . . . . . . . . . . . . .
173
11.3.2 Explicit action of Mp(2n, R) on squeezed states . . . . . . . . .
175
11.4 Anti-Wick quantization . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
177
11.4.1 Deﬁnition in terms of coherent states . . . . . . . . . . . . . . . .
178
11.4.2 The Weyl symbol of an anti-Wick operator . . . . . . . . . . . .
180
11.4.3 Some regularity results . . . . . . . . . . . . . . . . . . . . . . . . . .
181
12 Hilbert–Schmidt and Trace Class Operators
12.1 Hilbert–Schmidt operators . . . . . . . . . . . . . . . . . . . . . . . . . . . .
185
12.1.1 Deﬁnition and general properties . . . . . . . . . . . . . . . . . . .
185
12.1.2 Hilbert–Schmidt operators on L2(Rn) . . . . . . . . . . . . . . . .
188
12.2 Trace class operators . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
189
12.2.1 The trace of a positive operator . . . . . . . . . . . . . . . . . . . .
189
12.2.2 General trace class operators . . . . . . . . . . . . . . . . . . . . . .
193
12.3 The trace of a Weyl operator . . . . . . . . . . . . . . . . . . . . . . . . . . .
198
12.3.1 Heuristic discussion . . . . . . . . . . . . . . . . . . . . . . . . . . . .
198
12.3.2 Some rigorous results . . . . . . . . . . . . . . . . . . . . . . . . . . .
200
13 Density Operator and Quantum States
13.1 The density operator . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
205
13.1.1 Pure and mixed quantum states . . . . . . . . . . . . . . . . . . . .
206
13.2 The uncertainty principle revisited . . . . . . . . . . . . . . . . . . . . . . .
210
13.2.1 The strong uncertainty principle for
the density operator . . . . . . . . . . . . . . . . . . . . . . . . . . . .
210
13.2.2 Sub-Gaussian estimates . . . . . . . . . . . . . . . . . . . . . . . . . .
212
13.2.3 Positivity issues and the KLM conditions . . . . . . . . . . . . .
215

x
Contents
Part III
Pseudo-diﬀerential Operators and Function Spaces
14 Shubin’s Global Operator Calculus
14.1 The Shubin classes . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
223
14.1.1 Generalities . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
223
14.1.2 Deﬁnitions and preliminary results . . . . . . . . . . . . . . . . . .
225
14.1.3 Asymptotic expansions of symbols . . . . . . . . . . . . . . . . . .
229
14.2 More general operators . . . which are not more general! . . . . . . . .
230
14.2.1 More general classes of symbols . . . . . . . . . . . . . . . . . . . .
231
14.2.2 A reduction result . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
232
14.3 Relations between kernels and symbols . . . . . . . . . . . . . . . . . . . .
236
14.3.1 A general result . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
236
14.3.2 Application: Wigner and Rihaczek distributions . . . . . . . .
237
14.4 Adjoints and products . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
239
14.4.1 The transpose and adjoint operators . . . . . . . . . . . . . . . .
239
14.4.2 Composition formulas . . . . . . . . . . . . . . . . . . . . . . . . . . .
240
14.5 Proof of Theorem 330 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
243
Part IV
Applications
15 The Schr¨odinger Equation
15.1 The case of quadratic Hamiltonians . . . . . . . . . . . . . . . . . . . . . .
247
15.1.1 Preliminaries . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
248
15.1.2 Quadratic Hamiltonians . . . . . . . . . . . . . . . . . . . . . . . . .
249
15.1.3 Exact solutions of the Schr¨odinger equation . . . . . . . . . . .
252
15.2 The general case . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
254
15.2.1 Symplectic covariance as a characteristic property
of Weyl quantization . . . . . . . . . . . . . . . . . . . . . . . . . . . .
254
15.2.2 Quantum evolution groups and Stone’s theorem . . . . . . . .
256
15.2.3 Application to Schr¨odinger’s equation . . . . . . . . . . . . . . .
256
16 The Feichtinger Algebra
16.1 Deﬁnition and ﬁrst properties . . . . . . . . . . . . . . . . . . . . . . . . . .
261
16.1.1 Deﬁnition of S0(Rn) . . . . . . . . . . . . . . . . . . . . . . . . . . . .
262
16.1.2 First properties of S0(Rn) . . . . . . . . . . . . . . . . . . . . . . . .
263
16.2 Invariance and Banach algebra properties . . . . . . . . . . . . . . . . . .
266
16.2.1 Metaplectic invariance of the Feichtinger algebra . . . . . . . .
266
16.2.2 The algebra property of S0(Rn) . . . . . . . . . . . . . . . . . . . .
268
16.3 A minimality property for S0(Rn) . . . . . . . . . . . . . . . . . . . . . . .
270
16.3.1 Heisenberg–Weyl expansions . . . . . . . . . . . . . . . . . . . . . .
270
16.3.2 The minimality property . . . . . . . . . . . . . . . . . . . . . . . . .
271

Contents
xi
16.4 A Banach Gelfand triple . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
271
16.4.1 The dual space S′
0(Rn) . . . . . . . . . . . . . . . . . . . . . . . . . .
272
16.4.2 The Gelfand triple (S0, L2, S′
0) . . . . . . . . . . . . . . . . . . . .
273
17 The Modulation Spaces M q
s
17.1 The Lq spaces, 1 ≤q < ∞. . . . . . . . . . . . . . . . . . . . . . . . . . . . .
275
17.1.1 Deﬁnitions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
275
17.1.2 Weighted Lq spaces . . . . . . . . . . . . . . . . . . . . . . . . . . . .
278
17.2 The modulation spaces M q
s . . . . . . . . . . . . . . . . . . . . . . . . . . . .
281
17.2.1 Deﬁnition of M q
s . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
282
17.2.2 Metaplectic and Heisenberg–Weyl invariance properties . . .
284
17.3 The modulation spaces M ∞
s
. . . . . . . . . . . . . . . . . . . . . . . . . . .
285
17.3.1 The weighted spaces L∞
s
. . . . . . . . . . . . . . . . . . . . . . . . .
285
17.3.2 The spaces M ∞
s
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
286
17.4 The modulation spaces M ∞,1
s
. . . . . . . . . . . . . . . . . . . . . . . . . .
287
17.4.1 Deﬁnition and ﬁrst properties . . . . . . . . . . . . . . . . . . . . .
288
17.4.2 Weyl operators with symbols in M ∞,1
s
. . . . . . . . . . . . . . .
290
18 Bopp Pseudo-diﬀerential Operators
18.1 Introduction and motivation . . . . . . . . . . . . . . . . . . . . . . . . . . .
292
18.1.1 Bopp pseudo-diﬀerential operators . . . . . . . . . . . . . . . . . .
293
18.1.2 Bopp operators viewed as Weyl operators . . . . . . . . . . . . .
295
18.1.3 Adjoints and a composition formula . . . . . . . . . . . . . . . . .
297
18.1.4 Symplectic covariance of Bopp operators . . . . . . . . . . . . .
298
18.2 Intertwiners . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
299
18.2.1 Windowed wavepacket transforms . . . . . . . . . . . . . . . . . .
299
18.2.2 The intertwining property . . . . . . . . . . . . . . . . . . . . . . . .
302
18.3 Regularity results for Bopp operators . . . . . . . . . . . . . . . . . . . . .
303
18.3.1 Boundedness results . . . . . . . . . . . . . . . . . . . . . . . . . . . .
303
18.3.2 Global hypoellipticity properties . . . . . . . . . . . . . . . . . . .
304
19 Applications of Bopp Quantization
19.1 Spectral results for Bopp operators . . . . . . . . . . . . . . . . . . . . . .
307
19.1.1 A fundamental property of the intertwiners . . . . . . . . . . .
307
19.1.2 Generalized eigenvalues and eigenvectors
of a Bopp operator . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
309
19.1.3 Application: the Landau problem . . . . . . . . . . . . . . . . . . .
312
19.2 Bopp calculus and deformation quantization . . . . . . . . . . . . . . . .
314
19.2.1 Deformation quantization: motivation . . . . . . . . . . . . . . .
315
19.2.2 The Moyal product and bracket . . . . . . . . . . . . . . . . . . . .
316

xii
Contents
19.3 Non-commutative quantum mechanics . . . . . . . . . . . . . . . . . . . .
318
19.3.1 Background . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
318
19.3.2 The operators Tω(z0) and Fω . . . . . . . . . . . . . . . . . . . . . .
320
Bibliography . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
325
Index . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
335

Foreword
This book is partially based on a series of lectures I gave during the fall term 2009
at the NuHAG Institute at the University of Vienna. It therefore has a structure
reminiscent of a “Lecture Notes” monograph. This means, among other things,
that I have felt free to often repeat or recall some material, or deﬁnition, that has
been given in a previous chapter – exactly as when one is confronted by a class,
where it is appropriate to give a brief review of what has been said during last
week’s lecture. I hope that this will make the reading of this book easier and more
enjoyable to a majority of students and colleagues.
To those of the readers, certainly numerous, who will ﬁnd that this book is
too long for what it is, and have already closed it, I say “good bye!”. For the few
who would have liked to read more about all or some topics I develop, and who
deplore that I haven’t expanded them more, I can only quote the great Austrian
physicist Walter Thirring (I owe this citation to Karlheinz Gr¨ochenig):
. . . There are three things that are easy to start but very diﬃcult to
ﬁnish. The ﬁrst is a war. The second is a love aﬀair. The third is a trill.
To this may be added a fourth: a book.
Maurice A. de Gosson
This work is dedicated with all my love to Charlyne,
for her invaluable support and help.
xiii


Preface
Harmonic analysis is one of the most active and fastest growing parts of both pure
and applied mathematics. It has gone far beyond its primary goal, which was to
study the representation of functions or signals as superpositions of trigonometric
functions (Fourier series). The interest in harmonic analysis has always been great
because of the wealth of its applications, and it plays nowadays a central role in
the study of signal theory and time-frequency analysis. Its interest in pure math-
ematics (especially in functional analysis) has been revived by the introduction of
new functional spaces which are tools of choice for studying regularity properties
of pseudo-diﬀerential operators and their applications to mathematical physics.
Methods from symplectic geometry add power and scope to modern harmonic
analysis; historically these methods were perhaps for the ﬁrst time systematically
used in Folland’s seminal book [59].
The aim of the present book is to give a rigorous and modern treatment of
various objects from harmonic analysis with a strong emphasis on the underlying
symplectic structure (for instance symplectic and metaplectic covariance proper-
ties). More speciﬁcally we have in mind two audiences: the time-frequency commu-
nity, and mathematical physicists interested in applications to quantum mechanics.
The concepts and methods are presented in such a way that they should be eas-
ily accessible to students at the upper-undergraduate level (a certain familiarity
with basic Fourier analysis and the elementary theory of distributions is assumed).
Needless to say, this book can also be read with proﬁt by more advanced readers,
and can be used as a reference work by researchers in partial diﬀerential equations,
harmonic analysis, and mathematical physics. (Several chapters are part of ongo-
ing research and contain material that is usually not addressed in introductory
texts. For instance Gromov’s non-squeezing theorem from symplectic topology
and its applications, or the theory of phase space pseudodiﬀerential operators.)
Description of the book
This book is divided into parts and chapters, each devoted to a particular topic.
They have been designed in such a way that the material of each chapter can be
covered in a 90 minutes lecture (but this, of course, very much depends on the
student’s background). The parts can be read independently.
xv

xvi
Preface
Part I: Symplectic Mechanics
• Chapter 1 is intended to be a review of the main concepts from Hamilto-
nian mechanics; while it can be skipped by the reader wanting to advance
rapidly in the mathematics of harmonic analysis on symplectic spaces, it
is recommended as a reference for a better understanding of the reasons
for which many concepts are introduced. For instance, the Hamiltonian ap-
proach leads to a very natural and “obvious” motivation for consideration
of the Heisenberg–Weyl operators, and of the Weyl pseudo-diﬀerential cal-
culus. Also, deformation quantization does not really make sense unless one
understands the mechanical reasons which lie behind it. The main result of
this ﬁrst chapter is that Hamiltonian ﬂows consist of symplectomorphisms
(the physicist’s canonical transformations). This is proven in detail using an
elementary method, that of the “variational equation” (which is a misnomer,
because there is per se nothing variational in that equation!). We also dis-
cuss other topics, such as Poisson brackets (which is helpful to understand
the ﬁrst steps of deformation quantization; Hamilton–Jacobi theory is also
brieﬂy discussed).
• In Chapter 2 the basics of the theory of the symplectic group are developed
in a self-contained way. Only an elementary knowledge of linear algebra is re-
quired for understanding of the topics of this chapter; the few parts where we
invoke more sophisticated material such as diﬀerential forms can be skipped
by the beginner. A particular emphasis is put on the machinery of free sym-
plectic matrices and their generating functions, which are usually ignored
in ﬁrst courses. The consideration of this topic simpliﬁes many calculations,
and has the advantage of yielding the easiest approach to the theory of the
metaplectic group. We also discuss classical topics, such as the identiﬁcation
of the unitary group with a subgroup of the symplectic group.
• In Chapter 3 we reﬁne our study of the symplectic group by introducing the
notion of free symplectic matrix and its generating functions. Free symplectic
matrices can be deﬁned in several diﬀerent ways. Their importance comes
from the fact that they are in a sense the building blocks of the symplectic
group: every symplectic matrix is the product (in inﬁnitely many ways) of
exactly two free symplectic matrices. This property in turn allows an easy
construction of simple sets of generators for the symplectic group. Last – but
certainly not least! – the notion of free symplectic matrix will be instrumental
for our deﬁnition in Chapter 7 of the metaplectic representation.
• In Chapter 4 we discuss the notion of symplectomorphism, which is a gen-
eralization to the non-linear case of the symplectic transformations intro-
duced in the previous chapters. This leads us to deﬁne two very interest-
ing groups Symp(2n, R) and Ham(2n, R), respectively the group of all sym-
plectomorphisms, and that of all Hamiltonian symplectomorphisms. These
groups, which are of great interest in current research in symplectic topology,
are non-linear generalizations of the symplectic group Sp(2n, R). The group

Preface
xvii
Ham(2n, R) will play an important role in our derivation of Schr¨odinger’s
equation for arbitrary Hamiltonian functions.
• In Chapter 5 we introduce new and very powerful tools from symplectic
geometry and topology: Gromov’s symplectic non-squeezing theorem, and the
associated notion of symplectic capacity. The importance of these concepts
(which go back to the mid 1980s, and for which Gromov got the Abel Prize in
2009) in applications has probably not yet been fully realized in mathematical
analysis, and even less in mathematical physics.
• In Chapter 6 we address a topic which belongs to both classical and quantum
mechanics, namely uncertainties principles, and we do this from a topological
point of view. We begin by discussing uncertainty principles associated with
a quasi-probability distribution from a quite general point of view (hence
applicable both to the classical and quantum cases), and introduce the asso-
ciated notion of covariance matrix. This enables us to reformulate the strong
version of the uncertainty principle in terms of symplectic capacities. This
approach to both classical and quantum uncertainties is new and due to the
author. It seems to be promising because it allows us to analyze uncertain-
ties which are more general than those usually considered in the literature,
and has led to the deﬁnition of “quantum blobs”, which are symplectically
invariant subsets of phase space with minimum symplectic capacity one-half
of Planck’s constant h. We also prove a multi-dimensional Hardy uncertainty
principle, which says that a function and its Fourier transform cannot be
simultaneously dominated by too sharply peaked Gaussians.
Part II: Harmonic Analysis in Symplectic Spaces
• Chapter 7 is devoted to a detailed study of the metaplectic group Mp(2n, R)
as a unitary representation in L2(Rn) of the two-fold covering of the sym-
plectic group Sp(2n, R). The properties of Sp(2n, R), as exposed in Chapters
2 and 3, allow us to identify the generators of the metaplectic group as
“quadratic Fourier transforms”, generalizing the usual Fourier transforms.
We construct with great care the projection (covering) mapping from the
metaplectic group to the symplectic group, having in mind our future appli-
cations to the Wigner transform and the Schr¨odinger equation. In the forth-
coming chapters we will use systematically the properties of the metaplectic
group, in particular when establishing symplectic/metaplectic covariance for-
mulas in Weyl calculus and the theory of the Wigner transform.
• In Chapter 8 we study two companions, the Heisenberg–Weyl and Gross-
mann–Royer operators. These operators can in a sense be viewed as “quan-
tized” versions of, respectively, translation and reﬂection operators and are
symplectic Fourier transforms of each other. We also discuss the related no-
tion of Heisenberg group and algebra which play such an important role in
harmonic analysis in phase space; our approach starts with the canonical
commutation relations of quantum mechanics. We also deﬁne and brieﬂy dis-

xviii
Preface
cuss the aﬃne variant of the metaplectic group, namely the inhomogeneous
metaplectic group AMp(2n, R) which is an extension by the Heisenberg–Weyl
operators of the metaplectic group Mp(2n, R).
• In Chapter 9 we study in great detail various algebraic and functional prop-
erties of the cross-ambiguity and cross-Wigner functions, which are concisely
deﬁned using the Heisenberg–Weyl and Grossmann–Royer operators intro-
duced in the previous chapter. We discuss the relations with the short-time
Fourier transform used in signal and time-frequency analysis. We also prove
a useful inversion formula for the cross-Wigner transform; this formula plays
an important role in the theory of Feichtinger’s modulation spaces which will
be studied later in this book.
Part III: Pseudo-diﬀerential Operators and Function Spaces
• In Chapter 10 we present the basics of Weyl calculus, in particular the deﬁni-
tion of the Weyl correspondence which plays such an important role both in
the theory of pseudodiﬀerential operators and in modern quantum mechanics
of which it is one of the pillars. The chapter begins with an introductory sec-
tion where the need for “quantization” is brieﬂy discussed. We prove various
formulas (in particular formulas for the adjoint of a Weyl operator, and that
for the twisted symbol of the composition of two operators).
• In Chapter 11 we take a close look at the notion of coherent states (they are
elementary Gaussian functions); the properties of the metaplectic group al-
low us to give very explicit formulas for their natural extension, the squeezed
coherent states, which play a pivotal role both in harmonic analysis and in
quantum mechanics (especially in the subdiscipline known as quantum op-
tics). This leads us naturally to the consideration of anti-Wick operators (also
called Toeplitz or Berezin operators), of which we give the main properties.
• In Chapter 12 we review two venerable topics from functional analysis: the
theory of Hilbert–Schmidt and the associated theory of trace class operators.
This will allow us to give a precise meaning to the notion of mixed quantum
state in Chapter 13. We discuss in some detail the delicate procedure of cal-
culating the trace. In particular we state and prove a result making legitimate
the integration of the kernel when the operator is a Weyl pseudodiﬀerential
operator.
• In Chapter 13
we give a rigorous deﬁnition of the notion of mixed quan-
tum state, and of the associated density operators (called density matri-
ces in quantum mechanics). The relation between density operators and the
Wigner transform is made clear and fully exploited. We discuss the very
delicate notion of positivity for the density operator. This is done by in-
troducing the Kastler–Loupias–Miracle-Sole conditions, which we relate to
the uncertainty principle. We also apply Hardy’s uncertainty principle in its
multi-dimensional form to the characterization of sub-Gaussian mixed states;
the results are stated concisely using the notion of symplectic capacity.

Preface
xix
• Chapter 14 is of a rather technical nature. We introduce Shubin’s global sym-
bol classes, and the associated pseudo-diﬀerential operators. Shubin classes
are of a greater use in quantum-mechanics than the ordinary H¨ormander
classes because their deﬁnition takes into account global properties of poly-
nomial decrease in phase space. We discuss the notion of asymptotic expan-
sion of the symbols, and show that operators which are at ﬁrst sight much
more general can be reduced to the case of ordinary pseudo-diﬀerential oper-
ators. We also study the notion of τ-symbol of a pseudo-diﬀerential, and give
formulas allowing one to switch between diﬀerent values of the parameter τ.
Part IV: Applications
• In Chapter 15 we study a great classic of quantum mechanics, in fact one
of its pillars: Schr¨odinger’s time-dependent equation. We begin by showing
that this equation can be derived from the theory of the metaplectic group
when associated to a quadratic Hamiltonian function. In the second part of
the chapter we generalize our construction to arbitrary Hamiltonian func-
tions by using Stone’s theorem on strongly continuous one-parameter groups
of unitary operators together with the characteristic property of symplectic
covariance of Weyl pseudo-diﬀerential calculus.
• Chapters 16 and 17 are an introduction to Feichtinger’s theory of modula-
tion spaces. The elements ψ of these spaces are functions (or distributions) on
Rn characterized by the property that the cross-Wigner transform W(ψ, φ)
belongs to some weighted Banach space of integrable functions on R2n for
every “window” φ. The simplest example is provided by the Feichtinger al-
gebra M 1(Rn) which is the smallest Banach algebra containing the Schwartz
functions and being invariant under the action of the inhomogeneous group
(Chapter 16). Since Feichtinger’s algebra is a Banach algebra it can be used
with proﬁt as a substitute for the Schwartz space; it allows in particular,
together with its dual, to deﬁne a Gelfand triple. Modulation spaces play a
crucial role in time-frequency analysis and in the theory of pseudodiﬀerential
operators. Their importance in quantum mechanics has only been recently
realized, and is being very actively investigated.
• Chapter 18 is an introduction to a new topic, which we have called Bopp
calculus. Bopp operators are pseudodiﬀerential operators of a certain type
acting on phase space functions or distributions. They are associated in a
natural way to the usual Weyl operators by “Bopp quantization rules”, x −→
x + 1
2iℏ∂p, p −→p −1
2iℏ∂x. These rules are often used heuristically by
physicists working in the area of deformation quantization; this chapter gives
a rigorous justiﬁcation of these manipulations. We note that the theory of
Bopp operators certainly has many applications in pure mathematics and
physics (Schr¨odinger equation in phase space).
• In Chapter 19 we give a few applications of Bopp calculus. We begin by
studying spectral properties of Bopp operators, which we relate to those of

xx
Preface
the corresponding standard Weyl operators. As an example we derive the en-
ergy levels and eigenfunctions of the magnetic operator (also called Landau
operator). We thereafter show that Bopp pseudodiﬀerential operators allow
one to express deformation quantization in terms of a pseudodiﬀerential the-
ory; this has of course many technical and conceptual advantages since it
allows us to easily prove deep results on “stargenvalues” and “stargenvec-
tors”. The book ends on a beginning: the application of Bopp operators to
an emerging subﬁeld of mathematics called “noncommutative quantum me-
chanics” (NCQM), which has its origins in the quest for quantum gravity.
Acknowledgement
This work has been ﬁnanced by the Austrian Research Agency FWF (Projektnum-
mer P20442-N13). I wish to express my thanks to Hans Feichtinger and Karlheinz
Gr¨ochenig for their help and support, and correcting my misunderstandings about
modulation spaces. I am solely responsible for remaining errors. I also thank Franz
Luef for many stimulating conversations about modulation spaces and related
topics from time-frequency analysis; some parts of this book are based on joint
work with him. Last – but not least! – many thanks to you, Charlyne, for having
typed with competence and patience a great part of the manuscript and having
given me the loving environment I needed to write this book.

Prologue
In this preliminary chapter we introduce some notation and recall basic facts from
linear algebra and vector calculus.
Some notation
Let K = R or C.
• M(m, K) is the algebra of all m × m matrices with entries in K.
• GL(m, K) is the general linear group. It consists of all invertible matrices in
M(m, K).
• SL(m, K) is the special linear group: it is the subgroup of GL(m, K) consisting
of all matrices with determinant equal to 1.
• Sym(m, K) is the vector space of all symmetric matrices in M(m, K); it has
dimension 1
2m(m + 1); Sym+(2n, R) is the subset of Sym(m, K) consisting of
the positive deﬁnite symmetric matrices.
The elements of Rm should be viewed as column vectors
x =



x1
...
xn



when displayed; for typographic simplicity we will usually write x = (x1, . . . , xn)
in the text. The Euclidean scalar product ⟨·, ·⟩and norm | · | on Rm are deﬁned by
x · y = xT y =
m

j=1
xjyj.
The gradient operator in the variables x1, . . . , xn will be denoted by
∂x or



∂x1
...
∂xm


.
xxi

xxii
Prologue
Let f and g be diﬀerentiable functions Rm −→Rm; in matrix form the chain
rule is
∂x(g ◦f)(x) = (Df(x))T ∂xf(x)
(1)
where Df(x) is the Jacobian matrix of f: if f = (f1, . . . , fm) is a diﬀerentiable
mapping Rm −→Rm then
Df =






∂f1
∂x1
∂f1
∂x2
· · ·
∂f1
∂xm
∂f2
∂x1
∂f2
∂x2
· · ·
∂f2
∂xm
...
...
...
...
∂fm
∂x1
∂fn
∂x2
· · ·
∂fm
∂xm






.
(2)
Let y = f(x); we will indiﬀerently use the notation Df(x) for the Jacobian matrix
at x. If f is invertible, the inverse function theorem says that
D(f −1)(y) = [Df(x)]−1.
(3)
If f : Rm −→R is a twice continuously diﬀerentiable function, its Hessian
calculated at a point x is the symmetric matrix of second derivatives
D2f(x) =







∂2f
∂x2
1
∂2f
∂x1∂x2
· · ·
∂2f
∂x1∂xn
∂2f
∂x2∂x1
∂2f
∂x2
2
· · ·
∂2f
∂x2∂xn
...
...
...
...
∂2f
∂xn∂x1
∂2f
∂xn∂x2
· · ·
∂2f
∂x2n







.
(4)
Notice that the Jacobian and Hessian matrices are related by the formula
Dx(∂xf)(x) = D2
xf(x).
(5)
Also note the following useful formulae:
⟨A∂x, ∂x⟩e−1
2 ⟨Mx,x⟩= [⟨MAMx, x⟩−Tr(AM)] e−1
2 ⟨Mx,x⟩,
(6)
⟨Bx, ∂x⟩e−1
2 ⟨Mx,x⟩= ⟨MBx, x⟩e−1
2 ⟨Mx,x⟩,
(7)
where A, B, and M are symmetric matrices.
The space S(Rn) and its dual S′(Rn)
Very useful classes of functions and distributions are the so-called Schwartz space
S(Rn) and its dual S′(Rn), which is the space of tempered distributions. In our
context they are better adapted than the space C∞
o (Rn) of inﬁnitely diﬀeren-
tiable functions with compact support (the latter is not invariant under Fourier
transform).

Prologue
xxiii
Deﬁnition 1. The space S(Rn) consists of all inﬁnitely diﬀerentiable functions
f : Rn −→C such that for every pair (α, β) of multi-indices there exists a constant
Cαβ ≥0 such that
|xα∂β
xf(x)| ≤Cαβ for x ∈Rn.
This condition is equivalent to the existence of C′
αβ ≥0 such that
|∂β
x(xαf)(x)| ≤C′
αβ for x ∈Rn.
The proof of the equivalence of the two conditions above is left to the reader;
it readily follows – after some tedious calculations – from Leibniz’s rule for the
derivatives of a product.
Clearly C∞
0 (Rn) ⊂S(Rn); the archetypical example of a function which
belongs to S(Rn) but not to C∞
0 (Rn) is the Gaussian f(x) = e−|x|2; more generally
the product of a Gaussian by a polynomial is in S(Rn). Note that S(Rn) actually
is an algebra: the product of two elements of S(Rn) is also in S(Rn) (this readily
follows from the chain rule). The formulae
∥f∥(1)
αβ = sup
x∈Rn |xα∂β
xf(x)|,
∥f∥(2)
αβ = sup
x∈Rn |∂β
x(xαf)(x)|
deﬁne equivalent families of semi-norms on S(Rn); one shows that S(Rn) becomes
a Fr´echet space for the topology thus deﬁned.
The Fourier transform
Let f : Rn −→C be an absolutely integrable function
∥f∥L1 =
	
Rn |f(x)|dx < ∞;
we will write for short f ∈L1(Rn). By deﬁnition the Fourier transform Ff = 
f is
the function deﬁned by

f(ξ) =
 1
2π
n/2 	
Rn e−iξ·xf(x)dx.
We will use in this book the following variant of the Fourier transform F:
Fψ(x) =

1
2πℏ
n/2 	
Rn e−ix·x′ψ(x′)dx′;
here ℏis a positive parameter, which one identiﬁes in physics with Planck’s con-
stant divided by 2π: ℏ= h/2π (the notation is due to the physicist Dirac). One
proves (Riemann–Lebesgue lemma) that lim|ξ|→∞
f(ξ) = 0.

xxiv
Prologue
One of the main properties of the Schwartz space (and of it dual) is that it
is invariant by the Fourier transform:
F : S(Rn) −→S(Rn),
F : S′(Rn) −→S′(Rn).
This is in strong contrast with the case of C∞
o (Rn): the only compactly supported
function (or distribution, for that matter) whose Fourier transform is also com-
pactly supported is 0 (this is easily seen if one knows that the Fourier transform
of a compactly supported function is analytic, and can thus never have compact
support).
Proposition 2. The Fourier transforms F : f −→
f
and f −→Ff are invertible
automorphisms of S(Rn) which extends by duality into automorphisms of S′(Rn)
deﬁned by
⟨
f, g⟩= ⟨f, 
g⟩, ⟨Ff, g⟩= ⟨f, Fg⟩
for f ∈S′(Rn), g ∈S(Rn). The restriction of these automorphism to L2(Rn) are
unitary.
Proof. Let f ∈S(Rn); for α, β ∈Nn we have
ξα∂β
ξ 
f = (−i)|α|+|β| 
∂α
x xβf;
since ∂α
x xβf ∈S(Rn) there exists a constant Cαβ > 0 such that |ξα∂β
ξ 
f(ξ)| ≤Cαβ,
hence 
f ∈S(Rn). That the Fourier transform is an invertible automorphism of
S(Rn) follows from the Fourier inversion formula. The two last statements easily
follow from Plancherel’s formula
	
Rn f(x)
g(x)dx =
	
Rn

f(x)g(x)dx
and their proof is therefore left to the reader.
□

Part I
Symplectic Mechanics

Chapter 1
Hamiltonian Mechanics in a Nutshell
This chapter is an introduction to the basics of Hamiltonian mechanics, with an
emphasis on its symplectic formulation. It thus motivates the symplectic tech-
niques which will be developed in the forthcoming chapters. In fact, Hamiltonian
mechanics is historically the main motivation for the study of the symplectic group
in particular, and of symplectic geometry in general. For complements and an ex-
tended study the reader can consult with proﬁt the treatises by Abraham–Marsden
[2] and Arnol’d [3]; an elementary introduction at the undergraduate level is the
classical book by Goldstein [63] and its re-editions. (This book is written for physi-
cists, however, and the mathematics is not always rigorous.)
Historically, Hamiltonian mechanics goes back to the early work of Hamilton
and Lagrange; its symplectic formulation (as exposed in this chapter) is relatively
recent; see Arnol’d [3] and Abraham et al. [1] for detailed accounts.
1.1
Hamilton’s equations
We will use the notation x = (x1, . . . , xn), p = (p1, . . . , pn) for elements of Rn and
z = (x, p) for elements of R2n (the “phase space”). When using matrix notation,
x, p, z will always be viewed as column vectors.
1.1.1
Deﬁnition of Hamiltonian systems
Let H (“the Hamiltonian”) be a real-valued function in C∞(R2n); more generally
we will consider “time-dependent Hamiltonians” H ∈C∞(R2n × R), functions of
z and t.
Deﬁnition 3. The system of 2n ordinary diﬀerential equations
dxj
dt = ∂H
∂pj
(x, p, t),
dpj
dt = −∂H
∂xj
(x, p, t)
(1.1)
is called the Hamilton equations associated with H.
3
M.A. de Gosson, Symplectic Methods in Harmonic Analysis and in Mathematical Physics,  
Pseudo-Differential Operators 7, DOI 10.1007/978-3-7643-9992-4_ , © Springer Basel AG 2011 
1

4
Chapter 1. Hamiltonian Mechanics in a Nutshell
To simplify the discussion we will assume that for every z0 = (x0, p0) belong-
ing to an open subset Ωof R2n, this system has a unique solution t −→z(t) =
(x(t), p(t)) such that z(0) = z0, deﬁned for −T ≤t ≤T where T > 0. (See
Abraham–Marsden [2], Ch. 1, §2.1, for a general discussion of global existence and
uniqueness, including the important notion of “ﬂow box”.)
A basic example is the following; we state it in the case n = 1:
H(x, p) = p2
2m + U(x)
(1.2)
where m is a positive constant (“the mass”) and U a smooth function (“the po-
tential”). In this case Hamilton’s equations are
dx
dt = p
m , dp
dt = −U ′(x).
(1.3)
In physics one writes v = p/m (it is the velocity) and dp/dt, so that these equations
are just a restatement of Newton’s second law, familiar from elementary physics;
the quantity p2/2m is the “kinetic energy”. (We have discussed in some detail the
physical interpretation of Hamilton’s equations in [65].)
This example motivates the following deﬁnition:
Deﬁnition 4. Let t −→z(t) be a solution of Hamilton’s equations. The number
E(t) = H(z(t)) is called the energy along the solution curve through z0 = z(0)
at time t. When H is time-independent, we have H(z(t)) = H(z(0)) for every t.
More generally, any function which is constant along the curves t −→z(t) is called
a “constant of the motion”.
That the energy E is a constant for time-independent Hamiltonians follows
from the chain rule applied to H(z(t)), taking Hamilton’s equations into consid-
eration: setting z = z(t) we have
d
dtH(z(t)) =
n

j=1
∂H
∂xj
(z)dxj
dt + ∂H
∂pj
(z)dpj
dt = 0.
In the case of time-dependent Hamiltonians the same argument shows that
d
dtH(z(t), t) = ∂H
∂t (z(t), t)
hence the energy E(t) = H(z(t), t) is not a constant of the motion.
1.1.2
A simple existence and uniqueness result
Here is an existence result which is suﬃcient for many applications to physics. We
assume that the Hamiltonian is time-independent and of the type
H(x, p) =
n
j=1
p2
j
2mj
+ U(x)
where U ∈C∞(Rn).

1.1.
Hamilton’s equations
5
Proposition 5. If U ≥a for some constant a, then every solution of Hamilton’s
equations
dxj
dt = pj
mj
,
dpj
dt = −∂U
∂xj
(x)
(1 ≤j ≤n) exists for all times (and is unique).
Proof. In view of the local existence theory for ordinary diﬀerential equations it
suﬃces to show that the solutions t −→z(t) remain in bounded sets for ﬁnite times.
Since Hamilton’s equations are insensitive to the addition of a constant to the
Hamiltonian we may assume a = 0, and rescaling if necessary the momentum and
position coordinates it is no restriction neither to assume mj = 1 for 1 ≤j ≤n. For
notational simplicity we moreover assume n = 1. Let thus t →z(t) = (x(t), p(t))
be a solution curve of the equations
dx
dt = p
,
dp
dt = −∂U
∂x (x)
and let E = H(z(t)) be the energy; since H ≥U we have E ≥U(x(t)). In view of
the triangle inequality
|x(t)| ≤|x(0)| + |x(t) −x(0)| ≤|x(0)| +
	 t
0
 d
dtx(s)
 ds;
since
d
dtx(s) = p(s) and
p(t) =

2(E −U(x(t)) ≤
√
2E
(1.4)
we have:
|x(t)| ≤|x(0)| +
	 t
0
|p(s)| ds ≤|x(0)| +
	 t
0

2(E −U(x(s))ds
so that
|x(t)| ≤|x(0)| + t
√
2E.
(1.5)
The inequalities (1.4) and (1.5) show that for t in any ﬁnite time-interval [0, T ]
the functions t −→x(t) and t −→p(t) = x(t), and hence t −→z(t), stay forever
in a bounded set.
□
One can show (see [1], §4.1) that the conclusions of Proposition 5 still hold
if one replaces the boundedness condition U ≥a by the much weaker requirement
U(x) ≥a −b|x|2 for b > 0
where a and b are some constants (b > 0). This condition cannot be very much
relaxed; for instance one shows (ibid.) that already in the case n = 1 the solutions
of the Hamilton equations for
H(x, p) = p2
2m −ε2
8 x2+(4/ε)
are not deﬁned for all t if ε > 0.

6
Chapter 1. Hamiltonian Mechanics in a Nutshell
1.2
Hamiltonian ﬁelds and ﬂows
From now on we will use the following more compact notation, borrowed from
mechanics: time derivatives (i.e., derivatives with respect to t) will be denoted
by putting a dot over the letter standing for the function. For instance, ˙x means
dx/dt. Derivatives will in general be written as ∂x, ∂xj, etc. instead of ∂/∂x, ∂/∂xj.
We will also freely use the notation ∂x for the gradient (∂x1, . . . , ∂xn). Similarly,
∂z = (∂x, ∂p) is the gradient in the 2n variables z1 = x1, . . . , zn = xn; zn+1 =
p1, . . . , z2n = pn.
The Hamilton equations (1.1) can be rewritten in compact form as
˙z = J∂zH(z)
(1.6)
where J is the “standard symplectic matrix” deﬁned by
J =

0
I
−I
0

where 0 and I are the n × n zero and identity matrices. That matrix will play an
essential role in all of this book.
1.2.1
The Hamilton vector ﬁeld
Assume ﬁrst that H is a time-independent Hamiltonian function.
Deﬁnition 6. We call the vector ﬁeld
XH = J∂zH = (∂xH, −∂pH)
the “Hamilton vector ﬁeld of H”; the operator J∂z is called a “symplectic gradi-
ent”.
It follows from the elementary theory of ordinary autonomous diﬀerential
equations that the system (1.1) deﬁnes a ﬂow (φH
t ): by deﬁnition the function
t −→z(t) = φH
t (z0) is the solution of Hamilton’s equations with z(0) = z0 and we
have
φH
t φH
t′ = φH
t+t′ , φH
0 = I
(1.7)
when t, t′ and t + t′ are in the interval [−T, T ]. In particular each φH
t
is a diﬀeo-
morphism such that (φH
t )−1 = φH
−t.
Deﬁnition 7. One says that (φH
t ) is the ﬂow generated by the Hamilton equations
for H.
The Hamilton vector ﬁeld is gradient-free:
div XH = ∂x (∂pH) −∂p (∂xH) = 0

1.2.
Hamiltonian ﬁelds and ﬂows
7
hence the ﬂow (φH
t ) is incompressible. This result is called “Liouville’s theorem”
in the physics literature. Incompressibility means that for every subset U of Ωand
t ∈[−T, T ] such that φH
t (U) ⊂Ωwe have
Vol φH
t (U) = Vol U.
Hamiltonian ﬂows are thus volume-preserving. This property also follows from the
fact that Hamiltonian ﬂows consist of symplectomorphisms, as we will see in a
moment, for we then have
(φH
t )∗Vol = Vol
where Vol is the volume form (2.11).
When H is a time-dependent function, Hamilton’s equations become a non-
autonomous system of diﬀerential equations which we can write concisely as
˙z = J∂zH(z, t).
(1.8)
One again writes XH = ∂zH, but XH is not, strictly speaking, a vector ﬁeld in the
usual sense (because it depends on the parameter t). The “ﬂow” (φH
t ) generated
by time-dependent Hamiltonian no longer has the group property: φH
t φH
t′ ̸= φH
t+t′.
It is often useful to replace the notion of ﬂow as deﬁned above by that of time-
dependent ﬂow (φH
t,t′): φH
t,t′ is the function deﬁned by the condition that t −→
z(t, t′) = φH
t,t′(z0) is the solution of Hamilton’s equations with z(t′) = z0. Obviously
φH
t,t′ = φH
t,0

φH
t′,0
−1
hence the group property (1.7) has then to be replaced by
φH
t,t′φH
t′,t′ = φH
t,t′′ , φH
t,t = I
(1.9)
for all admissible t, t′, and t′′. Notice that it follows in particular that (φH
t,t′)−1 =
φH
t′,t.
It is however always possible to reduce the study of a time-dependent Hamil-
tonian to the time-independent case. The price to pay is that we have to work in
a phase space with dimension 2n + 2 instead of 2n. We deﬁne a new Hamiltonian
function H by the formula
H(x, p, t, E) = H(x, p, t) −E
(1.10)
where E is a new variable, viewed as conjugate to the time t which now has the
status of a “position variable”; we could as well write the deﬁnition of H in the
form
H(x, p, xn+1, pn+1) = H(x, p, xn+1) −pn+1
but we will however stick to the notation (1.10). The function H is deﬁned on the
extended phase space R2n+2 ≡R2n ×RE ×Rt. The associated Hamilton equations

8
Chapter 1. Hamiltonian Mechanics in a Nutshell
are, expressed in terms of the original Hamiltonian H:
dx
dt′ = ∂pH ,
dp
dt′ = −∂xH,
dE
dt′ = ∂H
∂t
,
∂t
∂t′ = 1,
where the parameter t′ plays the role of a new “time”; since H does not explicitly
contain that parameter, it is a “time-independent” Hamiltonian on the extended
phase space. Notice that in view of the fourth equation above we may choose
t′ = t so that the two ﬁrst equations are just the Hamiltonian equations for H; as
a bonus the third equation is just the familiar law for the variation of energy of a
time-dependent Hamiltonian system:
dE
dt = d
dtH(x, p, t) = ∂
∂tH(x, p, t)
(the second equality because of the chain rule and using the fact that x and
p satisfy Hamilton’s equations). We can now deﬁne the “extended Hamiltonian
ﬂow” (φH
t ) of H by the formula φH
t
= φ 
H
t . Notice that since (φ 
H
t ) is the ﬂow
determined by a time-independent Hamiltonian, (φH
t ) enjoys the one-parameter
group property φH
t φH
t′ = φH
t+t′ and φH
0 = I (the identity operator on the extended
phase space R2n+2). Denote now by (φH
t,t′) the two-parameter family of canonical
transformations of R2n deﬁned as follows: for ﬁxed t′ the function z = φH
t,t′(z′) is
the solution of Hamilton’s equations for H taking the value z′ at time t′. Thus:
φH
t,t′ = φH
t

φH
t′
−1 .
(1.11)
Clearly φH
t,t is the identity operator on R2n and φH
t,t′φH
t′,t′′ = φH
t,t′′, (φH
t,t′)−1 = φH
t′,t.
The two-parameter family (φH
t,t′) is sometimes called the “time-dependent ﬂow”;
it is related to the extended ﬂow deﬁned above by the simple formula
φH
t (z′, t′, E′) = (φH
t,t′(z′), t + t′, Et,t′)
(1.12)
with
Et,t′ = E′ + H(φH
t,t′(z′), t) −H(z′, t′).
(1.13)
We refer to the paper [154] by Struckmeier for a discussion of some subtleties
and diﬃculties related to the method just outlined. See Sardanashvily [139] for an
up-to-date discussion of time-dependent Hamiltonian mechanics from the point of
view of diﬀerential geometry.
1.2.2
The symplectic character of Hamiltonian ﬂows
Recall that J (the “standard symplectic matrix”) is deﬁned by
J =

0
I
−I
0


1.2.
Hamiltonian ﬁelds and ﬂows
9
where 0 and I are the n × n zero and identity matrices. Note that det J = 1 and
J2 = I , JT = J−1 = −J
(the superscript T denotes transposition).
Deﬁnition 8. A real 2n × 2n matrix is said to be symplectic if it satisﬁes the
conditions
ST JS = SJST = J.
(1.14)
The set of all symplectic matrices is denoted by Sp(2n, R).
A symplectic matrix is invertible because det(ST JS) = det J implies
det(S)2 = 1 since det J = 1. (We will actually see later that we must have det S = 1
when S is a symplectic matrix; this property is in fact not quite obvious.) We will
see in the next chapter that Sp(2n, R) is a group, in fact one of the classical Lie
groups.
The main property of Hamiltonian ﬂows – or, at least the one that distin-
guishes them from general ﬂows – is that they consist of symplectomorphisms (also
called “canonical transformations”, especially in the physical literature). There
are several ways to prove this; our approach makes use of the so-called variational
equation satisﬁed by the Jacobian matrices of a Hamiltonian ﬂow. We prove the
result for time-independent Hamiltonians; the extension to the time-dependent
case is straightforward (see Exercise 10 below).
Theorem 9. Let (φH
t ) be a Hamiltonian ﬂow deﬁned on Ω⊂R2n.
(i) The Jacobian matrix St(z) = DφH
t (z) satisﬁes the “variational equation”
d
dtSt(z) = JD2H(φH
t (z))St(z) , St(z) = I.
(1.15)
(ii) The Jacobian matrix DφH
t (z) is symplectic for every z ∈Ω:
[DφH
t (z)]T JDφH
t (z) = DφH
t (z)J[DφH
t (z)]T = J.
Proof. (i) Taking Hamilton’s equation into account the time-derivative of the Ja-
cobian matrix St(z) is
d
dtSt(z) = d
dt(DφH
t (z)) = D
 d
dtφH
t (z)

,
that is
d
dtSt(z) = D(XH(φH
t (z))).
Using the fact that XH = J∂zH together with the chain rule, we have
D(XH(φH
t (z))) = D(J∂zH)(φH
t (z))
= JD(∂zH)(φH
t (z))
= J(D2H)(φH
t (z))DφH
t (z),

10
Chapter 1. Hamiltonian Mechanics in a Nutshell
hence St(z) satisﬁes the variational equation (1.15). Statement (ii) follows from
(i): set St = St(z) and At = (St(z))T JSt(z); using the product rule together with
(1.15) we have
dAt
dt = d(St)T
dt
JSt + (St)T J dSt
dt
= (St)T D2H(z)St −(St)T D2H(z)St
= 0.
It follows that the matrix ST
t JSt is constant in t, hence, in particular, ST
t JSt =
ST
0 JS0 = J (because S0 is the identity) so that St ∈Sp(2n, R) for all t ∈R.
□
The following exercise is easy, but the result is useful: it shows that even for
time-depending Hamiltonians the ﬂow consists of symplectomorphisms.
Exercise 10. Reformulate (and prove) the conclusions of Theorem 9 in the case of
a time-dependent ﬂow determined by a time-dependent Hamiltonian.
1.2.3
Poisson brackets
There is another way of writing Hamilton’s equations; it makes use of the notion
of Poisson bracket. Let us introduce the following notation: for any pair of vectors
(z, z′) in R2n we set
σ(z, z′) = (z′)T Jz = Jz · z′.
The scalar σ(z, z′) is called the symplectic product of z and z′; σ is the standard
symplectic form on R2n. Observe that σ is a bilinear form on R2n which is antisym-
metric: σ(z, z′) = −σ(z′, z). It satisﬁes in addition the following non-degeneracy
condition: we can have σ(z, z′) = 0 for all z′ if and only if z = 0 (this because J
is invertible).
Deﬁnition 11. Let (f, g) ∈C∞(R2n) × C∞(R2n). The Poisson bracket of f and g
is the function
{f, g} =
n

j=1
∂xjf∂pjg −∂xjg∂pjf = ∂xf · ∂pg −∂xg · ∂pf.
It is immediate to verify that Hamilton’s equations can be rewritten, using
Poisson brackets, as
˙xj = {xj, H} ,
˙pj = {pj, H}.
The following properties of the Poisson brackets are proven by straightforward
calculations:
• Anticommutativity:
{f, g} = −{g, f};

1.3.
Additional topics
11
• Linearity:
{f, g + h} = {f, g} + {f, h},
{f + g, h} = {f, h} + {g, h},
{λf, g} = {f, λg} = λ{f, g};
• Leibniz’s law
{f, gh} = {f, g}h + g{f, h};
• Jacobi identity:
{f, {g, h}} + {h, {f, g}} + {g, {h, f}} = 0.
The relation between the symplectic product and Poisson brackets is instruc-
tive; it comes from the following property:
Proposition 12. Let XH and XK be the Hamilton ﬁelds of H and K. The Poisson
bracket of H and K is given by
{H, K} = −σ(XH, XK).
(1.16)
Proof. It is obvious since XH = (∂pH, −∂xH), XK = (∂pK, −∂xK) so that
σ(XH, XK) = −∂xH · ∂pK + ∂xK · ∂pH = −{f, g}.
□
Poisson brackets are useful in various circumstances; they are historically
at the origin of quantization deformation (and of prequantization, which is an
unphysical mathematical theory; see Wallach [158] for an introduction to this
topic).
1.3
Additional topics
1.3.1
Hamilton–Jacobi theory
Here is one method that can be used (at least theoretically) to integrate Hamilton’s
equations; historically it is one of the ﬁrst known resolution schemes. A complete
rigorous treatment is to be found in, for instance, Abraham et al. [1].
Given an arbitrary Hamiltonian function H the associated Hamilton–Jacobi
equation is the (usually non-linear) partial diﬀerential equation with unknown Φ:
∂Φ
∂t + H(x, ∂xΦ, t) = 0.
(1.17)
The interest of this equation comes from the fact that the knowledge of a suﬃ-
ciently general solution Φ yields the solutions of Hamilton’s equations for H. At
ﬁrst sight it may seem strange that one replaces a system of ordinary diﬀerential
equations by a non-linear partial diﬀerential equation, but this procedure is often
the only available method!

12
Chapter 1. Hamiltonian Mechanics in a Nutshell
Proposition 13. Let Φ = Φ(x, t, α) be a solution of
∂Φ
∂t + H(x, ∂xΦ, t) = 0
(1.18)
depending on n non-additive constants of integration α1, . . . , αn, and such that
det D2
x,αΦ(x, t, α) ̸= 0.
(1.19)
Let β1, . . . , βn be constants; the functions t −→x(t) and t −→p(t) determined by
the implicit equations
∂αΦ(x, t, α) = β , p = ∂xΦ(x, t, α)
(1.20)
are solutions of Hamilton’s equations for H.
Proof. We assume n = 1 for notational simplicity; the proof extends to the general
case without diﬃculty. Condition (1.19) implies, in view of the implicit function
theorem, that the equation ∂αΦ(x, t, α) = β has a unique solution x(t) for each t;
this deﬁnes a function t −→x(t). Inserting x(t) in the formula p = ∂xΦ(x, t, α) we
also get a function t −→p(t) = ∂xΦ(x(t), t, α). Let us show that t −→(x(t), p(t))
is a solution of Hamilton’s equations for H. Diﬀerentiating the equation (1.18)
with respect to α yields, using the chain rule,
∂2Φ
∂α∂t + ∂H
∂p
∂2Φ
∂α∂x = 0;
(1.21)
diﬀerentiating the ﬁrst equation (1.20) with respect to t yields
∂2Φ
∂x∂αx + ∂2Φ
∂t∂α = 0;
(1.22)
subtracting (1.22) from (1.21) we get
∂2Φ
∂x∂α
∂H
∂p −˙x

= 0,
hence we have proven that ˙x = ∂pH since ∂2Φ/∂x∂α is assumed to be non-singular.
To show that ˙p = −∂xH we diﬀerentiate (1.18) with respect to x:
∂2Φ
∂x∂t + ∂H
∂x + ∂H
∂p
∂2Φ
∂x2 = 0
(1.23)
and p = ∂xΦ with respect to t:
˙p = ∂2Φ
∂t∂x + ∂2Φ
∂x2 ˙x.
(1.24)
Inserting the value of ∂2Φ/∂x∂t given by (1.24) in (1.23) yields
∂H
∂x + ∂2Φ
∂x2 ˙x −∂H
∂p
∂2Φ
∂x2 + ˙p = 0
hence ˙p = −∂xH since ˙x = ∂pH.
□

1.3.
Additional topics
13
When the Hamiltonian is time-independent, the Hamilton–Jacobi equation
is separable: inserting Φ = Φ0 −Et in (1.18) we get the ‘reduced Hamilton–Jacobi
equation’:
H(x, ∂xΦ0, t) = E
(1.25)
which is often easier to solve in practice; the energy E can be taken as a constant
of integration.
Exercise 14.
(i) Let H =
1
2mp2 be the Hamiltonian of a particle with mass m moving freely
along the x-axis. Use (1.25) to ﬁnd a complete family of solutions of the
time-dependent Hamilton–Jacobi equation for H.
(ii) Do the same with the harmonic oscillator Hamiltonian H =
1
2m(p2+m2ω2x2).
1.3.2
The invariant volume form
In what follows H denotes a time-independent Hamiltonian function on R2n and
E a real number.
Deﬁnition 15. When non-empty the level set ΣE = {z ∈R2n : H(z) = E} is called
the energy shell for H corresponding to the energy level E. An energy shell is said
to be regular if the gradient ﬁeld ∂zH of the Hamiltonian is orthogonal to ΣE at
every point and moreover never vanishes on ΣE.
When ΣE is a regular energy shell, the formula
N(z) = ∂zH(z)
|∂zH(z)|
thus deﬁnes a unit normal ﬁeld N to the energy shell ΣE. We claim that the
(2n −1)-form dV 2n−1 deﬁned by
dV 2n−1
E
(X1, . . . , X2n−1) = dV 2n(N, X1, . . . , X2n−1)
(1.26)
(X1, . . . , X2n−1 tangent vector ﬁelds to ΣE) is a volume form on ΣE;
dV 2n = 1
n!σ ∧· · · ∧σ
(n factors) is the ‘Liouville volume form’ on R2n. This can be rewritten as:
dV 2n = dp1 ∧· · · ∧dpn ∧dx1 ∧· · · ∧dxn.
All we have to do is to check that dV 2n−1
E
(z) ̸= 0 for each z. Choose linearly
independent tangent vectors X1, . . . , X2n−1 to ΣE; since N(z) is orthogonal to
each Xj(z), the 2n vectors N(z), X1(z), . . . , X2n−1(z) are linearly independent.
Since Vol2n is a volume form on R2n we must thus have
Vol2n(N(z), X1(z), . . . , X2n−1(z)) ̸= 0
at every z, which proves our claim.

14
Chapter 1. Hamiltonian Mechanics in a Nutshell
In the notation and terminology of intrinsic diﬀerential geometry the volume
form just constructed is the restriction to ΣE of interior products of the Liouville
form Vol2n by the vector ﬁeld N; it is thus the contraction (or interior product)
of Vol2n with N:
dV 2n−1
E
= i∂zH/|∂zH| Vol2n
ΣE .
Here is an elementary example. Let H = 1
2(p2+x2) be the harmonic oscillator
Hamiltonian function. The energy shells are the circles S1(
√
2E). Formula (1.26)
yields
dV 1
E(z)(X, P) = −

x
2E
X
p
2E
P
 = 1
2E (pX −xP)
hence dV 1
E = (pdx −xdp)/2E.
A drawback with the standard volume element dV 2n−1
E
is the following: while
the Liouville form Vol2n is invariant under Hamiltonian ﬂows (more generally,
under the action of any symplectomorphism), this is not the case of dV 2n−1
E
.
We can however remedy this inconvenience by deﬁning a volume element on ΣE
related in a simple way to dV 2n−1
E
and which will be invariant under the ﬂow (φH
t )
determined by any Hamiltonian deﬁning that energy shell. One shows that
Proposition 16. Let ΣE be a regular energy shell for the Hamiltonian H.
(i) The formula
σ2n−1
E
=
1
|∂zH|dV 2n−1
E
(1.27)
deﬁnes a volume form on ΣE such that
Vol2n = dH ∧σ2n−1
E
.
(1.28)
(ii) For every subset M of ΣE we have
	
Mt
σ2n−1
E
=
	
M
σ2n−1
E
(1.29)
where Mt = φH
t (M) is the image of M by the Hamiltonian ﬂow (φH
t ).
Problem 17. (Requires a good knowledge of intrinsic diﬀerential calculus.) Show
that the form σ2n−1
E
is the only volume form ν2n−1
E
on ΣE such that Vol2n =
dH ∧ν2n−1
E
; deduce from this the invariance property (1.29) of σ2n−1
E
. [Hint: use
the fact that both Vol2n and dH are invariant under the Hamiltonian ﬂow (φH
t ).]
The invariant volume form deﬁnes a measure µE of sets on the energy shell.
If U ⊂ΣE, then
µE(U) =
	
U
σ2n−1
E
≡
	
U
dV 2n−1
E
|∂zH|
(1.30)
when deﬁned.

1.3.
Additional topics
15
We are next going to prove a very interesting property relating measure of
the energy shell to the volume of its interior. That result is sometimes called
the Cavalieri principle. We begin by making the following remark: let H be a
Hamiltonian and ΣE a regular and compact energy shell. We claim that there
exists ε0 > 0 and a family of diﬀeomorphisms (ϕε)−ε0≤ε≤ε0 of phase space such
that ϕ0 is the identity, and
z ∈ΣE =⇒H(ϕ∆E(z)) = E + ∆E.
(1.31)
Since ΣE is a regular energy shell, the gradient ∂zH does not vanish on ΣE; by
continuity we thus have ∂zH(z) ̸= 0 in a whole neighborhood U of ΣE. Since ΣE
is compact, we actually conclude the existence of c > 0 such that |∂zH(z)| ≥c in
that neighborhood. Set now X = ∂zH(z)/|∂zH(z)|2. This vector ﬁeld is deﬁned
on U; let (ϕε)−ε0≤ε≤ε0 be its ﬂow. Let z ∈ΣE; by the chain rule
d
dεH(ϕε(z)) = ∂zH(ϕε(z))dϕε
ds (z) = ∂zH(ϕε(z)) ∂zH(ϕε(z))
|∂zH(ϕε(z))|2
which is equal to 1, hence (1.31) since H(ϕ0(z)) = H(z) = E.
Proposition 18. Let ΣE be a regular and compact energy shell and V (E)=Vol(ME)
the volume of the set bounded by ΣE. We have
∂V (E)
∂E
=
	
ΣE
dV 2n−1
E
|∂zH|
= σ2n−1
E
(ΣE).
(1.32)
Proof. For a point z ∈ΣE let z + ∆z be the intersection of the normal through
z with ΣE+∆E; the length of the line segment [z, z + ∆z] is |∆z|. The diﬀerence
∆V = V (E + ∆E) −V (E) is the volume of the phase space region bounded by
ΣE and ΣE+∆E; we have
d(∆V ) = |∆z|dV 2n−1
E
.
(1.33)
With the notation introduced above, ∆z = ϕ∆E(z) −z, hence
∆z = ∆E
dϕε
dε (z)

ε=0
+ O((∆E)2)
= ∆E ∂zH(z)
|∂zH(z)|2 + O((∆E)2)
so that we can rewrite (1.33) as
d(∆V ) = ∆E

1
|∂zH(z)| + O((∆E)2)

dV 2n−1
E
hence, integrating over ΣE and dividing by ∆E:
∆V
∆E =
	
ΣE

1
|∂zH(z)| + O(∆E)

dV 2n−1
E
which yields (1.32) letting ∆E →0.
□

16
Chapter 1. Hamiltonian Mechanics in a Nutshell
1.3.3
The problem of “Quantization”
Quantum mechanics has its historical origins in the work of Bohr, Born, Heisen-
berg, Jordan, Pauli, von Neumann, Schr¨odinger, Weyl and Wigner in the mid
1920s. Its thrust is that physical phenomena are not continuous phenomena, but
instead take place in very small but discrete increments – that is, quanta. Besides
its great intrinsic interest as one of the pillars of modern Science, quantum mechan-
ics has triggered interest in new mathematical concepts, one of the most important
being the Weyl (also called the Weyl–Wigner–Moyal) formalism. In this chapter
we study the basic deﬁnitions and properties of Weyl calculus from a modern
point of view, where the notions of Heisenberg–Weyl operator and cross-Wigner
transform play an essential role.
Already in the early years (1925–1926) of Quantum Mechanics physicists
where confronted with the problem of ordering, which consisted of ﬁnding an un-
ambiguous procedure for associating to a “classical observable” (in mathematics,
we would speak about a real symbol) a self-adjoint operator. The oldest quan-
tization procedure was actually suggested by Schr¨odinger who associated to the
Hamiltonian function
H(x, p) = p2
2m + U(x)
the partial diﬀerential operator

H = −ℏ2
2m
∂2
∂x2 + U(x)
in the case n = 1. Schr¨odinger’s empirical prescription thus consisted in the formal
substitution p −→−iℏ∂/∂x in the Hamiltonian function. So far, so good. But,
asked physicists, what should one then do when confronted with more complicated
cases? For instance, what should the operator corresponding to
H(x, p) =
1
2m(p + x)2 + U(x)
then be? The “obvious” guess,

H = −ℏ2
2m(−iℏ∂x + x)2 + U(x),
is not obvious at all, because if we expand the square in the function H we have
inﬁnitely many possible choices for quantizing the product 2px, because there are
inﬁnitely many ways to write that function. For instance, we can write
2px = τpx + (1 −τ)xp = 2xp
for every number τ. Physicists decided to make a King Solomon’s Choice: they
decided that the “right” choice was α = 1/2. This corresponds to the “canonical
quantization rules”
x −→
X , p −→
P
, px −→1
2( 
X 
P + 
P 
X)
(1.34)

1.3.
Additional topics
17
where 
X is the operator of multiplication by x and 
P = −iℏ∂/∂x (this prescription
is actually the one corresponding to the ﬁrst “obvious” guess above).
It turns out that the canonical quantization rules above are particularly in-
teresting because they lead to a symplectically covariant theory. It is actually no
more than a particular case of the Weyl quantization procedure. It is sometimes
objected that the choice of Weyl quantization is in a sense ad hoc. One could as
well deﬁne “τ-quantization” which corresponds to the more general choice
x −→
x , p −→
p , px −→τ
x
p + (1 −τ)
p
x
(1.35)
which is mathematically interesting by itself. However, there is one reason to pre-
fer this choice, and to think it is the right choice, thus conﬁrming Weyl’s insight.
It turns out that Weyl quantization not only leads to a symplectically covariant
quantization procedure (and pseudodiﬀerential operator calculus), but in addition
it is the only possible choice if one insists on symplectic covariance (this funda-
mental fact will be proven later in this book).
Here is an exercise:
Problem 19. Consider the polynomial
(t1x1 + · · · + tnxn + τ1Dx1 + · · · + τnDn1)N
in the variables t, τ ∈Rn with operator coeﬃcients (xj is viewed as the multipli-
cation operator by xj) and write it in the form

|α+β|=N
N!
α!β!tατ βAαβ.
Then Aαβ is the operator with the Weyl symbol xαξβ.
We will actually study the notion of τ-quantization in some detail in Chapter
14 using Shubin’s theory of global pseudo-diﬀerential operators.
There is another way to see things. Quantization can be viewed as a “defor-
mation” of Hamiltonian mechanics (a little bit in the same way as special relativity
is seen as a deformation of Galilean relativity). Deformation quantization is one
of the themes of the last part of this book.

Chapter 2
The Symplectic Group
This chapter is a review of the most basic concepts of the theory of the symplectic
group, and of related concepts, such as symplectomorphisms or the machinery of
generating functions.
We may well be witnessing the advent of a “symplectic revolution” in funda-
mental Science. In fact, since the late sixties there has been a burst of applications
of symplectic techniques to mathematics and physics, and even to engineering or
medical sciences (magnetic resonance imaging is a typical example). It seems on
the other hand that it may be possible to recast a great deal of mathematics
in symplectic terms: there is indeed a process of “symplectization of Science” as
pointed out by Gotay and Isenberg [80].
Symplectic geometry diﬀers profoundly from more traditional geometries
(such as Euclidean geometry, or its reﬁnement Riemannian geometry) because
it appears somewhat counter-intuitive to the uninitiated. In symplectic geometry
all vectors are “orthogonal” to themselves because the ‘scalar product’ is anti-
symmetric. As a consequence, the notion of length in a symplectic space does
not make sense; but instead the notion of area does. For instance, in the plane
R2, the standard symplectic form is (up to the sign) the determinant function: if
z = (x, p), z′ = (x′, p′) are two vectors in R2, then det(z, z′) = xp′ −x′p represents
the oriented area of the parallelogram built on the vectors z, z′. In higher dimen-
sions the situation is similar: the symplectic product of two vectors is the sum of
the algebraic areas of the parallelograms built on the projections of these vectors
on the conjugate planes. Symplectic geometry is thus an ‘areal’ type of geometry;
this quality is actually reﬂected in recent, deep, theorems which express the fact
that this ‘two-dimensionality’ has quite dramatic consequences for the behavior of
Hamiltonian ﬂows, which are much more rigid than was thought before the mid-
1980s, when Gromov [87] proved very deep results in symplectic topology. Gromov
was eventually awarded (2009) the Abel prize (the equivalent of the Nobel prize
for mathematics) for his discoveries.
19
M.A. de Gosson, Symplectic Methods in Harmonic Analysis and in Mathematical Physics,  
Pseudo-Differential Operators 7, DOI 10.1007/978-3-7643-9992-4_ , © Springer Basel AG 2011 
2

20
Chapter 2. The Symplectic Group
2.1
Symplectic matrices
Recall that the “standard symplectic matrix” is J =
 0
I
−I
0

where 0 and I
are the n × n zero and identity matrices. we have det J = 1 and J2 = I,
JT = J−1 = −J.
2.1.1
Deﬁnition of the symplectic group
Deﬁnition 20. The set of all symplectic matrices is denoted by Sp(2n, R). Thus
S ∈Sp(2n, R) if and only if
ST JS = SJST = J.
(2.1)
If S is symplectic then S−1 is also symplectic because
(S−1)T JS−1 = −(SJS−1)T = J
since JT = J−1 = −J. The product of two symplectic matrices being obviously
symplectic as well, symplectic matrices thus form a group; that group is denoted
by Sp(2n, R) and is called the (real) symplectic group. The conditions (2.1) are
actually redundant. In fact:
S ∈Sp(2n, R) ⇐⇒ST JS = J ⇐⇒SJST = J
(2.2)
as you are asked to prove in Exercise 21 below:
Exercise 21. Show that S ∈Sp(2n, R) if and only ST ∈Sp(2n, R). [Hint: use the
fact that (S−1)T JS−1 = J].
The eigenvalues of a symplectic matrix are of a particular type:
Problem 22. (i) Show that the eigenvalues of a symplectic matrix occur in quadru-
ples (λ, λ−1, ¯λ, ¯λ−1). [Hint: show that the characteristic polynomial P of a sym-
plectic matrix is reﬂexive: P(λ) = λ2nP(λ−1).] (ii) Show that the determinant of
a symplectic matrix is equal to 1. (iii) Show that the eigenvalues of a symplectic
matrix S and those of its inverse S−1 are the same.
2.1.2
Symplectic block-matrices
It is often useful for practical purposes to use block-matrix notation and to write
S =
A
B
C
D

(2.3)
where the entries A, B, C, D are n × n matrices. Recalling that
J =

0
I
−I
0


2.1.
Symplectic matrices
21
one veriﬁes by an explicit calculation, using the identities ST JS = J = SJST ,
that this matrix is symplectic if and only the two following sets of equivalent
conditions are satisﬁed:
AT C, BT D are symmetric, and AT D −CT B = I,
(2.4)
ABT , CDT
are symmetric, and ADT −BCT = I.
(2.5)
Using the second set of conditions it follows that the inverse of a symplectic matrix
S written in the form (2.3) is
S−1 =

DT
−BT
−CT
AT

.
(2.6)
Notice that in the case n = 1 the formula above reduces to the familiar
S−1 =

d
−b
−c
a

which is true for every 2 × 2 matrix S =

a
b
c
d

such that det(ad −bc) = 1.
Exercise 23. Verify in detail the formulas (2.4), (2.5), (2.6) above.
Exercise 24. Show, using the conditions (2.4), (2.5) that S is symplectic if and
only if ST is.
Exercise 25. Show that if S =
A
B
C
D

is symplectic, then AAT + BBT is in-
vertible. [Hint: calculate (A + iB)(BT + iAT) and use the fact that ABT = BAT .]
2.1.3
The aﬃne symplectic group
An interesting extension of Sp(2n, R) consists of the aﬃne symplectic automor-
phisms. We denote by T(2n, R) the group of phase space translations: T (z0) ∈
T(2n, R) is the mapping z −→z + z0. Clearly T(2n, R) is isomorphic to Rn ⊕Rn
equipped with addition.
Deﬁnition 26. The aﬃne (or inhomogeneous) symplectic group is the semi-direct
product
ASp(2n, R) = Sp(2n, R) ⋉T(2n, R).
Formally, the group law of the semi-direct product ASp(2n, R) is given by
(S, z)(S′, z′) = (SS′, z + Sz′);
this is conveniently written in matrix form as

S
z
01×2n
1
 
S′
z′
01×2n
1

=

SS′
Sz′ + z
01×2n
1

.
(2.7)

22
Chapter 2. The Symplectic Group
One immediately checks that ASp(2n, R) is identiﬁed with the set of all
aﬃne transformations F of Rn ⊕Rn such that F can be factorized as a product
F = ST (z) for some S ∈Sp(2n, R) and z ∈Rn ⊕Rn. Since translations are
symplectomorphisms in their own right, it follows that ASp(2n, R) is the group of
all aﬃne symplectomorphisms of the symplectic space (Rn ⊕Rn, σ). We note the
following useful relations:
ST (z) = T (Sz)S,
T (z)S = ST (S−1z).
2.2
Symplectic forms
We have deﬁned the symplectic group in terms of matrices. It turns out that
Sp(2n, R) can be deﬁned intrinsically in terms of a general algebraic notion, that
of symplectic form:
2.2.1
The notion of symplectic form
We begin with a general deﬁnition:
Deﬁnition 27. A bilinear form on Rn ⊕Rn (or, more generally, on any even-
dimensional real vector space) is called a “symplectic form” if it is antisymmetric
and non-degenerate. The special antisymmetric bilinear form σ on Rn ⊕Rn de-
ﬁned by
σ(z, z′) = p · x′ −p′ · x
(2.8)
for z = (x, p), z′ = (x′, p′) is symplectic; it is called the “standard symplectic form
on Rn ⊕Rn”.
The antisymmetry condition means that we have
σ(z, z′) = −σ(z′, z)
for all z, z′ in R2n. Notice that the antisymmetry implies in particular that all
vectors z are isotropic, that is:
σ(z, z) = 0.
The non-degeneracy condition means that the condition σ(z, z′) = 0 for all z ∈R2n
is equivalent to z = 0.
Deﬁnition (2.8) of the standard symplectic form can be rewritten in a con-
venient way using the symplectic standard matrix
J =
 0
I
−I
0

where 0 and I are the n × n zero and identity matrices. In fact
σ(z, z′) = Jz · z′ = (z′)T Jz.
(2.9)

2.2.
Symplectic forms
23
Exercise 28. Show that the standard symplectic form is indeed non-degenerate.
Let s be a linear mapping Rn ⊕Rn −→Rn ⊕Rn. The condition σ(sz, sz′) =
σ(z, z′) is equivalent to ST JS = J where S is the matrix of s in the canonical
basis of Rn ⊕Rn that is, to S ∈Sp(2n, R). We can thus redeﬁne the symplectic
group by saying that it is the group of all linear automorphisms of Rn ⊕Rn which
preserve the standard symplectic form σ.
There are other more “exotic” symplectic forms which originate from physical
problems (for instance from quantum gravity); here is one example that will be
studied further when we discuss non-commutative quantum mechanics at this end
of this book: set
Ω=
ℏ−1Θ
I
−I
ℏ−1N

where Θ and N are n × n real antisymmetric matrices, and I the n × n identity.
One usually requires that Θ and N depend on ℏand that Θ = O(ℏ2), N = O(ℏ2).
From this viewpoint Ωcan be viewed as perturbation of J: we have Ω= J +O(ℏ2).
One shows that if ℏis small enough then Ωis invertible. Since Ωis antisymmetric
the formula
ω(z, z′) = z · Ω−1z′ = (ΩT )−1z · z′
deﬁnes a new symplectic form on Rn ⊕Rn (see Dias and Prata [31]). Note that ω
coincides with the standard symplectic form σ when Θ = N = 0.
2.2.2
Diﬀerential formulation
There is another, slightly more abstract, way to deﬁne the standard symplectic
form which has advantages if one has Hamiltonian mechanics on manifolds in mind.
It consists in observing that we can view σ as an exterior two-form on Rn ⊕Rn,
in fact:
σ = dp ∧dx =
n

j=1
dpj ∧dxj
(2.10)
where dpj ∧dxj is the wedge product of the coordinate one-forms dpj and dxj.
This formula is a straightforward consequence of the relation
dpj ∧dxj(x, p; x′, p′) = pjx′
j −p′
jxj.
With this identiﬁcation the standard symplectic form is related to the Lebesgue
volume form Vol on Rn ⊕Rn by the formula
Vol = (−1)n(n−1)/2 1
n!σ ∧σ ∧· · · ∧σ



n factors
.
(2.11)
Using this approach one can express very concisely that a diﬀeomorphism f
of Rn ⊕Rn is a symplectomorphism:
f ∈Symp(2n, R) ⇐⇒f ∗σ = σ

24
Chapter 2. The Symplectic Group
where f ∗σ is the pull-back of the two-form σ by the diﬀeomorphism f:
f ∗σ(z0)(z, z′) = σ(f(z0))Df(z0)z, Df(z0)z′).
(Df(z0) the Jacobian matrix at z0.)
In particular one immediately sees that a symplectomorphism is volume-
preserving since we then also have f ∗Vol = Vol in view of (2.11).
The language of diﬀerential form allows an elegant (and concise) reformula-
tion of the previous deﬁnitions. For instance, part (i) of Theorem (9) can thus be
re-expressed as
(φH
t )∗σ = σ.
It tuns out that Hamilton’s equations can be rewritten in a very neat and
concise way using the notion of contraction of a diﬀerential form. They are in fact
equivalent to the concise relation
ιXHσ + dzH = 0
(2.12)
between the contraction of the symplectic form with the Hamilton ﬁeld and the
diﬀerential of the Hamiltonian; this is easily veriﬁed by writing this formula “in
coordinates”, in which case it becomes
σ(XH(z, t), ·) + dzH = 0.
(2.13)
Formula(2.12) is usually taken as the starting point of Hamiltonian mechanics on
symplectic manifolds, which is a topic of great current interest.
It is quite easy to reconstruct a Hamiltonian function from its Hamilton
vector ﬁeld; in fact:
H(z, t) = H(0, t) −
	 1
0
σ(XH(sz), z)ds.
(2.14)
This formula is an immediate consequence of the observation that we have, for
ﬁxed t,
H(z, t) −H(0, t) =
	 1
0
d
dsH(sz, t)ds
=
	 1
0
∂zH(sz, t) · zds
= −
	 1
0
σ(XH(sz), z)ds.
Notice that formula (2.14) deﬁnes H up to the addition of a smooth function of t.

2.3.
The unitary groups U(n, C) and U(2n, R)
25
2.3
The unitary groups U(n, C) and U(2n, R)
Let U(n, C) denote the complex unitary group: u ∈U(n, C) if and only if u ∈
M(n, C) (the algebra of complex matrices of dimension n) and u∗u = uu∗= I
(the conditions u∗u = I and uu∗= I are actually equivalent).
2.3.1
A useful monomorphism
Writing the elements Z ∈M(n, C) in the form Z = A + iB where A and B are
real matrices we deﬁne a mapping
ι : M(n, C) −→M(2n, R)
by the formula:
ι(A + iB) =

A
−B
B
B

.
(2.15)
Lemma 29. The mapping ι is an algebra monomorphism: ι is injective and ι(Z +
Z′) = ι(Z) + ι(Z′), ι(λZ) = λι(Z) for λ ∈C, and ι(ZZ′) = ι(Z)ι(Z′).
Proof. It is easy to verify that ι is an algebra homomorphism (we leave the di-
rect calculations to the reader); that ι is injective immediately follows from its
deﬁnition.
□
We will see below that ι is an isomorphism of the unitary group onto a certain
subgroup of the symplectic group.
2.3.2
Symplectic rotations
Let us prove the main result of this section; it identiﬁes U(n, C) with a subgroup
of Sp(2n, R):
Proposition 30. The restriction of the mapping
ι : M(n, C) −→M(2n, R)
(2.16)
deﬁned above is an isomorphism of U(n, C) onto a subgroup U(2n, R) of Sp(2n, R).
Proof. It follows from conditions (2.4), (2.5) for the entries of a symplectic matrix
that the block matrix
U =

A
−B
B
A

(2.17)
is in U(2n, R) if and only if
ABT = BT A, AAT + BBT = I,
(2.18)
or, equivalently
AT B = BAT , AT A + BT B = I.
(2.19)

26
Chapter 2. The Symplectic Group
The equivalence of conditions (2.18) and (2.19) is proved by noting that U ∈
U(2n, R) if and only if U T ∈U(2n, R) which follows from the fact that the
monomorphism (2.16) satisﬁes ι(u∗) = ι(u)T and that the unitary group is in-
variant under the operation of taking adjoints.
□
Exercise 31. Show that u ∈U(2n, R) if and only if UJ = JU and that
U(2n, R) = Sp(2n, R) ∩O(2n, R).
(2.20)
The identity above shows that U(2n, R) (which is a copy of the unitary
group) consists of symplectic rotations. It contains the group O(n) of all symplectic
matrices of the type
A
0
0
A

with AAT = AT A = I.
It is immediately veriﬁed that O(n) is the image in U(2n, R) of the orthogonal
group O(n, R) by the monomorphism ι.
2.3.3
Diagonalization and polar decomposition
A positive-deﬁnite matrix can always be diagonalized using an orthogonal matrix.
When this matrix is in addition symplectic we can use a symplectic rotation to
perform this diagonalization:
Proposition 32. Let S ∈Sp(2n, R) be positive deﬁnite (in particular S = ST ).
There exists U ∈U(2n, R) such that S = U T DU where
D = diag(λ1, . . . , λn; λ−1
1 , . . . , λ−1
n )
where λ1, . . . , λn are the n smallest eigenvalues of S.
Proof. The eigenvalues of a symplectic matrix occur in quadruples: if λ is an
eigenvalue, then so are λ−1, ¯λ, and ¯λ−1 (Exercise 22). If S > 0 these eigenvalues
occur in real pairs (λ, λ−1) with λ > 0 and we can thus order them as follows:
λ1 ≤· · · ≤λn ≤λ−1
n
≤· · · ≤λ−1
1 .
Let now U be an orthogonal matrix such that S = U T DU. We are going to show
that U ∈U(2n, R). It suﬃces for this to show that we can write U in the form
(2.17) with A and B satisfying (2.18). Let e1, . . . , en be n orthonormal eigenvectors
of U corresponding to the eigenvalues λ1, . . . , λn. Since SJ = JS−1 (S is both
symplectic and symmetric) we have, for 1 ≤k ≤n,
SJek = JS−1ek = 1
λj
Jek

2.3.
The unitary groups U(n, C) and U(2n, R)
27
hence ±Je1, . . . , ±Jen are the orthonormal eigenvectors of U corresponding to the
remaining n eigenvalues 1/λ1, . . . , 1/λn. Write now the 2n×n matrix (e1, . . . , en) as
(e1, . . . , en) =

A
B

where A and B are n × n matrices; we have
(−Je1, . . . , −Jen) = −J

A
B

=

−B
A

hence U is indeed of the type
U = (e1, . . . , en; −Je1, . . . , −Jen =

A
−B
B
A

.
The conditions (2.18) are satisﬁed since U T U = I.
□
The following consequence of the result above shows that one can take powers
of symplectic matrices, and that these powers still are symplectic. In fact:
Corollary 33. Let S be a positive deﬁnite symplectic matrix. Then:
(i) For every α ∈R there exists a unique R ∈Sp(2n, R), R > 0, R = RT, such
that S = Rα. In particular S1/2 ∈Sp(2n, R).
(ii) Conversely, if R ∈Sp(2n, R) is positive deﬁnite, then Rα ∈Sp(2n, R) for
every α ∈R.
Proof of (i). Set R = U T D1/αU; then Rα = U T DU = S.
Proof of (ii). It suﬃces to note that we have
Rα = (U T DU)α = U T DαU ∈Sp(2n, R).
□
This result allows us to prove a polar decomposition result for the symplectic
group. We denote by Sym+(2n, R) the set of all symmetric positive deﬁnite real
2n × 2n matrices.
Proposition 34. For every S ∈Sp(2n, R) there exists a unique U ∈U(2n, R) and
a unique R ∈Sp(2n, R) ∩Sym+(2n, R), such that S = RU (resp. S = UR).
Proof. The matrix R = ST S is symplectic and positive deﬁnite. Set U
=
(ST S)−1/2S; since (ST S)−1/2 ∈Sp(2n, R) in view of Corollary 33, we have U ∈
Sp(2n, R). On the other hand
UU T = (ST S)−1/2SST(ST S)−1/2 = I
so that we actually have
U ∈Sp(2n, R) ∩O(2n, R) = U(2n, R)

28
Chapter 2. The Symplectic Group
(cf. Exercise 31). That we can alternatively write S = UR (with diﬀerent choices
of U and R) follows by applying the result above to ST . The uniqueness statement
follows from the generic uniqueness of polar decompositions.
□
We will see in Chapter 11, Subsection 11.3 that Proposition 34 can be reﬁned
by giving explicit formulas for the matrices R and U (“pre-Iwasawa factorization”).
Exercise 35. Use the result above to prove that every S ∈Sp(2n, R) has determi-
nant 1.
One very important consequence of the results above is the connectedness of
the symplectic group:
Corollary 36. The symplectic group Sp(2n, R) is a connected Lie group.
Proof. Let us set Sp+(2n, R) = Sp(2n, R) ∩Sym+(2n, R). In view of Proposition
34 above the mapping
f : Sp(2n, R) −→Sp+(2n, R) × U(2n, R)
deﬁned by f(S) = RU is a bijection; both f and its inverse f −1 are continuous,
hence f is a homeomorphism. Now U(2n, R) is connected, and so is Sp+(2n, R).
It follows that Sp(2n, R) is also connected.
□
Exercise 37. Check that Sp+(2n, R) is connected (use for instance Corollary 33).
2.4
Symplectic bases and Lagrangian planes
Symplectic bases in phase space are in a sense the analogues of orthonormal bases
in Euclidean geometry.
2.4.1
Deﬁnition of a symplectic basis
Let δij be the Kronecker index: δij = 1 if i = j and δij = 0 if i ̸= j.
Deﬁnition 38. A set B of vectors
B = {e1, . . . , en} ∪{f1, . . . , fn}
of Rn ⊕Rn is called a “symplectic basis” of (Rn ⊕Rn, σ) if we have
σ(ei, ej) = σ(fi, fj) = 0,
σ(fi, ej) = δij for 1 ≤i, j ≤n.
(2.21)
Exercise 39. Check that a symplectic basis is a basis in the usual sense.

2.4.
Symplectic bases and Lagrangian planes
29
An obvious example of a symplectic basis is the following: choose
ei = (ci, 0), ei = (0, ci)
where (ci) is the canonical basis of Rn. (For instance, if n = 1, e1 = (1, 0) and
f1 = (0, 1).) These vectors form the canonical symplectic basis
C = {e1, . . . , en} ∪{f1, . . . , fn}
of (Rn ⊕Rn, σ).
A very useful result is the following; it is a symplectic variant of the Gram–
Schmidt orthonormalization procedure in Euclidean geometry. It also shows that
there are (inﬁnitely many) non-trivial symplectic bases:
Proposition 40. Let A and B be two (possibly empty) subsets of {1, . . . , n}. For any
two subsets E = {ei : i ∈A}, F = {fj : j ∈B} of the symplectic space (Rn⊕Rn, σ)
such that the elements of E and F satisfy the relations
ω(ei, ej) = ω(fi, fj) = 0 , ω(fi, ej) = δij for (i, j) ∈A × B,
(2.22)
there exists a symplectic basis B of (Rn ⊕Rn, σ) containing these vectors.
For a proof we refer to de Gosson [67], §1.2.2.
Symplectic automorphisms take symplectic bases to symplectic bases: this is
obvious from the deﬁnition. In fact, the symplectic group acts transitively on the
set of all symplectic bases:
Exercise 41. Show that for any two symplectic bases B and B′ there exists S ∈
Sp(2n, R) such that B = S(B′).
2.4.2
The Lagrangian Grassmannian
The group Sp(2n, R) not only acts on points of phase space Rn ⊕Rn but also on
subspaces of Rn ⊕Rn. Among these of particular interest are “Lagrangian planes”:
Deﬁnition 42. A Lagrangian plane of the symplectic space (Rn ⊕Rn, σ) is an n-
dimensional linear subspace ℓof Rn ⊕Rn having the following property: if (z, z′) ∈
ℓ×ℓthen σ(z, z′) = 0. The set of all Lagrangian planes in (Rn ⊕Rn, σ) is denoted
by Lag(2n, R); it is called the Lagrangian Grassmannian of (Rn ⊕Rn, σ).
Both “coordinate planes” ℓX = Rn ×{0} and ℓP = {0} ×Rn are Lagrangian,
and so is the diagonal ∆= {(x, x) : x ∈Rn} of Rn⊕Rn. If ℓis a Lagrangian plane,
so is Sℓfor every S ∈Sp(2n, R): ﬁrst ℓand Sℓhave the same dimension n, and if
z1 = Sz and z′
1 = Sz′ are in Sℓwith z and z′ in ℓ, then σ(z1, z′
1) = σ(z, z′) = 0.
In fact, we have the following much more precise result:

30
Chapter 2. The Symplectic Group
Proposition 43. The group action
Sp(2n, R) × Lag(2n, R) −→Lag(2n, R)
deﬁned by (S, ℓ) −→Sℓis transitive. That is, for every pair (ℓ, ℓ′) ∈Lag(2n, R) ×
Lag(2n, R) there exists S ∈Sp(2n, R) such that ℓ= Sℓ′.
Proof. Choose bases {e1, . . . , en} and {e′
1, . . . , e′
n} of ℓand ℓ′ respectively. Since
ℓand ℓ′ are Lagrangian planes we have σ(ei, ej) = σ(e′
i, e′
j) = 0 so in view of
Proposition 40 we can ﬁnd vectors f1, . . . , fn and f ′
1, . . . , f ′
n such that
B = {e1, . . . , en} ∪{f1, . . . , fn},
B′ = {e′
1, . . . , e′
n} ∪{f ′
1, . . . , f ′
n}
are symplectic bases of (Rn ⊕Rn, σ). Deﬁning S ∈Sp(2n, R) by the condition
B = S(B′) (see Exercise 41); we have ℓ= Sℓ′.
□
Exercise 44. Show that the result above is still true if one replaces Sp(2n, R) by
the unitary group U(2n, R).
Here you are supposed to prove the following reﬁnement of Proposition 43:
Problem 45. Two Lagrangian planes ℓand ℓ′ are said to be transversal if ℓ∩ℓ′ = 0;
equivalently ℓ⊕ℓ′ = Rn ⊕Rn. Prove that Sp(2n, R) acts transitively on the set
of all transversal Lagrangian planes (hint: use Proposition 40). Does the property
remain true if we replace Sp(2n, R) by U(2n, R)?
The Lagrangian Grassmannian has a natural topology which makes it into a
compact and connected topological space.
Proposition 46. The Lagrangian Grassmannian Lag(2n, R) is homeomorphic to the
coset space U(2n, R)/O(n) where O(n) is the image of O(n, R) by the restriction
of the embedding U(n, C) −→U(2n, R). Hence Lag(2n, R) is both compact and
connected.
Proof. U(2n, R) acts transitively on Lag(2n, R) (Exercise 44); the isotropy sub-
group of ℓP = {0} × Rn is precisely O(n). It follows that Lag(2n, R) is home-
omorphic to U(2n, R)/O(n). Since U(2n, R)/O(n) is trivially homeomorphic to
U(n, C)/O(n, R), and the projection U(n, C) −→U(n, C)/O(n, R) is continuous,
Lag(2n, R) is compact and connected because U(n, C) has these properties.
□

Chapter 3
Free Symplectic Matrices
Free symplectic matrices are in a sense the building blocks of the symplectic group.
Not only do they form a system of generators of Sp(2n, R), but they can be de-
scribed by so-called “generating functions”, well known in Hamiltonian mechanics.
Free symplectic matrices and their generating functions will play a crucial role in
the deﬁnition of the metaplectic group in Chapter 7. A related interesting reading
is the older paper of Burdet et al. [24].
3.1
Generating functions
Let us begin by giving a few equivalent deﬁnitions of the notion of free symplectic
matrix.
3.1.1
Deﬁnition of a free symplectic matrix
Let us begin by giving a general deﬁnition.
Deﬁnition 47. Let S ∈Sp(2n, R). We say that S is “free” if it satisﬁes any of the
three following equivalent conditions:
(i) For a given pair (p, p′) ∈R2n there exists a unique pair (x, x′) ∈Rn × Rn
such that (x, p) = S(x′, p′);
(ii) If S =

A
B
C
D

then det B ̸= 0;
(iii) Setting (x, p) = S(x′, p′) we have
det
 ∂x
∂p′ (z0)

̸= 0.
(3.1)
Exercise 48. Show that all three conditions (i), (ii), and (iii) in the deﬁnition above
indeed are equivalent.
31
M.A. de Gosson, Symplectic Methods in Harmonic Analysis and in Mathematical Physics,  
Pseudo-Differential Operators 7, DOI 10.1007/978-3-7643-9992-4_  © Springer Basel AG 2011 
3,

32
Chapter 3. Free Symplectic Matrices
Here is a very useful geometric characterization of free symplectic matrices.
Suppose that S ∈Sp(2n, R) is free and set (x, p) = S(x′, p′) as above. Identifying
σ with the diﬀerential 2-form
dp ∧dx =
n

j=1
dpj ∧dxj,
we have dp ∧dx = dp′ ∧dx′ and this is equivalent, by Poincar´e’s lemma, to the
existence of a function G ∈C∞(Rn ⊕Rn) such that
pdx = p′dx′ + dG(x′, p′).
The condition det(∂x/∂p′) ̸= 0 implies, by the implicit function theorem, that we
can locally solve the equation x = x(x′, p′) in p′, so that p′ = p′(x, x′) and hence
G(x′, p′) is, for (x′, p′) ∈U, a function of x, x′ only: G(x′, p′) = G(x′, p′(x, x′)).
Calling this function W:
W(x, x′) = G(x′, p′(x, x′))
we thus have
pdx = p′dx′ + dW(x, x′)
= p′dx′ + ∂xW(x, x′)dx + ∂x′W(x, x′)dx′
which requires p = ∂xW(x, x′) and p′ = −∂x′W(x, x′) and f is hence free in U.
We will see in a moment that this function W, which is uniquely deﬁned up to
an additive constant, plays a very important role under the name of “generating
function” of the free symplectic automorphism (or matrix) S.
Let us give another, purely geometric, deﬁnition of the notion of free sym-
plectic matrix. This property will be used when we prove our main factorization
result below.
Proposition 49. A matrix S ∈Sp(2n, R) is free if and only if we have SℓP ∩ℓP =
{0} where ℓP = {0} × Rn.
Proof. The set SℓP ∩ℓP is described by the equations (Bp, Dp) = (0, p). It reduces
to {0} if and only if the solution of these equations is p = 0, which is equivalent
to det B ̸= 0.
□
The interest of this characterization is that it allows us to deﬁne a more
general notion of free symplectic matrix: one says that S ∈Sp(2n, R) is free with
respect to a Lagrangian plane ℓ∈Lag(2n, R) if we have Sℓ∩ℓ= {0}; see de
Gosson [67], §2.2.3 for a study of this notion.

3.1.
Generating functions
33
3.1.2
The notion of generating function
Free symplectic matrices are “generated” by quadratic forms in (x, x′):
Proposition 50. (i) Let S ∈Sp(2n, R) be a free symplectic matrix. Then
(x, p) = S(x′, p′) ⇐⇒

p = ∂xW(x, x′),
p′ = −∂x′W(x, x′),
(3.2)
where W is the quadratic form given by
W(x, x′) = 1
2DB−1x2 −B−1x · x′ + 1
2B−1Ax′2
(3.3)
and DB−1 and B−1A are symmetric matrices.
(ii) If conversely
W(x, x′) = 1
2Px2 −Lx · x′ + 1
2Qx′2
(3.4)
with P = P T , Q = QT , and det L ̸= 0, then the matrix
SW =

L−1Q
L−1
PL−1Q −LT
PL−1

(3.5)
is a free symplectic matrix whose generating function in the sense above is (3.4).
Proof of (i). The matrices DB−1 and B−1A are symmetric in view of (2.4). We
have
∂xW(x, x′) = DB−1x −(B−1)T x′,
∂x′W(x, x′) = −B−1x′ + B−1Ax′;
setting p = ∂xW(x, x′) and p′ = −∂x′W(x, x′) and solving in x and p we get
x = Ax′ + Bp′, p = Cx′ + Dp′, that is (x, p) = S(x′, p′).
Proof of (ii). To see this, it suﬃces to remark that we have (x, p) = S(x′, p′) if and
only if p = Px−LTx′ and p′ = Lx−Qx′, and to solve the equations p = Px−LTx′
and p′ = Lx −Qx′ in x, p.
□
Notation 51. If the free symplectic matrix S has generating function W we will
write S = SW .
Corollary 52. Let SW ∈Sp(2n, R) be a free symplectic matrix. Then (SW )−1 is
also free, and we have
S−1
W = SW ∗
with
W ∗(x, x′) = −W(x′, x).
(3.6)

34
Chapter 3. Free Symplectic Matrices
Proof. The inverse of SW is the symplectic matrix
S−1
W =

DT
−BT
−CT
AT

which is thus free since det(−BT ) = (−1)n det B. In view of part (i) in Proposition
50 the inverse S−1
W is generated by the function
W ∗(x, x′) = −1
2AT (BT )−1x2 + (BT )−1x · x′ −1
2(BT )−1DT x′2
= −1
2B−1Ax2 + B−1x′ · x −1
2DB−1x′2
= −W(x′, x)
(recall that AT (BT )−1 = B−1A and (BT )−1DT = DB−1).
□
The statement in the following exercise implies that almost every symplectic
matrix is free:
Exercise 53. Show that the set Sp0(2n, R) of all free symplectic matrices has
codimension 1 in Sp(2n, R). [Hint: there is a bijective correspondence between the
set of all triples (P, L, Q) (P and Q symmetric, det L ̸= 0) and Sp0(2n, R).]
The notion of generating function also makes sense for aﬃne symplectic map-
pings:
Proposition 54. Let F = T (z0)SW ∈ASp(2n, R).
(i) A free generating function of f = T (z0)SW is the function
Wz0(x, x′) = W(x −x0, x′) + p0 · x
(3.7)
where z0 = (x0, p0).
(ii) Conversely, if W is the generating function of SW then any polynomial
Wz0(x, x′) = W(x, x′) + α · x + α′ · x′
(3.8)
with α, α′ ∈Rn is a generating function of an aﬃne symplectic transforma-
tion T (z0)SW with z0 = (x0, p0) = (Bα, Da + β).
Proof. Let Wz0 be deﬁned by (3.7), and set (x′,p′)=S(x′′,p′′), (x,p)=T (z0)(x′,p′).
We have
pdx −p′dx′ = (pdx −p′′dx′′) + (p′′dx′′ −p′dx′)
= (pdx −(p −p0)d(x −x0) + dW(x′′, x′)
= d(p0 · x + W(x −x0, x′))
which shows that Wz0 is a generating function. Finally, formula (3.8) is obtained by
a direct computation, expanding the quadratic form W(x−x0, x′) in its variables.
□

3.1.
Generating functions
35
Corollary 55. Let f = [SW , z0] be a free aﬃne symplectic transformation, and set
(x, p) = f(x′, p′). The function Φz0 deﬁned by
Φz0(x, x′) = 1
2p · x −1
2p′ · x′ + 1
2σ(z, z0)
(3.9)
is also a free generating function for f; in fact,
Φz0(x, x′) = Wz0(x, x′) + 1
2p0 · x0.
(3.10)
Proof. Setting (x′′, p′′) = S(x, p), the generating function W satisﬁes
W(x′′, x′) = 1
2p′′ · x′′ −1
2p′ · x′
in view of Euler’s formula for homogeneous functions. Let Φz0 be deﬁned by for-
mula (3.9); in view of (3.7) we have
Wz0(x, x′) −Φz0(x, x′) = 1
2p0 · x −1
2p · x0 −1
2p0 · x0
which is (3.10); this proves the corollary since all generating functions of a sym-
plectic transformation are equal up to an additive constant.
□
3.1.3
Application to the Hamilton–Jacobi equation
The notion of generating function also makes sense for general symplectomor-
phisms; it has an interesting application to the Hamilton–Jacobi equation brieﬂy
discussed in the ﬁrst chapter.
Deﬁnition 56. A symplectomorphism φ of Rn ⊕Rn is said to be free in a neigh-
borhood U of z0 ∈Rn ⊕Rn when its Jacobian matrix Dφ(z′) is a free symplectic
matrix for each z′ ∈U, that is, if and only if det(∂x/∂p′) ̸= 0.
Let H be a Hamiltonian function; we will use the notation Hpp, Hxp, and
Hxx for the matrices of second derivatives of H in the corresponding variables; for
instance
Hxp =
 ∂2H
∂xj∂pk

1≤j,k≤n
= HT
px.
Let (φH
t ) be the associated ﬂow; we assume it is deﬁned for every t in some interval
[−T, T ], T > 0.
Proposition 57. There exists ε > 0 such that the symplectomorphism φH
t is free at
z0 ∈Rn ⊕Rn for 0 < |t| ≤ε if and only if det Hpp(z0) ̸= 0.
Proof. Let t −→z(t) = (x(t), p(t)) be the solution to Hamilton’s equations ˙z =
J∂zH(z) with initial condition z(t0) = z0. A second-order Taylor expansion in t
of the function z(t) yields
z(t) = z0 + tXH(z0) + O(t2);

36
Chapter 3. Free Symplectic Matrices
and hence, in particular
x(t) = x0 + t∂pH(z0) + O(t2).
It follows that the Jacobian matrix of x(t) with respect to the p variables is
∂x(t)
∂p
= tHpp(z0) + O(t2)
hence there exists ε > 0 such that ∂x(t)/∂p is invertible in the interval [−ε, 0[∩]0, ε]
if and only if Hpp(z0) is invertible; this is equivalent to saying that φH
t
is free at
the point z0.
□
Exercise 58. Justify the last sentence of the proof above!
The result above applies when the Hamiltonian H is of the “physical type”
H(z, t) =
n

j=1
1
2mj
p2
j + U(x)
since Hpp(z0) is in this case the diagonal matrix whose diagonal elements are the
numbers 1/2mj, 1 ≤j ≤n. In this case φH
t
is free for small non-zero t near each
z0 where it is deﬁned. More generally it also applies to all Hamiltonians of the
type
H(z, t) = 1
2A(x)p2 + U(x)
where A(x) > 0 (i.e., positive-deﬁnite).
Here is an application of the result above; it shows that the generating func-
tion provides us with a way of solving explicitly the Hamilton–Jacobi equation:
Proposition 59. Suppose again that det Hpp(z) ̸= 0 for all z. Then, the Hamilton–
Jacobi equation
∂Φ
∂t + H (x, ∂xΦ, t) = 0 , Φ(x, 0) = Φ0(x)
(3.11)
has a solution Φ for 0 < |t| < ε given by
Φ(x, t) = Φ0(x′) + W(x, x′; t)
(3.12)
where x′ is deﬁned by the condition
(x, p) = φH
t (x′, ∂xΦ0(x′))
(3.13)
and W is the generating function
W(x, x′; t) =
	
pdx −Hdt.

3.1.
Generating functions
37
Proof. We assume that n = 1 for notational simplicity (the generalization to arbi-
trary dimension is straightforward replacing partial derivatives by gradients, etc.).
Formula (3.13) uniquely deﬁnes x′ for small values of t: writing x = (x′, ∂xΦ0(x′), t)
we have, by the chain rule,
dx
dx′ = ∂x
∂x′ + ∂x
∂p′
∂2Φ0
∂x′2 .
The limit for t →0 of the Jacobian matrix DH
t (z′) being the identity it follows
that dx/dx′ is diﬀerent from zero in some interval [−α, α], α > 0, and hence
the mapping x′ −→φH
t (x′, ∂xΦ0(x′)) is a local diﬀeomorphism for each ﬁxed
t ∈[−α, α]. Obviously limt→0 Φ(x, t) = Φ0(x) since x′ →x as t →0, so that the
Cauchy condition is satisﬁed. To prove that Φ is a solution of Hamilton–Jacobi’s
equation one then notes that
Φ(x + ∆x, t + ∆t) −Φ(x, t) =
	
L
pdx −Hdt
where L is the line segment joining (x, p, t) to (x + ∆x, p + ∆p, t + ∆t); the values
p and p + ∆p are determined by the relations p = ∂xW(x, x′; t) and
p + ∆p = ∂xW(x + ∆x, x′ + ∆x′; t + ∆t)
where we have set ∆x′ = x′(x + ∆x) −x′(x). Thus,
Φ(x + ∆x, t + ∆t) −Φ(x, t) = p∆x + 1
2∆p∆x −∆t
	 1
0
H(x + s∆x, p + s∆p)ds
and hence
Φ(x, t + ∆t) −Φ(x, t)
∆t
= −
	 1
0
H(x, p + s∆p)ds.
Taking the limit ∆t →0 and noting that ∆p →0 we get
∂Φ
∂t (x, t) = −H(x, p).
(3.14)
Similarly,
Φ(x + ∆x, t) −Φ(x, t) = p∆x + 1
2∆p∆x
and ∆p →0 as ∆x →0 so that
∂Φ
∂x (x, t) = p.
(3.15)
Combining both relations (3.14) and (3.15) we see that Φ satisﬁes Hamilton-
Jacobi’s equation.
□

38
Chapter 3. Free Symplectic Matrices
3.2
A factorization result
There are many factorization results for symplectic matrices. Here we will only be
concerned with factorizations using free symplectic matrices (see de Gosson [67]
for more results).
3.2.1
Statement and proof
In our context the main interest of the notion of free symplectic matrix comes from
the following factorization result which says that every symplectic matrix can be
written as the product of exactly two free symplectic matrices. Our proof makes
use of the transitivity of the action of Sp(2n, R) on the Lagrangian Grassmannian
Lag(2n, R).
Theorem 60. For every S ∈Sp(2n, R) there exist two free symplectic matrices SW
and SW ′ such that S = SW SW ′.
Proof. The symplectic group Sp(2n, R) acts transitively not only on the Lagrang-
ian Grassmannian Lag(2n, R) but also on the subset of Lag(2n, R) × Lag(2n, R)
consisting of all pairs (ℓ, ℓ′) such that ℓ∩ℓ′ = {0} (see Problem 45). Let ℓP be
the Lagrangian plane {0} × Rn and, for given ℓ, choose ℓ′ transversal to both
ℓP and Sℓ:
ℓ′ ∩ℓP = ℓ′ ∩Sℓ= {0}.
In view of the pair transitivity property there exists S1 ∈Sp(2n, R) such that
S1(ℓP , ℓ′) = (ℓ′, SℓP ), that is S1ℓP = ℓ′ and SℓP = S1ℓ′. Since Sp(2n, R) acts
transitively on Lag(2n, R) we can ﬁnd S′
2 such that ℓ′ = S′
2ℓP and hence SℓP =
S1S′
2ℓP . It follows that there exists S′′ ∈Sp(2n, R) such that S′′ℓP = ℓP and
S = S1S′
2S′′. Set S2 = S′
2S′′; then S = S1S2 and we have
S1ℓP ∩ℓP = ℓ′ ∩ℓP = 0,
S2ℓP ∩ℓ0 = S′
2ℓP ∩ℓP = ℓ′ ∩ℓP = 0.
Hence S1 and S2 are free in view of Proposition 49; our claim follows since
S = S1S2.
□
The choice of SW and SW ′ in the factorization S = SW SW ′ is of course
not unique; for instance the identity I can be written as I = SW SW ∗for every
generating function W!
Problem 61. Modify the proof of Theorem 60 to show that, more generally, for
every (S, ℓ0) ∈Sp(2n, R) × Lag(2n, R) there exist two symplectic matrices S1, S2
such that S = S1S2 and S1ℓ0 ∩ℓ0 = S2ℓ0 ∩ℓ0 = 0.

3.2.
A factorization result
39
3.2.2
Application: generators of Sp(2n, R)
If P and L are, respectively, a symmetric and an invertible n × n matrix, and L
an invertible matrix, we set
VP =
 I
0
−P
I

, UP =
−P
I
−I
0

, ML =
L−1
0
0
LT

.
(3.16)
Proposition 62. Every free symplectic matrix S = ML =

A
B
C
D

can be factored
as
S = V−DB−1MB−1U−B−1A
(3.17)
and
S = V−DB−1MB−1JV−B−1A.
(3.18)
Proof. We begin by noting that we can write
A
B
C
D

=

I
0
DB−1
I
 B
0
0
DB−1A −C
 B−1A
I
−I
0

(3.19)
whether S is symplectic or not. If now S is symplectic, then the middle factor in
the right-hand side of (3.19) also is symplectic, since the ﬁrst and the third factors
obviously are. Taking the condition ADT −BCT = I in (2.5) into account, we
have DB−1A −C = (BT )−1and hence
B
0
0
DB−1A −C

=
B
0
0
(BT )−1

so that
S =

I
0
DB−1
I
 B
0
0
(BT )−1
 B−1A
I
−I
0

.
(3.20)
The factorization (3.17) follows (both DB−1 and B−1A are symmetric, as a con-
sequence of the relations BT D = DT B and BT A = AT B in (2.4)). Noting that

B−1A
I
−I
0

=

0
I
−I
0
 
I
0
B−1A
I

the factorization (3.18) follows as well.
□
Conversely, if a matrix S can be written in the form V−P MLJV−Q, then it
is a free symplectic matrix; in fact,
S = SW =

L−1Q
L−1
PL−1Q −LT
PL−1

(3.21)
as is checked by a straightforward calculation.

40
Chapter 3. Free Symplectic Matrices
A consequence of these results is the following:
Corollary 63. Each of the sets
{VP , ML, J : P = P T , det L ̸= 0}
and
{UP , ML : P = P T , det L ̸= 0}
generates Sp(2n, R).
Proof. Every S ∈Sp(2n, R) is the product of two free symplectic matrices. It now
suﬃces to apply Proposition 62 above.
□

Chapter 4
The Group of Hamiltonian
Symplectomorphisms
Symplectic diﬀeomorphisms, or symplectomorphisms as they are often called, are
the “canonical transformations” which have been known and used by physicists
for a long time. They generalize the linear (and aﬃne) symplectic mappings we
have been using so far. A basic reference for this chapter is Polterovich [133].
4.1
The group Symp(2n, R)
The notion of symplectic matrix or automorphism can be generalized to the non-
linear case, and leads to the notion of symplectomorphism.
4.1.1
Deﬁnition and examples
Recall that a diﬀeomorphism of Rn ⊕Rn is an invertible mapping φ : Rn ⊕Rn −→
Rn ⊕Rn (or Ω−→Ω′ where Ωand Ω′ are open subsets of Rn ⊕Rn) such that
both φ and its inverse φ−1 are inﬁnitely diﬀerentiable.
Deﬁnition 64. Let Ωbe an open subset of Rn ⊕Rn. Let Rn ⊕Rn be equipped with
the symplectic form σ. A diﬀeomorphism φ : Ω−→φ(Ω) ⊂Rn ⊕Rn is called a
symplectomorphism (or symplectic diﬀeomorphism) if its Jacobian matrix Dφ(z)
is symplectic at every point z ∈Ω: Dφ(z) ∈Sp(2n, R), that is
Dφ(z)T JDφ(z) = Dφ(z)JDφ(z)T = J.
In diﬀerential notation a diﬀeomorphism φ is a symplectomorphism if and
only if φ∗σ = σ:
φ∗


n

j=1
dpj ∧dxj

=
n

j=1
dpj ∧dxj
where φ∗denotes the pull-back by φ.
41
M.A. de Gosson, Symplectic Methods in Harmonic Analysis and in Mathematical Physics,  
Pseudo-Differential Operators 7, DOI 10.1007/978-3-7643-9992-4_ , © Springer Basel AG 2011 
4

42
Chapter 4.
The Group of Hamiltonian Symplectomorphisms
A typical (but rather trivial) example is the following: let f : Rn −→Rn be
a diﬀeomorphism; then the formula
φ(z) = (f(x), Df(x)−1p)
deﬁnes a symplectomorphism φ : Rn ⊕Rn −→Rn ⊕Rn.
Exercise 65. What is the symplectomoprphism φ above when f is linear?
Exercise 66. Show that the mapping φ : (r, α) −→(x, p) where x =
√
2r cos α
and p =
√
2r sin α is a symplectomorphism of some subset Ωof Rn ⊕Rn onto
its image. (The variables x =
√
2r cos α and p =
√
2r sin α are called “symplectic
polar coordinates”; the reader is invited to verify that the usual change to polar
variables x = r cos α, p = r sin α is not a symplectomorphism.)
If φ and ψ are symplectomorphisms deﬁned on Rn ⊕Rn then φψ = φ ◦ψ is
also a symplectomorphism: in view of the chain rule the Jacobian matrix of φψ at
a point z is namely
D(φψ)(z) = Dφ(ψ(z))Dψ(z)
and is hence a product of symplectic matrices. Using the formula D(φ−1) =
(Dφ)−1 for the Jacobian of the inverse of a diﬀeomorphism, one sees also that the
inverse of a symplectomorphism is also a symplectomorphism. Thus, Symp(2n, R)
is a group for the usual composition law φψ = φ ◦ψ.
Deﬁnition 67. The set of all symplectomorphisms deﬁned on Rn⊕Rn and equipped
with the natural composition law is denoted by Symp(2n, R) and called the group
of symplectomorphisms of the symplectic space (Rn ⊕Rn, σ).
Clearly the following inclusions hold:
Sp(2n, R) ⊂ISp(2n, R) ⊂Symp(2n, R).
The group Symp(2n, R) is equipped with a topology by specifying the con-
vergent sequences: let (φj)j∈N be a sequence of symplectomorphisms of Rn ⊕Rn;
we will say that
lim
j→∞φj = φ in Symp(2n, R)
if and only if for every compact set K in Rn⊕Rn the sequences (φj|K) and (D(φj|K))
converge uniformly towards φ|K and D(φ|K), respectively.
Symplectomorphisms preserve phase-space volume: this is an immediate con-
sequence of the fact that the Jacobian matrix of a symplectomorphism is symplec-
tic and thus has determinant equal to 1. On the diﬀerential level this can be seen
as follows: the volume form dz in Rn ⊕Rn is proportional to σ∧n = σ ∧σ ∧· · · ∧σ
(n factors) and
φ∗σ∧n = φ∗σ ∧φ∗σ ∧· · · ∧φ∗σ = σ∧n.
Of course, more generally, we have φ∗σ∧k = σ∧k for 1 ≤k ≤n.
We will study in Section 4.2 the connected component of Symp(2n, R); it is
the group of Hamiltonian symplectomorphisms.

4.2.
Hamiltonian symplectomorphisms
43
4.2
Hamiltonian symplectomorphisms
The notion of Hamiltonian symplectomorphism appears naturally when one stud-
ies Hamiltonian ﬂows. Recall from Chapter 1 that the ﬂow (φH
t ) determined by
Hamilton’s equations
dxj
dt = ∂H
∂pj
(x, p, t) , dpj
dt = −∂H
∂xj
(x, p, t)
consists of Hamiltonian symplectomorphisms since the Jacobian matrix DφH
t (z)
is symplectic at every point z of Rn ⊕Rn (Theorem 9(ii)).
4.2.1
Symplectic covariance of Hamiltonian ﬂows
Hamilton’s equations are covariant (i.e., they retain their form) under canonical
transformations. Let us begin by proving the following general result about vector
ﬁelds. We will write ϕψ for ϕ ◦ψ when ϕ and ψ are diﬀeomorphisms.
Lemma 68. Let (ϕX
t ) be the ﬂow of some vector ﬁeld X on Rm. Let ϕ be a diﬀeo-
morphism Rm −→Rm. The family (ϕY
t ) of diﬀeomorphisms deﬁned by
ϕY
t = ϕ−1ϕX
t ϕ
(4.1)
is the ﬂow of the vector ﬁeld Y = (Dϕ)−1(X ◦ϕ), that is:
Y (u) = D(ϕ−1)(ϕ(u))X(ϕ(u)) = [Dϕ(u)]−1X(ϕ(u)).
(4.2)
Proof. Obviously ϕY
0 is the identity; in view of the chain rule
d
dtϕY
t (x) = D(ϕ−1)(ϕX
t (ϕ(x)))X(ϕX
t (ϕ(x))
= (Dϕ)−1(ϕY
t (x))X(ϕ(ϕY
t (x)))
hence
d
dtϕY
t (x) = Y (ϕY
t (x))
which we set out to prove.
□
Let us apply this lemma to the Hamiltonian case. We deﬁne the push-forward
of a vector ﬁeld X by a diﬀeomorphism φ by the formula
φ∗X = (Dφ)−1(X ◦φ)
well known from elementary diﬀerential geometry.

44
Chapter 4.
The Group of Hamiltonian Symplectomorphisms
Proposition 69. Let φ be a symplectomorphism of (Rn ⊕Rn, σ).
(i) We have
XH◦φ(z) = [Dφ(z)]−1(XH ◦φ)(z),
(4.3)
that is
φ∗XH = XH◦φ.
(ii) The ﬂows (φH
t ) and (φH◦φ
t
) are conjugate by φ:
φH◦φ
t
= φ−1φH
t φ.
(4.4)
Proof. Let us prove (i); part (ii) will follow in view of Lemma 68 above. Set
K = H ◦φ. By the chain rule
∂zK(z) = [Dφ(z)]T (∂zH)(φ(z))
hence the vector ﬁeld XK = J∂zK is given by
XK(z) = J[Dφ(z)]T ∂zH(φ(z)).
Since Dφ(z) is symplectic we have
J[Dφ(z)]T = [Dφ(z)]−1J
and hence
XK(z) = [Dφ(z)]−1J∂zH(φ(z))
which is (4.3).
□
4.2.2
The group Ham(2n, R)
Let us now deﬁne the notion of Hamiltonian symplectomorphism.
In what follows Hamilton functions are generically time-dependent.
Deﬁnition 70. We will say that a diﬀeomorphism φ of (Rn ⊕Rn, σ) is a Hamil-
tonian symplectomorphism (or diﬀeomorphism) if there exists a real function
H ∈C∞((Rn ⊕Rn) × R) such that φ = φH
1 where (φH
t ) is the ﬂow generated
by H. The set of all Hamiltonian symplectomorphisms is denoted by Ham(2n, R).
Choosing H constant it is clear that the identity is a Hamiltonian symplec-
tomorphism.
The choice of a time-one map φH
1 in the deﬁnition above is of course arbitrary,
and can be replaced by any φH
a : if φ = φH
a for some a ̸= 0 then we also have
φ = φHa
1
where Ha(z, t) = aH(z, at). In fact, setting ta = at we have
dza
dt = J∂zHa(za, t) ⇐⇒dza
dta = J∂zH(za, ta)
and hence φHa
t
= φH
at.

4.2.
Hamiltonian symplectomorphisms
45
We are going to see in a moment that Ham(2n, R) is a connected and normal
subgroup of Symp(2n, R) for the induced composition law, thus justifying the
following deﬁnition:
Deﬁnition 71. The set Ham(2n, R) of all Hamiltonian symplectomorphisms
equipped with the law φψ = φ◦ψ is called the group of Hamiltonian symplectomor-
phisms of the standard symplectic space (Rn⊕Rn, σ). The topology of Ham(2n, R)
is the topology induced by that of the group Symp(2n, R) of symplectomorphisms
of (Rn ⊕Rn, σ).
We assume in what follows that all Hamiltonian ﬂows are deﬁned on Rn⊕Rn
for all values of time. This may seem a strong condition, especially after our dis-
cussion in Chapter 1, Subsection 1.1.2: many interesting Hamiltonian functions
do not generate ﬂows that exist forever. This diﬃculty can be suppressed by the
following trick: (see, e.g., Polterovich [133]). If φH
t
is not deﬁned for all values
of t, we just replace H by the function HΘ where Θ ∈C∞
0 (Rn ⊕Rn) is a com-
pactly supported inﬁnitely diﬀerentiable function equal to 1 on some arbitrarily
chosen subset Ωof phase space. Thus, H(z, t) is equal to 0 for z lying outside
Supp(Θ) ⊂Ω. The classical theory of diﬀerential systems tells us that the solu-
tions of Hamilton’s equations then exist for all times, and hence the ﬂow (φHΘ
t
)
is deﬁned for all t. The diﬀeomorphisms φHΘ
t
are the identity outside the support
of Θ. Suppose in fact that the initial point z0 lies outside Supp(Θ), so that H(z0)
is constant. The function z(t) = z0 is a solution of Hamilton’s equations because
˙z0 = 0 and ∂pH(z0, t) = ∂xH(z0, t) = 0. Since we always assume uniqueness,
z(t) = z0 is the solution, and thus φH
t (z0) = z0. Moreover, any solution curve
starting at time t = 0 from a point z0 inside Supp(Θ) will stay forever inside
Supp(Θ) (otherwise the curve would stop at a point outside Supp(Θ) in view of
the previous argument, and could not leave the exterior of Supp(Θ) even under
time-reversal, which is a contradiction).
Let us ﬁrst prove a preparatory result which is interesting in its own right.
Proposition 72. Let (φH
t ) and (φK
t ) be Hamiltonian ﬂows. Then:
φH
t φK
t = φH#K
t
and (φH
t )−1 = φ
¯
H
t
(4.5)
where H#K and ¯H are the Hamiltonian functions deﬁned by
H#K(z, t) = H(z, t) + K((φH
t )−1(z), t).
¯H(z, t) = −H(φH
t (z), t).
Proof of the ﬁrst identity (4.5). By the product and chain rule we have
d
dt(φH
t φK
t ) = ( d
dtφH
t )φK
t + (DφH
t )φK
t
d
dtφK
t
(4.6)
= XH(φH
t φK
t ) + (DφH
t )φK
t ◦XK(φK
t )
(4.7)

46
Chapter 4.
The Group of Hamiltonian Symplectomorphisms
and it thus suﬃces to show that
(DφH
t )φK
t ◦XK(φK
t ) = XK◦(φH
t )−1(φK
t ).
(4.8)
Writing
(DφH
t )φK
t ◦XK(φK
t ) = (DφH
t )((φH
t )−1φH
t φK
t ) ◦XK((φH
t )−1φH
t φK
t )
the equality (4.8) follows from the transformation formula (4.3) in Proposition 69.
Proof of the second identity (4.5). It is an easy consequence of the ﬁrst, noting
that (φH
t φ ¯
H
t ) is the ﬂow determined by the Hamiltonian
K(z, t) = H(z, t) + ¯H((φH
t )−1(z), t) = 0;
φH
t φ ¯
H
t is thus the identity, so that (φH
t )−1 = φ ¯
H
t as claimed.
□
Let us now show that Ham(2n, R) is a group, as claimed. In fact we will prove
a little bit more:
Proposition 73. Ham(2n, R) is a normal subgroup of the group Symp(2n, R) of all
symplectomorphisms of the standard symplectic space (Rn ⊕Rn, σ).
Proof. Let us show that if φ, ψ ∈Ham(2n, R) then φψ−1 ∈Ham(2n, R). We have
φ = φH
1 and ψ = φK
1 for some Hamiltonians H and K. In view of the identities
(4.5) we have
φψ−1 = φH
1 (φK
1 )−1 = φH# ¯
K
1
hence φψ−1 ∈Ham(2n, R). That Ham(2n, R) is a normal subgroup of Symp(2n, R)
immediately follows from formula (4.4) in Proposition 69: if ψ is a symplectomor-
phism and φ ∈Ham(2n, R) then
φH◦ψ
1
= ψ−1φH
1 ψ ∈Ham(2n, R)
(4.9)
which was to be proven.
□
We are now going to prove a deep and beautiful result due to Banyaga
[5]. It essentially says that a path of time-one Hamiltonian symplectomorphisms
passing through the identity at time zero is itself Hamiltonian; as a consequence
Ham(2n, R) is a connected group.
Let t −→φt be a path in Ham(2n, R), deﬁned for 0 ≤t ≤1 and starting at the
identity: φ0 = I. We will call such a path a one-parameter family of Hamiltonian
symplectomorphisms. Thus, each φt is equal to some symplectomorphism φHt
1 .
Theorem 74. Let t −→φt, 0 ≤t ≤1 be a continuous curve in Ham(2n, R) such
that φ0 = I. Then (φt) is the Hamiltonian ﬂow determined by the Hamiltonian
function
H(z, t) = −
	 1
0
σ(X(uz, t), z)du with X = ( d
dtφt) ◦(φt)−1.
(4.10)

4.3.
The symplectic Lie algebra
47
Proof. The starting point of the argument is the following: one begins by noting
that if XH is a Hamiltonian vector ﬁeld, one can reconstruct H by the following
method: ﬁrst write
H(z, t) = H(z, 0) +
	 1
0
d
duXH(uz, t)du
= H(z, 0) +
	 1
0
[∂zH(uz, t) · z] du
(the second equality in view of the chain rule).
Next observe that since ∇zH(uz, t) = −J2∂zH(uz, t) = −JXH(uz, t) we
have
H(z, t) = H(z, 0) −
	 1
0
σ(XH(uz, t), z)du
where σ is the standard symplectic form. Let us now prove Banyaga’s formula
(4.10). By deﬁnition of X we have d
dtφt = Xφt so that all we have to do is to prove
that X is a (time-dependent) Hamiltonian ﬁeld. For this it suﬃces to show that the
contraction iXσ of the symplectic form with X is an exact diﬀerential one-form, for
then iXσ = −dH where H is given by (4.10). The φt being symplectomorphisms,
they preserve the symplectic form σ and hence LXσ = 0. In view of Cartan’s
homotopy formula we have
LXσ = iXdσ + d(iXσ) = d(iXσ) = 0
so that iXσ is closed; by Poincar´e’s lemma it is also exact.
□
Corollary 75. The group Ham(2n, R) of Hamiltonian symplectomorphisms is a
connected subgroup of the group Symp(2n, R) of symplectomorphisms of (Rn ⊕
Rn, σ).
Proof. The connectedness of Ham(2n, R) follows from Theorem 74: let t −→φt,
0 ≤t ≤1 be a continuous curve in Ham(2n, R) joining the identity to φ ∈
Ham(2n, R); then (φt) is a Hamiltonian ﬂow and hence φ = φ1 ∈Ham(2n, R).
□
We encourage the reader to pay some attention to the following exercise.
Exercise 76. Show that Sp(2n, R) ⊂Ham(2n, R) and that the Hamiltonian func-
tion of (φH
t ) such that φH
t ∈Sp(2n, R) is of the type H(z, t) = 1
2M(t)z ·z for some
real symmetric matrix M(t) depending smoothly on t.
4.3
The symplectic Lie algebra
Let M(2n, R) be the algebra of all real 2n × 2n matrices. The symplectic group
Sp(2n, R) is a closed subgroup of the general linear group GL(2n, R): we have
Sp(2n, R) = f −1(0) where f is the continuous mapping M(2n, R) −→M(2n, R)

48
Chapter 4.
The Group of Hamiltonian Symplectomorphisms
deﬁned by f(M) = ST MS −J hence Sp(2n, R) is closed in M(2n, R); since
Sp(2n, R) ⊂GL(2n, R) it is also closed in GL(2n, R). It follows that Sp(2n, R) is
a classical Lie group, and it thus makes sense to talk about its Lie algebra.
4.3.1
Matrix characterization of sp(2n, R)
The main result is the following:
Proposition 77. The Lie algebra sp(2n,R) of Sp(2n,R) consists of all X ∈M(2n,R)
such that
XJ + JXT = 0 (equivalently XT J + JX = 0).
(4.11)
Proof. Let (St) be a diﬀerentiable one-parameter subgroup of Sp(2n, R) and X
a 2n × 2n real matrix such that St = exp(tX). Since St is symplectic we have
StJ(St)T = J, that is
exp(tX)J exp(tXT ) = J.
Diﬀerentiating both sides of this equality with respect to t and then setting t = 0
we get XJ+JXT = 0, and applying the same argument to the transpose ST
t we get
XTJ +JX = 0 as well. Suppose conversely that X is such that XJ +JXT = 0 and
let us show that X ∈sp(2n, R). For this it suﬃces to prove that St = exp(tX) is
in Sp(2n, R) for every t. The condition XT J +JX = 0 is equivalent to XT = JXJ
hence ST
t = exp(tJXJ); since J2 = −I we have (JXJ)k = (−1)k+1JXkJ and
hence
exp(tJXJ) = −
∞

k=0
(−t)k
k!
(JXJ)k = −Je−tXJ.
It follows that ST
t JSt = (−Je−tXJ)JetX = J so that St ∈Sp(2n, R) as claimed.
□
Note that if one writes X ∈sp(2n, R) in block matrix form then it has the
form
X =

U
V
W
−V T

where U, V , and W are n × n matrices such that
V = V T
and W = W T .
In particular sp(2, R) consists of all 2 × 2 matrices with vanishing trace:
X ∈sp(2, R) ⇐⇒Tr X = 0.
Exercise 78. Show that the dimension of Sp(2n, R) as a Lie group is n(2n + 1).
[Hint: write X ∈sp(2n, R) in block-matrix form and then use the fact that a Lie
group has the same dimension as its Lie algebra.]

4.3.
The symplectic Lie algebra
49
Problem 79.
(i) Let ∆jk = (δjk)1≤j,k≤n (δjk = 0 if j ̸= k, δjk = 1). Show that the matrices
Xjk =

∆jk
0
0
−∆jk

, Yjk = 1
2

0
∆jk + ∆kj
0
0

,
Zjk = 1
2

0
0
∆jk + ∆kj
0

(1 ≤j ≤k ≤n)
form a basis of sp(n).
(ii) Show that every Z ∈sp(n) can be written in the form [X, Y ] = XY −Y X
with X, Y ∈sp(n).
4.3.2
The exponential mapping
One should be careful to note that the exponential mapping
exp : sp(2n, R) −→Sp(2n, R)
is neither surjective nor injective; for instance it is not hard to prove that if S ∈
Sp(2, R) can be written in the form S = exp X with X ∈sp(1) then we must have
Tr S ≥−2 (see de Gosson [67], p. 37). However, when conditions of positivity
and symmetry are imposed, one has a much better situation. In fact, denoting by
Sym(2n, R) the set of real symmetric 2n × 2n matrices and by Sym+(2n, R) the
subset of Sym(2n, R) consisting of positive deﬁnite matrices, we have:
Proposition 80.
(i) We have S ∈Sp(2n, R) ∩Sym+(2n, R) if and only if S = exp X with X ∈
sp(n) and X = XT .
(ii) The exponential mapping is a diﬀeomorphism
exp : sp(2n, R) ∩Sym(2n, R) −→Sp(2n, R) ∩Sym+(2n, R).
Proof. If X ∈sp(2n, R) and X = XT then S is both symplectic and symmetric
positive deﬁnite. Assume conversely that S is symplectic and symmetric positive
deﬁnite. The exponential mapping is a diﬀeomorphism
exp : Sym(2n, R) −→Sym+(2n, R)
hence there exists a unique X ∈Sym(2n, R) such that S = exp X. Let us show
that X ∈sp(2n, R). Since S = ST we have SJS = J and hence S = −JS−1J.
Because −J = J−1 it follows that
exp X = J−1(exp(−X))J = exp(−J−1XJ)
and, J−1XJ being symmetric, we conclude that X = J−1XJ that is JX = −XJ,
showing that X ∈sp(2n, R).
□

50
Chapter 4.
The Group of Hamiltonian Symplectomorphisms
We now view the group Ham(2n, R) of all Hamiltonian symplectomorphisms
of (Rn ⊕Rn, σ) as a Lie subgroup of the group of all diﬀeomorphisms of Rn ⊕Rn.
Proposition 81. The Hamiltonian Lie algebra ham(2n, R) consists of all Hamilto-
nian vector ﬁelds XH with Lie bracket [XH, XK] such that
[XH, XK] = X{H,K}
(4.12)
where {H, K} is the Poisson bracket:
{H, K} = ∂xH · ∂pK −∂xK · ∂pH.
(4.13)
Proof. The Lie algebra ham(2n, R) of Ham(2n, R) is just the tangent space to
Ham(2n, R) at the identity, hence it is the algebra of all vector ﬁelds X on Rn⊕Rn
such that
X(z) = d
dtφt(z)

t=0
.
In view of Theorem 74 there exists a Hamiltonian function H ∈C∞((Rn⊕Rn)×R)
such that φt = φH
t
hence X = XH. The proof of formula (4.13) readily follows
from Proposition 12; we leave the details to the reader as an exercise.
□

Chapter 5
Symplectic Capacities
We are going to describe a deep topological principle, Gromov’s symplectic non-
squeezing theorem [87], alias the “principle of the symplectic camel”. As we will see
in the next chapter, the main tool allowing the application of Gromov’s theorem to
the study of classical and quantum uncertainties is the derived notion of symplectic
capacity, which is a typically “classical” object.
5.1
Gromov’s theorem and symplectic capacities
In addition to being volume-preserving, Hamiltonian ﬂows have an unexpected
additional property as soon as the number of degrees of freedom is superior to 1;
this property is a consequence of the symplectic non-squeezing theorem which was
proved in 1985 by M. Gromov [87].
5.1.1
Statement of Gromov’s theorem
Gromov’s non-squeezing theorem is very surprising and has many indirect conse-
quences. Let us state it precisely. We denote by Zj(R) the cylinder in Rn ⊕Rn
deﬁned by the condition: a point (x, p) is in Zj(R) if and only if x2
j + p2
j ≤R2.
Theorem 82 (Gromov). If there exists a symplectomorphism φ in Rn ⊕Rn sending
the ball B(r) in some cylinder Zj(R), then we must have r ≤R.
It is essential for the non-squeezing theorem to hold that the considered cylin-
der is based on an xj, pj plane (or, more generally, on a symplectic plane). For
instance, if we replace the cylinder Zj(R) by the cylinder Z12(R) : x2
1 + x2
2 ≤R2
based on the x1, x2 plane, it is immediate to check that the linear symplecto-
morphism φ deﬁned by φ(x, p) = (λx, λ−1p) sends B(r) into Z12(R) as soon as
λ ≤r/R. Also, one can always “squeeze” a large ball into a big cylinder using
volume-preserving diﬀeomorphisms that are not canonical. Here is an example in
51
M.A. de Gosson, Symplectic Methods in Harmonic Analysis and in Mathematical Physics,  
Pseudo-Differential Operators 7, DOI 10.1007/978-3-7643-9992-4_ , © Springer Basel AG 2011 
5

52
Chapter 5. Symplectic Capacities
the case n = 2 that is very easy to generalize to higher dimensions: deﬁne a linear
mapping f by
f(x1, x2, p1, p2) = (λx1, λ−1x2, λp1, λ−1p2).
Clearly det f = 1 and f is hence volume-preserving; f is however not symplectic
if λ ̸= 1. Choosing again λ ≤r/R, the mapping f sends B(R) into Z1(r).
Gromov’s theorem actually holds when Zj(R) is replaced by any cylinder
with radius R based on a symplectic plane, i.e., a two-dimensional subspace P
of Rn ⊕Rn such that the restriction of σ to P is non-degenerate (equivalently,
P has a basis {e, f} such that σ(e, f) ̸= 0). The planes Pj of coordinates xj, pj
are of course symplectic, and given an arbitrary symplectic plane P it is easy to
construct a linear symplectomorphism Sj such that Sj(P) = Pj. It follows that a
symplectomorphism φ sends B(r) in the cylinder Zj(R) if and only if φ ◦Sj sends
B(r) in the cylinder Zj(R) with the same radius based on P.
Gromov’s theorem obviously applies to Hamiltonian ﬂows, since these con-
sist of symplectomorphisms. Here is a dynamical description of the non-squeezing
theorem. Assume that we are dealing with a subset Ωt ⊂Rn ⊕Rn at time t mod-
elling a large number of points in phase space, subject to a Hamiltonian ﬂow (φH
t ).
Suppose that Ω0 = Ωis a phase space ball B(r) : |z −z0| ≤r at time t = 0. The
orthogonal projection of that ball on any plane of coordinates is a circle with area
πr2. As time evolves, Ωwill distort and may take after a while a very diﬀerent
shape, while keeping constant volume (because Hamiltonian ﬂows are volume pre-
serving). In fact, since conservation of volume has nothing to do with conservation
of shape, one might very well envisage that Ωbecomes stretched in all directions
by the Hamiltonian ﬂow (φH
t ), and eventually gets very thinly spread out over
huge regions of phase space, so that the projections on any plane could a priori
become arbitrarily small after some time t. (In fact, this possibility is perfectly
consistent with a deep result of Katok [106] which says that, up to sets of arbi-
trarily small measure ε, any kind of phase-space spreading is a priori possible for
a volume-preserving ﬂow. However, Gromov’s theorem implies that the areas of
the projections of the set φH
t (B(r)) on any plane of conjugate coordinates xj, pj
(or, more generally, on any symplectic plane) will never decrease below its original
value πr2.
5.1.2
Proof of Gromov’s theorem in the aﬃne case
All known proofs (direct, or indirect) of Gromov’s theorem are notoriously diﬃcult,
whatever method one uses (this might explain that it had not been discovered
earlier, even in the more “physical” framework of Hamiltonian dynamics). We
note that a related heuristic justiﬁcation of Gromov’s theorem is given by Hofer
and Zehnder in [101] p. 34; their argument however relies on an assumption which
is (if true) at least as diﬃcult to prove as Gromov’s theorem itself! We are going to
be much more modest, and to give a proof (actually two) of Gromov’s theorem for
aﬃne symplectomorphisms; a symplectomorphism is aﬃne if it can be factorized

5.1.
Gromov’s theorem and symplectic capacities
53
as the product of a symplectic transformation (i.e., an element of Sp(2n, R)) and
a phase space translation. Both proofs are of an elementary nature (the second
is shorter, but slightly more conceptual; also see [67] §3.7.2 for a variant of this
proof).
Proposition 83. If there exists an aﬃne symplectomorphism φ in Rn ⊕Rn sending
a ball B(r) inside the cylinder Zj(R), then we must have r ≤R. Equivalently,
the intersection of φ(B(r)) by an aﬃne plane parallel to a plane of conjugate
coordinates xj, pj passing through the center of φ(B(r)) is an ellipse with area πr2.
First proof. It relies on the fact that the form pdx = 
j pjdxj is a relative integral
invariant of every symplectomorphism, that is: if φ is a symplectomorphism and
γ a cycle (or loop) in Rn ⊕Rn then

γ
pdx =

φ(γ)
pdx
(5.1)
(see for instance Arnol’d [3], §44, p. 239). It is of course no restriction to assume
that the ball B(r) is centered at the origin, and that φ is a symplectic transforma-
tion S. We claim that the ellipse Γj = S(B(r)) ∩Pj, intersection of the ellipsoid
S(B(r)) with any plane Pj of conjugate coordinates xj, pj has area πr2; the propo-
sition immediately follows from this property. Let γj be the curve bounding the
ellipse Γj and orient it positively; the area enclosed by γ is then
Area(Γj) =

γj
pjdxj =

γj
pdx
(5.2)
hence, using property (5.1),
Area(Γj) =

S−1(γj)
pdx = πr2
(5.3)
(because S−1(γ) is a big circle of B(r)); notice that the assumption that Pj is a
plane of conjugate coordinates xj, pj is essential for the second equality (5.2) to
hold, making use of formula (5.1) possible [more generally, the argument works
when Pj is replaced by any symplectic plane].
Second proof. With the same notation as above we note that the set
S−1 [S(B(r)) ∩Pj]
is a big circle of B(r), and hence encloses a surface with area πr2. Now, Pj is
a symplectic space when equipped with the skew-linear form σj = dpj ∧dxj
and the restriction of S to Pj is also canonical from (Pj, σj) to the symplectic
plane S(Pj) equipped with the restriction of the symplectic form σ. Canonical
transformations being volume- (here: area) preserving it follows that S(B(r))∩Pj
also has area πr2.
□

54
Chapter 5. Symplectic Capacities
It would certainly be interesting to generalize the ﬁrst proof to arbitrary
symplectomorphisms, thus yielding a new proof of Gromov’s theorem in the general
case, in fact, a reﬁnement of it! The diﬃculty comes from the following fact: the
key to the proof in the linear case is the fact that we were able to derive the
equality
	
γR
pjdxj = πR2
by exploiting the fact that the inverse image of the xj, pj plane by S was a plane
cutting B(R) along a big circle, which thus encloses an area equal to πR2. When
one replaces the linear transformation S by a non-linear one, the inverse image of
xj, pj plane will not generally be a plane, but rather a surface. It turns out that
this surface is not quite arbitrary: it is a symplectic 2-dimensional manifold. If the
following property holds:
The section of B(r) by any symplectic surface containing the center of
B(r) has an area at least πr2
then we would have, by the same argument,
	
γR
pjdxj ≥πR2,
hence we would have proved Gromov’s theorem in the general case. We do not
know any proof of this property; nor do we know whether it is true!
We urge the reader to notice that the assumption that we are cutting S(B(r))
with a plane of conjugate coordinates is essential, because it is this assumption that
allowed us to identify the area of the section with action. Here is a counterexample
which shows that the property does not hold for arbitrary sections of the ellipsoid
S(B(r)). Taking n = 2 we deﬁne a symplectic matrix
S =




λ1
0
0
0
0
λ2
0
0
0
0
1/λ1
0
0
0
0
1/λ2




,
where λ1 > 0, λ2 > 0, and λ1 ̸= λ2. The set S(B(r)) is deﬁned by
1
λ1
x2
1 + 1
λ2
x2
2 + λ1p2
1 + λ2p2
2 ≤r2
and its section with the x2, p2 plane is the ellipse
1
λ1
x2
1 + λ1p2
1 ≤r2
which has area πr2 as predicted, but its section with the x2, p1 plane is the ellipse
1
λ1
x2
1 + λ2p2
2 ≤R2
which has area π(r2
λ1/λ2) diﬀerent from πr2 since λ1 ̸= λ2.

5.2.
The notion of symplectic capacity
55
Why is Gromov’s theorem sometimes called “the principle of the symplec-
tic camel”? The reason is metaphoric: Gromov’s non-squeezing theorem can be
restated by saying that there is no way to deform a phase space ball using sym-
plectomorphisms in such a way that we can make it pass through a circular hole
in a plane of conjugate coordinates xj, pj if the area of that hole is smaller than
that of the cross-section of that ball: the biblical camel is the ball B(R) and the
hole in the plane is the eye of the needle!
5.2
The notion of symplectic capacity
Gromov’s non-squeezing theorem makes possible the deﬁnition of a very interesting
and useful topological notion, that of symplectic capacity, which was deﬁned by
Ekeland and Hofer [41]. We refer to Hofer and Zehnder [101], Polterovich [133] for
much more on the topic.
5.2.1
Deﬁnition and existence
The following deﬁnition is standard, and the most commonly accepted in the
literature:
Deﬁnition 84. A normalized symplectic capacity” on (Rn ⊕Rn, σ) is a function
assigning to every subset Ωof Rn ⊕Rn a number c(Ω) ≥0, or +∞, and having
the four properties (SC1)–(SC4) listed below:
(SC1) Symplectic invariance:
c(φ(Ω)) = c(Ω) if
φ ∈Symp(2n, R);
(5.4)
(SC2) Monotonicity:
c(Ω) ≤c(Ω′) if Ω⊂Ω′;
(5.5)
(SC3) Conformality:
c(λΩ) = λ2c(Ω) for λ ∈R;
(5.6)
(SC4) Normalization:
c(B(R)) = πR2 = c(Zj(R)).
(5.7)
Exercise 85. (i) Show that if condition (5.7) holds for one index j then it holds
for all. (ii) Show that the cylinder Zj(R) : x2
j + p2
j ≤R2 can be replaced by any
cylinder Zj(R) with radius R based on a symplectic plane.
We will also often consider the weaker notion of linear symplectic capacity:
Deﬁnition 86. A linear symplectic capacity assigns to every subset Ωof Rn ⊕Rn
a number clin(Ω) ≥0 or +∞, and having the properties (SC2)–(SC4) above,
property (SC1) being replaced by:

56
Chapter 5. Symplectic Capacities
(SC1Lin) A linear symplectic capacity clin is invariant under phase-space trans-
lations and under the action of Sp(2n, R).
This deﬁnition can be restated by saying that a linear symplectic capacity is
only invariant under the action of the aﬃne (or: inhomogeneous) symplectic group
ASp(2n, R):
clin(φ(Ω)) = c(Ω) for all φ ∈Asp(2n, R).
(5.8)
(Recall that Asp(2n, R) consists of all products ST (z) where S ∈Sp(2n, R) and
T (z) : z′ −→z′ + z is an arbitrary phase-space translation.)
Obviously symplectic capacities are unbounded (even if the symplectic ca-
pacity of an unbounded set can be bounded, cf. property (SC4). We have for
instance
c(Rn ⊕Rn) = clin(Rn ⊕Rn) = +∞
(5.9)
as immediately follows from the double equality c(B(R)) = clin(B(R)) = πR2.
However, if Ωis bounded then all its symplectic capacities are ﬁnite: there exists
R such that a ball B(R) contains Ω, and hence c(Ω) ≤c(B(R)) = πR2 in view
of the monotonicity property (SC2). More generally, it follows from properties
(SC2) and (SC4) that if B(R) ⊂Ω⊂Zj(R) then c(Ω) = πR2; this illustrates the
fact that sets very diﬀerent in shape and volume can have the same symplectic
capacity.
Also note that a set Ωwith non-empty interior cannot have symplectic ca-
pacity equal to zero: let Ω′ be the interior of Ω, it is an open set, and if it is not
empty it contains a (possibly) very small) ball B(ε). Using again (SC2) we have
πε2 = c(B(ε)) ≤c(Ω).
We will usually drop the qualiﬁcation “normalized” in the deﬁnition above
and just speak about “symplectic capacities”; one exception to this rule will be
the Ekeland–Hofer capacities discussed in de Gosson and Luef [77].
The reader is urged to keep in mind that the notion of symplectic capacity is
not directly related to that of volume. For instance, the function cVol deﬁned by
cVol(Ω) = [Vol(Ω)]1/n
obviously satisﬁes the properties (SC1)–(SC4) above except the second identity
(SC4): we have cVol(Zj(R)) ̸= πR2 as soon as n > 1; now the second identity
(SC4) is precisely the most characteristic and interesting property of a symplectic
capacity, because it is related to Gromov’s non-squeezing theorem.
There remains to prove the existence of symplectic capacities.
Proposition 87. Let Ω⊂Rn ⊕Rn and set
Rσ =
sup
φ∈Symp(2n,R)
{R : φ(B(R)) ⊂Ω}.
Set cmin(Ω) = πR2
σ if Rσ < ∞, cmin(Ω) = ∞if Rσ = ∞. Then cmin is a symplectic
capacity on the standard symplectic space (Rn ⊕Rn, σ).

5.2.
The notion of symplectic capacity
57
Proof. Let us prove the symplectic invariance property (SC1). Let φ∈Symp(2n,R)
and φ′ ∈Symp(2n, R) be such that g(B(R)) ⊂Ω; then (φ ◦φ′)(B(R)) ⊂φ(Ω) for
every φ ∈Symp(2n, R) hence cmin(φ(Ω)) ≥cmin(Ω). To prove the opposite inequal-
ity we note that replacing Ωby φ−1(Ω) leads to cmin(Ω)) ≥cmin(φ−1(Ω)); since
φ is arbitrary we have in fact cmin(Ω)) ≥cmin(φ(Ω)) for every φ ∈Symp(2n, R).
It follows that we have equality: cmin(φ(Ω)) = cmin(Ω). The monotonicity prop-
erty (SC2) is of course trivially veriﬁed because a symplectomorphism sending
B(R) in Ω′ also sends B(R) in any set Ω′ ⊃Ω. Let us prove the conformality
property (SC3). First note it trivially holds for λ = 0 so we may assume λ ̸= 0.
Let φ ∈Symp(2n, R) and deﬁne φλ by φλ(z) = λφ(λ−1z); it is clear that φλ ∈
Symp(2n, R). The condition φ(B(R)) ⊂Ωbeing equivalent to λ−1φλ(λB(R)) ⊂Ω,
that is to φλ(B(λR)) ⊂λΩ, it follows from the deﬁnition of cmin that cmin(λΩ) =
π(λRσ)2 = λ2cmin(Ω). Let us ﬁnally prove that the normalization conditions
(SC4) are satisﬁed by cmin. The equality cmin(B(R)) = πR2 is obvious: every
ball B(r) with R′ ≤R is sent into B(R) by the identity and if R′ ≥R there
exists no φ ∈Symp(2n, R) such that φ(B(R′)) ⊂B(R) because symplectomor-
phisms are volume-preserving. There remains to show that cmin(Zj(R)) = πR2.
If R′ ≤R then the identity sends B(R′) in Zj(R) hence cmin(Zj(R)) ≤πR2. As-
sume that cmin(Zj(R)) > πR2; then there exists a ball B(R′) with R′ > R and a
φ ∈Symp(2n, R) such that φ(B(R′)) ⊂Zj(R) and this would violate Gromov’s
theorem.
□
We urge the reader to note that in the proof of the fact that cmin indeed is a
symplectic capacity, we needed Gromov’s theorem only at the very last step, when
we wanted to prove that cmin(Zj(R)) = πR2.
Deﬁnition 88. The symplectic capacity cmin is called the Gromov width (or sym-
plectic width). The (possibly inﬁnite) number Rσ such that cmin(Ω) = πR2
σ is
called the symplectic radius of Ω.
The proof that the existence of symplectic capacities is actually equivalent
to Gromov’s theorem is proposed to the reader’s sagacity in the problem below:
Problem 89. Show that the existence of a single symplectic capacity proves Gro-
mov’s non-squeezing theorem.
Gromov’s non-squeezing theorem actually allows us to easily construct an-
other symplectic capacity cmax, distinct from cmin and there are thus inﬁnitely
many symplectic capacities because for every real λ in the closed interval [0, 1] the
formula
cλ = λcmax + (1 −λ)cmin
(5.10)
obviously deﬁnes a symplectic capacity, and we have cλ ̸= cλ′ if λ ̸= λ′. (More
generally, we can always interpolate two arbitrary symplectic capacities to obtain
new capacities). The symplectic capacity cmax is constructed as follows: suppose
that no matter how large we choose r there exists no symplectomorphism sending
Ωinside a cylinder Zj(r). We then set cmax(Ω) = +∞. Suppose that, on the

58
Chapter 5. Symplectic Capacities
contrary, there are symplectomorphisms sending Ωinside some cylinder Zj(r) and
let R be the inﬁmum of all such r. Thus, by deﬁnition,
cmax(Ω) = inf
φ {πr2 : φ(Ω) ⊂Zj(r)} = πR2
(5.11)
where φ again ranges over all the symplectomorphisms Rn ⊕Rn −→Rn ⊕Rn. We
leave it to the reader to verify, using again the non-squeezing theorem, that cmax
indeed is a symplectic capacity. As the notation suggests, we have:
Proposition 90. For every Ω⊂Rn ⊕Rn we have
cmin(Ω) ≤c(Ω) ≤cmax(Ω)
(5.12)
for every symplectic capacity c.
Proof. Suppose ﬁrst cmin(Ω) > c(Ω) and set c(Ω) = πR2; thus cmin(Ω) > πR2. It
follows, by deﬁnition of cmin, that there exists ε > 0 and a symplectomorphism φ
such that φ(B(R +ε)) ⊂Ω. But then, in view of the monotonicity property (SC2)
of c we have c(φ(B(R + ε))) ≤c(Ω), that is, in view of the symplectic invariance
property (SC1), c(B(R + ε)) ≤c(Ω). We thus have, taking (SC4) into account,
c(B(R + ε)) = π(R + ε)2 ≤c(Ω), and this contradicts c(Ω) = πR2. The proof of
the inequality c(Ω) ≤cmax(Ω) is similar; we leave the details to the reader.
□
Exercise 91. Prove the existence of a subset Ωof Rn ⊕Rn such that cmin(Ω) <
cmax(Ω).
The existence of linear symplectic capacities is proven exactly in the same
way as above. In fact, for Ω⊂Rn ⊕Rn set
clin
min(Ω) =
sup
φ∈ISp(2n,R)
{πR2 : φ(B(R)) ⊂Ω},
(5.13)
clin
max(Ω) =
inf
φ∈ISp(2n,R){πR2 : φ(Ω) ⊂Zj(R)};
(5.14)
it is immediate to show that clin
min and clin
max are linear symplectic capacities, which
can be interpreted as follows: for every Ω⊂Rn ⊕Rn the number clin
min(Ω) (which
can be inﬁnite) is the supremum of all the πR2 of phase space balls B(R) that
can be sent in Ωusing elements of ISp(2n, R); similarly clin
min(Ω) is the inﬁmum of
all πR2 such that a cylinder Zj(R) can contain the deformation of Ωby elements
of the inhomogeneous symplectic group ISp(2n, R) (the group generated by phase
space translations and the elements of Sp(2n, R)). We have moreover
clin
min(Ω) ≤clin(Ω) ≤clin
max(Ω)
(5.15)
for every Ω⊂Rn⊕Rn and every linear symplectic capacity clin; the proof is similar
to that of the inequalities (5.12).
The homogeneity property (SC2) satisﬁed by every symplectic capacity (lin-
ear or not) together with the fact that c(B(R)) = πR2 suggests that symplectic

5.2.
The notion of symplectic capacity
59
capacities have something to do with the notion of area. In fact, the following is
true: the symplectic capacity cmin(Ω) of a subset in the phase plane R2 is the area
of Ωwhen the latter is connected (Siburg [148]; also see the proof in Hofer and
Zehnder [101], §3.5, Theorem 4). Note that the result in general no longer holds
when Ωis disconnected: suppose for instance that Ωis the union of two disjoint
disks with radii R and R′ such that R′ < R. Then cmin(Ω) = πR2 < Area(Ω). The
symplectic capacity cmax(Ω) is the area when Ωis simply connected. Summarizing,
it follows from the inequalities (5.12) that:
Proposition 92. Let c be a symplectic capacity on the phase plane R2. We have
c(Ω) = Area(Ω) when Ωis a connected and simply connected surface.
The reader may easily convince himself that cmin(Ω) is not the area when Ω
is disconnected, and that cmax(Ω) is in general not the area when Ωfails to be
simply connected (a typical counterexample is the annulus r ≤x2 + p2 ≤R2).
5.2.2
The symplectic capacity of an ellipsoid
As the title of this subsection suggests, the symplectic capacity of an ellipsoid is
intrinsically attached to that ellipsoid, in the sense that it does not depend on the
choice of symplectic capacity. To prove this we will need the following symplectic
diagonalization theorem, which is very interesting by itself, and which we will
use several times in this book. It was proven by Williamson [162] in 1936, and has
been rediscovered many times since. It can be viewed as a partial result in the non-
trivial topic of classiﬁcation of quadratic forms. We are following the presentation
in Folland’s book [60] (Proposition 4.22); for an alternative proof using Lagrange
multipliers see Hofer and Zehnder [101], §1.7.
Theorem 93 (Williamson). Let M be a positive-deﬁnite symmetric real 2n × 2n
matrix.
There exists S ∈Sp(2n, R) such that
ST MS =
Λ
0
0
Λ

,
Λ diagonal,
(5.16)
the diagonal entries λj of Λ being deﬁned by the condition
±iλj is an eigenvalue of JM.
(5.17)
Proof. Let ⟨·, ·⟩M be the scalar product on C2n deﬁned by ⟨z, z′⟩M = ⟨Mz, z′⟩.
Since both ⟨·, ·⟩M and the symplectic form are non-degenerate we can ﬁnd a unique
invertible matrix K of order 2n such that
⟨z, Kz′⟩M = σ(z, z′)
for all z, z′; that matrix satisﬁes KT M = J = −MK. Since the σ is antisymmetric
we must have K = −KM where KM = −M −1KT M is the transpose of K with

60
Chapter 5. Symplectic Capacities
respect to ⟨·, ·⟩M; it follows that the eigenvalues of K = −M −1J are of the type
±iλj, λj > 0, and so are those of JM −1. The corresponding complex eigenvectors
occurring in conjugate pairs e′
j ± if ′
j, we thus obtain a ⟨·, ·⟩M-orthonormal basis
{e′
i, f ′
j}1≤i,j≤n of Rn ⊕Rn such that Ke′
i = λif ′
i and Kf ′
j = −λje′
j. Notice that
it follows from these relations that we have K2e′
i = −λ2
i e′
i and K2f ′
j = −λ2
jf ′
j and
that the vectors of the basis {e′
i, f ′
j}1≤i,j≤n satisfy the relations
σ(e′
i, e′
j) = ⟨e′
i, Ke′
j⟩M = λj⟨e′
i, f ′
j⟩M = 0,
σ(f ′
i, f ′
j) = ⟨f ′
i, Kf ′
j⟩M = −λj⟨f ′
i, e′
j⟩M = 0,
σ(f ′
i, e′
j) = ⟨f ′
i, Ke′
j⟩M = λi⟨f ′
i, f ′
j⟩M = −λiδij.
Setting ei = λ−1/2
i
e′
i and fj = λ−1/2
j
f ′
j, the basis {ei, fj}1≤i,j≤n is symplectic.
Let S be the element of Sp(2n, R) mapping the canonical symplectic basis to
{ei, fj}1≤i,j≤n. The ⟨·, ·⟩M-orthogonality of {ei, fj}1≤i,j≤n implies (5.16) with Λ =
diag(λ1, . . . , λn).
□
Williamson’s theorem allows us to calculate rather easily the symplectic ca-
pacity of an ellipsoid:
Proposition 94. Let W = {z : Mz2 ≤1} (M symmetric) be an ellipsoid in Rn⊕Rn
and let c be an arbitrary linear symplectic capacity on (Rn ⊕Rn, σ). Let λ1,σ ≥
λ2,σ ≥· · · ≥λn,σ be the decreasing sequence of the moduli of the eigenvalues ±iλ
of JM. We have
c(W) =
π
λ1,σ
= clin(W)
(5.18)
where clin is any linear symplectic capacity.
Proof. Let us choose S ∈Sp(2n, R) such that the matrix ST MS =
Λ
0
0
Λ

. The
set S−1(W) is thus the ellipsoid described by Λx2 + Λp2 ≤1, that is
n

j=1
λj,σ(x2
j + p2
j) ≤1.
(5.19)
Since c(S−1(W)) = c(W) in view of the symplectic invariance (SC1) of symplectic
capacities it is suﬃcient to assume that the ellipsoid W is represented by (5.19).
In view of the obvious double inequality
λ1,σ(x2
1 + p2
1) ≤
n

j=1
λj,σ(x2
j + p2
j) ≤λ1,σ
n

j=1
(x2
j + p2
j)
(5.20)
we have B(λ−1/2
1,σ ) ⊂W ⊂Z1(λ−1/2
1,σ ) hence, using the monotonicity property
(SC2) of symplectic capacities,
c(B(λ−1/2
1,σ )) ⊂c(W) ⊂(Z(λ−1/2
1,σ )).

5.3.
Other symplectic capacities
61
The equality c(W) = π/λ1,σ follows in view of the normalization conditions (SC4)
satisﬁed by any symplectic capacity; the formula clin(W) = π/λ1,σ follows as
well since we have put the ellipsoid W in the form (5.19) using only a linear
symplectomorphism.
□
5.3
Other symplectic capacities
In this section we brieﬂy review two interesting symplectic capacities which cannot
be directly deduced from Gromov’s non-squeezing theorem, and which can thus
be used to derive this theorem (cf. Problem 89). The ﬁrst example, the Hofer–
Zehnder capacity, is normalized (in the sense of (SC4)), while the second example
provides us with a whole family of non-normalized symplectic capacities.
5.3.1
The Hofer–Zehnder capacity
We mentioned at the beginning of this chapter that the notion of symplectic
capacity can be viewed as a generalization of the notion of action. This is most
easily seen by using the Hofer–Zehnder capacity. In [101] (Chapter 3) Hofer and
Zehnder construct a symplectic capacity cHZ which measures sets in a dynamical
way. It is deﬁned as follows. Let Ωbe an open set in Rn⊕Rn and consider the class
H(Ω) of all Hamiltonian functions H ≥0 having the following three properties:
• H vanishes outside Ω(and is hence bounded);
• The critical values of H are 0 and max H;
• The ﬂow (φH
t ) has no constant periodic orbit with period T ≤1.
Then, by deﬁnition,
cHZ(Ω) = sup{max H : H ∈H(Ω)}.
(5.21)
To prove that cHZ satisﬁes the properties (SC1)–(SC4) is not straightforward;
the proof uses several tricks from the theory of Hamiltonian systems. However, it
does not rely on Gromov’s theorem, and thus provides an alternative proof of
this result (cf. Problem 89). The Hofer–Zehnder capacity has the property that
whenever Ωis a compact convex set in phase space then
cHZ(Ω) =

γmin
pdx
(5.22)
where pdx = p1dx1 + · · · + pndxn and γmin is the shortest (positively oriented)
Hamiltonian periodic orbit carried by the boundary ∂Ωof Ω. (For (5.22) the
condition that Ωbe compact and convex is essential (see Hofer and Zehnder’s
very illustrative “Bordeaux bottle” example in [101], p. 99).
Notice that this formula generalizes the observation made earlier in this sec-
tion that symplectic capacities agree with the usual notion of area in the case

62
Chapter 5. Symplectic Capacities
n = 1 for connected and simply connected surfaces. In fact, let Ωbe such a sur-
face in the phase plane, and assume that the boundary γ = ∂Ωis smooth, and
given the positive orientation. We then have, by Stoke’s theorem,
Area(Ω) = 1
2

γ
(pdx −xdp) =

γ
pdx.
Formula (5.22) in particular implies the inequalities
cmin(Ω) ≤cHZ(Ω) ≤


γ
pdx

(5.23)
for every periodic orbit γ on ∂Ω.
5.3.2
The Ekeland–Hofer capacities
The normalized symplectic capacities we have been using so far do not gen-
erally allow us to distinguish between ellipsoids: formula (5.18) implies that if
ΩM : Mz2 ≤1 and ΩM′ : M ′z2 ≤1 are such that M and M ′ have the same small-
est symplectic eigenvalue, then c(ΩM) = c(ΩM′). This can however be achieved
by introducing a slightly more general notion of symplectic capacity. To do this
we slightly relax the normalization condition (SC4) for symplectic capacities and
replace it with the weaker requirement:
(SC4bis) c(B2n(R)) > 0 and c(Zj(R)) < ∞.
In [41, 42] Ekeland and Hofer construct a sequence of generalized symplectic
capacities cEH
k
having the following properties:
(EH1) The sequence (cEH
k )k≥1 is increasing:
cEH
1 (Ω) ≤cEH
2 (Ω) ≤· · · ≤cEH
k (Ω) ≤· · ·
(5.24)
for all Ω⊂Rn ⊕Rn;
(EH2) If Ωis convex with boundary ∂Ω, then
cEH
k (Ω) = cEH
k (∂Ω)
(5.25)
(hence cEH
k (Ω) is determined by the boundary ∂Ω);
(EH3) If Ωis convex, then
cEH
1 (Ω) = cHZ(Ω) and cEH
k (Ω) =

γ
pdx
(5.26)
where γ is a periodic Hamiltonian orbit carried by ∂Ω.

5.3.
Other symplectic capacities
63
The values of the capacities cEH
k
on balls and cylinders are given by the
formulas
cEH
k (B2n(r)) =
k + n −1
n

πr2,
(5.27)
cEH
k (Z2n
j (r)) = πr2;
(5.28)
in the ﬁrst formula [x] is the integer part of x ∈R.
The Ekeland–Hofer capacities cEH
k
allow us to classify phase-space ellip-
soids. In fact, it readily follows from their properties (EH1) and (EH3) that
the non-decreasing sequence of numbers cEH
k (ΩM) is determined as follows: if
Specσ(M) = (λσ
1 , . . . , λσ
n) write the numbers kπ/λσ
1 in increasing order with repe-
tition if a number occurs several times; we thus obtain a sequence c1 ≤c2 ≤· · ·
and we have
cEH
k (ΩM) = ck.
(5.29)
That the Ekeland–Hofer capacities cEH
k
can be used to distinguish between ellip-
soids follows from:
Proposition 95. An ellipsoid ΩM : Mz2 ≤1 is uniquely determined (up to a sym-
plectic transformation) by the sequence of its Ekeland–Hofer capacities cEH
k (ΩM).
Proof. Suppose that ΩM and ΩM′ are two ellipsoids with λσ
j = λ′σ
j for 1 ≤j < k
and λσ
k > λ′σ
k . Then the multiplicity of λσ
k in the sequence of Ekeland–Hofer
capacities is one higher for ΩM than for ΩM′ hence not all of these capacities
agree on ΩM and ΩM′.
□

Chapter 6
Uncertainty Principles
Since the aim of the ﬁrst part of this book is to discuss classical mechanics from
the symplectic point of view, some readers might be a little surprised by the title
of the present chapter because it has a certain quantum-mechanical connotation.
In fact “uncertainty principles” are mostly studied within the realm of quantum
mechanics, even if the study of uncertainties is also a part of classical statistical
mechanics. However, as we have shown in our paper [72], the formalism of the
uncertainty principle is actually not as “quantum” as it may seem, but appears
in classical mechanics if one uses the notion of symplectic capacity. Even if every-
thing we will do is “classical”, in the sense that we do not invoke any quantum
mechanical properties, we will however make use of the notation ℏas if we were
“doing quantum mechanics”; the reader who feels uncomfortable with this irrup-
tion of a quantum-mechanical constant can view ℏas a parameter measuring some
indeterminacy in classical measurement processes.
The textbook uncertainty principle of quantum mechanics is usually stated in
the form ∆xj∆pj ≥1
2ℏ(the “Heisenberg inequalities”). It is unfortunate that even
in many otherwise excellent mathematical texts it is only this weak form of the
uncertainty principle that is studied. In fact, to limit ourselves to the Heisenberg
inequalities has many disadvantages, the most obvious being that these inequal-
ities are not preserved by linear transformations (except trivial ones). A better
formulation consists in using the Robertson [137] and Schr¨odinger [142] inequali-
ties
(∆Xα)2(∆Pα)2 ≥∆(Xα, Pα)2 + 1
4ℏ2 , 1 ≤α ≤n
(6.1)
which we will express in the form
c(WΣ) ≥1
2h
(6.2)
where WΣ is a certain ellipsoid and c a symplectic capacity. We will be following
rather closely the exposition in our review paper de Gosson and Luef [77].
65
M.A. de Gosson, Symplectic Methods in Harmonic Analysis and in Mathematical Physics,  
Pseudo-Differential Operators 7, DOI 10.1007/978-3-7643-9992-4_ , © Springer Basel AG 2011 
6

66
Chapter 6. Uncertainty Principles
6.1
The Robertson–Schr¨odinger inequalities
The Robertson–Schr¨odinger uncertainty principle is a strong version of the Heisen-
berg inequalities ∆xj∆pj ≥1
2ℏ, to which it reduces when one neglects the contri-
butions due to the covariances.
6.1.1
The covariance matrix
In what follows ρ is a real-valued function deﬁned on Rn ⊕Rn satisfying the
normalization condition
	
R2n ρ(z)dz = 1
(6.3)
and such that
	
R2n(1 + |z|2)|ρ(z)|dz < ∞.
(6.4)
We do not assume that ρ ≥0 so ρ is not in general a true probability density.
(Having later applications to quantum mechanics in mind, ρ will typically be
the Wigner transform of a mixed quantum state.) We will call such a function
ρ a “quasi-distribution”, and work with it exactly as we would with an ordinary
probability density.
Exercise 96. Show that condition (6.4) implies that the Fourier transform Fρ is
twice continuously diﬀerentiable.
Let us introduce the following notation: we set zα = xα if 1 ≤α ≤n and
zα = pα−n if n + 1 ≤α ≤2n.
We deﬁne the covariances and variances associated with ρ in the usual way
by the formulas
∆(Zα, Zβ) =
	
R2n(zα −⟨zα⟩)(zβ −⟨zβ⟩)ρ(z)dz
(6.5)
and
(∆Zα)2 = ∆(Zα, Zα) =
	
R2n(zα −⟨zα⟩)2ρ(z)dz.
(6.6)
In the formulas above the moments ⟨zk
α⟩, k = 1, 2, are the averages with respect
to ρ of the corresponding functions:
⟨zk
α⟩=
	
R2n zk
αρ(z)dz.
(6.7)
These moments are of course well deﬁned in view of condition (6.4).
Let Z1, Z2, . . . , Z2n be random variables on Rn ⊕Rn whose values are the
phase-space coordinates z1, z2, . . . , zn. Since the integral of ρ is equal to 1, formulae

6.1.
The Robertson–Schr¨odinger inequalities
67
(6.5) and 6.6) can be rewritten in the familiar form
∆(Zα, Zβ) = ⟨zαzβ⟩−⟨zα⟩⟨zβ⟩,
(6.8)
(∆Zα)2 = ∆(Zα, Zα) = ⟨z2
α⟩−⟨zα⟩2.
(6.9)
The quantities (6.5), (6.6), and (6.7) are well deﬁned in view of condition (6.4):
the integrals above are all absolutely convergent in view of the trivial estimates

	
R2n zαρ(z)dz
 ≤
	
R2n(1 + |z|2)|ρ(z)|dz < ∞,

	
R2n zαzβρ(z)dz
 ≤
	
R2n(1 + |z|2)|ρ(z)|dz < ∞.
Deﬁnition 97. We will call the symmetric 2n × 2n matrix
Σ = [∆(Zα, Zβ)]1≤α,β≤2n
the covariance matrix associated with ρ. When det Σ ̸= 0 the inverse Σ−1 is called
the precision (or information) matrix.
For instance, when n = 1, the covariance matrix is
Σ =

∆X2
∆(X, P)
∆(P, X)
∆P 2

where the quantities ∆X2 and ∆(X, P) are deﬁned by
∆X2 = ⟨x2⟩−⟨x⟩2 , ∆P 2 = ⟨p2⟩−⟨p⟩2,
∆(X, P) = ⟨xp⟩−⟨x⟩⟨p⟩.
6.1.2
A strong version of the Robertson–Schr¨odinger
uncertainty principle
The following result is essential. The ﬁrst statement (i) was apparently ﬁrst noted
in Narcowich [128] (Lemma 2.3), and part (ii) goes back to Narcowich [126], Nar-
cowich and O’Connell [129], and Yuen [167]. The third part (iii) is a way of ex-
pressing the symplectic covariance of the uncertainty principle.
Theorem 98. Let Σ be a real symmetric 2n×2n matrix and ℏa real number. Then
Σ+ iℏ
2 J is a Hermitian matrix. Suppose that there exists a real number ℏ̸= 0 such
that Σ + iℏ
2 J ≥0. Then:
(i) The matrix Σ must be positive deﬁnite and we have Σ + iℏ′
2 J ≥0 for every
ℏ′ ≤ℏ;
(ii) The inequalities
(∆Xα)2(∆Pα)2 ≥∆(Xα, Pα)2 + 1
4ℏ2
(6.10)
hold for 1 ≤α ≤n;

68
Chapter 6. Uncertainty Principles
(iii) Let S ∈Sp(2n, R) and deﬁne (XS
α, P S
α ) = S(Xα, Pα). Then
(∆XS
α)2(∆P S
α )2 ≥∆(XS
α, P S
α )2 + 1
4ℏ2.
(6.11)
Proof. We begin by noting that the matrix Σ+ iℏ
2 J is Hermitian because Σ is real
symmetric and (iJ)∗= (−i)(−J) = iJ.
Proof of (i). Let us begin by showing that Σ is non-negative. Suppose indeed that
Σ has a negative eigenvalue λ, and let zλ be a real eigenvector corresponding to
λ (such an eigenvector exists because Σ is real and symmetric). Since zT
λ Jzλ = 0
we have
zT
λ

Σ + iℏ
2 J

zλ = zT
λ Σzλ = λ|zλ|2 < 0
which contradicts the assumption Σ + iℏ
2 J ≥0. We next show that 0 cannot be
an eigenvalue of Σ; this will prove the statement. Suppose indeed that 0 is an
eigenvalue, and let z0 be a real eigenvector. For ε > 0 set z(ε) = (I +iεJ)z0. Using
the relations Σz0 = 0, zT
0 Σ = 0, and zT
0 Jz0 = σ(z0, z0) = 0 we get, after a few
calculations,
z(ε)T

Σ + iℏ
2 J

z(ε) = ε1
2ℏ|z0|2 + ε2(Jz0)T Σ(Jz0).
Choose now ε opposite in sign to 1
2ℏ; then ε 1
2ℏ|z0|2 < 0 and if |ε| is small enough
we have z(ε)T (Σ + iℏ
2 J)z(ε) < 0, which contradicts the fact that Σ + iℏ
2 J ≥0. To
show that Σ + iℏ′
2 J ≥0 for every ℏ′ ≤ℏit suﬃces to set ℏ′ = rℏwith 0 < r ≤1
and to note that
Σ + iℏ′
2 J = (1 −r)Σ + r

Σ + iℏ
2 J

≥0
because (1 −r)Σ ≥0 and Σ + iℏ
2 J ≥0.
Proof of (ii). The non-negativity of the Hermitian matrix Σ+ iℏ
2 J can be expressed
in terms of the submatrices
Σα =

(∆Xα)2
∆(Xα, Pα) + iℏ
2
∆(Pα, Xα) −iℏ
2
(∆Pα)2

which are non-negative provided that Σ + iℏ
2 J is. Since
Tr(Σα) = (∆Xα)2 + (∆Pα)2 ≥0
we have Σα ≥0 if and only if
det Σα = (∆Xα)2(∆Pα)2 −∆(Xα, Pα)2 −1
4ℏ2 ≥0
which is equivalent to the inequality (6.10).

6.1.
The Robertson–Schr¨odinger inequalities
69
Proof of (iii). Set ΣS = ST ΣS; it is the covariance matrix of the vector
(XS
1 , . . . , XS
n ; P S
1 , . . . , P S
n ) = S(X1, . . . , Xn; P1, . . . , Pn).
Since S is symplectic we have ST JS = J and hence
ΣS + iℏ
2 J = ST (Σ + iℏ
2 J)S ≥0;
the inequalities (6.11) now follow from the inequalities (6.10).
□
At this point it is appropriate to notice that (except in the case n = 1) the
condition Σ + iℏ
2 J ≥0 is not equivalent to the uncertainty inequalities (6.10); it
is in fact a stronger condition. It is actually easy to see why we have equivalence
when n = 1: the covariance matrix is just
Σ =

∆X2
∆(X, P)
∆(P, X)
∆P 2

and since
Tr

Σ + iℏ
2 J

= ∆X2 + ∆P 2 ≥0
the condition Σ + iℏ
2 J ≥0 is equivalent to det

Σ + iℏ
2 J

≥0, that is to
∆X2∆P 2 −

∆(X, P)2 + 1
4ℏ2

≥0
which is precisely (6.10) in the case n = 1. That this equivalence between Σ +
iℏ
2 J ≥0 and (6.10) is not true in higher dimensions is easily seen on the following
counterexample. Take n = 2 and 1
2ℏ= 1 and deﬁne a covariance matrix by
Σ =




1
−1
0
0
−1
1
0
0
0
0
1
0
0
0
0
1



.
(6.12)
We thus have (∆X1)2 = (∆X2)2 = 1 and (∆P1)2 = (∆P2)2 = 1, and also
∆(X1, P1) = ∆(X2, P2) = 0 so that the inequalities (6.10) are trivially satisﬁed
(they are in fact equalities). The matrix Σ + iJ is nevertheless indeﬁnite.
Exercise 99. Verify the indeﬁniteness of the 4 × 4 covariance matrix (6.12).
Let us introduce the following terminology:
Deﬁnition 100. Let Σ be a covariance matrix. The phase space ellipsoid
WΣ = {z ∈R2n : 1
2Σ−1z2 ≤1}

70
Chapter 6. Uncertainty Principles
is called the “Wigner ellipsoid” associated with Σ. The dual ellipsoid
W∗
Σ = {z ∈R2n : 1
2Σz2 ≤1}
of the Wigner ellipsoid is called the “precision (or information) ellipsoid” (cf.
Deﬁnition 97).
We will see in a while that the strong uncertainty principle in the form
Σ + iℏ
2 J ≥0 can be expressed in terms of the notion of symplectic capacity. But
we ﬁrst have to introduce some material from symplectic topology.
6.1.3
Symplectic capacity and the strong uncertainty principle
We are now going to give an application of the notion of symplectic capacity to the
strong uncertainty principle discussed in the beginning of this chapter. Another
application will be given in Chapter 6.2 when we discuss Hardy’s inequalities.
Let us return to the uncertainty principle in its strong Robertson–Schr¨odinger
form Σ + iℏ
2 J ≥0. The following geometric result is the key to our formulation in
terms of symplectic capacities:
Proposition 101. Let Σ be a positive-deﬁnite real 2n × 2n matrix. The three fol-
lowing conditions are equivalent:
(i) The Hermitian matrix Σ + iℏ
2 J is non-negative.
(ii) The symplectic capacity of the Wigner ellipsoid
WΣ = {z : 1
2Σ−1z2 ≤1}
is such that
c(WΣ) ≥πℏ= 1
2h.
(6.13)
(iii) The symplectic capacity of the dual ellipsoid
W∗
Σ = {z : 1
2Σz2 ≤1}
is such that
c(W∗
Σ) ≤2π
ℏ= 4π2
h .
(6.14)
Proof. Setting M = 1
2Σ−1 the Wigner ellipsoid is the set of all z ∈R2n such that
Mz2 ≤1 and the condition Σ + iℏ
2 J ≥0 is equivalent to 1
2M −1 + iℏ
2 J ≥0; using
a symplectic diagonalization of M this is equivalent to 1
2D−1 + iℏ
2 J ≥0 where
D =
Λσ
0
0
Λσ

, Λσ = diag(λσ
1, . . . , λσ
n).
It follows that the characteristic polynomial of 1
2M −1 + iℏ
2 J is the product P(t) =
P1(t) · · · Pn(t) where
Pα(t) = t2 −(λσ
α)−1t + 1
4(λσ
α)−2 −1
4ℏ2.

6.2.
Hardy’s uncertainty principle
71
The eigenvalues of the matrix 1
2M −1+ iℏ
2 J are thus the real numbers 1
2[(λσ
j )−1±ℏ]
hence that matrix is non-negative if and only if λσ
j ≤1
2( 1
2ℏ)−1 for every j, that is
if and only if λσ
max ≤1
2( 1
2ℏ)−1; this is equivalent to
c(WΣ) = π/λσ
max ≥2π · 1
2ℏ|
and to
c(W∗
Σ) = 2πλσ
min ≤π/
 1
2ℏ

in view of the discussion above; this proves the inequalities (6.13) and (6.14).
□
When Σ is a covariance matrix, the condition c(WΣ) ≥1
2h thus implies (but
is not equivalent to) the Robertson–Schr¨odinger uncertainty inequalities (6.10),
that is we have
(∆Xα)2(∆Pα)2 ≥∆(Xα, Pα)2 + 1
4ℏ2
for 1 ≤α ≤n.
We have conjectured in [72] and [77] that the condition c(WΣ) ≥1
2h might
well be the “true” uncertainty principle to be used both in classical and quantum
mechanics under certain conditions that we do not discuss here. A rather obvious
advantage in using this symplectic formulation is that if c(WΣ) ≥1
2h then we also
have c(f(WΣ)) ≥1
2h when f is an arbitrary symplectomorphism of (Rn ⊕Rn, σ)
(this because of the symplectic invariance property (SC1) of symplectic capacities),
so that the uncertainty principle expressed in this form is de facto symplectically
invariant (which is not true of the Schr¨odinger–Robertson inequalities which only
retain their form under linear symplectic transformations).
6.2
Hardy’s uncertainty principle
In this section we give another application of the notion of symplectic capacity.
A folk metatheorem is that a function ψ and its Fourier transform Fψ cannot
be simultaneously sharply localized. An obvious manifestation of this “principle”
is when ψ is of compact support: in this case the Fourier transform Fψ can be
extended into an entire function, and is hence never of compact support. A less
trivial way to express this kind of trade-oﬀbetween ψ and Fψ was discovered in
1933 by G.H. Hardy [98]. Hardy showed, using the Phragm´en–Lindel¨of principle
from complex analysis, that if a function ψ ∈L2(R) and its Fourier transform
Fψ(p) =
1
√
2πℏ
	 ∞
−∞
e−i
ℏpxψ(x)dx
satisfy, for |x| + |p| →∞, estimates of the type
ψ(x) = O

e−a
2ℏx2
, Fψ(p) = O

e−b
2ℏp2
(6.15)
with a, b > 0, then the following holds true:

72
Chapter 6. Uncertainty Principles
• If ab > 1 then ψ = 0;
• If ab = 1 we have ψ(x) = Ce−a
2ℏx2 for some complex constant C;
• If ab < 1 there exists a whole space of S solutions, containing the functions
ψ(x) = Q(x)e−a
2ℏx2 where Q is a polynomial (equivalently, S contains the
ﬁnite linear combinations of Hermite polynomials).
In this section we will generalize Hardy’s uncertainty principle to an arbitrary
number of dimensions. We will thereafter reformulate it in terms of the notion of
symplectic capacity previously introduced.
6.2.1
Two useful lemmas
The following result, although being of an elementary nature, is very useful. We
will see that it is a reﬁned version of Williamson’s diagonalization theorem [162]
in the block-diagonal case.
We make the preliminary observation that if A and B are positive deﬁnite
matrices then the eigenvalues of AB are real because AB has the same eigenvalues
as the symmetric matrix A1/2BA1/2. The following result shows that A and B can
be simultaneously diagonalized in a particular way:
Lemma 102. Let A and B be two positive-deﬁnite n×n real matrices. There exists
L ∈GL(n, R) such that
LT AL = L−1B(LT )−1 = Λ
(6.16)
where Λ = diag(√λ1, . . . , √λn) is the diagonal matrix whose eigenvalues are the
square roots of the eigenvalues λ1, . . . , λn of AB.
Proof. We claim that there exists R ∈GL(n, R) such that
RT AR = I and R−1B(RT )−1 = D
(6.17)
where D = diag(λ1, . . . , λn). In fact, ﬁrst choose P ∈GL(n, R) such that P T AP =
I and set B−1
1
= P T B−1P. Since B−1
1
is symmetric, there exists H ∈O(n, R)
such that B−1
1
= HT D−1H where D−1 is diagonal. Set now R = PHT ; we have
RTAR = I and also
R−1B(RT )−1 = HP −1B(P T )−1HT = HB1HT = D
hence the equalities (6.17). Let Λ = diag(√λ1, . . . , √λn). Since
RT AB(RT )−1 = RT AR(R−1B(RT )−1) = D
the diagonal elements of D are indeed the eigenvalues of AB hence D = Λ2. Setting
L = RΛ1/2 we have
LT AL = Λ1/2RT ARΛ1/2 = Λ,
L−1B(L−1)T = Λ−1/2R−1B(RT )−1Λ−1/2 = Λ
hence our claim.
□

6.2.
Hardy’s uncertainty principle
73
The result above is a precise statement of a classical theorem of Williamson
[162] in the block-diagonal case. That theorem says that every positive-deﬁnite
symmetric matrix can be diagonalized using symplectic matrices. More precisely:
let M be a positive deﬁnite real 2n×2n matrix; the eigenvalues of JM are those of
the antisymmetric matrix M 1/2JM 1/2 and are thus of the type ±iλσ
j with λσ
j > 0.
We have the following result, which relates Lemma 102 to Williamson’s the-
orem:
Lemma 103. Let A, B > 0. The symplectic spectrum (λσ
1, . . . , λσ
n) of M =
A
0
0
B

consists of the decreasing sequence √λ1 ≥· · · ≥√λn of square roots of the
eigenvalues λj of AB.
Proof. Let (λσ
1, . . . , λσ
n) be the symplectic spectrum of M. The λσ
j are the eigen-
values of
JM =
 0
B
−A
0

;
they are thus the moduli of the zeroes of the polynomial
P(t) = det(t2I + AB) = det(t2I + D)
where D = diag(λ1, . . . , λn); these zeroes are the numbers ±i

λj, j = 1, . . . , n;
the result follows.
□
Recall that when L is invertible the matrix
ML =
L−1
0
0
LT

(6.18)
is in Sp(2n, R). Lemma 102 can be restated by saying that if (A, B) is a pair of
symmetric positive deﬁnite matrices then there exists L such that

A
0
0
B

= MLT

Λ
0
0
Λ

ML.
(6.19)
This lemma is thus a precise version of Williamson’s theorem for block-diagonal
positive matrices: it is not at all obvious from the statement of Williamson’s the-
orem that

A
0
0
B

can be diagonalized using only a block-diagonal symplectic
matrix!
Lemma 102 allows us to give a simple proof of a multi-dimensional version
of this theorem. The following elementary remark will be useful:
Lemma 104. Let n > 1. For 1 ≤j ≤n let fj be a function of (x1, . . . , xj, . . . , xn) ∈
Rn−1 (the tildesuppressing the term it covers), and gj a function of xj ∈R. If
h = f1 ⊗g1 = · · · = fn ⊗gn
then there exists a constant C such that h = C(g1 ⊗· · · ⊗gn).

74
Chapter 6. Uncertainty Principles
Proof. Assume that n = 2; then
h(x1, x2) = f1(x2)g1(x1) = f2(x1)g2(x2).
If g1(x1)g2(x2) ̸= 0 then
f1(x2)/g2(x2) = f2(x1)/g1(x1) = C
hence f1(x2) = Cg2(x2) and h(x1, x2) = Cg1(x1)g2(x2). If g1(x1)g2(x2) = 0 then
h(x1, x2) = 0 hence h(x1, x2) = Cg1(x1)g2(x2) in all cases. The general case follows
by induction on the dimension n: suppose that
h = f1 ⊗g1 = · · · = fn ⊗gn = fn+1 ⊗gn+1;
for ﬁxed xn+1 the function k = f1 ⊗g1 = · · · = fn ⊗gn is given by
k(x, xn+1) = C(xn+1)g1(x1) · · · gn(xn).
Since we also have
k(x, xn+1) = fn+1(x1, . . . , xn)gn+1(xn+1)
it follows that C(xn+1) = C.
□
6.2.2
Proof of the multi-dimensional Hardy uncertainty principle
We are going the use the lemmas above to prove the following extension of Hardy’s
uncertainty principle:
Theorem 105. Let A and B be two real positive deﬁnite matrices and ψ ∈L2(Rn),
ψ ̸= 0. Assume that
|ψ(x)| ≤CAe−1
2ℏAx2
and |Fψ(p)| ≤CBe−1
2ℏBp2
(6.20)
for some constants CA, CB > 0. Then:
(i) The eigenvalues λj, j = 1, . . . , n, of the matrix AB are all ≤1;
(ii) If λj = 1 for all j, then ψ(x) = Ce−1
2ℏAx2 for some some complex constant
C;
(iii) If λj < 1 for some j then the space of functions satisfying (6.20) contains
every ψ(x) = Q(x)e−1
2ℏAx2 where Q is a complex polynomial.
Proof. It is of course no restriction to assume that CA = CB = C. Let L be as in
Lemma 102 and order the eigenvalues of AB decreasingly: λ1 ≥λ2 ≥· · · ≥λn. It
suﬃces to show that λ1 ≤1. Setting ψL(x) = ψ(Lx) we have
FψL(p) = Fψ((LT )−1p);

6.2.
Hardy’s uncertainty principle
75
in view of (6.16) in Lemma 102 condition (6.20) is equivalent to
|ψL(x)| ≤Ce−1
2ℏΛx2 and |FψL(p)| ≤Ce−1
2ℏΛp2
(6.21)
where Λ = diag(λ1, λ2, . . . , λn). Setting ψL,1(x1) = ψL(x1, 0, . . . , 0) we have
|ψL,1(x1)| ≤Ce−1
2ℏλ1x2
1.
(6.22)
On the other hand, by the Fourier inversion formula,
	
FψL(p)dp2 · · · dpn = (2πℏ)n/2
	
· · ·
	
Rne−i
ℏp·xψL(x)dxdp2 · · · dpn
= (2πℏ)(n−1)/2FψL,1(p1)
and hence we have the inequality
|FψL,1(p1)| ≤CL,1e−1
2ℏλ1p2
1
(6.23)
for some constant CL,1 > 0. Applying Hardy’s uncertainty principle in one di-
mension to the inequalities (6.22) and (6.23) we must have λ2
1 ≤1 hence the
assertion (i).
Proof of (ii). The condition λj = 1 for all j means that
|ψL(x)| ≤Ce−1
2ℏx2 and |FψL(p)| ≤Ce−1
2ℏp2
(6.24)
for some C > 0. Let us keep x′ = (x2, . . . , xn) constant; the partial Fourier trans-
form of ψL in the x1 variable is F1ψL = (F ′)−1FψL where (F ′)−1 is the inverse
Fourier transform in the x′ variables, hence there exists C′ > 0 such that
|F1ψL(x1, x′)| ≤

1
2πℏ
 n−1
2
	
|FψL(p)|dp2 · · · dpn ≤C′e−1
2ℏp2
1.
Since |ψL(x)| ≤C(x′)e−1
2ℏx2
1 with C(x′) ≤e−1
2ℏx′2 it follows from Hardy’s theorem
that we can write
ψL(x) = f1(x′)e−1
2ℏx2
1
for some real C∞function f1 on Rn−1. Applying the same argument to the re-
maining variables x2, . . . , xn we conclude that there exist C∞functions fj for
j = 2, . . . , n, such that
ψL(x) = fj(x1, . . . , xj, . . . , xn)e−1
2ℏx2
1.
(6.25)
In view of Lemma 104 above we have ψL(x) = CLe−1
2ℏx2 for some constant CL;
since Λ = I = LT AL we thus have ψ(x) = CLe−Ax2/2ℏas claimed.
Proof of (iii). Assume that λ1 < 1 for j ∈J , J a subset of {1, . . . , n}. By the
same argument as in the proof of part (ii) establishing formula (6.25), we infer,
using Hardy’s theorem in the case ab < 1, that
ψL(x) = fj(x1, . . . , xj, . . . , xn)Qj(xj)e−1
2ℏx2
j

76
Chapter 6. Uncertainty Principles
where Qj is a polynomial with degree 0 if j /∈J . One concludes the proof using
once again Lemma 104.
□
6.2.3
Geometric interpretation
Let us give a geometric interpretation of Theorem 105 in terms of the notion
of symplectic capacity. We begin by making an obvious observation: Hardy’s
uncertainty principle can be restated by saying that if ψ ̸= 0 then the con-
ditions ψ(x) = O(e−1
2ℏax2) and
Fψ(p) = O(e−1
2ℏbp2) imply that the ellipse
W : ax2 + bp2 ≤ℏhas area πℏ/
√
ab ≥πℏ= 1
2h:
Area(W) ≥1/2h.
More precisely:
If the area of the ellipse W is smaller than 1
2h then ψ = 0; if this area
equals
1
2h then ψ(x) = Ce−1
2ℏax2 and if it is larger than
1
2h then the
functions ψ(x) = Q(x)e−1
2ℏax2, Q a polynomial, belong to the set of
functions satisfying Area(W) > 1
2h.
We can restate Hardy’s theorem in a very simple geometric way in terms of
the symplectic capacity (not the volume!) of an ellipsoid. Recall that all symplectic
capacities agree on phase space ellipsoids in view of Proposition 94. Recall that
πℏ= 1
2h.
Proposition 106. Let ψ ∈L2(Rn), ψ ̸= 0. Assume that there exist constants CA >
0 and CB > 0 such that
|ψ(x)| ≤CAe−1
2ℏAx2
and |Fψ(p)| ≤CBe−1
2ℏBp2.
(6.26)
Then the symplectic capacity of the ellipsoid
W = {(x, p) : Ax2 + Bp2 ≤ℏ}
is such that c(W) ≥1
2h.
Proof of (i). Setting M =

A
0
0
B

the equation of W is Mz2 ≤ℏ. In view of
formula (5.18) in Proposition 94 together with the conformality property of sym-
plectic capacities we have c(W) = πℏ/λσ
1 where λσ
1 is the smallest of all numbers
λ such that ±iλ is an eigenvalue of JM. In view of Lemma 103 λσ
j =

λj where
the λj are the eigenvalues of AB, and by Theorem 105 we must have λj ≤1; the
result follows since πℏ= 1
2h.
□
The result above thus shows that Hardy’s uncertainty principle has an im-
portant (and unexpected) geometrical meaning. It will be generalized later on in
this book when we discuss the Wigner formalism.

Part II
Harmonic Analysis in
Symplectic Spaces

Chapter 7
The Metaplectic Group
The metaplectic group is a unitary representation of the double cover of the sym-
plectic group; it plays an essential role in Weyl pseudodiﬀerential calculus, because
it appears as a characteristic group of symmetries for Weyl operators. In fact –
and this fact seems to be largely ignored in the literature – this property (called
“symplectic covariance”) actually is characteristic (in a sense that will be made
precise) of Weyl calculus. Metaplectic operators of course have many other appli-
cations; they allow us, for instance, to give explicit solutions to the time-dependent
Schr¨odinger equation with quadratic Hamiltonian, as will be shown later, but they
are also used with proﬁt in optics, engineering, and last but not least, in quantum
mechanics.
7.1
The metaplectic representation
The idea behind the metaplectic representation of the symplectic group is that one
can associate to every symplectic matrix a pair of unitary operators on L2(Rn)
diﬀering by a sign. Technically this is achieved by constructing of a unitary rep-
resentation of the (connected) double covering Sp2(2n, R) of Sp(2n, R). This rep-
resentation (which is not irreducible, see Exercise 138 in Chapter 8) is called the
metaplectic group and is denoted by Mp(2n, R). Equivalently, the sequence
0 −→Z2 −→Mp(2n, R) −→Sp(2n, R) −→0
is exact. In many texts the existence of the metaplectic representation is motivated
by vague considerations about the uniqueness of the Schr¨odinger representation
and the Heisenberg–Weyl operators 
T(z) which will be studied in Chapter 8. Fol-
lowing this argument there must exist, for every S ∈Sp(2n, R) a unitary operator

S such that 
S 
T(z)
S−1 = 
T(Sz). However this relation certainly does not charac-
terize precisely 
S since it is still true if we replace it by c
S with |c| = 1. At best
one obtains in this way a projective representation of the symplectic group.
We are following closely de Gosson [67], Chapter 7.
79
M.A. de Gosson, Symplectic Methods in Harmonic Analysis and in Mathematical Physics,  
Pseudo-Differential Operators 7, DOI 10.1007/978-3-7643-9992-4_ , © Springer Basel AG 2011 
7

80
Chapter 7.
The Metaplectic Group
7.1.1
A preliminary remark, and a caveat
In many texts the metaplectic group is presented as being the group of unitary
operators generated by the following elementary unitary operators:
• The modiﬁed Fourier transform µ(J) deﬁned by
µ(J)ψ(x) =

1
2πiℏ
n 	
Rn e−i
ℏx·x′ψ(x′)dx′;
• The “chirps”
µ(V−P )ψ(x) = e
i
2ℏP x·xψ(x)
where P is a real symmetric matrix;
• The rescaling operators
µ(ML)ψ(x) =
√
det Lψ(Lx)
where
√
det L is “some adequate” determination of the square root of det L.
We emphasize that the notation µ(S) used above to denote metaplectic op-
erators associated to a symplectic automorphism S is ambiguous, and should be
avoided because it can lead to contradictions; unfortunately it is often found in
the literature, even in the best treatises. We will not use it in this book.
7.1.2
Quadratic Fourier transforms
We have seen that the symplectic group Sp(2n, R) is generated by the free sym-
plectic matrices
S =
A
B
C
D

∈Sp(2n, R) ,
det B ̸= 0.
To each such matrix we associated the generating function
W(x, x′) = 1
2DB−1x2 −B−1x · x′ + 1
2B−1Ax′2
and we showed that
(x, p) = S(x′, p′) ⇐⇒p = ∂xW(x, x′) , p′ = −∂x′W(x, x′).
Conversely, to every polynomial of the type
W(x, x′) = 1
2Px2 −Lx · x′ + 1
2Qx′2
(7.1)
with P = P T , Q = QT , and
det L ̸= 0
we can associate a free symplectic matrix, namely
SW =

L−1Q
L−1
PL−1Q −LT
PL−1

.
(7.2)

7.1.
The metaplectic representation
81
We now associate an operator 
SW,m to every SW by setting, for ψ ∈S(Rn),

SW,mψ(x) =
 1
2πi
n/2 ∆(W)
	
Rn eiW(x,x′)ψ(x′)dx′;
(7.3)
here arg i = π/2 and the factor ∆(W) is deﬁned by
∆(W) = im
| det L|;
(7.4)
the integer m corresponds to a choice of arg det L:
mπ ≡arg det L
mod 2π.
(7.5)
Notice that we can rewrite Deﬁnition (7.3) in the form

SW,mψ(x) =
 1
2π
n/2 
e−i π
4 µ ∆(W)
	
Rn eiW(x,x′)ψ(x′)dx′
(7.6)
where
µ = 2m −n.
(7.7)
Deﬁnition 107.
(i) The operator 
SW,m is called a “quadratic Fourier transform” associated to
the free symplectic matrix SW .
(ii) The class modulo 4 of the integer m is called “Maslov index” of 
SW,m. The
quadratic Fourier transform corresponding to the choices SW = J and m = 0
is denoted by 
J.
We will not discuss the properties of the Maslov index in this book; it has
been studied in a comprehensive way in de Gosson [67].
The generating function of J being simply W(x, x′) = −x · x′, it follows that

Jψ(x) =
 1
2πi
n/2 	
Rn e−ix·x′ψ(x′)dx′ = i−n/2Fψ(x)
(7.8)
for ψ ∈S(Rn); F is the usual unitary Fourier transform deﬁned by
Fψ(x) =
 1
2π
n/2 	
Rn e−ix·x′ψ(x′)dx′.
It follows from the Fourier inversion formula
F −1ψ(x) =
 1
2π
n/2 	
Rn eix·x′ψ(x′)dx′
that the inverse 
J−1 of 
J is given by the formula

J−1ψ(x) =
 i
2π
n/2 	
Rn eix·x′ψ(x′)dx′ = in/2F −1ψ(x).

82
Chapter 7.
The Metaplectic Group
Note that the identity operator cannot be represented by an operator 
SW,m
since it is not a free symplectic matrix.
Of course, if m is one choice of Maslov index, then m + 2 is another equally
good choice: to each function W formula (7.3) associates not one but two operators

SW,m and 
SW,m+2 = −
SW,m (this reﬂects the fact that the operators 
SW,m are
elements of the two-fold covering group of Sp(2n, R)).
Let us deﬁne operators 
V−P and 
ML,m by

V−P ψ(x) = e
i
2 P x·xψ(x) , 
ML,mψ(x) = im
| det L|ψ(Lx).
(7.9)
We have the following useful factorization result:
Proposition 108. Let W be the quadratic form (7.1).
(i) We have the factorization

SW,m = 
V−P 
ML,m 
J 
V−Q;
(7.10)
(ii) The operators 
SW,m extend to unitary operators L2(Rn) −→L2(Rn) and the
inverse of 
SW,m is

S−1
W,m = 
SW ∗,m∗with W ∗(x, x′) = −W(x′, x) , m∗= n −m.
(7.11)
Proof. (i) By deﬁnition of 
J we have

Jψ(x) = i−n/2Fψ(x) =
 1
2πi
n/2 	
Rn e−ix·x′ψ(x′)dx′;
the factorization (7.10) immediately follows noting that

ML,m 
Jψ(x) =
 1
2πi
n/2 im
| det L|
	
Rn e−iLx·x′ψ(x′)dx′.
(ii) The operators 
V−P and 
ML,m are trivially unitary, and so is the modiﬁed
Fourier transform 
J; (ii) We obviously have
(
V−P )−1 = 
VP
and (
ML,m)−1 = 
ML−1,−m
and 
J−1 is given by

J−1ψ(x) =

i
2πℏ
n/2 	
Rn e
i
ℏx·x′ψ(x′)dx′.
Writing

S−1
W,m = 
VQ 
J−1 
ML−1,−m 
VP

7.1.
The metaplectic representation
83
and noting that

J−1 
ML−1,−mψ(x) =
 i
2π
n/2 i−m
| det L−1|
	
Rn eix·x′ψ(L−1x′)dx′
=
 1
2πi
n/2 i−m+n
| det L|
	
Rn eiLT x·x′ψ(x′)dx′
= 
M−LT ,n−m 
Jψ(x)
the inversion formulas (7.11) follow.
□
It follows from the proposition above that the operators 
SW,m form a subset
of the group U(L2(Rn)) of unitary operators acting on L2(Rn), which is closed
under the operation of inversion. They thus generate a subgroup of U(L2(Rn)).
Deﬁnition 109. The subgroup of U(L2(Rn)) generated by the quadratic Fourier
transforms 
SW,m is called the “metaplectic group” and is denoted by Mp(2n, R).
The elements of Mp(2n, R) are called “metaplectic operators”.
Every 
S ∈Mp(2n, R) is thus, by deﬁnition, a product 
SW1,m1 · · · 
SWk,mk
of metaplectic operators associated to free symplectic matrices. We will use the
following result which considerably simpliﬁes many arguments; it is the metaplectic
analogue of Theorem 60 which says that every symplectic matrix can be written
as the product of two free symplectic matrices:
Proposition 110. Every 
S ∈Mp(2n, R) can be written as a product of exactly two
quadratic Fourier transforms: 
S = 
SW,m 
SW ′,m′. (Such a factorization is, however,
never unique: for instance I = 
SW,m 
SW ∗,m∗for every generating function W.)
Proof. See Leray [114], Ch. 1, or de Gosson [64]); the result follows from the exis-
tence of a natural projection Mp(2n, R) −→Sp(2n, R) which will be established in
the next section and the fact that every S ∈Sp(2n, R) can be written as a product
SW SW ′. (See Exercise 111 below.)
□
Exercise 111. Prove Proposition 110 above.
Proposition 110 has the following immediate consequence:
Corollary 112. The metaplectic group Mp(2n, R) is generated by the operators

V−P , 
ML,m, and 
J.
Proof. It follows from the deﬁnition above of Mp(2n, R) together with the fact
that each 
SW,m is a product 
V−P 
ML,m 
J 
V−Q (formula (7.10)).
□
Exercise 113. Show that quadratic Fourier transform 
SW,m cannot be a local
operator (a local operator on S′(Rn) is an operator 
S such that Supp(
Sψ) ⊂
Supp(ψ) for ψ ∈S′(Rn)).

84
Chapter 7.
The Metaplectic Group
7.2
The projection πMp
It turns out that Mp(2n, R) is a double covering of the symplectic group Sp(2n, R)
and hence a faithful representation of Sp(2n, R).
7.2.1
Precise statement
The main result of this subsection is the following, whose detailed proof is given
in Section 7.3:
Theorem 114. The mapping 
SW,m −→SW , which to the quadratic Fourier trans-
form

SW,mψ(x) =
 1
2πi
n/2 ∆(W)
	
Rn eiW(x,x′)ψ(x′)dx′
associates the free symplectic matrix with generating function W, extends into a
surjective group homomorphism
πMp : Mp(2n, R) −→Sp(2n, R);
that is
πMp(
S 
S′) = πMp(
S)πMp(
S′)
and the kernel of πMp is
ker(πMp) = {−I, +I}.
Hence πMp : Mp(2n, R) −→Sp(2n, R) is a twofold covering of the symplectic
group.
The last statement follows from the theory of covering groups: a covering
group of a Lie group has discrete ﬁber, isomorphic to the kernel of the projection
homomorphism.
Deﬁnition 115. We will call the homomorphism πMp the natural projection, or
covering mapping of Mp(2n, R) onto Sp(2n, R).
Recalling that Sp(2n, R) is generated by the symplectic matrices J and
ML =

L−1
0
0
LT

, V−P =

I
0
P
I

(det L ̸= 0, P = P T ), the natural projection has in addition the following proper-
ties:
Proposition 116. We have:
πMp( 
J) = J
, πMp(
ML,m) = ML , πMp(
VP ) = VP .
(7.12)

7.2.
The projection πMp
85
Proof. The formula πMp( 
J) = J is obvious since 
J is a quadratic Fourier trans-
form with W(x, x′) = −x · x′. Let us prove the second formula (7.12). We have

ML,m = 
J−1( 
J 
ML,m) and 
J 
ML,m = 
SW,m with W(x, x′) = −(LT )−1x · x′. Since
πMp( 
J−1) = J−1 = −J it follows that
πMp(
ML,m) = πMp( 
J−1)πMp( 
J 
ML,m)
=
 0
I
−I
0
  0
LT
L−1
0

=
L−1
0
0
LT

hence πMp(
ML,m) = ML. The formula πMp(
VP ) = VP is proven using a similar
argument.
□
7.2.2
Dependence on ℏ
It is useful to have a parameter-dependent version of Mp(2n, R); in the applications
to quantum mechanics that parameter is ℏ, Planck’s constant h divided by 2π.
The main observation is that a covering group can be “realized” in many dif-
ferent ways. Instead of choosing πMp as a projection, we could as well have chosen
any other mapping Mp(2n, R) −→Sp(2n, R) obtained from πMp by composing
it on the left with an inner automorphism of Mp(2n, R), or on the right with an
inner automorphism of Sp(2n, R), or both. The point is here that the diagram
Mp(2n, R)
F
−→
Mp(2n, R)
πMp
πMp′
Sp(2n, R)
−→
G
Sp(2n, R)
is commutative: π′ Mp ◦F = G ◦πMp, because for all such π′ Mp we will have
Ker(π′ Mp) = {± I} and
π′ Mp : Mp(2n, R) −→Sp(2n, R)
will then also be a covering mapping. We ﬁnd it particularly convenient to deﬁne a
new projection by using the following inner automorphism of Mp(2n, R): for λ > 0
set 
Mλ = 
MλI,0, that is

Mλψ(x) = λn/2ψ(λx) , ψ ∈L2(Rn)
and denote by Mλ the projection of 
Mλ on Sp(2n, R):
Mλ(x, p) = (λ−1x, λp).

86
Chapter 7.
The Metaplectic Group
We have 
Mλ ∈Mp(2n, R) and Mλ ∈Sp(2n, R). For 
S ∈Mp(2n, R) we deﬁne

Sℏ∈Mp(2n, R) by

Sℏ= 
M1/
√
ℏ
S 
M√
ℏ.
(7.13)
The projection of Sℏon Sp(2n, R) is then given by:
πMp(
Sℏ) = Sℏ= M1/
√
ℏSM√
ℏ.
We now deﬁne the new projection
πMp ℏ: Mp(2n, R) −→Sp(2n, R)
by the formula
πMp ℏ(
Sℏ) = M√
ℏ(πMp(
Sℏ))M1/
√
ℏ
which is of course equivalent to
πMpℏ(
Sℏ) = πMp(
S).
Suppose for instance that 
S = 
SW,m; it is easily checked using the fact that
W is homogeneous of degree 2 in (x, x′) that

Sℏ
W,mψ(x) =

1
2πiℏ
n/2 ∆(W)
	
Rn e
i
ℏW(x,x′)ψ(x′) dx′
or, equivalently,

Sℏ
W,m = ℏ−n/2 
SW/ℏ,m.
Also,
(
Sℏ
W,m)−1ψ(x) =

i
2πℏ
n/2 ∆(W ∗)
	
Rn e
i
ℏW ∗(x,x′)ψ(x′) dx′.
The projection of 
Sℏ
W,m on Sp(2n, R) is the free matrix SW :
πMpℏ(
Sℏ
W,m) = SW .
(7.14)
Exercise 117. Show that if ℏand ℏ′ are two positive numbers, then we have

Sℏ
W,m = M√
ℏ′/ℏ
Sℏ′
W,mM√
ℏ/ℏ′.
(i.e., Mp(2n, R) and Mp(2n, R) are equivalent representations of the metaplectic
group).
In what follows we will use the following convention, notation, and terminology:
Notation 118. The projection Mp(2n, R) −→Sp(2n, R) will always be assumed to
be the homomorphism
πMpℏ: Mp(2n, R) −→Sp(2n, R)
and we will drop all the superscripts referring to ℏ: we will write πMp for πMpℏ,

SW,m for 
Sℏ
W,m and 
S for 
Sℏ.

7.3.
Construction of πMp
87
7.3
Construction of πMp
We begin by giving a few deﬁnitions.
7.3.1
The group Diﬀ(1)(n)
Let us denote the elements of the dual (Rn ⊕Rn)∗of Rn ⊕Rn by a, b, etc. Thus
a(z) = a(x, p) is the value of the linear form a at the point z = (x, p).
To every a we associate a ﬁrst-order linear partial diﬀerential operator A
obtained by replacing formally p in a(x, p) by Dx: A = a(x, Dx), Dx = −i∂x;
thus, if a(x, p) = α · x + β · p for α = (α1, . . . , αn), β = (β1, . . . , βn) in Rn, then
A = α · x + β · Dx = α · x −iβ · ∂x.
(7.15)
Obviously the sum of two operators of the type above is an operator of the same
type, and so is the product of such an operator by a scalar. It follows that these
operators form a 2n-dimensional vector space, which we denote by Diﬀ(1)(n).
The vector spaces Rn ⊕Rn, (Rn ⊕Rn)∗and Diﬀ(1)(n) are isomorphic since
they all have the same dimension 2n. The following result explicitly describes three
canonical isomorphisms between these spaces:
Lemma 119.
(i) The linear mappings
ϕ1 : Rn ⊕Rn −→(Rn ⊕Rn)∗, ϕ1 : z0 −→a,
ϕ2 : (Rn ⊕Rn)∗−→Diﬀ(1)(n) , ϕ2 : a −→A,
where a is the unique linear form on Rn ⊕Rn such that a(z) = σ(z, z0), are
isomorphisms, hence so is their compose ϕ :
ϕ = ϕ2 ◦ϕ1 : Rn ⊕Rn −→Diﬀ(1)(n);
the latter associates to z0 = (x0, p0) the operator
A = ϕ(z0) = p0 · x −x0 · Dx.
(ii) Let [A, B] = AB −BA be the commutator of A, B ∈Diﬀ(1)(n); we have
[ϕ(z1), ϕ(z2)] = −iσ(z1, z2)
(7.16)
for all z1, z2 ∈Rn ⊕Rn.
Proof. (i) The vector spaces Rn ⊕Rn, (Rn ⊕Rn)∗, and Diﬀ(1)(n) having the same
dimension, it suﬃces to show that ker(ϕ1) and ker(ϕ2) are zero. Now, ϕ1(z0) = 0
is equivalent to the condition σ(z, z0) = 0 for all z, and hence to z0 = 0 since a

88
Chapter 7.
The Metaplectic Group
symplectic form is non-degenerate. If ϕ2(a) = 0 then
Aψ = ϕ2(a)ψ = 0 for all ψ ∈S(Rn)
which implies A = 0 and thus a = 0.
(ii) Let z1 = (x1, p1), z2 = (x2, p2). We have
ϕ(z1) = p1 · x −x1 · Dx
,
ϕ(z2) = p2 · x −x2 · Dx
and hence
[ϕ(z1), ϕ(z2)] = i(x1 · p2 −x2 · p1)
which is precisely the commutation formula (7.16).
□
We are next going to show that the metaplectic group Mp(2n, R) acts by
conjugation on Diﬀ(1)(n). This will allow us to explicitly construct a covering
mapping Mp(2n, R) −→Sp(2n, R).
Recall that the symplectic matrices
VP =
 I
0
−P
I

, ML =
L−1
0
0
LT

, J =
0
I
I
0

generate the group Sp(2n, R).
Lemma 120. For z0 = (x0, p0) ∈Rn ⊕Rn deﬁne A ∈Diﬀ(1)(n) by
A = ϕ(z0) = p0 · x −x0 · Dx.
(i) Let { 
J, 
ML,m, 
VP } be the set of generators of Mp(2n, R) deﬁned in Corollary
112. We have:

JA 
J−1 = −x0 · x −p0 · Dx = ϕ(Jz0),
(7.17)

ML,mA(
ML,m)−1 = LT p0 · x −L−1x0 · Dx = ϕ(MLz0),
(7.18)

VP A(
VP )−1 = (p0 + Px0) · x −x0 · Dx = ϕ(VP z0).
(7.19)
(ii) If A ∈Diﬀ(1)(n) and 
S ∈Mp(2n, R), then 
SA
S−1 ∈Diﬀ(1)(n).
(iii) For every 
S ∈Mp(2n, R) the mapping
Φ 
S : Diﬀ(1)(n) −→Diﬀ(1)(n) , A −→
SA
S−1
is a vector space automorphism.
Proof of (i). Using the properties of the Fourier transform, it is immediate to
verify that:
(x0 · Dx)ψ = 
J−1(x0 · x) 
Jψ,
(p0 · x)ψ = −
J−1(p0 · Dx) 
Jψ
for ψ ∈S(Rn) hence (7.17). To prove (7.18) it suﬃces to remark that

ML,m(p0 · x)(
ML,m)−1ψ(x) = (p0 · Lx)ψ(x)

7.3.
Construction of πMp
89
and

ML,m(x0 · Dx)(
ML,m)−1ψ(x) = x0(L−1)T Dxψ(x).
Let us prove formula (7.19). Recalling that by deﬁnition

V−P ψ(x) = e
i
2 P x·xψ(x)
we have, since P is symmetric,
(x0 · Dx)
V−P ψ(x) = 
V−P (Px0 · x)ψ(x) + (p0 · Dx)ψ(x))
and hence

VP A(
V−P ψ)(x) = ([p0 + Px0) · x] ψ(x) −(x0 · Dx)ψ(x)
which is (7.19).
Proof of (ii). Property (ii) immediately follows since 
S is a product of operators

J, 
ML,m, 
VP . (iii) The mapping Φ 
S is trivially a linear mapping Diﬀ(1)(n) −→
Diﬀ(1)(n). If B = 
SA
S−1 ∈Diﬀ(1)(n), then we have also A = 
S−1B 
S ∈Diﬀ(1)(n)
since A = 
S−1B(
S−1)−1. It follows that Φ 
S is surjective and hence bijective.
□
Since the operators 
J, 
ML,m, 
VP generate Mp(2n, R) the lemma above shows
that for every 
S ∈Mp(2n, R) there exists a linear automorphism S of Rn ⊕Rn
such that Φ 
S(A) = 
a ◦S that is
Φ 
S(ϕ(z0)) = ϕ(Sz0).
(7.20)
Let us show that the automorphism S preserves the symplectic form. For z, z′ ∈
Rn ⊕Rn we have, in view of the commutation formula (7.16),
σ(Sz, Sz′) = i [ϕ(Sz), ϕ(Sz′)]
= i

Φ 
Sϕ(z), Φ 
Sϕ(z′)
 
= i
!

Sϕ(z)
S−1, 
Sϕ(z′)
S−1"
= i
S [ϕ(z), ϕ(z′)] 
S−1
= σ(z, z′)
hence S ∈Sp(2n, R) as claimed.
7.3.2
Construction of the projection
We are now able to describe explicitly the natural projection of Mp(2n, R) onto
Sp(2n, R).
Deﬁnition 121. The covering projection πMp : Mp(2n, R) −→Sp(2n, R) is the
mapping πMp which to 
S ∈Mp(2n, R) associates the element πMp(
S) = S ∈
Sp(2n, R) deﬁned by (7.20), that is
S = ϕ−1Φ 
Sϕ.
(7.21)

90
Chapter 7.
The Metaplectic Group
That the mapping πMp indeed is a covering mapping follows from:
Proposition 122.
(i) The mapping πMp is a continuous group epimorphism of Mp(2n, R) onto
Sp(2n, R) such that:
πMp( 
J) = J
, πMp(
ML,m) = ML , πMp(
VP ) = VP
(7.22)
and hence
πMp(
SW,m) = SW .
(7.23)
(ii) We have ker(πMp) = {−I, +I}; hence πMp : Mp(2n, R) −→Sp(2n, R) is a
two-fold covering map.
Proof. (i) Let us ﬁrst show that πMp is a group homomorphism. In view of the
obvious identity Φ 
SΦ 
S′ = Φ 
S 
S′ we have
πMp(
S 
S′) = ϕ−1Φ 
S 
S′ϕ
= (ϕ−1Φ 
Sϕ)(ϕ−1Φ 
S′ϕ)
= πMp(
S)πMp(
S′).
Let us next prove that πMp is surjective. We have seen in Corollary 63 of Proposi-
tion 62 that the matrices J, ML, and VP generate Sp(2n, R) when L and P range
over, respectively, the invertible and symmetric real matrices of order n. It is thus
suﬃcient to show that formulae (7.22) hold. Now, using (7.17), (7.18), and (7.19)
we have
ϕΦ 
Jϕ−1 = J , ϕΦ
ML,mϕ−1 = ML , ϕΦ
VP ϕ−1 = VP
hence (7.12). Formula (7.23) follows since every quadratic Fourier transform 
SW,m
can be factorized as

SW,m = 
V−P 
ML,m 
J 
V−Q
in view of Proposition 108 above. To establish the continuity of the mapping πMp
we ﬁrst remark that the isomorphism ϕ : Rn⊕Rn −→Diﬀ(1)(n) deﬁned in Lemma
119 is trivially continuous, and so is its inverse. Since Φ 
S 
S′ = Φ 
SΦ 
S′ it suﬃces
to show that for every A ∈Diﬀ(1)(n), ψS(A) has A as limit when 
S →I in
Mp(2n, R). Now, Mp(2n, R) is a group of continuous automorphisms of S(Rn)
hence, when 
S →I then 
S−1ψ →ψ for every ψ ∈S(Rn), that is A
S−1ψ →Aψ
and also 
SA
S−1ψ →ψ. (ii) Suppose that ϕ−1Φ 
Sϕ = I. Then 
SA
S−1 = A for
every A ∈Diﬀ(1)(n) and this is only possible if 
S is multiplication by a constant
c with |c| = 1 (see exercise below); thus ker(πMp) ⊂S1. In view of Lemma 110 we
have 
S = 
SW,m 
SW ′,m′ for some choice of (W, m) and (W ′, m′) hence the condition

S ∈ker(πMp) is equivalent to

SW ′,m′ = c(
SW,m)−1 = c
SW ∗,m∗
which is only possible if c = ±1 hence 
S = ±I as claimed.
□

Chapter 8
Heisenberg–Weyl and
Grossmann–Royer Operators
The Heisenberg–Weyl operators (also sometimes called simply “Heisenberg oper-
ators”) are in a sense the easiest way to access quantum mechanics, because their
deﬁnition can be understood in terms of a simple Hamiltonian dynamics: they
are the time-one evolution operator for the quantized displacement Hamiltonian.
One can actually also deﬁne these operators in terms of the phase function of a
Lagrangian manifold without invoking any quantization at all; we will not use this
approach here and refer the interested reader to Chapter 5 in de Gosson [67]). To-
gether with their cousins, the Grossmann–Royer operators, the Heisenberg–Weyl
operators play a key role in the theory of Weyl pseudo-diﬀerential operators, and
moreover allow us to simplify many statements and proofs. In particular they al-
low a neat deﬁnition of the cross-ambiguity and Wigner transforms as we will see
in Chapter 9. We will also brieﬂy discuss the notion of Weyl–Heisenberg frame,
also called Gabor frame in time-frequency analysis.
8.1
Dynamical motivation, and deﬁnition
The Heisenberg–Weyl operators (also sometimes called Heisenberg operators) are
the “quantized” variants of phase-space translations. The presentation we give is
“dynamical”: we start with a displacement Hamiltonian, which we then “quan-
tize”, as opposed with the usual approaches.
8.1.1
The displacement Hamiltonian
The phase space translation operators T (z0) : z −→z+z0 are symplectomorphisms
(because the Jacobian matrix of a translation is the identity, and is hence symplec-
tic). These translations are in fact even Hamiltonian symplectomorphisms: we have
91
M.A. de Gosson, Symplectic Methods in Harmonic Analysis and in Mathematical Physics,  
Pseudo-Differential Operators 7, DOI 10.1007/978-3-7643-9992-4_ , © Springer Basel AG 2011 
8

92
Chapter 8. Heisenberg–Weyl and Grossmann–Royer Operators
T (z0) ∈Ham(2n, R). To see this deﬁne, for each z0, a Hamiltonian function Hz0 by
Hz0(z) = σ(z, z0) = p · x0 −p0 · x.
The associated Hamilton equations are ˙x = x0, ˙p = p0 so that the ﬂow is given by
the formula
φ
Hz0
t
(z′) = z′ + tz0
and we have T (z0) = φ
Hz0
1
.
Deﬁnition 123. The function Hz0 = σ(z, z0) is called the displacement (or trans-
lation) Hamiltonian.
Let us look for a “quantized” version of the T (z0). For this we consider the
Schr¨odinger equation
iℏ∂ψ
∂t = 
Hz0ψ
,
ψ(x, 0) = ψ0(x)
(8.1)
where 
Hz0 is the operator

Hz0 = σ(ˆz, z0) = −iℏx0 · ∂x −p0 · x
(8.2)
obtained from Hz0 by formally replacing p by −iℏ∂x. The solution of (8.1) can be
formally written as
ψ(x, t) = 
T(z0, t)ψ0(x) = e−it
ℏσ(ˆz,z0)ψ0(x).
(8.3)
Using for instance the method of characteristics, or a direct calculation, one sees
that an explicit formula for this solution is given by

T(z0, t)ψ0(x) = e
i
ℏ(tp0·x−1
2 t2p0·x0)ψ0(x −tx0).
(8.4)
It is clear that 
T(z0, t) is a unitary operator on L2(Rn): we have
∥
T(z0, t)ψ∥L2 = ∥ψ∥L2
(8.5)
for every ψ ∈L2(Rn).
The reader is invited to observe that we have here a case where the Schr¨o-
dinger equation can be explicitly solved; it is actually a particular case of a more
general situation; we will come back to this when we study the Schr¨odinger equa-
tion in Chapter 15.

8.1.
Dynamical motivation, and deﬁnition
93
8.1.2
The Heisenberg–Weyl operators
The considerations above lead us to the following deﬁnition:
Deﬁnition 124. The operator 
T(z0) = 
T(z0, 1) is called the Heisenberg–Weyl (for
short: HW) operator determined by z0. Thus, explicitly,

T(z0)ψ = e
i
ℏ(p0·x−1
2 p0·x0)ψ(x −x0).
(8.6)
This formula can also be written

T(z0)ψ = e−i
ℏσ(ˆz,z0)ψ0(x) = e
i
ℏσ(z0,ˆz)ψ(x)
(8.7)
(cf. formula (8.3)).
Notice that it is clear from formula (8.4) that we have 
T(z0, t) = 
T(tz0).
While ordinary translation operators obviously form an abelian group iso-
morphic to the additive group Rn ⊕Rn:
T (z)T (z′) = T (z′)T (z) = T (z + z′),
this is not true of the HW operators; in particular these operators do not commute.
The following relations are considered by many mathematicians or physicists al-
most as “mythic”, in the sense that they are supposed to contain the essence of
quantum mechanics. This view is however questionable, because the HW opera-
tors (and thus their commutation relations) can be deﬁned using only classical
arguments (the Hamilton–Jacobi theory together with the notion of phase of a
Lagrangian manifold: see de Gosson [66, 67]).
Proposition 125. The Heisenberg–Weyl operators satisfy the relations

T(z0) 
T(z1) = e
i
ℏσ(z0,z1) 
T(z1) 
T(z0)
(8.8)
and

T(z0 + z1) = e−i
2ℏσ(z0,z1) 
T(z0) 
T(z1)
(8.9)
for all z0, z1 ∈R2n.
Proof. Translations act on functions on Rn via the formula T (z0)ψ(x) = ψ(x−x0)
if z0 = (x0, p0). Let us prove formula (8.8). We have

T(z0) 
T(z1) = 
T(z0)(e
i
ℏ(p1·x−1
2 p1·x1)T (z1))
= e
i
ℏ(p0·x−1
2 p0·x0)e
i
ℏ(p1·(x−x0)−1
2 p1·x1)T (z0 + z1)
and, similarly

T(z1) 
T (z0) = e
i
ℏ(p1·x−1
2 p1·x1)e
i
ℏ(p0·(x−x1)−1
2 p0·x0)T (z0 + z1).

94
Chapter 8. Heisenberg–Weyl and Grossmann–Royer Operators
Deﬁning the quantities
Φ = p0 · x −1
2p0 · x0 + p1 · (x −x0) −1
2p1 · x1,
Φ′ = p1 · x −1
2p1 · x1 + p0 · (x −x1) −1
2p0 · x0,
we have

T(z0) 
T(z1) = e
i
ℏ(Φ−Φ′) 
T(z1) 
T(z0)
and an immediate calculation yields
Φ −Φ′ = p0 · x1 −p1 · x0 = σ(z0, z1)
which proves (8.8). Let us next prove formula (8.9). We have

T(z0 + z1) = e
i
ℏΦ′′T (z0 + z1)
with
Φ′′ = (p0 + p1) · x −1
2(p0 + p1) · (x0 + x1).
On the other hand we have seen above that

T(z0) 
T(z1) = e
i
ℏΦT (z0 + z1)
so that

T(z0 + z1) = e
i
ℏ(Φ′′−Φ) 
T(z0) 
T(z1).
A straightforward algebraic calculation shows that
Φ′′ −Φ = 1
2p1 · x0 −1
2p0 · x1 = −1
2σ(z0, z1)
hence formula (8.9).
□
Exercise 126. Prove formally the formulas (8.8) and (8.9) using the diﬀerential
expression (8.7) of the Heisenberg–Weyl operators.
We note that the HW operators act on functions deﬁned on “conﬁguration
space” Rn while the translations T (z0) act on phase space Rn⊕Rn. It is not diﬃcult
to remedy at this dissymmetry: it suﬃces to deﬁne, for a function Ψ ∈S(Rn⊕Rn),

T(z0)Ψ(z) = e
i
ℏ(p0·x−1
2 p0·x0)Ψ(z −z0);
(8.10)
this deﬁnition of course extends to Ψ ∈S′(Rn ⊕Rn) and one immediately veriﬁes,
using the argument in the proof of the proposition above, that this redeﬁnition
of the Heisenberg–Weyl operators again satisfy the relations (8.8) and (8.9). We
will use a variant of this idea in Chapter 18 when we study phase-space pseudo-
diﬀerential operators (“Bopp calculus”).
Exercise 127. Verify that the operators (8.10) satisfy the same relations (8.8) and
(8.9) as the HW operators.

8.1.
Dynamical motivation, and deﬁnition
95
8.1.3
The symplectic covariance property of the HW operators
The phase space translation operators T (z0) satisfy the intertwining formula
ST (z0)S−1 = T (Sz0) for every S ∈Sp(2n, R). It is therefore perhaps not so
surprising that we have a similar formula for the HW operators. In fact:
Theorem 128. Let 
S ∈Mp(2n, R) and S = πMp(
S). We have

S 
T(z0)
S−1 = 
T(Sz0)
(8.11)
for every z0 ∈R2n.
Proof. To prove formula (8.11) it is suﬃcient to assume that 
S is a quadratic
Fourier transform 
SW,m since every 
S ∈Mp(2n, R) is a product of two such
operators. Suppose indeed we have shown that

T(SW z0) = 
SW,m 
T(z0)
S−1
W,m;
(8.12)
writing an arbitrary element S of Mp(2n, R) as a product SW,mSW ′,m′ we have

T(Sz0) = 
SW,m(
SW ′,m′ 
T(z0)
S−1
W ′,m′)
S−1
W,m
= 
SW,m 
T(SW ′z0)
S−1
W,m
= 
T(SW SW ′z0)
= 
SW,m 
SW ′,m′ 
T (z0)(
SW,m 
SW ′,m′)−1
= 
S 
T(z0)
S−1.
Let us set out to prove (8.12); equivalently:

T(z0)
SW,m = 
SW,m 
T(S−1
W z0).
(8.13)
For ψ ∈S(Rn) set
g(x) = 
T(z0)
SW,mψ(x).
By deﬁnition of 
SW,m and 
T(z0) we have
g(x) =

1
2πiℏ
n/2 ∆(W)e−1
2ℏp0·x0
	
Rn e
i
ℏ(W(x−x0,x′)+p0·x)ψ(x′)dx′.
In view of formula (3.7) in Proposition 54, the function
W0(x, x′) = W(x −x0, x′) + p0 · x
(8.14)
is a generating function of the free aﬃne symplectomorphism T (z0)SW , hence we
have just shown that

T(z0)
SW,m = e
i
2ℏp0·x0 
SW0,m
(8.15)

96
Chapter 8. Heisenberg–Weyl and Grossmann–Royer Operators
where 
SW0,m is one of the metaplectic operators associated to W0. Let us now set
h(x) = 
SW,m 
T(S−1
W z0)ψ(x) and (x′
0, p′
0) = 
S−1
W,m(x0, p0);
we have
h(x) =

1
2πiℏ
n/2 ∆(W)
	
Rn e
i
ℏW(x,x′)e−i
2ℏp′
0·x′
0e
i
ℏp′
0·x′ψ(x′ −x′
0) dx′
that is, performing the change of variables x′ −→x′ + x′
0:
h(x) =

1
2πiℏ
n/2 ∆(W)
	
Rn e
i
ℏW(x,x′+x′
0)e
i
2ℏp′
0·x′
0e
i
ℏp′
0·x′ψ(x′) dx′.
We will thus have h(x) = g(x) as claimed, if we show that
W(x, x′ + x′
0) + 1
2p′
0 · x′
0 + p′
0 · x′ = W0(x, x′) −1
2p0 · x0
that is
W(x, x′ + x′
0) + 1
2p′
0 · x′
0 + p′
0 · x′ = W(x −x0, x′) + p0 · x −1
2p0 · x0.
Replacing x by x + x0 this amounts to proving that
W(x + x0, x′ + x′
0) + 1
2p′
0 · x′
0 + p′
0 · x′ = W(x, x′) + 1
2p0 · x0 + p0 · x.
But this equality immediately follows from Proposition 54 and its Corollary 55.
□
Exercise 129. Give an alternative proof of formula (8.11) using the generators

V−P , 
ML,m, 
J of Mp(2n, R) deﬁned by (7.9).
The inhomogeneous metaplectic group AMp(2n, R) is an extension by the
HW operators of the metaplectic group Mp(2n, R). It is the analogue at the “quan-
tized” level of the inhomogeneous symplectic group ASp(2n, R) (see Deﬁnition 26).
Its construction requires the use of the Heisenberg–Weyl operators.
8.2
The Heisenberg group
The Heisenberg group is a venerable topic, closely related to the Heisenberg–Weyl
operators. It has played an important role in the development of quantum me-
chanics following ideas of Heisenberg and Weyl. We shortly discuss it for the sake
of completeness even if we will not really use it in this book. Excellent references
for the Heisenberg group are the books by Schempp [140] and Stein [153] (Chapter
12); very readable presentations are also given in Folland [59] and Gr¨ochenig [82].

8.2.
The Heisenberg group
97
8.2.1
The canonical commutation relations
Consider the textbook “quantum operators” 
Xj, 
Pj on S(Rn) deﬁned, for ψ ∈
S(Rn) by

Xjψ = xjψ
,

Pjψ = −iℏ∂ψ
∂xj
.
These operators satisfy the commutation relations
[ 
Xi, 
Xj] = [ 
Pi, 
Pj] = 0 , [ 
Xi, 
Pj] = iℏδijI
(8.16)
thus justifying the following deﬁnition:
Deﬁnition 130. A “Heisenberg algebra” is a Lie algebra hn with a basis
{ 
X1, . . . , 
Xn; 
P1, . . . , 
Pn; 
T}
whose elements satisfy the so-called canonical commutation relations (for short:
CCR)
[ 
Xi, 
Xj] = 0 ,
[ 
Pi, 
Pj] = 0 ,
[ 
Xi, 
Pj] = δij 
T,
[ 
Xi, 
T] = 0 ,
[ 
Pi, 
T] = 0
(8.17)
for 1 ≤i, j ≤n; ℏis a constant identiﬁed in Physics with Planck’s constant h
divided by 2π.
In the realization (8.16) of the CCR one usually chooses for 
T multiplication
of functions by the imaginary number iℏ: 
Tψ = iℏψ. (The operator 
T can be
viewed as “setting the quantum scale”.)
Writing 
U and 
U ′ in the basis { 
X1, . . . , 
Xn; 
P1, . . . , 
Pn; 
T} we have

U =
n

i=1
xi 
Xi + pi 
Pi + t 
T
,

U ′ =
n

i=1
x′
i 
Xi + p′
i 
Pi + t′ 
T.
Setting z = (x, p), z′ = (x′, p′) the CCR are then immediately seen to be equivalent
to the relation
[
U, 
U ′] = σ(z, z′) 
T .
(8.18)
Formula (8.18) quite explicitly shows that the CCR are intimately related to the
choice of the symplectic structure on Rn ⊕Rn; this observation will be fully ex-
ploited in Chapters 18 and 19 when we motivate and discuss phase space pseudo-
diﬀerential operators.
Exercise 131. Verify that the Heisenberg algebra hn really is a Lie algebra.

98
Chapter 8. Heisenberg–Weyl and Grossmann–Royer Operators
8.2.2
Heisenberg group and Schr¨odinger representation
Let us now describe the simply connected Lie group Hn corresponding to the Lie
algebra hn. We begin by recalling that the exponential mapping exp : g −→G
from a Lie algebra g to a Lie group G does not in satisfy the relation exp X exp Y =
exp(X + Y ) if XY ̸= Y X. Now, there is a formula, called the Baker–Campbell–
Hausdorﬀformula, that says that under some conditions (which we assume to
hold), there exists a C(X, Y ) ∈g such that
eXeY = eC(X,Y )
where C(X, Y ) has a series expansion of the type
C(X, Y ) = X + Y + 1
2[X, Y ] +
∞

j=1
Cj(X, Y )
where the Cj(X, Y ) are linear combinations of commutators of higher order. Since
all Lie brackets in 
U, 
U ′ of length superior to 2 vanish, hence the Baker–Campbell–
Hausdorﬀformula reduces (if 
U and 
U ′ are suﬃciently close to zero) to the simple
formula
exp(
U) exp(
U ′) = exp(
U + 
U ′ + 1
2[
U, 
U ′])
that is, in view of formula (8.18),
exp(
U) exp(
U ′) = exp(
U + 
U ′ + 1
2σ(z, z′) 
T).
(8.19)
The exponential being a diﬀeomorphism of a neighborhood U of zero in hn onto a
neighborhood of the identity in Hn we can identify 
U, 
U ′, for small z, z′, t, t′,
with the exponentials exp(
U), exp(
U ′), and exp(
U) exp(
U ′) with the element
(z, t)✠(z′, t) of R2n+1 = R2n × R deﬁned by
(z, t)✠(z′, t) = (z + z′, t + t′ + 1
2σ(z, z′)).
(8.20)
It turns out that this formula deﬁnes a (non-commutative) group law:
Deﬁnition 132. The set R2n × R equipped with the group law
(z, t)✠(z′, t) = (z + z′, t + t′ + 1
2σ(z, z′))
is called the (2n + 1)-dimensional Heisenberg group Hn. [In physics it is often
called the Weyl group.]
Obviously (0, 0) ∈R2n × R is a unit for the composition law ✠, and each
(z, t) is invertible with inverse (−z, −t) (the latter property immediately follows
from the fact that σ(z, z) = 0).
Exercise 133. Verify that the law ✠is associative, so it really deﬁnes a group
structure on R2n+1.

8.2.
The Heisenberg group
99
At this point we remark that some authors use the following variant of Def-
inition 132:
Deﬁnition 134. The reduced Heisenberg group Hred
n
is the set R2n × S1 equipped
with the law
(z, u)♦(z′, u′) = (zz′, uu′e
i
2ℏσ(z,z′)).
(8.21)
It turns out that Hn is the universal covering group of this “exponentiated”
version Hred
n
of Hn. Deﬁne in fact a projection π : Hn −→Hred
n
by the formula
π(z, t) = (z, eit). We have
π [(z, t)(z′, t′)] = π(z + z′, t + t′ + i
2σ(z, z′))
= (z + z′, eiteit′e
i
2 σ(z,z′))
= π(z, t)π(z′, t′)
so that π is a group homomorphism; it is in addition trivially surjective (because
every u ∈S1 is of the type eit for some t ∈R). Now the kernel ker π = π−1{(0, 1)}
is deﬁned by z = 0 and eit = 1, that is t ∈2πZ; it is thus a discrete subgroup of
Hn so that Hn is indeed a covering group of Hred
n ; since Hn is simply connected
(it is just R2n × R as a set) it is thus the universal covering of Hred
n .
Since the Lie algebra g of the universal covering group of a Lie group G is
isomorphic to that of G itself, we see that the Lie algebra of Hred
n
is just hn.
There is a useful identiﬁcation of Hn with a subgroup Hpol
n
of GL(2n + 2, R).
That group (the “polarized Heisenberg group”) consists of all (2n + 2) × (2n + 2)
upper-triangular matrices of the type
M(z, t) =







1
p1
· · ·
pn
t
0
1
· · ·
0
x1
...
...
...
...
...
0
0
· · ·
1
xn
0
0
· · ·
0
1







(the entries of the principal diagonal are each equal to 1); we ﬁnd it convenient to
write these matrices for short as
M(z, t) =


1
pT
t
0
1
x
0
0
1

.
One easily checks that the determinant of M(z, t) is 1:
det M(z, t) = 1
and that its inverse is given by the formula
M(z, t)−1 =


1
−pT
−t + p · x
0
1
−x
0
0
1

;

100
Chapter 8. Heisenberg–Weyl and Grossmann–Royer Operators
we have moreover
M(z, t)M(z′, t′) = M(z + z′, t + t′ + p · x′).
(8.22)
Exercise 135. Show that the mapping φ : Hpol
n
−→Hn deﬁned by
φ(M(z, t)) =

z, t −1
2p · x

(8.23)
is a group isomorphism.
Exercise 136. Show that the Lie algebra hpol
n
of Hpol
n
consists of all matrices
Xpol(z, t) =


0
pT
t −1
2p · x
0
0
x
0
0
0

.
The polarized version of the Heisenberg group is useful in many applications
(for instance medical imaging); see for instance Schempp [140, 141].
8.2.3
The Stone–von Neumann theorem
Recall that a unitary representation of a topological group G is a pair (H, π)
where H is a Hilbert space and π is a strongly continuous homomorphism of G
into the group U(H) of all unitary operators on H. “Strong continuity” refers to
the following property:
If limj→∞gj = g in G then limj→∞π(gj)ψ = π(g)ψ for every ψ ∈H.
Given a representation (H, π) of G the functions g −→(ψ|π(g)φ)H are called
the “representation coeﬃcients” of (H, π).
Let us introduce some terminology:
Deﬁnition 137.
(i) Two representations (H1, π1) and (H2, π2) are equivalent if there exists a
unitary operator U : H1 −→H2 such that Uπ1(g)U −1 = π2(g) for all g ∈G.
(ii) A representation (H, π) is said to be irreducible if {0} and H are the only
closed subspaces of H invariant under all the operators π(g), g ∈G.
It is easy to see that the metaplectic representation is not irreducible.
Exercise 138. Let L2
even(Rn) (resp. L2
odd(Rn)) be the vector subspaces of L2(Rn)
consisting of all even (resp. odd) functions. Let 
S ∈Mp(2n, R). Show that
L2(Rn) = L2
even(Rn) ⊕L2
odd(Rn)
and

S(L2
even(Rn)) ⊂L2
even(Rn)
and

S(L2
odd(Rn)) ⊂L2
odd(Rn).
[Hint: use Proposition 110.]

8.2.
The Heisenberg group
101
The Heisenberg–Weyl operators are related in the following way to the Hei-
senberg group:
Proposition 139. Let U(L2(Rn)) be the group of all unitary operators on L2(Rn).
The mapping ρ : Hn −→U(L2(Rn)) deﬁned by
ρ(z, t) = e
i
ℏt 
T(z)
(8.24)
is a unitary representation of the Heisenberg group Hn.
Proof. The operators ρ(z, t) are obviously unitary on L2(Rn). Let us show that ρ
is a group homomorphism, that is
ρ [(z, t)✠(z′, t′)] = ρ(z, t)ρ(z′, t′).
By deﬁnition of the multiplication on Hn and formula (8.9) we have
ρ [(z, t)✠(z′, t′)] = ρ

(z + z′, t + t′ + 1
2σ(z, z′)
 
= e
i
ℏ(t+t′+ 1
2 σ(z,z′) 
T(z + z′)
= e
i
ℏ(t+t′) 
T(z) 
T(z′)
= ρ(z, t)ρ(z′, t′).
□
This result leads us to the following deﬁnition:
Deﬁnition 140. The representation (L2(Rn), ρ) is called the Schr¨odinger represen-
tation of the Heisenberg group.
One can prove (see for instance [67, 59, 82, 158]) that the Schr¨odinger rep-
resentation is irreducible, that is:
The only closed subspaces of L2(Rn) which are invariant under every
operator ρ(z, t) (or, equivalently, 
T(z)) are {0} or L2(Rn) itself.
In view of a result of Schur (Schur’s Lemma) this condition is equivalent to:
If A is a bounded operator on L2(Rn) commuting with ρ (that is Aρ =
ρA) then A = λI for some λ ∈C.
There is a deep result of Stone and von Neumann about the uniqueness of
the Schr¨odinger representation. It is in fact so well known that it has acquired the
status of a “folk theorem” which has led to the following usual (mis-)quotation:
The Schr¨odinger representation is the only irreducible representation of
Hn up to trivial transformations such as rescalings.
Here is one statement of the theorem of Stone and von Neumann:
Theorem 141. Every irreducible representation (L2(Rn), π) of the Heisenberg group
Hn is equivalent to one of the following:
(i) π(z, t) = e
i
ℏz0·z where z0 ∈R2n;
(ii) π(z, t) = 
Tλ(z, t) where 
T(z, t) = 
T(λz, t).

102
Chapter 8. Heisenberg–Weyl and Grossmann–Royer Operators
A more complete statement is the following (Folland, [59], §5):
Theorem 142. Let (H, π) be a unitary representation of the Heisenberg group Hn
such that π(0, t) = e
i
ℏtI for some ℏ̸= 0. Then H =#Hj where the Hj are pairwise
orthogonal subspaces of H each invariant under π and such that the restrictions
πj = π|Hj are unitarily equivalent to (L2(Rn), ρ) for every j. In particular, if
(H, π) is irreducible then π is equivalent to (L2(Rn), ρ).
We will see later on, when we discuss pseudo-diﬀerential operators on phase
space, that it is perfectly possible to construct non-trivial representations of the
Heisenberg group which are distinct from the Schr¨odinger representation provided
that one replaces L2(Rn) by other Hilbert spaces.
8.3
The Grossmann–Royer operators
We introduce in this section the Grossmann–Royer operators which are a kind
of reﬂection operators. Their deﬁnition goes back to the work of Grossmann [88]
and Royer [138]. These operators are not universally known, and this is indeed
very unfortunate since their use allows one to considerably simplify many proofs.
In addition they allow an alternative deﬁnition of Weyl operators in terms of the
symbol, as we will see in Chapter 10
8.3.1
The symplectic Fourier transform
We begin by introducing the notion of symplectic Fourier transform, which is a
“twisted” form of the usual Fourier transform on R2n. We will often use it when
dealing later on with Weyl calculus.
Deﬁnition 143. The symplectic Fourier transform Fσ is deﬁned, for a ∈S(Rn⊕Rn),
by
Fσa(z) =

1
2πℏ
n 	
R2n e−i
ℏσ(z,z′)a(z′)dz′.
(8.25)
We will often use the shorthand notation aσ = Fσa.
The following propositions give the main properties of the symplectic Fourier
transform. Recall that the standard (ℏ-dependent) Fourier transform on S(Rn ⊕
Rn) is given by
Fa(z) =

1
2πℏ
n 	
R2n e−i
ℏz·z′a(z′)dz′.
(8.26)
Proposition 144.
(i) The Fourier transforms Fσ and F are related by the formula
Fσa(z) = Fa(Jz) = F(a ◦J)(z).
(8.27)
In particular Fσ is a linear automorphism
Fσ : S(Rn ⊕Rn) −→S(Rn ⊕Rn)

8.3.
The Grossmann–Royer operators
103
which extends by duality into an automorphism
Fσ : S′(Rn ⊕Rn) −→S′(Rn ⊕Rn).
(ii) The symplectic Fourier transform is involutive and unitary:
Fσ ◦Fσ = I , ∥Fσa∥L2(R2n) = ∥a∥L2(R2n).
(8.28)
Proof of (i). Writing σ(z, z′) = Jz · z′ where J is the standard symplectic matrix,
we have,
Fσa(z) =

1
2πℏ
n 	
R2n e−i
ℏJz·z′a(z′)dz′ = Fa(Jz)
hence the ﬁrst equality (8.27). Setting z′ = Jz′′ in the integral the second formula
formula (8.27) follows as well since we have Jz · Jz′′ = z · z′′.
Proof of (ii). The equality Fσ ◦Fσ = I follows from the usual Fourier inversion
formula written in the form F(Fa)(z) = a(−z):
Fσ(Fσa)(z) = F(Fa)(−z) = a(z).
It follows that the symplectic Fourier transform is both involutive and unitary.
□
In particular the symplectic Fourier transform Fσ is its own inverse: F −1
σ
=
Fσ on S′(Rn ⊕Rn). Thus:
Fσa(z) =

1
2πℏ
n 	
R2n e−i
ℏσ(z,z′)a(z′)dz′,
a(z) =

1
2πℏ
n 	
R2n e−i
ℏσ(z,z′)Fσa(z′)dz′.
More generally, the symplectic Fourier transform behaves well under the ac-
tion of the symplectic group:
Proposition 145. For a ∈S′(Rn ⊕Rn) and S ∈Sp(2n, R) we have
Fσa(Sz) = Fσ(a ◦S)(z).
(8.29)
Proof. It suﬃces to assume that a ∈S(Rn ⊕Rn), in which case
Fσa(Sz) =

1
2πℏ
n 	
R2n e−i
ℏσ(Sz,z′)a(z′)dz′;
since we have
σ(Sz, z′) = σ(S−1Sz, S−1z′) = σ(z, S−1z′)
because S−1 is symplectic, it follows, setting z′′ = S−1z′, that
Fσa(Sz) =

1
2πℏ
n 	
R2n e−i
ℏσ(z,S−1z′)a(z′)dz′
=

1
2πℏ
n 	
R2n e−i
ℏσ(z,z′′)a(Sz′′)dz′
which proves (8.29).
□

104
Chapter 8. Heisenberg–Weyl and Grossmann–Royer Operators
Fσ also satisﬁes the following variants of the Plancherel formula:
Proposition 146. The symplectic Fourier transform satisﬁes the Plancherel formula
(Fσa|b)L2(R2n) = (a|Fσb)L2(R2n)
(8.30)
or, equivalently,using the distributional brackets ⟨⟨·, ·⟩⟩on S(Rn ⊕Rn):
	
R2n a(z)Fσb(z)dz =
	
R2n Fσa(−z)b(z)dz,
(8.31)
⟨⟨a, bσ⟩⟩= ⟨⟨a∨
σ, b⟩⟩= ⟨⟨aσ, b∨⟩⟩
(8.32)
where a∨
σ(z) = aσ(−z).
Proof. It is a straightforward consequence of the fact that Fσ is a unitary involu-
tion:
(Fσa|b)L2(R2n) = (F 2
σa|Fσb)L2 = (a|Fσb)L2.
□
8.3.2
Deﬁnition of the Grossmann–Royer operators
The simplest – or perhaps the most convincing! – way of introducing the Gross-
mann–Royer operators is to express them as the conjugate of a reﬂection operator
by a Heisenberg–Weyl operator:
Deﬁnition 147. The Grossmann–Royer operator 
TGR(z0) is the operator

TGR(z0) : S(Rn) −→S(Rn)
deﬁned by the formulae

TGR(0)ψ(x) = ψ(−x)
(8.33)
and

TGR(z0) = 
T(z0) 
TGR(0) 
T(z0)−1.
(8.34)
The following properties are straightforward (but useful!) consequences of
the deﬁnition:
Proposition 148. The Grossmann–Royer operators are linear and unitary involu-
tions of S(Rn) (and hence of S′(Rn)), and the action of 
TGR(z0), z0 = (x0, p0),
is explicitly given by the formula

TGR(z0)ψ(x) = e
2i
ℏp0·(x−x0)ψ(2x0 −x)
(8.35)
for any function (or distribution) ψ : Rn −→C.

8.3.
The Grossmann–Royer operators
105
Proof. The linearity of 
TGR(z0) is obvious. That 
TGR(z0) is an involution, that is

TGR(z0) 
TGR(z0) = I,
follows from the sequence of equalities

TGR(z0) 
TGR(z0) = 
T(z0) 
TGR(0) 
T(z0)−1 
T(z0) 
TGR(0) 
T(z0)−1
= 
T(z0) 
TGR(0) 
TGR(0) 
T(z0)−1 = 
T(z0) 
T (z0)−1.
Setting x′ = 2x0 −x, we have
∥
TGR(z0)ψ∥2
L2 =
	
Rn |ψ(2x0 −x)|2dx = ∥ψ∥2
L2
hence 
TGR(z0) is also unitary. Formula (8.35) follows from Deﬁnition (8.34) by a
straightforward calculation which is left to the reader as a pleasant exercise.
□
The following result shows that the operators 
TGR(z0) and 
T(z0) are inti-
mately related by the symplectic Fourier transform:
Proposition 149. Let ψ ∈S′(Rn). We have

TGR(z0)ψ(x) = 2−nFσ[ 
T(·)ψ(x)](−z0)
(8.36)
where Fσ is the symplectic Fourier transform.
Proof. Since 
TGR(z0) and Fσ are continuous automorphisms of S′(Rn) it is suf-
ﬁcient to assume that ψ ∈S(Rn). Formula (8.36) follows from (8.35): using the
explicit expressions of σ(z0, z′) and 
T(z′)ψ(x) the right-hand side of (8.36) is
A =

1
4πℏ
n 	
R2n e
i
ℏσ(z0,z′) 
T(z′)ψ(x)dz′
=

1
4πℏ
n 	
R2n e
i
ℏ(p0·x′−p′·x0+p′·x−1
2 p′·x′)ψ(x −x′)dz′
=

1
4πℏ
n 	
Rn
	
Rn e
i
ℏp′·(x−x0−1
2 x′)dp′

e
i
ℏp0·x′ψ(x)dx′.
Now, in the distributional sense,
	
R2 e
i
ℏp′·(x−x0−1
2 x′)dp′ = (2πℏ)n δ(x −x0 −1
2x′)
and hence, setting y = 1
2x′:
A = 2−n
	
Rn δ(x −x0 −1
2x′)e
i
ℏp0·x′ψ(x)dx′
=
	
Rn δ(y + x0 −x)e
2i
ℏp0·yψ(x)dy
= e
2i
ℏp0·(x−x0)ψ(−x + 2x0)
which proves (8.35).
□

106
Chapter 8. Heisenberg–Weyl and Grossmann–Royer Operators
We have seen that the Grossmann–Royer operators are involutions; more
generally we have the following result which is a generalization of the fact that
the product of two reﬂections is a translation:
Proposition 150. The Grossmann–Royer operators satisfy the product formula

TGR(z0) 
TGR(z1) = e−2i
ℏσ(z0,z1) 
T(2(z0 −z1))
(8.37)
for all z0, z1 ∈R2n.
Proof. We have

TGR(z0) 
TGR(z1)ψ(x) = 
TGR(z0)
!
e
2i
ℏp1·(2x0−x−x1)ψ(2x1 −x)
"
= e
2i
ℏp0·(x−x0)e
2i
ℏp1·(x−x1)ψ(2x1 −(2x0 −x))
= e
i
ℏΦψ(x −2(x0 −x1))
with
Φ = 2[(p0 −p1)x −p0x0 −p1x1 + 2p1x0].
On the other hand

T(2(z0 −z1))ψ(x) = e
i
ℏΦ′ψ(x −2(x0 −x1))
with
Φ′ = 2((p0 −p1)x −(p0 −p1)(x0 −x1)).
We have Φ −Φ′ = −2σ(z0, z1) hence the result.
□
8.3.3
Symplectic covariance
We have previously seen that the Heisenberg–Weyl operators 
T(z0) satisfy the
intertwining formula

S 
T(z0)
S−1 = 
T(Sz0).
We are going to see that a similar relation holds for the Grossmann–Royer oper-
ators.
Proposition 151. Let 
S ∈Mp(2n, R) and S = πMp(S). We have

S 
TGR(z0)
S−1 = 
TGR(Sz0)
(8.38)
for every z0 ∈R2n.
Proof. To prove formula (8.38) recall (Proposition 149) that we have

TGR(z0) = 
T(z0) 
TGR(0) 
T(z0)−1.

8.4.
Weyl–Heisenberg frames
107
It follows that

TGR(Sz0) = 
S 
T(z0)(
S−1
GR 
T(0)
S) 
T (z0)−1 
S−1.
It thus suﬃces to show that 
S−1
GR 
T(0)
S = 
TGR(0), and as above it is no restriction
to assume that 
S = 
SW,m. For ψ ∈S(Rn) we have, since 
TGR(0) is just a reﬂection
operator,

TGR(0)
SW,mψ(x) =

1
2πiℏ
n/2 ∆(W)
	
Rn e
i
ℏW(−x,x′)ψ(x′) dx′
=

1
2πiℏ
n/2 ∆(W)
	
Rn e
i
ℏW(−x,−x′′)ψ(−x′′) dx′
= 
SW,m 
TGR(0)ψ(x),
the last equality because W(−x, −x′′) = W(x, x′′) since W is a quadratic form.
For the same reason we have W(−x, x′) = W(x, −x′) and hence

TGR(0)
SW,mψ(x) =

1
2πiℏ
n/2 ∆(W)
	
Rn e
i
ℏW(x,−x′′)ψ(x′′) dx′
=

1
2πiℏ
n/2 ∆(W)
	
Rn e
i
ℏW(x,x′′)ψ(−x′′) dx′
=

1
2πiℏ
n/2 ∆(W)
	
Rn e
i
ℏW(x,x′′) 
TGR(0)ψ(x′′) dx′,
that is

TGR(0)
SW,mψ(x) = 
SW,m 
TGR(0)ψ
which proves our claim.
□
Exercise 152. Show that for every 
S ∈Mp(2n, R) there exists 
S′ ∈Mp(2n, R)
such that

S 
TGR(z0) = 
T(Sz0)
S′.
[Hint: Consider ﬁrst the case 
S = 
SW,m.]
8.4
Weyl–Heisenberg frames
This section aims at being a modest introduction to frame theory, especially to
Weyl–Heisenberg frames (which are also called Gabor frames in signal theory and
time-frequency analysis1). Our main sources are Christensen [26] and Gr¨ochenig
[82]. For a detailed study of the topic of varying the lattice of Gabor frames see
Feichtinger and Kaiblinger [53].
1Since Weyl–Heisenberg frames will be deﬁned using Heisenberg–Weyl operators, it would be bet-
ter to call them “Heisenberg–Weyl frames”. We are however complying here with the commonly
accepted terminology.

108
Chapter 8. Heisenberg–Weyl and Grossmann–Royer Operators
8.4.1
The notion of frame
Frames are generalizations of the notion of basis in a Hilbert space.
Deﬁnition 153. A frame in a Hilbert space H is a sequence (ψj)j = (ψj)j∈N in H
for which there exist a, b > 0 such that
a∥ψ∥2
H ≤

j
|(ψ|ψj)H|2 ≤b∥ψ∥2
H
(8.39)
for all ψ ∈H. The numbers a and b are called the lower and upper frame bounds,
respectively. If a = b then (ψj)j is called a tight frame; if a = b = 1 it is called a
normalized tight frame.
An orthonormal basis of H is a normalized tight frame since we always have
the identity

j
|(ψ|ψj)H|2 = ∥ψ∥2
H.
Notice that in the deﬁnition above one does not require that the vectors ψj are
linearly independent, even less that they form an orthonormal set. A tight frame
can of course always be normalized, replacing each ψj by a−1/2ψj.
Fundamental tools in the study of frames are the following operators:
• The frame operator: it is the operator 
F on H deﬁned by

Fψ =

j
(ψ|ψj)Hψj
(8.40)
for ψ ∈H;
• The synthesis (or reconstruction) operator: it is the operator 
R : ℓ2(N) −→H
deﬁned by

R[(cj)j] =

j
cjψj;
• The coeﬃcient (or analysis) operator: it is the operator 
C : H −→ℓ2(N)
deﬁned by

Cψ = ((ψ|ψj)H)j .
It is immediate to check that 
C = 
R∗and that 
F = 
C 
C∗. In particular 
F is
thus a positive and self-adjoint operator. Notice that when (ψj)j is an orthonormal
basis the frame operator is the identity. One shows – but we will not do it here
– that the series in the right-hand side of formula (8.40) is unconditionally con-
vergent, that is, 
j(ψ|ψϵ(j))Hψσ(j) < ∞for every permutation ϵ of N, in which
case the limit is the same regardless of ϵ. For a detailed study of the notion of
unconditional convergence see [82, §5.3].

8.4.
Weyl–Heisenberg frames
109
Proposition 154. The frame operator

F is an invertible positive self-adjoint
bounded operator on the complex Hilbert space H such that
a∥ψ∥2
H ≤( 
Fψ|ψ)H ≤b∥ψ∥2
H
(8.41)
for every ψ ∈H. Equivalently
aI ≤
F ≤bI
(8.42)
which means 
F −aI ≥0 and bI −
F ≥0.
Proof. As noticed above, the self-adjointness and positivity statements follow from
the formula 
F = CC∗. It can also be seen directly by noting that we have by
deﬁnition of 
F,
( 
Fψ|ψ)H =

j
(ψ|ψj)H(ψj|ψ)H =

j
|(ψ|ψj)H|2 .
(8.43)
The double inequality (8.41) immediately follows from (8.39). In view of (8.41) we
have, if ∥ψ∥H = 1,
0 < 1 −b−1( 
Fψ|ψ)H ≤b −a
b
< 1
hence the operator norm of I −b−1 
Fψ satisﬁes
∥I −b−1 
Fψ∥=
sup
∥ψ∥H=1
|(I −b−1 
Fψ|ψ)H < 1.
It follows that b−1 
F = I −(I −b−1 
F) is invertible, hence 
F is also invertible.
□
Using the frame operator we can construct a new frame, the so-called dual
frame ( 
F−1ψj)j:
Proposition 155. Let (ψj)j be a frame with frame operator 
F. Then ( 
F−1ψj)j is
also a frame with frame bounds b−1 and a−1 and frame operator 
F−1.
Proof. Let us show that
b−1∥ψ∥2
H ≤

j
|(ψ| 
F−1ψj)H|2 ≤a−1∥ψ∥2
H ;
(8.44)
this will prove that ( 
F−1ψj)j∈J is a frame with bounds b−1 and a−1. We ﬁrst
observe that since ( 
F−1)∗= 
F−1 we have

j
|(ψ| 
F−1ψj)H|2 =

j
|( 
F−1ψ|ψj)H|2

110
Chapter 8. Heisenberg–Weyl and Grossmann–Royer Operators
and hence, replacing ψ with 
F−1ψ in (8.43),

j
|(ψ| 
F−1ψj)H|2 = (ψ| 
F−1ψ)H = ( 
F−1ψ|ψ)H.
Because 
F and the identity commute with 
F−1 we can multiply both sides of
(8.42) which yields 
F−1 ≤a−1I and 
F−1 ≥b−1I so that b−1I ≤
F−1 ≤a−1I and
this is equivalent to (8.45).
b−1∥ψ∥2
H ≤( 
F−1ψ|ψ)H ≤a−1∥ψ∥2
H.
(8.45)
Let us show that ( 
F−1ψ|ψ)H = 
j |(ψ| 
F−1ψj)H|2 for every ψ ∈H, the identity
(8.44) will follow. Replacing ψ with 
Fψ this equality is equivalent to (ψ| 
Fψ)H =

j |( 
Fψ|ψj)H|2, which is just (8.43). There remains to prove that 
F−1 is the frame
operator for ( 
F−1ψj)j∈J. Let us denote by 
F′ this frame operator; by deﬁnition,

F′ψ =

j
(ψ| 
F−1ψj)H 
F−1ψj
= 
F−1 
j
( 
F−1ψ|ψj)Hψj
= 
F−1 
F( 
F−1ψ)
hence 
F′ = 
F−1.
□
Problem 156. Show that if the bounds a and b are optimal for the frame (ψj)j
then b−1 and a−1 are optimal bounds for the dual frame ( 
F−1ψj)j.
The following result shows why frames are important in harmonic analysis:
Proposition 157. Let (ψj)j be a frame with frame operator 
F. We have
ψ =

j
(ψ| 
F−1ψj)Hψj =

j
(ψ|ψj)H 
F−1ψj,
(8.46)
both series being unconditionally convergent for every ψ ∈H.
Proof. We have ψ = 
F[ 
F−1ψ] hence, by Deﬁnition (8.40) of 
F,
ψ =

j
( 
F−1ψ|ψj)Hψj =

j
(ψ| 
F−1ψj)Hψ
which proves the ﬁrst equality (8.46). The proof of the unconditional convergence
of the series is omitted (see Christensen [26]).
□

8.4.
Weyl–Heisenberg frames
111
This result shows that given a frame (ψj)j we can always write an arbitrary
function ψ ∈H as an unconditionally convergent series
ψ =

j
cjψj , (cj)j ∈ℓ2(N)
with coeﬃcients cj = ( 
F−1ψ|ψj)H. However, except in the case where (ψj)j is a ba-
sis, these coeﬃcients are not unique; it turns out that the choice cj = ( 
F−1ψ|ψj)H
is in a sense optimal: If (ψj)j is a frame with frame operator 
F then ψ = 
j cjψj
with (cj)j ∈ℓ2(N) implies that

j
|cj|2 ≥

j
|( 
F−1ψ|ψj)H|2
(see [82], Proposition 5.1.4, for a proof of this inequality). Let us give the following
deﬁnition:
Deﬁnition 158. Let (ψj)j be a frame with frame operator 
F. If each ψ ∈H
has a unique decomposition ψ = 
j cjψj (with coeﬃcients thus given by cj =
( 
F−1ψ|ψj)H) one says that (ψj)j is a Riesz basis of H.
Of course the frame operator of a Riesz basis is the identity. Moreover:
Proposition 159. A frame (ψj)j of H is a Riesz basis if and only if there exists
an orthonormal basis (φj)j of H and an invertible bounded operator T on H such
that ψj = T φj for each j ∈N.
For a proof of this result we refer to [82], Proposition 5.1.5, where alternative
necessary and suﬃcient conditions are also given.
8.4.2
Weyl–Heisenberg frames
Weyl–Heisenberg frames are traditionally deﬁned in time-frequency analysis using
the shift (= translation) and modulation operators Tx and Eω given by
Tx0ψ(x) = ψ(x −x0) , Eω0ψ(x) = e2πiω0·xψ(x).
(8.47)
Exercise 160. Show that these operators satisfy the commutation relation TxEω =
e−2πiω·xEωTx.
These operators are related to the Heisenberg–Weyl operators by the simple
(but important) formula

T(z) = eπip·xTxEp = Ep/2TxEp/2
(8.48)
when ℏ= 1/2π.
Consider Weyl–Heisenberg frames in terms of lattices. A lattice in phase space
R2n is a cocompact discrete subgroup of R2n; more precisely:

112
Chapter 8. Heisenberg–Weyl and Grossmann–Royer Operators
Deﬁnition 161. A lattice in R2n is a discrete subgroup Λ = M(Z2n) where M ∈
GL(2n, R). The number Vol(Λ) = det M is called the volume of the lattice Λ. The
lattice Λo = (M −1)∗(Z2n) is called the dual lattice of Λ. When M = αS with
S ∈Sp(2n, R) then Λ is called a symplectic lattice.
It is convenient in practice to choose M =

A
0n×n
0n×n
B

with A, B ∈
GL(n, R); we then have Λ = AZn × BZn. In many applications one even makes
the simpler choice M =

αIn×n
0n×n
0n×n
βIn×n

in which case the lattice is just Λ =
αZn × βZn.
Deﬁnition 162. Let φ ∈L2(Rn), φ ̸= 0 (“window”) and a lattice Λ. The set
G(φ, Λ) = { 
T(z)φ : z ∈Λ}
is called a Weyl–Heisenberg (or Gabor) system. If G(φ, Λ) is a frame, it is called a
Weyl–Heisenberg (or Gabor) frame. The corresponding frame operator is denoted
by Fφ,Λ; it is given for ψ ∈L2(Rn) by
Fφ,Λψ =

z∈Λ
(ψ| 
T(z)φ)L2(Rn) 
T(z)φ
(8.49)
and the right-hand side of this equality is called a Gabor expansion.
In Chapter 9 we will study in detail the cross-ambiguity function of a pair
(ψ, φ) of elements of L2(Rn); it is the function on L2(R2n) deﬁned by
A(ψ, φ)(z) =

1
2πℏ
n (ψ| 
T(z)φ)L2(Rn).
(8.50)
Given a Weyl–Heisenberg frame G(φ, Λ) it is easy to characterize the frame oper-
ator in terms of the cross-ambiguity function: we have
Fφ,Λψ = (2πℏ)n 
z∈Λ
A(ψ, φ)(z) 
T (z)φ.
(8.51)
In fact by Deﬁnition (8.40) of the frame operator we have
Fφ,Λψ =

z∈Λ
(ψ| 
T(z)φ)L2(Rn) 
T(z)φ,
hence (8.51). The cross-ambiguity function has the following symplectic covariance
property: for every 
S ∈Mp(2n, R) with projection S = πMp(
S) on Sp(2n, R) we
have
A(
Sψ, 
Sφ)(z) = A(ψ, φ)(S−1z);
(8.52)
this important property follows at once from formula (8.11) which we ﬁnd conve-
nient to rewrite here in the form

T(S−1z0) = 
S−1 
T (z0)
S
(8.53)
for further use.

8.4.
Weyl–Heisenberg frames
113
Proposition 163. Let G(φ, Λ) be a Weyl–Heisenberg frame and 
S ∈Mp(2n, R)
with projection S = πMp(
S). Then G(
Sφ, SΛ) is also a Weyl–Heisenberg frame
and the frame operators of G(φ, Λ) and G(
Sφ, SΛ) are related by the metaplectic
conjugation formula
F 
Sφ,SΛ = 
SFφ,Λ 
S−1.
(8.54)
Proof. In view of formulas (8.51) and (8.52) we have
Fφ,Λ 
S−1ψ =

z∈Λ
A(ψ, 
Sφ)(Sz) 
T (z)φ =

z∈SΛ
A(ψ, 
Sφ)(z) 
T (S−1z)φ
and hence, using (8.53),
Fφ,Λ 
S−1ψ =

z∈SΛ
A(ψ, 
Sφ)(z)
S−1 
T(z0)
Sφ
= 
S−1
$ 
z∈SΛ
A(ψ, 
Sφ)(z) 
T (z0)
Sφ
%
= 
S−1F 
Sφ,SΛ
proving formula (8.54).
□
8.4.3
A useful “dictionary”
In the time-frequency literature Weyl–Heisenberg frames are deﬁned using the
shift and modulation operators (8.47) and the Gabor expansion deﬁned above is
then replaced with
ψ =

(x,ω)∈Λ
(ψ|TxEωφ)TxEωψ.
(8.55)
It is therefore useful to have a “dictionary” allowing one to pass from one deﬁnition
to the other. Recalling that in the case ℏ= 1/2π the operators 
T(z) and TxEω
are related by the formula 
T(z) = eπip·xTxEω (ω = p) and hence
Fφ,Λψ =

z∈Λ
(ψ| 
T(z)φ)L2 
T(z)φ =

z∈Λ
(ψ|TxEpφ)L2TxEωφ
because we have (ψ| 
T (z)φ)L2 = e−πip·x(ψ|TxEωφ)L2. Thus, if ℏ= 1/2π both
Deﬁnitions (8.49) and (8.55) coincide. How about the general case? We observe
that the reduction to the former case can be easily made by setting p = 2πℏω:
we then have 
T(x, p) = eπiω·xTxEω so that (8.49) and (8.55) again are the same.
Thus:

T(x, 2πℏp) = eπiω·xTxEp.

114
Chapter 8. Heisenberg–Weyl and Grossmann–Royer Operators
It follows that we have the equality

z∈Λ
(ψ|TxEpφ)L2TxEpφ =

z∈Λ
(ψ| 
T(x, 2πℏp)φ)L2 
T(x, 2πℏp)φ.
(8.56)
Deﬁning the new lattice Λℏ=
I
0
0
2πℏI

Λ we get the important formula

z∈Λ
(ψ|TxEpφ)L2TxEpφ =

z∈Λℏ
(ψ| 
T (z)φ)L2 
T(z)φ
(8.57)
valid for arbitrary ℏ.
It is useful to rescale the window φ by using some dilation, to make it more
adequate for a quantum-mechanical use. For example, it is customary in time-
frequency analysis to work with the Gaussian window ψ0(x) = 2n/4e−πx2 while
one prefers to use the “coherent state” ψℏ
0(x) = (πℏ)−n/4e−x2/2ℏin quantum
mechanics; both functions are normalized in L2(Rn) and we have ψℏ
0 = ψ0 when
ℏ= 1/2π. Introducing the unitary scaling operator 
Mλ deﬁned for λ > 0 by

Mλψ(x) = λn/2ψ(λx)
we then have 
M√
2πℏψ0 = ψℏ
0 and 
M1/
√
2πℏψℏ
0 = ψ0. We notice that the operator

Mλ belongs to the metaplectic group Mp(2n, R); in fact 
Mλ = 
ML,0 with L = λI,
so that 
Mλ has projection
Mλ =
λI
0
0
λ−1I

∈Sp(2n, R).
(8.58)
A simple calculation shows that we have

T(x, 2πℏp)
M√
2πℏ= eπip·xTxEp
and hence

z∈Λ
(ψ| 
T(z)φ)L2 
T(z)φ =

z∈Λ
(ψ|TxEpφ)L2TxEωφ.
Proposition 164. For ψ, φ ∈L2(Rn) set ψℏ= 
M√
2πℏψ and φℏ= 
M√
2πℏφ. Let
G(φ, Λ) be a Gabor system with frame operator Fφ,Λ. Then G(φℏ,
√
2πℏΛ) is a
Gabor system with frame operator Fφ,
√
2πℏΛ such that
Fφ,
√
2πℏΛψℏ=

z∈
√
2πℏΛ
(ψℏ| 
T(z)φℏ)L2 
T(z)φℏ.
(8.59)

8.4.
Weyl–Heisenberg frames
115
Proof. We have
Fφ,Λψ =

z∈Λℏ
(ψ| 
T (z)φ)L2 
T(z)φ
=

z∈Λℏ
(ψ| 
T (z)
M√
2πℏφℏ)L2 
T(z)
M√
2πℏφℏ
that is
Fφ,Λψ =

z∈Λℏ
(ψ|
M√
2πℏ
T(M −1
√
2πℏz))L2 
M√
2πℏ
T(M −1
√
2πℏz)φℏ
since 
T(z)
M√
2πℏ= 
M√
2πℏ
T(M −1
√
2πℏz) in view of formula (8.53). Since the adjoint
of 
M√
2πℏis 
M −1
√
2πℏthe formula above is equivalent to

M −1
√
2πℏFφ,Λψ =

z∈Λℏ
(
M −1
√
2πℏψ| 
T(M −1
√
2πℏz))L2 
T(M −1
√
2πℏz)φℏ
=

z∈M√
2πℏΛℏ
(ψℏ| 
T(z)φℏ)L2 
T(z)φℏ.
Observing that by deﬁnition of Λℏand formula (8.58)
M −1
√
2πℏΛℏ=
√
2πℏI
0
0
(
√
2πℏ)−1I
 
I
0
0
2πℏI

Λ =
√
2πℏΛ
we thus have

M −1
√
2πℏFφ,Λψ =

z∈
√
2πℏΛ
(ψℏ| 
T(z)φℏ)L2 
T(z)φℏ.
Taking into account the metaplectic conjugation formula (8.54) we have

SF 
Sφ,SΛ = 
SFφ,Λ
and

M −1
√
2πℏFφ,Λψ = Fφℏ,
√
2πℏΛ 
M −1
√
2πℏψ = Fφℏ,
√
2πℏΛψℏ,
hence formula (8.59).
□
The result above allows us to restate the following necessary condition for a
Weyl–Heisenberg system to be a frame in terms of ℏ:
Proposition 165. Let Λαβ = αZn × βZn be a lattice in R2n, and G(φ, Λαβ) the
corresponding Gabor system.
(i) If G(φ, Λαβ) is a frame for L2(Rn) then we have αβ ≤2πℏ;
(ii) G(φ, Λαβ) is a Riesz basis for L2(Rn) if and only if it is a frame and αβ =
2πℏ;
(iii) G(φ, Λαβ) is an orthonormal basis for L2(Rn) if and only if it is a tight frame
and ∥φ∥L2 = 1 and αβ = 2πℏ.

116
Chapter 8. Heisenberg–Weyl and Grossmann–Royer Operators
For a proof of this result (in the case 2πℏ= 1) see [82], §7.5. The study
and even the statement of suﬃcient conditions for G(φ, Λαβ) to be a frame is
rather complicated; see Theorem 6.5.1 in [82] which proves a condition due to
Walnut [159].
A very interesting situation occurs when one chooses a Gaussian window
because Gaussians play a somewhat privileged role in both time-frequency analysis
and quantum mechanics. Unfortunately at the time we are writing one has a simple
necessary and suﬃcient condition only in the case n = 1:
Proposition 166. Let ψℏ
0(x) = (πℏ)−1/4e−x2/2ℏwith x ∈R and Λαβ = αZ × βZ.
The Gabor system G(ψℏ
0, Λαβ) is a frame for L2(R2) if and only if αβ < 2πℏ.
The proof of this result uses methods from complex analysis (see Lyubarski
[120] and Seip and Wallst´en [146]).

Chapter 9
Cross-ambiguity and
Wigner Functions
The Heisenberg–Weyl and Grossmann–Royer operators allow us to deﬁne in a
particular simple way two classical objects from symplectic harmonic analysis,
namely the cross-ambiguity and Wigner functions, which are symplectic Fourier
transforms of each other. Wigner introduced the eponymic distribution in 1932 as
a substitute for a phase space probability density, but he did that in an ad hoc
way, a kind of “lucky guess” one could say. It has since then been realized that
the Wigner distribution (and its companion, the cross-ambiguity function) have
a very natural meaning in Weyl calculus, and that they can be simply deﬁned in
terms of the Grossmann–Royer and Heisenberg–Weyl operators of last chapter.
9.1
The cross-ambiguity function
The cross-ambiguity function is a venerable object much used in harmonic anal-
ysis, and having many applications in signal theory, time-frequency analysis, and
engineering (for instance radar theory). We have already brieﬂy encountered it
when discussing Weyl–Heisenberg frames.
9.1.1
Deﬁnition of A(ψ, φ)
Recall that the Heisenberg–Weyl operator 
T(z0) is deﬁned by

T(z0)ψ = e
i
ℏ(p0·x−1
2 p0·x0)ψ0(x −x0)
where ψ ∈S(Rn) (or ψ ∈S′(Rn)).
Deﬁnition 167. Let ψ and φ be in S(Rn). The function (ψ, φ) −→A(ψ, φ) de-
ﬁned by
A(ψ, φ)(z) =

1
2πℏ
n (ψ| 
T (z)φ)L2(Rn)
(9.1)
 
117
M.A. de Gosson, Symplectic Methods in Harmonic Analysis and in Mathematical Physics,  
Pseudo-Differential Operators 7, DOI 10.1007/978-3-7643-9992-4_ , © Springer Basel AG 2011 
9

118
Chapter 9. Cross-ambiguity and Wigner Functions
is called the cross-ambiguity function (or transform). The function Aψ = A(ψ, ψ)
given by
Aψ(z) =

1
2πℏ
n (ψ| 
T(z)ψ)L2(Rn)
(9.2)
is called the (auto-)ambiguity function or sometimes, the Wigner–Fourier trans-
form of ψ.
Notice that formula (9.1) can be rewritten in the form
A(ψ, φ)(z) =

1
2πℏ
n ( 
T (z)ψ∨|φ∨)L2(Rn)
(9.3)
where ψ∨(x) = ψ(−x); this formula is somewhat useful and shows that
A(ψ, φ) = A(ψ∨, φ∨).
(9.4)
When ℏ= 1/2π and p is viewed as a frequency the function Aψ is also called
“radar ambiguity function” or “Woodward ambiguity function”.
Having in mind our applications to the case where ψ might be a tempered
distribution, we notice that Deﬁnition (9.1) might as well be written
A(ψ, φ)(−z) =

1
2πℏ
n ⟨
T(z)ψ, φ⟩
(9.5)
where ⟨
T(z)ψ, φ⟩is the distributional pairing of 
T(z)ψ and φ. This formula deﬁnes
unambiguously A(ψ, φ) when ψ ∈S′(Rn) and φ ∈S(Rn).
Exercise 168. Check the “following polarization identity” satisﬁed by the cross-
ambiguity function:
Re A(ψ, φ) = 1
4 [A(ψ + φ) −A(ψ −φ)] .
(9.6)
Exercise 169. In Chapter 8 we discussed the Stone–von Neumann theorem from the
point of representation theory. Show that the cross-ambiguity function is related
to the notion of “representation coeﬃcient” for the Schr¨odinger representation.
The cross-ambiguity function of (ψ, φ) ∈S(Rn) × S(Rn) is explicitly given
by the formula
A(ψ, φ)(z) =

1
2πℏ
n 	
Rn e−i
ℏp·x′ψ(x′ + 1
2x)φ(x′ −1
2x)dx′.
(9.7)
In fact, by deﬁnition of 
T(z) we have, setting z = (x, p),
A(ψ, φ)(z) =

1
2πℏ
n 	
Rn e
i
ℏ(p·x′′−1
2 p·x)ψ∨(x′′ −x)φ∨(x′′)dx′′
(9.8)
which is precisely (9.8) performing the change of variables x′′ = −x′ + 1
2x. The
ambiguity function is thus given by
Aψ(z) =

1
2πℏ
n 	
Rn e−i
ℏp·x′ψ(x′ + 1
2x)ψ(x′ −1
2x)dx′.
(9.9)

9.1.
The cross-ambiguity function
119
9.1.2
Elementary properties of the cross-ambiguity function
Here are some elementary continuity properties of the cross-ambiguity function:
Proposition 170. The cross-ambiguity function has the following properties:
(i) It is a continuous mapping S(Rn) × S(Rn) −→S(Rn ⊕Rn);
(ii) That mapping extends into a continuous mapping
A : L2(Rn) × L2(Rn) −→C0(Rn ⊕Rn) ∩L∞(Rn ⊕Rn)
such that
∥A(ψ, φ)∥∞≤∥ψ∥L2∥φ∥L2.
(9.10)
Proof of (i). In view of formula (9.8) and the fact that multiplication by the ex-
ponential e−i
2ℏp·x is a mapping S(Rn ⊕Rn) −→S(Rn ⊕Rn) it suﬃces to show
that the function F deﬁned by
F(z) =
	
Rn e
i
ℏp·x′ψ(x′ −x)φ(x′)dx′
is in S(Rn ⊕Rn) if ψ and φ are in S(Rn). Now, F is (up to a constant factor) the
partial Fourier transform in x′ of the mapping (x, x′) −→f(x, x′) = ψ(x′−x)φ(x′);
since f ∈S(Rn × Rn) the claim follows.
Proof of (ii). Using Deﬁnition (9.3) of A(ψ, φ) we have
|A(ψ, φ)(z0)| ≤

1
2πℏ
n 	
Rn | 
T(z0)ψ(−x)||φ(−x)|dx
≤
	
Rn |ψ(−x −x0)||φ(−x)|dx
=
	
Rn |ψ(x −x0)||φ(x)|dx,
hence, using the Cauchy–Schwarz inequality,
|A(ψ, φ)(z0)|2 ≤
	
Rn |ψ(x −x0)|2dx
2 	
Rn |φ(x)|2dx
2
that is
|A(ψ, φ)(z0)| ≤∥ψ∥L2∥φ∥L2.
Taking the supremum with respect to z0 we get the inequality (9.10). The fact
that A(ψ, φ) is continuous follows since S(Rn) is dense in L2(Rn).
□

120
Chapter 9. Cross-ambiguity and Wigner Functions
9.2
The cross-Wigner transform
The cross-Wigner function (or transform) is closely related to the cross-ambiguity
function using a symplectic Fourier transform. It is an object of choice for studying
quantum mechanics in phase space. The deﬁnition we give is a ﬁrst illustration of
the usefulness of Grossmann–Royer operators.
9.2.1
Deﬁnition and ﬁrst properties of W (ψ, φ)
Replacing the Heisenberg–Weyl operator by the Grossmann–Royer operator

TGR(z0)ψ(x) = e
2i
ℏp0·(x−x0)ψ(2x0 −x)
in Deﬁnition 167 yields the cross-Wigner transform:
Deﬁnition 171. Let ψ and φ be as in S(Rn). The function (ψ, φ) −→W(ψ, φ)
deﬁned by
W(ψ, φ)(z) =
 1
πℏ
n ( 
TGR(z)ψ|φ)L2(Rn)
(9.11)
is called the cross-Wigner transform, or function (it is sometimes also called the
Wigner–Moyal distribution). The function Wψ = W(ψ, ψ) is called the “Wigner
transform” of ψ (or “Wigner–Blokhintsev transform”).
As in the case for the cross-ambiguity function, we might rewrite this formula
in terms of distribution brackets as
W(ψ, φ)(z) =
 1
πℏ
n ⟨
TGR(z)ψ, φ⟩.
(9.12)
As for the cross-ambiguity function, we have an analytic expression for the cross-
Wigner function.
The formulas below are very often taken as a deﬁnition in the literature.
Proposition 172. The cross-Wigner transform is given by the explicit formula
W(ψ, φ)(z) =

1
2πℏ
n 	
Rn e−i
ℏp·yψ(x + 1
2y)φ(x −1
2y)dy,
(9.13)
hence the Wigner transform is given by
Wψ(z) =

1
2πℏ
n 	
Rn e−i
ℏp·yψ(x + 1
2y)ψ(x −1
2y)dy.
(9.14)
Proof. We have
( 
TGR(z0)ψ|φ)L2 =
	
Rn e
2i
ℏp0·(x−x0)ψ(2x0 −x)φ(x)dx.

9.2.
The cross-Wigner transform
121
Setting y = 2(x0 −x) this is
( 
TGR(z0)ψ|φ)L2 = 2−n
	
Rn e−i
ℏp0·yψ(x0 + 1
2y)φ(x0 −1
2y)dx
= (πℏ)n W(ψ, φ)(z0)
proving (9.14) in view of (9.11).
□
Clearly (ψ, φ) −→W(ψ, φ) is a sesquilinear mapping (as is the cross-am-
biguity function); it follows that we have the polarization identity
Re W(ψ, φ) = 1
4 [W(ψ + φ) −W(ψ −φ)]
(9.15)
(cf. formula (9.6) for the cross-ambiguity function).
The following property is obvious:
W(ψ, φ) = W(φ, ψ);
(9.16)
and hence, in particular
Wψ is always a real function.
The fact that Wψ is real has far-reaching consequences in quantum me-
chanics; this property allows Wψ to be viewed as the substitute for a probability
density; for instance, we will see later that Wψ has the “correct marginals” in the
sense that
	
Rn W(ψ, φ)(z)dp = ψ(x)φ(x),
(9.17)
	
Rn W(ψ, φ)(z)dx = Fψ(p)Fφ(p).
(9.18)
However, the Wigner function is not in general positive. In fact, a classical result
of Hudson [103] (also see Janssen [104]) tells us that Wψ is non-negative if and
only if ψ is a Gaussian, in fact:
Wψ ≥0 ⇔ψ(x) = CeM(x−x0)2
where M is a complex matrix with negative real eigenvalues and x0 ∈Rn.
Exercise 173. Assume that ψ ∈S(Rn) is an odd function: ψ(−x) = −ψ(x). Show
that Wψ takes negative values. [Hint: calculate Wψ(0).]
We also mention the following tensor-product properties: if x = (x′, x′′) with
x′ ∈Rk, x′′ ∈Rn−k and ψ′ ∈S(Rk), ψ′′ ∈S(Rn−k), then
A(ψ′ ⊗ψ′′) = A′ψ′ ⊗A′′ψ′′
(9.19)
and
W(ψ′ ⊗ψ′′) = W ′ψ′ ⊗W ′′ψ′′
(9.20)

122
Chapter 9. Cross-ambiguity and Wigner Functions
where A and A′ (resp. W ′ and W ′′) are the cross-ambiguity (resp. Wigner) trans-
forms on S(Rk) and S(Rn−k), in that order. More generally, we have
A(ψ′ ⊗ψ′′, φ′ ⊗φ′′) = A′(ψ′, φ′) ⊗A′′(ψ′′, φ′′)
(9.21)
and
W(ψ′ ⊗ψ′′, φ′ ⊗φ′′) = W ′(ψ′, φ′) ⊗W ′′(ψ′′, φ′′).
(9.22)
These formulas are useful for the study of so-called partial traces in quantum
mechanics.
9.2.2
Translations of Wigner transforms
The following result describes the behavior of the (cross) Wigner transform under
translations and Heisenberg–Weyl operators. Recall that T (z0) is the translation
operator z −→z+z0; it acts on functions or distributions F on R2n by T (z0)F(z) =
F(z −z0).
Proposition 174.
(i) For every ψ ∈L2(Rn) and z0 ∈R2n we have
W( 
T (z0)ψ, 
T(z0)φ)(z) = T (z0)W(ψ, φ)(z).
(9.23)
In particular
W( 
T(z0)ψ)) = T (z0)Wψ.
(9.24)
(ii) More generally, if ψ, φ ∈L2(Rn), then
W( 
T (z0)ψ, 
T(z1)φ)(z) = e−i
ℏ[σ(z,z0−z1)+ 1
2 σ(z0,z1)]W(ψ, φ)(z −⟨z⟩)
(9.25)
where ⟨z⟩= 1
2(z0 + z1).
Proof. The statements in (i) follow from (ii). Let us prove formula (9.25). We will
use the notation ⟨x⟩=
1
2(x0 + x1) and ⟨p⟩=
1
2(p0 + p1). By deﬁnition of the
Weyl–Heisenberg operators we have

T (z0)ψ(x + 1
2y) = e
i
ℏ[p0·(x+ 1
2 y)−1
2 p0·x0]ψ(x −x0 + 1
2y),

T(z1)φ(x −1
2y) = e
i
ℏ[p1·(x−1
2 y)−1
2 p1·x1]φ(x −x1 −1
2y)
and hence

T(z0)ψ(x + 1
2y) 
T(z1)φ(x −1
2y)
= e
i
ℏδ(z0,z1)e
i
ℏ⟨p⟩·yψ(x −x0 + 1
2y)φ(x −x1 −1
2y)
with
δ(z0, z1) = (p0 −p1) · x −1
2(p0 · x0 −p1 · x1).

9.3.
Relations between A(ψ, φ), W (ψ, φ), and the STFT
123
It follows that we have
W( 
T(z0)ψ, 
T(z1)φ)(z) =

1
2πℏ
n e
i
ℏδ(z0,z1)
×
	
Rn e−i
ℏ(p−⟨p⟩)·yψ(x −x0 + 1
2y)φ(x −x0 −1
2y)dy.
Performing the change of variables y′ = x1 −x0 + y in the integral this equality
becomes
W( 
T (z0)ψ, 
T(z1)φ)(z) =

1
2πℏ
n e
i
ℏ∆
×
	
Rn e−i
ℏ(p−⟨p⟩)·yψ(x −⟨x⟩+ 1
2y)φ(x −⟨x⟩−1
2y)dy
where the phase ∆is given by
∆= (p0 −p1) · x −(x0 −x1) · p + 1
2(p1 · x0 −p0 · x1)
= −σ(z, z0 −z1) −1
2σ(z0, z1)
hence formula (9.25).
□
The following particular case of formula (9.25) will be important in our study
of a certain pseudo-diﬀerential calculus in Chapter 18:
W( 
T(z0)ψ, φ)(z) = e−i
ℏσ(z,z0)W(ψ, φ)(z −1
2z0).
9.3
Relations between A(ψ, φ), W (ψ, φ),
and the STFT
The cross-ambiguity and cross-Wigner transform are related by a symplectic
Fourier transform; in addition, both can be expressed in terms of the short-time
Fourier transform used in signal theory and time-frequency analysis.
9.3.1
Two simple formulas
The deﬁnitions (and explicit expressions) of the cross-ambiguity and Wigner func-
tions are formally very similar. In this section we analyze these similarities in
detail, which leads us to some rather surprising results.
As claimed in the beginning of the chapter, the cross-ambiguity and Wigner
functions are symplectic transforms of each other. Let us prove this.
Proposition 175. Let (ψ, φ) ∈S′(Rn) × S′(Rn).
(i) We have
A(ψ, φ) = FσW(ψ, φ)
(9.26)
where Fσ is the symplectic Fourier transform; in particular Aψ = FσWψ.

124
Chapter 9. Cross-ambiguity and Wigner Functions
(ii) We have
A(ψ, φ)(z) = 2−nW(ψ, φ∨)( 1
2z)
(9.27)
where φ∨(x) = φ(−x).
Proof of (i). It is suﬃcient to assume that ψ and φ are in S(Rn). Set A =
(2πℏ)2nFσW(ψ, φ); by deﬁnition of Fσ and W(ψ, φ) we have
A(z) =
			
R3ne−i
ℏ[σ(z,z′)+p′·y]ψ(x′ + 1
2y)φ(x′ −1
2y)dp′dx′dy
=
			
R3ne−i
ℏp′·(y−x)e−i
ℏp·x′ψ(x′ + 1
2y)φ(x′ −1
2y)dp′dx′dy.
In view of the “Fourier inversion formula”
	
Rn e−i
ℏp′·(y−x)dp′ = (2πℏ)n δ(x −y)
we can rewrite the expression A as
A = (2πℏ)n
		
R2nδ(x −y)e−i
ℏp·x′ψ(x′ + 1
2y)φ(x′ −1
2y)dx′dy
= (2πℏ)n
	
Rn e−i
ℏp·x′ψ(x′ + 1
2x)φ(x′ −1
2x)dx′
hence A = A(ψ, φ). [The calculation of the integral in p′ is formal and should
be viewed in the distributional sense; the reader willing to attain full rigor might
want to redo the calculation using a distributional pairing ⟨FσW(ψ, φ), Φ⟩with
Φ ∈S(Rn ⊕Rn).]
Proof of (ii). We have, by deﬁnition of the cross-Wigner transform,
W(ψ, φ)( 1
2z) =

1
2πℏ
n 	
Rn e−i
2ℏp·yψ( 1
2x + 1
2y)φ( 1
2x −1
2y)dy
that is, setting x′ = 1
2y,
W(ψ, φ∨)( 1
2z) =
 1
πℏ
n 	
Rn e−i
ℏp·x′ψ( 1
2x + x′)φ( 1
2x −x′)dy′
=
 1
πℏ
n 	
Rn e−i
ℏp·y′ψ(y′ + 1
2x)φ∨(x′ −1
2x)dy′
hence (9.27) in view of formula (9.7).
□
We claim that:
Proposition 176. If (ψ, ψ′) ∈S′(Rn) × S′(Rn) then
Wψ = Wψ′ ⇐⇒ψ = eiαψ′ , α ∈R.
(9.28)

9.3.
Relations between A(ψ, φ), W (ψ, φ), and the STFT
125
Proof. It is suﬃcient to assume that ψ and φ are in S′(Rn). That both ψ and eiαψ
(α ∈R) have the same Wigner transform immediately follows from the deﬁnition
of Wψ. Suppose conversely that Wψ = Wψ′ and, for ﬁxed x, set
f(y) = ψ(x + 1
2y)ψ(x −1
2y),
f ′(y) = ψ′(x + 1
2y)ψ′(x −1
2y).
The equality Wψ = Wψ′ is then equivalent to the equality of the Fourier trans-
forms of f and f ′ and hence f = f ′ that is
ψ(x + 1
2y)ψ(x −1
2y) = ψ′(x + 1
2y)ψ′(x −1
2y)
for all x, y; taking y = 0 we get |ψ|2 = |ψ′|2 which proves (9.28).
□
There remains the question of the invertibility of the Wigner transform. We
will deal with that question in a moment.
We will see later (formula 10.26) that the cross-Wigner transform enjoys the
following very nice symplectic covariance property: if 
S is a metaplectic operator
with projections, the symplectic matrix S is then
W(
Sψ, 
Sφ)(z) = W(ψ, φ)(S−1z).
(9.29)
9.3.2
The short-time Fourier transform
A mathematical object closely related to the Wigner function is the short-time
Fourier transform used in signal theory and time-frequency analysis:
Deﬁnition 177. Let φ ∈S(Rn). The short-time Fourier transform (STFT) (or
windowed Fourier transform, or Gabor transform) with window φ ∈S(Rn) is the
mapping Vφ : S(Rn) −→S(Rn ⊕Rn) deﬁned by
Vφψ(z) =
	
Rn e−2πip·x′ψ(x′)φ(x′ −x)dx′.
(9.30)
We note the following rescaling result, whose (trivial) proof is left to the
reader as an exercise:
Lemma 178. For real λ ̸= 0 set ψλ(x) = ψ(λx). We have
Vφλψλ(x, p) = λ−nVφψ(λx, λ−1p).
(9.31)
Taking λ =
√
2πℏit is easy to see that the STFT and the cross-Wigner
transform are related by the formulae
W(ψ, φ)(z) =
 2
πℏ
n/2 e
2i
ℏp·xVφ∨
√
2πℏψ√
2πℏ

z
&
2
πℏ

(9.32)
where φ∨(x) = φ(−x); equivalently:
Vφψ(z) =
 2
πℏ
−n/2 e−iπp·xW(ψ1/
√
2πℏ, φ∨
1/
√
2πℏ)

z
&
πℏ
2

.
(9.33)

126
Chapter 9. Cross-ambiguity and Wigner Functions
Exercise 179. Verify in detail formulae (9.32) and (9.33) using the deﬁnitions.
Exercise 180. Prove the Moyal identity
⟨Vφψ, Vφ′ψ′⟩= ⟨ψ, ψ′⟩⟨φ, φ′⟩
(9.34)
for the short-time Fourier transform. (This formula is called by some authors the
“orthogonality relation for the STFT”. It is familiar in representation theory, and
apparently goes back to the 1940s; it is thus posterior to the Wigner transform.)
In particular, if one takes ℏ= 1/2π (which is the standard choice in time-
frequency analysis) one gets
W(ψ, φ)(z) = 2ne4πip·xVφ∨ψ(2z)
(9.35)
and
Vφψ(z) = 2−ne−iπp·xW(ψ, φ∨)( 1
2z).
(9.36)
These formulas will be used in Chapters 16 and 17 when we study the theory
of modulation spaces (they are usually deﬁned in terms of the STFT).
9.3.3
The Cohen class
The lack of positivity of the Wigner distribution Wψ which makes its interpre-
tation as a true probability density problematic has led to search for alternative
distributions Qψ. One of the most famous examples is Husimi’s distribution, which
is the convolution of the Wigner transform with a Gaussian function. More gen-
erally, we will say following Gr¨ochenig [82], §4.5, that Qψ belongs to the Cohen
class if it is of the type Qψ = Wψ ∗θ for some distribution θ ∈S′(Rn ⊕Rn). The
following result gives suﬃcient conditions for a distribution to belong to Cohen’s
class:
Proposition 181. Let Q : S(Rn) × S(Rn) −→S(Rn ⊕Rn) be a sesquilinear form
and set Qψ = Q(ψ, ψ). If Q is such that
Qψ(z −z0) = Q( 
T(z0)ψ)(z),
(9.37)
|Q(ψ, φ)(0, 0)| ≤∥ψ∥L2(Rn)∥φ∥L2(Rn)
(9.38)
for all ψ, φ in L2(Rn), then there exists θ ∈S′(Rn ⊕Rn) such that Qψ = Wψ ∗θ
for all ψ ∈S(Rn).
Proof. (Cf. [82], Theorem 4.5.1.) The condition (9.38) ensures us that (ψ, φ) −→
Q(ψ, φ)(0, 0) is a bounded sesquilinear form. Hence, by Riesz’s representation the-
orem there exists a bounded operator 
A on L2(Rn) such that Q(ψ, φ)(0, 0) =
⟨
Aψ, φ⟩. In view of the covariance formula (9.37) we have
Qψ(z0) = Q( 
T(−z0)ψ)(0)
= ⟨
A 
T(−z0)ψ, 
T(−z0)ψ⟩.

9.3.
Relations between A(ψ, φ), W (ψ, φ), and the STFT
127
In view of Schwartz’s kernel theorem there exists a distribution K ∈S′(Rn × Rn)
such that ⟨
Aψ, φ⟩= ⟨⟨K, ψ ⊗φ⟩⟩for all ψ, φ ∈S(Rn) (⟨⟨·, ·⟩⟩the distributional
bracket on S(R2n)) so that we can write
Qψ(z0) = ⟨⟨K, 
T(−z0)ψ ⊗
T(−z0)ψ⟩⟩
=
		
Rn×RnK(x, y) 
T (−z0)ψ(x) 
T (−z0)ψ(y)dxdy.
By deﬁnition of the Weyl–Heisenberg operators we have

T(−z0)ψ(x) = e
i
ℏ(−p0·x−1
2 p0·x0)ψ(x + x0)

T(−z0)ψ(y) = e−i
ℏ(−p0·y−1
2 p0·x0)ψ(y + x0)
and hence
Qψ(z0) =
		
Rn×RnK(x, y)e−i
ℏp0·(x−y)ψ(x + x0)ψ(y + x0)dxdy.
(9.39)
On the other hand, for every θ ∈S′(Rn ⊕Rn) we have
(Wψ ∗θ)(z0) =
	
Rn Wψ(z0 −z)θ(z)dz
(the integral being interpreted in the distributional sense) hence, in view of the
deﬁnition of the Wigner transform,
(Wψ ∗θ)(z0) =

1
2πℏ
n 			
Rn×Rn×Rne−i
ℏ(p0−p)·y′
× ψ(x0 −x′ + 1
2y′)ψ(x0 −x′ −1
2y′)θ(x′, p′)dpdx′dy′
that is, calculating the integral in the p variables,
(Wψ ∗θ)(z0) =

1
2πℏ
n/2 		
Rn×RnF −1
2
θ(x′, y′)e−i
ℏp0·y′
× ψ(x0 −x′ + 1
2y′)ψ(x0 −x′ −1
2y′)θ(x′, p′)dx′dy′
where F −1
2
θ is the partial inverse Fourier transform of θ in the second set of
variables. Making the change of variables x′ = −1
2(x + y), y′ = x −y we have
dx′dy′ = dxdy and the equality above becomes
(Wψ ∗θ)(z0) =

1
2πℏ
n/2		
Rn×RnF −1
2
θ(x, x −y)e−i
ℏp0·(x−y)
× ψ(x + x0)ψ(y + x0)dxdy.
(9.40)

128
Chapter 9. Cross-ambiguity and Wigner Functions
Comparing formulas (9.39) and (9.40) we see that Qψ = Wψ ∗θ where θ is
determined by the equality
K(x, y) =

1
2πℏ
n/2 F −1
2
θ(x, x −y)
that is
θ(x, p) = (2πℏ)n/2
	
Rn e−i
ℏp·yK(x, x −y)dy.
□
9.4
The Moyal identity
Moyal’s identity is a fundamental formula which will allow us later in this book
to construct wavepacket transforms; it has many uses in quantum mechanics and
time-frequency analysis.
9.4.1
Statement and proof
The Moyal identity, is valid for both the cross-Wigner and ambiguity functions.
It shows, in particular, that up to a constant factor the mapping ψ −→W(ψ, φ)
is, for each ﬁxed φ ∈L2(Rn), a partial isometry of L2(Rn) onto a closed subspace
of L2(R2n). This fact will be used in Chapter 18, where these mappings will be
used to intertwine ordinary Weyl calculus with “Bopp calculus”. Because of its
importance in both practical and theoretical considerations we dignify the result
as a theorem:
Theorem 182. The cross-Wigner and cross-ambiguity functions satisﬁes the
“Moyal identity”
(W(ψ, φ)|W(ψ′, φ′))L2(R2n) =

1
2πℏ
n (ψ|ψ′)L2(Rn)(φ|φ′)L2(Rn)
(9.41)
and
(A(ψ, φ)|A(ψ′, φ′))L2(R2n) =

1
2πℏ
n (ψ|ψ′)L2(Rn)(φ|φ′)L2(Rn)
(9.42)
for all (ψ, φ) ∈L2(Rn) × L2(Rn). Equivalently:
⟨W(ψ, φ), W(ψ′, φ′)⟩=

1
2πℏ
n ⟨ψ, ψ′⟩⟨φ, φ′⟩.
(9.43)
In particular
∥Wψ∥L2(R2n) =

1
2πℏ
n/2 ∥ψ∥L2(Rn).
(9.44)
Proof. It suﬃces to prove formula (9.41) since formula (9.42) immediately follows
using the fact that the symplectic Fourier transform is unitary (recall that the
cross-Wigner and ambiguity functions are symplectic Fourier transforms of each
other). Also, the equivalence of formulas (9.41) and (9.43) is obvious. Let us prove
(9.41). The scalar product
A = (2πℏ)2n(W(ψ, φ)|W(ψ′, φ′))L2(R2n)

9.4.
The Moyal identity
129
is given by the expression
	
R4n e−i
ℏp·(y−y′)ψ(x + 1
2y)ψ′(x + 1
2y′) φ(x −1
2y)φ′(x −1
2y′)dydy′dxdp.
The integral in p (interpreted as a distributional bracket) yields
	
Rn e−i
ℏp·(y−y′)dp = (2πℏ)nδ(y −y′)
and hence
A = (2πℏ)n
	
R3n ψ(x + 1
2y)ψ′(x −1
2y)φ(x + 1
2y)φ′(x −1
2y)dy′dx.
Setting u = x + 1
2y and v = x −1
2y we have dudv = dxdy hence
A = (2πℏ)n
	
Rn ψ(u)ψ′(u)du
 	
Rn φ(v)φ′(v)dv

which is (9.41).
□
Using Moyal’s identity we can prove:
Proposition 183. The cross-Wigner and ambiguity transforms (ψ, φ) −→W(ψ, φ)
and (ψ, φ) −→A(ψ, φ) extends into bilinear mappings
W : S′(Rn) × S′(Rn) −→S′(Rn),
(9.45)
A : S′(Rn) × S′(Rn) −→S′(Rn),
(9.46)
and we have
W : L2(Rn) × L2(Rn) −→L2(Rn ⊕Rn) ∩C0(Rn ⊕Rn),
(9.47)
A : L2(Rn) × L2(Rn) −→L2(Rn ⊕Rn) ∩C0(Rn ⊕Rn).
(9.48)
We have the following inequalities:
∥W(ψ, φ)∥∞≤
 1
πℏ
n ∥ψ∥L2(Rn)∥φ∥L2(Rn),
(9.49)
∥A(ψ, φ)∥∞≤
 1
πℏ
n ∥ψ∥L2(Rn)∥φ∥L2(Rn).
(9.50)
Proof. Let us show that W(ψ, φ) and A(ψ, φ) are square integrable if ψ and φ are.
The property for the Wigner transform W follows from Moyal’s identity (9.42).
That it is also true for the ambiguity function A follows from the relation A =
FσW and the fact that the symplectic Fourier transform is an automorphism of

130
Chapter 9. Cross-ambiguity and Wigner Functions
L2(Rn ⊕Rn). Let us show the continuity property. We have, using (9.41), the
integral deﬁnition of W(ψ, φ), and the Cauchy–Schwarz inequality,
∥W(ψ, φ)∥∞= sup
z∈R2n |W(ψ, φ)(z)|
≤

1
2πℏ
n 	
Rn |ψ(x + 1
2y)||φ(x −1
2y)|dy
≤

1
2πℏ
n
	
Rn |ψ(x + 1
2y)|2dy
1/2 	
Rn |φ(x −1
2y)|2dy
1/2
,
hence the inequality (9.49) since we have
	
Rn |ψ(x + 1
2y)|2dy
1/2
= 2n/2∥ψ∥L2(Rn),
	
Rn |φ(x −1
2y)|2dy
1/2
= 2n/2∥φ∥L2(Rn).
The inequality (9.50) is proven by a similar argument.
□
Let us mention, without proof (see [82], Theorem 3.3.2) that the cross-Wigner
transform satisﬁes the “Lieb inequality”
	
R2n |W(ψ, φ)|q(z)dz ≤Cq

∥ψ∥Lq(Rn)∥ψ∥Lq(Rn)
 q
for 2 ≤q < ∞. Here Lq(Rn) is the space of all complex functions on Rn such that
∥ψ∥Lq(Rn) =
	
Rn |ψ(x)|qdx
1/q
< ∞.
9.4.2
An inversion formula
Moyal’s formula also allows us to prove the following important inversion formula
for the Wigner function; it is important because it also yields a formula for the
adjoint mapping of ψ −→W(ψ, φ) and because it will allow us later in this book
to prove a fundamental property of modulation spaces.
Proposition 184. Let (φ, γ) ∈L2(Rn) × L2(Rn) be such that (γ|φ)L2(Rn) ̸= 0. For
every ψ ∈S′(Rn) we have
ψ(x) =
2n
(γ|φ)L2(Rn)
	
R2n W(ψ, φ)(z0) 
TGR(z0)γ(x)dz0.
(9.51)
Proof. Let us denote by χ(x) the right-hand side of (9.51):
χ(x) =
2n
(γ|φ)L2(Rn)
	
R2n W(ψ, φ)(z0) 
TGR(z0)γ(x)dz0.

9.4.
The Moyal identity
131
This function is well deﬁned since W(ψ, φ) ∈L2(Rn ⊕Rn) in view of Moyal’s
identity (9.41). For any α ∈S(Rn) we have
(χ|α) =
2n
(γ|φ)L2
	
R2n W(ψ, φ)(z)( 
TGR(z)γ|α)L2dz.
Recalling (formula (9.11)) that by deﬁnition
W(ψ, φ)(z) =
 1
πℏ
n ( 
TGR(z)ψ|φ)L2,
we thus have the sequence of equalities
(χ|α) = (2πℏ)n
(γ|φ)L2
	
R2n W(ψ, φ)(z)W(γ, α)dz
= (2πℏ)n
(γ|φ)L2
	
R2n W(ψ, φ)(z)W(α, γ)dz
= (2πℏ)n
(γ|φ)L2 (W(ψ, φ)|W(α, γ))L2
(the second equality because W(γ, α) = W(α, γ)). Applying Moyal’s identity
(9.41) to (W(ψ, φ)|W(α, γ)) we get
(χ|α)L2 =
 1
2πℏ
n (2πℏ)n
(γ|φ) (ψ|α)L2(φ|γ)L2 = (ψ|α)L2.
Since this identity holds for all α ∈S(Rn) we have χ = ψ almost everywhere,
which proves formula (9.51).
□
An interesting consequence of the result above is the following; it will be
useful in our study of modulation spaces:
Corollary 185. Let φ ∈S(Rn), φ ̸= 0. The following properties are equivalent:
(i) ψ ∈S(Rn);
(ii) W(ψ, φ) ∈S(Rn ⊕Rn);
(iii) For every N ≥0 there exists CN ≥0 such that
|W(ψ, φ)| ≤CN(1 + |z|)−N.
Proof. We already know that (i)=⇒(ii). That (ii)=⇒(iii) is obvious in view of
the deﬁnition of S(Rn ⊕Rn). There remains to prove that (iii)=⇒(i). It is easily
veriﬁed that the function χ deﬁned by
χ(x) =
2n
∥φ∥L2
	
R2n W(ψ, φ)(z) 
TGR(z)φ(x)dz
is in S(Rn); but then χ = ψ in view of the proof of Proposition 184 since (iii)
implies in particular that W(ψ, φ) ∈L2(Rn ⊕Rn). Thus ψ ∈S(Rn) and we are
done.
□

132
Chapter 9. Cross-ambiguity and Wigner Functions
Exercise 186. Check that we indeed have χ ∈S(Rn) by using one of the deﬁnitions
of the space S(Rn).
One also proves the following extension of Proposition 184:
Corollary 187. Assume that W(ψ, φ) = O(|z|m) for |z| →∞(m ∈R). The
inversion formula (9.51) still holds under the assumption ψ ∈S′(Rn).
Proof. The result is obtained by reﬁning the proof above, cf. Gr¨ochenig [82], Corol-
lary 11.2.7.
□
Here is an interesting application of the Moyal identity to orthonormal bases,
which does not seem to be universally known, and which we will use several times
in this book (in particular to establish a trace formula for a product of two Weyl
operators, and to study the spectral properties of the “Bopp operators” that will
be introduced in Chapter 18). This result shows that to each orthonormal basis
of L2(Rn) we can associate an orthonormal basis of L2(Rn ⊕Rn) using the cross-
Wigner transform. Since we will prove this result in a more general setting in
Chapter 18 (Theorem 442) we just outline the argument here.
Proposition 188. Let (ψj)j be an orthonormal basis of L2(Rn). The vectors Φj,k =
(2πℏ)n/2W(ψj, ψk) form an orthonormal basis of L2(Rn ⊕Rn).
Proof. We have, using Moyal’s identity (9.41),
(Φj,k|Φj′,k′)L2 = (2πℏ)n(W(ψj, ψk)|W(ψj′, ψk′))L2
= (ψj|ψj′)L2(ψk|ψk′)L2
hence the Φj,k form an orthonormal system. There remains to show that if Ψ ∈
L2(Rn ⊕Rn) is orthogonal to the family (Φj,k)j,k then Ψ = 0. This is done using
the properties of the adjoint of the linear mapping ψj −→W(ψj, ψk) and formula
(9.51) above.
□
9.5
Continuity and growth properties
In this section we study some global properties of the cross-Wigner and ambiguity
transforms.
9.5.1
Continuity of A(ψ, φ) and W (ψ, φ)
We begin by stating two formulas, the proof of which is left to the reader (they are
obtained quite easily by using Leibniz’s formula for the product of two functions).

9.5.
Continuity and growth properties
133
Let ψ ∈S(Rn) (or S′(Rn)) and α, β ∈Nn two multi-indices. We deﬁne
∂α
x = ∂α1
x1 · · · ∂αn
xn and xβ = xβ1 · · · xβn. We have:
∂α
x xβ 
T(z)ψ =

γ≤α,δ≤β
cαβγδxδpγ 
T(z)(∂α−γ
x
xβ−δψ),
(9.52)
∂α
x xβ 
TGR(z)ψ =

γ≤α,δ≤β
dαβγδxδpγ 
TGR(z)(∂α−γ
x
xβ−δψ)
(9.53)
where the cαβγδ and dαβγδ are complex constants and γ ≤α means γj ≤αj for
j = 1, 2, . . . , n.
We will need the following result which is genuinely interesting in its own
right:
Proposition 189. The maps z −→
T(z) and z −→
TGR(z) are strongly continuous
on S(Rn) and weakly ∗-continuous on S′(Rn).
Proof. Let us prove the two claims for the map z −→
T(z); the proof for z −→

TGR(z) is identical, replacing the coeﬃcient cαβγδ by dαβγδ. Let ψ ∈S(Rn). Since

T(z) acts linearly on functions we have to show that, for all multi-indices α and
β, we have
lim
|z|→0 ∥∂α
x xβ( 
T(z)ψ −ψ)∥∞= 0
where ∥ψ∥∞= sup |ψ|. In view of formula (9.52) we have
∥∂α
x xβ( 
T(z)ψ −ψ)∥∞≤∥( 
T(z)(∂α
x xβψ) −(∂α
x xβψ)∥∞
+

0<γ≤α
0<δ≤β
cαβγδ|xδpγ| ∥
T(z)(∂α−γ
x
xβ−δψ)∥∞.
It is clear that
lim
|z|→0 |xδpγ| ∥
T(z)(∂α−γ
x
xβ−δψ)∥∞= 0
since γ ̸= 0, δ ̸= 0. There remains to show that
lim
|z|→0 ∥( 
T(z)(∂α
x xβψ) −(∂α
x xβψ)∥∞= 0.
This is clear if ψ is compactly supported, i.e., ψ ∈C∞
0 (Rn). The convergence in
the general case follows from the density of C∞
0 (Rn) in S(Rn). There remains to
prove the statement about S′(Rn). Assume that ψ ∈S′(Rn) and φ ∈S(Rn); we
have
lim
|z|→0⟨
T (z)ψ, φ⟩= lim
|z|→0⟨ψ, 
T(−z)φ⟩= ⟨ψ, φ⟩
and hence 
T(z) is weakly ∗-continuous on S′(Rn) as claimed.
□
Let us now prove the main result of this subsection.

134
Chapter 9. Cross-ambiguity and Wigner Functions
Theorem 190. Let ψ ∈S′(Rn) and φ ∈S(Rn). Then:
(i) Both A(ψ, φ) and W(ψ, φ) are continuous functions:
A(ψ, φ) ∈C0(Rn ⊕Rn) and W(ψ, φ) ∈C0(Rn ⊕Rn);
(9.54)
(ii) There exist constants C, C′ > 0 and µ, µ′ such that
|A(ψ, φ)(z)| ≤C(1 + |z|)µ,
(9.55)
|W(ψ, φ)(z)| ≤C′(1 + |z|)µ′
(9.56)
for all z ∈R2n.
Proof of (i). The continuity statements for A(ψ, φ) and W(ψ, φ) are immediate
consequences of Proposition 189.
Proof of (ii). In view of formula (9.27) relating A(ψ, φ) and W(ψ, φ) it is suﬃcient
to prove the estimate for the cross-ambiguity function. Recalling that
A(ψ, φ)(z) =

1
2πℏ
n ⟨
T (−z)ψ, φ⟩
(formula (9.5)), we have, since ψ ∈S′(Rn) and using inequality (9.52),
|A(ψ, φ)(z)| ≤C

|α|≤M
|β|≤N
∥∂α
x xβ 
T(z)φ∥∞
≤C′ 
|α|≤M
|β|≤N

γ≤α
δ≤β
xδpγ∥∂α−γ
x
xβ−δφ∥∞.
Since φ ∈S(Rn) we have ∥∂α−γ
x
xβ−δφ∥∞< ∞so that the right-hand side of the
last inequality is a polynomial in z = (x, p); the estimate |A(ψ, φ)(z)| ≤C(1+|z|)µ
follows.
□
9.5.2
Decay properties of A(ψ, φ) and W (ψ, φ)
We are going to see that it suﬃces with a decay property of A(ψ, φ) and W(ψ, φ)
which does not invoke derivatives to prove that ψ and φ are both in S(Rn). This
result will have several pleasant consequences, which will be fully exploited when
we study modulation spaces. We begin with a preparatory result.
Lemma 191. Let φ ∈S(Rn) and let Ψ be a function deﬁned on R2n and such that
for every N ≥0 there exists CN > 0 such that
|Ψ(z)| ≤CN(1 + |z|)−N.
(9.57)
Then, the function θ deﬁned by
θ(x) =
	
R2n Ψ(z0) 
TGR(z0)φ(x)dz0
(9.58)
is in S(Rn).

9.5.
Continuity and growth properties
135
Proof. The integral in the right-hand side of (9.58) is obviously absolutely conver-
gent in view of the assumption (9.57). Things do not change for
∂α
x xβθ(x) =
	
R2n Ψ(z0)(∂α
x xβ 
TGR(z0))φ(x)dz0
as is easily checked using the estimate (9.53) (we leave the task of writing explicit
inequalities to the reader as a technical exercise); it follows that ∥∂α
x xβθ(x)∥∞< ∞
so that θ ∈S(Rn) as claimed.
□
Let us now prove:
Proposition 192. Let φ ∈S(Rn) and ψ ∈S′(Rn). Then the following four proper-
ties are equivalent:
(i) ψ ∈S(Rn);
(ii) W(ψ, φ) ∈S(Rn ⊕Rn);
(iii) A(ψ, φ) ∈S(Rn ⊕Rn);
(iv) For every N ≥0 there exist CN, C′
N > 0 such that
|W(ψ, φ)(z)| ≤CN(1 + |z|)−N,
(9.59)
|A(ψ, φ)(z)| ≤C′
N(1 + |z|)−N.
(9.60)
Proof. That (i)=⇒(ii) was established in Proposition 170. We have (ii)=⇒(iii)
because A(ψ, φ) and W(ψ, φ) are (symplectic) Fourier transforms of each other
(alternatively use formula (9.27). That (ii) or (iii)=⇒(iv) is obvious by deﬁnition
of S(Rn ⊕Rn). Let us show that (iv)=⇒(i). Choosing Ψ = W(ψ, φ) in Lemma 191
above we have ψ ∈S(Rn) in view of the inversion formula (9.51).
□
An interesting consequence of this result is:
Corollary 193. For every φ ∈S(Rn), φ ̸= 0, the seminorms ψ −→∥ψ∥φ where
∥ψ∥s,φ = sup
z∈R2n [(1 + |z|)sW(ψ, φ)(z)]
deﬁne the topology of S(Rn).
Proof. That the ∥· ∥s,φ are seminorms on S(Rn) is obvious in view of the equiva-
lence (i)⇐⇒(iv) in the proposition above. Let us show that the seminorms ∥· ∥s,φ
are equivalent to the usual seminorms
∥ψ∥αβ = sup
x∈Rn |∂β
xxαψ(x)| = ∥∂β
xxαψ∥
on S(Rn). By the inversion formula (9.51) we have
|∂β
xxαψ(x)| ≤
2n
∥φ∥2
L2
	
R2n |W(ψ, φ)(z0)||∂β
xxα 
TGR(z0)φ(x)|dz

136
Chapter 9. Cross-ambiguity and Wigner Functions
and hence, using the estimate (9.53), there exists a polynomial function P such
that
∥∂β
xxαψ∥∞≤C
	
R2n |W(ψ, φ)(z0)|P(z0)|dz;
note that the integral on the right side is absolutely convergent in view of the
estimates (9.59). Setting m = deg P(z) we have
∥∂β
xxαψ∥∞≤C′
	
R2n |W(ψ, φ)(z)(1 + |z|)mdz
≤C′
	
R2n |W(ψ, φ)(z)(1 + |z|)m+2n+1dz
×
	
R2n(1 + |z|)−2n−1dz
that is
∥∂β
xxαψ(x)∥∞≤C′′∥ψ∥m+2n+1,φ.
But this estimate implies that the identity operator ψ −→ψ from S(Rn) equipped
with the topology deﬁned by the seminorms ∥ψ∥s,φ onto S(Rn) equipped with the
usual topology is continuous. The open mapping theorem for the Fr´echet space
S(Rn) then implies that the identity operator is an isomorphism, and we are thus
done.
□

Chapter 10
The Weyl Correspondence
This chapter introduces and discusses the basics of “Weyl correspondence”, or
“Weyl quantization” as it is also called. It is today the preferred quantization
procedure in physics, for reasons that will be discussed (one of the main features
of the Weyl correspondence is that it is the only pseudo-diﬀerential quantization
procedure which is symplectically covariant). It is in a sense the natural general-
ization of the Schr¨odinger correspondence rule xp −→1
2(
p
x + 
x
p) from the early
days of quantum mechanics as discussed in Section 1.3.3 of the ﬁrst chapter.
10.1
The Weyl correspondence
The material developed in the previous two chapters gives us all the elements we
need to deﬁne the Weyl correspondence a
Weyl
←→
A in a simple way, without having
to invoke pseudo-diﬀerential calculus (our approach, which is common in quan-
tum mechanics and time-frequency analysis) has the advantage of immediately
allowing the use of quite general symbols. It also immediately makes explicit the
relation between the Weyl correspondence and related objects such as the Wigner
transform.
We begin by deﬁning the notion of Weyl operator in terms of the Heisen-
berg–Weyl and Grossmann–Royer operators. We will thereafter give equivalent
deﬁnitions using the cross-ambiguity and Wigner functions.
10.1.1
First deﬁnitions and properties
Recall the deﬁnitions of the Heisenberg–Weyl and Grossmann–Royer operators:

T(z0)ψ = e
i
ℏ(p0·x−1
2 p0·x0)ψ(x −x0),

TGR(z0)ψ(x) = e
2i
ℏp0·(x−x0)ψ(2x0 −x).
137
M.A. de Gosson, Symplectic Methods in Harmonic Analysis and in Mathematical Physics,  
Pseudo-Differential Operators 7, DOI 10.1007/978-3-7643-9992-4_
, © Springer Basel AG 2011 
10

138
Chapter 10.
The Weyl Correspondence
Deﬁnition 194. Let a ∈S(Rn⊕Rn) and aσ = Fσa be the symplectic Fourier trans-
form of a. The Weyl operator with symbol a is the linear operator 
A : S(Rn) −→
S(Rn) deﬁned by

Aψ(x) =

1
2πℏ
n 	
R2n aσ(z0) 
T(z0)ψ(x)dz0;
(10.1)
equivalently,

Aψ(x) =
 1
πℏ
n 	
R2n a(z0) 
TGR(z0)ψ(x)dz0.
(10.2)
We will write 
A
Weyl
←→a or a
Weyl
←→
A (“Weyl correspondence”). The function aσ is
called the “twisted” (or covariant) symbol of 
A.
The fact that a ∈S(Rn ⊕Rn) ensures us that 
A : S(Rn) −→S(Rn) is clear.
In fact:
Proposition 195. If a ∈S(Rn ⊕Rn) then 
A
Weyl
←→a is a continuous operator
S(Rn) −→S(Rn) and hence extends into a continuous operator S′(Rn) −→
S′(Rn).
Proof. We only sketch the proof and leave the details to the reader as an exercise.
If a ∈S(Rn ⊕Rn) and ψ ∈S(Rn) then the function z0 −→a(z0)(xα∂α
x ) 
TGR(z0)ψ
belongs to S(Rn ⊕Rn) for all multi-indices α ∈Nn, hence |(xα∂α
x ) 
Aψ(x)| < ∞for
all α ∈Nn; the property follows.
□
We can rewrite these deﬁnition in slightly more compact form as

A =

1
2πℏ
n 	
R2n aσ(z0) 
T (z0)dz0
and

A =
 1
πℏ
n 	
R2n a(z0) 
TGR(z0)dz0
where the integrals are interpreted as Bochner integrals (that is, operator-valued
integrals).
Exercise 196. Prove the equivalence of Deﬁnitions (10.1) and (10.2).
These formulas already make quite “obvious” the fact that we will be able to
extend the deﬁnition of the Weyl correspondence to much larger classes of symbols
than the Schwartz functions. This can be seen by rewriting the deﬁnition of 
A in
terms of the distributional brackets ⟨⟨·, ·⟩⟩on R2n:

Aψ =

1
2πℏ
n ⟨⟨aσ(·), 
T (·)ψ⟩⟩=
 1
πℏ
n ⟨⟨a(·), 
TGR(·)ψ⟩⟩.
(10.3)
The notation 
A
Weyl
←→a or a
Weyl
←→
A introduced in the deﬁnition above suggests
that the Weyl correspondence is one-to-one. In the following Proposition we show
that this indeed the case:

10.1.
The Weyl correspondence
139
Proposition 197. The Weyl correspondence a
Weyl
←→
A is linear and one-to-one:
(i) If a
Weyl
←→
A and a′ Weyl
←→
A then a = a′.
(ii) In particular 1
Weyl
←→I where I is the identity operator on S′(Rn).
Proof of (i). The linearity of the correspondence a
Weyl
←→
A is obvious; to show that
it is one-to-one it thus suﬃces to show that if 
Aψ = 0 for all ψ ∈S(Rn) then a = 0.
But 
Aψ = 0 is equivalent, by the second formula (10.3), to ⟨a(·), 
TGR(·)ψ⟩= 0,
that is to a = 0 since ψ ∈S(Rn) is arbitrary.
Proof of (ii). To show that if a = 1 then 
A is the identity it suﬃces to note that
by the second formula (10.3) we have

Aψ(x) =
 1
πℏ
n ⟨⟨1, 
TGR(·)ψ(x)⟩⟩
=
	
Rn
	
Rn e
2i
ℏp0·(x−x0)dp0

ψ(2x0 −x)dx0
=
	
Rn δ(2(x −x0))ψ(2x0 −x)dx0 = ψ(x)
so that 
Aψ = ψ for all ψ ∈S(Rn). By continuity, using the density of S(Rn), we
also have 
Aψ = ψ for all ψ ∈S′(Rn) hence 
A = I on S′(Rn).
□
Property (ii) in the proposition above is a particular case of the following
interesting result which determines explicitly the Weyl symbol of the Heisenberg–
Weyl operator:
Proposition 198. The operator with Weyl symbol z →e−i
ℏσ(z,z0) is the Heisen-
berg–Weyl operator 
T(z0).
Proof. Let us write az0(z) = e−i
ℏσ(z,z0). Let 
Az0 be the operator with Weyl symbol
az0. We have, by the second formula (10.3),

Az0ψ(x) =
 1
πℏ
n 		
Rn×Rn e−i
ℏσ(z,z′)e
2i
ℏp0·(x−x0)ψ(2x0 −x)dp0dx0
=
 1
πℏ
n 		
Rn×Rn e
i
ℏp′·x0e
i
ℏp0·(x′+2x0−2x)ψ(2x0 −x)dp0dx0
=
 1
πℏ
n 	
Rn e
i
ℏp′·x0
	
Rn e
i
ℏp0·(x′+2x0−2x)dp0

ψ(2x0 −x)dx0
= 2n
	
Rn e
i
ℏp′·x0δ(x′ + 2x0 −2x)ψ(2x0 −x)dx0.
Setting y = 2x0 we get

Az0ψ(x) =
	
Rn e
i
ℏp′·x0δ(y −(2x −x′))ψ(2x0 −x)dx0 = e
i
ℏ(p′·x−1
2 p′·x′)ψ(x −x′)
which concludes the proof.
□

140
Chapter 10.
The Weyl Correspondence
Taking into account the diﬀerential expression (8.7) of the Heisenberg–Weyl
operator we thus have
e−i
ℏσ(ˆz,z0) Weyl
←→e−i
ℏσ(z,z0).
(10.4)
As a consequence of Schwartz’s kernel theorem, every continuous operator
S(Rn ⊕Rn) −→S′(Rn ⊕Rn) is a Weyl operator for a suitable symbol (usually a
tempered distribution); we will prove this in a moment, but let us for the moment
show that the notion of Weyl operator makes sense even when the symbol is not
a function, but a distribution. A ﬁrst constraint comes from the fact that the
symplectic Fourier transform aσ = Fσa must be deﬁned. This is however a minor
limitation because Fσ is an isomorphism S′(Rn ⊕Rn) −→S′(Rn ⊕Rn) and we
are thus authorized to use any tempered distributions as a symbol. Since we have,
for ψ, φ ∈S(Rn),
⟨
Aψ, φ⟩=
		
R2n×R
aσ(z0) 
T(z0)ψ(x)φ(x)dz0dx,
(10.5)

A is deﬁned in the weak sense by:
⟨
Aψ, φ⟩= ⟨aσ, Φ⟩
, Φ(z0) = ⟨
T (z0)ψ, φ⟩.
(10.6)
Proposition 199. If a ∈S′(Rn ⊕Rn) then 
A : S(Rn) −→S′(Rn).
Proof. The condition a ∈S′(Rn ⊕Rn) is equivalent to aσ ∈S′(Rn ⊕Rn) hence
it is suﬃcient to show that Φ deﬁned in (10.6) is in S(Rn ⊕Rn). But this follows
from Lemma 170.
□
Let us now return to formula (10.8) which, as we said, can be taken as an
alternative deﬁnition of the Weyl correspondence. Choosing φ = ψ this formula
implies, since Wψ = W(ψ, ψ):
( 
Aψ|ψ)L2(Rn) =
	
R2n a(z)Wψ(z)dz.
More about the properties of the Weyl correspondence in a moment; we are
ﬁrst going to rewrite the deﬁnition of 
A in two equivalent ways using the cross-
Wigner and ambiguity transforms.
10.1.2
Deﬁnition using the Wigner transform
The following result can be taken as an alternative deﬁnition of the Weyl operator
with symbol a; it also makes obvious the fact that the Weyl correspondence extends
to symbols a ∈S′(Rn ⊕Rn).

10.1.
The Weyl correspondence
141
Proposition 200. Let (ψ, φ) ∈S(Rn) × S(Rn) and assume that 
A
Weyl
←→a is a
mapping S(Rn) −→L2(Rn). We have both
( 
Aψ|φ)L2(Rn) =
	
R2n aσ(z)A(ψ, φ)(−z)dz
(10.7)
and
( 
Aψ|φ)L2(Rn) =
	
R2n a(z)W(ψ, φ)(z)dz.
(10.8)
Proof. It is suﬃcient to assume that a ∈S(Rn ⊕Rn). We have
( 
Aψ|φ)L2 =

1
2πℏ
n 	
Rn
	
R2n aσ(z0)
	
Rn

T(z0)ψ(x)dz0

φ(x)dx
and hence, by Fubini’s theorem,
( 
Aψ|φ)L2 =

1
2πℏ
n 	
R2n aσ(z0)
	
Rn

T(z0)ψ(x)φ(x)dx

dz0
that is, in view of Deﬁnition (9.1) of the cross-Wigner transform,
( 
Aψ|φ)L2 =
	
R2n aσ(z0)A(ψ, φ)(−z0)dz0
which is formula (10.7). In view of formula (9.26) we have
A(ψ, φ)(−z0) = FσW(ψ, φ)(−z0)
and hence, by Plancherel’s formula (8.31) for the symplectic Fourier transform
( 
Aψ|φ)L2 =
	
R2n Fσa(z0)A(ψ, φ)(−z0)dz0
=
	
R2n a(z0)FσA(ψ, φ)(−z0)dz0
which is formula (10.8) since FσA(ψ, φ) = W(ψ, φ) (see formula (9.26)).
□
The formulas above can be easily extended to the distributional case using
Proposition 199. In fact:
Corollary 201. Let (ψ, φ) ∈S(Rn) × S(Rn) and assume that 
A
Weyl
←→a with a ∈
S′(Rn ⊕Rn). Then
⟨
Aψ, φ⟩= ⟨⟨aσ, A(ψ, φ)∨⟩⟩= ⟨⟨a, W(ψ, φ)⟩⟩
(10.9)
where A(ψ, φ)∨(z) = A(ψ, φ)(−z) and ⟨⟨·, ·⟩⟩is the distributional bracket for dis-
tributions on Rn ⊕Rn.
Proof. It is an immediate consequence of formulas (10.7), (10.8) using Proposi-
tion 199.
□

142
Chapter 10.
The Weyl Correspondence
10.1.3
Probabilistic interpretation
As we already have discussed, the Wigner function is not in general positive. In
fact, as mentioned earlier, a classical result of Hudson [103] (also see Janssen [104])
tells us that Wψ is non-negative if and only if ψ is a Gaussian. An illustration of
this generic non-positivity of the Wigner transform is provided by the following
easy exercise:
Exercise 202. Assume that ψ ∈S(Rn) is an odd function: ψ(−x) = −ψ(x). Show
that Wψ takes negative values. [Hint: calculate Wψ(0).]
However, there are several good reasons for which it might be adequate to
view Wψ as a good substitute for a true probability density. Here is a ﬁrst moti-
vation for viewing the Wigner function as a “quasi probability” density:
Proposition 203. Assume that ψ, φ ∈L1(Rn) ∩L2(Rn). We have
	
Rn W(ψ, φ)(z)dp = ψ(x)φ(x),
(10.10a)
	
Rn W(ψ, φ)(z)dx = Fψ(p)Fφ(p)
(10.10b)
hence, in particular
	
Rn Wψ(z)dp = |ψ(x)|2 ,
	
Rn Wψ(z)dx = |Fψ(p)|2.
(10.11)
Proof. Let us prove the ﬁrst formula (10.10). Noting that in view of the “inverse
Fourier transform formula”, which we write sloppily as
	
Rn e−i
ℏp·ydp = (2πℏ)n δ(y)
we have
	
Rn W(ψ, φ)(z)dp =
	
Rn δ(y)ψ(x + 1
2y)φ(x −1
2y)dy
=
	
Rn δ(y)ψ(x)φ(x)dy
= ψ(x)φ(x)
as claimed. Let us prove the second formula (10.10). Setting x′ = x + 1
2y and
x′′ = x −1
2y in the right-hand of the equality
	
Rn Wψ(z)dx =

1
2πℏ
n 		
Rn×Rn e−i
ℏp·yψ(x + 1
2y)φ(x −1
2y)dydx

10.1.
The Weyl correspondence
143
we get
	
Rn Wψ(z)dx =

1
2πℏ
n 		
Rn×Rn e−i
ℏp·x′ψ(x′)e−i
ℏp·x′′φ(x′′)dx′dx′′
=

1
2πℏ
n 	
Rn e−i
ℏp·x′ψ(x′)dx′
	
Rn e−i
ℏp·x′′φ(x′′)dx′′ = Fψ(p)Fφ(p).
□
It immediately follows from any of the two formulae (10.11) above that
	
R2n Wψ(z)dz = ∥ψ∥2
L2(Rn) = ∥Fψ∥2
L2(Rn).
(10.12)
If the function ψ is normalized: ∥ψ∥2
L2 = 1, then so is Wψ(z):
	
R2n Wψ(z)dz = 1 if ∥ψ∥2
L2(Rn) = 1.
If in addition Wψ ≥0 it would thus be a probability density; but again, this is
only the case when ψ is a Gaussian function.
These two formulas are just particular cases of a (generalized) Radon trans-
forms of the Wigner distribution Wψ, corresponding to integration along the par-
ticular Lagrangian planes ℓP = 0 × Rn and ℓX = 0 × Rn, respectively. More
generally one could deﬁne that transform as the function deﬁned by
Rℓ(u) =
	
ℓ
Wψ(z)dµℓ(z)
where dµℓ(z) is the Euclidean measure on the Lagrangian plane ℓ. The Radon
transform was deﬁned by the Austrian mathematician J. Radon [134] in 1917 (see
the English translation Radon and Parks [135]). For a mathematically rigorous
treatment of its various extensions (which belong to the area of integral geometry)
see Helgason’s book [99].
Having the probabilistic interpretation of the Wigner transform Wψ in mind
formulas (10.7) and (10.9) can be interpreted as giving the average value of the
symbol a when ∥ψ∥2
L2 = 1. This point of view is totally consistent with the one
adopted in quantum mechanics, from which the following deﬁnition comes:
Deﬁnition 204. Let ψ ̸= 0 be viewed as a “quantum state”, and let a be a real
symbol, viewed as a “classical observable”. Then
⟨
A⟩ψ = ( 
Aψ|ψ)L2(Rn)
(ψ|ψ)L2(Rn)
(10.13)
is called the average value of the corresponding “quantum observable” in the
quantum state ψ.
Formula (10.13) can be viewed as saying that the expectation value ⟨
A⟩ψ of
the Weyl operator 
A in the state ψ is the average of the symbol a with respect to
the quasi-probability distribution Wψ.

144
Chapter 10.
The Weyl Correspondence
10.1.4
The kernel of a Weyl operator
The following result will be studied further from a slightly diﬀerent point of view
in Section 10.4 when we study the Weyl correspondence from the point of view of
pseudo-diﬀerential operators. Recall that the kernel of an operator A : S(Rn) −→
S′(Rn) is a distribution K ∈S′(Rn × Rn) such that
⟨Aψ, φ⟩= ⟨K, φ ⊗ψ⟩
for all φ, ψ ∈S(Rn). We may also write
Aψ(x) =
	
Rn K(x, y)ψ(y)dy
where the integral is to be understood in the distributional sense. Every linear
operator A : S(Rn) −→S′(Rn) has a kernel K ∈S′(Rn × Rn) provided it is con-
tinuous from S(Rn) to S′(Rn) (this is Schwartz’s kernel theorem; for a reﬁnement
see [82]).
Proposition 205. (i) Let 
A
Weyl
←→a. The kernel of 
A and its symbol a are related by
the following formulas:
K 
A(x, y) =

1
2πℏ
n 	
Rn e
i
ℏp·(x−y)a( 1
2(x + y), p)dp,
(10.14)
a(x, p) =
	
Rn e−i
ℏp·yK 
A(x + 1
2y, x −1
2y)dy.
(10.15)
Proof of (i). Let us express 
A in terms of its symbol and the Grossmann–Royer
operators (formula (10.2)):

Aψ(x) =
 1
πℏ
n 	
R2n a(z0) 
TGR(z0)ψ(x)dz
=
 1
πℏ
n 	
R2n a(z0)e
2i
ℏp0·(x−x0)ψ(2x −x0)dz.
Setting y = 2x −x0 and p = p0 we get

Aψ(x) =

1
2πℏ
n 		
Rn×Rn e
i
ℏp·(x−y)a( 1
2(x + y), p)ψ(y)dydp.
(10.16)
It follows that the kernel of the operator 
A is given by formula (10.14).
Proof of (ii). We have
K 
A(x + 1
2y, x −1
2y) =

1
2πℏ
n 	
Rn e
i
ℏp·ya(x, p)dp;
(10.17)
ﬁxing x, the Fourier inversion formula yields (10.15).
□

10.1.
The Weyl correspondence
145
Exercise 206. Show that the function z −→e−i
ℏσ(z,z0) is the Weyl symbol of the
Heisenberg–Weyl operator 
T(z0).
The following consequence of Proposition 205 is obvious:
Corollary 207. The Weyl symbol of the operator with kernel

1
2πℏ
n (ψ ⊗φ) is the
cross-Wigner transform W(ψ, φ).
Proof. It is a straightforward application of formula (10.15).
□
Exercise 208. Find the relation between the kernel K 
A and the symplectic Fourier
transform aσ = Fσa of the symbol of 
A.
There is a simple relation between the L2 norm of the symbol and that of
the kernel. The result is useful when one studies L2 regularity properties of Weyl
operators; we will also use it in Chapter 12 in connection with the calculation of
traces of Weyl operators:
Proposition 209. Assume that K 
A ∈L2(Rn ×Rn). We then have a ∈L2(Rn ⊕Rn)
and aσ ∈L2(Rn ⊕Rn); moreover:
∥a∥L2(R2n) = ∥aσ∥L2(R2n) = (2πℏ)n/2 ∥K 
A∥L2(Rn×Rn).
(10.18)
Proof. The equality ∥a∥L2 = ∥aσ∥L2 is obvious since the symplectic Fourier trans-
form is unitary. Let us prove that ∥a∥L2 = (2πℏ)n/2 ∥K 
A∥L2 when K 
A ∈S(Rn ×
Rn); the proposition will follow by the density of S(Rn × Rn) in L2(Rn × Rn). In
view of formula (10.15) the symbol a is, for ﬁxed x, (2πℏ)n/2 times the Fourier
transform of the function y −→K 
A(x+ 1
2y, x−1
2y) hence, by Plancherel’s formula,
	
Rn |a(x, p)|2dp = (2πℏ)n
	
Rn |K 
A(x + 1
2y, x −1
2y)|2dy
(10.19)
and hence, integrating in x,
	
R2n |a(z)|2dz = (2πℏ)n
	
Rn
	
Rn |K 
A(x + 1
2y, x −1
2y)|2dy

dx
= (2πℏ)n
		
Rn×Rn|K 
A(x + 1
2y, x −1
2y)|2dxdy
where we have applied Fubini’s theorem (the integrals are absolutely convergent
since (x, y) −→K 
A(x + 1
2y, x −1
2y) is in S(Rn × Rn) because K 
A is). Set now
x′ = x + 1
2y and y′ = x −1
2y; we have dx′dy′ = dxdy hence
	
R2n |a(z)|2dz = (2πℏ)n
		
Rn×Rn|K 
A(x′, y′)|2dx′dy′
which we set out to prove.
□

146
Chapter 10.
The Weyl Correspondence
We have several times insisted on the fact that the “quantization” of classical
“observables” should satisfy the Schr¨odinger prescription: to a(z) = xjpj should
correspond to the symmetrized operator

A = 1
2(
Xj
Pj + 
Pj 
Xj).
(10.20)
Let us check that the Weyl correspondence 
A
Weyl
←→a satisﬁes this requirement. We
have, taking a(z) = xjpj and hence
(2πℏ)n 
Aψ(x) = 1
2
		
R2n e
i
ℏp·(x−y)pjxjψ(y)dydp
+ 1
2
		
R2n e
i
ℏp·(x−y)pjyjψ(y)dydp.
Formula (10.20) follows in view of the obvious equalities

1
2πℏ
n 1
2xj
		
R2n e
i
ℏp·(x−y)pjψ(y)dydp = 1
2xj
Pjψ(x),

1
2πℏ
n 1
2
		
R2n e
i
ℏp·(x−y)pjyjψ(y)dydp = 1
2 
Pj(xjψ)(x).
Exercise 210. Prove (10.20) using the deﬁnition of 
A in terms of the symbol and
the Grossmann–Royer operator.
10.2
Adjoints and products
We are going to see that the symbol of the adjoint of a Weyl operator 
A can be
very easily determined in terms of the symbol of a. This leads to the celebrated
property of the Weyl correspondence which says that 
A
Weyl
←→a is self-adjoint if and
only if a is real. This property is very important in the applications to quantum
mechanics, because “quantization” of an observable should precisely lead to a
self-adjoint operator.
We also calculate the symbol of the product of two Weyl operators; the
result is of particular importance for the study of the applications to deformation
quantization (“Bopp calculus”).
10.2.1
The adjoint of a Weyl operator
The formal adjoint 
A∗of an operator 
A : S(Rn) −→S(Rn) is deﬁned by the
formula
( 
Aψ|φ)L2(Rn) = (ψ| 
A∗φ)L2(Rn)
for all (ψ, φ) ∈S(Rn) × S(Rn). We are going to determine explicitly the Weyl
correspondence 
A∗Weyl
←→a∗. For this we need the following elementary lemma:

10.2.
Adjoints and products
147
Lemma 211. Let b be a function on Rn such that (b|W(ψ, φ))L2(R2n) = 0 for all
(ψ, φ) ∈S(Rn) × S(Rn). Then b = 0.
Proof. In view of formula (10.8) we have, noting that W(ψ, φ) = W(φ, ψ),
( 
Bφ|ψ))L2 = (b|W(ψ, φ))L2
where 
B
Weyl
←→b. If (b|W(ψ, φ))L2 = 0 for all ψ and φ we must thus have 
Bφ = 0
for all φ hence 
B = 0; but then b = 0 since the Weyl correspondence is one-to-one
in view of Proposition 197.
□
We have:
Proposition 212. The adjoint 
A∗of the Weyl operator 
A
Weyl
←→a is the Weyl op-
erator 
A∗Weyl
←→a∗with symbol a∗= a. In particular, 
A is formally self-adjoint if
and only if a is a real function.
Proof. Expressing 
A in terms of the Grossmann–Royer operators we have, in view
of formula (10.2),
( 
Aψ|φ)L2 =
 1
πℏ
n 	
R2n a(z0)
	
Rn

TGR(z0)ψ(x)φ(x)

dz0
=
	
R2n a(z0)W(ψ, φ)(z0)dz0.
Since, by deﬁnition, ( 
Aψ|φ)L2 = (ψ| 
A∗φ)L2 we have
(ψ| 
A∗φ)L2 = ( 
A∗φ|ψ)L2
=
	
R2n a∗(z0)W(ψ, φ)(z0)dz0
hence
( 
Aψ|φ)L2 =
	
R2n a∗(z0)W(ψ, φ)(z0)dz0.
Applying Lemma 211 to b = a −a∗yields a = a∗that is a∗= a.
□
10.2.2
Composition formulas
We now assume that the Weyl operators

A =

1
2πℏ
n 	
R2n aσ(z) 
T(z)dz,

B =

1
2πℏ
n 	
R2n bσ(z) 
T(z)dz

148
Chapter 10.
The Weyl Correspondence
can be composed (this is always the case for instance if aσ and bσ are in S(Rn⊕Rn))
and set 
C = 
A 
B. Assuming that we can write

C =

1
2πℏ
n 	
R2n cσ(z) 
T(z)dz
we ask: what is cσ? The answer is giving by the following theorem, which is
instrumental in the deﬁnition of deformation quantization we will give later in
this book:
Theorem 213. Let 
A
Weyl
←→a and 
B
Weyl
←→b be Weyl operators.
(i) The product 
C = 
A 
B has (when deﬁned) Weyl symbol
c(z) =

1
4πℏ
2n 		
R4n e
i
2ℏσ(z′,z′′)a(z + 1
2z′)b(z −1
2z′′)dz′dz′′.
(10.21)
(ii) The symplectic Fourier transform of c is given by
cσ(z) =

1
2πℏ
n 	
R2n e
i
2ℏσ(z,z′)aσ(z −z′)bσ(z′)dz′
(10.22)
or, equivalently, by
cσ(z) =

1
2πℏ
n 	
R2n e−i
2ℏσ(z,z′)aσ(z′)bσ(z −z′)dz′.
(10.23)
Proof of (i). Assume that the Weyl symbols a, b of 
A and 
B are in S(Rn ⊕Rn).
We have
K 
A 
B(x, y) =

1
2πℏ
2n 			
R3n e
i
ℏ((x−α)·p+(α−y)·p
× a( 1
2(x + α), ζ)b( 1
2(x + y), ξ)dαdζdξ.
In view of formula (10.15) we have
c(x, p) =
	
e−i
ℏp·uK 
A 
B(x + 1
2u, x −1
2u)du
and the symbol of 
A 
B is thus
c(z) =
 1
πℏ
2n 				
R4n e
i
ℏQa( 1
2(x + α + 1
2u), ζ)
× b( 1
2(x + α −1
2u), ξ)dαdζdudξ
where the phase Q is given by
Q = (x −α + 1
2u) · ζ + (α −x + 1
2u) · ξ −u · p
= (x −α + 1
2u) · (ζ −p) + (α −x + 1
2u) · (ξ −p).

10.2.
Adjoints and products
149
Setting ζ′ = ζ −p, ξ′ = ξ −p, α′ = 1
2(α −x + 1
2u) and u′ = 1
2(α −x −1
2u) we have
dαdζdudξ = 22ndα′ζ′du′dξ′
and Q = 2σ(u′, ξ′; α′, ζ′), hence
c(z) =
 1
πℏ
2n 				
R4n e
2i
ℏσ(u′,ξ′;α′,ζ′)
× a(x + α′, p + ζ′)b(x + u′, p + ξ′)dα′dζ′du′dξ′;
formula (10.21) follows setting z′ = 2(α′, ζ′) and z′′ = −2(u′, ξ′).
Proof of (ii). Writing the operators 
A and 
B in the usual form

A =

1
2πℏ
n 	
R2n aσ(z0) 
T(z0)dz0,

B =

1
2πℏ
n 	
R2n bσ(z1) 
T (z1)dz1
we have, using the property

T(z0 + z1) = e−i
2ℏσ(z0,z1) 
T(z0) 
T(z1)
of HW operators,

T(z0) 
B =

1
2πℏ
n 	
R2n bσ(z1) 
T (z0) 
T(z1)dz1
=

1
2πℏ
n 	
R2n e
i
2ℏσ(z0,z1)bσ(z1) 
T(z0 + z1)dz1
and hence

A 
B =

1
2πℏ
2n 		
R4n e
i
2ℏσ(z0,z1)aσ(z0)bσ(z1) 
T(z0 + z1)dz0dz1.
Setting z = z0 + z1 and z′ = z1 this can be written

A 
B =

1
2πℏ
2n 	
R2n
	
R2n e
i
2ℏσ(z,z′)aσ(z −z′)bσ(z′)dz′


T(z)dz
hence (10.22). Formula (10.23) follows by a trivial change of variables and using
the antisymmetry of σ.
□
The composition formulas (10.22), (10.23) are very important in the context
of the deformation quantization theory we will study later, and where the function
c deﬁned by (10.21) is called the Moyal (or Groenewold–Moyal) starproduct, and
is denoted a ⋆ℏb.
Exercise 214. Prove formula (10.21) for the Weyl symbol of a product by using
the representation (10.2) of 
A and 
B in terms of the Grossmann–Royer operators.

150
Chapter 10.
The Weyl Correspondence
10.3
Symplectic covariance of Weyl operators
A striking feature of Weyl calculus is that it is the only pseudo-diﬀerential operator
calculus for which metaplectic covariance holds (see Chapter 10.4 for a discussion
of the general notion of pseudo-diﬀerential operator). This property is another
manifestation of the importance of Weyl operators in quantum mechanics.
10.3.1
Statement and proof of the symplectic covariance property
Recall that the Heisenberg–Weyl and Royer–Grossmann operators 
T(z0) and

TGR(z0) satisfy the following property: for 
S ∈Mp(2n, R) and S = πMp(
S) we
have

S 
T(z0)
S−1 = 
T(Sz0) ,

S 
TGR(z0)
S−1 = 
TGR(Sz0)
(10.24)
for every z0 ∈R2n.
Theorem 215. Let S ∈Sp(2n, R) and 
S ∈Mp(2n, R) be any one of the two
metaplectic operators with S = πMp(
S). For every Weyl operator 
A
Weyl
←→a we
have the correspondence
a ◦S
Weyl
←→
S−1 
A
S.
(10.25)
That is, to the symbol aS (z) = a(Sz) corresponds the Weyl operator 
S−1 
A
S.
Proof. Let us denote by 
B the Weyl operator with symbol a◦S. In view of formula
(10.8) we have

Bψ =
	
R2n aσ(Sz) 
T(z)ψdz
that is, performing the change of variables Sz −→z and taking into account the
fact that det S = 1,

Bψ =
	
R2n aσ(z) 
T(S−1z)ψdz.
By formula (8.11) in Theorem 128 we have 
S−1 
T(z)
S = 
T(S−1z) and hence

Bψ =
	
R2n aσ(z)
S−1 
T(z)
Sψdz
= 
S−1
	
R2n aσ(z) 
T(z)dz


Sψ
which is (10.25).
□
Problem 216. Give an alternative proof of (10.25) using the formula

A =
 1
πℏ
n 	
R2n a(z0) 
TGR(z0)dz0
expressing the Weyl correspondence in terms of the Grossmann–Royer operators.

10.3.
Symplectic covariance of Weyl operators
151
As a straightforward consequence of Theorem 128 we obtain the so-called
metaplectic covariance formula for the cross-Wigner transform:
Corollary 217. Let ψ, φ ∈S(Rn) and 
S ∈Mp(2n, R); we denote by S the projection
of 
S on Sp(2n, R). We have
W(
Sψ, 
Sφ)(z) = W(ψ, φ)(S−1z)
(10.26)
and hence in particular
W(
Sψ)(z) = Wψ(S−1z).
(10.27)
Proof. In view of formula (10.7) in Proposition 200 we have, since 
S is unitary,
	
R2n W(
Sψ, 
Sφ)a(z)dz = ( 
A 
Sψ|
Sφ)L2 = (
S−1 
A
Sψ|φ)L2.
In view of (10.25) we have
(
S−1 
A
Sψ, φ)L2 =
	
R2n W(ψ, φ)(z)(a ◦S)(z)dz
=
	
R2n W(ψ, φ)(S−1z)a(z)dz
which establishes the equality (10.26) since ψ and φ are arbitrary; formula (10.27)
trivially follows taking ψ = φ.
□
Problem 218. Prove a similar result for the cross-ambiguity function.
10.3.2
Covariance under aﬃne symplectomorphisms
Let us denote by T (z0) the phase space translation operator z −→z + z0. It
induces a natural action of functions by the formula T (z0)a(z) = a(z −z0); this
action can be extended into an action on distributions in the obvious way.
Proposition 219. Let a
Weyl
←→
A with a ∈S′(Rn ⊕Rn). Let T (z0)a(z) = a(z −z0).
We have
T (z0)a
Weyl
←→
T(z0) 
A 
T(z0)−1
(10.28)
where 
T(z0) is the Heisenberg–Weyl operator.
Proof. Let ψ, φ ∈S(Rn). We ﬁrst remark that writing (10.8) in terms of distribu-
tional brackets, and using the fact that W(ψ, φ) = W(φ, ψ) we have
⟨
Aψ, φ⟩=
	
R2n a(z)W(ψ, φ)(z)dz = ⟨a, W(φ, ψ)⟩.

152
Chapter 10.
The Weyl Correspondence
We next observe that
⟨
T (z0) 
A 
T(z0)−1ψ, φ⟩= ⟨
A 
T(z0)−1ψ, 
T(z0)−1φ⟩
= ⟨a, W( 
T (z0)−1φ, 
T (z0)−1ψ)⟩
= ⟨a, T (−z0)W(φ, ψ)⟩
the last equality in view of formula (9.23); since we have
⟨a, T (−z0)W(φ, ψ)⟩= ⟨T (z0)a, W(φ, ψ)⟩
formula (10.28) follows.
□
Exercise 220. Prove directly formula (10.28) using the deﬁnition of 
A in terms of
the Heisenberg–Weyl operators. [Hint: use several changes of variables together
with the formula 
T(z0) 
T (z1) = e
i
ℏσ(z0,z1) 
T(z1) 
T(z0) (formula (8.8)).]
Recall (Deﬁnition 26) that the aﬃne symplectic group ASp(2n, R) is the semi-
direct product Sp(2n, R) ⋉T(2n, R) of the symplectic group with the translation
group T(2n, R) ≡R2n. It is the group generated by symplectic matrices and
the translations T (z0). Writing Sz0 = ST (z0) to each Sz0 one can associate two
unitary operators ±
Sz0 deﬁned as follows: 
Sz0 = 
S 
T(z0) where 
S is any one of
the two metaplectic operators with projection S ∈Sp(2n, R). The operators 
Sz0
generate a group, the aﬃne (or homogeneous) metaplectic group AMp(2n, R).
Combining Theorem 128 with Proposition 219 we get:
Corollary 221. The Weyl correspondence is covariant under the action of the aﬃne
symplectic group ASp(2n, R) in the sense that if 
A
Weyl
←→a then
a ◦Sz0
Weyl
←→
S−1
z0 
A
Sz0
(10.29)
for every Sz0 = ST (z0).
It turns out that symplectic covariance is characteristic of the Weyl corre-
spondence: among all other pseudo-diﬀerential calculi (as studied in Chapter 14),
it is the only one having the properties above. This is a fundamental fact, because
it allows the derivation of Schr¨odinger’s equation. We will come back to that prop-
erty in Chapter 15 when we study the derivation of Schr¨odinger’s equation.
10.4
Weyl operators as pseudo-diﬀerential operators
We introduced Weyl operators using concepts from harmonic analysis such as the
Heisenberg–Weyl or Grossmann–Royer operators. We now take the point of view
of pseudo-diﬀerential operators; this approach will be developed in Chapter 14
from a more general point of view using Shubin’s theory [147]. The literature on

10.4.
Weyl operators as pseudo-diﬀerential operators
153
pseudo-diﬀerential operators is immense. The main references for what we will
be doing here are the books by Wong [163], Nicola and Rodino [131]. The books
[40] by Egorov, Komech, and Shubin, contains very valuable material concerning
applications of pseudo-diﬀerential operators to the theory of partial diﬀerential
equations. Another good source is Chazarain and Piriou [25] where there is a
strong use of microlocal techniques.
We begin with a quick review of the general notion of pseudo-diﬀerential
operator.
10.4.1
The notion of pseudo-diﬀerential operator
We will use the following multi-index notation: for α = (α1, . . . , α2n) in N2n we
set
|α| = α1 + · · · + α2n , ∂α
z = ∂α1
z1 · · · ∂α2n
z2n
where ∂αj
zj = ∂αj/∂xαj
j
for 1 ≤j ≤n and ∂αj
zj = ∂αj/∂ξαj
j
for n + 1 ≤j ≤2n.
We will write Dx = −i∂x and Dα
x = (−i)|α|∂α
x and use similar notation for Dp
and Dα
p .
The starting point of any honest theory of pseudo-diﬀerential operators is
the search for an extension of partial diﬀerential operators. In the early days of
the theory one started by remarking that we can write any partial diﬀerential
operators (with smooth coeﬃcients) on Rn in the form

A =

|α|≤m
aα(x)Dα
x
, aα ∈C∞(Rn)
(10.30)
and deﬁne the symbol of 
A as being the polynomial
a(x, ξ) =

|α|≤m
aα(x)ξα , ξα = ξα1
1
· · · ξαn
n .
(10.31)
Deﬁning the Fourier transform 
f of f ∈C∞
0 (Rn) (the vector space of C∞functions
with compact support) by

f(ξ) =
 1
2π
n/2 	
Rn e−iξ·xf(x)dx
(10.32)
(thus 
f = Ff with ℏ= 1) we can rewrite Deﬁnition (10.30) as

Af(x) =
	
Rn eiξ·xa(x, ξ) 
f(ξ)dξ.
(10.33)
Exercise 222. Show that formula (10.33) immediately follows from the Fourier
inversion formula
f(x) =
 1
2π
n/2 	
Rn eix·ξ 
f(ξ)dx
(10.34)
and the relation ξα 
f(ξ) = 
Dαxf(ξ).

154
Chapter 10.
The Weyl Correspondence
The next step consisted in deﬁning pseudo-diﬀerential operators as being
linear operators of the type (10.33) where a is a (more or less arbitrary) function on
Rn⊕Rn called in this context a symbol or amplitude. Of course, such a deﬁnition is
vague and rather useless unless one puts some constraints on the classes of symbols
that are acceptable. For instance if a(x, ξ) increases “too” fast when |ξ| →∞the
integral in (10.33) will only be convergent for “very” small classes of functions f.
For instance, a reasonable requirement is that one should be able to calculate 
Af
when f ∈C∞
0 (Rn), and this will be the case if one requires that the symbol not
grow faster than a polynomial in ξ. Then, another natural requirement might be
that the smoothness of 
Af corresponds in some way to the smoothness of f, and
for this to be true one has to impose conditions on the x-derivatives of the symbol
a. The most popular choice in the 1970s was to use the so-called H¨ormander symbol
classes Sm
ρ,σ (H¨ormander [96], H¨ormander and Duistermaat [97]):
Deﬁnition 223. Let m, ρ, δ be real numbers such that 0 ≤δ < ρ ≤1. The symbol
class Sm
ρ,δ(Rn⊕Rn) is the (complex) vector space of all functions a ∈C∞(Rn⊕Rn)
such that for each choice of multi-indices α, β ∈Nn and of a compact subset K of
Rn there exists a constant Cα,β,K ≥0 such that
∂α
x ∂β
ξ a(x, ξ) ≤Cα,β,K(1 + |ξ|)m−|β|
(10.35)
for (x, ξ) ∈K × Rn. One writes Sm(Rn ⊕Rn) = Sm
1,0(Rn ⊕Rn). The vector space
of pseudo-diﬀerential operators

Af(x) =
	
Rn eiξ·xa(x, ξ) 
f(ξ)dξ
(10.36)
with symbol in Sm
ρ,δ(Rn ⊕Rn) is denoted Lm
ρ,δ(Rn). One often calls a the Kohn–
Nirenberg symbol of 
A.
It is not diﬃcult to show that when a ∈Sm
ρ,δ(Rn ⊕Rn) the corresponding
pseudo-diﬀerential operator 
A maps continuously C∞
0 (Rn) into C∞(Rn) (it in-
volves repeated use of Leibniz’s rule for the diﬀerentiation of a product); moreover
any symbol a of the polynomial type (10.31) belongs to the class Sm(Rn ⊕Rn),
so the deﬁnition above achieves the program of generalizing ordinary partial dif-
ferential operators (at least those with C∞coeﬃcients).
So far, so good. The rub comes from the fact that in the elements of the
symbol classes Sm
ρ,δ the variables x and ξ are on very diﬀerent footing, due to
the fact that one is more interested in local properties than in global behavior
(the cotangent bundle of a manifold is locally identical with T ∗Rn = Rn ⊕Rn).
This dissymmetry conﬂicts with the phase space approach of both classical and
quantum mechanics, where the variables x and ξ play equivalent roles. We will
deﬁne later in this book a pseudo-diﬀerential calculus that avoids this diﬃculty
(the Shubin global calculus, Chapter 14).

10.4.
Weyl operators as pseudo-diﬀerential operators
155
Problem 224. Show that every pseudo-diﬀerential operator belonging to one of
the H¨ormander classes Lm
ρ,δ(Rn) with 0 ≤δ < ρ ≤1 maps (continuously) S(Rn)
into itself.
The best-known regularity results for these operators are expressed in terms
of the usual Sobolev spaces1 Hs: we have f ∈Hs(Rn) if and only if 
f is a function
satisfying
∥f∥2
s =
	
Rn | 
f(ξ)|2(1 + |ξ|2)sdξ < ∞.
It is clear that Hs(Rn) is a vector space; it is in fact a complex Hilbert space for
the sesquilinear form
(f, g) −→(f|g)s =
	
Rn

f(ξ)
g(ξ)(1 + |ξ|2)sdξ
and f −→∥f∥s = (f|f)1/2
s
is the associated norm. Since pseudo-diﬀerential op-
erators are not in general local one cannot in general state regularity results in
terms of these spaces, and one considers the following derived spaces:
Hs
c(Rn) = {f ∈Hs(Rn) : Supp(f) is compact},
Hs
loc(Rn) = {f ∈S′(Rn) : ϕf ∈Hs
c (Rn) for some ϕ ∈C∞
0 (Rn)}.
Equipping these spaces with adequate topologies, a classical result is then:
Theorem 225. Every 
A ∈Lm
1,0(Rn) is continuous Hs
c (Rn) −→Hs−m
loc
(Rn).
Proof. See any textbook on pseudo-diﬀerential operators published before the mid-
1980s.
□
It should be mentioned that every 
A ∈Lm
1,0(Rn) can be written as 
A =

A′ + R where 
A′ : Hs
c (Rn) −→Hs−m
c
(Rn) and R is a smoothing operator (i.e., an
operator with C∞kernel). If an operator maps compactly supported distributions
to compactly supported distributions one says it is a proper operator.
10.4.2
The kernel of a Weyl operator revisited
We are going to see that a Weyl operator 
A
Weyl
←→a can be represented in the
following way:

Aψ(x) =

1
2πℏ
n 		
Rn×Rn e
i
ℏp·(x−y)a( 1
2(x + y), p)ψ(y)dydp.
(10.37)
Of course, the right-hand side does not have a well-deﬁned mathematical sense
in general; for the “double integral” to be absolutely convergent one has to put
1Sometimes also called “Bessel potential spaces”.

156
Chapter 10.
The Weyl Correspondence
rather stringent conditions on the symbol a and the function ψ. For instance, one
can require that ψ ∈S(Rn) and a decreases suﬃciently fast in p. We are going
to see that one can, however, give a meaning to this formal expression by using a
“molliﬁer” provided that a belongs to a “good” symbol class. We will reﬁne and
improve our results when we discuss the Shubin classes.
Let us show that Weyl operators are just pseudo-diﬀerential operators of
the type above when a decays rapidly. Recall from Proposition 205 that if a ∈
S(Rn ⊕Rn) and 
A
Weyl
←→a then

Aψ(x) =

1
2πℏ
n 		
Rn×Rn e
i
ℏp·(x−y)a( 1
2(x + y), p)ψ(y)dydp
(10.38)
for every ψ ∈S(Rn). It follows that the kernel of 
A is given by
K 
A(x, y) =

1
2πℏ
n 	
Rn e
i
ℏp·(x−y)a( 1
2(x + y), p)dp.
(10.39)
Conversely, the expression of the symbol in terms of the kernel is
a(x, p) =
	
Rn e−i
ℏp·yK 
A(x + 1
2y, x −1
2y)dy.
(10.40)
Notice that if we interpret formula (10.39) in the distributional sense we
recover the fact that the identity operator has symbol a = 1. In fact it suﬃces to
observe that in view of the Fourier inversion formula we have

1
2πℏ
n 		
R2n e
i
ℏp·(x−y)ψ(y)dydp = ψ(x).
(10.41)
10.4.3
Justiﬁcation in the case a ∈Sm
We are following here closely Chapter 4 in Wong [163]. Let us begin with a regu-
larization result making use of a “molliﬁer”.
Proposition 226. Let a ∈Sm(Rn ⊕Rn) = Sm
1,0(Rn ⊕Rn) and assume that the
estimates (10.35) hold uniformly in x, that is
∂α
x ∂β
ξ a(x, ξ) ≤Cα,β(1 + |ξ|)m−|β|.
Let θ ∈C∞
0 (Rn) be such that θ(0) = 1. For every ψ ∈S(Rn) the limit
L(x) = lim
ε→0+
		
Rn×Rn e
i
ℏp·(x−y)θ(εp)a( 1
2(x + y), p)ψ(y)dydp
(10.42)
exists and is independent of the choice of the function θ.

10.4.
Weyl operators as pseudo-diﬀerential operators
157
Proof. Deﬁne a function Lε by the formula
Lε(x) =
		
Rn×Rn e
i
ℏp·(x−y)θ(εp)a( 1
2(x + y), p)ψ(y)dydp.
For any integer N ≥0 we have
(1 −∆y)Ne
i
ℏp·(x−y) = ℏ−N(1 + |p|2)Ne
i
ℏp·(x−y)
hence, integrating by parts in the y variable,
Lε(x) = ℏN
		
Rn×Rn e
i
ℏp·(x−y)θ(εp)(1 + |p|2)−N
× (1 −∆y)N 
a( 1
2(x + y), p)ψ(y)

dydp.
Using Leibniz’s formula for the repeated derivatives of a product we have
(1−∆y)N 
a( 1
2(x + y), p)ψ(y)

=

|α|≤N
1
α!(Dα
xa)( 1
2(x+y), p)P α(D)ψ(y) (10.43)
where P α
N(D) is the partial diﬀerential operator with symbol ∂α
p

(1 + |p|2)N 
. For
each ﬁxed x ∈Rn we have
lim
ε→0+
!
θ(εp)(1 + |p|2)−Ne
i
ℏp·(x−y)(Dα
xa)( 1
2(x + y), p)P α
N(D)ψ(y)
"
= (1 + |p|2)−Ne
i
ℏp·(x−y)(Dα
xa)( 1
2(x + y), p)P α
N(D)ψ(y).
In view of the estimate
|(Dα
xa)( 1
2(x + y), p)| ≤Cα(1 + |p|2)m
there exists a constant C such that
|θ(εp)(1 + |p|2)−Ne
i
ℏp·(x−y)(Dα
xa)( 1
2(x + y), p)P α
N(D)ψ(y)|
≤C(1 + |p|2)−N(1 + |p|2)m|P α
N(D)ψ(y)|
for y and p in Rn. Since the function
(y, p) −→(1 + |p|2)−N(1 + |p|2)m|P α
N(D)ψ(y)|
is in L1(Rn) as soon as N > (m + n)/2 it follows from (10.43) and Lebesgue’s
dominated convergence theorem that limε→0+ Lε(x) exists and is independent of
the choice of θ.
□
Exercise 227. Show, using the formulas in the proof, that the convergence in
formula (10.42) is uniform with respect to the variable x.

158
Chapter 10.
The Weyl Correspondence
The limit (10.42) is called an “oscillatory integral”, and one often uses the
notation
L(x) =

1
2πℏ
n '
		
Rn×Rne
i
ℏp·(x−y)a( 1
2(x + y), p)ψ(y)dydp.
Provided that some care is taken one can work with oscillatory integrals very much
like with ordinary integrals in their evaluation (see Chazarain and Piriou [25] for
more on this topic and various extensions).
10.5
Regularity results for Weyl operators
10.5.1
Some general results
Let us begin with a modest goal and see what happens if we assume that aσ is
absolutely integrable. Recall that if A is an operator from a Banach space B to a
Banach space B′ then the operator norm ∥A∥is deﬁned by
∥A∥= inf {M : ∥Af∥B′ ≤M∥f∥B, f ∈B} .
We have the following precise result:
Proposition 228. Assume that aσ ∈L1(Rn ⊕Rn) [equivalently a ∈FL1(Rn ⊕Rn)]
and ψ ∈S(Rn). Then:
(i) The operator 
A
Weyl
←→a is continuous on S(Rn ⊕Rn) for the induced L2-norm;
in fact
∥
Aψ∥L2(Rn) ≤

1
2πℏ
2n ∥aσ∥L1(Rn)∥ψ∥L2(Rn)
(10.44)
hence the operator norm of 
A on L2(Rn) satisﬁes
∥
A∥≤

1
2πℏ
2n ∥aσ∥L1(Rn).
(10.45)
(ii) 
A extends into a bounded operator L2(Rn) −→L2(Rn), which will also be
denoted 
A.
Proof. Statement (ii) immediately follows from (i), using the density of S(Rn) in
L2(Rn). Formula (10.45) is equivalent to formula (10.44). The kernel of 
A is given
by
K 
A(x, y) =

1
2πℏ
n/2 F2( 1
2(x + y), y −x)
where F2 is the Fourier transform in the p variables. By the Fourier inversion
formula we have
F2a( 1
2(x + y), y −x) =

1
2πℏ
n/2 	
Rn e
i
2ℏ(x+y)·ξF(ξ, y −x)dξ

10.5.
Regularity results for Weyl operators
159
and hence
K 
A(x, y) =

1
2πℏ
n 	
Rn e
i
2ℏ(x+y)·ξFa(ξ, y −x)dξ.
It follows that
	
|K 
A(x, y)|dx ≤

1
2πℏ
n 		
Rn×Rn|Fa(ξ, y −x)|dξdx,
	
|K 
A(x, y)|dy ≤

1
2πℏ
n 		
Rn×Rn|Fa(ξ, y −x)|dξdy.
Setting η = y −x we have
		
Rn×Rn|Fa(ξ, y −x)|dξdx =
		
Rn×Rn|Fa(ξ, η)|dξdη
hence the two inequalities above can be rewritten, in view of the ﬁrst equality
(8.27), in the form
	
Rn |K 
A(x, y)|dx ≤

1
2πℏ
n ∥aσ∥L1,
	
Rn |K 
A(x, y)|dy ≤

1
2πℏ
n ∥aσ∥L1.
The rest of the proof of the inequality (10.44) goes as follows: setting C =
(2πℏ)−n∥aσ∥L1 we have, using Cauchy–Schwarz’s inequality,
| 
Aψ(x)|2 ≤
	
Rn |K 
A(x, y)|dny
	
Rn |K 
A(x, y)| |ψ(y)|2dy
≤C2
	
Rn |K 
A(x, y)| |ψ(y)|2dy
and hence
	
Rn | 
Aψ(x)|2dx ≤C2
	
Rn
	
Rn |K 
A(x, y)|dx

|ψ(y)|2dy,
that is
	
Rn | 
Aψ(x)|2dx ≤C2
	
Rn |ψ(y)|2dy
which is precisely the estimate (10.44).
□
The study of regularity properties of Weyl operators on L2(Rn) has become
something of an industry since the early 1990s. One of the most known (and cer-
tainly most useful!) results nevertheless goes back to an older paper of Cordes [29]:
Proposition 229. Assume that the symbol a satisﬁes the conditions ∂α
x ∂β
p a ∈
L∞(Rn ⊕Rn) for all multi-indices α, β such that |α|, |β| ≤[n/2] + 1. Then
the operator 
A
Weyl
←→a is bounded on the space L2(Rn).

160
Chapter 10.
The Weyl Correspondence
The conditions on the multi-indices α, β in the result above are rather sharp;
see Boulkhemair [21] for a discussion of these conditions and references to previous
work (in addition there is a detailed discussion of L2-boundedness for operators
with symbols in the H¨ormander classes Sm
ρ,δ).
10.5.2
Symbols in Lq spaces
In his book [163] Wong has analyzed in detail regularity results for Weyl operators
with symbols in the Lq spaces, and has given conditions for these operators to be
continuous, compact, and Hilbert–Schmidt. We refer to Wong’s work for details,
and limit ourselves here to a few statements.
We begin by proving a boundedness result when the symbol a belongs to the
space L2(Rn ⊕Rn) of square integrable functions. It is a nice application of the
Moyal identity
(W(ψ, φ)|W(ψ′, φ′))L2(R2n) =

1
2πℏ
n (ψ|ψ′)L2(Rn)(φ|φ′)L2(Rn).
(10.46)
Proposition 230. Let 
A
Weyl
←→a with a ∈L2(Rn ⊕Rn). Then the Weyl operator 
A
is bounded on L2(Rn) and we have the estimate
∥
Aψ∥L2(Rn) ≤

1
2πℏ
n ∥a∥L2(R2n)∥ψ∥L2(Rn)
(10.47)
for all functions ψ ∈L2(Rn).
Proof. It is no restriction to assume that 
Aψ ̸= 0. Assume ﬁrst that a ∈S(Rn ⊕
Rn). Then, for every ψ, φ ∈S(Rn) we have, in view of (10.8),
( 
Aψ|φ)L2 =
	
R2n a(z)W(ψ, φ)(z)dz
and hence, using successively the Cauchy–Schwarz inequality and the Moyal iden-
tity (10.46),
|( 
Aψ|φ)L2| ≤∥a∥L2∥W(ψ, φ)∥L2
≤

1
2πℏ
n ∥a∥L2∥ψ∥L2∥φ∥L2.
Since 
Aψ ∈S(Rn) we may choose φ = 
Aψ and the inequality above then becomes
∥
Aψ∥2
L2 ≤

1
2πℏ
n ∥a∥L2∥ψ∥L2∥
Aψ∥L2.
Dividing both sides by ∥
Aψ∥L2 yields the estimate (10.47) in the considered case.
The general case follows in view of the density of S(Rn) in L2(Rn) and that of
S(Rn ⊕Rn) in L2(Rn ⊕Rn).
□

10.5.
Regularity results for Weyl operators
161
Recall that Lq(Rn ⊕Rn) (1 ≤q < ∞) is the Banach space of all measurable
functions a : Rn ⊕Rn −→C such that
∥a∥q =
	
R2n |a(z)|qdz
1/q
< ∞
(these spaces will be studied in some detail in Chapter 17).
The result above extends to the case of Lq spaces with 1 ≤q < 2; we will
not prove this here and refer to Wong [163], Theorem 1.1:
Proposition 231. Let 
A
Weyl
←→a with a ∈Lq(Rn ⊕Rn), 1 ≤q < 2. The Weyl
operator 
A is bounded on L2(Rn) and there exists a constant Cq only depending
on q such that
∥
Aψ∥L2(Rn) ≤Cq∥a∥Lq(R2n)∥ψ∥L2(Rn)
for all ψ ∈L2(Rn).
When 2 < q < ∞one can no longer expect L2 boundedness; in fact one can
show that for each q such that 2 < q < ∞there exists a symbol a ∈Lq(Rn ⊕Rn)
such that 
A
Weyl
←→a is not a bounded operator on L2(Rn) (for a proof of this result
we refer to Wong [163], Theorem 13.1).

Chapter 11
Coherent States and
Anti-Wick Quantization
The theory of coherent states plays an important role in various aspects of repre-
sentation theory, and of, course, in quantum mechanics from which it originates.
Historically, the notion of coherent state goes back to Schr¨odinger’s 1926 work [143]
on non-dispersing wavepackets for a harmonic oscillator. In 1932 von Neumann
[130] considered sets of coherent states associated with a division of phase space
into quantum cells. The modern theory was initiated by Glauber’s 1963 work [62]
in quantum optics (Glauber was awarded the 2005 Nobel Prize in Physics for his
contributions; we mention that there was a controversy about priorities involving
the physicist Sudarshan, also famous for his work on coherent states). The theory
of coherent states has since then been applied to a variety of problems in math-
ematics and mathematical physics, and has been extended in various directions,
for instance within the framework of anti-Wick (also called Toeplitz, or Berezin)
quantization (Berezin [13]) which we will study later in this chapter.
11.1
Coherent states
Much of the material of this section is inspired by Littlejohn’s seminal paper
[117]. We begin with an easy physical motivation of coherent states as “minimum
uncertainty wavepackets”.
11.1.1
A physical motivation
Consider the Hamiltonian function
H(z) =
1
2mp2 + 1
2mω2x2
163
M.A. de Gosson, Symplectic Methods in Harmonic Analysis and in Mathematical Physics,  
Pseudo-Differential Operators 7, DOI 10.1007/978-3-7643-9992-4_
, © Springer Basel AG 2011 
11

164
Chapter 11.
Coherent States and Anti-Wick Quantization
of the harmonic oscillator in one dimension; the eigenvalues of the corresponding
Weyl operator

H = −ℏ
2m
∂2
∂x2 + 1
2mω2x2
are the numbers (N + 1
2)ℏω (N = 0, 1, 2, . . .) and the associated eigenfunctions
are the rescaled Hermite functions
ψN(x) =
(
1
2NN!
mω
πℏ
1/4
exp

−mω
2ℏx2
HN

x
(mω
ℏ

where the HN are the Hermite polynomials
HN (x) = (−1)Nex2 dN
dxN ex2.
Let us focus on the ground state ψ0; it is given by
ψ0(x) =
mω
πℏ
1/4
exp

−mω
2ℏx2
.
(11.1)
This function has the following typical property: it is, to use physicists’ terminol-
ogy, a “minimum extension (or uncertainty) wavepacket”; by that we mean that
the statistical variances (∆x)ψ0 and (∆p)ψ0 are such that (∆p)ψ0(∆x)ψ0 = 1
2ℏ
(one says that the Heisenberg inequality is “saturated by ψ0”).
Exercise 232. Show that (∆x)ψ0 = (ℏ/2mω)1/2 and (∆p)ψ0 = (ℏmω/2)1/2. [Hint:
use for instance formula (11.18) to calculate explicitly Wψ0(z) and then determine
the corresponding covariance matrix.]
For more on the physical properties of the coherent state ψz0 we refer to
Messiah’s classical (but still very modern) book [123].
11.1.2
Properties of coherent states
Let us introduce the following notation for x ∈Rn; we write
ψℏ
0(x) =
 1
πℏ
n/4 e−1
2ℏ|x|2
(11.2)
and
ψℏ
z0(x) = 
T(z0)ψℏ
0(x)
(11.3)
where 
T (z0) is the Heisenberg–Weyl operator. When n = 1 the function ψℏ
0 is just
the ground state (11.1) of the quantum harmonic oscillator when m = 1, ω = 1.
Deﬁnition 233. The function ψℏ
0 ∈S(Rn) deﬁned by (11.2) is called the standard
(or ﬁducial1) coherent state. Let z0 = (x0, p0); the function ψℏ
z0 ∈S(Rn) deﬁned
by (11.3) is called the coherent state centered at z0. (In the quantum mechanical
literature these states are often denoted |0⟩and |z0⟩, respectively.)
1In the sense of something taken as an origin or zero of reference – not in the legal sense!

11.1.
Coherent states
165
In physics one also sometimes calls ψℏ
0 the “vacuum state”. In signal analysis
(particularly wavelet theory) one often uses the terminology “mother wavelet”.
We begin by proving that the set of all translations of the standard coher-
ent states span a dense subset of L2(Rn). Our proof is elementary, and relies on
Plancherel’s formula; Gr¨ochenig [82] (Lemma 1.5.3) gives a related proof of this
property, which he then uses to derive Plancherel’s formula. More precisely:
Proposition 234. Let T (x0) be the translation operator x −→x + x0 on Rn and
deﬁne T (x0)ψ(x) = ψ(x −x0). The linear spans of sets {T (x0)ψ : x0 ∈Rn} and
{ψℏ
z0 : z0 ∈Rn} are dense in the space L2(Rn) of square integrable functions.
Proof. We will only prove the assertion for the set {T (x0)ψ : x0 ∈Rn}; the case
of {ψℏ
z0 : z0 ∈Rn} is an immediate adaptation. Let ψ ∈L2(Rn); since ψℏis even
we have
⟨ψ, T (x0)ψℏ⟩=
	
Rn ψ(x)ψℏ(x −x0)dx = ψ ∗ψℏ(x0).
Thus ⟨ψ, T (x0)ψℏ⟩= 0 for all ψ implies that ψ ∗ψℏ= 0, and hence FψFψℏ= 0,
that is Fψ = 0 since Fψℏ> 0. In view of Plancherel’s formula ∥Fψ∥L2 = ∥ψ∥L2
and thus ψ = 0 almost everywhere. It follows that there are no non-trivial vectors
which are orthogonal to the span of the set {ψℏ
z0 : z0 ∈Rn} and hence the span of
{T (x0)ψ : x0 ∈Rn} is dense in L2(Rn).
□
Note that in the proof above the fact that we were using the standard coherent
state was not essential: we could actually replace ψℏwith any function φ ∈L2(Rn)
such that Fφ never vanishes.
It follows from Proposition 234 that the space of functions spanned by the
{ψℏ
z0 : z0 ∈Rn} is also dense in the space L2(Rn), since it contains the span. Let
us develop this property:
Proposition 235. The coherent states ψℏ
z0 have the following properties:
(i) They satisfy the generalized orthogonality relations

1
2πℏ
n 	
R2n ψℏ
z0(x)ψℏz0(y)dz0 = δ(x −y);
(11.4)
(ii) For every ψ ∈L2(Rn) we have
∥ψ∥2
L2 =

1
2πℏ
n 	
R2n |(ψ|ψℏ
z0)L2(Rn)|2dz0
(11.5)
and
ψ(x) =

1
2πℏ
n 	
R2n(ψ|ψℏ
z0)L2(Rn)ψℏ
z0(x)dz0.
(11.6)

166
Chapter 11.
Coherent States and Anti-Wick Quantization
Proof of (i). We have
(ψ, ψℏ
z0)L2 = e
i
2ℏp0·x0
	
Rn e−i
ℏp0·xψ(x)e−1
2ℏ(x−x0)2dx
= (2πℏ)n/2 e
i
2ℏp0·x0F(ψψℏ(· −x0))(p0)
hence, by Plancherel’s theorem,
	
R2n |(ψ, ψℏ
z0)L2|2dz0 = (2πℏ)n
	
Rn ∥ψψℏ((·) −x0)∥2
L2dx0
= (2πℏ)n
	
Rn |ψ(x)|2
	
Rn |ψℏ(x −x0)|2dx0

dx
= (2πℏ)n ∥ψ∥2
L2.
Proof of (ii). We have
	
R2n ψℏ
z0(x)ψℏz0(y)dz0 =
	
R2n e
i
ℏp0·(x−y)ψℏ(x −x0)ψℏ(y −x0)dz0
=
	
Rn
	
Rn e
i
ℏp0·(x−y)dp0

ψℏ(x −x0)ψℏ(y −x0)dx0
= (2πℏ)n
	
Rn δ(x −y)ψℏ(x −x0)ψℏ(y −x0)dx0
= (2πℏ)n
	
Rn |ψℏ(x −x0)|2dx0

δ(x −y)
= (2πℏ)n δ(x −y)
which proves (11.4). Formula (11.6) follows since we have
ψ(x) =
	
Rn δ(x −y)ψ(y)dy
=

1
2πℏ
n 		
Rn×R2nψℏ
z0(x)ψℏz0(y)ψ(y)dydz0
=

1
2πℏ
n 	
R2n
	
Rn ψℏz0(y)ψ(y)dy

ψℏ
z0(x)dz0
=

1
2πℏ
n 	
R2n(ψ|ψℏ
z0)L2(Rn)ψℏ
z0(x)dz0.
□
Exercise 236. Restate formulas (11.5) and (11.6) in terms of the cross-ambiguity
and Wigner distributions.
The result above leads to interesting expressions in terms of coherent states
for the kernel and Weyl symbol of an operator:

11.1.
Coherent states
167
Proposition 237. Let 
A be a continuous linear operator S(Rn) −→S′(Rn) with
kernel K 
A; we have
K 
A(x, y) =

1
2πℏ
n 	
R2n

Aψℏ
z0(x)ψℏz0(y)dz0
(11.7)
and the Weyl symbol a
Weyl
←→
A is given by
a(z) =
	
R2n W( 
Aψℏ
z0, ψℏ
z0)(z)dz0.
(11.8)
Proof. We have

Aψℏ
z0(x) =
	
Rn K 
A(x, x′)ψℏ
z0(x′)dx′
hence, using formula (11.4),
	
R2n

Aψℏ
z0(x)ψℏz0(y)dz0 =
	
R×R2n K 
A(x, x′)ψℏ
z0(x′)ψℏz0(y)dx′dz0
= (2πℏ)n
	
Rn K 
A(x, x′)δ(y −x′)dx′
= (2πℏ)n K 
A(x, y)
that is (11.7). Formula (11.8) for the symbol readily follows: using successively
(10.15) in Proposition 205 and (11.7) we have
a(x, p) =
	
Rn e−i
ℏp·yK 
A(x + 1
2y, x −1
2y)dy
=

1
2πℏ
n 	
Rn e−i
ℏp·y
	
R2n

Aψℏ
z0(x + 1
2y)ψℏz0(x −1
2y))dz0

dy
=
	
R2n W( 
Aψℏ
z0, ψℏ
z0)(z)dz0
which concludes the proof.
□
In Section 8.4 we discussed the notion of frame. This notion can be generalized
to the continuous case, and this will allow us to interpret the results above. Let
us ﬁrst give the following deﬁnition:
Deﬁnition 238. Let H be a complex Hilbert space and (M, µ) a measure space
with positive measure µ. A continuous (or generalized) frame in H is a family of
vectors (ψz)z∈M in H such that:
(i) For every ψ ∈H the mapping z −→(ψ|ψz)H is a measurable function on
(M, µ);

168
Chapter 11.
Coherent States and Anti-Wick Quantization
(ii) There exist constants a, b > 0 such that
a∥ψ∥2
H ≤
	
M
|(ψ|ψz)H|2dµ(z) ≤b∥ψ∥2
H
(11.9)
for every vector ψ ∈H.
When a = b (resp. a = b = 1) the family (ψz)z∈M is called a tight (resp.
normalized) continuous frame.
In what follows we choose H = L2(Rn) and M = R2n; µ is the usual Lebesgue
measure.
Proposition 239. The family (ψℏ
z)z∈R2n is a continuous tight Gabor frame in
L2(Rn) with bound (2πℏ)n.
Proof. We have by deﬁnition ψℏ
z = 
T(z)ψℏ
0, hence
(ψ|ψℏ
z )L2 = (2πℏ)nA(ψ, ψℏ
0)(z)
thus the mapping z −→(ψ|ψℏ
z )L2 is continuous and hence measurable. In view of
formula (11.5) in Proposition 235 we have
(2πℏ)n ∥ψ∥2
L2 =
	
R2n |(ψ|ψℏ
z0)L2(Rn)|2dz0
hence (ψℏ
z)z∈R2n is a tight frame.
□
Much of what we have said above is not speciﬁc to the choice ψℏ
z0 and remains
valid in a much more general setting. We refer to Peremolov’s paper [132] for a
generalization scheme useful for various physical problems that have dynamical
symmetries. From a more abstract point of view one can deﬁne a very general
notion of coherent states in Hilbert spaces as follows (see Kisil [108]):
Deﬁnition 240. Let H be a Hilbert space and G a Lie group with Haar measure µ
acting on H. A family {ψg ∈H : g ∈G} is called a system of coherent states if
(i) There is a representation T : g −→T g of the group G by unitary operators
on H;
(ii) There is a vector ψ0 ∈H such that for ψg = Tgψ0 and every ψ ∈H we have
∥ψ∥2
H =
	
G
|(ψ|ψg)H|2dµ.
(11.10)
The coherent states we have been studying above correspond to the choices
H = L2(Rn), G = Hn (the Heisenberg group); the representation T is of course
here the mapping (z0, t) −→
T(z0, t) where

T(z0, t)ψ(x) = e
i
ℏ(tp0·x−1
2 t2p0·x0)ψ(x −tx0)
(see formula (8.4) in Chapter 8).

11.2.
Wigner transforms of Gaussians
169
11.2
Wigner transforms of Gaussians
In Chapter 6 (Proposition 106) we expressed Hardy’s multi-dimensional uncer-
tainty principle in terms of the topological notion of symplectic capacity studied
in Chapter 5. We are going to see that similar methods allow us to show that the
Wigner transform cannot be “too concentrated” in phase space; the result can be
expressed in terms of the symplectic capacity of the “Wigner ellipsoid”.
11.2.1
Some explicit formulas
Let us begin by giving a formula allowing us to calculate the Fourier transform
Fψ(x) =

1
2πℏ
n/2 	
Rn e−i
ℏx·x′ψ(x′)dx′
of a complex Gaussian function:
Lemma 241. Let φM(x) = e−1
2ℏMx2 where M = X + iY is a symmetric complex
n × n matrix such that X = Re M > 0. We have
FφM(x) = (det M)−1/2φM−1(x)
(11.11)
where (det M)−1/2 is given by the formula
(det M)−1/2 = λ−1/2
1
· · · λ−1/2
m
,
the numbers λ−1/2
1
, . . . , λ−1/2
n
being the square roots with positive real parts of the
eigenvalues λ−1
1 , . . . , λ−1
m of M −1.
Proof. It is standard, generalizing from the case n = 1 and using a simultaneous
diagonalization of X and Y . See, e.g., Folland [59], Appendix A.
□
From now on we denote by ψℏ
M the Gaussian function deﬁned by
ψℏ
M(x) =
 1
πℏ
n/4 (det X)1/4e−1
2ℏMx2
(11.12)
where M is as above. The coeﬃcient in front of the exponential is chosen so
that ψℏ
M is normalized to unity: ∥ψℏ
M∥L2 = 1. Gaussians of this type are called
“squeezed coherent states”; they will be studied in detail in Chapter 11. Note that
since X > 0 we have ψℏ
M ∈S(Rn) and hence Wψℏ
M ∈S(Rn ⊕Rn). The following
result shows that Wψℏ
M is in fact a phase space Gaussian of a very special type:
Proposition 242. Let M = X + iY and ψℏ
M be deﬁned as above.
(i) The Wigner transform Wψℏ
M is the phase space Gaussian
Wψℏ
M(z) =
 1
πℏ
n e−1
ℏGz2
(11.13)

170
Chapter 11.
Coherent States and Anti-Wick Quantization
where G is the symmetric matrix
G =

X + Y X−1Y
Y X−1
X−1Y
X−1

;
(11.14)
(ii) We have G ∈Sp(2n, R); in fact G = ST S where
S =

X1/2
0
X−1/2Y
X−1/2

(11.15)
is a symplectic matrix.
Proof of (i). Set C(X) = (πℏ)−n/4 (det X)1/4. By deﬁnition of the Wigner trans-
form we have
Wψℏ
M(z) =

1
2πℏ
n C(X)2
	
Rn e−i
ℏp·ye−1
2ℏF (x,y)dy
(11.16)
where the phase F is deﬁned by
F(x, y) = (X + iY )(x + 1
2y)2 + (X −iY )(x −1
2y)2
= 2Xx · x + 2iY x · y + 1
2Xy · y
and hence
Wψℏ
M(z) =

1
2πℏ
n e−1
ℏXx2C(X)2
	
Rn e−i
ℏ(p+Y x)·ye−1
4ℏXy2dy.
Using the Fourier transformation formula (11.11) above with x replaced by p+Y x
and M by 1
2X we get
	
Rn e−i
ℏ(p+Y x)·ye−1
4ℏXy·ydy = (2πℏ)n/2 
det( 1
2X)
 −1/2
× C(X)2 exp

−1
ℏX−1(p + Y x) · (p + Y x)
 
.
On the other hand we have
(2πℏ)n/2 
det( 1
2X)
 −1/2 C(X)2 =
 1
πℏ
n
and hence
Wψℏ
M(z) =
 1
πℏ
n e−1
ℏGz2
where
Gz2 = (X + Y X−1)x · x + 2X−1Y x · p + X−1p · p;
Proof of (ii). The symmetry of G is obvious, and so is the factorization G = ST S.
One immediately veriﬁes that ST JS = J hence S ∈Sp(2n, R) as claimed.
□

11.2.
Wigner transforms of Gaussians
171
Exercise 243. Verify directly that Wψℏ
M is normalized to unity by making the
change of variables u = Sz in the integral in formula (11.16).
In particular, when ψℏ
0 is the “coherent state” deﬁned by
ψℏ
0(x) =
 1
πℏ
n/4 e−1
2ℏ|x|2
(11.17)
we immediately get from (11.13) and (11.14) the formula
Wψℏ
0(z) =
 1
πℏ
n e−1
ℏ|z|2
(11.18)
well known from quantum mechanics.
11.2.2
The cross-Wigner transform of a pair of Gaussians
Let us generalize formula (11.13) by calculating the cross-Wigner transform
W(ψℏ
M, ψM′) of a pair of Gaussians of the type above; we recall that the Wigner-
Moyal transform of ψ, φ ∈S(Rn) is deﬁned by
W(ψ, φ)(z) =

1
2πℏ
n 	
Rn e−i
ℏp·yψ(x + 1
2y)φ(x −1
2y)dy.
(11.19)
Proposition 244. Let ψℏ
M and ψℏ
M′ be Gaussian functions of the type (11.12). We
have
W(ψℏ
M, ψℏ
M′)(z) =
 1
πℏ
n CM,M′e−1
ℏF z2
(11.20)
where CM,M′ is a constant given by
CM,M′ = (det XX′)1/4 det
 1
2(M + M ′)
 −1/2
(11.21)
and F is the symmetric complex matrix given by
F =

2M ′(M + M ′)−1M
−i(M −M ′)(M + M ′)−1
−i(M + M ′)−1(M −M ′)
2(M + M ′)−1

.
(11.22)
Proof. We have
W(ψℏ
M, ψℏ
M′)(z) = C(X, X′)
	
Rn e−i
ℏpye−1
2ℏΦ(x,y)dy
where the functions C and Φ are given by
C(X, X′) = 2−n  1
πℏ
2n (det XX′)1/4,
Φ(x, y) = M(x + 1
2y)2 + M ′(x −1
2y)2.
Let us evaluate the integral
I(z) =
	
Rn e−i
ℏpye−1
2ℏΦ(x,y)dy.

172
Chapter 11.
Coherent States and Anti-Wick Quantization
We have
Φ(x, y) = (M + M ′)x2 + 1
4(M + M ′)y2 + (M −M ′)x · y
and hence
I(z) = e−1
2ℏ(M+M′)x2 	
Rn e−i
ℏ[p−i
2 (M−M′)x]·ye−1
8ℏ(M+M′)y2dy.
Using the Fourier transformation formula (11.11) we get
I(z) = (2πℏ)n/2 det
 1
4(M + M ′)
 −1/2
× exp

−1
2ℏ
!
(M + M ′)x2 + 4(M + M ′)−1 
p −1
2(M −M ′)x
2"
.
A straightforward calculation shows that
1
2(M + M ′)x2 + 4(M + M ′)−1 
p −1
2(M −M ′)x
2 = Fz · z
where F is the matrix

K
−i(M −M ′)(M + M ′)−1
−i(M + M ′)−1(M −M ′)
2(M + M ′)−1

(11.23)
with left upper block
K = 1
2

M + M ′ −(M −M ′)(M + M ′)−1(M −M ′)
 
.
Using the identity
M + M ′ −(M −M ′)(M + M ′)−1(M −M ′) = 4M ′(M + M ′)−1M
(11.24)
the matrix (11.23) is given by (11.22). We thus have, collecting the constants and
simplifying the obtained expression,
W(ψℏ
M, ψℏ
M′)(z) =
 1
πℏ
n (det XX′)1/4 det
 1
2(M + M ′)
 −1/2 e−1
ℏF z2
which we set out to prove.
□
Exercise 245. Check the matrix identity (11.24) above and verify that when M =
M ′ the matrix F is identical to the matrix G in formula (11.14) for the Wigner
transform of a Gaussian.
11.3
Squeezed coherent states
We have seen that the usual coherent states are minimum extension wavepackets,
in the sense that the Heisenberg inequalities become equalities for these states.
However, this property is not characteristic of these coherent states.

11.3.
Squeezed coherent states
173
11.3.1
Deﬁnition and characterization
We deﬁne the squeezed coherent states in terms of their Wigner transform:
Deﬁnition 246. A function ψ ∈S(Rn) is called a (normalized) squeezed coherent
state if its Wigner transform is
Wψ(z) =
 1
πℏ
n e−1
ℏG(z−z0)2
(11.25)
where G ∈Sp(2n, R) is positive deﬁnite: G = GT > 0 and z0 ∈R2n.
Recall that
Wψℏ
0(z) =
 1
πℏ
n e−1
ℏ|z|2
(11.26)
(formula (11.18) hence, with this terminology, ψℏ
0 is itself a squeezed coherent
state. Let ψℏ
M be given by (11.12), that is
ψℏ
M(x) =
 1
πℏ
n/4 (det X)1/4e−1
2ℏMx2
(11.27)
with M = X+iY , X and Y symmetric, X > 0. Using Proposition 242 and formula
(9.24) in Proposition 174, we see that every function of the type 
T(z0)ψℏ
M satisﬁes
(11.25) with
G =
X + Y X−1Y
Y X−1
X−1Y
X−1

;
(11.28)
moreover G = ST S with
S =

X1/2
0
X−1/2Y
X−1/2

.
(11.29)
We are going to see that every squeezed coherent state is of the type 
T(z0)ψℏ
M
and that it can be obtained from the standard coherent state ψℏ
0 using the aﬃne
metaplectic group AMp(2n, R).
Proposition 247. A function ψ is a squeezed coherent state if and only if there
exists 
S ∈Mp(2n, R) and z0 ∈R2n such that
ψ = eiγ 
T(z0)
Sψℏ
0
where ψℏ
0 is the standard coherent state and γ is real.
Proof. We ﬁrst remark that the relation
W(eiγ 
T (z0)
Sψℏ
0)(z) = W(
Sψℏ
0)(z −z0)
reduces the proof to case z0 = 0. Let us thus show that if
Wψ(z) =
 1
πℏ
n e−1
ℏGz2

174
Chapter 11.
Coherent States and Anti-Wick Quantization
with G > 0 and symplectic, then ψ is equal to 
Sψℏ
0 (up to a complex factor
with modulus 1) for some metaplectic operator 
S. We may write G = S2 where
S ∈Sp(2n, R) is symmetric (Corollary 33). Thus
Wψ(S−1z) =
 1
πℏ
n e−1
ℏ|z|2 = Wψℏ
0(z).
In view of the metaplectic covariance formula (10.27) for Wigner transforms we
have Wψ(S−1z) = W(
Sψ)(z) where 
S ∈Mp(2n, R) is such that πMp(
S) = S; it
follows that ψ = eiγ. We will see in a moment how to calculate explicitly 
Sψℏ
0,
but let us ﬁrst note that an immediate consequence of the discussion above is that
the metaplectic group acts on squeezed coherent states. Let us introduce some
notation:
□
Notation 248. The set of all squeezed coherent states is denoted by Σℏ(n); the
subset consisting of all centered squeezed coherent state is denoted by Σℏ
0(n).
It turns out that we have a continuous group action
Mp(2n, R) × Σℏ
0(n) −→Σℏ
0(n),
(
S, ψℏ
M) −→
Sψℏ
M.
In fact, every ψℏ
M ∈Σℏ
0(n) can be written 
SMψℏ
0 for some 
SM ∈Mp(2n, R) hence

Sψℏ
M = (
S 
SM)ψℏ
0 is also a squeezed coherent state. The action of Mp(2n, R) on
Σℏ
0(n) is transitive: for every pair (ψℏ
M, ψℏ
M′) ∈Σℏ
0(n)×Σℏ
0(n) we have ψℏ
M = Sψℏ
M′
with 
S = 
S−1
M′ 
SM if ψℏ
M = 
SMψℏ
0 and ψℏ
M′ = 
SM′ψℏ
0. These elementary remarks
lead to an interesting topological identiﬁcation of Σℏ
0(n): we have
Σℏ
0(n) ≡Mp(2n, R)/U(2n, R).
(11.30)
This is easily seen as follows: by the theory of homogeneous spaces there is a
bijection of Σℏ
0(n) on every coset space Mp(2n, R)/St(ψ) where
St(ψ) = { 
S ∈Mp(2n, R) : 
Sψ = ψ}
is the stabilizer (or isotropy subgroup) of ψ. Let us choose in particular ψ = ψℏ
0, the
standard coherent state. The stabilizer of ψℏ
0 consists of all metaplectic operators

S such that 
Sψℏ
0 = ψℏ
0, that is W(
Sψℏ
0) = Wψℏ
0. Since Wψℏ
0(z) = (πℏ)−n e−1
ℏ|z|2
(formula (11.26) and W(
Sψℏ
0)(z) = W(ψℏ
0)(S−1z) the condition W(
Sψℏ
0) = Wψℏ
0
is equivalent to |S−1z|2 = |z|2 hence S must be a symplectic rotation, i.e.,
S ∈Sp(2n, R) ∩O(2n, R) = U(2n, R)
whence the identiﬁcation (11.30).
Problem 249. Show that there is a natural action
AMp(2n, R) × Σℏ(n) −→Σℏ(n),
(
S 
T(z), ψℏ
z0,M) −→
S 
T(z)ψℏ
z0,M
and generalize the discussion above to this case.

11.3.
Squeezed coherent states
175
11.3.2
Explicit action of Mp(2n, R) on squeezed states
Recall that the aﬃne metaplectic group AMp(2n, R) consists of all operators

T(z0)
S (or 
S 
T(z0)) where 
S ∈Mp(2n, R) and z0 ∈R2n.We will need the fol-
lowing factorization formula for symplectic matrices (it is a reﬁnement of the po-
lar decomposition result in Proposition 34). It is sometimes called a pre-Iwasawa
factorization in the theory of Lie groups.
Proposition 250. Let S =

A
B
C
D

be a symplectic matrix. We have a unique
factorization
S =
I
0
P
I
 L
0
0
L−1
  U
V
−V
U

(11.31)
where P = P T , L = LT (det L ̸= 0), X, and Y are given by the formulas
P = (CAT + DBT )(AAT + BBT )−1
(11.32)
L = (AAT + BBT )1/2
(11.33)
U = (AAT + BBT )−1/2A
(11.34)
V = (AAT + BBT )−1/2B.
(11.35)
The proof of this proposition is given in detail in de Gosson [67], Chapter 2,
§2.2.2. Note that we have
R =

U
V
−V
U

∈U(2n, R)
and hence RRT = RT R = I because R is a symplectic rotation (see Subsection
2.3.2).
Exercise 251. Show that every symplectic matrix S =

A
B
C
D

can be written in
the form
S =
L
0
Q
L−1
  U
V
−V
U

(11.36)
where Q is given by the formula
Q = (CAT + DBT )(AAT + BBT )−1/2.
(11.37)
Recall from Proposition 242 that the Wigner transform of a Gaussian
ψℏ
M(x) =
 1
πℏ
n/4 (det X)1/4e−1
2ℏMx2
is given by the formula
Wψℏ
M(z) =
 1
πℏ
n e−1
ℏGz2
(11.38)

176
Chapter 11.
Coherent States and Anti-Wick Quantization
where G = ST S is symplectic matrix, the matrix S being given by
S =
 X1/2
0
X−1/2Y
X−1/2

,
(11.39)
that is
G =
X + Y X−1Y
Y X−1
X−1Y
X−1

.
(11.40)
The following result is an easy consequence of the formulas above:
Proposition 252. Let 
S ∈Mp(2n, R) have projection S =

A
B
C
D

on Sp(2n, R).
We have

Sψℏ
0(x) = eiγ  1
πℏ
n/4 (det X)1/4e−1
2ℏMx2
(11.41)
where the phase γ is a real constant and M = X + iY where X and Y are real
symmetric matrices given by
X = (AAT + BBT )−1,
(11.42)
Y = (CAT + DBT )(AAT + BBT )−1.
(11.43)
Proof. We have W(
Sψℏ
0)(z) = W(ψℏ
0)(S−1z) and hence, using formula (11.26),
W(
Sψℏ
0)(z) =
 1
πℏ
n e−1
ℏ(S−1)T S−1z2.
(11.44)
Using formula (2.6) for the inverse of a symplectic matrix we have
(S−1)T S−1 =

CCT + DDT
−DBT −CAT
−BDT −ACT
AAT + BBT

and hence, comparing with (11.40),
X + Y X−1Y = CCT + DDT
, Y X−1 = −DBT −CAT ,
X−1Y = −BDT −ACT
, X−1 = AAT + BBT .
Solving this system of matrix equations yields the solutions (11.42) and (11.43).
That 
Sψℏ
0(x) is given by (11.41) follows from the fact that the Wigner transform of
ψℏ
M(x) = eiγ  1
πℏ
n/4 (det X)1/4e−1
2ℏMx2
is given by (11.38).
□
One can use formula (11.44) to describe the action of 
S ∈Mp(2n, R) on
general squeezed coherent states. However the formulas and calculations are rather
lengthy, and in addition it is not immediate that the exact phase factor here is

11.4.
Anti-Wick quantization
177
another method, which has a pleasant geometrical ﬂavor. Let us denote by Σn the
Siegel half-space, that is
Σn = {Z : Z = ZT , Im M > 0}
where Z denotes a complex n × n matrix. We have the following interesting result
which describes the action of fractional linear transforms on the Siegel half-space:
Proposition 253. Let S ∈Sp(2n, R) be given by (2.3) and Z ∈Σn. Then det(A +
BZ) ̸= 0, det(C + DZ) ̸= 0 and
α(S) = (C + DZ)(A + BZ)−1 ∈Σn
(11.45)
(in particular α(S) is symmetric), and
α(SS′) = α(S)α(S′).
(11.46)
The action Sp(2n, R) × Σn −→Σn thus deﬁned is transitive.
(Proof omitted; see Folland [59] or Littlejohn [117].)
Let 
S ∈Mp(2n, R) have projection S = πMp(
S) =
A
B
C
D

on Sp(2n, R);
one then proves that

Sψℏ
0(x) =
 1
πℏ
n/4
im( 
S)

det(A + iB)
exp

−1
2ℏα(S)x2

where the branch cut of the square root of det(A + iB) is taken to lie just under
the positive real axis; m(
S) is the Maslov index of 
S. It follows from this formula
that a squeezed state of the type 
Sψℏ
z0(x) is easily calculated: since by deﬁnition
ψℏ
z0 = 
T(z0)ψℏ
0, the metaplectic covariance formula 
S 
T(z0)
S−1 = 
T(Sz0) (see
(8.11)) immediately yields

Sψℏ,
z0(x) = 
T(Sz0)
Sψℏ
0(x).
The results above can be generalized to arbitrary squeezed coherent states:
Let ψℏ
z0,M (M ∈Σn), be a squeezed coherent state and 
S ∈Mp(2n, R),
S = πMp(
S). We have

Sψℏ
0,M = ψℏ
α(S)M ,

Sψℏ
z0,M = 
T(Sz0)ψℏ
α(S)M.
11.4
Anti-Wick quantization
There are several equivalent ways of deﬁning anti-Wick pseudo-diﬀerential opera-
tors (also called Toeplitz, or Berezin, operators). In this section we review several
possibilities.

178
Chapter 11.
Coherent States and Anti-Wick Quantization
11.4.1
Deﬁnition in terms of coherent states
We recall that ψℏ
0 is the standard coherent state deﬁned by
ψℏ
0(x) =
 1
πℏ
n/4 e−1
2ℏ|x|2.
(11.47)
We denote by 
Πℏ
0 the orthogonal projection operator of L2(Rn) onto the ray {λψℏ
0 :
λ ∈C}, that is

Πℏ
0ψ = (ψ|ψℏ
0)L2(Rn)ψℏ
0.
(11.48)
The Weyl symbol π0 of 
Πℏ
0 is (2πℏ)n times the Wigner transform of ψℏ
0; in view of
formula (11.18) we have Wψℏ
0(z) = (πℏ)−ne−|z|2/ℏand hence π0(z) = 2ne−|z|2/ℏ.
Consider now the operator 
Πℏ(z0) with Weyl symbol the translated Gaussian
πz0(z) = T (z0)π0(z) = 2ne−1
ℏ|z−z0|2;
(11.49)
in view of Proposition 219 we have

Πℏ(z0) = 
T(z0)
Πℏ
0 
T(z0)−1
where 
T(z0) is the Heisenberg–Weyl operator. In particular we see that 
Πℏ(z0) is
the orthogonal projection in L2(Rn) onto the ray {λψℏ
z0 : λ ∈C} where ψℏ
z0 =

T(z0)ψℏ
0 (see formula (11.50) below).
The following lemma contains a few useful formulas which we will use to
study anti-Wick operators;
Lemma 254. We have, for every ψ ∈L2(Rn),

Πℏ(z0)ψ = (ψ|ψℏ
z0)L2(Rn)ψℏ
z0.
(11.50)
In particular
(
Πℏ(z0)ψ|φ)L2(Rn) = (ψ|ψℏ
z0)L2(Rn)(ψℏ
z0|φ)L2(Rn).
(11.51)
We moreover have the identities

Πℏ(z0)ψ = (2πℏ)nA(ψ, ψℏ
0)(z0)ψℏ
z0
(11.52)
and hence
(
Πℏ(z0)ψ|φ)L2(Rn) = (2πℏ)2nA(ψ, ψℏ
0)(z0)A(ψℏ
0, φ)(z0).
(11.53)
Proof. Let ψ ∈L2(Rn); we have

Πℏ(z0)ψ = 
T(z0)
Πℏ
0( 
T(z0)−1ψ)
= ( 
T (z0)−1ψ|ψℏ
0)L2 
T(z0)ψℏ
0
= (ψ| 
T (z0)ψℏ
0)L2 
T(z0)ψℏ
0

11.4.
Anti-Wick quantization
179
(the last equality because 
T(z0)−1 = 
T(z0)∗) hence 
Πℏ(z0) is indeed the orthogonal
projection on {λψℏ
z0 : λ ∈C}. Formula (11.51) immediately follows from (11.50).
Formula (11.50) can be rewritten

Πℏ(z0)ψ = (ψ| 
T(z0)ψℏ
0)L2(Rn)ψℏ
z0
and hence, by Deﬁnition (9.1) of the cross-ambiguity function,

Πℏ(z0)ψ = (2πℏ)nA(ψ, ψℏ
0)(z0)ψℏ
z0
which is precisely formula (11.52). Formula (11.53) follows by a similar argument,
rewriting formula (11.51) as
(
Πℏ(z0)ψ|φ)L2(Rn) = (ψ| 
T(z0)ψℏ
0)L2( 
T(z0)ψℏ
0|φ)L2.
□
These considerations lead to the following deﬁnition:
Deﬁnition 255. Let a ∈S(Rn); the anti-Wick operator 
AaW with symbol a is
deﬁned by

AaWψ =
	
R2n a(z0)
Πℏ(z0)ψdz0
(11.54)
or, equivalently, by

AaWψ = (2πℏ)n
	
R2n a(z0)A(ψ, ψℏ
0)(z0)ψℏ
z0dz0.
(11.55)
We will write 
AaW
AW
←→a or a
AW
←→
AaW.
The equivalence of Deﬁnitions (11.54) and (11.55) of 
AaW is immediate taking
formula (11.52) in Lemma 254 into account.
We note that if ψ ∈S(Rn) then the function z0 −→
Πℏ(z0)ψ is in S(R2n),
hence one can expect the deﬁnition of 
AaWψ for large classes of symbols. We will
see later that Shubin classes are excellent choices, but the following remark is
already very useful:
Proposition 256. The anti-Wick operator 
AaW is uniquely deﬁned by the formula
( 
AaWψ|φ)L2(Rn) = (2πℏ)2n(aA(ψ, ψℏ
0)|A(φ, ψℏ
0 ))L2(R2n).
(11.56)
Proof. We have (cf. formula (11.53))
( 
AaWψ|φ)L2 = (2πℏ)n
	
R2n a(z0)A(ψ, ψℏ
0)(z0)(ψℏ
z0|φ)L2dz0
= (2πℏ)n
	
R2n a(z0)A(ψ, ψℏ
0)(z0)(φ|ψℏz0)L2dz0
= (2πℏ)2n
	
R2n a(z0)A(ψ, ψℏ
0)(z0)A(φ, ψℏ
0)L2dz0,
hence (11.56).
□

180
Chapter 11.
Coherent States and Anti-Wick Quantization
Immediate – and very pleasant – features of anti-Wick operators are the
following self-adjointness and positivity properties:
Proposition 257. Let a be a symbol deﬁning an anti-Wick operator 
AaW.
(i) If a is real then 
AaW is self-adjoint.
(ii) If in addition a ≥0 then 
AaW ≥0, that is ( 
AaWψ|ψ)L2(Rn) ≥0 for all
ψ ∈L2(Rn).
Proof of (i). We have
( 
AaWψ|φ)L2 =
	
R2n a(z0)(
Πℏ(z0)ψ|φ)L2dz0
and, by the sesquilinearity of the L2 inner product,
(ψ| 
A∗
aWφ)L2 =
	
R2n a∗(z0)(
Πℏ(z0)φ|ψ)L2dz0.
(a∗is the symbol of 
A∗
aW). In view of formula (11.51), (11.50) we have
(
Πℏ(z0)φ|ψ)L2 = (
Πℏ(z0)ψ|φ)L2
hence ( 
AaWψ|φ)L2 = (ψ| 
A∗
aWφ)L2 when a is a real function.
Proof of (ii). We have
( 
AaWψ|ψ)L2 =
	
R2n a(z0)(
Πℏ(z0)ψ|ψ)L2dz0;
in view of (11.50) we have
(
Πℏ(z0)ψ|ψ)L2 = (ψ|ψ)2
L2 ≥0
hence ( 
AaWψ|ψ)L2 ≥0 if a ≥0.
□
11.4.2
The Weyl symbol of an anti-Wick operator
Every anti-Wick operator S(Rn) −→S′(Rn) can be viewed as a Weyl operator. We
are going to determine the Weyl symbol of 
AaW, but let us ﬁrst recall (Proposition
200) that if 
A
Weyl
←→a then we have
( 
Aψ|φ)L2(Rn) =
	
R2n a(z)W(ψ, φ)(z)dz
(11.57)
for all ψ and φ in S(Rn).

11.4.
Anti-Wick quantization
181
Proposition 258. The Weyl symbol aw of the anti-Wick operator 
AaW
AW
←→a is
given by the convolution formula
aw(z) =
	
R2n e−1
ℏ|z−z0|2a(z0)dz0.
(11.58)
Proof. We have, by Deﬁnition (11.54),
( 
AaWψ|φ)L2 =
	
R2n a(z0)(
Πℏ(z0)ψ|φ)L2dz0
that is, taking formulas (11.57) and (11.49) into account:
( 
AaWψ|φ)L2 = 2n
	
R2n a(z0)
	
R2n e−1
ℏ|z−z0|2W(ψ, φ)(z)dz

dz0
= 2n
	
R2n
	
R2n a(z0)e−1
ℏ|z−z0|2dz0

W(ψ, φ)(z)dz
hence (11.58), using again (11.57).
□
We notice that in view of formula (11.58) the Weyl symbol of an anti-Wick
operator is real analytic: expanding the exponential in a Taylor series we obtain
a power series for aw(z). This fact shows that not every Weyl operator can be
written as an anti-Wick operator. In [28] (Theorem 5.1) Cordero and Nicola have
shown that one can build an exact Weyl/anti–Wick correspondence for all Weyl
operators whose symbol is real analytic on R2n and satisﬁes a certain condition
which is expressed in terms of a certain modulation space. In the general case one
can prove the following result:
Proposition 259. Let 
A
Weyl
←→a be such that the symbol a satisﬁes the following
conditions: a ∈C∞(Rn ⊕Rn) and for every α ∈N2n there exists a constant
Cα ≥0 with
|∂α
z a(z)| ≤Cα ⟨z⟩m−ρ|α|
for z ∈R2n
(11.59)
where ⟨z⟩= (1 + |z|2)1/2. Then there exists an anti-Wick operator 
BaW
AW
←→b
where b ∈C∞(Rn ⊕Rn) also satisﬁes the estimates (11.59) and such that the
kernel K of 
A −
BaW is in S(Rn × Rn).
We omit the proof of this result here, and refer to Shubin [147] (Theorem
24.2). The conditions (11.59) on the symbol characterize the Shubin class Γm
ρ (Rn⊕
Rn) which will be studied in Chapter 14).
11.4.3
Some regularity results
We are going to show that anti-Wick operators are continuous in S(Rn) (and hence
in S′(Rn)) if one makes a rather mild assumption of polynomial increase on its
symbol (cf. Proposition 259).

182
Chapter 11.
Coherent States and Anti-Wick Quantization
Proposition 260. Assume that a satisﬁes the conditions (11.59) in Proposition 259.
Then 
AaW
AW
←→a is a continuous map S(Rn) −→S(Rn) and hence extends into a
continuous map S′(Rn) −→S′(Rn).
Proof. In view of formula (11.58) for the Weyl symbol aw of 
AaW we have
aw(z) =
	
R2n e−1
ℏ|z0|2a(z −z0)dz0
and hence, for every multi-index α ∈N2n,
zα∂α
z aw(z) =
	
R2n e−1
ℏ|z0|2zα∂α
z a(z −z0)dz0
so that
|zα∂α
z aw(z)| ≤Cℏ
α
	
R2n e−1
ℏ|z0|2 ⟨z −z0⟩m+(1−ρ)|α| dz0 < ∞
for some constant Cℏ
α > 0. It follows that aw ∈S(Rn) hence the result in view of
Proposition 195.
□
Exercise 261. Prove the result above using directly Deﬁnition (11.54) of an anti-
Wick operator.
The following operator estimate for the anti-Wick correspondence is very
interesting:
Proposition 262. Let 
AaW
AW
←→a and
∥
AaW∥=
sup
ψ∈S(Rn),ψ̸=0
∥
AaWψ∥
∥ψ∥
(11.60)
be the operator norm of 
AaW. We have
∥
AaW∥≤sup
z∈R2n |a(z)|.
(11.61)
Proof. We will prove the estimate (11.61) when a is a real-valued symbol; for the
general case we refer to Shubin [147] (Problem 24.4, p. 191). Since a is real the
operator 
AaW is self-adjoint in view of Proposition 257(i). Let λ ≥0; the inequality
∥
AaW∥≤λ is equivalent when A is self-adjoint to λI−
AaW ≥0 and λI+ 
AaW ≥0.
These relations obviously hold for λ = supz∈R2n |a(z)|, hence (11.61).
□
Exercise 263. Apply the proof above to Re a and Im a to show that ∥
AaW∥≤
2 supz∈R2n |a(z)|.

11.4.
Anti-Wick quantization
183
Corollary 264. Let the symbol a satisfy the estimates (11.59) with m = 0.
Thus |∂α
z a(z)| ≤Cα ⟨z⟩−ρ|α| for every multi-index α. The anti-Wick operator

AaW
AW
←→a is then bounded on L2(Rn).
Proof. The estimates satisﬁed by the symbol a imply in particular that it is
bounded, and hence
sup
ψ∈S(Rn)
∥
AaWψ∥
∥ψ∥
< ∞.
By continuity we also have
sup
ψ∈L2(Rn)
∥
AaWψ∥
∥ψ∥
< ∞
hence 
AaW is bounded on L2(Rn).
□
One also proves the following regularity results for anti-Wick operators with
symbols in Lq spaces:
Proposition 265. Let a ∈Lq(Rn ⊕Rn). Then:
(i) The operator 
AaW
AW
←→a is bounded on L2(Rn);
(ii) If 1 ≤q ≤2 The anti-Wick operator 
AaW : L2(Rn) −→L2(Rn) is compact.
Proof. See Boggiatto and Cordero [15] for a detailed argument.
□

Chapter 12
Hilbert–Schmidt and
Trace Class Operators
In this chapter we pause to make an excursion to the well-established theory
of Hilbert–Schmidt and trace class operators. These are venerable topics from
functional analysis; besides their intrinsic interest in mathematics, they are of
paramount importance for studying the notion of mixed state in quantum me-
chanics, as we will see in the next chapter.
We give here a rather succinct treatment of the topic. For details and proofs
we refer to Reed and Simon [136], Simon [149], Shubin [147] (Appendix 3), H¨or-
mander [102], §19.1; we are following de Gosson [67] with some additions, modiﬁ-
cations and improvements.
12.1
Hilbert–Schmidt operators
In what follows H is a separable Hilbert space with scalar product (·|·j)H and
associated norm ∥· ∥H. We denote by L(H) the Banach algebra of all bounded
operators on H.
We recall the elementary equality

j
(u|ej)H(v|ej)H = (u|v),
(12.1)
valid for all u, v ∈H and all orthonormal bases (ej)j of H. When u = v it is called
the Bessel equality.
12.1.1
Deﬁnition and general properties
Hilbert–Schmidt operators are deﬁned by an integrability condition with respect
to an orthonormal basis:
185
M.A. de Gosson, Symplectic Methods in Harmonic Analysis and in Mathematical Physics,  
Pseudo-Differential Operators 7, DOI 10.1007/978-3-7643-9992-4_
, © Springer Basel AG 2011 
12

186
Chapter 12.
Hilbert–Schmidt and Trace Class Operators
Deﬁnition 266. An operator 
A ∈L(H) is called a Hilbert–Schmidt operator (for
short: 
A is Hilbert–Schmidt) if there exists an orthonormal basis (ej)j of H such
that

j,k
|( 
Aej| 
Aej)H =

j
∥
Aej∥2
H < ∞.
(12.2)
We denote by L2(H) the set of all Hilbert–Schmidt operators on H.
If the condition (12.2) holds for one orthonormal basis then it holds for all,
and the sum 
j ∥
Aej∥2
H does moreover not depend on the choice of basis. Let us
prove this essential property. Let in fact (fj)j be an arbitrary orthonormal basis,
and write 
Aej = 
k( 
Aej|fj)Hfk. Then, using (12.1) with u = v = 
Aej,

j
∥
Aej∥2
H =

j,k
|( 
Aej|fj)H|2 =

j,k
|(ej| 
A∗fj)H|2
that is, again by (12.1), with this time u = v = 
A∗fj,

j
∥
Aej∥2
H =

j,k
|( 
A∗fj|ej)H|2 =

k
∥
A∗fk∥2
H < ∞.
Taking (fj)j = (ej)j we have 
k ∥
A∗ek∥2
H < ∞hence the adjoint is also Hilbert–
Schmidt; we may thus replace 
A by 
A∗in the inequality above, which yields

k ∥
Afk∥2
H < ∞as claimed. Notice that we have at the same time proved that

A ∈L(H) is Hilbert–Schmidt if and only if 
A∗is.
Proposition 267. We have:
(i) The set L2(H) is a vector subspace of L(H) and the function ∥· ∥HS ≥0
deﬁned by the formula
∥
A∥2
HS =

i
∥
Aei∥2
H
(12.3)
is a norm on that subspace;
(ii) L2(H) is a two-sided *-ideal in L(H): if 
A ∈L2(H) and 
B ∈L(H) then

A 
B ∈L2(H) and 
B 
A ∈L2(H) and we have 
A∗∈L2(H).
Proof of (i). If 
A and 
B are Hilbert–Schmidt operators then λ 
A is trivially a
Hilbert–Schmidt operator and ∥λ 
A∥HS = |λ∥| 
A∥HS for every λ ∈C; on the other
hand

j
∥( 
A + 
B)ej∥2
H ≤

j
∥
Aej∥2
H +

j
∥
Bej∥2
H < ∞

12.1.
Hilbert–Schmidt operators
187
for every orthonormal basis (ej)j hence 
A + 
B is also a Hilbert–Schmidt operator
and we have
∥
A + 
B∥2
HS ≤∥
A∥2
HS + ∥
B∥2
HS
hence also
∥
A + 
B∥HS ≤∥
A∥HS + ∥
B∥HS.
Finally, ∥
A∥HS = 0 is equivalent to 
Aej = 0 for every index j, that is to 
A = 0.
Proof of (ii). Let us show that 
B 
A ∈L2(H). We have, denoting by ∥
B∥the oper-
ator norm of 
B,
∥
B 
A∥2
HS =

j
∥
B 
Aej∥2
H ≤∥
B∥


j
∥
Aej∥2
H

< ∞.
Applying the same argument to 
A 
B = ( 
B∗
A∗)∗shows that 
A 
B ∈L2(H) as
well.
□
The norm ∥· ∥2
HS is called the “Hilbert–Schmidt norm”. The space L2(H) is
complete for that norm, and hence a Banach space (it is actually even a Hilbert
space when equipped with a scalar product that we will deﬁne later).
We note the following useful inequality: if 
A ∈L2(H) then the operator norm
of 
A satisﬁes
∥
A∥=
sup
∥u∥H≤1
∥
Au∥H ≤∥
A∥HS.
(12.4)
To prove this inequality, it suﬃces to note that if (ej)j is an orthonormal basis
and u = 
j(u|ej)Hej then 
Au = 
j(u|ej)H 
Aej and hence
∥
Au∥H ≤

j
|(u|ej)H| · ∥
Aej∥H.
Using the Cauchy–Schwarz inequality for sums we thus have
∥
Au∥2
H ≤

j
|(u|ej)H|2 
j
∥
Aej∥2
H = ∥u∥2
H∥
A∥HS
hence (12.4) taking the supremum for ∥u∥H ≤1.
Simple examples of Hilbert–Schmidt operators are provided by the operators
of ﬁnite rank; in fact:
Problem 268. Let 
A be a bounded operator on the Hilbert space H. Prove the
following properties: (i) If 
A is of ﬁnite rank, then it is a Hilbert–Schmidt operator;
(ii) Every Hilbert–Schmidt operator is the limit of a sequence of compact operators
in L(H); (iii) Hilbert–Schmidt operators are compact operators.

188
Chapter 12.
Hilbert–Schmidt and Trace Class Operators
12.1.2
Hilbert–Schmidt operators on L2(Rn)
The following very important result characterizes all Hilbert–Schmidt operators
on L2(Rn), and is sometimes taken as their deﬁnition. Since by Hilbert–Schmidt
these operators are compact (Problem 268 above), that characterization also gives,
as a by-product, a suﬃcient (but of course not necessary) condition for an operator
on L2(Rn) to be compact.
Theorem 269. An operator 
A on L2(Rn) is a Hilbert–Schmidt operator if and only
it has a kernel K 
A ∈L2(Rn × Rn), and we have the norm equality
∥
A∥HS = ∥K 
A∥L2(Rn×Rn).
(12.5)
Proof. Let 
A be a Hilbert–Schmidt operator on L2(Rn) and choose an orthonormal
basis (ei)i in L2(Rn). The family (ei ⊗ej)i,j of tensor products is an orthonormal
basis in L2(Rn × Rn). Let us now deﬁne
K(x, y) =

i,j
( 
Aei|ej)L2ej(x) ⊗ei(y).
We have
	
R2n |K(x, y)|2dxdy ≤

i,j
|( 
Aei|ej)L2|2∥ej ⊗ei∥2
L2
=

i,j
|( 
Aei|ej)L2|2,
hence K ∈L2(Rn × Rn) using the fact that 
A is Hilbert–Schmidt. Since ψ =

i(ψ|ei)L2ei and 
Aei = 
j( 
Aej|ej)L2ej we have

Aψ(x) =

i
(ψ|ei)L2 
Aei(x)
=

i,j
(ψ|ei)L2( 
Aej|ej)L2ej(x);
since on the other hand
	
Rn K(x, y)ψ(y)dy =

i,j
( 
Aei|ej)L2(ψ|ei)ej(x),
by deﬁnition of K it follows that we have

Aψ(x) =
	
Rn K(x, y)ψ(y)dy
(12.6)

12.2.
Trace class operators
189
and hence K is the kernel of the operator 
A. The equality (12.5) now follows from
the identity (12.1). Assume conversely that the kernel of 
A ∈L(H) belongs to
L2(Rn × Rn). We can then ﬁnd numbers cij such that 
i,j |cij|2 < ∞and
K(x, y) =

i,j
cijej(x) ⊗ei(y).
Deﬁne now the operator 
A by the equality (12.6); we have

Aψ(x) =

i,j
cijej(x)
	
Rn ei(y)ψ(y)dy
=

i,j
cij(ψ|ei)L2ej(x)
and hence, since the basis (ei)i is orthonormal,

Aek =

i,j
cij(ek|ei)L2ej =

j
ckjej
so that
∥
A∥2
HS =

k
∥
Aek∥2
L2 =

j,k
|ckj|2 < ∞
and 
A is thus Hilbert–Schmidt.
□
12.2
Trace class operators
We begin by recalling some results from elementary functional analysis (see for
instance Reed and Simon [136], §6.4). Let H be a complex Hilbert space, and

A ∈L(H) be a positive operator: ( 
Au|u)H ≥0 for all u ∈H. We will write 
A ≥0.
A positive operator on a complex Hilbert space is always self-adjoint: 
A = 
A∗.
There exists a unique 
B ∈L(H) such that 
B ≥0 and 
B2 = 
A (in particular 
B is
also self-adjoint). We will write 
B =


A or 
B = 
A1/2 and call 
B the square root
of 
A.
12.2.1
The trace of a positive operator
Positive trace class operators have two main advantages: they are easy to study,
and they can be used to deﬁne trace class operators in the general case. In addition,
they are the only ones we will really need when we study the density operator in
the next chapter.

190
Chapter 12.
Hilbert–Schmidt and Trace Class Operators
Proposition 270. Let 
A ∈L(H) be such that 
A ≥0. Assume that there exists an
orthonormal basis (ej)j of H such that 
j( 
Aej|ej)H < ∞. Then 
j( 
Afj|fj)H <
∞for every orthonormal basis (fj)j of H. More precisely, we have the equality

j
( 
Aej|ej)H =

j
( 
Afj|fj)H
valid for all operators 
A ≥0, whether of trace class or not.
Proof. Let (fj)j be an arbitrary orthonormal basis of H and set
T =

j
( 
Afj|fj)H =

j
( 
A1/2fj| 
A1/2fj)H.
We are going to show that T = 
j( 
Aej|ej)H; this will prove the proposition.
Taking u = v = 
A1/2fj in (12.1) we have
( 
A1/2fj| 
A1/2fj)H =

k
|( 
A1/2fj|ek)H|2
and hence using the fact that 
A1/2 is symmetric:
T =

j
$
k
|( 
A1/2fj|ek)H|2
%
=

k


j
|( 
A1/2ek|fj)H|2


(interchanging summation signs is allowed because all the terms are positive).
Using again (12.1) we have

j
|( 
A1/2ek|fj)H|2 = ( 
A1/2ek| 
A1/2ek)H = ( 
Aek|ek)H
and hence T = 
k( 
Aek|ek)H which we set out to prove.
□
This result motivates the following deﬁnition:
Deﬁnition 271. The trace of a positive operator 
A ∈L(H) is
Tr 
A =

j
( 
Aej|ej)H
(12.7)
where (ej)j is an arbitrary orthonormal basis of H. If Tr 
A < ∞one says that 
A
is a trace class operator.
Clearly Tr 
A ≥0 (because ( 
Aej|ej)H ≥0 for every j since 
A ≥0).
Every positive trace class operator is the square of a Hilbert–Schmidt operator:

12.2.
Trace class operators
191
Proposition 272. Let 
A ∈L(H), 
A ≥0, be of trace class. The square root 
B =


A
is a Hilbert–Schmidt operator on H. Hence every positive trace class operator is
the square of a Hilbert–Schmidt operator.
Proof. Since 
A = 
B2 is of trace class we have

j
( 
Bej| 
Bej)H =

j
( 
B2ej|ej)H < ∞
for every orthonormal basis (ej)j of H, hence 
B is a Hilbert–Schmidt operator.
□
An interesting property of positive trace class operators is their invariance
under conjugation with unitary operators:
Proposition 273. Let 
A be a positive trace class operator on H and 
U a unitary
operator on H. Then 
U ∗
A 
U is also a positive trace class operator and we have
Tr(
U ∗
A
U) = Tr( 
A).
(12.8)
Proof. It is clear that 
U ∗
A 
U is a positive operator. The operator 
A is of trace
class if and only if 
j( 
Aej|ej)H < ∞for one (and hence every) orthonormal basis
(ej)j of H. Since (
U ∗
A
Uej|ej)H = ( 
A 
Uej|
Uej)H and (
Uej)j also is an orthonormal
basis of H, it follows that 
U ∗
A
U is of trace class; formula (12.8) follows from the
basis independence of formula (12.7): we have
Tr(
U ∗
A
U) =

j
(
U ∗
A
Uej|ej)H =

j
( 
A 
Uej|
Uej)H = Tr( 
A)
because (
Uej)j is an orthonormal basis since 
U is unitary.
□
Trace class operators are compact: this will be established in Proposition
280; it is already clear that this is the case for positive trace class operators using
Proposition 272 above since Hilbert–Schmidt operators are compact (Problem
268) and the product of two compact operators also is compact. We may thus
apply the spectral theory of compact operators to them. Recall the following basic
result from functional analysis obtained by amalgamating the Riesz–Schauder and
Hilbert–Schmidt theorems:
Theorem 274. Let 
A be a compact self-adjoint operator on H. Then
(i) The spectrum σ( 
A) is discrete and has no limit point except perhaps zero;
every non-zero element λj of σ( 
A) = {λj : j ∈J} is an eigenvalue with ﬁnite
multiplicity;
(ii) Ordering the λj, j ∈J so that |λj| ≥|λj+1| we have limj→∞λj = 0 if J is
inﬁnite;
(iii) There exists a system of orthonormal eigenvectors (ej)j∈J such that 
Aej =
λjej and the system (ej)j∈J is an orthonormal basis of the closure Im 
A ⊂H:

192
Chapter 12.
Hilbert–Schmidt and Trace Class Operators
(iv) For every u ∈H we have
u = v +

j∈J
(u|ej)H ,

Au =

j∈J
( 
Au|ej)H
(12.9)
with v ∈ker 
A.
For a proof see, e.g., Dieudonn´e [35], §11.5; beware of the too concise and
therefore somewhat misleading statement in Reed and Simon, Theorem VI.16.
Applying this result to positive trace class operators gives a complete char-
acterization of these operators in terms of orthogonal projections. We begin by
remarking that Theorem 274 above implies that, if we denote by Hj the eigenspace
corresponding to the eigenvalue λj > 0, then dim Hj < ∞and for j ̸= k the spaces
Hj and Hk are orthogonal. The ﬁrst formula (12.9) implies that H splits into the
Hilbert sum
H = Ker 
A ⊕(H1 ⊕H2 ⊕· · ·).
(12.10)
Proposition 275. Let 
A be a positive self-adjoint operator 
A of trace class on a
Hilbert space H; let λ1 ≥λ2 · · · be the sequence of eigenvalues of 
A and H1, H
2, . . . the corresponding eigenspaces.
(i) We have the spectral decomposition formula

A =

j
λjPj
(12.11)
where Pj is the orthogonal projection H −→Hj;
(ii) The trace of 
A is given by the formula
Tr( 
A) =

j
λj dim Hj;
(12.12)
(iii) Conversely, every operator of the type (12.11) with λj > 0 and Pj being an
orthogonal projection operator on a ﬁnite-dimensional space is of trace class
if we have 
j λj dim Hj < ∞.
Proof of (i). Choose an orthonormal basis (eij)i in each eigenspace Hj and com-
plete the union ∪i(eij)i of these bases into a full orthonormal basis of H by selecting
orthonormal vectors (fi)i in Ker 
A such that (fi, ejk)H = 0 for all j, k. Let u be
an arbitrary element of H and write

Au =

i
( 
Au|fi)Hfi +

i,j
( 
Au|eij)Heij.
Since 
A is self-adjoint we have ( 
Au, fi)H = (u, 
Afi)H = 0 and
( 
Au|eij)H = (u| 
Aeij)H = λj(u|eij)H.

12.2.
Trace class operators
193
It follows that we have

Au =

j
λj
$
i
(u|eij)Heij
%
.
The operator Pj deﬁned by
Pju =

i
(u|eij)Heij
is the orthogonal projection on Hj hence (12.11).
Proof of (ii). By deﬁnition of the trace of a positive operator we have
Tr( 
A) =

i
( 
Afi|fi)H +

i,j
( 
Aeij|eij)H;
since ( 
Afi, fi)H = 0 and ( 
Aeij, eij)H = λj for every index i this reduces to
Tr( 
A) =

i,j
λj(eij|eij)H =

j
λj
$
i
(eij|eij)H
%
(12.13)
hence (12.12) since the sum indexed by i is equal to the dimension of the eigen-
space Hj.
Proof of (iii). Any operator 
A that can be written in the form (12.11) is self-
adjoint because orthogonal projections are self-adjoint operators; moreover the
operator 
A is positive and the condition 
j λj dim Hj < ∞is precisely equivalent
to 
A being of trace class in view of the second equality (12.13).
□
12.2.2
General trace class operators
In many texts one deﬁnes trace class operators on H as operators 
A ∈L(H) such
that | 
A| = ( 
A∗
A)1/2 is of trace class in the sense of the last subsection. In other
texts they are deﬁned as products of two Hilbert–Schmidt operators. We give a
third deﬁnition, which is more in the same spirit as our deﬁnition of Hilbert–
Schmidt operators. All these deﬁnitions are equivalent.
Deﬁnition 276. An operator 
A ∈L(H) is said to be of trace class if there exist
two orthonormal bases (ei)i and (fj)j of H such that

i,j
|( 
Aei|fj)H| < ∞.
(12.14)
The set of all trace class operators on H is denoted by L2(H).

194
Chapter 12.
Hilbert–Schmidt and Trace Class Operators
Obviously 
A is of trace class if and only if its adjoint 
A∗is of trace class: we
have

i,j
|( 
A∗ei|fj)H| =

i,j
|(ei| 
Afj)H| =

i,j
|( 
Afj|ei)H|
and 
i,j |( 
A∗ei|fj)H| < ∞if and only if 
i,j |( 
Afj|ei)H| < ∞.
Deﬁnition (12.15) coincides with Deﬁnition (12.7) when 
A ≥0 since in this
case 
A = | 
A|.
We are going to prove that if the condition (12.14) characterizing trace class
operators holds for one pair of orthonormal basis, then it holds for all. This prop-
erty will allow us to prove that L2(H) is indeed a vector space, and to deﬁne the
trace of an element of L2(H) by the formula
Tr 
A =

i
( 
Aei|ei)H.
(12.15)
Proposition 277. Suppose that 
A ∈L2(H). The following properties hold:
(i) We have

i,j
|( 
Aei|fj)H| < ∞
(12.16)
for all orthonormal bases (ei)i, (fj)j of H with the same index set;
(ii) If (ei)i and (fi)i are two orthonormal bases then

i
( 
Aei|ei)H =

i
( 
Afi|fi)H
(12.17)
and both series are absolutely convergent.
(iii) The set L2(H) of all trace class operators is a vector space.
Proof of (i). Writing Fourier expansions
e′
i =

j
(e′
i|ej)Hej , f ′
ℓ=

k
(f ′
ℓ|fk)Hfk
we have
( 
Ae′
i|f ′
ℓ)H =

j,k
(e′
i|ej)H(f ′
ℓ|fk)H( 
Aej|fk)H
(12.18)
and hence, by the triangle inequality,

i,ℓ
|( 
Ae′
i|f ′
ℓ)H| ≤

j,k


i,ℓ
|(e′
i|ej)H| |(f ′
ℓ|fk)H|

|( 
Aej|fk)H|).
(12.19)

12.2.
Trace class operators
195
In view of the trivial inequality ab ≤1
2(a2 + b2) we have

i,ℓ
|(e′
i|ej)H| |(f ′
ℓ|fk)H| ≤1
2

i
|(e′
i|ej)H|2 + 1
2

ℓ
|(f ′
ℓ|fk)H|2,
i.e., since 
i |(e′
i|ej)H|2 = ∥ej∥2
H = 1 and 
ℓ|(f ′
ℓ|fk)H|2 = ∥fk∥2
H = 1,

i,ℓ
|( 
Ae′
i|f ′
ℓ)H| ≤

j,k
|( 
Aej|fk)H|) < ∞
which proves (12.16).
Proof of (ii). Assume now that ei = fi and e′
i = f ′
i for all indices i. In view of
(12.18) we have
( 
Ae′
i|e′
i)H =

j,k
(e′
i|ej)H(e′
i|ek)H( 
Aej|ek)H
and hence

i
( 
Ae′
i|e′
i)H =

j,k
$
i
(e′
i|ej)H(e′
i|ek)H
%
( 
Aej|ek)H).
In view of (12.1)

i
(e′
i|ej)H(e′
i|ek)H = (ej|ek)H = δjk
which establishes (12.17); that the series is absolutely convergent follows from
(12.16) with the choice ei = fi for all indices i.
Proof of (iii). It is clear that λ 
A ∈L2(H) if λ ∈C and 
A ∈L2(H). Let 
A, 
B ∈
L2(H); then

i
(( 
A + 
B)ei|ei)H =

i
( 
Aei|ei)H +

i
( 
Bei|ei)H
and each sum on the right-hand side is absolutely convergent, implying that 
A +

B ∈L2(H).
□
Exercise 278. Show that
Tr( 
A∗) = Tr( 
A)
(12.20)
(hence Tr( 
A) is real when 
A is self-adjoint).
Trace-class operators do not only form a vector space, they also form a
normed algebra:

196
Chapter 12.
Hilbert–Schmidt and Trace Class Operators
Proposition 279. Let 
A ∈L1(H) and 
B ∈L(H).
(i) We have 
A 
B ∈L1(H) and 
B 
A ∈L1(H), hence L1(H) is a two-sided ideal
in L(H); we have Tr( 
A 
B) = Tr( 
B 
A).
(ii) The formula ∥
A∥Tr = (Tr( 
A∗
A))1/2 deﬁnes a norm on the algebra L2(H) of
Hilbert–Schmidt operators on H; that norm is associated to the scalar product
( 
A| 
B)Tr = Tr( 
A∗
B).
Proof of (i). Let (ei)i and (fi)i be orthonormal bases of H. Writing ( 
A 
Bei|fi)H =
( 
Bei| 
A∗fi)H formula (12.1) with u = 
Bei and v = 
A∗fi yields
( 
A 
Bei|fi)H =

j
( 
Bei|ej)H( 
A∗fi|ej)H
(12.21)
and hence, observing that |( 
Bei|ej)H| ≤∥
Bei∥H ≤∥
B∥,
|( 
A 
Bei|fi)H| ≤

j
|( 
Bei|ej)H| · |( 
A∗fi|ej)H| ≤∥
B∥

j
|( 
A∗fi|ej)H|.
It follows that

i
|( 
A 
Bei|ei)H| ≤∥
B∥

i,j
|( 
A∗fi|ej)H| < ∞
since 
A∗is of trace class;it follows that 
A 
B ∈L1(H). The property 
B 
A ∈L1(H)
follows by writing 
B 
A = ( 
A∗
B∗)∗. Formula (12.21) implies that

i
( 
A 
Bei|ei)H =

i
( 
B 
Aei|ei)H,
(12.22)
that is Tr( 
A 
B) = Tr( 
B 
A).
Proof of (ii). Since 
A∗
A is self-adjoint its trace is real so (Tr( 
A∗
A))1/2 is well
deﬁned. If ∥
A∥Tr = 0 then ( 
Aei|ej)H = 0 for all i hence 
A = 0. The relation
∥λ 
A∥Tr = |λ| ∥
A∥Tr being obvious there only remains to show that the triangle
inequality holds. If 
A, 
B ∈LTr(H) then
∥
A + 
B∥2
Tr = Tr(( 
A∗+ 
B∗)( 
A + 
B))
= Tr( 
A∗
A) + Tr( 
B∗
B) + Tr( 
A∗
B) + Tr( 
B∗
A).
In view of the formula (12.20) we have
Tr( 
A∗
B) + Tr( 
B∗
A) = 2 Re Tr( 
A∗
B)
and hence
∥
A + 
B∥2
Tr = ∥
A∥2
Tr + ∥
B∥2
Tr + 2 Re Tr( 
A∗
B).
(12.23)

12.2.
Trace class operators
197
We have
Tr( 
A∗
B) =

i
( 
Bei| 
Aei)H
hence, noting that Re Tr( 
A∗
B) ≤| Tr( 
A∗
B)| and using the Cauchy-Schwarz in-
equality,
Re Tr( 
A∗
B) ≤

i
( 
Bei| 
Bei)1/2
H ( 
Aei| 
Aei)1/2
H ,
that is
Re Tr( 
A∗
B) ≤

i
( 
B∗
Bei|ei)1/2
H ( 
A∗
Aei|ei)1/2
H
≤∥
B∥Tr∥
A∥Tr
which proves the triangle inequality in view of (12.23).
□
An essential feature of trace class operators is that they are compact (an
operator 
A on H is compact if the image of the unit ball in H by 
A is relatively
compact). The sum and the product of two compact operators is again a compact
operator; in fact compact operators form a two-sided ideal in L(H).
Proposition 280. A trace class operator 
A on a Hilbert space H is a compact
operator.
Proof. Let (uj) be a sequence in H such that ∥uj∥H ≤1 for every j. Let us show
that ( 
Auj) contains a convergent subsequence; this will prove our claim. Let (ei)
be an orthonormal basis of H; writing uj = 
i(uj|ei)Hei we have
∥
Auj∥2
H = ( 
A∗
Auj|uj)H
=

i,k
(uj|ei)H(uj|ek)H( 
A∗
Aek|ei)H.
Using Cauchy–Schwarz’s inequality we have
|(uj|ei)H| ≤∥uj∥H∥ei∥H ≤1
and hence
∥
Auj∥2
H ≤

i,k
( 
A∗
Aek|ei)H < ∞;
since the operator 
A∗
A is of trace class the sequence ( 
Auj) is contained in the ball

B(R) with R = 
i,k( 
A∗
Aek|ei)H and thus contains a convergent subsequence as
claimed.
□
We mentioned at the beginning of this subsection that there are several
diﬀerent deﬁnitions of the trace class operators in the literature. In fact:

198
Chapter 12.
Hilbert–Schmidt and Trace Class Operators
Proposition 281. Let 
A ∈L(H). The following statements are equivalent:
(i) 
A is of trace class;
(ii) The modulus | 
A| =


A∗
A is of trace class;
(iii) 
A is the product of two Hilbert–Schmidt operators.
We do not give the proof of this result here; a proof of the equivalence
(i)⇐⇒(ii) is given in H¨ormander [102], §19.1. That every trace class operator is the
product of two Hilbert–Schmidt operators is easy to see using the polar decom-
position of 
A: writing 
A = 
U( 
A∗
A)1/2 we have 
A = 
B∗
C with 
B∗= 
U( 
A∗
A)1/4
and 
C = ( 
A∗
A)1/4 and one easily checks that 
B∗and 
C are Hilbert–Schmidt
operators.
Note the following easy consequence of the result above:
Corollary 282. Every trace class operator on L2(Rn) is the product of two operators
with L2 kernels.
Proof. It suﬃces to use (iii) in the proposition above together with Theorem 269.
□
12.3
The trace of a Weyl operator
In this section we give several formulas in the case where the involved operators
are Weyl operators.
12.3.1
Heuristic discussion
Let 
A be a trace class operator on L2(Rn) with kernel K. It is customary (especially
in the physical literature) to calculate the trace of 
A using the formula
Tr( 
A) =
	
Rn K(x, x)dx
(12.24)
which is obviously an extension to the inﬁnite-dimensional case of the usual deﬁ-
nition of the trace of a matrix as the sum of its diagonal elements. Needless to say,
this formula does not follow directly from the deﬁnition of a trace class operator!
In fact, even when the integral in (12.24) is absolutely convergent, this formula
has no reason to be true in general. The right condition in the case n = 1 is the
following (Simon [149]): assume that the kernel K is of positive type: this means
that

1≤j,k≤N
λjλkK(xj, xk) ≥0
for all integers N, all xj ∈R and all λj ∈C (in particular K ≥0). Then formula
(12.24) holds.

12.3.
The trace of a Weyl operator
199
On the positive side, Simon [149] notes that if a trace class operator 
A has
kernel K satisfying
)
Rn |K(x, x)|dx < ∞then we are “almost sure” that formula
(12.24) holds. Of course this vague statement is not, as Dubin et al. [39] note, a
charter allowing carefree calculations!
When 
A is a Weyl operator 
A
Weyl
←→a, one then infers from (12.24) that the
trace is expressed in terms of the Weyl symbol by the formula
Tr( 
A) =

1
2πℏ
n 	
R2n a(z)dz
(12.25)
(which has no reason to be correct in general!). Heuristically one can argue as
follows to justify (12.25). In view of formula (10.14) in Proposition 205 the kernel
K 
A of 
A is given by
K 
A(x, y) =

1
2πℏ
n 	
R2 e
i
ℏp·(x−y)a( 1
2(x + y), p)dp
so that K 
A(x, x) is given by (12.24) and formula (12.25) hence follows.
Another often used formula is the following: assuming that 
B
Weyl
←→b also is
of trace class, then
Tr( 
A 
B) =

1
2πℏ
n 	
R2n a(z)b(z)dz.
(12.26)
To justify formula (12.26) one argues as follows: we have
Tr( 
A 
B) =

1
2πℏ
n 	
R2n c(z)dz
where c(z) is the Weyl symbol of 
C = 
A 
B; in view of formula (10.21) in Theorem
213 we have
c(z) =

1
4πℏ
2n 		
R4n e
i
2ℏσ(z′,z′′)a(z + 1
2z′)b(z −1
2z′′)dz′dz′′.
Performing the change of variables u = z + 1
2z′, v = z −1
2z′′ we have dz′dz′′ =
42ndudv and hence
c(z) =
 1
πℏ
2n 		
R4n e
i
2ℏσ(u−z,v−z)a(u)b(v)dudv
=
 1
πℏ
2n 		
R4n e
2i
ℏσ(z,u−v) 
e
2i
ℏσ(u,v)a(u)b(v)

dudv.
Integrating c(z) yields
	
R2n c(z)dz =
 1
πℏ
2n 		
R4n
	
R2n e
2i
ℏσ(z,u−v)dz

e
2i
ℏσ(u,v)a(u)b(v)dudv.

200
Chapter 12.
Hilbert–Schmidt and Trace Class Operators
Now, by the Fourier inversion formula,
	
R2n e
2i
ℏσ(z,u−v)dz =
	
R2n e
2i
ℏJz·(u−v)dz = (2πℏ)2nδ(2u −2v)
and hence
	
R2n c(z)dz = 22n
		
R4n δ(2u −2v)e
2i
ℏσ(u,v)a(u)b(v)dudv
= 22n
		
R4n δ(2u −2v)a(u)b(v)dudv
=
	
R4n a(u)b(u)du;
formula (12.26) follows in view of formula (12.25).
Needless to say, the “derivations” above are formal and one should be ex-
tremely cautious when using the “formulas” thus obtained. Shubin [147], §27, dis-
cusses a step-by-step procedure for checking such identities, but it is not always
easy to use.
Exercise 283. Find the shortcomings in the arguments above, and try to correct
as many as possible by imposing conditions on the symbols (and kernels). A good
idea is to ﬁnd out what happens when one assumes that a ∈S(Rn ⊕Rn).
12.3.2
Some rigorous results
Here are some rigorous results. Also see the paper by Brislawn [22] for a thorough
discussion of the kernels of trace class operators and of the traceability of Hilbert–
Schmidt operators.
We begin by giving a rigorous justiﬁcation of formula (12.26) when the op-
erators 
A and 
B are Hilbert–Schmidt:
Proposition 284. Let 
A
Weyl
←→a and 
B
Weyl
←→b be Hilbert–Schmidt operators. We
then have
Tr( 
A 
B) =

1
2πℏ
n 	
R2n a(z)b(z)dz.
(12.27)
Proof. We ﬁrst observe that in view of Theorem 269 the kernels K 
A and K 
B are
square integrable; it then follows from Proposition 209 that we have a ∈L2(Rn)
and b ∈L2(Rn). Let (ψj)j be an orthonormal basis of L2(Rn); we have
Tr( 
A 
B) =
∞

j=1
( 
A 
Bψj|ψj)L2 =
∞

j=1
( 
Bψj| 
A∗ψj)L2.

12.3.
The trace of a Weyl operator
201
Expanding 
Bψj and 
A∗ψj in the basis (ψj)j we have 
Bψj = ∞
k=1( 
Bψj|ψk)L2ψk
and 
A∗ψj = ∞
ℓ=1(ψj| 
Aψℓ)L2ψℓ, hence
( 
Bψj| 
A∗ψj)L2 =
∞

k=1
( 
Bψj|ψk)L2( 
Aψj|ψk)L2.
In view of formula (10.8) in Proposition 200 we have
( 
Aψj|ψk)L2 =
	
R2n a(z)W(ψj, ψk)(z)dz = (a|W(ψk, ψj))L2(R2n),
( 
Bψj|ψk)L2 =
	
R2n b(z)W(ψj, ψk)(z)dz = (b|W(ψk, ψj))L2(R2n),
hence the equality above can be written:
( 
Bψj| 
A∗ψj)L2 =
∞

k=1
(a|W(ψk, ψj))L2(R2n)(b|W(ψk, ψj))L2(R2n).
Recall now (Proposition 188) that if (ψj)j is an orthonormal basis of L2(Rn) then
the vectors Φj,k = (2πℏ)n/2W(ψk, ψj) form an orthonormal basis of L2(Rn ⊕Rn);
thus
Tr( 
A 
B) =
∞

j=1
( 
Bψj| 
A∗ψj)L2(Rn)
=

1
2πℏ
n

1≤j,k<∞
(a|Φj,k)L2(R2n)(b|Φj,k)L2(R2n)
=

1
2πℏ
n (a|b)L2(R2n)
in view of the classical identity (12.1); this proves formula (12.27).
□
Exercise 285. Give an alternative proof of Proposition 284 by justifying the heuris-
tic derivation of formula (12.26) given above when 
A and 
B are Hilbert–Schmidt
operators. [Hint: show that the symbols a and b are square integrable in view of
Theorem 269.]
A very useful criterion is the following (cf. Du and Wong [38], Theorem 2.4.):
Proposition 286. Let 
A
Weyl
←→a be a trace class operator. If a ∈L1(Rn) then
Tr( 
A) =

1
2πℏ
n 	
R2n a(z)dz.
(12.28)
Equivalently
Tr( 
A) = aσ(0)
(12.29)
where aσ = Fσa is the symplectic Fourier transform of the symbol a.

202
Chapter 12.
Hilbert–Schmidt and Trace Class Operators
Proof. We ﬁrst observe that the equality Tr( 
A) = aσ(0) is obvious since the inte-
gral of a is exactly (2πℏ)n times the symplectic Fourier transform evaluated at 0.
Writing 
A = 
B 
C where 
B and 
C are Hilbert–Schmidt operators we have, using
formula (12.27) in Proposition 284,
Tr( 
A) =

1
2πℏ
n 	
R2n b(z)c(z)dz.
Let us show that
aσ(0) =

1
2πℏ
n 	
R2n b(z)c(z)dz;
formula (12.29) will follow in view of the equality (12.29). We have, in view of
formula (10.22) in Theorem 213,
aσ(z) =

1
2πℏ
n 	
R2n e
i
2ℏσ(z,z′)bσ(z −z′)cσ(z′)dz′
and hence
aσ(0) =

1
2πℏ
n 	
R2n(bσ)∨(z)cσ(z)dz
=

1
2πℏ
n ((bσ)∨|cσ)L2(R2n)
with (bσ)∨(z) = bσ(−z). Noting that (bσ)∨= (b∨)σ and cσ = (c∨)σ we thus have,
since the symplectic Fourier transform is unitary,
aσ(0) =

1
2πℏ
n ((b∨)σ|(c∨)σ)L2(R2n)
=

1
2πℏ
n (b∨|c∨)L2(R2n)
=

1
2πℏ
n 	
R2n b(z)c(z)dz,
which was to be proven.
□
Notice that in the proof above the assumption that 
A is a trace class operator
is essential; in [38] it is moreover remarked that if a ∈L1(Rn) but a /∈L2(Rn)
then 
A is not a trace class operator.
If one imposes more stringent conditions on the Weyl symbol, one can in
addition obtain suﬃcient conditions for the operator to be of trace class:
Proposition 287. Let 
A
Weyl
←→a be a Weyl operator and assume that the symbol a
satisﬁes the following conditions: there exist m ∈R and ρ ∈R, 0 < ρ ≤1, such
that for every multi-index α ∈N2n we can ﬁnd a constant Cα such that
|∂α
z a(z)| ≤Cα(1 + |z|)m−ρ|α|.
(12.30)
If m < −2n then 
A is of trace class and we have
Tr 
A =

1
2πℏ
n 	
R2n a(z)dz.
(12.31)

12.3.
The trace of a Weyl operator
203
Proof. For the proof that the conditions on a imply that 
A is of trace class see
Shubin [147], §27. The condition m < −2n implies that a ∈L1(Rn) hence it
suﬃces to apply Proposition 286.
□
We remark that the symbols a ∈C∞(Rn ⊕Rn) satisfying the conditions
(12.30) form a vector space denoted by Γm
ρ (Rn ⊕Rn); it is one of the Shubin
classes of symbols we will study in Chapter 14; these classes play an important
role in the study of global properties of pseudo-diﬀerential operators.
We ﬁnally note the following invariance property of the trace of a Weyl
operator under conjugation with metaplectic operators:
Corollary 288. Assume that 
A
Weyl
←→a of trace class on L2(Rn) and 
S ∈Mp(2n, R);
then 
S 
A
S−1 Weyl
←→a ◦S−1 (S = πMp(
S)) is also of trace class and has same trace
as 
A.
Proof. It immediately follows from Proposition 273 since metaplectic operators
are unitary; that we have 
S 
A
S−1 Weyl
←→a ◦S−1 was proven in Theorem 215.
□

Chapter 13
Density Operator and
Quantum States
At ﬁrst sight the notion of density operator (or density matrix, as it is called in
physics) should not lead to any particular diﬃculty: mathematically, a density
operator is just a positive trace class operator with trace equal to one. It turns
out that, perhaps somewhat unexpectedly, it is the positivity property which is
the most delicate to establish. It turns out that the positivity of a self-adjoint
trace class operator is very sensitive to the choice of the value of “Planck’s con-
stant” ℏ: thus a self-adjoint operator with trace 1 might very well be a positive
operator for some values of ℏand non-positive for other values. We study in this
chapter a fundamental tool deﬁned and developed by Narcowich [126, 127, 128]
and Narcowich and O’Connell [129] based on earlier work of Kastler [105] and
Loupias and Miracle-Sole [118, 119], namely the Narcowich–Wigner spectrum of a
self-adjoint trace class operator. Roughly speaking, this set consists of the values
of the parameter ℏfor which the operator in question is positive, and hence a
“density operator” representing a mixed quantum state.
We mention that much of this chapter can be recast in the language of the
theory of C∗-algebras; due to lack of space we do not address this fruitful point of
view here and refer to the aforementioned papers of Kastler, Loupias, Miracle-Sole
and to the references therein. For a brief discussion (at an elementary level) of the
usefulness of the language of C∗-algebras in the study of quantum mechanical
states we refer to §11.11 in Hannabuss’ book [91].
13.1
The density operator
Density operators (also called “density matrices” in physics) are central objects
in quantum mechanics, because they are identiﬁed with the “mixed states” of a
quantum system. They contain, as a particular case, the “pure states” which are
usually described by the wave function.
205
M.A. de Gosson, Symplectic Methods in Harmonic Analysis and in Mathematical Physics,  
Pseudo-Differential Operators 7, DOI 10.1007/978-3-7643-9992-4_
, © Springer Basel AG 2011 
13

206
Chapter 13.
Density Operator and Quantum States
13.1.1
Pure and mixed quantum states
Let us begin by deﬁning rigorously the notion of density operator in terms of trace
class operators.
Deﬁnition 289. A density operator (or density matrix) on a separable Hilbert space
H is a bounded operator 
ρ : H −→H having the following properties:
(i) 
ρ is self-adjoint and semi-deﬁnite positive: 
ρ = 
ρ∗, 
ρ ≥0;
(ii) 
ρ is of trace class and Tr(
ρ) = 1.
In quantum mechanics the Hilbert space H is usually realized as a space of
square-integrable functions.
Here is a ﬁrst example of a density operator. Let us assume that we are in
presence of a well-deﬁned quantum state, represented by an element ψ ̸= 0 of
H. Such a state is called a pure state in quantum mechanics. It is no restriction
to assume that ψ is normalized, that is ∥ψ∥H = 1, so that the mathematical
expectation of 
A in the state ψ is
⟨
A⟩ψ = ( 
Aψ|ψ)H.
(13.1)
Consider now the projection operator

ρψ : H −→{αψ : α ∈C}
(13.2)
of H on the “ray” generated by ψ. For each φ ∈H we have

ρψφ = αψ , α = (φ|ψ)H.
(13.3)
We will call 
ρψ the pure density operator associated with ψ; it is a trace class
operator with trace equal to 1.
Exercise 290. Check this last statement in detail.
Observe that when H = L2(Rn) formula (13.3) can be written

ρψφ(x) =
	
Rn ψ(x)ψ(y)φ(y)dy,
hence the kernel of 
ρψ is just the tensor product
K
ρψ = ψ ⊗ψ.
(13.4)
We are going to see that the pure density operator 
ρψ is in this case a Weyl
operator whose symbol is (up to a factor) just the Wigner transform of ψ (cf.
Corollary 207). Let us restate this property in our new language and notation:

13.1.
The density operator
207
Proposition 291. Let 
ρψ be the density operator associated to a pure state ψ by
(13.3).
(i) The Weyl symbol ρψ of 
ρψ and the Wigner transform Wψ of ψ are related
by the formula
ρψ(z) = (2πℏ)nWψ(z).
(13.5)
(ii) Let 
A
Weyl
←→a. If ∥ψ∥L2(Rn) = 1 then the expectation value ⟨
A⟩ψ =( 
Aψ|ψ)L2(Rn)
of 
A in the state ψ is given by:
⟨
A⟩ψ =

1
2πℏ
n Tr(
ρψ 
A).
(13.6)
Proof of (i). In view of formula (10.15) in Proposition 205 the Weyl symbol aψ of

ρψ is given by
ρψ(x, p) =
	
Rn e−i
ℏp·yK
ρψ(x + 1
2y, x −1
2y)dy
=
	
Rn e−i
ℏp·yψ(x + 1
2y)ψ(x + 1
2y)dny
that is ρψ(z) = (2πℏ)nWψ(z) as claimed.
Proof of (ii). In view of formula (10.8) in Proposition 200 we have
⟨
A⟩ψ =
	
R2n a(z)Wψ(z)dz
and formula (13.6) follows from (i) using the expression (12.27) in Proposition 284
giving the trace of the composition of two Weyl operators.
□
We have so far been assuming that the quantum system under consideration
was in a well-known state characterized by a function ψ. Suppose for instance
that we have the choice between a ﬁnite or inﬁnite number of states, described by
functions ψ1, ψ2, . . . , each ψj having a probability αj to be the “true” description.
We can then form a weighted “mixture” of the ψj by forming the convex sum
ψ =
∞

j=1
αjψj ,
∞

j=1
αj = 1 , αj ≥0.
(13.7)
We will say that ψ is a mixed state.
Deﬁnition 292. The density operator of the mixed state (13.7) is the self-adjoint
operator

ρ =
∞

j=1
αj 
ρψj
(13.8)
where the real numbers αj satisfy the conditions (13.7) above.
It is clear that 
ρ is a density operator in the sense of Deﬁnition 289: since
trace class operators form a vector space, 
ρ is indeed of trace class and its trace is 1

208
Chapter 13.
Density Operator and Quantum States
since Tr(
ρj) = 1 and the αj sum to 1. That 
ρ = 
ρ∗is obvious, and the positivity
of 
ρ follows from the fact that αj ≥0 for each j. We will see below (Corollary 294)
that any density operator on L2(Rn) can actually be written in the form (13.8).
The following result describes all density matrices in a Hilbert space H:
Proposition 293. An operator 
ρ on a Hilbert space H is a density operator if and
only if there exists a (ﬁnite or inﬁnite) sequence (αj) of positive numbers and
ﬁnite-dimensional pairwise orthogonal subspaces Hj of H such that

ρ =

j
αj 
ρj
and

j
αj dim Hj = 1
(13.9)
where 
ρj is the orthogonal projection H −→Hj.
Proof. The statement is just Proposition 275, since the orthogonal projections 
ρj
are rank-one self-adjoint operators. Since the spaces Hj are pairwise orthogonal
we have 
ρj 
ρk = 0 if j ̸= k and hence 
ρ2 = 
j α2
j 
ρj.
□
Specializing to the case where H = L2(Rn) we get:
Corollary 294. An operator 
ρ : L2(Rn) −→L2(Rn) is a density operator if and
only if there exists a family (ψj)j∈J in L2(Rn), a sequence (λj)j∈J of numbers
λj ≥0 with 
j∈J λj = 1 such that the Weyl symbol ρ of 
ρ is given by
ρ =

j∈J
λjWψj.
(13.10)
Proof. Assume that the Weyl symbol of 
ρ is given by (13.10); in view of Proposition
293 and the discussion preceding it we have

ρ =

j∈J
αj 
ρj
where 
ρj is the orthogonal projection on the ray {αψj : α ∈C}. It follows that 
ρ is
a density operator. If conversely 
ρ is a density operator on L2(Rn), then there exist
pairwise orthogonal ﬁnite-dimensional subspaces H1, H2,. . . of L2(Rn) such that

ρ =

j
αj 
ρHj with

j
mjαj = 1
with 
ρj the orthogonal projection on Hj and mj = dim Hj. Choose now an or-
thonormal basis ψ1, . . . , ψm1 of H1, an orthonormal basis ψm1+1, . . . , ψm1+m2+1
of H2, and so on. The Weyl symbol of 
ρ is
ρ = α1
m1

j=1
Wψj + α2
m1+m2+1

j=m1
Wψj + · · ·
which is (13.10), setting λj = mjαj.
□

13.1.
The density operator
209
Let us deﬁne the notion of purity of a quantum state, which is a measure of
how much a quantum state diﬀers from a pure state:
Deﬁnition 295. Let 
ρ be a density operator on H; the number µ(
ρ) = Tr(
ρ2) is
called the “purity of the quantum state” that 
ρ represents.
The following result justiﬁes the deﬁnition above:
Proposition 296. Let 
ρ be a density operator on a Hilbert space H. We have
0 ≤Tr(
ρ2) ≤Tr(
ρ) ≤1
(13.11)
and Tr(
ρ2) = 1 if and only if 
ρ is a pure-state density operator.
Proof. The condition 
j αj dim Hj = 1 implies that we must have αj ≤1 for
each j so that
Tr 
ρ2 =

j
α2
j dim Hj ≤

j
αj dim Hj = 1.
If 
ρ is a pure-state density operator then it is a projection of rank 1, hence 
ρ2 = 
ρ
and Tr(
ρ2) = 1. Suppose conversely that Tr(
ρ2) = 1, that is

j
α2
j dim Hj =

j
αj dim Hj = 1.
Since dim Hj > 0 for every j this equality is only possible if the numbers αj
are either 0 or 1; since the case αj = 0 is excluded it follows that the sum

j αj dim Hj = 1 reduces to one single term, say αj0 dim Hj0 = 1 so that 
ρ =
αj0Pj0 and 
ρ2 = α2
j0 
ρj0. The equality Tr(
ρ) = Tr(
ρ2) = 1 can hold if and only if
αj0 = 1 hence dim Hj0 = 1 and 
ρ is a projection of rank 1, and hence a pure-state
density operator.
□
Recalling (formula (13.4)) that the operator kernel of the density operator of
a pure state ψ is just the tensor product ψ ⊗ψ we have more generally:
Corollary 297. Let the density operator 
ρ be given by formula (13.9) and let (ψjk)j,k
be a double-indexed family of orthonormal vectors in L2(Rn) such that the subfam-
ily (ψjk)k is a basis of Hj for each j.
(i) The kernel K
ρ of 
ρ is given by
K
ρ(x, y) =

j,k
λjψjk(x) ⊗ψjk(y);
(13.12)
(ii) The Weyl symbol of 
ρ is given by
a(z) =

j,k
λjWψjk(z)
(13.13)
(Wψjk the Wigner transform of ψjk).

210
Chapter 13.
Density Operator and Quantum States
Proof. (i) We have

ρψ =

j
λj 
ρψ =

j,k
λj(ψ|ψjk)Hψjk
that is, by deﬁnition of the scalar product:

ρψ =

j
λj 
ρψ =

j,k
λj
	
Rn ψjk(x)ψ(y)ψjk(y)dy
which is (13.12).
(ii) Formula (13.13) for the symbol immediately follows from (13.12) in view
of Proposition 293.
□
13.2
The uncertainty principle revisited
Let us see what the strong uncertainty principle in the Robertson–Schr¨odinger
form becomes in the case of mixed states.
13.2.1
The strong uncertainty principle for the density operator
Recall that the Robertson–Schr¨odinger inequalities (6.10) are
(∆Xα)2(∆Pα)2 ≥∆(Xα, Pα)2 + 1
4ℏ2.
(13.14)
Let 
A and 
B be Weyl operators; we assume that the expectation values
⟨
A⟩
ρ = Tr(
ρ 
A) , ⟨
A2⟩
ρ = Tr(
ρ 
A2)
(13.15)
(and similar expressions for 
B) exist and are ﬁnite. Setting
(∆
A)2

ρ = ⟨
A2⟩
ρ −⟨
A⟩2

ρ , (∆
B)2

ρ = ⟨
B2⟩
ρ −⟨
B⟩2

ρ,
∆( 
A, 
B)
ρ = 1
2⟨
A 
B + 
B 
A⟩
ρ −⟨
A⟩
ρ⟨
B⟩
ρ
we have the following result:
Proposition 298. Let 
A
Weyl
←→a and 
B
Weyl
←→b be two essentially self-adjoint Weyl
operators on L2(Rn) for which the expectation values (13.15) are deﬁned. We have
|⟨
A 
B⟩
ρ|2 = ∆( 
A, 
B)2

ρ −1
4⟨[ 
A, 
B]⟩2

ρ
(13.16)
where [ 
A, 
B] = 
A 
B −
B 
A and hence
(∆
A)2

ρ(∆
B)2

ρ ≥∆( 
A, 
B)2

ρ −1
4⟨[ 
A, 
B]⟩2

ρ .
(13.17)

13.2.
The uncertainty principle revisited
211
Proof. Replacing 
A and 
B by 
A−⟨
A⟩
ρ and 
B −⟨
B⟩
ρ we may assume that ⟨
A⟩
ρ =
⟨
B⟩
ρ = 0 so that (13.16) and (13.17) reduce to, respectively,
|⟨
A 
B⟩
ρ|2 = 1
2⟨
A 
B + 
B 
A⟩2

ρ −1
4⟨[ 
A, 
B]⟩2

ρ
(13.18)
and
⟨
A2⟩
ρ⟨
B2⟩
ρ ≥1
2⟨
A 
B + 
B 
A⟩2

ρ −1
4⟨[ 
A, 
B]⟩2

ρ.
(13.19)
Writing 
A 
B = 1
2( 
A 
B + 
B 
A) + 1
2( 
A 
B −
B 
A) we have,
⟨
A 
B⟩
ρ = 1
2⟨
A 
B + 
B 
A⟩
ρ + 1
2⟨
A 
B −
B 
A⟩
ρ.
Now, ∆( 
A, 
B)
ρ is a real number, and ⟨[ 
A, 
B]⟩
ρ is pure imaginary (because
[ 
A, 
B]∗= −[ 
A, 
B] since 
A and 
B are essentially self-adjoint), hence formula
(13.18). We next observe that
⟨
A 
B⟩
ρ =

j∈J
αj( 
A 
Bψj|ψj)L2 =

j∈J
αj( 
Bψj| 
Aψj)L2;
(13.20)
applying the Cauchy–Schwarz inequality to each scalar product ( 
Bψj| 
Aψj)L2
we get
|⟨
A 
B⟩
ρ|2 ≤

j∈J
αj∥
Bψj∥L2 ∥
Aψj∥L2.
(13.21)
Since ⟨
A⟩2

ρ = ⟨
B⟩2

ρ = 0 we have
∥
Aψj∥= ⟨
A2⟩1/2
ψj = (∆
A)2
ψj , ∥
Bψj∥= ⟨
B2⟩1/2
ψj = (∆
B)2
ψj
and the inequality (13.21) is thus equivalent to
|⟨
A 
B⟩
ρ| ≤

j∈J
αj⟨
A2⟩1/2
ψj ⟨
B2⟩1/2
ψj .
Writing αj = (√αj)2 the Cauchy–Schwarz inequality for sums yields
|⟨
A 
B⟩
ρ| ≤


j∈J
αj⟨
A2⟩1/2
ψj




j∈J
α⟨
B2⟩1/2
ψj

= ⟨
A2⟩
ρ⟨
B2⟩
ρ
hence the inequality (13.19) using formula (13.18).
□
Choosing for 
A the operator of multiplication by xj and 
B = −iℏ∂/∂xj one
obtains the usual Robertson–Schr¨odinger inequalities
(∆Xj)2

ρ(∆Pj)2

ρ ≥∆(Xj, Pj)2

ρ + 1
4ℏ2
(13.22)
for 1 ≤j ≤n.

212
Chapter 13.
Density Operator and Quantum States
Corollary 299. Assume that [ 
A, 
B] = iℏ; then
(∆
A)2

ρ(∆
B)2

ρ ≥∆( 
A, 
B)2

ρ + 1
4ℏ2.
(13.23)
If 
ρ represents a pure state ψ ∈D 
A 
B ∩D 
B 
A then we have equality if and only if
the vectors ( 
A −⟨
A⟩)ψ and ( 
B −⟨
B⟩)ψ are collinear.
Proof. The inequality (13.23) immediately follows from the inequality (13.17).
Assume that we have equality in (13.23). It is suﬃcient to consider the case ⟨
A⟩ψ =
⟨
B⟩ψ = 0. In view of formula ⟨
A 
B⟩ψ = ⟨
A 
Bψ|ψ⟩= ⟨
Bψ| 
Aψ⟩this means that the
Cauchy–Schwarz inequality reduces to an equality, which implies that 
Aψ and 
Bψ
are colinear.
□
Assume in particular that 
Aψ = x1ψ and 
Bψ = −iℏ∂ψ/∂x1. The inequality
(13.22) with j = 1 becomes an equality if there exists a complex constant λ1 such
that
−iℏ∂ψ
∂x1
= λ1x1ψ;
it follows that we must have
ψ(x) = C(x2, . . . , xn)e−i
2ℏλ1x2
1
for some function C of only the variables x2, . . . , xn. Thus, if we require all the
Robertson–Schr¨odinger equalities (13.22) to become equalities we must have
ψ(x) = C exp

i
2ℏ
n

j=1
λjx2
j


where C and the λj are complex constants; the condition that ψ be square-
integrable requires that Im λj > 0. Choosing in particular λ1 = · · · = λn = i
and C = (πℏ)−n/4 one obtains the standard coherent state
ψℏ
0(x) = (πℏ)−n/4e−1
2ℏ|x|2.
(13.24)
13.2.2
Sub-Gaussian estimates
We begin by discussing the case of a pure state.
We have seen in Chapter 11, Section 11.2, that the Wigner transform of a
Gaussian is itself a Gaussian. More precisely, assume that
ψℏ
M(x) =
 1
πℏ
n/4 (det X)1/4e−1
2ℏMx2
where M = X + iY with X and Y symmetric and X positive deﬁnite. Then
Wψℏ
M(z) =
 1
πℏ
n e−1
ℏGz2
(13.25)

13.2.
The uncertainty principle revisited
213
where G is the real 2n × 2n matrix given by
G =
X + Y X−1Y
Y X−1
X−1Y
X−1

= ST S
(13.26)
where the symplectic matrix S is given by
S =
 X1/2
0
X−1/2Y
X−1/2

∈Sp(2n, R).
(13.27)
The following simple geometric remark already hints at the fact that sym-
plectic capacities might already be lurking behind these formulas:
Lemma 300. If a Gaussian function Ψ(z) = Ce−1
ℏMz2 on R2n is the Wigner
transform of a Gaussian (11.12) then the phase-space ellipsoid W = {z : Mz2 ≤ℏ}
is the image S(B(
√
ℏ)) of the ball B(ℏ) : |z| ≤ℏby some S ∈Sp(2n, R), and hence
the symplectic capacity of W is πℏ= 1
2h.
Proof. (Cf. Proposition 242) We have M = ST S for some S ∈Sp(2n, R) and hence
W = S(B(ℏ)). Let c be an arbitrary symplectic capacity; then, using successively
the symplectic invariance of c and the normalization condition c(B(R)) = πR2,
we get
c(W) = c(S(B(
√
ℏ))) = c((B(
√
ℏ))) = πℏ.
□
The following result shows that a Wigner transform cannot be dominated by
an arbitrarily sharply peaked phase space Gaussian function. This is of course a
phase space version of the uncertainty principle obtained by using Hardy’s uncer-
tainty principle. We are following the exposition in de Gosson and Luef [74].
Proposition 301. Let ψ ∈L2(Rn), ψ ̸= 0, and assume that there exists C > 0 such
that Wψ(z) ≤Ce−1
ℏMz·z. Then c(WΣ) ≥1
2h where WΣ is the Wigner ellipsoid
corresponding to the choice Σ =
ℏ
2M −1 (equivalently c(BM) ≥
1
2h where BM :
Mz2 ≤ℏ).
Proof. In view of Williamson’s symplectic diagonalization theorem we can ﬁnd
S ∈Sp(2n, R) such that
MSz · Sz =
n

j=1
λj(x2
j + p2
j)
where λ1 ≥λ2 ≥· · · ≥λn are the moduli of the eigenvalues ±iλ, λ > 0, of JM.
It follows that the assumption Wψ(z) ≤Ce−1
ℏMz·z can be rewritten as
Wψ(S−1z) ≤C exp

−1
ℏ
n

j=1
λj(x2
j + p2
j)

.
(13.28)

214
Chapter 13.
Density Operator and Quantum States
In view of the metaplectic covariance formula (9.29) we have Wψ(S−1z)=W 
Sψ(z)
where 
S ∈Mp(n, R) has projection S on Sp(2n, R). Since 
Sψ ∈L2(Rn) and c(WΣ)
is a symplectic invariant it is no restriction to assume S = I, 
S = I. Integrating
the inequality
Wψ(z) ≤C exp

−1
ℏ
n

j=1
λj(x2
j + p2
j)


in x and p, respectively we get, using the marginal properties formulae (9.17) and
(9.18),
|ψ(x)| ≤C1 exp

−1
2ℏ
n

j=1
λjx2
j

,
(13.29)
|Fψ(p)| ≤C1 exp

−1
2ℏ
n

j=1
λjp2
j


(13.30)
for some constant C1 > 0. Let us now introduce the following notation. We set
ψ1(x1) = ψ(x1, 0, . . . , 0) and denote by F1 the one-dimensional Fourier transform
in the x1 variable. Now, we ﬁrst note that (13.29) implies that
|ψ1(x1)| ≤C1 exp

−λ1
2ℏx2
1

.
(13.31)
On the other hand, by deﬁnition of the Fourier transform F,
	
Rn−1 Fψ(p)dp2 · · · dpn =

1
2πℏ
n/2 	
Rn−1
	
Rn e−i
ℏp·xψ(x)dx

dp2 · · · dpn;
taking into account the Fourier inversion formula this formula can be rewritten as
	
Rn−1 Fψ(p)dp2 · · · dpn = (2πℏ)(n−1)/2 F1ψ1(p1).
It follows that
|F1ψ1(p1)| ≤

1
2πℏ
(n−1)/2 C1
	
exp

−1
2ℏ
n

j=1
λjp2
j

dp2 · · · dpn
that is
|F1ψ1(p1)| ≤C3 exp

−λ1
2ℏp2
1

(13.32)
for some constant C3 > 0. Applying Hardy’s uncertainty principle we see that
the condition λ2
1 ≤1 is both necessary and suﬃcient for these inequalities to hold
(remember that we are using the ordering convention λ1 ≥λ2 ≥· · · ≥λn); this is
equivalent to c(BM) ≥1
2h.
□

13.2.
The uncertainty principle revisited
215
Exercise 302. Use Theorem 301 to show that a Wigner transform Wψ can never
have compact support. [Hint: show that if Wψ has compact support then it is
dominated by arbitrarily sharply peaked Gaussians.]
The results above allow us to prove the more general result:
13.2.3
Positivity issues and the KLM conditions
Let us now shortly address the following important, deep, and diﬃcult question:
When is a real symmetric 2n × 2n matrix Σ the covariance matrix of a
mixed quantum state 
ρ?
In the classical case the answer is simple: Σ is the covariance matrix of some
probability density if and only if Σ is positive deﬁnite. In the quantum case the
situation is much more subtle and diﬃcult than it could appear at ﬁrst sight,
because it is plagued by positivity questions. Let in fact 
ρ be a self-adjoint operator
of trace class with trace Tr(
ρ) = 1. The operator 
ρ is thus a candidate for being a
density matrix. However, to be eligible, it must in addition be non-negative, that
is we must have (
ρψ|ψ)L2 ≥0 for all ψ ∈L2(Rn), and it is this property which is
diﬃcult to check.
We are going to present a theoretical characterization of the positivity of
a density operator, the KLM conditions. The letters KLM are an acronym for
Kastler [105] and Loupias and Miracle-Sole [118, 119] who all three have con-
tributed signiﬁcantly to a better understanding of the positivity issues for trace
class operators. Also see the related paper of Emch [43] on “geometric dequanti-
zation” where similar issues are discussed.
Let us ﬁrst introduce a notation: for a function a ∈S(Rn ⊕Rn) we set
a♦(z) =
 1
2π
n 	
Rn eiσ(z,z′)a(z′)dz′
(a♦can be pronounced “a diamond”). This deﬁnition of course also makes sense
for a ∈S′(Rn ⊕Rn) if one interprets the integral as a distributional bracket. In
fact, the function a♦(z) is related to the symplectic Fourier transform
aσ(z) = Fσa(z) =

1
2πℏ
n 	
Rn e−i
ℏσ(z,z′)a(z′)dz′
by the simple formula
a♦(z)(z) = ℏnaσ(−ℏz).
(13.33)
Deﬁnition 303. Let a be a complex function deﬁned on the symplectic space (Rn⊕
Rn, σ). Let η ∈R be a variable parameter and set
Λjk(zj, zk) = e−iη
2 σ(zj,zk)a♦(zj −zk)
(13.34)

216
Chapter 13.
Density Operator and Quantum States
where (z1, . . . , zN) ∈(R2n)N. The set WS(a) of values of η for which every matrix
Λ = (Λjk(zj, zk, η))1≤j,k≤N with N and (z1, . . . , zN) arbitrary is positive semi-
deﬁnite is called the Narcowich–Wigner spectrum of a. If η ∈WS(a) one says
that a is of η-positive type.
Explicitly, WS(a) is thus the set of all real numbers η such that for every
integer N ≥1 and every sequence (z1, . . . , zN) we have

1≤j,k≤N
λjλke−iη
2 σ(zj,zk)a♦(zj −zk) ≥0,
λ = (λ1, . . . , λN) ∈CN. It should be emphasized that in the veriﬁcation of the
condition above it is assumed that a does not depend explicitly on the variable η.
Exercise 304. Show that functions of η-positive type form a cone: if a and b are
of η-positive type then so is λa + µb for all λ ≥0 and µ ≥0.
Notice that if we choose η = 0 we recover the usual deﬁnition of a function
of positive type: the function a is of positive type if for each integer N the N × N
matrix with entries a♦(zj −zk) is positive semi-deﬁnite. In view of a classical
theorem of Bochner this is a well-known suﬃcient and necessary condition for
the continuous function a♦to be the Fourier transform of a positive measure (see
Katznelson [107], p. 137 for a proof of Bochner’s theorem). Let us introduce the
following terminology from statistical mechanics: a classical state is the datum of
a probability density on the phase space Rn ⊕Rn. We have:
Proposition 305. Assume that a is continuous on Rn ⊕Rn and of 0-positive type.
Then a is a positive measure and can thus be identiﬁed with a classical state.
Proof. To say that a is 0-positive type means that a♦is of positive type in the
usual sense, hence a = (a♦)♦is a positive measure in view of Bochner’s theorem.
Normalizing this measure yields a probability density, hence a classical state.
□
When η = ℏwe can restate the deﬁnition above in terms of the symplectic
Fourier transform Fσ:
Proposition 306. The function a♦is of ℏ-positive type if and only if for ev-
ery integer N ≥1 and every (z1, . . . , zN) ∈(R2n)N the N × N matrix Λ′ =
(Λ′
jk(zj, zk))1≤j,k≤N where
Λ′
jk(zj, zk) = e
i
2ℏσ(zj,zk)Fσa(zj −zk)
(13.35)
is positive semi-deﬁnite.
Proof. It is immediate in view of formula (13.33) replacing (zj, zk) with η−1(zk, zj)
and noting that σ(zk, zj) = −σ(zj, zk).
□

13.2.
The uncertainty principle revisited
217
The observant reader has certainly noticed that the right-hand side of (13.35)
has some kind of remote resemblance with the formula (8.9)

T(z0 + z1) = e−i
2ℏσ(z0,z1) 
T(z0) 
T(z1)
for Heisenberg–Weyl operators, which we can rewrite as

T(zk −zj) = e−i
2ℏσ(zj,zk) 
T(zk) 
T(−zj).
(13.36)
That the Heisenberg–Weyl operators indeed are part of the picture is shown by
the following fundamental example of a function of ℏ-positive type.
Proposition 307. The Wigner distribution Wψ of ψ ∈L2(Rn) is of ℏ-positive type:
ℏ∈WS(Wψ).
Proof. In view of Proposition 306 we have to show that for all (z1, . . . , zN) ∈
(R2n)N and (λ1, . . . , λN) ∈CN we have
IN =

1≤j,k≤N
λjλke−i
2ℏσ(zj,zk)FσWψ(zj −zk)) ≥0
(13.37)
for every complex vector (λ1, . . . , λN) ∈CN and every sequence (z1, . . . , zN) ∈
(R2n)N. Since the Wigner distribution Wψ and the ambiguity function
Aψ(z) =

1
2πℏ
n ( 
T(−z)ψ|ψ)L2
are obtained from each other by the symplectic Fourier transform Fσ (formula
(9.26) in Proposition 175) we have
IN =

1≤j,k≤N
λjλke−i
2ℏσ(zj,zk)Aψ(zj −zk)).
Let us prove that
IN =

1
2πℏ
n
****

1≤j≤N
λj 
T(−zj)ψ
****
2
L2;
(13.38)
the inequality (13.37) will follow. Taking into account the fact that 
T(−zk)∗=

T(zk) and using formula (13.36) we have
****

1≤j≤N
λj 
T(zj)ψ
****
2
L2
=

1≤j,k≤N
λjλk( 
T(−zj)ψ| 
T(−zk)ψ)L2
=

1≤j,k≤N
λjλk( 
T(zk) 
T(−zj)ψ|ψ)L2
=

1≤j,k≤N
λjλke
i
2ℏσ(zj,zk)( 
T(zk −zj)ψ|ψ)L2
= (2πℏ)n

1≤j,k≤N
λjλke
i
2ℏσ(zj,zk)Aψ(zj −zk)
proving the equality (13.38).
□

218
Chapter 13.
Density Operator and Quantum States
One shows (but we will not do it here) that
Proposition 308. If a : Rn ⊕Rn −→C is of ℏ-positive type then a ∈L2(Rn ⊕Rn).
(See Loupias and Miracle-Sole [118], Theorem 4.)
The interest of the notion of ℏ-positivity comes from the following result:
Theorem 309. Let 
A
Weyl
←→a be a self-adjoint trace class operator on L2(Rn). The
operator 
A is positive semi-deﬁnite (written 
A ≥0) if and only if the symbol a is
of ℏ-positive type.
We will need the following result in our discussion:
Lemma 310. If a : Rn ⊕Rn −→C is continuous and twice continuously diﬀeren-
tiable near 0 and of ℏ-positive type, then we have
−2ℏa′′(0) + iJ ≥0
(13.39)
where a′′(0) = D2a(0) is the Hessian matrix of a at 0.
Proof. (Cf. Lemma 2.1 in Narcowich [128]). For (λ1, . . . , λm) ∈Cm and ε ∈R let
us set
R(ε) =
m

j,k=1
λjλke−iε2
2ℏσ(zj,zk)a(ε(zj −zk)).
If a is of ℏ-positive type we have R(ε) ≥0 for every ε; choose now the λj such
that 
j λj = 0; thenR(0) = 0 and R′′(0) ≥0. An elementary calculation shows
that
R′′(0) = ZT (−2a′′(0) + iℏ−1J)Z
where Z = 
j λjzj ∈C2n. The λj and zj being arbitrary we thus have −2a′′(0)+
iℏ−1J ≥0, proving the lemma.
□
Proposition 311. Let 
ρ be a density operator.
(i) The covariance matrix Σ
ρ satisﬁes the strong uncertainty principle:
Σ
ρ + 1
2iℏJ ≥0;
(13.40)
(ii) The Robertson–Schr¨odinger inequalities hold:
(∆Xj)2

ρ(∆Pj)2

ρ ≥(Cov(Xj, Pj)
ρ)2 + 1
4ℏ2,
(13.41)
(j = 1, . . . , n) and (∆Xj)2
ψ(∆Pk)2
ψ ≥0 if j ̸= k.
Proof of (i). The matrix Σ
ρ + 1
2iℏJ is Hermitian since Σ
ρ is symmetric and the
transpose of J is −J. We next remark that Σ
ρ = Σ
ρ0 where ρ0 is deﬁned by
ρ0(z) = ρ(z + ⟨z⟩ρ) with ⟨z⟩ρ = (⟨x⟩ρ , ⟨p⟩ρ): we have ⟨z⟩ρ0 = 0 and hence
Cov(Xj, Xk)ρ0 =
	
R2n xjxkρ0(z)dz = Cov(Xj, Xk)ρ;

13.2.
The uncertainty principle revisited
219
similarly Cov(Xj, Pk)ρ0 = Cov(Xj, Pk)ρ and Cov(Pj, Pk)ρ0 = Cov(Pj, Pk)ρ. It is
thus suﬃcient to prove the proposition for the density operator 
ρ0. Let us calculate
the Hessian matrix ρ′′
0,σ(0). A direct calculation shows that we have
ℏ2ρ′′
0,σ(0) = (2πℏ)−n

−ΣP P,ρ0
ΣXP,ρ0
ΣP X,ρ0
−ΣXX,ρ0

and hence
ℏ2ρ′′
0,σ(0) =

1
2πℏ
n JΣ
ρJ.
(13.42)
Since we have ρσ = (2πℏ)−naσ the positivity of 
ρ implies, taking Proposition 311
and the lemma preceding it into account that
M = −2ℏ−1JΣρJ + iJ ≥0 ;
the condition M ≥0 being equivalent to JT MJ ≥0 the inequality (13.40) follows.
Proof of (ii). It follows from property (i) in view of Theorem 98 in Chapter 6.
□

Part III
Pseudo-diﬀerential Operators
and Function Spaces

Chapter 14
Shubin’s Global Operator Calculus
In the applications to quantum mechanics that we have in mind in this book a cru-
cial role is played by non-local eﬀects in symplectic space; for this reason the local
theory traditionally developed by many authors working in the theory of partial
diﬀerential equations is of little use. This chapter is a review of pseudo-diﬀerential
calculus from the point of view developed in Shubin [147]. The speciﬁcity of this
calculus is that the symbols satisfy global estimates where the x and p variables are
placed on equal footing. This is in strong contrast with the usual pseudodiﬀerential
calculus often used in the theory of partial diﬀerential equations (especially their
microlocal study), and which is less adequate for the study of quantum mechan-
ics in its phase space formulation. The Shubin calculus contains the usual Weyl
calculus as a particular case; this remark will be important later when we derive
the Schr¨odinger equation. An excellent source which complements this chapter is
Nicola and Rodino [131].
We will again use the multi-index notation α = (α1, . . . , α2n) ∈Nn, |α| =
α1 + · · · + α2n, and ∂α
z = ∂α1
x1 · · · ∂αn
xn ∂αn+1
y1
· · · ∂α2n
yn
if z = (x, y).
14.1
The Shubin classes
We begin by introducing some notation and useful formulas.
14.1.1
Generalities
In Section 1.3.3 we brieﬂy discussed quantization rules of the type
px −→τ
x
p + (1 −τ)
p
x
where τ is an arbitrary real constant, and which generalize the Weyl quantization
scheme
px −→1
2(
x
p + 
p
x).
223
M.A. de Gosson, Symplectic Methods in Harmonic Analysis and in Mathematical Physics,  
Pseudo-Differential Operators 7, DOI 10.1007/978-3-7643-9992-4_
, © Springer Basel AG 2011 
14

224
Chapter 14.
Shubin’s Global Operator Calculus
The consideration of such rules leads us to study pseudo-diﬀerential operators of
the type

Af(x) =

1
2πℏ
n 		
R2n e
i
ℏp·(x−y)aτ((1 −τ)x + τy, p)f(y)dydp
(14.1)
where the integral should be understood in some “reasonable” sense. For instance,
this expression makes perfect sense if f ∈S(Rn) and aτ ∈S(Rn ⊕Rn) because the
integral is then absolutely convergent. For more general symbols aτ one can give
a meaning to the expression (14.1) by declaring that the operator 
A is deﬁned by
the distributional kernel
K 
A(x, y) =

1
2πℏ
n/2 (F −1
2
aτ)((1 −τ)x + τy, p)
where F −1
2
is the inverse Fourier transform in the second set of variables. We
notice that setting τ = 1
2 and a1/2 = a formula (14.1) becomes

Af(x) =
 1
2π
n 		
R2n eiξ·(x−y)a( 1
2(x + y), ξ)f(y)dydξ
(14.2)
which is the expression (10.38) of a Weyl operator in terms of its symbol when we
choose ℏ= 1 (more about that below). To make the notation more compact we
will in fact often assume that ℏ= 1, so that we will actually deal with operators
written in the form

Af(x) =
 1
2π
n 		
R2n eiξ·(x−y)aτ((1 −τ)x + τy, ξ)f(y)dydξ
(14.3)
which is standard in the theory of partial diﬀerential operators. In harmonic anal-
ysis the preferred choice is to take ℏ= 1/2π and to write ω instead of p:

Af(x) =
		
R2n e2πiω·(x−y)aτ((1 −τ)x + τy, ω)f(y)dydω.
(14.4)
Each choice has its advantages and disadvantages. But keeping these conventions
in mind, it is easy to translate the properties of each formulation into the other.
Choosing τ = 0 in formula (14.3) yields

Af(x) =
 1
2π
n 		
R2n eiξ·(x−y)aτ(x, ξ)f(y)dydξ
that is

Af(x) =
 1
2π
n/2 	
Rn eix·ξa(x, ξ)Ff(ξ)dξ
(14.5)
where
Ff(ξ) =
 1
2π
n/2 	
Rn e−iξ·yf(y)dy;

14.1.
The Shubin classes
225
this is the conventional deﬁnition of a pseudo-diﬀerential operator found in most
texts dealing with partial diﬀerential equations; a is then sometimes called the
“Kohn–Nirenberg symbol” of the operator 
A.
We mention for further use the following simple conjugation relation the
between usual Weyl operators and operators (14.2) with ℏ-dependent symbols (cf.
the subsection on the dependence on ℏof πMp in Chapter 7):
Lemma 312. The Weyl operator 
A
Weyl
←→a given by

Af(x) =

1
2πℏ
n 		
R2n e
i
ℏp·(x−y)a( 1
2(x + y), p)f(y)dydp
(14.6)
and the operator (14.2) with symbol a(ℏ)(z) = a(z
√
ℏ), that is

A(ℏ)f(x) =
 1
2π
n 		
R2n eiξ·(x−y)a( 1
2
√
ℏ(x + y),
√
ℏξ)f(y)dydξ
(14.7)
are related by the formula

A = M −1
√
ℏ
A(ℏ)M√
ℏ
where M√
ℏf(x) = ℏn/4f(x
√
ℏ).
Proof. We have
M −1
√
ℏ
AM√
ℏf(x) =
 1
2π
n 		
R2n eiξ·(
1
√
ℏx−y)a( 1
2(x +
√
ℏy),
√
ℏξ)f(
√
ℏy)dydξ;
setting y = y′/
√
ℏand ξ = p/
√
ℏwe get
M −1
√
ℏ
AM√
ℏf(x) =

1
2πℏ
n 		
R2n e
i
ℏp·(x−y)a( 1
2(x + y′), p)f(y′)dy′dp
which establishes the lemma.
□
14.1.2
Deﬁnitions and preliminary results
It is convenient – and natural, from the point of view of quantum mechanics – to
introduce the Shubin symbol classes. We will be following very closely Shubin’s
exposition ([147], particularly §23).
We will use throughout this chapter the weight function
⟨z⟩=

1 + |z|2
for z ∈R2n.

226
Chapter 14.
Shubin’s Global Operator Calculus
Deﬁnition 313. Let m ∈R and 0 < ρ ≤1.
(i) The symbol class Γm
ρ (Rn⊕Rn) consists of all complex functions a ∈C∞(Rn⊕
Rn) such that for every α ∈N2n there exists a constant Cα ≥0 with
|∂α
z a(z)| ≤Cα ⟨z⟩m−ρ|α|
for z ∈R2n.
(14.8)
(ii) The symbol class Σm,µ
ρ,δ (Rn ⊕Rn), µ > 0, δ ≤1/2, consists of all complex
functions a ∈C∞(Rn ⊕Rn) depending continuously on ℏ∈(0, ε) such that
|∂α
z a(z, ℏ)| ≤Cα ⟨z⟩m−ρ|α| ℏµ−δ|α| for z ∈R2n.
(14.9)
We set
Γ−∞
ρ
(Rn ⊕Rn) =
+
m∈R Γm
ρ (Rn ⊕Rn).
We will see later on that the choice of τ is actually irrelevant: if 
A ∈Gm
ρ (Rn) is
given by (14.1) for one choice of τ it is true for all choices of the parameter.
Obviously Γm
ρ (Rn ⊕Rn), Σm,µ
ρ,δ (Rn ⊕Rn), and Γ−∞
ρ
(Rn ⊕Rn) are complex
vector spaces for the usual operations of addition and multiplication by complex
numbers. Moreover one easily checks that
a ∈Γm
ρ (Rn ⊕Rn) and b ∈Γm′
ρ (Rn ⊕Rn) =⇒ab ∈Γm+m′
ρ
(Rn ⊕Rn);
a ∈Γm
ρ (Rn ⊕Rn) and α ∈N2n =⇒∂α
z a ∈Γm−|α|
ρ
(Rn ⊕Rn).
The ﬁrst implication is proved by using the generalized Leibniz rule for the deriva-
tives of a product of functions; the second is obvious in view of the deﬁnition of
Γm
ρ (Rn ⊕Rn). We also have
a ∈Σm,µ
ρ,δ (Rn ⊕Rn) and b ∈Σm′,µ′
ρ′,δ′ (Rn ⊕Rn)
=⇒ab ∈Σm+m′,µ+µ′
ρ′′,δ′′
(Rn ⊕Rn) , ρ′′ = min(ρ, ρ′), δ′′ = max(δ, δ′).
The simplest and most typical example is the reduced harmonic oscillator
Hamiltonian H(z) = 1
2|z|2 which obviously belongs to Γ2
1(Rn ⊕Rn). In fact, we
may as well choose the “complete” Hamiltonian
H(z) =
n

j=1
1
2mj
(p2
j + m2
jω2
j x2
j)
as is shown by the following exercise (the property can also be derived from Propo-
sition 316 below):
Exercise 314. Show that any polynomial function in z of degree m is in
Γm
1 (Rn ⊕Rn).
The following exercise shows that S(Rn ⊕Rn) can be characterized in terms
of the Shubin classes Γm
ρ (Rn ⊕Rn):

14.1.
The Shubin classes
227
Exercise 315. Show that Γ−∞
ρ
(Rn ⊕Rn) = ∩m∈RΓm
ρ (Rn ⊕Rn) is identical with
the Schwartz space S(Rn ⊕Rn) of rapidly decreasing functions on Rn ⊕Rn.
The following result is an invariance property which shows that the class
Γm
ρ (Rn ⊕Rn) is preserved by linear changes of variables:
Proposition 316. Let a ∈Γm
ρ (Rn ⊕Rn) and φ a linear automorphism of Rn ⊕Rn.
Then φ∗a = a ◦φ is also in Γm
ρ (Rn ⊕Rn).
Proof. Let us ﬁrst show that |φ∗a(z)| ≤Cφ ⟨z⟩m for some constant Cφ ≥0. Diag-
onalizing the symmetric automorphism φT ◦φ using an orthogonal transformation
we have
λmin|z|2 ≤|φ(z)|2 ≤λmax|z|2
where λmin > 0 and λmax > 0 are the smallest and largest eigenvalues of φT ◦φ.
It follows that
⟨φ(z)⟩m ≤max(1, λmax) ⟨z⟩m
if m ≥0, and
⟨φ(z)⟩m ≤min(1, λmin) ⟨z⟩m
if m < 0. We thus have |φ∗a(z)| ≤CF ⟨z⟩m. A similar argument shows that for
every multi-index α we have an estimate of the type
|∂α
z (φ∗a)(z)| ≤Cα,φ ⟨z⟩m−ρ|α|
where Cα,φ is a constant.
□
This property of invariance under linear transformations allows us to tog-
gle between symbols (x, ξ) −→a(x, ξ) and (x, ξ) −→a(x, ℏξ) = a(x, p) without
changing the symbol class.
Deﬁnition 317. The set of operators 
A deﬁned by

Af(x) =
 1
2π
n 		
R2n eiξ·(x−y)a( 1
2(x + y), ξ)f(y)dydξ
with a ∈Γm
ρ (Rn ⊕Rn) for some value of τ ∈R is denoted by Gm
ρ (Rn).
The operators 
A ∈Gm
ρ (Rn) have many interesting regularity properties; the
following is important (even if not very surprising):
Proposition 318. Every operator 
A ∈Gm
ρ (Rn) is a continuous operator S(Rn) −→
S(Rn) and can be extended into a continuous operator 
A : S′(Rn) −→S′(Rn).
Proof. That we have a continuous extension 
A : S′(Rn) −→S′(Rn) follows from
the ﬁrst statement by duality provided that we know that the transpose 
AT is also
in Gm
ρ (Rn), this fact is true and will established in Proposition 342. The proof of
the continuity property 
A : S(Rn) −→S(Rn) is classical; it is actually the same

228
Chapter 14.
Shubin’s Global Operator Calculus
that one uses to prove the continuity of operators with symbols in the H¨ormander
classes. Let us sketch the argument: we write 
A in the Kohn–Nirenberg form (14.5):

Af(x) =
 1
2π
n/2 	
Rn eix·ξa(x, ξ)Ff(ξ)dξ
and note that for every integer N ≥0 we have
(1 + |x|2)N 
Af(x) =
 1
2π
n/2 	
Rn(1 −∆ξ)Neix·ξa(x, ξ)Ff(ξ)dξ
=
 1
2π
n/2 	
Rn eix·ξ(1 −∆ξ)N[a(x, ξ)Ff(ξ)]dξ
where the second inequality is obtained using integration by parts. Using Leibniz’s
formula for the derivatives of a product of functions and the properties of the
Fourier transform we thus have
(1 + |x|2)N 
Af(x) =

|α|+|β|≤2N
Cαβ
	
Rn eix·ξ∂α
ξ a(x, ξ)F(xβf)(ξ)dξ
where the Cαβ are complex constants. Since xβf ∈S(Rn) and |∂α
ξ a(x, ξ)| ≤
Cα ⟨z⟩m−ρ|α| it follows that |(1 + |x|2)N 
Af(x)| ≤CN for some constant CN. Ap-
plying the same argument to
∂α
x 
Af(x) =

β≤α
C′
αβ
	
Rn eix·ξ∂β
xa(x, ξ)F(xβ−αf)(ξ)dξ
we have in fact (1 + |x|2)N∂α
x 
Af ≤C′′
α,N for all α ∈Nn and N ≥0 and hence

Af ∈S(Rn). Using the expressions above we also get estimates of the semi-norms
which imply the continuity of 
A : S(Rn) −→S(Rn).
□
We next consider the case of ℏ-dependent symbols; it is the most important
from a quantum mechanical perspective:
Deﬁnition 319. The set of operators 
A deﬁned by

Af(x) =

1
2πℏ
n 		
R2n e
i
ℏp·(x−y)a( 1
2(x + y), p, ℏ)f(y)dydp
with a ∈Σm,µ
ρ,δ (Rn ⊕Rn), µ > 0, δ ≤1/2 is denoted by Sm,µ
ρ,δ (Rn ⊕Rn).
The following boundedness results are important; they are consequences of
the properties of anti-Wick quantization studied in Chapter 11.
Proposition 320.
(i) Let a ∈Γ0
ρ(Rn ⊕Rn). The Weyl operator 
A
Weyl
←→a is bounded on L2(Rn).
(ii) Every operator 
A ∈S0,µ
ρ,δ (Rn ⊕Rn) with µ > 0, δ ≤1/2 is uniformly bounded
on L2(Rn) for 0 < ℏ≤ε.

14.1.
The Shubin classes
229
Proof of (i). In view of Proposition 259 there exists an anti-Wick operator

BaW
AW
←→b with |∂α
z b(z)| ≤Cα ⟨z⟩−ρ|α| for every α ∈Nn and 
A = 
BaW + 
R
where the kernel K of 
R is in S(Rn × Rn). In view of Corollary 264 the operator

BaW is bounded on L2(Rn), so it suﬃces to show that 
R is also bounded on
L2(Rn). Applying the Cauchy–Schwarz inequality to the relation

Rψ(x) =
	
Rn K(x, y)ψ(y)dy
we get
	
Rn | 
Rψ(x)|2dx ≤
	
Rn |K(x, y)|2dxdy
	
Rn |ψ(y)|2dy
hence ∥
Rψ∥L2 ≤∥K∥L2∥ψ∥L2 which proves our assertion.
Proof of (ii): Omitted.
□
Proposition 321. Every operator 
A ∈G0
ρ(Rn) is bounded on L2(Rn)
14.1.3
Asymptotic expansions of symbols
Let us now deﬁne and brieﬂy study the notion of asymptotic expansion of a symbol
a ∈Γm
ρ (Rn ⊕Rn).
Deﬁnition 322. Let (aj)j be a sequence of symbols aj ∈Γmj
ρ (Rn ⊕Rn) such that
limj→+∞m →−∞. Let a ∈C∞(Rn ⊕Rn). If for every integer r ≥2 we have
a −
r−1

j=1
aj ∈Γmr
ρ (Rn ⊕Rn)
(14.10)
where mr = maxj≥r mj, we will write a ∼∞
j=1 aj and call this relation an
asymptotic expansion of the symbol a.
The interest of the notion of asymptotic expansion comes from the fact that
every sequence of symbols (aj)j with aj ∈Γmj
ρ (Rn ⊕Rn), the degrees mj being
strictly decreasing and such that mj →−∞determines a symbol in some Γm
ρ (Rn⊕
Rn), that symbol being unique up to an element of S(Rn ⊕Rn):
Proposition 323. Let (aj)j be a sequence of symbols aj ∈Γmj
ρ (Rn ⊕Rn) such that
mj > mj+1 and limj→+∞m →−∞. Then:
(i) There exists a function a, such that a ∼
∞

j=1
aj.
(ii) If another function a′ is such that a′ ∼
∞

j=1
aj, then a −a′ ∈S(Rn ⊕Rn).

230
Chapter 14.
Shubin’s Global Operator Calculus
For the proof of this result we refer to Shubin [147], p. 176. Note that property
(ii) immediately follows from the fact that we have
+
m∈R Γm
ρ (Rn ⊕Rn) = S(Rn ⊕Rn)
(cf. Exercise 315).
We also have:
Proposition 324. Let aj ∈Γmj
ρ (Rn ⊕Rn), j = 1, 2, . . ., where mj →−∞when
j →+∞. Let a ∈C∞(Rn ⊕Rn) be such that for any multi-index α there exist
real constants µα and Cα such that the following estimate holds:
|∂α
z a(z)| ≦Cα ⟨z⟩µα .
(14.11)
Also assume that lj and Cj are such that lj →−∞as j →+∞and that we have

a(z) −
r−1

j=1
aj(z)

≦Cr ⟨z⟩lr .
(14.12)
Then we have the asymptotic expansion a ∼
∞

j=1
aj.
The interest of this lies in the fact that the conditions imposed on the function
a are rather weak: it is only required that a and its derivatives are polynomially
bounded at inﬁnity.
14.2
More general operators . . . which
are not more general!
Formula (14.1) suggests that it could perhaps be interesting to replace the symbol
aτ((1 −τ)x + τy, ξ) by some more arbitrary function a(x, y, ξ) and to consider
more general “Fourier integral operators” of the type

Af(x) =
 1
2π
n 		
R2n eiξ·(x−y)a(x, y, ξ)f(y)dydξ
(14.13)
or, equivalently,

Af(x) =

1
2πℏ
n 		
R2n e
i
ℏp·(x−y)a(x, y, p)f(y)dydp.
We will see that nothing is actually gained in generality.

14.2.
More general operators . . . which are not more general!
231
14.2.1
More general classes of symbols
The consideration of such more general operators motivates the introduction of
the following extension of the class Γm
ρ (Rn ⊕Rn):
Deﬁnition 325. The symbol class Πm
ρ (R3n) consists of all complex functions a ∈
C∞(R3n) such that for every α, β, γ ∈Nn there exists a constant Cαβγ ≥0 such
that the following estimate holds for some m′ ∈R:
|∂α
ξ ∂β
x∂γ
y a(x, y, ξ)| ≤Cαβγ ⟨u⟩m−ρ|α+β+γ| ⟨x −y⟩m′+ρ|α+β+γ| .
(14.14)
We are using here the notation u = (x, y, ξ) and ⟨u⟩= (1 + |x|2 + |y|2 + |ξ|2)1/2.
The following result, and its corollary, shows that Γm
ρ (Rn ⊕Rn) can be used
to construct symbols in Πm
ρ (R3n):
Proposition 326. Let f be a linear map R2n →Rn such that the linear map
φ : R2n →R2n deﬁned by φ(x, y) = (f(x, y), x −y) is an isomorphism. Let b ∈
Γm
ρ (R2n). Deﬁne a function a ∈C∞(R3n) by the formula
a(x, y, ξ) = b(f(x, y), ξ).
(14.15)
Then a ∈Πm
ρ (R3n).
Proof. The functions |x|+|y| and |f(x, y)|+|x −y| give equivalent norms on R2n.
Therefore, for the proof of the proposition it remains to use the easily veriﬁed
inequality
(1 + |f(x, y)| + |ξ|)s
(1 + |f(x, y)| + |x −y| + |ξ|)s ≦C(1 + |x −y|)|s|
(14.16)
valid for s ∈R, from which the estimates follow for a(x, y, ξ) with m′ = |m|.
□
Exercise 327. Prove Peetre’s inequality (1 + |a −b|)s ≤2|s|(1 + |a|)s(1 + |b|)|s|.
Exercise 328. Use Peetre’s inequality to prove the inequality (14.16).
It readily follows from the result above that:
Corollary 329. Let b ∈Γm
ρ (Rn ⊕Rn) and deﬁne
a1(x, y, ξ) = b(x, ξ)
and
a2(x, y, ξ) = b(y, ξ).
Then a1 and a2 both belong to the symbol class Γm
ρ (R3n).
Proof. We have a1(x, y, ξ) = b(f(x, y), ξ) with f(x, y) = x and φ(x, y) = (x, x−y)
obviously is an isomorphism, hence a1 ∈Γm
ρ (R3n) in view of Proposition 326; a
similar argument shows that we have a2 ∈Γm
ρ (R3n) as well.
□

232
Chapter 14.
Shubin’s Global Operator Calculus
Let us now give a meaning to the expression (14.13) deﬁning the pseudo-
diﬀerential operator A. The expression

Af(x) =
 1
2π
n 		
R2n eiξ·(x−y)a(x, y, ξ)f(y)dydξ
(14.17)
perfectly makes sense if a ∈Πm
ρ (R3n) is compactly supported and f ∈C∞
0 (Rn)
(the compactly supported inﬁnitely diﬀerentiable functions); the discussion below
actually works as well modulo a few minor modiﬁcations if we assume f ∈S(Rn).
In fact the integration in the right-hand side of (14.17) is performed over a compact
set, so that we get an absolutely convergent integral. To deal with a general a ∈
Πm
ρ (R3n) we note that in view of the obvious identities
⟨x −y⟩−M ⟨∂ξ⟩M eiξ·(x−y) = eiξ·(x−y),
⟨ξ⟩−N ⟨∂y⟩N eiξ·(x−y) = eiξ·(x−y)
we can rewrite (14.17) as

Af(x) =
 1
2π
n 		
R2n eiξ·(x−y) ⟨x −y⟩−M
× ⟨∂ξ⟩M ⟨∂y⟩N !
⟨ξ⟩−N a(x, y, ξ)f(y)
"
dydξ.
For an arbitrary a ∈Πm
ρ (R3n) we can take this expression as a deﬁnition of
the operator A as soon as we have m −N < −n and m′ + m −M < −n. The
estimates (14.14) imply that the double integral is convergent, and thus deﬁnes a
continuous function Af. One readily veriﬁes that if we increase M and N then we
obtain integrals which are also convergent after diﬀerentiation with respect to the
variable x, hence A : C∞
0 (Rn) −→S(Rn) (respectively A : S(Rn) −→S(Rn)). We
leave the details to the reader.
14.2.2
A reduction result
The following result, which we dignify as a theorem, is due to Shubin ([147] The-
orem 23.2). It is very important because it shows that nothing is really gained by
the consideration of the more “exotic” operators of the type (14.17). It shows in
fact that every such pseudo-diﬀerential operator with symbol in Πm
ρ (R3n) can be
expressed as an operator belonging to the class ΠGm
ρ (Rn), and this in inﬁnitely
many ways. The proof of this property is long and technical (it makes use of
several Taylor expansions), but we reproduce it in Section 14.5 for the sake of
completeness.
Theorem 330. Let τ be an arbitrary real number. Every pseudo-diﬀerential operator

A ∈Gm
ρ (R3n), that is

Af(x) =
 1
2π
n 		
R2n eiξ·(x−y)a(x, y, ξ)f(y)dydξ
(14.18)

14.2.
More general operators . . . which are not more general!
233
or, equivalently, setting p = ℏξ:

Af(x) =

1
2πℏ
n 		
R2n e
i
ℏp·(x−y)a(x, y, ℏ−1p)f(y)dydp
(14.19)
with a ∈Πm
ρ (R3n), can be written in the form

Af(x) =
 1
2π
n 		
R2n eiξ·(x−y)aτ((1 −τ)x + τy, ξ)f(y)dydξ
(14.20)
where aτ ∈Γm
ρ (Rn ⊕Rn); respectively

Af(x) =

1
2πℏ
n 		
R2n e
i
ℏp·(x−y)aτ((1 −τ)x + τy, ℏ−1p)f(y)dydp.
(14.21)
We have in addition the following asymptotic expansion:
aτ(x, ξ) ∼

β,γ
1
β!γ!τ |β|(1 −τ)|γ|∂β+γ
ξ
(−Dx)βDγ
ya(x, y, ξ)|y=x.
(14.22)
The following consequence of Theorem 330 is obvious; it links the theory of
Weyl operators to Shubin’s theory of pseudo-diﬀerential operators:
Corollary 331. Every pseudo-diﬀerential operator 
A of the type

Af(x) =
 1
2π
n 		
R2n eiξ·(x−y)a(x, y, ξ)f(y)dydξ
with a ∈Πm
ρ (R3n) is a Weyl operator 
A
Weyl
←→aw with symbol aw ∈Γm
ρ (R2n) given
by the expression
aw(x, ξ) ∼

β,γ
1
β!γ!
1
2
|β|+|γ|
∂β+γ
ξ
(−Dx)βDγ
ya(x, y, ξ)|y=x.
Proof. It suﬃces to take τ = 1
2 in formula (14.22).
□
The following result shows that the correspondence between operators and
symbols (for a given τ) is one-to-one and onto.
Proposition 332. The τ-symbol of an operator 
A ∈Gm
ρ (R3n) is uniquely deﬁned.
Thus, for each value of the parameter τ the correspondence 
A
τ
←→a is bijective.
Proof. Let us ﬁrst verify that if 
A has a kernel K 
A ∈S(Rn ⊕Rn), then it has a
τ-symbol aτ ∈S(Rn ⊕Rn) and the correspondence between kernel and symbol is a
one-to-one correspondence. When a ∈S(Rn ⊕Rn) it follows from formula (14.20)
that the correspondence between kernel and τ-symbol is given by
K 
A(x, y) =
 1
2π
n/2 F −1
ξ→x−yaτ((1 −τ)x + τy, ξ),
(14.23)
aτ(v, ξ) = (2π)n/2 Fw→ξK 
A(v + τw, v −(1 −τ)w),
(14.24)

234
Chapter 14.
Shubin’s Global Operator Calculus
where formula (14.24) is obtained from formula (14.23) by a change of coordinates
and the Fourier inversion formula. In particular, for any K 
A ∈S(R2n), we can
ﬁnd aτ(v, ξ) ∈S(Rn ⊕Rn) using formula (14.24).
□
The following consequence is of course an obvious extension of formulas
(10.14) and (10.15) in Proposition 205) relating the Weyl symbol and the ker-
nel of an operator:
Corollary 333. In the ℏ-dependent case the symbol a and the kernel K 
A are related
by the formulas
K 
A(x, y) =

1
2πℏ
n 	
Rn e
i
ℏp·(x−y)a((1 −τ)x + τy, p)dp,
(14.25)
aτ(x, p) =
	
Rn e−i
ℏp·yK 
A(x + τy, x −(1 −τ)y)dy
(14.26)
(the integrals being understood as Fourier transforms).
Proof. These formulas are just a formal restatement of (14.23) and (14.24) in the
case of ℏ-dependent τ-pseudodiﬀerential operators.
□
We next show the uniqueness of the τ-symbol in the general case. For this
we note that (14.23) is always true when 
A is given via a τ-symbol aτ(v, ξ) and
if the partial Fourier transform, which appears in this formula, is understood in
the distributional sense. It follows that the inversion formula is also true, leading
to (14.24) after the linear change of coordinates (14.62). Furthermore, the unique-
ness of a τ-symbol is obvious in view of formula (14.24), taking into account the
uniqueness of the kernel K 
A.
In particular, the Weyl correspondence 
A
Weyl
←→a is also bijective. More gen-
erally:
Corollary 334. Every operator 
A ∈Gm
ρ (Rn) can always be written in any of the
following three forms:

Au(x) =
 1
2π
n 		
R2n ei(x−y)·ξaℓ(x, ξ)u(y)dydξ,
(14.27)

Au(x) =
 1
2π
n 		
R2n ei(x−y)·ξar(y, ξ)u(y)dydξ,
(14.28)

Au(x) =
 1
2π
n 		
R2n ei(x−y)·ξaw( 1
2(x + y), ξ)u(y)dydξ.
(14.29)
In the expressions above the symbols aℓ, ar and aw belong to Γm
ρ (Rn ⊕Rn), and
are uniquely deﬁned by 
A.

14.2.
More general operators . . . which are not more general!
235
The case of ℏ-dependent operators is immediately obtained by the usual
modiﬁcations; for instance formula (14.29) becomes

Aψ(x) =

1
2πℏ
n 		
R2n e
i
ℏ(x−y)·paw( 1
2(x + y), p)ψ(y)dydp
(14.30)
where one recognizes the usual Weyl correspondence 
A
Weyl
←→aw.
These results motivate the following deﬁnition:
Deﬁnition 335. The functions aℓ, ar and aw in the formulae (14.27)–(14.29) and
corresponding to the choices τ = 0, τ = 1, τ = 1
2 are called, respectively, the left,
right and Weyl symbols of operator 
A. When we speak about a “Weyl pseudo-
diﬀerential operator 
A” it will be implicitly understood that its symbol is aw, and
it will be written a when no confusion can arise.
In this book we mainly use the Weyl symbol; as already emphasized, this
choice is in a sense “natural” in quantum mechanics (especially in deformation
quantization) because Weyl operators enjoy very nice covariance properties with
respect to the symplectic and metaplectic groups.
In ordinary pseudo-diﬀerential calculus one has continuity results in terms of
the usual Sobolev spaces Hs(Rn). Since the vocation of the operators studied in
this chapter is to incorporate global behavior, it is appropriate to introduce the
following variant of the usual Sobolev spaces:
Deﬁnition 336. For s ∈R the global Sobolev space Qs(Rn) consists of all f ∈
S′(Rn) such that Lsf ∈L2(Rn) where Ls ∈Gs
1(Rn) is the operator deﬁned by
Lsf(x) =
 1
2π
n/2 	
Rn eix·ξ⟨z⟩s/2Ff(ξ)dξ.
The norm on Qs(Rn) is deﬁned by ∥f∥Qs(Rn) = ∥Lsf∥L2(Rn).
It turns out that the study of Qs(Rn) is best understood within the framework
of the modulation spaces we will study in Chapter 17. Let us just mention at this
point that Qs(Rn) can be equipped with an inner product making it into a Hilbert
space, and that we have the equalities
+
s∈RQs(Rn) = S(Rn) and
,
s∈RQs(Rn) = S′(Rn)
and that the following regularity result holds:
Proposition 337. Every operator 
A∈Γm
ρ (Rn) is continuous Qs(Rn)−→Qs−m(Rn).
In particular 
A : S(Rn) −→S′(Rn).

236
Chapter 14.
Shubin’s Global Operator Calculus
14.3
Relations between kernels and symbols
In Chapter 10 we brieﬂy discussed the relationship between Weyl operators, their
kernels, and their symbols. We are giving here a more detailed study within the
framework of τ-symbols. This will allow us to make explicit the relation between
the Wigner and the Rihaczek transformations.
14.3.1
A general result
We want to be able to compare the symbols aτ and aτ ′ of a given operator 
A. For
instance, given the Kohn–Nirenberg symbol of 
A, what is the Weyl symbol of that
operator? The following result (Shubin [147], p. 183) gives a method for passing
from one symbol to the other:
Proposition 338. The symbols aτ and aτ ′ of the same operator 
A ∈Gm
ρ (Rn) are
related by the formula
aτ(x, ξ) = ei(τ−τ ′)Dα
x ·Dα
ξ aτ ′(x, ξ)
(14.31)
where Dα
x · Dα
ξ = 
j Dαj
xj · Dαj
ξj .
(i) The following asymptotic formula holds:
aτ(x, ξ) ∼

α
1
α!(τ ′ −τ)|α|∂α
ξ Dα
xaτ ′(x, ξ).
(14.32)
(ii) We have aτ −aτ ′ ∈Γm−2ρ
ρ
(Rn ⊕Rn).
Proof. The second statement immediately follows from the ﬁrst. Notice that the
right-hand side of formula (14.31) is well deﬁned because the exponential is a
Fourier multiplier. We begin by making the following remark. Consider a τ-
pseudodiﬀerential operator with symbol a ∈Πm
ρ (R3n):

Af(x) =
 1
2π
n 		
R2n eiξ·(x−y)aτ((1 −τ)x + τy, ξ)f(y)dydξ.
The expression of the τ-symbol in terms of the τ ′-symbol for a diﬀerent τ, can be
easily obtained from Theorem 330 in the form of an asymptotic series. Indeed, if
an operator 
A has the τ ′-symbol aτ′ (x, ξ), that symbol may be determined via
a(x, y, ξ) = aτ ′((1 −τ ′)x + τ ′y, ξ).
In view of formula (14.22) in Theorem 330 the τ-symbol has the asymptotic ex-
pansion
aτ(x, ξ) ∼

β,γ
(−1)|β|
β!γ! τ |β|(1 −τ)|γ|(1 −τ1)|β|τ ′|γ|∂β+γ
ξ
Dβ+γ
x
aτ ′

14.3.
Relations between kernels and symbols
237
or
aτ(x, ξ) ∼

α
cα∂α
ξ Dα
xaτ ′(x, ξ),
where cα is a real constant given by
cα =

β+γ=α
(−1)|β|
β!γ!
[τ(1 −τ ′)]|β| [(1 −τ)τ ′]|γ| ;
(14.33)
in particular,we have c0 = 1. Now, transforming (14.33) using Newton’s binomial
formula, we obtain after a few calculations
cα = 1
α! [(1 −τ)τ ′e −τ(1 −τ ′)e]α
where e = (1, 1, . . . , 1), that is cα =
1
α!(τ ′ −τ)|α| which yields formula (14.32).
Formula (14.31) follows.
□
One can also show that we have precise asymptotic expansions relating the
symbols left, right, and Weyl symbols aℓ, ar and aw:
aℓ(x, ξ) ∼

α
1
α!∂α
ξ Dα
y a(x, y, ξ)|y=x,
(14.34)
ar(y, ξ) ∼

α
1
α!∂α
ξ (−Dx)αa(x, y, ξ)|y=x,
(14.35)
aw(x, ξ) ∼

β,γ
1
β!γ!
1
2
|β+γ|
∂β+γ
ξ
(−Dx)βDγ
ya(x, y, ξ)|y=x .
(14.36)
14.3.2
Application: Wigner and Rihaczek distributions
Recall from Corollary 207 that the Weyl symbol of the projection operator Pψ :
L2(Rn) −→{λψ : λ ∈C} (ψ ̸= 0) is (up to a constant) the Wigner transform of
ψ. In fact, more generally, the Weyl symbol of the operator with kernel Kψ,φ =
(2πℏ)−n/2ψ⊗φ is the cross-Wigner transform W(ψ, φ). Let us generalize this result
to the case of τ-pseudodiﬀerential operators. Let us rewrite in a more tractable
form formulas(14.23) and (14.24) relating the τ-symbol and kernel of an operator

Af(x) =
 1
2π
n 		
R2n eiξ·(x−y)aτ((1 −τ)x + τy, ξ)f(y)dydξ.
Writing the Fourier transforms as integrals these formulas become
K 
A,τ(x, y) =
 1
2π
n 	
Rn eiξ·(x−y)aτ((1 −τ)x + τy, ξ)dξ,
(14.37)
aτ(x, ξ) =
	
Rn e−iξ·yK 
A,τ(x + τy, x −(1 −τ)y)dy.
(14.38)

238
Chapter 14.
Shubin’s Global Operator Calculus
Having quantum-mechanical applications in perspective we restate this result
in terms of operators depending on ℏ:
Lemma 339. The distributional kernel
K 
A,τ(x, y) =

1
2πℏ
n 	
Rn e
i
ℏp·(x−y)aτ((1 −τ)x + τy, p)dp
(14.39)
of the operator 
A deﬁned by

Aψ(x) =

1
2πℏ
n 		
R2n e
i
ℏp·(x−y)aτ((1 −τ)x + τy, ξ)ψ(y)dydp
(14.40)
is related to the τ-symbol of that operator by the formula
aτ(x, p) =
	
Rn e−i
ℏp·yK 
A,τ(x + τy, x −(1 −τ)y)dy.
(14.41)
Proof. Let us check this formula directly. We have, using (14.39),
K 
A,τ(x + τy, x −(1 −τ)y) =

1
2πℏ
n 	
Rn e
i
ℏp·yaτ(x, p)dp;
formula (14.41) follows since the left-hand side is (2πℏ)−n/2 the inverse Fourier
transform of aτ.
□
We have shown in Corollary 207 that the cross-Wigner transform
W(ψ, φ)(z) =

1
2πℏ
n 	
Rn e−i
ℏp·yψ(x + 1
2y)φ(x −1
2y)dy
is the Weyl symbol of the operator 
Aψ⊗φ with kernel (2πℏ)−n ψ ⊗φ. Thus:

Aψ⊗φ
Weyl
←→W(ψ, φ).
In time-frequency analysis and signal theory one often uses the so-called Ri-
haczek distribution (also called Kirkwood–Rihaczek distribution in the literature).
Its deﬁnition, in units where ℏ= 1/2π, is
R(f, g)(x, ω) = e−2πiω·xf(x)
g(ω);
(14.42)
here 
g is the unitary Fourier transform given by

g(ω) =
	
Rn e−2πiω·xg(x)dx.
In more general units we may redeﬁne the Rihaczek distribution in the obvious
way:
R(ψ, φ)(x, p) = e−i
ℏp·xψ(x)Fφ(p)
(14.43)

14.4.
Adjoints and products
239
where Fψ is the ℏ-dependent Fourier transform. (Some authors interchange ψ
and φ which amounts to replacing R(ψ, φ) by R(φ, ψ).) That this distribution is
related to the Wigner distribution as a particular case of a τ-dependent symbol
was noticed a long time ago by Kozek [110].
Proposition 340. Let 
Aψ⊗φ be the operator with kernel K = ψ ⊗φ. We have:
(aψ⊗φ)ℓ= (2πℏ)n/2R(ψ, φ).
(14.44)
Proof. The left symbol corresponds to the choice τ = 0 in formula (14.41) and
hence
(aψ⊗φ)ℓ(z) =
	
Rn e−i
ℏp·yψ(x)φ(x −y)dy
= ψ(x)
	
Rn e−i
ℏp·yφ(x −y)dy
= (2πℏ)n/2ψ(x)e−i
ℏp·xFφ(p)
as claimed.
□
Exercise 341. Compute the right symbol (aψ⊗φ)r corresponding to the choice
τ = 1.
14.4
Adjoints and products
The Shubin classes “behave well” under the operations of transposition (or of
taking the adjoint) and composition. This leads to some useful formulas.
14.4.1
The transpose and adjoint operators
Let us now consider the transposed operator 
AT , deﬁned by the formula
-

Au, v
.
=
-
u, 
AT v
.
for
u, v ∈S(Rn),
where ⟨·, ·⟩is the distributional pairing.
Proposition 342. If the operator 
A has a τ-symbol aτ, then 
AT has the (1 −τ)-
symbol aT
1−τ, given by the formula
aT
1−τ(x, ξ) = aτ(x, −ξ).
(14.45)
Proof. It is an immediate consequence of the equalities
-

Au, v
.
=
 1
2π
n 	
R3n ei(x−y)·ξaτ((1 −τ)x + τy, ξ)u(y)v(x)dydxdξ
=
 1
2π
n 	
R3n ei(y−x)·ξaτ((1 −τ)x + τy, −ξ)u(y)v(x)dydxdξ.
□

240
Chapter 14.
Shubin’s Global Operator Calculus
One can also show using the methods above that one has the following asymp-
totic formula for the symbol of the transpose:
Proposition 343. If 
A ∈Gm
ρ (Rn) then 
AT ∈Gm
ρ (Rn) and the τ-symbol aT
τ (x, ξ)
of 
AT can be expressed in terms of the τ-symbol aτ(x, ξ) of 
A by the asymptotic
formula
aT
τ (x, ξ) ∼

α
1
α!(1 −2τ)|α|∂α
ξ Dα
xaτ(x, −ξ).
(14.46)
We omit the proof since we will not need this result (see Shubin [147]).
Deﬁning the formal adjoint of 
A∗of 
A by
( 
Au|v)L2(Rn) = (u| 
A∗v)L2(Rn) for u, v ∈S(Rn)
(14.47)
one proves similarly that:
Proposition 344. If 
A ∈Gm
ρ (Rn), then 
A∗∈Gm
ρ (Rn) and the τ-symbol a∗
τ(x, ξ) of

A∗is related to the (1 −τ)-symbol a1−τ(x, ξ) of 
A by the formula
a∗
τ(x, ξ) = a1−τ(x, ξ),
(14.48)
and it can be expressed in terms of the τ-symbol aτ(x, ξ) of 
A via the asymptotic
series
aτ ∼

α
1
α!(1 −2τ)|α|∂α
ξ Dα
xaτ.
(14.49)
As an immediate consequence of this result we recover the following well-
known property of Weyl operators:
Corollary 345. If 
A ∈Gm
ρ (Rn), then the Weyl symbol (aw)∗of the formal adjoint

A∗is given by
(aw)∗(x, ξ) = aw(x, ξ).
(14.50)
In particular, the condition 
A = 
A∗is equivalent to the real-valuedness of the Weyl
symbol a(x, ξ).
14.4.2
Composition formulas
Another important result is the following, which gives asymptotic formulas for
composing operators in the Shubin classes:
Proposition 346. Let 
A ∈Gm1
ρ (Rn) and 
B ∈Gm2
ρ (Rn). Then 
A 
B ∈Gm1+m2
ρ
(Rn)
and if aτ1 is the τ1-symbol of 
A and bτ2 the τ2-symbol of 
B, then the τ-symbol cτ
of 
A 
B has the asymptotic expansion
cτ ∼

α,β,γ,δ
cαβγδ(∂α
ξ Dβ
xaτ1)(∂γ
ξ Dδ
xbτ2)
(14.51)

14.4.
Adjoints and products
241
where the sum runs over sets of multi-indices α, β, γ and δ such that α+γ = β +δ;
the cαβγδ are complex constants depending on τ, τ1 and τ2 such that c0000 = 1. In
particular, we have
cτ −aτ1bτ2 ∈Γm1+m2−2ρ
ρ
(Rn ⊕Rn).
Proof. Taking Proposition 326 into account, we see that it suﬃces to consider only
one arbitrary triple of the numbers τ, τ1 and τ2. Let us take for simplicity τ1 = 0,
τ2 = 1. The operator 
B can be written, using the symbol b1(y, ξ), as

Bu(x) =
 1
2π
n 		
R2n ei(x−y)·ξb1(y, ξ)u(y)dydξ
or, equivalently,
F( 
Bu)(ξ) =
	
Rn e−iy·ξb1(y, ξ)u(y)dy
(14.52)
where F( 
Bu) is the Fourier transform of 
Bu. The operator 
A has the form

Av(x) =
 1
2π
n 		
R2n ei(x−y)·ξa0(x, ξ)u(y)dydξ
(14.53)
=
 1
2π
n 	
Rn eix·ξa0(x, ξ)Fu(ξ)dξ.
(14.54)
From (14.52) and (14.53) it follows that

A 
Bu(x) =
 1
2π
n 		
R2n ei(x−y)·ξa0(x, ξ)b1(y, ξ)u(y)dydξ,
(14.55)
i.e., 
A 
B has symbol
c(x, y, ξ) = a0(x, ξ)b1(y, ξ) ∈Πm1+m2
ρ
(R3n).
It follows that we have 
A 
B ∈Gm1+m2
ρ
(Rn). In view of Theorem 330 we have the
asymptotic expansion
cτ(x, ξ) ∼

β,γ
(−1)|β|
β!γ! τ |β|(1 −τ)|γ|∂β+γ
ξ

(Dβ
xa0(x, ξ))(Dγ
xb1(x, ξ))
 
.
(14.56)
Using Leibniz’s diﬀerentiation rule for functions of several variables this formula
can be rewritten as
cτ(x, ξ) ∼
 (−1)|β|(β + γ)!
β!γ!δ!ε!
τ |β|(1 −τ)|γ|(∂δ
ξDβ
xa0)(∂ε
ξDγ
xb1),
(14.57)
where the sum is taken over all β, γ, δ, ε such that δ +ε = β +γ, which is the same
thing as (14.51).
□

242
Chapter 14.
Shubin’s Global Operator Calculus
Inserting into (14.57) the expressions for a′
0, a′′
1 in terms a′
τ1, a′′
τ2 we obtain
formulae for the coeﬃcients cαβγδ in (14.51), which may sometimes be simpliﬁed.
For instance, one can show that, similarly to Proposition (346) one has
a0(x, ξ) ∼

α
1
α!∂α
ξ a′
0(x, ξ)Dα
x a′′
0(x, ξ).
(14.58)
In the case of Weyl operators we get the following important explicit result:
Corollary 347. If 
A ∈Gm1
ρ (Rn) and 
B ∈Gm2
ρ (Rn), then the Weyl symbol cw of

C = 
A 
B is given by
cw ∼

α,β
(−1)|β|
α!β! 2−|α+β|(∂α
ξ Dβ
xaw))(∂β
ξ Dα
xbw).
(14.59)
When 
A, 
B, and 
C are expressed in the ℏ-dependent form then this formula be-
comes
cw ∼

α,β
(−1)|β|
α!β!
ℏ
2
|α+β|
(∂α
ξ Dβ
xaw))(∂β
ξ Dα
xbw).
(14.60)
Proof. It is immediate, using formula (14.57) above.
□
The property in the following problem is at the origin of many results in the
classical theory of pseudodiﬀerential operators:
Problem 348. Show that the left symbol aℓof an operator 
A ∈Gm
ρ (Rn) can be
expressed in terms of 
A by the formula
aℓ(x, ξ) = e−ix·ξ 
A(eix·ξ)
(14.61)
where 
A acts on the variable x.
For the applications to quantum mechanics (especially deformation quanti-
zation and its variants which will be studied in Chapter 19) the following result
for operators with ℏ-dependent symbols is essential:
Theorem 349. Let 
A ∈Sm,µ
ρ,δ (Rn) and 
B ∈Sm′,µ′
ρ′,δ′ (Rn ⊕Rn). Then 
C = 
A 
B ∈
Sm+m′,µ+µ′
ρ′′,δ′′
(Rn) with ρ′′ = min(ρ, ρ′), δ′′ = max(δ, δ′) and the symbol c
Weyl
←→
C
has the expansion
c =

|α+β|<N
(−1)|β|
α!β!
−iℏ
2
|α+β|
(∂α
ξ ∂β
xa)(∂α
x ∂β
ξ a) + ℏNrN
with the following condition on the term rN:
rN ∈Σm+m′−N(ρ+ρ′),µ+µ′−N(δ+δ′)
ρ,δ
(Rn ⊕Rn).
The proof of this result is long and technical; see [147], Appendix A.2.5,
pp. 245–248.

14.5.
Proof of Theorem 330
243
14.5
Proof of Theorem 330
It is of course suﬃcient to give the proof in the case ℏ= 1.
Setting v = (1 −τ)x + τy and w = x −y in a(x, y, ξ), that is, equivalently,
x = v + τw , y = v −(1 −τ) w
(14.62)
we have
a(x, y, ξ) = a(v + τw, v −(1 −τ) w, ξ).
(14.63)
Expanding the right-hand side of (14.63) in a Taylor series at w = 0, we get
a = aN + rN where
aN(x, y, ξ) =

|β+γ|≤N−1
(−1)|γ|
β!γ! τ |β| (1 −τ)|γ| (x −y)β+γ(∂β
x∂γ
y a)(v, v, ξ) (14.64)
and the remainder term rN is given by the formula
rN(x, y, ξ) =

|β+γ|=N
cβγ(x −y)β+γIβγ(x, y, ξ) with
(14.65a)
Iβγ(x, y, ξ) =
	 1
0
(1 −t)N−1(∂β
x∂γ
y a)(v + tτw, v −t(1 −τ)w, ξ)dt
(14.65b)
where the cβγ are constants. In (14.64) the expression (∂β
x∂γ
y a)(v, v, ξ) signiﬁes that
we have replaced x and y with v = (1 −τ) x + τy in the expression ∂β
x∂γ
y a(x, y, ξ).
The expression
(∂β
x∂γ
y a)(v + tτw, v −t(1 −τ)w, ξ)
in (14.65) should be understood in a similar way. We next note that the operator
with symbol (x −y)β+γ(∂β
x∂γ
y a)(v, v, ξ) is the same as the one with symbol
(−Dξ)β+γ(∂β
x∂γ
y a)(v, v, ξ) = (−1)|β|+|γ|(∂β+γ
ξ
Dβ
xDγ
ya)(v, v, ξ).
It follows from (14.64) that 
A = 
AN + 
RN where 
AN is an operator with τ-symbol
aN(x, ξ) =

|β+γ|≤N−1
1
β!γ!τ |β|(1 −τ)|γ|∂β+γ
ξ
(−Dx)ξDγ
ya(x, y, ξ)|y=x
and 
RN is an operator with symbol rN. Note that the operator 
RN is a linear
combination of a ﬁnite number of terms having symbols of the type
	 1
0
(∂β+γ
ξ
∂β
x∂γ
y a)(v + tτw, v −t(1 −τ)w, ξ)(1 −t)N−1dt
(14.66)
with |β + γ| = N. Let us now show that the rN symbol belongs to the class
Πm−2Nρ
ρ
(R3n). For this it suﬃces to show that this is true for the integrand

244
Chapter 14.
Shubin’s Global Operator Calculus
in (14.66), with all estimates uniform in t (note that this is obvious for each
ﬁxed t ̸= 0 and true for t = 0 by Proposition 326). Using the trivial relations
v = (1 −τ)(v + tτw) + τ(v −t(1 −τ)w),
tw = (v + tτw) −(v −t(1 −τ)w)
it is easy to see that there exists a constant C > 0 independent of t ∈[0, 1] such
that
C−1 ≦|v + tτw| + |v −t(1 −τ)w|
|v| + |tw|
≦C
and we thus have the estimate
(∂β+γ
ξ
∂β
x∂β
y a)(v + tτw, v −t(1 −τ)w, ξ)

≤C(1 + |v| + |tv| + |ξ|)m−2ρN(1 + |tw|)m′+2ρN.
Since for m′ + 2ρN ≧0 we have the inequality
(1 + |tw|)m′+2ρN ≤(1 + |v| + |tv| + |ξ|)m′+2ρN(1 + |v| + |ξ|)−(m′+2ρN),
it is clear that if, in addition, m + m′ ≧0 and m −2ρN ≦0, then
(∂β+γ
ξ
∂β
x∂β
y a)(v + tτw, v −t(1 −τ)w, ξ)

≤C′(1 + |v| + |ξ|)−m′−2ρN(1 + |v| + |tw| + |ξ|)m′+m
≤C′(1 + |v| + |ξ|)m−2ρN(1 + |w|)m′+m
≤C′(1 + |v| + |w| + |ξ|)m−2ρN(1 + |w|)m′+2m+2ρN
where C′ is independent of t. One estimates the derivatives in a similar way. Now,
let the symbol b′(x, ξ) ∈Γm
ϱ (Rn ⊕Rn) be such that
b′(x, ξ) ∼
∞

N=0
(bN(x, ξ) −bN−1(x, ξ)).
Then, if 
A′ has τ-symbol b′(x, ξ) it is clear that the kernel of the operator 
A −
A′
is in S(R2n).

Part IV
Applications

Chapter 15
The Schr¨odinger Equation
Schr¨odinger’s equation
iℏ∂ψ
∂t (x, t) = 
Hψ(x, t)
is considered by physicists as a postulate that cannot be rigorously derived from
Hamiltonian mechanics. It is however well known that in the case of linear Hamil-
tonian ﬂows, the Schr¨odinger equation is obtained using the metaplectic repre-
sentation: this will be proven in the ﬁrst part of this chapter (Section 15.1). In
the second part of this chapter (Section 15.2), which is somewhat tentative in
the sense that we pay little attention to domain questions, we will show that the
Schr¨odinger equation can be derived using Stone’s theorem on strongly continu-
ous one-parameter groups of unitary operators, if one requires in addition that
quantum states satisfy a certain covariance property. This derivation is made pos-
sible thanks to Theorem 356 (essentially due to Wong [163]) which says that Weyl
calculus is the only symplectically covariant pseudo-diﬀerential theory. We men-
tion that a more physical version of these results is to appear in de Gosson and
Hiley [73] (not surprisingly leading to negative emotional reactions from some
physicists); for those interested in the physical aspects (including the scientiﬁc on-
tology) of quantum mechanics, we recommend the texts [92, 93, 94, 95] by Hiley
and collaborators.
15.1
The case of quadratic Hamiltonians
Here is again a somewhat technical section; it gives explicit formulae for the solu-
tions of the Schr¨odinger equation associated with a Hamiltonian function which is
quadratic. Most physicists know these explicit formulae, but prefer to invoke the
“Feynman path integral” for their derivation. However the Feynman integral as
used in Physics has no precise mathematical meaning (even if it may be a useful
heuristic tool in some circumstances; see Schulman [144] for an exposition of the
techniques related to path integrals).
247
M.A. de Gosson, Symplectic Methods in Harmonic Analysis and in Mathematical Physics,  
Pseudo-Differential Operators 7, DOI 10.1007/978-3-7643-9992-4_
, © Springer Basel AG 2011 
15

248
Chapter 15.
The Schr¨odinger Equation
15.1.1
Preliminaries
It turns out that Schr¨odinger’s equation can be solved explicitly when the operator

H is the Weyl operator associated with a Hamiltonian function which is a quadratic
polynomial in the position and momentum variables:
H(z) = 1
2Mz · z
where M is some (arbitrary) real 2n × 2n symmetric matrix. Thus, H is a real
quadratic form in the xj, pj variables. To H we associate a partial diﬀerential
operator 
H by applying the ordering rules (1.34) discussed in the ﬁrst chapter:
x −→
x , p −→
p , px −→1
2(
x
p + 
p
x)
(15.1)
where 
x is the operator of multiplication by x and 
p = −iℏ∂/∂x (this prescription
is suﬃcient to determine unambiguously the operator 
H since H is a polynomial
of degree 2). Writing
M =

Hxx
Hxp
Hpx
Hpp

, Hpx = HT
xp
we have the explicit formula

H = −ℏ2
2 Hpp∂x · ∂x −iℏHpxx · ∂x + 1
2Hxxx · x −i
2 Tr(Hpx).
(15.2)
One veriﬁes, using the fact that
Problem 350. Prove formula (15.2) above and show by a direct calculation that

H∗= 
H. What is 
H when H(x, p) = p · x?
The associated Schr¨odinger equation is
iℏ∂ψ
∂t (x, t) = 
Hψ(x, t)
where ψ is a function (or distribution) in the x, t variables. We are going to see that
this equation can be explicitly solved using the theory of the metaplectic group.
The solutions will in fact be expressed, except for exceptional values of time, as
quadratic Fourier transforms.
To prove this remarkable fact we will have to ﬁnd an explicit description of
the Lie algebra of the metaplectic group (on the abstract level, this Lie algebra is
identical with that of the symplectic group).

15.1.
The case of quadratic Hamiltonians
249
15.1.2
Quadratic Hamiltonians
Let us begin by shortly discussing the properties of quadratic Hamiltonians. These
intervene in many interesting problems from classical and quantum mechanics (for
instance in the study of motion near equilibrium, or for the calculation of the
energy spectrum of an electron in a uniform magnetic ﬁeld).
Let H be a homogeneous polynomial in z ∈R2n and with coeﬃcients de-
pending on t ∈R:
H(z, t) = 1
2H′′(t)z · z
(15.3)
(H′′(t) = D2
zH(z, t) is the Hessian matrix of H in the variables z = (x, p)); the
associated Hamilton equations can be written
˙z(t) = JH′′(t)(z(t)).
(15.4)
Recall the following notation: (SH
t,t′) is the time-dependent ﬂow determined by H,
that is if t −→z(t) is the solution of (15.4) with z(t′) = z′ then
z(t) = SH
t,t′(z′).
(15.5)
We will set SH
t,0 = SH
t . Assume that H does not depend on t; then (SH
t ) is the
one-parameter subgroup of Sp(2n, R) given by
SH
t = etJH′′.
Conversely, if (St) is an arbitrary one-parameter subgroup of Sp(2n, R) then St =
etX for some X ∈sp(2n, R) and we have (St) = (SH
t ) where H is the quadratic
Hamiltonian
H(z) = −1
2JXz · z.
(15.6)
The following elementary result gives a useful relation between the Poisson bracket
of quadratic Hamiltonian functions and commutators in the symplectic Lie algebra:
Lemma 351. Let H and K be two quadratic Hamiltonians associated by (15.6) to
X, Y ∈sp(2n, R), that is
H(z) = −1
2JXz · z , K(z) = −1
2JY z · z.
The Poisson bracket {H, K} is the quadratic Hamiltonian given by
{H, K}(z) = −1
2J[X, Y ]z · z
where [X, Y ] = XY −Y X.
Proof. We have
{H, K}(z) = −σ(XH(z), XK(z))
= −σ(Xz, Y z)
= −JXz · Y z
= −Y T JXz · z.

250
Chapter 15.
The Schr¨odinger Equation
Now
Y T JXz · z = 1
2(Y T JX −XTJY )z · z
that is, since Y T J and XT J are symmetric,
Y T JXz · z = −1
2J(Y X −XY )z · z,
whence
{H, K}(z) = 1
2J(Y X −XY )z · z
which we set out to prove.
□
The metaplectic group Mp(2n, R) is a covering group of Sp(2n, R); it follows
from the general theory of Lie groups that the Lie algebra mp(2n, R) of Mp(2n, R)
is isomorphic to sp(2n, R) (the Lie algebra of Sp(2n, R)). We are going to construct
explicitly an isomorphism F : sp(2n, R) −→mp(2n, R) making the following dia-
gram commutative:
mp(2n, R)
F −1
−→
sp(2n, R)
exp

 exp
Mp(2n, R)
−→
πMp
Sp(2n, R) .
(15.7)
Recall that sp(2n, R) denotes the Lie algebra of the symplectic group
Sp(2n, R); we will call mp(2n, R) the “metaplectic algebra”.
The following result generalizes Lemma 351:
Theorem 352.
(i) The linear mapping F, which to X ∈sp(2n, R) associates the anti-Hermitian
operator F(X) = −i
ℏ
H where 
H
Weyl
←→H with H given by (15.6), is injective,
and we have the equality
[F(X), F(X′)] = F([X, X′])
(15.8)
for all X, X′ ∈sp(2n, R);
(ii) The image F(sp(2n, R)) of F is the metaplectic algebra mp(2n, R).
Proof. It is clear that the mapping F is linear and injective. Consider the matrices
Xjk =

∆jk
0
0
−∆jk

, Yjk = 1
2

0
∆jk + ∆kj
0
0

,
Zjk = 1
2

0
0
∆jk + ∆kj
0

(1 ≤j ≤k ≤n)
with 1 the only non-vanishing entry at the jth row and kth column; these ma-
trices form a basis of sp(2n, R) (you were asked to check this in Problem 79).

15.1.
The case of quadratic Hamiltonians
251
For notational simplicity we will assume that n = 1 and set X = X11, Y = Y11,
Z = Z11:
X =

1
0
0
−1

, Y =

0
1
0
0

, Z =

0
0
1
0

;
the case of general n is studied in an exactly similar way. To the matrices X, Y ,
Z correspond via formula (15.6) the Hamiltonians
HX = px , HY = 1
2p2, HZ = −1
2x2.
The operators 
HX = F(X), 
HY = F(Y ), 
HZ = F(Z) form a basis of the vector
space F(sp(1)); they are given explicitly by the formulas

HX = −iℏx∂x −1
2iℏ, 
HY = −1
2ℏ2∂2
x , 
HZ = −1
2x2.
Let us show that formula (15.8) holds. In view of the linearity of F it is suﬃcient
to check that
[ 
HX, 
HX] = 
H[X,Y ],
[ 
HX, 
HZ] = 
H[X,Z],
[ 
HY , 
HZ] = 
H[Y,Z].
We have thus proved that F is a Lie algebra isomorphism.
To show that F(sp(2, R)) = mp(2, R) it is thus suﬃcient to check that the
one-parameter groups
t −→Ut = e−i
ℏ
HXt,
t −→Vt = e−i
ℏ
HY t,
t −→Wt = e−i
ℏ
HZt
are subgroups of Mp(1). Let ψ0 ∈S(R) and set ψ(x, t) = Utψ0(x). The function
ψ is the unique solution of the Cauchy problem
iℏ∂ψ
∂t = −(iℏx∂x + 1
2iℏ)ψ , ψ(·, 0) = ψ0.
A straightforward calculation (using for instance the method of characteristics)
yields
ψ(x, t) = e−t/2ψ0(e−tx)
hence the group (Ut) is given by Ut = 
ML(t),0 where L(t) = e−t and we thus have
Ut ∈Mp(1) for all t. Leaving the detailed calculations to the reader one similarly
veriﬁes that
Vtψ0(x) =

1
2πiℏt
1/2 	
e
i
2ℏt (x−x′)2ψ0(x′)dx′,
Wtψ0(x) = e−1
2ℏx2ψ0(x)

252
Chapter 15.
The Schr¨odinger Equation
so that Vt is a quadratic Fourier transform corresponding to the generating func-
tion W = (x−x′)2/2t and Wt is the operator 
V−tI; in both cases we have operators
belonging to Mp(1).
□
We leave it to the reader to check that the diagram (15.7) is commutative.
Exercise 353. Show, using the generators of mp(2n, R) and sp(2n, R), that
exp ◦F −1 = πMp ◦exp where exp is a collective notation for the exponentials
sp(2n, R) −→Sp(2n, R) and mp(2n, R) −→Mp(2n, R).
15.1.3
Exact solutions of the Schr¨odinger equation
Let us apply the result above to the Schr¨odinger equation associated to a quadratic
Hamiltonian (15.3). Since Mp(2n, R) covers Sp(2n, R) it follows from the unique
path lifting theorem from the theory of covering manifolds that we can lift the
path t −→SH
t,0 = SH
t
in a unique way into a path t −→
SH
t
in Mp(2n, R) such
that 
SH
0 = I. Let ψ0 ∈S(Rn
x) and set
ψ(x, t) = 
Stψ0(x).
It turns out that ψ satisﬁes Schr¨odinger’s equation
iℏ∂ψ
∂t = 
Hψ
where 
H is the Weyl operator 
H
Weyl
←→H. The results in the following problem will
be used to prove this property:
Problem 354.
(i) Verify that the operator 
H is given by

H = −ℏ2
2 Hpp∂x · ∂x −iℏHpxx · ∂x + 1
2Hxxx · x −i
2 Tr(Hpx)
(15.9)
where Tr(Hpx) is the trace of the matrix Hpx. (Hpp, Hpx, Hxx are the matrices
of second derivatives of H in the corresponding variables.)
(ii) Let 
H
Weyl
←→H, 
K
Weyl
←→K where H and K are quadratic Hamiltonians (15.3).
Show that
[ 
H, 
K] = iℏ
{H, K} = −iℏσ(XH, XK)
where {·, ·} is the Poisson bracket.
Let us now show that ψ = 
Stψ0 is a solution of Schr¨odinger’s equation as
claimed:

15.1.
The case of quadratic Hamiltonians
253
Corollary 355. Let t −→
St be the lift to Mp(2n, R) of the ﬂow t −→SH
t . For
every ψ0 ∈S(Rn
x) the function ψ deﬁned by ψ(x, t) = 
Stψ0(x) is a solution of the
partial diﬀerential equation
iℏ∂ψ
∂t = 
Hψ , ψ(·, 0) = ψ0
where 
H
Weyl
←→H. Equivalently, the function t −→
St solves the abstract diﬀerential
equation
iℏd
dt

St = 
H 
St ,

S0 = I.
Proof. We have
iℏ∂ψ
∂t = iℏlim
∆t→0
 1
∆t(
S∆t −I)


Stψ0,
hence it suﬃces to show that
lim
∆t→0
 1
∆t(
S∆t −I)

f = 
Hf
for every function f ∈S(Rn). But this equality is an immediate consequence of
Theorem 352.
□
Here is an example. For instance, in the case n = 1 the generating function
for the harmonic oscillator Hamiltonian
H = p2
2m + mω2
2
x2
(15.10)
is given by
W(x, x′; t, t′) =
mω
2 sin ω(t −t′)

(x2 + x′2) cos ω(t −t′) −2xx′ 
,
(15.11)
hence the solution of the corresponding Schr¨odinger’s equation
iℏ∂ψ
∂t =

−ℏ2
2m
∂2
∂x2 + mω2
2
x2

ψ
is explicitly given for t /∈πZ, by
ψ(x, t) =

1
2πiℏ
1/2 i−[ω(t−t′)/π]
( mω
sin ωt

	 +∞
−∞
e
i
ℏW(x,x;t,t′)ψ0(x′)dx′.
Physicists often see this formula as an application of the so-called “Feynman
path integral”, which is supposed to be calculable explicitly for the harmonic os-
cillator (and some other Hamiltonians; see Schulman [144]). However, the path
integral is only a heuristic device, and “derivations” using this device are math-
ematically meaningless. (See Kumano-go [112] for a rigorous theory of the path
integral using time-slicing methods.)

254
Chapter 15.
The Schr¨odinger Equation
15.2
The general case
While the fact that Schr¨odinger’s equation can be derived using the metaplectic
representation has been known for a long time in mathematics (at least among
people working in harmonic analysis and representation theory), the material we
present in this section is new.
15.2.1
Symplectic covariance as a characteristic
property of Weyl quantization
We have seen – and very much emphasized! – the fact that Weyl calculus is a
symplectically covariant theory. In particular, we proved in Chapter 10, Theorem
128, that if S ∈Sp(2n, R) then
!

A
Weyl
←→a
"
⇐⇒
!
a ◦S
Weyl
←→
S−1 
A
S
"
(15.12)
where 
S ∈Mp(2n, R) is any one of the two metaplectic operators such that S =
πMp(
S).
We are going to see that this property is characteristic of Weyl pseudo-
diﬀerential operators. More precisely: we have introduced in Chapter 14 a very
general notion of pseudo-diﬀerential operators, of the type
Aψ(x) =

1
2πℏ
n 		
Rn×Rn e
i
ℏp·(x−y)a(x, y, p)ψ(y)dydp.
We then showed that such operators can be written, for every value of the real
parameter τ in the form
Aψ(x) =

1
2πℏ
n 		
Rn×Rn e
i
ℏp·(x−y)aτ((1 −τ)x + τy, p)ψ(y)dydp
extending the quantizations px −→τ
x
p + (1 −τ)
p
x; the symbol aτ is uniquely
determined by the operator A, the particular choice τ = 1
2 corresponding to the
Weyl correspondence. It is legitimate to ask the question whether the symplectic
covariance property (15.12) still holds for the general correspondence A←→aτ, at
least for some privileged values of the parameter τ. The answer is: no. The Weyl
correspondence is the only quantization which is symplectically covariant in the
sense above. That this property really is characteristic of Weyl quantization seems
to be somewhat ignored both in mathematics and physics. It will be crucial in our
derivation of the Schr¨odinger equation.
We are going to give a precise statement of this fundamental property below;
let us ﬁrst introduce some notation. Viewing the space of tempered distributions
S′(Rn) as a space of “classical Hamiltonians”, we denote by L(S(Rn), S′(Rn)) the

15.2.
The general case
255
space of continuous operators S(Rn) −→S′(Rn), and we assume that there is a
continuous and linear “quantization mapping”
Q : S′(Rn ⊕Rn) −→L(S(Rn), S′(Rn))
(15.13)
associating to a symbol a an operator A = Q(a).
The following result is hinted at in Stein’s book [153] (§7.6, Chapter 12) and
proven in detail in Chapter 30 of Wong [163]. It is really a fundamental result, be-
cause it shows that the quantization mapping Q must be the Weyl correspondence
if one makes three simple assumptions (we will see in a moment that the third is
actually superﬂuous).
Theorem 356. Assume that the quantization map (15.13) has the three following
properties:
(i) Q is continuous in the sense that if (ak) is a sequence in S′(Rn ⊕Rn) then
limk→∞ak = a in S′(Rn ⊕Rn) implies limk→∞Q(ak) = Q(a);
(ii) For every S ∈Sp(2n, R) we have Q(a ◦S−1) = 
SQ(a)
S−1 where 
S ∈
Mp(2n, R) is any of the two metaplectic operators with projection S;
(iii) If a(x, p) = a(x) with a ∈L∞(Rn) then Q(a) is multiplication by the function
a, that is Q(a)ψ = aψ.
Then Q is the Weyl correspondence a
Weyl
←→
A that is Q(a) = 
A for every
a ∈S′(Rn ⊕Rn).
It turns out that the requirement (iii) can be relaxed. In fact, in view of the
Schwartz kernel theorem together with Theorem 330, condition (i) implies that
for every τ ∈R there exists a symbol aτ ∈S′(Rn ⊕Rn) such that the quantization
map Q satisﬁes
[Qa]ψ(x) =

1
2πℏ
n 		
Rn×Rn e
i
ℏp·(x−y)aτ((1 −τ)x + τy, p)ψ(y)dydp.
Suppose that a only depends on x; then the formula above implies that
[Qa]ψ(x) =

1
2πℏ
n 	
Rn
	
Rn e
i
ℏp·(x−y)dp

aτ((1 −τ)x + τy)ψ(y)dy
=
	
Rn δ(x −y)aτ((1 −τ)x + τy)ψ(y)dy
= aτ(x)ψ(x)
so that we must have aτ = a, hence condition (iii) is indeed fulﬁlled.
Summarizing:
If the quantization map Q is continuous and such that Q(a ◦S−1) =

SQ(a)
S−1 then it must be the Weyl correspondence.

256
Chapter 15.
The Schr¨odinger Equation
15.2.2
Quantum evolution groups and Stone’s theorem
Let A be a self-adjoint operator on some Hilbert space, say L2(Rn). If A is
bounded, we can deﬁne the exponential of itA by the usual power series
eitA =
∞

k=0
(it)k
k! Ak
(the series is well deﬁned, being normally convergent). When A is unbounded, one
can still deﬁne the exponential using a functional calculus of operators. The fol-
lowing properties are well known (see for instance Reed and Simon [136], §VIII.4):
Group 1
For each t ∈R the operator Ut = eitA is unitary and we have UtUt′ =
Ut+t′;
Group 2
The one-parameter group (Ut)t∈R is strongly continuous: for each ψ ∈
L2(Rn) we have limt→t0 Utψ = Ut0ψ;
Group 3
For ψ ∈DA (the domain of A) we have
lim
∆t→0
U∆tψ −ψ
∆t
= iA
and if the limit above exists for some ψ ∈L2(Rn) then ψ ∈DA.
The operator A is called the inﬁnitesimal generator of the unitary one-
parameter group (Ut)t∈R. It turns out that every strongly continuous unitary
one-parameter group of operators in L2(Rn) arises as the exponential of a self-
adjoint operator; this is Stone’s theorem:
Theorem 357 (Stone). Let (Ut)t∈R be a strongly continuous one-parameter uni-
tary group on L2(Rn) (or, on an arbitrary Hilbert space). Then the inﬁnitesimal
generator
A = −i lim
∆t→0
U∆tψ −ψ
∆t
(15.14)
is self-adjoint; in particular it is closed and densely deﬁned. The domain DA con-
sists of all ψ ∈L2(Rn) for which the limit (15.14) exists, and is invariant under
the action of each Ut.
For self-contained proofs of Stone’s theorem we refer to Abraham et al. [1],
pp. 529–536 or to Reed and Simon [136], §VIII.4.
15.2.3
Application to Schr¨odinger’s equation
Let us now apply Stone’s theorem to Schr¨odinger’s equation. We will call a non-
zero element ψ0 of L2(Rn) a “quantum state”. We assume that the time-evolution
of quantum states is determined by a strongly continuous one-parameter group of
operators (Ut)t∈R (“evolution group”). That is, the state at time t is ψt = Utψ0

15.2.
The general case
257
where the operators Ut satisfy UtUt′ = Ut+t′ and the map ψ0 −→ψt is continuous
for every ψ0. Stone’s theorem tells us that the operator

H = iℏd
dtUtΨ0

t=0
= iℏlim
∆t→0
U∆tΨ0 −Ψ0
∆t
(15.15)
exists, is self-adjoint, and is densely deﬁned. We thus have
iℏdUt
dt = 
HUt.
(15.16)
This is an abstract and formal version of Schr¨odinger’s equation.
Deﬁnition 358. We will say that (Ut)t∈R is a “quantum evolution group” associated
with the Hamilton function H.
Let us now brieﬂy return to the property of the metaplectic representation
of Sp(2n, R) mentioned above. It can be summarized as follows: to every family
(St) of symplectic matrices depending smoothly on t and such that 
S0 = I we can
associate, in a unique way, a family (
St) of unitary operators on L2(Rn) belong-
ing to the metaplectic group Mp(2n, R) such that 
S0 is the identity; introducing
a rescaling constant ℏhaving the dimension of action, that family satisﬁes the
Schr¨odinger equation
iℏd
dt

St = 
H 
St
where 
H is the self-adjoint operator deﬁned by applying the Weyl rule to the
(time-dependent) Hamiltonian H of which (St) is the ﬂow. Such a Hamiltonian
always exists in view of our discussion of Banyaga’s theorem in Chapter 4. That
is, the correspondence H
Weyl
←→
H is obtained by simple inspection of the ﬂow
(φH
t ) = (St). We thus have

St = e−i 
Ht/ℏ
(generically 
H is not a bounded operator on L2(Rn) so that the exponential has
to be deﬁned using some functional calculus; see, e.g., Reed and Simon [136]
§VIII.3). We now ask whether this property has an analogue for paths in the
group Ham(2n, R) of Hamiltonian canonical transformations. Let us introduce the
following notation:
• P Ham(2n, R) is the set of all one-parameter families (φt) in Ham(2n, R)
depending smoothly on t and passing through the identity at time t = 0;
in view of Banyaga’s theorem such a family of canonical transformations is
always the ﬂow (φH
t ) of some (usually time-dependent) Hamiltonian H;
• PU(L2(Rn)) is the set of all strongly continuous one-parameter families (Ft)
of unitary operators on L2(Rn) depending smoothly on t and such that F0
is the identity operator, and having the following property: the domain of the
inﬁnitesimal generator 
H of (Ft) contains the Schwartz space S(Rn).

258
Chapter 15.
The Schr¨odinger Equation
We will use Stone’s theorem to prove the hard part of our main result:
Theorem 359. There exists a bijective correspondence
C : PU(L2(Rn)) ←→P Ham(2n, R)
(φt) ←→(Ut)
(15.17)
whose restriction to families (St) of symplectic matrices reduces to the metaplectic
representation, and which has the following symplectic covariance property: for
every (φt) in P Ham(2n, R) and for every S ∈Sp(2n, R) we have
C(SφtS−1) = (
SUt 
S−1)
(15.18)
where S is any of the two operators in Mp(2n, R) such that πMp(
S) = S. This
correspondence C is bijective and we have
iℏd
dtUt = 
HUt
(15.19)
where 
H
Weyl
←→H, the Hamiltonian function H being determined by (φt).
It is perhaps worth observing that it is always preferable to take the family
(Ut) as the fundamental object, rather than 
H (and hence Schr¨odinger’s equation).
This was already remarked by Weyl who noticed that (Ft) is everywhere deﬁned
and consists of bounded operators, while 
H is generically unbounded and only
densely deﬁned (see the discussion in Mackey [121] for a discussion of related
questions).
Let us begin with derivation of Schr¨odinger’s equation in the case where (φt)
is the Hamiltonian ﬂow determined by a time-independent Hamiltonian function
H = H(z). Then (φt) = (φH
t ) is a one-parameter group of symplectomorphisms:
that is φH
t φH
t′ = φH
t+t′. We thus want to associate to (φH
t ) a strongly continuous
one-parameter group (Ft) = (F H
t ) of unitary operators on L2(Rn) satisfying some
additional conditions. We proceed as follows: let 
H be the operator associated to H
by the Weyl correspondence: 
H
Weyl
←→H and deﬁne C(φH
t ) = (Ut) by Ut = e−it 
H/ℏ.
The Weyl operator 
H is self-adjoint and its domain obviously contains S(Rn). Let
us show that the covariance property (15.18) holds. We have
C(SφH
t S−1) = C(φH◦S−1
t
)
in view of formula (1.7), that is, by deﬁnition of C,
C(SφH
t S−1) = (e−i
ℏt 
H◦S−1).
In view of the symplectic covariance property a ◦S−1 Weyl
←→S 
AS−1 of Weyl oper-
ators we have

H ◦S−1 = S 
HS−1, and hence
C(SφH
t S−1) = (e−i
ℏtS 
HS−1) = (Se−i
ℏt 
HS−1)
which is property (15.18).

15.2.
The general case
259
Let conversely (Ft) be in PU(L2(Rn)); we must show that we can ﬁnd a
unique (φt) in P Ham(2n, R) such that C(φt) = (Ut). By Stone’s theorem and our
deﬁnition of PU(L2(Rn)) there exists a unique self-adjoint operator A, densely
deﬁned, and whose domain contains S(Rn). Thus A is continuous on S(Rn) and
for each value of the parameter τ there exists an observable a such that A ←→aτ.
Choose τ = 1
2; then A = 
H
Weyl
←→H for some function H = H(x, p) and we have
C(φH
t ) = (Ut).
There remains to show that the correspondence C restricts to the metaplectic
representation for semigroups (φt) = (St) in Sp(2n, R); but this is clear since (St)
is generated, as a ﬂow, by a quadratic Hamiltonian, and the unitary one-parameter
group of operators determined by such a function precisely consists of metaplectic
operators.
We now no longer assume that (φt) and (Ft) are one-parameter groups. Recall
that we have reduced the study of a time-dependent Hamiltonian H = H(z, t) by
introducing
H(x, p, t, E) = H(x, p, t) −E
(15.20)
which is a time-independent Hamiltonian on (Rn+1 ⊕Rn+1) ≡R2n × RE × Rt
where E is viewed as a conjugate variable to t. The ﬂow (φH
t ) = (φ 
H
t ) on R2n+2
generated by H is related to the time-dependent ﬂow (φH
t,t′) by the formula
φH
t (z′, t′, E′) = (φH
t,t′(z′), t + t′, Et,t′)
(15.21)
where Et,t′ −E′ is the variation of the energy in the time interval [t′, t]. The
advantage of this reformulation of the dynamics associated with H is that (φH
t ) is
a one-parameter group of canonical transformations of R2n+2. In the operator case
we can proceed in a quite similar way, noting that the Weyl operator associated
with H is given by

H = 
H −iℏ∂
∂t.
Of course 
H is self-adjoint if and only if 
H is, which is the case since H is real.
We will need the following elementary fact, which is a variant of the method of
separation of variables:
Lemma 360. Let E be an arbitrary real number. The function
Ψ(x, t; t′) = ψ(x, t)e
i
ℏE(t−t′)
(15.22)
is a solution of the extended Schr¨odinger equation
iℏ∂Ψ
∂t′ = 
HΨ
(15.23)
if and only if ψ = ψ(x, t) is a solution of the usual Schr¨odinger equation
iℏ∂ψ
∂t = 
Hψ.
(15.24)

260
Chapter 15.
The Schr¨odinger Equation
Proof. We ﬁrst note the obvious identity
iℏ∂Ψ
∂t′ = EΨ.
(15.25)
Writing for short 
H(t) = 
H(x, −iℏ∇x, t) we have, after a few calculations


H(t) −iℏ∂
∂t

Ψ =


H(t)ψ −iℏ∂ψ
∂t

e
i
ℏE(t−t′) + EΨ
(15.26)
hence (15.23) is equivalent to (15.24) in view of (15.25).
□
This result shows the following: choose an initial function ψ0 = ψ0(x) at time
t = 0 and solve the usual Schr¨odinger equation (15.24), which yields the solution
ψ = ψ(x, t). Then Ψ = Ψ(x, t; t′) deﬁned by (15.22) is the solution of the extended
Schr¨odinger equation (15.23) with initial datum Ψ(x, t; t) = ψ(x, t) at time t′ = t.
In terms of ﬂows we can rewrite this as
Ft′−t(Ftψ0) = (Ftψ0)e
i
ℏE(t−t′).

Chapter 16
The Feichtinger Algebra
We are now going to address a ﬁrst topic from the theory of modulation spaces,
which was initiated by Feichtinger in the early 1980’s: the Feichtinger algebra
S0(Rn) (we will study the general notion of modulation space in the next chap-
ter). The elements of S0(Rn) are characterized by the property that their Wigner
transform is in L1(Rn ⊕Rn), but it is not obvious at all that, with this deﬁni-
tion, S0(Rn) is a vector space, even less an algebra! We will therefore need an
alternative, more tractable, equivalent deﬁnition.
The Feichtinger algebra S0(Rn) contains continuous non-diﬀerentiable func-
tions, such as
ψ(x) =
 1 −|x| if |x| ≤1
0 if |x| > 1
and it is thus a good substitute for the Schwartz space S(Rn) as long as one is
not interested in diﬀerentiation properties. It is moreover the smallest Banach
space containing S(Rn) and being invariant under the action of the inhomoge-
neous metaplectic group. The dual space S′
0(Rn) of S0(Rn) contains many basic
distributions such as the Dirac distribution δ or its translates. These properties,
together with the fact that Banach spaces are mathematically easier to deal with
than Fr´echet spaces, makes the Feichtinger algebra into a tool of choice not only
for the study of wavepackets, but also of global regularity properties for quan-
tum mechanical operators. Of a particular interest for the study of the continuous
spectrum of such operators is the fact that (S0(Rn), L2(Rn), S′
0(Rn)) is a Gelfand
triple.
16.1
Deﬁnition and ﬁrst properties
We begin by introducing some technical tools. Recall from Chapter 9 (formulas
(9.32) and (9.33)) that the short-time Fourier transform
Vφψ(z) =
	
Rn e−2πip·x′ψ(x′)φ(x′ −x)dx′
(16.1)
261
M.A. de Gosson, Symplectic Methods in Harmonic Analysis and in Mathematical Physics,  
Pseudo-Differential Operators 7, DOI 10.1007/978-3-7643-9992-4_
, © Springer Basel AG 2011 
16

262
Chapter 16.
The Feichtinger Algebra
and is related to the cross-Wigner transform by the formula
W(ψ, φ)(z) =
 2
πℏ
n/2 e
2i
ℏp·xVφ∨
√
2πℏψ√
2πℏ

z
&
2
πℏ

(16.2)
where ψ√
2πℏ(x) = ψ(x
√
2πℏ) and φ∨(x) = φ(−x); equivalently
Vφψ(z) =
 2
πℏ
−n/2 e−iπp·xW(ψ1/
√
2πℏ, φ∨
1/
√
2πℏ)

z
&
πℏ
2

.
(16.3)
16.1.1
Deﬁnition of S0(Rn)
Let us give a ﬁrst deﬁnition of the Feichtinger algebra. In what follows φ will be
a non-zero element of S(Rn); we will call φ a “window”.
Deﬁnition 361. The Feichtinger algebra S0(Rn) (often also denoted by M 1(Rn))
consists of all ψ ∈S′(Rn) such that Vφψ ∈L1(Rn ⊕Rn) for every window φ. The
number
∥ψ∥φ,S0(Rn) = ∥Vφψ∥L1(R2n) =
	
R2n |Vφψ(z)|dz
(16.4)
is called the STFT norm of ψ relative to the window φ.
The notation M 1(Rn) is used in the context of modulation spaces, of which
the Feichtinger algebra is a particular case. The more general modulation spaces
M q(Rn) and their weighted variants M q
v(Rn) will be discussed in the next chapter.
The reader is encouraged to verify the following property:
Exercise 362. Show that ∥· ∥φ,S0 indeed is a norm on S0(Rn) for each φ ∈S(Rn),
φ ̸= 0.
There are several seemingly obscure points in the deﬁnition above. First,
while it is obvious that S0(Rn) is a vector space (because of the linearity of the
mapping ψ →Vφψ) it is much less obvious why it should be an algebra. We will
see that S0(Rn) is actually an algebra for both pointwise multiplication and for
the convolution product. Perhaps an apparently more serious shortcoming of the
deﬁnition above is the fact that the Feichtinger algebra seems to be deﬁned in
terms of inﬁnitely many “windows” φ. We are going to see that it actually suﬃces
that Vφψ ∈L1(Rn ⊕Rn) for one window! Let us ﬁrst rewrite Deﬁnition 361 in
terms of the cross-Wigner transform:
Deﬁnition 363. The Feichtinger algebra S0(Rn) consists of all ψ ∈S′(Rn) such
that W(ψ, φ) ∈L1(Rn ⊕Rn) for every window φ. The number
∥ψ∥ℏ
φ,S0(Rn) = ∥W(ψ, φ)∥L1(R2n) =
	
R2n |W(ψ, φ)(z)|dz
(16.5)
is called the Wigner norm of ψ relative to the window φ.

16.1.
Deﬁnition and ﬁrst properties
263
Let us verify that both Deﬁnitions 361 and 363 are equivalent. In view of
formula (9.32) relating the cross-Wigner transform and the STFT the condition
W(ψ, φ) ∈L1(Rn) is equivalent to
	
R2n |Vφ∨
√
2πℏψ√
2πℏ(z
&
2
πℏ)|dz < ∞
that is, performing the change of variables z −→

πℏ/2z, to
	
R2n |Vφ∨
√
2πℏψ√
2πℏ(z)|dz < ∞.
In view of the equality (9.31) in Lemma 178 this inequality can be rewritten as
		
Rn×Rn |Vφ∨ψ(x
√
2πℏ, p/
√
2πℏ)|dpdx < ∞
that is, setting x′ = x
√
2πℏand p′ = p/
√
2πℏ, Vφ∨ψ ∈L1(Rn) which is equivalent
to ψ ∈S0(Rn), since φ and hence φ∨is arbitrary.
16.1.2
First properties of S0(Rn)
The main result of this section is the following:
Proposition 364. Let ψ ∈S′(Rn) and (φ, φ′) be a pair of windows.
(i) Let γ ∈S(Rn) be such that (γ|φ)L2(Rn) ̸= 0. We have
∥ψ∥ℏ
φ′,S0(Rn) ≤
2n
(γ|φ)L2 ∥ψ∥ℏ
φ,S0(Rn)∥γ∥ℏ
φ′∨,S0(Rn)
(16.6)
with φ′∨(x) = φ′(−x);
(ii) We have ψ ∈S0(Rn) if and only if there exists one window φ such that
W(ψ, φ) ∈L1(Rn ⊕Rn), hence we have W(ψ, φ) ∈L1(Rn ⊕Rn) for all
windows φ;
(iii) The Wigner norms ∥· ∥ℏ
φ,S0(Rn) (resp. the STFT norms ∥· ∥φ,S0(Rn)) are all
equivalent when φ ranges over S(Rn).
Proof. Property (ii) follows from property (i): suppose there exists a window φ
such that ∥ψ∥ℏ
φ,S0 < ∞. Choose now an arbitrary window φ′ and γ ∈S(Rn) such
that (γ|φ)L2 ̸= 0. We then have ∥ψ∥ℏ
φ′,S0 < ∞in view of the inequality (16.6). Let
us prove (i). Recall that we can express ψ in terms of W(ψ, φ) using the inversion
formula (9.51):
ψ(x) =
2n
(γ|φ)L2
	
R2n W(ψ, φ)(z0) 
TGR(z0)γ(x)dz0.
(16.7)

264
Chapter 16.
The Feichtinger Algebra
Let z′ ∈R2n and apply 
TGR(z′) to both sides of this equality; in view of the
product formula (8.37) we have

TGR(z′)ψ(x) =
2n
(γ|φ)L2
	
R2n W(ψ, φ)(z)e
2i
ℏσ(z,z′) 
T(2z −2z′)γ(x)dz.
We now observe that by Deﬁnition (9.11) of the cross-Wigner transform we have
( 
TGR(z′)ψ|φ′) = (πℏ)n W(ψ, φ′)(z′)
and by Deﬁnition (9.1) of the cross-ambiguity function
( 
T(2z −2z′)γ|φ′)L2 = (2πℏ)n A(γ, φ′)(2z′ −2z)
= (πℏ)n W(γ, φ′∨)(z′ −z)
where the second equality follows from formula (9.27) relating cross-ambiguity and
cross-Wigner transforms. Formula (16.7) above thus yields
W(ψ, φ′)(z′) =
2n
(γ|φ)L2
	
R2n W(ψ, φ)(z)e
2i
ℏσ(z,z′)nW(γ, φ′∨)(z′ −z)dz
and hence
|W(ψ, φ′)(z′)| ≤
2n
|(γ|φ)L2|
	
R2n |W(ψ, φ)(z)| |W(γ, φ′∨)(z′ −z)|dz
that is
|W(ψ, φ′)| ≤
2n
|(γ|φ)L2||W(ψ, φ)| ∗|W(γ, φ′∨)|.
(16.8)
Integrating both sides of this inequality with respect to z yields (16.6) in view of
the classical inequality ∥F ∗G∥L1 ≤∥F∥L1∥G∥L1 that is valid for any integrable
functions F and G. (iii) That the norms ∥· ∥ℏ
φ,S0 are equivalent is clear from the
inequality (16.6); we leave it to the reader to show that the same is true of the
norms ∥· ∥φ,S0.
□
The following result shows that the “windows” used in the deﬁnition of
S0(Rn) can themselves be chosen in S0(Rn).
Proposition 365. Let both ψ and φ be in L2(Rn).
(i) If W(ψ, φ) ∈L1(Rn ⊕Rn) then both ψ and φ are in S0(Rn);
(ii) We have ψ ∈S0(Rn) if and only if W(ψ, φ) ∈L1(Rn ⊕Rn) for one (and
hence every) φ ∈S0(Rn).
Proof. Property (ii) immediately follows from (i). Let us prove property (i). The
condition that ψ, φ ∈L2(Rn) implies that W(ψ, φ) is a square-integrable and
continuous function (Proposition 183). Recall that in the course of the proof of
Proposition 364 we proved the inequality (16.8).

16.1.
Deﬁnition and ﬁrst properties
265
Choosing γ = φ′∨this inequality becomes
|W(ψ, φ′)| ≤
2n
|(γ|φ)L2||W(ψ, φ)| ∗|Wφ′∨|
hence, integrating both sides,
∥ψ∥ℏ
φ′,S0(Rn) ≤
2n
|(γ|φ)L2|∥W(ψ, φ)∥L1∥Wφ′∨∥∞< ∞
which shows that ψ ∈S0(Rn). Swapping ψ and φ the inequality above becomes
∥φ∥ℏ
φ′,S0(Rn) ≤
2n
|(γ|φ)L2|∥W(φ, ψ)∥L1∥W(φ′∨)∥∞< ∞
hence we also have φ ∈S0(Rn).
□
It immediately follows that:
Corollary 366. A function ψ ∈L2(Rn) belongs to S0(Rn) if and only if Wψ ∈
L1(Rn ⊕Rn).
Proof. In view of the statement (i) in Proposition 367 the condition Wψ ∈L1(Rn⊕
Rn) implies that ψ ∈S0(Rn). If conversely ψ ∈S0(Rn) then Wψ ∈L1(Rn ⊕Rn)
in view of the statement (ii) in the same Proposition.
□
Note that the condition Wψ ∈L1(Rn ⊕Rn) could be taken as the deﬁnition
of S0(Rn) but then it would not be clear at all that S0(Rn) is a vector space!
The following result shows that S0(Rn) is a subspace of several “nice” spaces
of functions (in particular S0(Rn) consists of continuous integrable functions):
Proposition 367. We have the inclusions
S0(Rn) ⊂C0(Rn) ∩L1(Rn) ∩F(L1(Rn))
(16.9)
where F(L1(Rn)) is the image of L1(Rn) by the Fourier transform.
Proof. Recall again the inversion formula
ψ(x) =
2n
(γ|φ)L2
	
R2n W(ψ, φ)(z0) 
TGR(z0)γ(x)dz0
valid for all γ ∈S(Rn) such that (γ|φ)L2 ̸= 0. Putting ∆ψ = ψ(x + ∆x) −ψ(x)
we have
|∆ψ| ≤
2n
|(γ|φ)L2|
	
R2n |W(ψ, φ)(z0)| | 
TGR(z0)(γ(x + ∆x) −γ(x))|dz0
≤
2n
|(γ|φ)L2|∥W(ψ, φ)∥L1 sup
z0
| 
TGR(z0)(γ(x + ∆x) −γ(x))|
=
2n
|(γ|φ)L2|∥W(ψ, φ)∥L1 sup
x0
|(γ(2x0 −x −∆x) −γ(2x0 −x))|

266
Chapter 16.
The Feichtinger Algebra
where the last equality follows from the deﬁnition of 
TGR(z),from which readily
follows that lim∆x→0 ∆ψ = 0; hence S0(Rn) ⊂C0(Rn). Let us next show that
S0(Rn) ⊂L1(Rn). Let ψ ∈S0(Rn). Using again the inversion formula we get,
|ψ(x)| ≤
2n
|(γ|φ)L2|
	
R2n |W(ψ, φ)(z0)| |γ(2x0 −x)|dz0
≤
2n
|(γ|φ)L2|
	
R2n |W(ψ, φ)(z0)| |γ(2x0 −x)|dz0
and hence, integrating in x,
∥ψ∥L1 ≤
2n
(γ|φ)L2 ∥ψ∥ℏ
φ,S0∥γ∥L∞< ∞
so that ψ ∈S0(Rn). To prove that S0(Rn) ⊂F(L1(Rn)) it suﬃces to note that
S0(Rn) is invariant under Fourier transform: we have ψ ∈S0(Rn) if and only
if W(ψ, F −1φ) ∈L1(Rn ⊕Rn) for every window φ since F is an automorphism
S(Rn) −→S(Rn). Now,
W(F −1ψ, F −1φ)(z) = W(ψ, φ)(Jz) = W(ψ, φ)(p, −x)
in view of the symplectic covariance property (10.26) of the cross-Wigner trans-
form. It follows from the inclusion S0(Rn) ⊂L1(Rn) that we have F −1ψ ∈L1(Rn)
and hence ψ ∈F(L1(Rn)) as claimed.
□
16.2
Invariance and Banach algebra properties
We are going to see that the Feichtinger algebra is a Banach algebra; in addition
we will prove that this algebra is invariant under the action of the metaplectic
group, and that it enjoys a characteristic minimality property for the action of the
Heisenberg–Weyl operators.
16.2.1
Metaplectic invariance of the Feichtinger algebra
Another very nice property is that S0(Rn) is closed under the action of the inho-
mogeneous metaplectic group:
Proposition 368. Let ψ ∈S0(Rn), 
S ∈Mp(2n, R), and z0 ∈Rn. We have
(i) 
Sψ ∈S0(Rn);
(ii) 
T (z0)ψ ∈S0(Rn);
(iii) In particular ψ ∈S0(Rn) if and only if Fψ ∈S0(Rn).

16.2.
Invariance and Banach algebra properties
267
Proof. We have ψ ∈S0(Rn) if and only if Wψ ∈L1(Rn). In view of the symplectic
covariance property W(
Sψ)(z) = Wψ(S−1z) (see (10.27)) of the Wigner function
we have W(
Sψ)(z) = Wψ(S−1z) where S ∈Sp(2n, R) is the projection of 
S. Now,
	
R2n |Wψ(S−1z)|dz =
	
R2n |W(
Sψ)(z)|dz
(because det S = 1) and hence W(
Sψ) ∈L1(Rn) if and only if Wψ ∈L1(Rn). On
the other hand
W( 
T(z0)ψ, φ) = e
i
ℏσ(z,z0)W(ψ, φ)(z −1
2z0)
in view of formula (9.25) hence, for every window φ ∈S(Rn),
	
R2n |W( 
T (z0)ψ, φ)(z)|dz =
	
R2n |Wψ(z −1
2z0)|dz
=
	
R2n |Wψ(z)|dz
so that W( 
T (z0)ψ) ∈S0(Rn) if and only if Wψ ∈L1(Rn). The statement (iii)
follows from the fact that the Fourier transform F is related to the generator 
J of
Mp(2n, R) by the formula F = in/2 
J.
□
Corollary 369. A function ψ ∈S0(Rn) is bounded and we have limz→∞ψ = 0.
Proof. Since ψ is continuous it suﬃces to prove that limz→∞ψ = 0. Since S0(Rn)
is invariant by Fourier transform, we have F −1ψ ∈S0(Rn); now S0(Rn) ⊂L1(Rn)
hence ψ = F(F −1ψ) has limit 0 at inﬁnity in view of Riemann–Lebesgue’s lemma.
□
As we have seen the topology deﬁned on S0(Rn) using the Wigner norm
∥ψ∥ℏ
φ,S0(Rn) = ∥W(ψ, φ)∥L1(Rn)
is independent of the choice of window φ. Let us prove that the normed space
S0(Rn) is complete.
Proposition 370. The Feichtinger algebra S0(Rn) has the following properties:
(i) It is a Banach space for the Wigner norm ∥· ∥ℏ
φ,S0 (resp. the STFT norm,
∥· ∥φ,S0).
(ii) The Schwartz space S(Rn) is dense in S0(Rn).
Proof of (i). We sketch the proof, and refer to [82], Theorem 11.3.5 for the tech-
nical details, replacing the STFT by the cross-Wigner transform. Let (ψj) be
a Cauchy sequence in S0(Rn); then (Ψj) = (W(ψj, φ)) is a Cauchy sequence

268
Chapter 16.
The Feichtinger Algebra
in L1(Rn ⊕Rn). The space L1(Rn ⊕Rn) being complete, there exists Ψ ∈L1(Rn ⊕
Rn) such that
lim
j→∞∥Ψ −W(ψj, φ)∥L1 = 0.
Deﬁning ψ by the formula
ψ(x) =
2n
∥φ∥L2
	
R2n Ψ(z) 
TGR(z)φ(x)dz
(16.10)
(cf. inversion formula (9.51) ) one then shows that ψ ∈S0(Rn) and
∥ψ −ψj∥ℏ
φ,S0 = lim
j→∞∥W(ψ −ψj, φ)∥L1
= lim
j→∞∥Ψ −W(ψj, φ)∥L1 = 0
hence S0(Rn) is complete as claimed.
Proof of (ii). Let us ﬁrst show that S(Rn) ⊂S0(Rn). Let ψ ∈S(Rn); for every
window φ we have W(ψ, φ) ∈S(Rn ⊕Rn) hence for every N > 0 there exists
CN > 0 such that
|W(ψ, φ)(z)| ≤CN(1 + |z|)−N.
It follows, by deﬁnition of the norm ∥· ∥ℏ
φ,S0 that
∥ψ∥ℏ
φ,S0 ≤CN
	
R2n(1 + |z|)−Ndz
and hence ∥ψ∥ℏ
φ,S0 < ∞if we choose N > 2n. We defer the proof of the density
since it will be proven in a more general setting in next chapter (Proposition
399).
□
16.2.2
The algebra property of S0(Rn)
We begin by proving the following result which is interesting by itself:
Proposition 371. Suppose that ψ ∈L1(Rn) and ψ′ ∈S0(Rn). Then ψ∗ψ′ ∈S0(Rn)
and we have
∥ψ ∗ψ′∥ℏ
φ,S0(Rn) ≤∥ψ∥L1(Rn)∥ψ′∥ℏ
φ,S0(Rn)
(16.11)
for every window φ ∈S(Rn). Thus, if ψ ∈L1(Rn) and ψ′ ∈S0 then ψ ∗ψ′ ∈
S0(Rn):
L1(Rn) ∗S0(Rn) ⊂S0(Rn).
Proof. We begin by rewriting the cross-Wigner transform using Deﬁnition (9.11)
that is
W(ψ, φ)(z) =
 1
πℏ
n ( 
TGR(z)ψ|φ)L2,

16.2.
Invariance and Banach algebra properties
269
where 
TGR(z0) is the Grossmann–Royer operator. This yields the formula
W(ψ, φ)(z0) =
 1
πℏ
n e−2i
ℏp0·x0
	
Rn ψ(2x0 −x)φp0(x)dx
with φp0(x) = e
2i
ℏp0·xφ(x), that is
W(ψ, φ)(z0) =
 1
πℏ
n e−2i
ℏp0·x0ψ ∗φp0(2x0).
(16.12)
It follows, in particular, that
∥ψ∥ℏ
φ,S0 =

1
2πℏ
n 	
Rn ∥ψ ∗φp0∥L1dp0.
(16.13)
Formula (16.12) now shows that
W(ψ ∗ψ′, φ)(z0) =
 1
πℏ
n e−2i
ℏp0·x0ψ ∗ψ′ ∗φp0(2x0)
and hence, by (16.13),
∥ψ ∗ψ′∥ℏ
φ,S0 =

1
2πℏ
n 	
Rn ∥ψ ∗(ψ′ ∗φp0)∥L1dp0.
Since L1(Rn) is a convolution algebra we have
∥ψ ∗(ψ′ ∗φp0)∥L1 ≤∥ψ∥L1∥ψ′ ∗φp0∥L1;
we obtain the inequality
∥ψ ∗ψ′∥ℏ
φ,S0 ≤

1
2πℏ
n ∥ψ∥L1
	
Rn ∥ψ′ ∗φp0∥L1dp0
that is, using again (16.13),
∥ψ ∗ψ′∥ℏ
φ,S0 ≤∥ψ∥L1∥ψ∥ℏ
φ,S0
which we set out to prove.
□
The following result motivates the denomination “Feichtinger algebra”:
Corollary 372. The Banach space S0(Rn) is an algebra for both pointwise mul-
tiplication and convolution: if ψ and ψ′ are in S0(Rn) then ψψ′ ∈S0(Rn) and
ψ ∗ψ′ ∈S0(Rn).
Proof. Since ψψ′ and ψ ∗ψ′ are interchangeable by the Fourier transform F, and
S0(Rn) is invariant under F in view of Proposition 368(iii), it is suﬃcient to show
that ψ ∗ψ′ ∈S0(Rn) if ψ ∈S0(Rn) and ψ′ ∈S0(Rn). But this follows from the
inequality (16.11) since S0(Rn) ⊂L1(Rn) in view of Proposition 367.
□

270
Chapter 16.
The Feichtinger Algebra
16.3
A minimality property for S0(Rn)
A remarkable property of the Feichtinger algebra is that of being the smallest
Banach space invariant under the action of the Heisenberg–Weyl operators. To
prove this we will need an alternative characterization of S0(Rn).
16.3.1
Heisenberg–Weyl expansions
Let φ ∈S0(Rn) be a window, and consider the series
ψ =
∞

k=1
ck 
T(zk)φ
(16.14)
where (ck)k is a sequence of complex numbers and (zk)k is a sequence of points in
R2n. We have
|ψ(z)| ≤
∞

k=1
|ck| |φ(z −zk)|.
We claim that the series is convergent if ∞
k=1 |ck| < ∞. In fact, since φ ∈S0(Rn) is
bounded in view of Corollary 369 there exists a constant Cφ such that |φ(z−zk)| ≤
Mφ and hence
|ψ(z)| ≤Mφ
∞

k=1
|ck| < ∞.
Deﬁnition 373. The representation (16.14) of ψ is called a “Heisenberg–Weyl ex-
pansion (or representation)” and ( 
T(zk)φ)k a “Heisenberg–Weyl frame” (in time-
frequency analysis one would rather speak of “Gabor expansions” and “Gabor
frames”).
Let us now denote by M(Rn) the set of all functions ψ that have a Heisen-
berg–Weyl expansion (16.14); clearly M(Rn) is a complex vector space under the
usual addition and multiplication by scalars. It is even a normed vector space if
one deﬁnes
∥ψ∥M(Rn) = inf
/ ∞

k=1
|ck| < ∞: ψ =
∞

k=1
ck 
T(zk)φ
0
.
It turns out that M(Rn) is identical with S0(Rn):
Proposition 374. We have M(Rn) = S0(Rn) and there exists a constant Cφ > 0
such that
1
Cφ
∥ψ∥ℏ
φ,S0(Rn) ≤∥ψ∥M(Rn) ≤Cφ∥ψ∥ℏ
φ,S0(Rn)
hence the norms ∥· ∥M(Rn) and ∥· ∥ℏ
φ,S0(Rn) are equivalent.

16.4.
A Banach Gelfand triple
271
Proof. We omit the proof. See Gr¨ochenig [82], Theorem 12.1.8, which is itself based
on the paper by Bonsall [17].
□
This result shows that every ψ ∈S0(Rn) can be represented in a Heisenberg–
Weyl frame by an absolutely convergent series (16.14).
16.3.2
The minimality property
We are going to prove that Feichtinger’s algebra is the smallest Banach algebra in
S′(Rn) which is invariant under the Heisenberg–Weyl operators.
Proposition 375. Let (B(Rn), ∥·∥B) be a Banach algebra of tempered distributions
on Rn. Suppose that B(Rn) satisﬁes the two following conditions:
(i) there exists C > 0 such that ∥
T(z)ψ∥≤C∥ψ∥for all z ∈R2n and ψ ∈B(Rn);
(ii) S0(Rn) ∩B ̸= {0}. Then S0(Rn) is continuously embedded in B(Rn) and
S0(Rn) is the smallest algebra having this property.
Proof. We are following Gr¨ochenig [82]. Let φ ∈S0(Rn) ∩B(Rn), φ ̸= 0. In view
of Proposition 374 the space S0(Rn) consists of all Heisenberg–Weyl expansions
ψ =
∞

k=1
ck 
T(zk)φ ,
∞

k=1
|ck| < ∞.
Thus,
∥ψ∥B ≤
∞

k=1
|ck|∥
T(zk)φ∥B ≤C
$ ∞

k=1
|ck|
%
∥φ∥B < ∞
and hence ψ ∈S0(Rn) so that S0(Rn) ⊂B(Rn). Let us show that this embedding
is continuous. taking the inﬁmum of the right-hand side of the inequality
∥ψ∥B ≤C
$ ∞

k=1
|ck|
%
∥φ∥B
for all Heisenberg–Weyl expansions of ψ we get
∥ψ∥B ≤C∥ψ∥S0∥φ∥B
which proves the statement.
□
16.4
A Banach Gelfand triple
Dirac already emphasized in his fundamental work [37] the relevance of rigged
Hilbert spaces for quantum mechanics1. Later Schwartz provided an instance of
1In quantum mechanics, to rig a Hilbert space means simply to equip that Hilbert space with
distribution theory [122].

272
Chapter 16.
The Feichtinger Algebra
rigged Hilbert spaces based on his class of test functions and on tempered dis-
tributions. Later Gelfand and Shilov formalized the construction of Schwartz and
Dirac and introduced what is nowadays known as Gelfand triples. It has been
known for several decades that Dirac’s bra-ket formalism is mathematically jus-
tiﬁed not by the Hilbert space alone, but by the use of Gelfand triples; see de la
Madrid [122] (among other things we learn from that paper that the terminol-
ogy “rigged Hilbert space” is a direct translation of the phrase “osnashchyonnoe
Hilbertovo prostranstvo” from the original Russian). The prototypical example of
a Gelfand triple is
(S(Rn), L2(Rn), S′(Rn)).
In this section we will study the particular very interesting Gelfand triple
(S0(Rn), L2(Rn), S′
0(Rn))
whose properties are very interesting both from a theoretical and practical point
of view. For a very nice review of the topic with many historical remarks see the
contribution of Feichtinger et al. in [55].
16.4.1
The dual space S′
0(Rn)
Let us denote by S′
0(Rn) the dual Banach space of S0(Rn). It is the space of all
bounded linear functionals on S0(Rn). Since S0(Rn) is the smallest Banach space
isometrically invariant under the action of the aﬃne metaplectic group (and hence
under the Heisenberg–Weyl operators) its dual is essentially the largest space of
distributions with this property.
The following result characterizes S′
0(Rn):
Proposition 376. The Banach space S′
0(Rn) consists of all ψ ∈S′(Rn) such that
W(ψ, φ) ∈L∞(Rn ⊕Rn) for one (and hence all) window φ ∈S0(Rn); the duality
bracket is given by the pairing
(ψ, ψ′) =
	
R2n W(ψ, φ)(z)W(ψ′, φ)(z)dz
(16.15)
and the formula
∥ψ∥ℏ
φ,S′
0(Rn) = sup
z∈R2n |W(ψ, φ)(z)|
(16.16)
deﬁnes a norm on S′
0(Rn).
Proof. It is based on the fact that L∞(Rn ⊕Rn) is the dual space of L1(Rn ⊕Rn);
see [82], §11.3.
□
It readily follows from this characterization that:
Proposition 377. The Dirac distribution δ is in S′
0(Rn); more generally δa ∈
S′
0(Rn) where δa(x) = δ(x −a).

16.4.
A Banach Gelfand triple
273
Proof. We have
W(δ, φ)(z0) =
 1
πℏ
n ⟨
TGR(z0)δ, φ⟩
(formula (9.12)) and

TGR(z0)δ(x) = e
2i
ℏp0·(x−x0)δ(2x0 −x) = e
2i
ℏp0·x0δ(2x0 −x).
It follows that
W(δ, φ)(z0) =
 1
πℏ
n e
2i
ℏp0·x0φ(2x0)
and hence |W(δ, φ)(z0)| ≤
 1
πℏ
n ∥φ∥∞. It follows that δ ∈S′
0(Rn). That we also
have δa ∈S′
0(Rn) is proven by a similar argument (alternatively one can use
formula (9.25) in Proposition 174). One can show that, more generally, the “Dirac
comb” 
a∈Zn δa belongs to S′
0(Rn).
□
16.4.2
The Gelfand triple (S0, L2, S′
0)
Let us begin by deﬁning rigorously the notion of Banach Gelfand triple (also called
rigged, or nested, spaces):
Deﬁnition 378. A (Banach) Gelfand triple (B, H, B′) consists of a Banach space
B which is continuously and densely embedded into a Hilbert space H, which in
turn is w∗-continuously and densely embedded into the dual Banach space B′.
In this deﬁnition one identiﬁes H with its dual H∗and the scalar product on
H thus extends in a natural way into a pairing between B ⊂H and B′ ⊃H.
The use of the Gelfand triple (S0(Rn), L2(Rn), S′
0(Rn)) not only oﬀers a
better description of self-adjoint operators but it also allows a simpliﬁcation of
many proofs. Here is a typical situation, that will be slightly extended in Chapter
18, Subsection 19.1.2. Given a Gelfand triple (B, H, B′) one proves that every self-
adjoint operator A : B −→B has a complete family of generalized eigenvalues
(ψα)α = {ψα ∈B′ : α ∈A} (A an index set), deﬁned as follows: for every α ∈A
there exists λα ∈C such that
(ψα, Aφ) = λα(ψα, φ) for every φ ∈B.
Completeness of the family (ψα)α means that there exists at least one ψα such
that (ψα, φ) ̸= 0 for every φ ∈B. A basic example, in the case n = 1, is the
operator 
x of multiplication by x. This operator has no eigenfunctions in L2(R),
but since 
xδa(x) = xδ(x −a) = aδa(x) every a ∈R is a generalized eigenvalue
(with associated eigenfunction δa ∈S′
0(R)).
Given a Gelfand triple (B, H, B′) every φ ∈B has an expansion with respect
to the generalized eigenvectors ψα which generalizes the usual expansion with
respect to a basis of eigenvectors. A classical example is the following: consider the
Gelfand triple (S0(Rn), L2(Rn), S′
0(Rn)) and choose 
A = −iℏ∂xj. The generalized

274
Chapter 16.
The Feichtinger Algebra
eigenvalues of 
A are the functions χp(x) = eip·x/ℏ(p ∈Rn) and the corresponding
expansion can be written as the Fourier inversion formula
ψ(x) =

1
2πℏ
n/2 	
Rn e
i
ℏp·xFψ(p)dp
(16.17)
(see Feichtinger et al. in [55] for a detailed discussion of the Fourier transform
within the context of the Banach Gelfand triple (S0(Rn), L2(Rn), S′
0(Rn))).
An important feature of Gelfand triples is the existence of a kernel theorem,
which is much more useful both for theoretical and practical purposes than the
usual kernel theorem of Schwartz. We denote as usual by ⟨⟨·, ·⟩⟩the distributional
bracket for distributions on Rn ⊕Rn.
Theorem 379 (Feichtinger). The following properties hold:
(i) Every linear bounded operator A : S0(Rn) −→S′
0(Rn)has a kernel KA ∈
S′
0(Rn × Rn), that is ⟨Aψ, φ⟩= ⟨⟨KA, φ ⊗ψ⟩⟩for ψ and φ in S0(Rn).
(ii) Conversely, every K ∈S′
0(Rn × Rn) deﬁnes by the formula above a bounded
operator S0(Rn) −→S′
0(Rn).
Formally we can thus write
Aψ(x) =
	
Rn K(x, y)ψ(y)dy
for some K ∈S′
0(Rn × Rn) when A : S0(Rn) −→S′
0(Rn) is a continuous operator.
This result was announced by Feichtinger in [45] and proven in [52]. See [82], §11.4
for a detailed proof, comments, and various extensions. We will see in the next
chapter that this result can be generalized to a whole class of modulation spaces.
For instance, in the example above, one can interpret the Fourier inver-
sion formula (16.17) by saying that the kernel of the inverse Fourier transform
is K(x, p) = (2πℏ)n/2 eip·x/ℏ.

Chapter 17
The Modulation Spaces M q
s
If the choice of good symbol classes is essential in any pseudo-diﬀerential calcu-
lus, so is the choice of good functional spaces between which these operators act.
These spaces must reﬂect regularity properties (in the broad sense) of the op-
erators that are used. For instance, in H¨ormander’s theory of pseudo-diﬀerential
operators a standard choice are the Sobolev spaces Hs and their variants. In Shu-
bin theory one has the global spaces Qs, where one can simultaneously control the
behavior in x and its dual variable (these are in fact already modulation spaces).
In our case, where we are interested in studying quantum mechanics in phase
space, it turns out that the best playground consists of a constellation of spaces
called the modulation spaces M q
s (Rn) = M q
vs(Rn) where 1 ≤q ≤∞and vs is
a polynomial weight. These are particular cases of the spaces M p,q
v
(Rn) whose
deﬁnition goes back to Feichtinger’s foundational papers [46, 48, 49]; for a recent
review see [50]. In addition, if one denotes by (M q
s (Rn))′ the dual of M q
s (Rn)
then (M q
s (Rn), L2(Rn), (M q
s (Rn))′) is a Gelfand triple which is a natural domain
for studying the generalized eigenvalues and eigenvectors of quantum mechanical
operators (in particular the continuous spectrum).
17.1
The Lq spaces, 1 ≤q < ∞
In order to deﬁne modulation spaces we have to introduce weighted Lq spaces.
The number of books devoted to this topic (at various levels of diﬃculty) is huge;
a limpid recent treatment is given in Chapter 6 of Folland’s textbook [60].
We begin by reviewing the Lq theory.
17.1.1
Deﬁnitions
We will assume that Rm is equipped with the Lebesgue measure dx = dx1 · · · dxm.
Let q a real number such that 1 ≤q < ∞. If f : Rm −→C is measurable we set
∥f∥q =
	
Rm |f(x)|qdx
1/q
;
275
M.A. de Gosson, Symplectic Methods in Harmonic Analysis and in Mathematical Physics,  
Pseudo-Differential Operators 7, DOI 10.1007/978-3-7643-9992-4_
, © Springer Basel AG 2011 
17

276
Chapter 17.
The Modulation Spaces M q
s
∥f∥q is thus a real number, or ∞. We will write f ∼g when f −g = 0 almost
everywhere for the measure dx. The relation ∼is an equivalence relation for all
functions Rm −→C.
Deﬁnition 380. The space Lq(Rm) consists of all ∼equivalence classes of mea-
surable functions f : Rm −→C such that ∥f∥q < ∞, equipped with the norm
f −→∥f∥q.
That Lq(Rm) indeed is a vector space is seen as follows. First, it is clear that
λf ∈Lq(Rm) if f ∈Lq(Rm), for every λ ∈C. Let now f and g be two elements
of Lq(Rm). Then
|f + g|q ≤(2 sup(f, g))q ≤2q(|f|q + |g|q)
(17.1)
(prove this!) and hence
∥f + g∥q ≤2(∥f∥q + ∥g∥q) < ∞.
(17.2)
Observe that the inequality (17.2) does not prove that ∥· ∥q is a norm:
while it is clear that ∥λf∥q = |λ| ∥f∥q and that ∥f∥q = 0 implies f = 0 (almost
everywhere), we still have to prove the Minkowski inequality
∥f + g∥q ≤∥f∥q + ∥g∥q
(17.3)
and this will require some extra work. The Minkowski inequality is actually a
consequence of the famous H¨older inequality:
Proposition 381. Let q and r be real numbers ≥1 such that 1/q + 1/r = 1. We
have
∥fg∥1 ≤∥f∥q∥g∥r
(17.4)
for all f ∈Lq(Rm) and g ∈Lr(Rm).
Proof. We are going to use the elementary inequality
qrab ≤raq + qbr
(17.5)
(which is a generalization of the trivial inequality 2ab ≤a2 +b2), valid for all non-
negative a, b when 1/q + 1/r = 1. Choosing a = |f(x)|, b = |g(x)| this inequality
becomes
qr|f(x)| |g(x)| ≤r|f(x)|q + q|g(x)|r
and hence, integrating,
qr∥fg∥1 ≤r∥f∥q
q + q∥g∥r
r.
Replacing f and g by f/∥f∥q and g/∥g∥r we get
qr
∥f∥q∥g∥r
∥fg∥1 ≤r + q = 1
which yields H¨older’s inequality (17.4).
□

17.1.
The Lq spaces, 1 ≤q < ∞
277
Deﬁnition 382. We will call the numbers q and r “conjugate exponents” when
they satisfy the conditions 1/q + 1/r = 1 above.
Exercise 383. Prove the inequality (17.5); show that we have equality if and only
if a = b. [Hint: study the variations of the function k(x) = rxq + qbr −qrxb.]
Let us now prove the main result of this subsection:
Theorem 384. Let q be such that 1 ≤q < ∞. We have:
(i) The mapping f −→∥f∥q is a norm on Lq(Rm);
(ii) Lq(Rm) is a Banach space for the topology deﬁned by this norm.
Proof. (i) There remains to prove the Minkowski inequality (17.3). The result
being obvious for q = 1 or ∥f + g∥q = 0 we assume q > 1 and that ∥f + g∥q > 0.
We next note that since |f + g| ≤|f| + |g| we have
|f + g|q ≤|f| |f + g|q−1 + |g| |f + g|q−1.
Applying H¨older’s inequality to |f| |f + g|q−1 and |g| |f + g|q−1 we get:
∥(f + g)q∥1 ≤∥f∥q∥(f + g)q−1∥r + ∥g∥q∥(f + g)q−1∥r
= (∥f∥q + ∥g∥q)∥(f + g)q−1∥r.
Since r(q −1) = q we have
∥(f + g)q−1∥r =
	
Rm |f + g|r(q−1)dx
1/r
=
	
Rm |f + g|qdx
1/r
and hence
∥(f + g)q∥1 ≤(∥f∥q + ∥g∥q)∥f + g∥q/r
q
.
Now, ∥(f + g)q∥1 = ∥f + g∥q
q so that we ﬁnally have, dividing both sides by
∥f + g∥q−1
q
,
∥f + g∥q ≤(∥f∥q + ∥g∥q)∥f + g∥q/r+1−q
q
which is Minkowski’s inequality since q/r + 1 −q = 0 because q and r are con-
jugate exponents. (ii) It is suﬃcient to show that every absolutely convergent
series in Lq(Rm) is convergent. Let (fj) be a sequence in Lq(Rm) and assume that
∞
j=1 ∥fj∥q = M (M a real number). Setting Fk = k
j=1 |fj| and F = ∞
j=1 |fj|
we have
∥Fk∥q ≤
k

j=1
∥fj∥k ≤M

278
Chapter 17.
The Modulation Spaces M q
s
for all indices k, hence
	
Rm F qdx = lim
k→∞
	
Rm F q
k dx ≤M q
so that F ∈Lq(Rm). This implies that we must have F(x) < ∞almost everywhere,
and the series (k
j=1 fj)k is thus convergent almost everywhere. Let f = k
j=1 fj
be its limit; we have |f| ≤F and hence f ∈Lq(Rm). On the other hand |f −
k
j=1 fj|q ≤(2F)p and F p ∈L1(Rm) hence, using the dominated convergence
theorem,
lim
k→∞∥f −
k

j=1
fj∥q
q = lim
k→∞
	
Rm |f −
k

j=1
fj|qdx = 0.
This proves that the absolutely convergent series k
j=1 fj converges in Lq(Rm),
and we are done.
□
Another important property of the Lq spaces is the following:
Theorem 385. Let q and r be conjugate exponents, q > 1.
(i) For each Φ ∈(Lq(Rm))∗(the dual space of Lq(Rm)) there exists gΦ ∈Lr(Rm)
such that
Φ[f] =
	
Rm fgΦdx;
(17.6)
two functions gΦ and hΦ satisfying this relation are equal almost everywhere;
(ii) The dual (Lq(Rm))∗is isometrically isomorphic to Lr(Rm).
Proof. (i) The construction of g is rather lengthy and we omit it here (see Folland
[60], §6.2). The duality property (ii) immediately follows from (17.6). Consider the
mapping Φ −→gΦ deﬁned by (17.6). In view of H¨older’s inequality (Proposition
381) we have |Φ[f]| ≤∥f∥q∥gΦ∥r showing that Φ is a continuous linear functional
on Lq(Rm) and hence an element of (Lq(Rm))∗. The proof of the converse is left
to the reader.
□
17.1.2
Weighted Lq spaces
The notion of weight plays an essential role in the theory of modulation spaces.
We begin with deﬁning the notion of weight; our deﬁnition is rather restric-
tive, but suﬃcient for our purposes. For a more general deﬁnition see [82], §11.1.
Deﬁnition 386. A weight on R2n is a real, non-negative, and locally integrable
function v : R2n −→C which is in addition sub-multiplicative: v(z+z′) ≤v(z)v(z′)
for all z, z′ in R2n.
Exercise 387. Show that an even weight v always satisﬁes v(0) ≥1.

17.1.
The Lq spaces, 1 ≤q < ∞
279
The study of weighted Lq spaces is not new, see for instance Benedik and
Panzone [12]. In particular these authors prove a more general result than the
following:
Proposition 388. The weighted spaces Lq
v(Rn ⊕Rn) have the two following prop-
erties:
(i) Lq
v(Rn ⊕Rn) is a Banach space;
(ii) Lq
v(Rn ⊕Rn) is invariant under the translations T (z0)Ψ(z) = Ψ(z −z0). In
fact:
∥T (z0)Ψ∥Lq
v ≤v(z0)∥Ψ∥Lq
v;
(17.7)
Proof of (i). Let (Ψj) be a Cauchy sequence in Lq
v(Rn ⊕Rn); then (Φj) = (vΨj)
is a Cauchy sequence in Lq(Rn ⊕Rn): this immediately follows from the equal-
ity ∥Ψj∥Lq
v = ∥vΨj∥Lq. Let Φ be its limit and set Ψ = v−1Φ. We claim that
limj→∞Ψj = Ψ in Lq
v(Rn ⊕Rn). In fact,
∥Ψj −Ψ∥Lq
v = ∥Φj −Φ∥Lq
hence limj−→∞∥Ψj −Ψ∥Lq
v = 0.
Proof of (ii). To prove that Lq
v(Rn⊕Rn) is invariant under the translation operator
T (z0) it suﬃces to use the submultiplicative property of the weight: we have, for
q < ∞,
∥T (z0)Ψ∥q
Lq
v =
	
R2n |Ψ(z −z0)|qv(z)qdz
=
	
R2n |Ψ(z)|qv(z + z0)qdz
≤v(z0)
	
R2n |Ψ(z)|qv(z)qdz.
□
For our purposes it will be suﬃcient to limit ourselves to choosing for v the
standard weight function
vs(z) = (1 + |z|2)s/2 = ⟨z⟩s .
(17.8)
Notation 389. When the weight v is given by (17.8) we will write Lq
s(Rn ⊕Rn)
instead of Lq
v(Rn ⊕Rn).
Exercise 390. Verify that the standard weight vs is submultiplicative.
Recall that for 1 ≤q < ∞the space Lq(Rn ⊕Rn) consists of all complex
functions Ψ on Rn ⊕Rn such that
∥Ψ∥Lq =
	
R2n |Ψ(z)|qdz
1/q
< ∞.
The mapping Ψ −→∥Ψ∥Lq is a norm on Lq(Rn⊕Rn) and Lq(Rn⊕Rn) is a Banach
space for the topology thus deﬁned.

280
Chapter 17.
The Modulation Spaces M q
s
Deﬁnition 391. The weighted space Lq
s(Rn⊕Rn) consists of all Ψ such that ⟨·⟩s Ψ ∈
Lq(Rn ⊕Rn) equipped with the norm ∥Ψ∥Lq
s = ∥⟨·⟩s Ψ∥Lq.
Exercise 392. Show that ∥· ∥Lq
s indeed is a norm on Lq
v(Rn ⊕Rn). [Hint: Use
Exercise 387.]
The following simple result is very useful:
Lemma 393. The weighted spaces Lq
s(Rn ⊕Rn) are invariant under linear changes
of variables: if Ψ ∈Lq
s(Rn ⊕Rn) and F ∈GL(2n, R) then Ψ ◦F ∈Lq
s(Rn ⊕Rn).
Proof. (Cf. the proof of Proposition 316). Diagonalizing F T F using an orthogonal
transformation we have
λmin|z|2 ≤|F(z)|2 ≤λmax|z|2
where λmin > 0 and λmax > 0 are the smallest and largest eigenvalues of F T F. It
follows that we have
⟨F(z)⟩s ≤max(1, λmax) ⟨z⟩s
if s ≥0, and
⟨F(z)⟩s ≤min(1, λmin) ⟨z⟩s
if s < 0.
□
We will also need the following results about convolutions:
Proposition 394. Let s ∈R.
(i) We have the estimate
∥Ψ ∗Φ∥Lq
s(R2n) ≤Cs∥Ψ∥L1s(R2n)∥Φ∥Lq
s(R2n)
(17.9)
and hence
L1
s(Rn ⊕Rn) ∗Lq
s(Rn ⊕Rn) ⊂Lq
s(Rn ⊕Rn).
(ii) If s > 2n then
∥Ψ ∗Φ∥L∞
s (R2n) ≤Cs∥Ψ∥L∞
s (R2n)∥Φ∥L∞
s (R2n)
(17.10)
and hence
L∞
s (Rn ⊕Rn) ∗L∞
s (Rn ⊕Rn) ⊂L∞
s (Rn ⊕Rn).

17.2.
The modulation spaces M q
s
281
Proof. (Cf. [82], Proposition 11.1.3). (i) Let Θ ∈Lq′
−s(Rn⊕Rn) with 1/q+1/q′ = 1.
We have, using Fubini’s theorem and the inequality (17.7),
|(Ψ ∗Φ|Θ)L2| =

		
R4n Ψ(u)Φ(z −u)Θ(u)dzdu

≤
	
R2n |Ψ(u)|
	
R2n |T (u)Φ(z)| |Θ(z)|dz

du
≤
	
R2n |Ψ(u)|∥T (u)Φ∥Lq
sdu · ∥Θ∥Lq′
−s
≤C
	
R2n |Ψ(u)| ⟨u⟩s du

∥Φ∥Lq
s∥Θ∥Lq′
−s.
By duality we have
∥Ψ ∗Φ∥Lq
s = sup
1
|(Ψ ∗Φ|Θ)L2| : ∥Θ∥Lq′
−s ≤1
2
≤Cs∥Ψ∥L1s∥Φ∥Lq
s,
hence the estimate (17.9).
(ii) Let Ψ, Φ ∈L∞
s (Rn ⊕Rn). We have
|Ψ(z)| ≤∥Ψ∥L∞
s (R2n) ⟨z⟩−s ,
|Φ(z)| ≤∥Φ∥L∞
s (R2n) ⟨z⟩−s
and hence
|Ψ ∗Φ(z)| ≤∥Ψvs∥L∞
s ∥⟨·⟩s Φ∥L∞
s
	
R2n(1 + |u|2)−s/2(1 + |z −u|2)−s/2du
where we have used the convolution inequality
⟨·⟩−s ∗⟨·⟩−s ≤Cs ⟨·⟩−s .
(17.11)
(See exercise below.) Integrating in z the estimate (17.10) follows since the integral
is absolutely convergent for s > 2n.
□
Exercise 395. Prove the convolution inequality (17.11); equivalently:
	 ∞
−∞
(1 + |t|)−s(1 + |x −t|)−sdt ≤Cs(1 + |x|)−s
(in case of emergency see [82], (11.5)).
17.2
The modulation spaces M q
s
The modulation spaces M q
s (Rn) we are going to study in this and the following
sections are in a sense rather straightforward extensions of the Feichtinger algebra
and of its its dual.

282
Chapter 17.
The Modulation Spaces M q
s
17.2.1
Deﬁnition of M q
s
Recall that the weight vs is deﬁned by
vs(z) = (1 + |z|2)s/2 = ⟨z⟩s
and that the corresponding weighted Lq spaces are denoted by Lq
s.
Deﬁnition 396. The modulation space M q
s (Rn) consists of all ψ ∈S′(Rn) such
that Vφψ ∈Lq
s(Rn ⊕Rn) for every window φ ∈S′(Rn) (where Vφψ is the STFT
transform).
The deﬁnition of M q
s (Rn) can be restated in terms of the cross-Wigner trans-
form in the same way as was done for the Feichtinger algebra:
Proposition 397. We have ψ ∈M q
s (Rn) if and only if W(ψ, φ) ∈Lq
s(Rn ⊕Rn) for
every φ ∈S(Rn).
Proof. It is, as in the Feichtinger algebra case, again based on formula (16.2)
relating the STFT Vφ to the cross-Wigner transform W(ψ, φ). Recall that we
denote by ψλ the function deﬁned by ψλ(x) = ψ(λx). We have ψ ∈M q
s (Rn) if and
only if Vφψ ∈Lq
s(Rn ⊕Rn) for every φ ∈S(Rn), that is if and only if Vφ∨
√
2πℏψ ∈
Lq
s(Rn ⊕Rn). Since, in addition, ψ ∈M q
s (Rn) if and only if ψ√
2πℏ∈M q
s (Rn), we
thus have ψ ∈M q
s (Rn) if and only if
Vφ∨
√
2πℏψ√
2πℏ∈Lq
s(Rn ⊕Rn)
or, which amounts to the same,
ψ ∈M q
s (Rn) ⇐⇒2ne
2i
ℏp·xVφ∨
√
2πℏψ√
2πℏ∈Lq
s(Rn ⊕Rn).
(17.12)
Now, a function Ψ is in Lq
s(Rn ⊕Rn) if and only if Ψλ is, as follows from the
inequality
	
R2n | ⟨z⟩s Ψ(λz)|qdz ≤λ−2nq(1 + λ−2)s/2
	
Rn | ⟨z⟩s Ψ(z)|qdz
obtained by performing the change of variable z −→λ−1z and using the trivial
estimate
(1 + |λ−1z|2)s/2 ≤(1 + λ−2)s/2(1 + |z|2)s/2
valid for all s ≥0. Combining this property (with λ =

2/πℏ) and the equivalence
(17.12) we thus have ψ ∈M q
s (Rn) if and only if Wφψ ∈Lq
s(Rn ⊕Rn).
□
We can equip the modulation space M q
s (Rn) with a family of norms deﬁned by
∥ψ∥ℏ
φ,Mq
s (Rn) = ∥W(ψ, φ)∥Lq
s(R2n) =
	
R2n |W(ψ, φ)(z)|q ⟨z⟩s dz.
(17.13)
We have deﬁned M q
s (Rn) by requiring that W(ψ, φ) ∈Lq
s(Rn ⊕Rn) for every
window φ. Not surprisingly, taking into account Proposition 364:

17.2.
The modulation spaces M q
s
283
Proposition 398. We have ψ ∈M q
s (Rn) if and only if W(ψ, φ) ∈Lq
s(Rn ⊕Rn) for
one window φ ∈S(Rn). The topology of M q
s (Rn) is deﬁned by using a single norm
∥· ∥ℏ
φ,Mq
s ; moreover all the norms obtained by letting φ vary are equivalent.
Proof. It is similar to that of Proposition 364 with a few technical modiﬁcation;
we therefore leave it to the reader.
□
The following result is the analogue of Proposition 370 where it was stated
that the Feichtinger algebra M 1(Rn) is a Banach space containing S(Rn) as a
dense subspace.
Proposition 399.
(i) The modulation space M q
s (Rn) is a Banach space for the topology deﬁned by
the norm ∥· ∥ℏ
φ,Mq
s . It is the Feichtinger algebra S0(Rn) when q = 1.
(ii) The Schwartz space S(Rn) is a dense subspace of each of the modulation
spaces M q
s (Rn) for q < ∞.
Proof of (i). See Gr¨ochenig’s book [82], Theorem 11.3.5 for a detailed proof using
the short-time Fourier transform.
Proof of (ii). Let us ﬁrst show that S(Rn) ⊂M q
s (Rn). Let ψ ∈S(Rn); for every
window φ we have W(ψ, φ) ∈S(Rn ⊕Rn) hence for every N > 0 there exists
CN > 0 such that |W(ψ, φ)(z)| ≤CN ⟨z⟩−N. It follows, by deﬁnition of the norm
∥· ∥ℏ
φ,Mq
s that
∥ψ∥ℏ
φ,Mq
s ≤Cq
N
	
Rn⊕Rn(1 + |z|2)(s−qN)/2dz
and hence ∥ψ∥ℏ
φ,Mq
s < ∞if we choose s −qN < −n, that is N > (s + n)/q. Let
us ﬁnally prove the density statement. Let us choose an exhaustive sequence (Kj)
of compact subsets of Rn ⊕Rn (i.e., Kj ⊂˚
Kj+1 and Rn ⊕Rn = ∪jKj) and set
Ψj = W(ψ, φj)χj where χj is the characteristic function of Kj. Also set
ψj = W ∗
φΨj =
2n
(γ|φ)L2
	
Rn⊕Rn Ψj(z) 
TGR(z)γdz.
Since W(ψ, φ) ∈S(Rn ⊕Rn) we have ψj ∈S(Rn) and
∥ψ −ψj∥ℏ
φ,Mq
s = ∥W ∗
φ(Wφψ −Ψj)∥ℏ
φ,Mq
s
≤C∥Wφψ −Ψj∥Lq
s.
We have limj→∞∥Wφψ −Ψj∥ℏ
φ,Mq
s = 0 and hence also limj→∞∥ψ −ψj∥ℏ
φ,Mq
s
proving our claim.
□

284
Chapter 17.
The Modulation Spaces M q
s
17.2.2
Metaplectic and Heisenberg–Weyl invariance properties
The modulation spaces M q
s (Rn) have two remarkable invariance properties, ex-
tending the similar properties of the Feichtinger algebra:
Proposition 400. The modulation spaces M q
s (Rn) have the following properties:
(i) Each space M q
s (Rn) is invariant under the action of the Heisenberg–Weyl
operators 
T(z); in fact there exists a constant C > 0 such that
∥
T(z)ψ∥ℏ
φ,Mq
s ≤C ⟨z⟩s ∥ψ∥ℏ
φ,Mq
s .
(17.14)
(ii) The space M q
s (Rn) is invariant under the action of the metaplectic group
Mp(2n, R): if 
S ∈Mp(2n, R) then 
Sψ ∈M q
s (Rn) if and only if ψ ∈M q
s (Rn).
In particular M q
s (Rn) is invariant under the Fourier transform.
Proof of (i). The cross-Wigner transform satisﬁes
W( 
T(z0)ψ, φ)(z) = e−i
ℏσ(z,z0)W(ψ, φ)(z −1
2z0)
(property (9.25)) hence it suﬃces, in view of Proposition 397, to show that Lq
s(Rn⊕
Rn) is invariant under the phase space translation T (z0) : z −→z + z0. In view
of the submultiplicative property of the weight vs (cf. Exercise 390) we have, for
q < ∞,
∥T (z0)Ψ∥q
Lq
v =
	
Rn⊕Rn |Ψ(z −z0)|q ⟨z⟩qs dz
=
	
Rn⊕Rn |Ψ(z)|q ⟨z + z0⟩qs dz
≤⟨z⟩s
	
Rn⊕Rn |Ψ(z)|q ⟨z⟩qs dz,
hence our claim; the estimate (17.14) follows.
Proof of (ii). In view of Proposition 398 we have ψ ∈M q
s (Rn) if and only if
W(ψ, φ) ∈Lq
s(Rn ⊕Rn) for one window φ ∈S(Rn); if this property holds, then
it holds for all windows. In view of the symplectic covariance formula (10.26) for
the Wigner transform we have
W(
Sψ, φ) = W(
Sψ, 
S(
S−1φ))(z)
= W(ψ, (
S−1φ))(S−1z),
hence W(
Sψ, φ) ∈Lq
s(Rn ⊕Rn) if and only if the function
z −→W(ψ, (
S−1φ))(S−1z)
is in Lq
s(Rn⊕Rn). But this condition is equivalent to W(ψ, (
S−1φ)) ∈Lq
s(Rn⊕Rn)
in view of Lemma 393, hence 
Sψ ∈M q
s (Rn).
□

17.3.
The modulation spaces M ∞
s
285
The following consequence of the result above is interesting:
Corollary 401. The modulation space M q
s (Rn) is invariant under the dilations
ψ −→ψλ where ψλ(x) = ψ(λx) where λ ̸= 0. More generally, M q
s (Rn) is invariant
under every change of variables x −→Lx (det L ̸= 0).
Proof. The unitary operators ML with ML,mψ(x) = im
| det L|ψ(Lx) (det L ̸= 0,
arg det L ≡mπ mod 2π) belong to Mp(2n, R); the lemma follows since M q
s (Rn) is
a vector space.
□
The class of modulation spaces M q
s (Rn) contains as particular cases many
of the classical function spaces. For instance, M 2
s (Rn) coincides with the Shubin–
Sobolev space
Qs(Rn) = L2
s(Rn) ∩Hs(Rn)
(Shubin [147], p. 45). We also have
S(Rn) =
+
s≥0
M 2
s (Rn).
17.3
The modulation spaces M ∞
s
We now study the case q = ∞.
17.3.1
The weighted spaces L∞
s
The spaces L∞
s (Rn ⊕Rn) are deﬁned as follows:
Deﬁnition 402. Let Ψ be a complex-valued measurable function on Rn ⊕Rn. We
have Ψ ∈L∞
s (Rn ⊕Rn) if there exists a constant C > 0 such that ess sup(|Ψ|vs) ≤
C where “esssup” stands for “essential supremum”.
Equivalently: |Ψ(z)| ≤Cv−s(z) for almost every z ∈Rn ⊕Rn.
It is clear that L∞
s (Rn ⊕Rn) is a vector space: if ess sup(|Ψ| ⟨·⟩s) ≤C then
ess sup(|λΨ|vs) ≤C|λ| for λ ∈C and if ess sup(|Ψ′| ⟨·⟩s) ≤C′ then
ess sup(|Ψ + Ψ′| ⟨·⟩s) ≤C + C′.
The norm on L∞
s (Rn ⊕Rn) is deﬁned as follows: ∥Ψ∥L∞
s
is the inﬁmum of all
constants C such that ess sup(|Ψ|vs) ≤C:
∥Ψ∥L∞
s = inf{C : ess sup(|Ψ| ⟨·⟩s) ≤C}.
(17.15)
Exercise 403. Prove in detail that Ψ −→∥Ψ∥L∞
s
deﬁnes a norm on the vector
space L∞
s (Rn ⊕Rn).
We invite the reader to prove the completeness of L∞
s (Rn⊕Rn) (it is standard,
and does not require any unexpected trick):

286
Chapter 17.
The Modulation Spaces M q
s
Problem 404. Prove that L∞
s (Rn ⊕Rn) is a Banach space for the norm ∥· ∥L∞
s .
(It is an adaptation of the proof of property (i) in Proposition 388.)
The dual of the Banach space L∞
s (Rn ⊕Rn) is L1
−s(Rn ⊕Rn) where the
duality bracket is deﬁned by
(Φ, Ψ) =
	
Rn⊕Rn Φ(z)Ψ(z)dz
for Φ ∈L1
−s(Rn ⊕Rn) and Ψ ∈L∞
s (Rn ⊕Rn). In fact,
|(Φ, Ψ)| ≤
	
Rn⊕Rn |Φ(z)| |Ψ(z)|dz
=
	
Rn⊕Rn |Φ(z)| ⟨z⟩−s Ψ(z)|vs(z)dz
≤∥Φ∥L1
−s∥Ψ∥L∞
s .
The following property is the extension to the L∞
s case of the invariance property
of Lq
v under translations proven in Proposition 388:
Proposition 405. The space L∞
s (Rn ⊕Rn) is invariant under translations
T (z0)Ψ(z) = Ψ(z −z0),
and we have:
∥T (z0)Ψ∥L∞
s ≤⟨z0⟩s ∥Ψ∥L∞
s
(17.16)
for every Ψ ∈L∞
s (Rn ⊕Rn).
Proof. It suﬃces to prove the estimate (17.16). By deﬁnition of the norm on
L∞
s (Rn ⊕Rn) this is equivalent to proving that, if |Ψ(z −z0)|vs(z) ≤C almost ev-
erywhere, then |Ψ(z)|vs(z) ≤Cvs(z0) a.e. Now, the condition |Ψ(z−z0)|vs(z) ≤C
a.e. is equivalent to Ψ(z)|vs(z + z0) ≤C a.e. Noting that in view of the submulti-
plicativity property of the weight vs we have, writing vs(z) = vs(z + z0 −z0),
|Ψ(z)| ⟨z⟩s ≤|Ψ(z)| ⟨z + z0⟩s ⟨z0⟩s ≤C ⟨z0⟩s
which concludes the proof.
□
17.3.2
The spaces M ∞
s
The deﬁnition is a straightforward adaptation of that of M q
s for q < ∞:
Deﬁnition 406. The modulation space M ∞
s (Rn) consists of all ψ ∈S′(Rn) such
that Vφψ ∈L∞
s (Rn ⊕Rn) for every window φ ∈S′(Rn) (where Vφψ is the STFT
transform); equivalently W(ψ, φ) ∈L∞
s (Rn ⊕Rn).

17.4.
The modulation spaces M ∞,1
s
287
We leave it to the reader to check that the conditions Vφψ ∈L∞
s (Rn ⊕Rn)
and W(ψ, φ) ∈L∞
s (Rn ⊕Rn) (for all φ) are equivalent.
We equip M ∞
s (Rn) with the norms
∥ψ∥φ,M∞
s (Rn) = ∥W(ψ, φ)∥L∞
s (Rn⊕Rn).
Not very surprisingly, we have:
Proposition 407. We have ψ ∈M ∞
s (Rn) if and only if W(ψ, φ) ∈L∞
s (Rn ⊕Rn)
for one window φ ∈S(Rn). The norms ψ −→∥ψ∥φ,M∞
s (Rn) are equivalent norms
on M ∞
s (Rn).
Proof. It is similar to the proof of Proposition 397.
□
The spaces M ∞
s (Rn) can be seen as non-trivial reﬁnements of the Schwartz
space S(Rn). In fact, we have the following beautiful result:
Proposition 408. We have the equalities
S(Rn) = 3
s≥0
M ∞
s (Rn) , S′(Rn) = 4
s≥0
M ∞
−s(Rn).
(17.17)
Proof. Let us prove the ﬁrst equality (17.17). Let ψ ∈S(Rn); in view of the
estimate (9.59) in Proposition 192, for every N ≥0 there exists CN > 0 such that
|W(ψ, φ)(z)| ≤CN ⟨z⟩−N. It follows that
|W(ψ, φ)(z)| ⟨z⟩s ≤CN ⟨z⟩s−N ≤CN
if we choose N ≥s and hence ψ ∈M ∞
s (Rn) for every s. Suppose conversely that
ψ ∈M ∞
s (Rn) for every s ≥0; this is equivalent to |W(ψ, φ)(z)| ≤Cs ⟨z⟩−s for
every s and hence ψ ∈S(Rn) in view of the implication (iv)=⇒(i) in Proposition
192. Let us now prove the second equality (17.17). First of all it is clear that
4
s≥0
M ∞
s (Rn) ⊂S′(Rn)
since, by deﬁnition, the elements of each space M ∞
s (Rn) are tempered distribu-
tions. Let ψ ∈S′(Rn). Then, by Theorem 190(ii) there exist constants C ≥0 and
µ ≥0 such that |W(ψ, φ)(z)| ≤C ⟨z⟩µ and hence |W(ψ, φ)| ⟨z⟩−µ is bounded, so
that ψ ∈M µ
−s(Rn) for some s ≥0.
□
17.4
The modulation spaces M ∞,1
s
Let us now introduce a diﬀerent class of modulation spaces, whose elements are
excellent candidates for being Weyl symbols. This class contains as a particu-
lar case the Sj¨ostrand classes which were deﬁned by other methods in Sj¨ostrand
[150, 151].

288
Chapter 17.
The Modulation Spaces M q
s
17.4.1
Deﬁnition and ﬁrst properties
We will again use the weight function on R2n deﬁned for z ∈R2n and ζ ∈R2n by
⟨z⟩s = (1 + |z|2)s/2. We will assume that s ≥0.
Deﬁnition 409. The modulations space M ∞,1
s
(Rn ⊕Rn) consists of all tempered
distributions Ψ ∈S′(Rn ⊕Rn) such that
sup
z∈R2n |W(Ψ, Φ)(z, ζ)⟨z⟩s| ∈L1(Rn ⊕Rn)
(17.18)
for every Φ ∈S(Rn⊕Rn). When s = 0 the space M ∞,1
0
(Rn⊕Rn) = M ∞,1(Rn⊕Rn)
is called the Sj¨ostrand class. It thus consists of all Ψ ∈S′(Rn ⊕Rn) such that
sup
z∈R2n |W(Ψ, Φ)(z, ζ)| ∈L1(Rn ⊕Rn)
for every Φ ∈S(Rn ⊕Rn).
Exercise 410. Verify that M ∞,1
s
(Rn ⊕Rn) is a complex vector space for the usual
operations.
The spaces M ∞,1
s
(Rn ⊕Rn) are usually deﬁned in terms of the short-time
Fourier transform VΦΨ instead of W(Ψ, Φ). That the choice of deﬁnition is irrele-
vant is easy to prove:
Exercise 411. Show that Ψ ∈M ∞,1
s
(Rn ⊕Rn) if and only if
sup
z∈R2n |VΦΨ(z, ζ)⟨z⟩s| ∈L1(Rn ⊕Rn)
by adapting the method in the proof of Proposition 397.
The following result is the analogue of Proposition 399; it shows in particular
that it suﬃces to check the bound (17.18) for one function Φ:
Proposition 412. We have Ψ ∈M ∞,1
s
(Rn ⊕Rn) if and only if (17.18) holds for
one Φ ∈S(Rn ⊕Rn), and
(i) The equalities
∥Ψ∥Φ
M∞,1
s
=
	
R2n sup
z∈R2n |W(Ψ, Φ)(z, ζ)⟨z⟩s|dζ
deﬁne a family of equivalent norms on M ∞,1
s
(Rn ⊕Rn) when Φ describes
S(Rn ⊕Rn);
(ii) The space M ∞,1
s
(Rn ⊕Rn) is a Banach space for the topology deﬁned by any
of the norms ∥·∥Φ
M∞,1
s
and S(Rn⊕Rn) is a dense subspace of M ∞,1
s
(Rn⊕Rn).
An important property of the modulation spaces M ∞,1
s
(Rn ⊕Rn) is their
invariance under linear changes of variables:

17.4.
The modulation spaces M ∞,1
s
289
Proposition 413. Let A ∈GL(2n, R) and set A∗Ψ = Ψ ◦A. We have Ψ ∈
M ∞,1
s
(Rn ⊕Rn) if and only A∗Ψ ∈M ∞,1
s
(Rn ⊕Rn). There exists a constant
CA > 0 such that
∥A∗Ψ∥Φ
M∞,1
s
≤CA∥Ψ∥A∗Φ
M∞,1
s
(17.19)
for every Φ ∈S(Rn ⊕Rn).
Proof. It is of course suﬃcient to prove the existence of a constant CA such that
(17.19) holds. Let us set Ψ′ = A∗Ψ and choose Φ ∈S(Rn ⊕Rn). We have, by
deﬁnition of the cross-Wigner transform on Rn ⊕Rn,
W(Ψ′, Φ)(z, ζ) =

1
2πℏ
2n 	
R2n e−i
ℏζ·ηΨ(Az + 1
2Aη)Φ(z −1
2η)dη,
that is, performing the change of variables ξ = Aη,
W(Ψ′, Φ)(z, ζ) =

1
2πℏ
2n | det A|−1
×
	
R2n e−i
ℏζ·A−1ξΨ(Az + 1
2ξ)Φ(z −1
2A−1ξ)dξ
and hence
W(Ψ′, Φ)(A−1z, AT ζ) =

1
2πℏ
2n | det A|−1
×
	
R2n e−i
ℏζ·ξΨ(z + 1
2ξ)(A−1)∗Φ(z −1
2ξ)dξ.
It follows that
W(Ψ′, Φ)(A−1z, AT ζ) = | det A|−1W(Ψ, (A−1)∗Φ)(z, ζ),
that is
W(Ψ′, Φ)(z, ζ) = | det A|−1W(Ψ, (A−1)∗Φ)(Az, (AT )−1ζ);
(17.20)
taking the suprema of both sides of this equality we get
sup
z∈R2n |W(Ψ′, Φ)(z, ζ)⟨z⟩s| = | det A|−1 sup
z∈R2n |W(Ψ, (A−1)∗Φ)(z, ζ)⟨A−1z⟩s|
and hence
∥A∗Ψ∥Φ
M∞,1
s
= | det A|−1
	
R2n sup
z∈R2n |W(Ψ, (A−1)∗Φ)(z, ζ)⟨A−1z⟩s|dζ.
Since we have ⟨A−1z⟩s ≤C(A)⟨z⟩s for some constant C(A) > 0 the estimate
(17.19) follows.
□
Exercise 414. Derive the equality (17.20) using the symplectic covariance property
(10.26) of the cross-Wigner transform.

290
Chapter 17.
The Modulation Spaces M q
s
17.4.2
Weyl operators with symbols in M ∞,1
s
For this subsection a good source is Gr¨ochenig’s paper [84] (also see the older
paper [83] by Gr¨ochenig and Heil), and Gr¨ochenig [82].
It is interesting to view the modulation spaces M ∞,1
s
as symbol classes: in
contrast to the cases traditionally considered in the literature, membership of a
symbol a in M ∞,1
s
(Rn ⊕Rn) does not imply any smoothness of a. It turns out that
this point of view allows us to recover many classical and diﬃcult regularity prop-
erties (for instance the Calder´on–Vaillancourt theorem) in a rather simple way.
Here is a ﬁrst very interesting result. It says basically that the Weyl operators
with symbols in M ∞,1
s
(Rn ⊕Rn) preserve phase-space concentration.
Proposition 415. Suppose that a ∈M ∞,1
s
(Rn ⊕Rn). Then the operator 
A
Weyl
←→a
is bounded on each of the modulation spaces M q
s (Rn).
Proof. (Cf. ([82], Theorem 14.5.6).
□
The interest of M ∞,1
s
(Rn ⊕Rn) comes from the following property of the
Moyal product (Gr¨ochenig [85]), namely that it equips these spaces with a ∗-
algebra structure. Recall that the Moyal product a ⋆ℏb is the Weyl symbol of the
product 
A 
B of the operators 
A
Weyl
←→a and 
B
Weyl
←→b.
Proposition 416. Let a, b ∈M ∞,1
s
(Rn ⊕Rn). Then a ⋆ℏb ∈M ∞,1
s
(Rn ⊕Rn). In
particular, for every window Φ there exists a constant CΦ > 0 such that
∥a ⋆ℏb∥Φ
M∞,1
s
≤CΦ∥a∥Φ
M∞,1
s
∥b∥Φ
M∞,1
s
.
Since obviously a ∈M ∞,1
s
(Rn ⊕Rn) if and only if a ∈M ∞,1
s
(Rn ⊕Rn), the
property above can be restated in the following concise way:
The modulation space M ∞,1
s
(Rn ⊕Rn) is a Banach ∗-algebra with
respect to the Moyal product ⋆ℏand the involution a −→a.
In the case of the Sj¨ostrand class M ∞,1(Rn ⊕Rn) one has the following more
precise results:
Proposition 417. We have the following properties:
(i) Every Weyl operator 
A
Weyl
←→a with a ∈M ∞,1(Rn⊕Rn) is bounded on L2(Rn);
(ii) If we have 
C = 
A 
B with a, b ∈M ∞,1(Rn ⊕Rn) then c ∈M ∞,1(Rn ⊕Rn);
(iii) If 
A with a ∈M ∞,1(Rn ⊕Rn) is invertible with inverse 
B
Weyl
←→b then b ∈
M ∞,1(Rn ⊕Rn).
The Sj¨ostrand class M ∞,1(Rn ⊕Rn) contains, in particular, the symbol class
S0
0,0(Rn ⊕Rn) consisting of all inﬁnitely diﬀerentiable complex functions A on
Rn ⊕Rn such that ∂α
z A is bounded for all multi-indices α ∈N2n. Property (i) thus
extends the L2-boundedness property of operators with symbols in S0
0,0(Rn ⊕Rn).
Property (iii) is called the Wiener property of M ∞,1(Rn ⊕Rn).

Chapter 18
Bopp Pseudo-diﬀerential Operators
Bopp pseudo-diﬀerential operators are the operators formally obtained from a
symbol by the quantization rules
x −→x + 1
2iℏ∂p , p −→p −1
2iℏ∂x
(18.1)
instead of the usual correspondence x −→x, p −→−iℏ∂x. The terminology
comes from the fact that the operators x + 1
2iℏ∂p and p −1
2iℏ∂x are called “Bopp
shifts” in the physics literature. These operators act, not on functions deﬁned on
Rn as ordinary Weyl operators do, but on functions (or distributions) deﬁned on
the phase space Rn ⊕Rn. The deﬁnition of Bopp pseudo-diﬀerential operators
is sensitive to the choice of symplectic structure on Rn ⊕Rn; this property will
be exploited in the next chapter in the context of non-commutative quantum
mechanics where one is led to use other symplectic forms than the standard one.
We will call this quantization procedure “Bopp quantization” in honor of
the physicist Fritz Bopp, who was the ﬁrst to consider (in 1956) operators of
this type in his paper [18] where he discussed some statistical implications of
quantization. We should also give credit to the mathematical physicist Ryogo Kubo
[111] who noticed in 1964 the relationship between operators of this type and Weyl
calculus. This possibility has been sporadically discussed in the physics literature
(see for instance Brodimas et al. [23] and Balazs and Pauli [4]), but their papers
seem to have been unfortunately more or less unnoticed. We will see in the next
chapter that the theory of Bopp pseudo-diﬀerential operators is a tool of choice
for the study of deformation quantization which it reduces to a Weyl calculus of
a particular type. We will also see that the study of non-commutative quantum
mechanics can also be reduced to Bopp calculus. (Another easy application is the
study of generalizations of the magnetic Landau problem.)
The study of phase space pseudo-diﬀerential operators (from a slightly dif-
ferent point of view) was initiated in de Gosson [67, 68, 69, 70, 71], and applied to
deformation quantization via the theory of modulation spaces in de Gosson and
Luef [76, 79].
291
M.A. de Gosson, Symplectic Methods in Harmonic Analysis and in Mathematical Physics,  
Pseudo-Differential Operators 7, DOI 10.1007/978-3-7643-9992-4_
, © Springer Basel AG 2011 
18

292
Chapter 18.
Bopp Pseudo-diﬀerential Operators
18.1
Introduction and motivation
To understand what Bopp pseudo-diﬀerential calculus is about, let us consider
the following simple example. In deformation quantization one studies “star prod-
ucts” of functions deﬁned on phase space. The most commonly used, at least in
applications, is the Moyal product ⋆ℏ, which is one of the cornerstones of defor-
mation quantization, which we will discuss in more detail in the next chapter. By
deﬁnition c = a ⋆ℏb where
c(z) =

1
4πℏ
2n 		
R4n e
i
2ℏσ(z′,z′′)a(z + 1
2z′)b(z −1
2z′′)dz′dz′′.
This is immediately recognized as being the formula giving the symplectic Fourier
transform of the symbol of the product 
C = 
A 
B of two Weyl operators (cf. The-
orem 213). Equivalently, the symplectic Fourier transform of c is given by the
formula
cσ(z) =

1
2πℏ
n 	
R2n e
i
2ℏσ(z,z′)aσ(z −z′)bσ(z′)dz′.
After a few calculations one sees that, in particular,
x ⋆ℏa =

x + 1
2iℏ∂p

a ,
p ⋆ℏa =

p −1
2iℏ∂x

a
(18.2)
where ∂p and ∂x are the gradients in p and x, respectively.
Exercise 418. Prove these formulas. More generally, what is xα ⋆ℏa (resp. pα ⋆ℏa)
when α ∈Nn?
The formulas (18.2) suggest that, more generally, the Moyal product a ⋆ℏb
of two functions a, b could be rewritten in the form
a ⋆ℏb = Ab
(18.3)
where A = A(x, p) is a pseudo-diﬀerential operator formally obtained by the “Bopp
quantization rules” x −→x and p −→p where x and p are the diﬀerential opera-
tors
x = x + 1
2iℏ∂p , p = p −1
2iℏ∂x;
(18.4)
writing z = (x, p) these relations can be written
z = z + 1
2iℏJ∂z
(18.5)
which has the advantage of making explicit the relation of Bopp quantization
with the standard symplectic structure. This also opens the door to more general
quantizations associated with non-standard symplectic structures as we will see
in Chapter 19. Of course “formula” (18.3) only remains a notation as long as one
has not given a working deﬁnition of the operator A = a(z); and it is not at
all obvious what this deﬁnition should be except when a is a polynomial! Notice

18.1.
Introduction and motivation
293
that by deﬁnition, such operators A act not on functions (or distributions) deﬁned
on Rn but on functions (or distributions) deﬁned on phase space Rn ⊕Rn. We
can therefore consider the study of such operators as a study of a phase space
pseudo-diﬀerential calculus.
We will give below a rigorous deﬁnition of the Bopp operators A which can
be viewed as a Weyl operator of a very particular type acting on phase space
functions. We will see that “Bopp calculus” is intertwined with the usual Weyl
calculus by inﬁnitely many partial isometries of L2(Rn) onto closed subspaces of
L2(Rn). This fact has very surprising consequences, and it leads (as a by-product)
to simple proofs for many regularity properties for the usual Weyl operators.
18.1.1
Bopp pseudo-diﬀerential operators
Recall that the Heisenberg–Weyl operator 
T(z0) acts on functions deﬁned on Rn
via the formula

T(z0)ψ(x) = e
i
ℏ(p0·x−1
2 p0·x0)ψ(x −x0);
a natural step is to extend the domain of 
T(z0) by letting it act on functions (or
distributions) deﬁned on Rn ⊕Rn via the formula

T(z0)Ψ(z) = e
i
ℏ(p0·x−1
2 p0·x0)Ψ(z −z0).
This approach was actually initiated in our monograph [67] in connection with the
study of the phase space Schr¨odinger equation (also see de Gosson [69, 68, 70]). For
our present purpose, which is the deﬁnition of Bopp pseudo-diﬀerential operators,
we prefer to use a variant of this redeﬁnition of the Heisenberg–Weyl operator:
Deﬁnition 419. For z0 ∈R2n the operator T(z0) is deﬁned, for Ψ ∈S′(Rn ⊕Rn),
by
T(z0)Ψ(z) = e−i
ℏσ(z,z0)Ψ(z −1
2z0).
(18.6)
This choice (as arbitrary as it can seem at ﬁrst sight!) is consistent with the
quantization rules (18.4). This can be seen as follows. Recall from Chapter 8, for-
mula (8.3) that the introduction of the usual Heisenberg–Weyl operator 
T(z0) =
e−iσ(
z,z0) can be motivated by the Weyl quantization of the translation Hamilto-
nian Hz0(z) = σ(z, z0); the operator with Weyl symbol is 
Hz0(z) = σ(
z, z0) with

z = (x, −iℏ∂x) and the solution of the corresponding Schr¨odinger equation
iℏ∂
∂tψ = 
Hz0ψ , ψ(x, 0) = ψ0(x)
is formally given by ψ(x, t) = eitσ(
z,z0)/ℏψ0(x); a direct calculation then leads to
the explicit formula
u(x, t) = e
i
ℏtσ(
z,z0)ψ0(x) = e
i
ℏ(tξ0·x−1
2 t2ξ0·x0)ψ0(x −tx0)

294
Chapter 18.
Bopp Pseudo-diﬀerential Operators
and hence 
T(z0)ψ(x, 0) = ψ(x, 1). To deﬁne the operators T(z0) one proceeds
exactly in the same way: replacing the Hamiltonian operator 
Hz0(z) = σ(
z, z0)
with Hz0(z) = σ(z, z0) where z = z + 1
2iℏJ∂z we are led to the “phase space
Schr¨odinger equation”
iℏ∂
∂tΨ = σ(z, z0)Ψ , Ψ(z, 0) = Ψ0(z)
whose solution is
Ψ(z, t) = e
i
ℏtσ(z,z0)Ψ0(z) = e−i
ℏtσ(z,z0)Ψ0(z −1
2tz0).
We thus have
Ψ(z, t) = T (z0)Ψ(z) = e
i
ℏσ(z,z0)Ψ0(z).
We also observe that the operators T(z0) also appear (albeit in disguise) in
the translation formula (9.25) for Heisenberg–Weyl operators:
W( 
T(z0)ψ, 
T (z1)φ)(z) = e−i
ℏ[σ(z,z0−z1)+ 1
2 σ(z0,z1)]W(ψ, φ)(z −⟨z⟩)
where ⟨z⟩= (z0+z1)/2. In fact taking z1 = 0 in the formula above we immediately
get (18.6). It turns out that the operators T(z0) satisfy commutation relations
which are similar to

T(z0) 
T(z1) = e
i
ℏσ(z0,z1) 
T(z1) 
T(z0),

T(z0 + z1) = e−i
2ℏσ(z0,z1) 
T(z0) 
T(z1),
which are satisﬁed by the Heisenberg–Weyl operators (formulae (8.8) and (8.9)).
In fact:
Proposition 420. We have
T(z0 + z1) = e−i
2ℏσ(z0,z1) T(z0) T (z1),
(18.7)
T(z1) T (z0) = e−i
ℏσ(z0,z1) T(z0) T(z1)
(18.8)
for all z0, z1 ∈R2n.
Proof. Formula (18.8) follows from formula (18.7) noting that we can write
T(z1) T(z0) = e
i
2ℏσ(z1,z0) T(z1 + z0)
= e−i
2ℏσ(z0,z1) T(z0 + z1)
= e−i
ℏσ(z0,z1) T(z0) T(z1).
The proof of (18.7) is similar and left to the reader.
□

18.1.
Introduction and motivation
295
These relations suggest that T(z0) could correspond to a unitary representa-
tion of the Heisenberg group on phase space functions. We will see later on that
this is indeed the case.
In analogy with the formula

Aψ(x) =

1
2πℏ
n 	
R2n aσ(z0) 
T(z0)ψ(x)dz0
deﬁning a Weyl operator we introduce:
Deﬁnition 421. Let a ∈S′(Rn ⊕Rn); the operator A deﬁned for Ψ ∈S(Rn ⊕Rn)
by
AΨ(z) =

1
2πℏ
n 	
R2n aσ(z0) T(z0)Ψ(z)dz0
is called the Bopp operator with symbol a, and we will write A
Bopp
←→a or a
Bopp
←→A
(“Bopp correspondence”).
The deﬁnition of a Bopp operator can be reformulated in many diﬀerent
ways. For instance, in terms of the distributional brackets ⟨⟨·, ·⟩⟩on Rn ⊕Rn we
have
AΨ =

1
2πℏ
n ⟨⟨aσ, T(·)Ψ⟩⟩.
This immediately shows that the deﬁnition of A still makes sense when the symbol
a is a tempered distribution on Rn ⊕Rn. Thus, the Bopp correspondence a
Bopp
←→A
makes sense for a ∈S′(Rn ⊕Rn). We will see below that this is not surprising,
because Bopp pseudo-diﬀerential operators are just Weyl operators of a special
type.
Exercise 422. In Chapter 8 we deﬁned the Grossmann–Royer operators by the
formula 
TGR(z0) = 
T(z0) 
TGR(0) 
T(z0)−1 where 
TGR(0)ψ(x) = ψ(−x). Show that
the operator TGR(z0) : S(Rn ⊕Rn) −→S(Rn ⊕Rn) deﬁned by TGR(z0) =
T(z0) TGR(0) T(z0)−1 where TGR(0)Ψ(x) = Ψ(−x) is explicitly given by
TGR(z0)Ψ(z) = e−2i
ℏσ(z,z0)Ψ(−z + z0).
18.1.2
Bopp operators viewed as Weyl operators
Let us view the linear operator A as a Weyl operator A : S(Rn ⊕Rn) −→S′(Rn ⊕
Rn). We are going to identify the symbol of A below; we begin by calculating its
distributional kernel:
Lemma 423. The kernel of the operator A
Bopp
←→a is given by the formula
K 
A(z, z′) =
 1
πℏ
n aσ[2(z −z′)]e
2i
ℏσ(z,z′).
(18.9)

296
Chapter 18.
Bopp Pseudo-diﬀerential Operators
Proof. In view of Deﬁnition (18.6) of T(z0)Ψ we have, performing the change of
variable z0 = 2(z −z′),
AΨ(z) =

1
2πℏ
n 	
R2n aσ(z0)e−i
ℏσ(z,z0)Ψ(z −1
2z0)dz0
=
 1
πℏ
n 	
R2n aσ[2(z −z′)]e
2i
ℏσ(z,z′)Ψ(z′)dz′,
hence the kernel K A of A is given by formula (18.9).
□
Theorem 424. Viewing A as a Weyl operator S(Rn ⊕Rn) −→S′(Rn ⊕Rn), its
symbol a
Weyl
←→A is obtained from the symbol a
Weyl
←→
A by
a(z, ζ) = a(z −1
2Jζ)
(18.10)
that is, setting ζ = (ζx, ζp),
a(z, ζ) = a(x −1
2ζp, p + 1
2ζx).
(18.11)
Proof. It is a variant of the proof we have given in de Gosson [71] in a slightly
diﬀerent context. In view of formula 10.15 with n replaced by 2n we can determine
the Weyl symbol a of A by the formula
a(z, ζ) =
	
R2n e−i
ℏζ·ηK(z + 1
2η, z −1
2η)dη.
We have, using the identity σ(z + 1
2η, z −1
2η) = −σ(z, η),
K(z + 1
2η, z −1
2η) =
 1
πℏ
n aσ(2η)e−2i
ℏσ(z,η)
and hence
a(z, ζ) =
 1
πℏ
n 	
R2n e−i
ℏζ·ηe−2i
ℏσ(z,η)aσ(2η)dη
that is, setting ω = 2η,
a(z, ζ) =

1
2πℏ
n 	
R2n e−i
2ℏζ·ωe−i
ℏσ(z,ω)aσ(ω)dω.
Now we observe that
1
2ζ · ω + σ(z, ω) = 1
2ζ · ω + Jz · ω
= J(z −1
2Jζ) · ω
= σ(z −1
2Jζ, ω)
so that
a(z, ζ) =

1
2πℏ
n 	
R2n e−i
ℏσ(z−1
2 Jζ,ω)aσ(ω)dω.

18.1.
Introduction and motivation
297
Recalling that the symplectic Fourier transform is its own inverse we thus have
a(z, ζ) = a(z −1
2Jζ)
(18.12)
which we set out to prove.
□
Note that (z, ζ) is the generic point of the 4n-dimensional phase space R2n ⊕
R2n; the variable ζ = (ζx, ζp) ∈Rn×Rn is viewed as the dual variable of z = (x, p).
The result above justiﬁes the interpretation of A as the operator obtained
from the usual Weyl symbol a by the quantization rule
z = (x, p) −→(x + 1
2iℏ∂p, p −1
2iℏ∂x) = z
(18.13)
and thus legitimates the notation
A = a(x + 1
2iℏ∂p, p −1
2iℏ∂x) = a(z)
we introduced above.
18.1.3
Adjoints and a composition formula
The usual rules for calculating the adjoint and composing Weyl operators apply
to the case of Bopp operators as well.
Proposition 425.
(i) The Weyl symbol c of the product C = A B of two Bopp operators is
c(z, ζ) = c

z −1
2Jζ

(18.14)
where c is the usual Weyl symbol of the product 
A 
B. Hence
A B = '
AB.
(18.15)
(ii) The symbol of the adjoint A∗is the complex conjugate a of the symbol a of
A. Hence A∗is (essentially) self-adjoint if and only if a is real.
Proof of (i). In view of the composition formulas in Theorem 213 the Weyl symbol
of A B is given by
c(z, ζ) =

1
4πℏ
4n 	
R4n e
i
2 σ(z′,ζ′;z′′,ζ′)a
 1
2(z + 1
2z′) −J(ζ + 1
2ζ′)
 
× b
 1
2(z −1
2z′′) −J(ζ −1
2ζ′′)
 
dz′dz′′dζ′dζ′′
where ω is the symplectic form on R4n. Deﬁning new variables u′ = 1
2z′ −Jζ′ and
u′′ = 1
2z′′ −Jζ′′, this formula becomes
c(z, ζ) =

1
4πℏ
4n 	
R4n I(u, u′′)a(z + u′ −1
2Jζ)b(z −u′′ −1
2Jζ)dz′dz′′du′du′′

298
Chapter 18.
Bopp Pseudo-diﬀerential Operators
with
I(u, u′′) =
	
Rn exp

−i
2ℏ(σ(z′, z′′ −u′′) −σ(u′, z′′))

dz′dz′′.
Using the properties of the Fourier transform, I(u, u′′) is easily calculated and one
ﬁnds that it is equal to (4π)2ne
i
2 σ(u′,u′); formula (18.15) follows.
Proof of (ii). Part (ii) of the proposition follows from Proposition 212 about the
Weyl symbol of the adjoint of an operator and the fact that a is the Weyl symbol
of A viewed as an operator S(Rn ⊕Rn) −→S(Rn ⊕Rn).
□
18.1.4
Symplectic covariance of Bopp operators
The calculus of Bopp pseudo-diﬀerential operators should inherit the symplectic
covariance properties of the usual Weyl calculus. This is indeed the case:
Proposition 426. Let a
Bopp
←→A and S ∈Sp(2n, R). We have
a ◦S−1Bopp
←→5
MS A5
M −1
S
(18.16)
where 5
MS is the unitary operator on L2(Rn ⊕Rn) deﬁned by 5
MSΨ(z) = Ψ(Sz).
Equipping Sp(4n, R) with its standard symplectic structure σ ⊕σ we have 5
MS ∈
Mp(4n, R) where Mp(4n, R) is the corresponding metaplectic group.
Proof. That 5
MS ∈Mp(4n, R) is clear, since we have
5
MSΨ(z) = 
MS,0Ψ(z) =
√
det SΨ(Sz)
(cf. the notation (7.9) in Chapter 7). With the notation of Chapter 3 (formula
(3.16)) set
MS =
S−1
0
0
ST

;
then MS is the projection on Sp(4n, R) of the metaplectic operator 5
MS = 
MS,0.
To prove the covariance formula (18.16) we recall that the Weyl symbol of A is
given by a(z, ζ) = a(z −1
2Jζ). Let b be the Weyl symbol of the Bopp operator
with Weyl symbol a ◦S−1; since S−1J = JST we have
b(z, ζ) = a(S−1(z −1
2Jζ)) = a(MS(z, ζ)).
This proves formula (18.16) applying the usual symplectic covariance formula
(10.25) for Weyl operators in Theorem 128 in our case.
□
We notice that the symplectic covariance formula (18.16) is very simple com-
pared to the covariance formula a ◦S−1Weyl
←→
S 
A
S because the operator 5
MS is just
a symplectic change of variables.

18.2.
Intertwiners
299
18.2
Intertwiners
As a rule, given a symbol a, the Weyl operator 
A
Weyl
←→a is less complicated than the
corresponding Bopp operator A
Bopp
←→a, so one would like to deduce the properties
of the second from those of the ﬁrst. For this we ﬁrst have to ﬁnd a procedure
allowing us to associate to a function ψ ∈L2(Rn) a function Ψ ∈L2(Rn ⊕Rn);
that correspondence should be linear, and intertwine in some way the operators 
A
and A. It turns out that there exist many procedures for transforming a function
of, say, x into a function of twice as many variables: the well-known and much
used Bargmann transform is an archetypical (and probably the oldest) example
of such a procedure (see Problem 429 below). However, the Bargmann transform
is not suﬃcient when one wants to recover all the spectral properties of A from
those of 
A. For example, the eigenvalues of A are generally inﬁnitely degenerate,
so it is illusory to attempt to recover the corresponding eigenvectors from those of

A using one single transform! This diﬃculty is of course related to the fact that
no isometry from L2(Rn) to L2(Rn ⊕Rn) can take a basis of the ﬁrst space to a
basis of the other (intuitively L2(Rn) is “much smaller” than L2(Rn ⊕Rn)). We
will overcome this diﬃculty by constructing an inﬁnite family of partial isometries
Wφ : L2(Rn) −→L2(Rn ⊕Rn) parametrized by the Schwartz space S(Rn); these
partial isometries are easily deﬁned in terms of the cross-Wigner transform.
18.2.1
Windowed wavepacket transforms
Here is the deﬁnition of the wavepacket transforms Wφ:
Deﬁnition 427. Let φ ∈S(Rn) be such that ∥φ∥L2(Rn) = 1. The linear mapping
Wφ : S(Rn) −→S(Rn ⊕Rn) deﬁned by
Wφψ = (2πℏ)n/2W(ψ, φ)
(18.17)
where W(ψ, φ) is the cross-Wigner distribution, is called the wavepacket transform
(for short WPT) with window φ.
Equivalently, taking into account Deﬁnition 171 of the cross-Wigner trans-
form,
Wφψ(z) =
 2
πℏ
n/2 ( 
TGR(z)ψ|φ)L2(Rn)
(18.18)
where 
TGR(z) is the Grossmann–Royer transform. In view of the formula (9.14)
the WPT is explicitly given by
Wφψ(z) =

1
2πℏ
n/2 	
Rn e−i
ℏp·yψ(x + 1
2y)φ(x −1
2y)dy.
(18.19)
Since W(ψ, φ) is deﬁned for ψ ∈S′(Rn) if φ ∈S(Rn) the wavepacket trans-
form extends into a mapping S′(Rn) −→S′(Rn). In fact:

300
Chapter 18.
Bopp Pseudo-diﬀerential Operators
Proposition 428. For every φ ∈S(Rn) the mapping Wφ : S(Rn) −→S(Rn ⊕Rn)
extends into an automorphism
Wφ : S′(Rn) −→S′(Rn ⊕Rn)
whose inverse (Wφ)−1 is calculated as follows: if Wφψ = Ψ then
ψ(x) =
1
(γ|φ)L2(Rn)
 2
πℏ
n/2 	
R2n Ψ(z0) 
TGR(z0)γ(x)dz
(18.20)
for each γ ∈S(Rn) such that (γ|φ)L2(Rn) ̸= 0. In particular, since φ is normalized,
ψ(x) =
 2
πℏ
n/2 	
R2n Ψ(z0) 
TGR(z0)φ(x)dz.
(18.21)
Proof. The fact that Wφ can be extended into an automorphism S′(Rn) −→
S′(Rn ⊕Rn) is a consequence of Proposition 192 and its Corollary 194. The in-
version formulas (18.20) and (18.21) immediately follow from formula (9.51) in
Proposition 184.
□
We mentioned at the beginning of the chapter that the Bargmann transform
is a device that allows one to turn functions on conﬁguration space into functions
on phase space. In the following problem you are asked to make explicit the re-
lationship between the Bargmann transform and the wavepacket transform for a
special Gaussian window.
Problem 429. Bargmann [6] has introduced an integral transform deﬁned on
L2(Rn) and whose values are functions on the complex space Cn. This transform
is deﬁned by the somewhat cumbersome formula
Bψ(z) = 2n/4
	
Rn e2πu·z−πu2−π
2 z2ψ(u)du.
(i) Show that the Bargmann transform is related to the short-time Fourier trans-
form deﬁned in formula (16.1) by
Vφ0ψ(x, −p) = eiπx·pBψ(z)e−π|z|2/2
(18.22)
where z = x + ip and φ0(z) = 2n/4e−π|x|2. [The proof of formula (18.22)
is purely computational; the reader who is in a hurry can ﬁnd a proof in
Gr¨ochenig’s book [82], pp. 53–54.]
(ii) Deduce from this a relation between the Bargmann transform and Wφ0.
The WPT Wφ has several important function-analytical properties: let us
begin by showing that it is a partial isometry onto a closed subspace of the Hilbert
space L2(Rn ⊕Rn).

18.2.
Intertwiners
301
Theorem 430.
(i) The standard WPT Wφ is an isometry of L2(Rn) onto a closed subspace Hφ
of L2(Rn ⊕Rn) and the adjoint W ∗
φ of Wφ is given by the formula
W ∗
φΨ =
 2
πℏ
n/2 	
R2n Ψ(z0) 
TGR(z0)φdz0
(18.23)
where 
TGR(z0) is the Grossmann–Royer operator;
(ii) The operator W ∗
φWφ is the identity on L2(Rn) and
Pφ = WφW ∗
φ : L2(Rn ⊕Rn) −→L2(Rn ⊕Rn)
is the orthogonal projection of L2(Rn ⊕Rn) onto Hφ.
Proof of (i). Let ψ ∈S(Rn). In view of Moyal’s identity (formula (9.41)) in The-
orem 182) we have:
(Wφψ|Wφψ′)L2 = (ψ|ψ′)L2(φ|φ)L2
that is, since φ has norm 1,
(Wφψ|Wφψ′)L2 = (ψ|ψ′)L2
hence the operator Wφ extends into an isometry of L2(Rn) onto a subspace Hφ
of L2(Rn ⊕Rn); that subspace is closed since it is homeomorphic to L2(Rn). Let
us prove formula (18.23) for the adjoint of Wφ. By deﬁnition of the adjoint of an
operator we have
(W ∗
φΨ|ψ)L2 = (Ψ|Wφψ)L2,
hence it suﬃces to show that
 2
πℏ
n/2 	
R2n Ψ(z0)( 
TGR(z0)φ|ψ)L2dz0 = (Ψ|Wφψ)L2.
(18.24)
Now, using Deﬁnitions (9.11) and (18.17) we have
( 
TGR(z0)φ|ψ)L2 = (πℏ)nW(φ, ψ)(z0) =
 πℏ
2
n/2 Wφψ(z0)
and hence
 2
πℏ
n/2 	
R2n Ψ(z0)( 
TGR(z0)φ|ψ)L2dz0 = (Ψ|Wφψ)L2
which was to be proven.
Proof of (ii). To prove that W ∗
φWφ is the identity on L2(Rn) we choose ψ ∈
L2(Rn) and observe that for every ψ′ ∈L2(Rn) we have
(W ∗
φWφψ|ψ′)L2 = (Wφψ|Wφψ′)L2 = (ψ|ψ′)L2;
it follows that W ∗
φWφψ = ψ. We have Pφ = P ∗
φ and PφP ∗
φ = Pφ hence Pφ is an
orthogonal projection. Since W ∗
φWφ is the identity on L2(Rn) the range of W ∗
φ is
L2(Rn) and that of Pφ is therefore precisely Hφ.
□

302
Chapter 18.
Bopp Pseudo-diﬀerential Operators
18.2.2
The intertwining property
The main interest of our wavepacket transforms comes from the fact that they
intertwine Bopp operators with the usual Weyl operators.
Proposition 431.
(i) The operator Wφ intertwines the operators T(z0) and 
T(z0), in the sense that
Wφ( 
T(z0)ψ) = T(z0)Wφψ;
(18.25)
(ii) and hence
AWφ = Wφ 
A and W ∗
φ A = 
AW ∗
φ.
(18.26)
Proof of (i). Making the change of variable y = y′ + x0 in Deﬁnition (18.17) of
Wφ we get
Wφ( 
T(z0)ψ, φ)(z) = e−i
ℏσ(z,z0)Wφψ(z −1
2z0)
which is precisely (18.25). Alternatively, this formula is a particular case of prop-
erty (9.25) of the cross-Wigner transform.
Proof of (ii). Applying Wφ to both sides of the formula

Aψ =

1
2πℏ
n 	
R2n aσ(z0) 
T(z0)ψdz0
deﬁning the Weyl operator 
A
Weyl
←→a, we get
Wφ 
Aψ =

1
2πℏ
n 	
R2n aσ(z0)Wφ[ 
T(z0)ψ]dz0 = AWφψ
and hence
Wφ 
Aψ =

1
2πℏ
n 	
R2n aσ(z0)[ T(z0)Wφψ]dz0 = A(Wφψ)
which is the ﬁrst equality (18.26). To prove the second equality it suﬃces to apply
this equality to W ∗
φ A = ( A∗Wφ)∗.
□
Let us have a look at how the windowed wavepacket transform behaves under
the action of symplectic linear automorphisms.
Proposition 432. Let S ∈Sp(2n, R) and ψ ∈L2(Rn). We have
Wφψ(S−1z) = W
Sφ(Sψ)(z)
(18.27)
where 
S is any of the two operators in the metaplectic group Mp(2n, R) covering S.
Proof. It follows immediately from the symplectic covariance formula
W(ψ, φ) ◦S−1 = W(
Sψ, 
Sφ)
satisﬁed by the cross-Wigner distribution (Proposition 217).
□

18.3.
Regularity results for Bopp operators
303
18.3
Regularity results for Bopp operators
As a rule, to each regularity result for a Weyl operator 
A
Weyl
←→a corresponds a
regularity result for the Bopp operator A
Bopp
←→a.
18.3.1
Boundedness results
We begin with a simple continuity statement:
Proposition 433. Let a ∈L2(Rn ⊕Rn). The operator A
Bopp
←→a is continuous on
L2(Rn ⊕Rn) −→L∞(Rn ⊕Rn) and we have the estimate
∥AΨ∥∞≤
 1
πℏ
n ∥a∥L2(R2n)∥Ψ∥L2(R2n)
(18.28)
for all Ψ ∈L2(Rn ⊕Rn).
Proof. It is of course suﬃcient to prove the inequality (18.28). By deﬁnition
AΨ(z) =

1
2πℏ
n 	
R2n aσ(z0) T(z0)Ψ(z)dz0
with T(z0)Ψ(z) = e−i
ℏσ(z,z0)Ψ(z −1
2z0). Hence, using Cauchy–Schwarz’s inequal-
ity:
| AΨ(z)|2 ≤

1
2πℏ
2n ∥a∥L2(R2n)
	
R2n |Ψ(z −1
2z0)|2dz0.
Setting u = z −1
2z0 in the integral this inequality becomes
| AΨ(z)|2 ≤
 1
πℏ
2n ∥a∥L2(R2n)∥Ψ∥L2(R2n)
which we set out to prove.
□
Let us now introduce the following notation: for an arbitrary window φ set
Lq
φ(R2n) = Wφ(M q
s (Rn)) ⊂Lq
s(R2n).
(18.29)
Clearly Lφ(R2n) is a closed linear subspace of Lq
s(R2n) (and hence a Banach space).
Proposition 434. Let A
Bopp
←→a be associated to the Weyl operator 
A
Weyl
←→a. If
a ∈M ∞,1
s
(R2n) then
Aω : Lq
φ(R2n) −→Lq
φ(R2n)
(continuously) for every window φ ∈S(Rn).
Proof. Let U ∈Lq
φ(R2n); by deﬁnition there exists u ∈M q
s (Rn) such that U =
Wφu. In view of the ﬁrst intertwining relation (18.26) we have
AWφu = Wφ 
Au
hence 
Au ∈M q
s (Rn) and 
A is bounded. It follows that Wφ 
Au ∈Lq
f,φ(R2n).
□

304
Chapter 18.
Bopp Pseudo-diﬀerential Operators
It is worthwhile (and important, in a quantum mechanical context) to note
that the spaces Lq
φ(R2n) cannot contain functions which are “too concentrated”
around a point; this is reminiscent of the uncertainty principle. In particular the
Schwartz space S(R2n) is not contained in any of the Lq
φ(R2n). This is an imme-
diate consequence of the Hardy uncertainty principle for the Wigner transform:
assume that u ∈S(Rn) is such that Wu ≤Ce−Mz·z for some C > 0 and a real
matrix M = M T > 0. Consider now the eigenvalues of JM; these are of the form
±iλj with λj > 0. Then we must have λj ≤1 for all j = 1, . . . , n. Equivalently, the
symplectic capacity c(WM) of the “Wigner ellipsoid” WM : Mz · z ≤1 satisﬁes
c(W) ≥π. This result in fact also holds true for the cross-Wigner transform: if
|W(u, φ)(z)| ≤Ce−Mz·z for some φ ∈S(Rn) then c(W) ≥π. Assume now that
U ∈Lq
f,φ(R2n) satisﬁes the sub-Gaussian estimate |U(z)| ≤Ce−Mz·z; by deﬁni-
tion of Lq
φ(R2n) this is equivalent to |W(u, φ)(z)| ≤Ce−Mz·z hence the ellipsoid
WM must have symplectic capacity at least equal to π.
Recall from Chapter 17 that the modulations space M ∞,1
s
(Rn ⊕Rn) contains
the weighted Sj¨ostrand classes consisting of all tempered distributions Ψ ∈S′(Rn⊕
Rn) such that
sup
z∈R2n |W(Ψ, Φ)(z, ζ)⟨z⟩s| ∈L1(Rn ⊕Rn).
(18.30)
We have seen that M ∞,1
s
(Rn⊕Rn) is a Banach ∗-algebra with respect to the Moyal
product ⋆ℏand the involution a −→a and that for every window Φ ∈S(Rn ⊕Rn)
there exists a constant CΦ > 0 such that
∥a ⋆ℏb∥Φ
M∞,1
s
≤CΦ∥a∥Φ
M∞,1
s
∥b∥Φ
M∞,1
s
for a, b ∈M ∞,1
s
(Rn ⊕Rn).
18.3.2
Global hypoellipticity properties
In Chapter 14 we introduced the global Shubin classes of symbols Γm
ρ ; we have
a ∈Γm
ρ (Rn ⊕Rn) if and only if a is a complex function in C∞(Rn ⊕Rn) such that
for every α ∈N2n there exists a constant Cα ≥0 with
|∂α
z a(z)| ≤Cα ⟨z⟩m−ρ|α|
for z ∈R2n.
(18.31)
In the context of Bopp pseudo-diﬀerential operators it is interesting to consider
symbols belonging to a subclass of HΓm1,m0
ρ
of Γm
ρ ; the consideration of these new
symbol spaces will enable us to prove both regularity and spectral results.
The following deﬁnition goes back to Shubin [147] (Chapter 4):
Deﬁnition 435. Let m0, m1, and ρ be real numbers such that m0 ≤m1 and 0 < ρ ≤
1. The symbol class HΓm1,m0
ρ
(Rn ⊕Rn) consists of all functions a ∈C∞(Rn ⊕Rn)
such that, for |z| suﬃciently large, the following properties hold:
C0|z|m0 ≤|a(z)| ≤C1|z|m1
(18.32)

18.3.
Regularity results for Bopp operators
305
for some C0, C1 ≥0 and, for every α ∈Nn there exists Cα ≥0 such that
|∂α
z a(z)| ≤Cα|a(z)| |z|−ρ|α|.
(18.33)
We denote by HGm1,m0
ρ
(Rn) the class of operators 
A : S(Rn) −→S′(Rn) with
τ-symbols aτ belonging to HΓm1,m0
ρ
(Rn ⊕Rn).
Thus, 
A ∈HΓm1,m0
ρ
(Rn ⊕Rn) means that for every τ ∈R there exists
aτ ∈HΓm1,m0
ρ
(Rn ⊕Rn) such that

Au(x) = (2π)−n
		
R2n ei(x−y)·ξaτ((1 −τ)x + τy, ξ)u(y)dydξ;
choosing τ = 1
2 this means, in particular, that every Weyl operator 
A
Weyl
←→a with
a ∈HΓm1,m0
ρ
(Rn ⊕Rn) is in HGm1,m0
ρ
(Rn ⊕Rn). It turns out that the condition
a ∈HΓm1,m0
ρ
(Rn ⊕Rn) is also suﬃcient, because if aτ ∈HΓm1,m0
ρ
(Rn ⊕Rn) is
true for some τ then it is true for all τ.
The spaces HΓm1,m0
ρ
(Rn⊕Rn) and HGm1,m0
ρ
(Rn) are subspaces of the Shubin
classes studied in Chapter 14:
HΓm1,m0
ρ
(Rn ⊕Rn) ⊂Γm1
ρ (Rn ⊕Rn),
HGm1,m0
ρ
(Rn) ⊂Gm1
ρ (Rn),
as trivially follows from their deﬁnition. An immediate consequence of Proposition
318 in Chapter 14 is the following:
Proposition 436. Every operator 
A ∈HΓm1,m0
ρ
(Rn ⊕Rn) is a continuous operator
S(Rn) −→S(Rn).
The classes HGm1,m0
ρ
(Rn ⊕Rn) have an interesting “global hypoellipticity”
property, which motivated Shubin’s interest (also see the contribution by Bog-
giatto et al. [16], p. 70). Recall that an operator 
A : S′(Rn) −→S′(Rn) is C∞-
hypoelliptic if
ψ ∈S′(Rn) and 
Aψ ∈C∞(Rn) =⇒ψ ∈C∞(Rn).
Shubin’s notion of global hypoellipticity is more useful in applications to quantum
mechanics than C∞hypoellipticity because it incorporates the decay at inﬁnity
of the involved functions or distributions.
Deﬁnition 437. We will say that a linear operator 
A : S′(Rn) −→S′(Rn) is
“globally hypoelliptic” if we have
ψ ∈S′(Rn) and 
Aψ ∈S(Rn) =⇒ψ ∈S(Rn).
(18.34)
Shubin ([147], Chapter IV, §23) has proved the existence of a left parametrix
of an operator 
A ∈HGm0,m1
ρ
(Rn ⊕Rn); more precisely he shows that:

306
Chapter 18.
Bopp Pseudo-diﬀerential Operators
Proposition 438. Let 
A ∈HGm0,m1
ρ
(Rn ⊕Rn);
(i) There exists an operator 
B ∈GΓ−m1,−m0
ρ
(Rn) such that 
B 
A = I + 
R where
the kernel of 
R is in S(Rn × Rn) and hence 
R : S′(Rn) −→S(Rn);
(ii) Any Weyl operator 
A belonging to the class HGm1,m0
ρ
(Rn ⊕Rn) is globally
hypoelliptic.
The statement (ii) actually immediately follows from the existence of the
parametrix 
B: let ψ ∈S′(Rn) and assume that φ = 
Aψ ∈S(Rn); then ψ =

Bφ −
Rψ. Now it is clear that 
Bφ ∈S(Rn) and we have 
Rψ ∈S(Rn) in view of
the proposition above.
We cannot however use the result above to prove global hypoellipticity prop-
erties for the Bopp operator A
Bopp
←→a: while it is clear from the way in which Bopp
operators compose (Proposition 425 above) that we have B A = I + R where R is
the Bopp operator corresponding to the Weyl operator 
R, it is not true in general
that the kernel of R is in S(R2n × R2n).
Exercise 439. Check this statement in detail using the formulas in Theorem 424.
To be able to prove global hypoellipticity results for Bopp operators we can
use the following reﬁnement of Proposition 438, also due to Shubin ([147], Chapter
IV, §25):
Proposition 440. Let 
A ∈HGm1,m0
ρ
(Rn ⊕Rn) be such that Ker 
A = Ker 
A∗= {0}.
Then there exists 
B ∈HG−m1,−m0
ρ
(Rn ⊕Rn) such that 
B 
A = 
A 
B = I (i.e., 
B is
a true inverse of 
A).
An immediate consequence of this result is:
Corollary 441. The Bopp operator A associated to a ∈GΓm1,m0
ρ
(Rn ⊕Rn) such
that Ker 
A = Ker 
A∗= {0} is globally hypoelliptic.
Proof. In view of Proposition 440 the operator 
A has an inverse 
B belonging to
HG−m1,−m0
ρ
(Rn ⊕Rn). In view of formula (18.15) in Proposition 425 the Bopp
operator B is then an inverse of A. Assume now that AΨ = Φ ∈S(Rn ⊕Rn); then
Ψ = BΦ. The result now follows from the observation that B maps S(Rn ⊕Rn)
into S(Rn ⊕Rn) and S′(Rn ⊕Rn) into S′(Rn ⊕Rn).
□

Chapter 19
Applications of Bopp Quantization
In this chapter we study a few selected applications of the techniques and material
introduced in the previous chapters. Needless to say, the list of topics we have
chosen is not exhaustive, and only limited due to constraints of place and space;
they very much reﬂect the taste – and knowledge. . . – of the author. Much is part
of ongoing research, and the interested reader is invited to consult the bibliographic
hints.
We begin by a rather straightforward application of the techniques of Bopp
calculus, and then show how it is a tool of choice for understanding deforma-
tion quantization from an operator point of view. We thereafter extend Bopp
calculus to a topic of current great interest in mathematical physics, namely “non-
commutative quantum mechanics” whose study we reduce to that of Bopp calculus.
19.1
Spectral results for Bopp operators
An essential property of the Bopp pseudo-diﬀerential operator A is that it has the
same (generalized) eigenvalues as the corresponding Weyl operator 
A. Moreover,
the corresponding eigenfunctions are obtained from those of 
A using wavepacket
transforms; this fact implies that in general the eigenvalues of A have inﬁnite
degeneracy.
19.1.1
A fundamental property of the intertwiners
Another essential property of the WPT is the following, which was announced in
Proposition 188:
Theorem 442. Let (φj)j and (ψj)j be arbitrary orthonormal bases of L2(Rn); the
vectors Φj,k = Wφjψk form an orthonormal basis of L2(Rn ⊕Rn). In particular
(Wψjψk)j,k is such a basis.
307
M.A. de Gosson, Symplectic Methods in Harmonic Analysis and in Mathematical Physics,  
Pseudo-Differential Operators 7, DOI 10.1007/978-3-7643-9992-4_
, © Springer Basel AG 2011 
19

308
Chapter 19.
Applications of Bopp Quantization
Proof. Using Moyal’s identity (9.41) we have
(Φj,k|Φj′,k′)L2 = (Wφjψk|Wφj′ ψk′)L2
= (2πℏ)n(W(ψk, φj)|W(ψk′, φj′))L2
= (ψk|ψk′)L2(φj|φj′)L2
hence the Φj,k form an orthonormal system of vectors in L2(Rn ⊕Rn). It is thus
suﬃcient to show that, if Ψ ∈L2(Rn ⊕Rn) is orthogonal to the family (Φj,k)j,k
(and hence to all the spaces Hφj), then Ψ = 0. Assume that (Ψ|Φjk)L2(R2n) = 0
for all indices j, k. Since we have
(Ψ|Φjk)L2 = (Ψ|Wφjψk)L2 = (W ∗
φjΨ|ψk)L2
it follows that W ∗
φjΨ = 0 for all j since (ψk)k is a basis. Using the sesquilinearity
of Wφ in φ we have in fact W ∗
φΨ = 0 for all φ ∈L2(Rn) since (φj)j also is a basis.
Let us show that this property implies that we must have Ψ = 0. Recall (formula
(18.23)) that the adjoint of the wavepacket transform W ∗
φ is given by
W ∗
φΨ =
 2
πℏ
n/2 	
R2n Ψ(z0) 
TGR(z0)φdz0
where 
TGR(z0) is the Grossmann–Royer operator. Let now ψ be an arbitrary ele-
ment of S(Rn); we have, using Deﬁnition (9.11) of the cross-Wigner transform,
(W ∗
φΨ|ψ)L2 =
 2
πℏ
n/2 	
R2n Ψ(z)( 
TGR(z)φ|ψ)L2dz
= (2πℏ)n/2
	
R2n Ψ(z)W(ψ, φ)(z)dz.
Let us now view Ψ ∈L2(Rn ⊕Rn) as the Weyl symbol1 of an operator 
AΨ. In
view of formula (10.8) we have
(2πℏ)n/2
	
R2n Ψ(z)W(ψ, φ)(z)dz = ( 
AΨψ|φ)L2
and the condition W ∗
φΨ = 0 for all φ ∈S(Rn) is thus equivalent to ( 
AΨψ|φ)L2 = 0
for all φ, ψ ∈S(Rn). It follows that 
AΨψ = 0 for all ψ and hence 
AΨ = 0. Since
the Weyl correspondence is one-to-one we must have Ψ = 0 as claimed.
□
Problem 443. State (and prove) a generalization of Theorem 442 to Weyl–Heisen-
berg frames.
1I am grateful to Harald Stockinger (NuHAG) for having pointed out this approach to me.

19.1.
Spectral results for Bopp operators
309
19.1.2
Generalized eigenvalues and eigenvectors of a Bopp operator
In this subsection we give an application of the machinery developed above to spec-
tral results for Bopp operators. In order to avoid delicate domain questions we will
deal here with generalized eigenvalues and eigenvectors; more speciﬁc results will
be studied in the next subsection when we make some additional assumptions on
the symbols. In that context the Banach Gelfand triple (S0(Rn), L2(Rn), S′
0(Rn))
(where S0(Rn) is the Feichtinger algebra) is a useful device.
Let us slightly extend the notion of generalized eigenvalues and eigenfunctions
we brieﬂy discussed in Subsection 16.4.2:
Deﬁnition 444. Let 
A be an operator on L2(Rn). We assume that 
A is continuous
on S(Rn) −→S(Rn), and hence has a continuous extension S′(Rn) −→S′(Rn).
Setting (ψ|θ) = ⟨ψ, θ⟩for ψ ∈S′(Rn) and θ ∈S(Rn) a distribution ψ ∈S′(Rn) is
called a generalized eigenvector of 
A corresponding to the (generalized) eigenvalue
λ if ψ ̸= 0 and we have
(ψ| 
A∗θ) = λ(ψ|θ)
for all θ ∈S(Rn) [observe that we do not require ψ to be in the domain D 
A of

A]. We will similarly write ((Ψ|Θ)) = ⟨⟨Ψ, Θ⟩⟩where ⟨⟨·, ·⟩⟩is the distributional
bracket on Rn ⊕Rn. The distribution Ψ ∈S′(Rn ⊕Rn) is a generalized eigen-
function of A : S(Rn ⊕Rn) −→S(Rn ⊕Rn) if Ψ ̸= 0 and there exists λ such
that
((Ψ| A∗Θ)) = λ((Ψ|Θ))
for all Θ ∈S(Rn ⊕Rn).
With this deﬁnition and notation we have the following result:
Theorem 445.
(i) The generalized eigenvalues of the operators 
A and A are the same;
(ii) Let ψ be a generalized eigenvector of 
A. Then, for every φ ∈S(Rn) the vector
Ψ = Wφψ satisﬁes ((Ψ| A∗Θ)) = λ((Ψ|Θ)) for all for all Θ ∈S(Rn ⊕Rn); in
particular if Ψ ̸= 0 it is a generalized eigenvector of A corresponding to the
same generalized eigenvalue.
(iii) Conversely, if Ψ is a generalized eigenvector of A then ψ = W ∗
φΨ is a gen-
eralized eigenvector of 
A corresponding to the same eigenvalue.
Proof. (i) Let us show that if
(ψ| 
A∗θ) = λ(ψ|θ)
for every θ ∈S(Rn)
then
((Wφψ| A∗Θ)) = λ((Wφψ|Θ))
for every Θ ∈S(Rn ⊕Rn).

310
Chapter 19.
Applications of Bopp Quantization
We have
((Wφψ| A∗Θ)) = ((ψ|W ∗
φ A∗Θ)) = ((ψ| 
A∗W ∗
φΘ))
= λ((ψ|W ∗
φΘ))
= λ((Wφψ|Θ))
hence the claim since W ∗
φΘ ∈S(Rn). Suppose conversely that ((Ψ| A∗Θ)) =
λ((Ψ|Θ)) for every Θ ∈S(Rn ⊕Rn). We have to show that (W ∗
φΨ| 
A∗θ) =
λ(W ∗
φΨ|θ) for every θ ∈S(Rn). Now,
(W ∗
φΨ| 
A∗θ) = (Ψ|Wφ 
A∗θ) = (Ψ| A∗Wφθ)
= λ((Ψ|Wφθ)) = λ((W ∗
φΨ|θ))
proving our claim. That every eigenvalue of 
A also is an eigenvalue of A is clear:
if 
Aψ = λψ for some ψ ̸= 0 then
A(Wφψ) = Wφ 
Aψ = λWφψ
and Ψ = Wφψ ̸= 0; this proves at the same time that Wφψ is an eigenvector of

A because Wφ has kernel {0}. (ii) Assume conversely that AΨ = λΨ for Ψ ∈
L2(Rn ⊕Rn), Ψ ̸= 0, and λ ∈R. For every φ we have

AW ∗
φΨ = W ∗
φ AΨ = λW ∗
φΨ
hence λ is an eigenvalue of 
A and ψ an eigenvector if ψ = W ∗
φΨ ̸= 0. We have
Wφψ = WφW ∗
φΨ = PφΨ
where Pφ is the orthogonal projection on the range Hφ of Wφ. Assume that ψ = 0;
then PφΨ = 0 for every φ ∈S(Rn), and hence Ψ = 0 in view of Theorem 442.
□
Let us specialize the results above to the case where A is (essentially) self-
adjoint:
Corollary 446. Suppose that 
A is an essentially self-adjoint operator on L2(Rn)
and that each of the eigenvalues λ0, λ1, . . . , λj, . . . has multiplicity 1. Let ψ0, ψ1,
. . . , ψj, . . . be the corresponding sequence of orthonormal eigenvectors. Let Ψj be
an eigenvector of A corresponding to the eigenvalue λj. There exists a sequence
(αj,k)k of complex numbers such that
Ψj =

ℓ
αj,ℓΨj,ℓwith Ψj,ℓ= Wψℓψj ∈Hj ∩Hℓ.
(19.1)
Proof. We know from Theorem 445 above that 
A and A have the same eigenvalues
and that Ψj,k = Wψkψj satisﬁes AΨj,k = λjΨj,k. Since 
A is self-adjoint its eigen-
vectors ψj form an orthonormal basis of L2(Rn); it follows from Theorem 442 that

19.1.
Spectral results for Bopp operators
311
the Ψj,k form an orthonormal basis of L2(Rn ⊕Rn), hence there exist non-zero
scalars αj,k,ℓsuch that Ψj = 
k,ℓαj,k,ℓΨk,ℓ. We have, by linearity and using the
fact that AΨk,ℓ= λkΨk,ℓ,
AΨj =

k,ℓ
αj,k,ℓAΨk,ℓ=

k,ℓ
αj,k,ℓλkΨk,ℓ.
On the other hand we also have
AΨj = λjΨj =

j,k
αj,k,ℓλjΨk,ℓ
and this is only possible if αj,k,ℓ= 0 for k ̸= j; setting αj,ℓ= αj,j,ℓformula
(19.1) follows. That Ψj,ℓ∈Hj ∩Hℓis clear using the deﬁnition of Hℓand the
sesquilinearity of the cross-Wigner transform.
□
Besides the fact that they intervene in global hypoellipticity questions, one
of the main appeals of Shubin’s classes HΓm1,m0
ρ
and HGm1,m0
ρ
comes from the
following property, which is essential for the proof of the main result (Theorem
448) which we will prove in a moment:
Theorem 447. Let 
A ∈HGm1,m0
ρ
(Rn ⊕Rn) with m0 > 0. If 
A is formally self-
adjoint, that is if ( 
Au|v)L2 = (u| 
Av)L2 for all u, v ∈C∞
0 (Rn), then 
A is essen-
tially self-adjoint and has discrete spectrum in L2(Rn). Moreover there exists an
orthonormal basis of eigenfunctions φj ∈S(Rn) (j = 1, 2, . . . ) with eigenvalues
λj ∈R such that limj→∞|λj| = ∞.
We remark that the global hypoellipticity property of the operators 
A−λI ∈
HGm1,m0
ρ
automatically implies that the orthonormal basis of eigenfunctions φj
is in the Schwartz space S(Rn).
We now have all the elements we need to prove the main result of this section:
Theorem 448. Let 
A ∈HGm1,m0
ρ
(Rn ⊕Rn).
(i) The operators 
A and A have the same eigenvalues; if ψ is an eigenfunction
of A corresponding to the eigenvalue λ then Ψφ = Wφψ is an eigenfunction
of A corresponding to λ, for every φ, and we have Ψφ ∈S(Rn ⊕Rn).
(ii) Assume in addition that m0 > 0 and that 
A is formally self-adjoint. Then A
has discrete spectrum (λj)j∈N and limj→∞|λj| = ∞.
(iii) The eigenfunctions of A are in this case given by Φjk = Wφjφk where the φj
are the eigenfunctions of A.
(iv) We have Φjk ∈S(Rn ⊕Rn) and the Φjk form an orthonormal basis of
L2(Rn ⊕Rn).

312
Chapter 19.
Applications of Bopp Quantization
Proof of (i). That every eigenvalue of 
A also is an eigenvalue of A is clear: if

Aψ = λψ for some ψ ̸= 0 then
A(Wφψ) = Wφ 
Aψ = λ(Wφψ)
and Wφψ ̸= 0 because Wφ is injective; this proves at the same time that Wφψ is
an eigenfunction of A. Assume conversely that AΨ = λΨ for Ψ ̸= 0. For every φ
we have, using the equality W ∗
φ A = 
AW ∗
φ,

AW ∗
φΨ = W ∗
φ AΨ = λW ∗
φΨ,
hence λ is an eigenvalue of 
A and W ∗
φΨ will be an an eigenfunction of 
A if it is
diﬀerent from zero. Let us prove this is indeed the case. Recall that WφW ∗
φ = Pφ
is the orthogonal projection on Hφ. Assume that W ∗
φΨ = 0; then PφΨ = 0 for
every φ ∈S(Rn), and hence Ψ = 0 in view of Theorem 442; but this is not
possible since Ψ is an eigenfunction. That we have Ψφ ∈S(Rn ⊕Rn) is clear since
Wφ : S(Rn) −→S(Rn ⊕Rn).
Proof of (ii)–(iv). Properties (ii)–(iv) follow immediately from property (i) using
the properties of the Shubin classes HGm1,m0
ρ
(Rn ⊕Rn).
□
19.1.3
Application: the Landau problem
The “Landau problem” is a classical topic from mathematical physics; it is basi-
cally the study of Hamiltonian operators arising in the study of particles moving
under the action of a magnetic ﬁeld (see for instance Landau and Lifshitz [113]).
It has mathematically very interesting ramiﬁcations, such as the study of the Hall
eﬀect (both classical and quantum); see for instance the overview [11] by Bellissard
et al. In our study of the spectral properties of the Landau problem for a uniform
magnetic ﬁeld we are following the approach in our paper de Gosson [71] where
we showed the strong relationship between this problem and Bopp calculus.
The derivation of the so-called magnetic operator can be found in a multitude
of textbooks; we are following here our exposition in [65]. Consider a hydrogen
atom placed in a magnetic ﬁeld −→
B = (Bx, By, Bz). Neglecting spin and relativistic
eﬀects the Hamiltonian function is
H(−→r , −→p ) =
1
2m
−→p −e
c
−→
A
2
−e2
r
where we are using the notation −→r = (x, y, z), −→p = (pxpy, pz), r = |−→r |; the vector
potential −→
A is a solution of the equation −→
B = ∇−
→
r ×−→
A (it is of course not uniquely
determined by this relation). Assuming that r is very large (which is the case for
instance when the atom is in a highly excited state) we neglect the term e2/r and
the Hamiltonian function becomes
H(−→r , −→p ) =
1
2m
−→p −e
c
−→
A
2
.

19.1.
Spectral results for Bopp operators
313
Supposing that the magnetic ﬁeld −→
B is constant and uniform, and that its direction
is the z-axis, the coordinates of the vector potential satisfy the equations
∂Ay
∂z −∂Az
∂y = ∂Ax
∂z −∂Az
∂x = 0 , ∂Ay
∂x −∂Ax
∂y = Bz.
Choosing the solution Ax = −1
2Bz, Ay = 1
2Bzy, Az = 0 (it is called the “symmet-
ric gauge”) the Hamiltonian takes the explicit form
H(−→r , −→p ) = p2
2m + e2B2
z
8mc2 (x2 + y2) −eBz
2mc(xpy −ypx)
(19.2)
with p = |−→p |. Since the problem is essentially planar, we can actually assume
pz = 0; setting ωL = eBz/2mc (“Larmor frequency”) this can be rewritten in the
form
Hmag(−→r , −→p ) =
1
2m(p2
x + p2
y) + mω2
L
2
(x2 + y2) −ωL(xpy −ypx).
(19.3)
The corresponding Weyl operator is then given by

Hmag = −ℏ2
2m∆x,y −iℏωL

y ∂
∂x −x ∂
∂y

+ mω2
L
2
(x2 + y2)
(19.4)
where ∆x,y is the Laplace operator in the variables x and y. Notice that the
associated Schr¨odinger equation can be solved exactly (in principle) using the
theory of the metaplectic group since the operator 
H is the “quantization” of the
quadratic Hamiltonian (19.3).
A closer look at formula (19.4) reveals that the magnetic operator 
Hmag is
obtained from the simple Hamiltonian function
H = ω
2 (p2 + x2)
(19.5)
on R2 by setting ωL =

ω/m and using the “quantization rules” x −→
X and
p −→Y where

X = x +
iℏ
√mω
∂
∂y
, Y = y −
iℏ
√mω
∂
∂x.
(19.6)
Of course, these rules are just Bopp quantization when ℏis replaced with ℏ/√mω
(and p with y). Thus, the theory developed in Chapter 18 applies mutatis mu-
tandis; for instance the intertwining operator Wφ should be replaced with a new
operator W mag
φ
deﬁned as follows: ﬁrst write the cross-Wigner transform by chang-
ing ℏinto ℏ/√mω; this leads to the formula
W mag(ψ, φ)(z) =
 √mω
2πℏ
n 	
Rn e−i√mω
ℏ
p·yψ(x + 1
2y)φ(x −1
2y)dy.
(19.7)

314
Chapter 19.
Applications of Bopp Quantization
Then, one replaces the formula Wφψ = W(ψ, φ) with
W mag
φ
ψ =

2πℏ
√mω
n/2
W mag(ψ, φ).
This leads to the following explicit form for the intertwiner W mag
φ
:
W mag
φ
ψ(z) =
 √mω
2πℏ
n/2 	
Rn e−i√mω
ℏ
p·yψ(x + 1
2y)φ(x −1
2y)dy.
(19.8)
Let us choose units in which ℏ= 1. The symbol of the Bopp operator (19.5)
is in the Shubin class HΓ2,2
1 (R2), hence Theorem 448 applies. The eigenvalues of

H are thus those of the operator

H = ω
2 (−∂2
x + x2).
(19.9)
These are well known, they are the numbers λj = 2j + 1 (j = 0, 1, 2, . . .); the cor-
responding eigenfunctions φj are conveniently rescaled Hermite functions. Using
well-known formulae expressing the cross-Wigner transforms of pairs of Hermite
functions in terms of Laguerre polynomial Lk
j of degree j and order k (see, e.g.,
[163]) one recovers the usual expressions
Φj+k,k(z) = (−1)j
1
√
2π

j!
(j+k)!
 1
2 2−k
2 zkLk
j ( 1
2|z|2)e−|z|2
4
and Φj,j+k = Φj+k,k when k = 0, 1, 2, . . . for the eigenfunctions of H found in the
physics literature (see, e.g., Landau and Lifschitz [113]).
Another very interesting property of the Landau Hamiltonian is the following:
Proposition 449. The partial diﬀerential operator

Hmag = −ℏ2
2m∆x,y −iℏωL

y ∂
∂x −x ∂
∂y

+ mω2
L
2
(x2 + y2)
is globally hypoelliptic: if Ψ ∈S′(R2) is such that 
HmagΨ ∈S(R2) then Ψ ∈S(R2).
Proof. This immediately follows from Corollary 441 since the harmonic oscillator
symbol (19.9) is in HΓ2,2
1 (R2) and the corresponding operator has no eigenvalue
equal to zero.
□
19.2
Bopp calculus and deformation quantization
We show here that “deformation quantization”, which is an alternative way of
doing quantum mechanics, is essentially the same thing as Bopp calculus. For a
very nice introduction to the topic (readable, following the authors, by an under-
graduate student. . . ) see Hancock et al. [90]. Deformation quantization originates

19.2.
Bopp calculus and deformation quantization
315
from the pioneering work of Weyl, Wigner, Groenewold, Moyal; it is a very active
branch not only of physics, but also of mathematics: for instance Kontsevich’s
work [109] on the deformation quantization of Poisson algebras was part of the
reason he was awarded the Fields medal in 1998. More about the historical origins
below.
19.2.1
Deformation quantization: motivation
The basic philosophy of deformation quantization is that quantization can be
viewed as a deformation of the structure of the algebra of classical observables,
rather than a radical change in the nature of the observables. By “quantization” we
mean the procedure familiar from quantum mechanics which consists in associating
to an “observable” a self-adjoint operator; from a mathematical viewpoint, this is
just the Weyl correspondence (or one of its variants) which allows one to associate
to a real symbol an essentially self-adjoint operator.
The genesis of the modern theory of deformation quantization roughly goes
as follows (we are taking this historical account from Bordemann [19, 20]. In
1974 Flato, Lichnerowicz, and Sternheimer studied in [56, 57] deformations of the
Lie algebra structure deﬁned by the Poisson brackets on the algebra of smooth
functions on a symplectic manifold. In 1975, Vey [157] pursued their work in a
diﬀerential context and constructed a deformation on Rn ⊕Rn which turns out to
be precisely the Moyal bracket. This opened the path to deformation quantization
presented in 1976 by Flato, Lichnerowicz, and Sternheimer in [58]. Two years
later, in two brilliant papers [9, 10] Bayen, Flato, Fronsdal, Lichnerowicz, and
Sternheimer not only posed the mathematical foundations of deformation theory,
but also proposed physical applications. They moreover showed that the Moyal star
product could be deﬁned on any symplectic manifold which admits a symplectic
connection. Their study of star products on manifolds used Gerstenhaber’s [61]
theory of deformations of associative algebras, where Hochschild cohomology plays
a central role. The work of Bayen et al. drew the attention of both physical and
mathematical communities to a well-posed mathematical problem of describing
and classifying up to some natural equivalence the formal associative diﬀerential
deformations of the algebra of smooth functions on a manifold; it can therefore be
viewed as the birth certiﬁcate of deformation quantization.
The notion of Poisson bracket, brieﬂy reviewed in the introductory chapter
where the basics of Hamiltonian mechanics were exposed, can be generalized in
the following way. Let us call Poisson algebra a real vector space A equipped with
a commutative and associative algebra structure (f, g) −→fg and a Lie algebra
structure (f, g) −→{g, h} satisfying the Leibniz law
{fg, h} = f{g, h} + {f, h}g.
Note that since {·, ·} is a Lie algebra structure, it satisﬁes in particular the Jacobi
identity
{f, {g, h}} + {h, {f, g}} + {g, {h, f}} = 0.

316
Chapter 19.
Applications of Bopp Quantization
Keeping this deﬁnition in mind, a Poisson manifold is a manifold M such that
the space A = C∞(M) is a Poisson algebra for the usual (pointwise) multiplication
of functions and some prescribed Lie algebra structure. For instance, if M =
Rn ⊕Rn one can choose the usual Poisson bracket.
Let us denote by C∞(M)[[ℏ]] the ring of all formal series in ℏwith coeﬃcients
in C∞(M); here ℏis just viewed as a symbol (the “deformation parameter”). An
element f ∈C∞(M)[[ℏ]] can thus be symbolically written
f =
∞

j=0
 iℏ
2
j fk
where the fk’s are in C∞(M); we prefer to choose 1
2iℏas deformation parameter
rather than ℏ.
A starproduct on (or formal deformation of) C∞(M) is a map
⋆: C∞(M) × C∞(M) −→C∞(M)[[ℏ]]
associating to each pair satisfying (f, g) of function in C∞(M) a formal series
f ⋆g =
∞

j=0
 iℏ
2
j Cj(f, g)
the following rules:
• Formal associativity: (f ⋆g) ⋆h = f ⋆(g ⋆h);
• C0(f, g) = fg and the Cj’s are bidiﬀerential operators;
• C1(f, g) = 2{f, g} where {·, ·} is the Poisson bracket.
We will not pursue the abstract study of deformation quantization here and
refer to the aforementioned paper by Kontsevich [109].
19.2.2
The Moyal product and bracket
Recall (formula (10.21)) that by deﬁnition c = a ⋆ℏb is the Weyl symbol of the
product 
C = 
A 
B with 
A
Weyl
←→a and 
B
Weyl
←→b:
a ⋆ℏb
Weyl
←→
A 
B
(assuming that 
A 
B is deﬁned as an operator S(Rn) −→S′(Rn)). We thus have
the explicit formula
a ⋆ℏb(z) =

1
4πℏ
2n 		
R4n e
i
2ℏσ(z′,z′′)a(z + 1
2z′)b(z −1
2z′′)dz′dz′′.
(19.10)

19.2.
Bopp calculus and deformation quantization
317
This formula can be rewritten in several equivalent ways; for instance the change
of variables u = z + 1
2z′, v = z −1
2z′′ leads to the formula
a ⋆ℏb(z) =
 1
πℏ
2n 		
R4n e
2i
ℏ∂σ(u,z,v)a(u)b(v)dudv
(19.11)
where ∂σ is the antisymmetric cocycle deﬁned by
∂σ(u, z, v) = σ(u, z) −σ(u, v) + σ(z, v).
(19.12)
Exercise 450. Show that for suitable symbols a and b the following identity holds:
	
R2n a ⋆ℏb(z)dz =
	
R2n a(z)b(z)dz =
	
R2n b ⋆ℏa(z)dz.
[Hint: use Proposition 284 in Chapter 12.]
The Moyal product is associative: when both sides are deﬁned we have
(a ⋆ℏb) ⋆ℏc = a ⋆ℏ(b ⋆ℏc)
(19.13)
because composition of operators is associative. It is obviously also bilinear:
a ⋆ℏ(b + c) = a ⋆ℏb + a ⋆ℏc,
(b + c) ⋆ℏa = b ⋆ℏa + c ⋆ℏa.
Note that in general a ⋆ℏb ̸= b ⋆ℏa.
Exercise 451. Show that a ⋆ℏb = b ⋆ℏa.
The important point is that the Moyal product can be deﬁned in terms of
Bopp pseudo-diﬀerential operators:
Proposition 452. Let 
A
Weyl
←→a and 
B
Weyl
←→b. We assume that b ∈S(Rn ⊕Rn) (or,
more generally, that 
C = 
A 
B exists). We have
a ⋆ℏb = Ab.
(19.14)
Proof. We have, by deﬁnition of the symplectic Fourier transform and the opera-
tors T(z0),
Ab(z) =

1
2πℏ
2n 	
R2n e−i
ℏσ(z,z0)
	
R2n e−i
ℏσ(z0,z′)a(z′)dz′

× b(z −1
2z0)dz0dz′.
Setting v = z0 and u = 2(z −z′) and noting that by the antisymmetry of σ
σ(z, v) + σ(v, z + 1
2u) = −1
2σ(u, v)
the right-hand side is precisely a ⋆ℏb.
□
The result above actually reduces the study of deformation quantization to
the study of an algebra of pseudo-diﬀerential operators (Bopp calculus); this ap-
proach was initiated in de Gosson and Luef [76] using the methods in de Gosson
[68, 69, 71].

318
Chapter 19.
Applications of Bopp Quantization
19.3
Non-commutative quantum mechanics
Admittedly, “non-commutative quantum mechanics” (NCQM) is a misnomer: one
of the most salient properties of traditional standard quantum mechanics is pre-
cisely that it deals with operators which do not commute! We will however stick
to this somewhat unfortunate terminology, which is standard among physicists.
The possibility of non-commuting position operators was already put forward
by Heisenberg in 1930, and taken up by many physicists (Peierls, Pauli, Snyder).
Even though Werner Heisenberg had already hinted, in the 1930s, at the possibility
of non-commuting position operators, one can say that the act of birth of NCQM
goes back to 1947 when Snyder [152] considered non-commuting coordinates on
space-time in order to discard the ultraviolet divergences in quantum ﬁeld theory.
Snyder showed that his approach was compatible with Lorentz invariance, that is
with the theory of special relativity. One of the main incentives for studying NCQM
comes from the quest for a theory of quantum gravity, and it is widely expected
that such a theory will determine a modiﬁcation of the structure of space-time of
some non-commutative nature [30, 36, 145, 155]; also see the excellent paper by
Binz et al. [14].
We are going to show that NCQM is just a variant of Bopp quantization,
which allows us to reduce its study to Bopp and Weyl calculus.
19.3.1
Background
The Weyl operators corresponding to the symbols xj and pj are the operators

Xj =multiplication by xj and 
Pj = −iℏ∂/∂xj. These operators trivially satisfy
the “canonical commutation relations”
[ 
Xj, 
Xk] = [ 
Pj, 
Pk] = 0 , [ 
Xj, 
Pk] = iℏδjk
(19.15)
on their common domain. Setting 
Zα = 
Xα if 1 ≤α ≤n and Zα = Pα−n if
n + 1 ≤α ≤2n these relations can be written more compactly as
[ 
Zα, 
Zβ] = iℏjαβ , 1 ≤α, β ≤2n
(19.16)
where the jαβ are the entries of the standard symplectic matrix J =

0
I
−I
0

.
The passage to non-commutative quantum mechanics consists in replacing the
operators 
Zα by new operators, which we denote by Zα so that instead of (19.16)
we have the new commutation relations
[ Zα, Zβ] = iℏωαβ , 1 ≤α, β ≤2n
(19.17)
where Ω= (ωαβ)1≤α,β≤2n is the 2n × 2n antisymmetric matrix deﬁned by
Ω=

ℏ−1Θ
I
−I
ℏ−1N

(19.18)

19.3.
Non-commutative quantum mechanics
319
where Θ = (θαβ)1≤α,β≤n and N = (ηαβ)1≤α,β≤n are antisymmetric matrices. Since
Ω= J + ℏ−1
Θ
0
0
N

the matrix Ωcan be viewed as a perturbation of the standard symplectic matrix
J, and one can thus expect that it is invertible if Θ and n are small enough. In
fact, Bastos, Dias, and Prata (see [8]) prove the following:
Proposition 453. We have det Ω> 0 if the following conditions hold:
θαβηγδ < ℏ2 for 1 ≤α < β ≤n and 1 ≤γ < δ ≤n .
(19.19)
We will from now on assume that these conditions are satisﬁed.
Writing Zα = 
Xα if 1 ≤α ≤n and Zα = Pα−n if n + 1 ≤α ≤2n, this
amounts to replacing the CCR (19.15) with
[ 
Xα, 
Xβ] = θαβ , [ Pα, Pβ] = ηαβ , [ 
Xα, Pβ] = iℏδαβ.
(19.20)
Let us now make the following explicit choices for the operators 
Xα and Pα:
we set

Xα = xα + 1
2iℏ∂pα + 1
2i

β θαβ∂xβ,
(19.21)
Pα = pα −1
2iℏ∂xα + 1
2i

β ηαβ∂pβ.
(19.22)
These relations suggest that we represent Z = ( Z1, . . . , Z2n) by the vector operator
Z = z + 1
2iℏΩ∂z
(19.23)
which acts on functions deﬁned on the phase space Rn ⊕Rn. In analogy with the
theory of Bopp operators this formula suggests that we consider generalized Bopp
operators of the type
Aω = a(z + 1
2iℏΩ∂z)
where ω is the symplectic form deﬁned by
ω(z, z′) = z · Ω−1z′ = −Ω−1z · z′.
(19.24)
Note that the invertibility of the antisymmetric matrix Ωimplies that we must
have det Ω> 0 (this follows readily from the properties of the Pfaﬃan of an an-
tisymmetric matrix). Since JT = −J, the symplectic form ω reduces to the stan-
dard symplectic form σ when Ω= J. Let us denote by Σ a linear automorphism
of Rn ⊕Rn such that σ = Σ∗ω; equivalently ΣJΣT = Ω. Thus Σ is a symplec-
tomorphism (Rn ⊕Rn, σ) −→(Rn ⊕Rn, ω). Clearly (det Σ)2 = det Ω> 0 so we
are free to choose Σ such that det Σ > 0. The mapping Σ is sometimes called the

320
Chapter 19.
Applications of Bopp Quantization
“Seiberg–Witten map” in the physics literature; its existence is of course mathe-
matically a triviality, because all symplectic structures with constant coeﬃcients
are isomorphic (see [67], §1.1.2). Writing Σ in block-matrix form
A
B
C
D

, the
condition ΣJΣT = Ωis equivalent to the relations
ABT −BAT = ℏ−1Θ , CDT −DCT = ℏ−1N , ADT −BCT = I.
Of course, the automorphism Σ is not uniquely deﬁned: if Σ∗ω = Σ′∗ω then
Σ−1Σ′ ∈Sp(2n, R).
19.3.2
The operators Tω(z0) and Fω
Let ω be an arbitrary symplectic form with constant coeﬃcients on Rn ⊕Rn (not
necessarily the symplectic form (19.24)). It is thus represented by some invertible
antisymmetric matrix Ωwith det Ω> 0:
ω(z, z′) = z · Ω−1z′ = (ΩT )−1z · z′.
To ω we associate the operator Tω(z0) : S(Rn ⊕Rn) −→S(Rn ⊕Rn) deﬁned, for
z0 ∈R2n, by
Tω(z0)Ψ(z) = e−i
ℏω(z,z0)Ψ(z −1
2z0).
(19.25)
Of course Tω(z0) extends into an operator S′(Rn ⊕Rn) −→S′(Rn ⊕Rn) whose
restriction to L2(Rn ⊕Rn) is unitary: we have
∥Tω(z0)Ψ∥L2(R2n) = ∥Ψ∥L2(R2n)
for all Ψ ∈L2(Rn⊕Rn). The operators Tω(z0) are of course strongly reminiscent of
the Heisenberg–Weyl operators; the major diﬀerence is that they act on functions
or distributions) deﬁned on phase space Rn⊕Rn, and not on “conﬁguration space”
Rn. It turns out that the operators Tω(z0) satisfy relations similar to those satisﬁed
by the operators T(z0) deﬁned in the previous chapter:
Proposition 454. We have, for all z0, z1 ∈R2n,
Tω(z0 + z1) = e−i
2ℏω(z0,z1) Tω(z0) Tω(z1),
(19.26)
Tω(z0) Tω(z1) = e
i
ℏω(z0,z1) Tω(z1) Tω(z0).
(19.27)
Proof. It is straightforward, replacing σ by ω in Proposition 420.
□
Deﬁnition 455. The ω-symplectic transform Fω is deﬁned by the formula
Fωa(z) =

1
2πℏ
n (det Ω)−1/2
	
R2n e−i
ℏω(z,z′)a(z′)dz′
(19.28)
when a ∈S(Rn ⊕Rn).

19.3.
Non-commutative quantum mechanics
321
Clearly Fω extends in the same way as the ordinary Fourier transform into
an involutive automorphism of S′(Rn ⊕Rn) (also denoted by Fω) and whose
restriction to L2(Rn ⊕Rn) is unitary, and if ω = σ we recover the symplectic
Fourier transform previously studied.
Let us express the operator Aω = a(z + 1
2iℏΩ∂z) in terms of Fωa and Tω(z0).
Proposition 456. Let Aω be the operator on Rn ⊕Rn with Weyl symbol
aΩ(z, ζ) = a(z −1
2Ωζ).
(19.29)
We have
Aω =

1
2πℏ
n (det Ω)−1/2
	
R2n Fωa(z) Tω(z)dz.
(19.30)
Proof. Let us denote by B the right-hand side of (19.30). We have, setting u =
z −1
2z0,
BΨ(z) =

1
2πℏ
n (det Ω)−1/2
	
R2n Fωa(z0)e−i
ℏω(z,z0)Ψ(z −1
2z0)dz0
=
 2
πℏ
n (det Ω)−1/2
	
R2n Fωa[2(z −u)]e
2i
ℏω(z,u)Ψ(u)du,
hence the kernel of B is given by
K(z, u) =
 2
πℏ
n (det Ω)−1/2Fωa[2(z −u)]e
2i
ℏω(z,u).
It follows that the Weyl symbol b of B is given by
b(z, ζ) =
	
R2n e−i
ℏζ·ζ′K(z + 1
2ζ′, z −1
2ζ′)dζ′
=
 2
πℏ
n (det Ω)−1/2
	
R2n e−i
ℏζ·ζ′Fωa(2ζ′)e−2i
ℏω(z,ζ′)dζ′,
that is, using the obvious relation
ζ · ζ′ + 2ω(z, ζ′) = ω(2z −Ωζ, ζ′)
together with the change of variables z′ = 2ζ′,
b(z, ζ) =
 2
πℏ
n (det Ω)−1/2
	
R2n e−i
ℏω(2z−Ωζ,ζ′)Fωa(2ζ′)dζ′
=

1
2πℏ
n (det Ω)−1/2
	
R2n e−i
ℏω(z−1
2 Ωζ,z′)Fωa(z′)dz′,
that is, using the fact that FωFω is the identity,
b(z, ζ) = a(z −1
2Ωζ) = aΩ(z, ζ)
which concludes the proof.
□

322
Chapter 19.
Applications of Bopp Quantization
Deﬁnition 457. The operator Aω = a(z + 1
2iℏΩ∂z) will be called the ω-Bopp
pseudo-diﬀerential operator with symbol a.
We are going to prove a very useful result which reduces the study of the
Bopp operators to the case where ω is the standard symplectic form on Rn ⊕Rn.
This result is closely related to the symplectic covariance of Weyl operators under
metaplectic conjugation as we will see below.
For Σ a linear automorphism of Rn⊕Rn we deﬁne the operator MΣ : S′(Rn⊕
Rn) −→S′(Rn ⊕Rn) by
MΣΨ(z) =

| det Σ|Ψ(Σz).
(19.31)
Clearly MΣ is a unitary operator when restricted to L2(Rn ⊕Rn): we have
∥MΣΨ∥L2(R2n) = ∥Ψ∥L2(R2n)
for all Ψ ∈L2(R2n).
The following result shows how the operator Aω is related to the correspond-
ing Bopp operator A by an intertwining metaplectic operator:
Proposition 458. Let Σ be a linear automorphism such that σ = Σ∗ω and deﬁne
the automorphism MΣ : S′(Rn ⊕Rn) −→S′(Rn ⊕Rn) by
MΣΨ(z) =

| det Σ|Ψ(Σz).
(19.32)
We have MΣ ∈Mp(4n, σ ⊕σ) (hence MΣ is unitary on L2(Rn ⊕Rn)). We have
MΣ Tω(z0) = T(Σ−1z0)MΣ ,
(19.33)
MΣFω = FσMΣ
and hence
MΣ Aω = BMΣ
(19.34)
where B
Bopp
←→b with b = Σ∗a.
Proof. That MΣ ∈Mp(4n, σ ⊕σ) is clear (see [67], Chapter 7): it is one of the
two metaplectic operators belonging to the ﬁber of

Σ−1
0
0
Σ

∈Sp(4n, σ ⊕σ).
We have
MΣ Tω(z0)Ψ(z) =

| det Σ|e−i
ℏω(Σz,z0)Ψ(Σz −1
2z0))
=

| det Σ|e−i
ℏω(Σz,Σ(Σ−1z0))Ψ(Σ(z −1
2Σ−1z0))
=

| det Σ|e−i
ℏσ(z,Σ−1z0))Ψ(Σ(z −1
2Σ−1z0))
= T(Σ−1z0)MΣΨ(z).

19.3.
Non-commutative quantum mechanics
323
The second formula (19.33) follows by a similar argument. Let us prove formula
(19.34); using the identities (19.33) we have
AωΨ(z) =

1
2πℏ
n (det Ω)−1/2
	
R2n Fωa(z0) Tω(z0)Ψ(z)dz0
and hence
MΣ AωΨ =

1
2πℏ
n (det Ω)−1/2
	
R2n Fωa(z0)MΣ
!
Tω(z0)Ψ
"
dz0
=

1
2πℏ
n (det Ω)−1/2
	
R2n Fωa(z0) T (Σ−1z0)MΣΨdz0
=

1
2πℏ
n (det Ω)−1/2| det Σ|
	
R2n Fωa(Σz0) T (z0)MΣΨdz0
=

1
2πℏ
n (det Ω)−1/2| det Σ|1/2
	
R2n MΣFωa(z0) T(z0)MΣΨdz0
=

1
2πℏ
n (det Ω)−1/2| det Σ|1/2
	
R2n Fσ(MΣa)(z0) T (z0)MΣΨdz0
=

1
2πℏ
n (det Ω)−1/2| det Σ|
	
R2n Fσb(z0) T(z0)MΣΨdz0
= BMΣΨ
(the last equality because | det Ω|−1/2| det Σ| = 1).
□
That we have MSσΨ(z) = Ψ(Sσz) is clear since det Sσ = 1.
We note that formula (19.34) can be interpreted in terms of the symplectic
covariance property of Weyl calculus. To see this, let us equip the double phase
space R2n ⊕R2n with the symplectic structure σ⊕= σ ⊕σ. In view of formula
(19.29) with Ω= J the Weyl symbols of operators 5
A′′ and 5
A′ are, respectively
a′(z, ζ) = a

Σ(z −1
2Jζ)

, 5
a
′′(z, ζ) = a

Σ′(z −1
2Jζ)

and hence, using the identities Σ−1Σ′ = Sσ ∈Sp(Rn⊕Rn, σ) and SσJ = J(ST
σ )−1,
5
a
′′(z, ζ) = a′ 
Sσz −1
2J(ST
σ )−1ζ)

= a′(Sσz, (ST
σ )−1ζ).
Let now MSσ be the automorphism of R2n ⊕R2n deﬁned by
MSσ(z, ζ) = (S−1
σ z, ST
σ ζ);
formula(19.34) can thus be rewritten
5
A′′ = MSσ5
A′M −1
Sσ
with a
′′ = a′ ◦M −1
Sσ .
(19.35)
Recall now that each automorphism Σ of Rn ⊕Rn induces an element MΣ of the
symplectic group Sp(4n, R), deﬁned by mΣ(z, ζ) = (Σ−1z, ΣTζ), and that MΣ
is the projection of the metaplectic operator 
MΣ ∈Mp(R2n ⊕R2n, σ⊕) deﬁned
by (19.31). Formulas (19.35) and (19.35) thus reﬂect the symplectic covariance
property of Weyl calculus.

Bibliography
[1] R. Abraham, J.E. Marsden, and T. Ratiu, Manifolds, Tensor Analysis, and
Applications, Applied Mathematical Sciences, 75, Springer, 1988.
[2] R. Abraham and J.E. Marsden, Foundations of Mechanics, The Ben-
jamin/Cummings Publishing Company, 2nd edition, 1978.
[3] V. I. Arnold, Mathematical Methods of Classical Mechanics, Graduate Texts
in Mathematics, 2nd edition, Springer-Verlag, 1989.
[4] N.L. Balazs and H.C. Pauli, Quantum-Mechanical Operators and Phase-
Space Operators, Z. Physik A, 282 (1977), 221–225.
[5] A. Banyaga, Sur la structure du groupe des diﬀ´eomorphismes qui pr´eservent
une forme symplectique, Comm. Math. Helv., 53 (1978), 174–227.
[6] V. Bargmann, On a Hilbert space of analytic functions and an associated
integral transform, Comm. Pure Appl. Math., 14 (1961), 187–214.
[7] C. Bastos, O. Bertolami, N.C. Dias, and J.N. Prata, Weyl–Wigner Formu-
lation of Noncommutative Quantum Mechanics, J. Math. Phys., 49 (2008),
072101.
[8] C. Bastos, N.C. Dias, and J.N. Prata, Wigner measures in non-commutative
quantum mechanics, Preprint, arXiv:0907.4438v1 [math-ph] 25 July 2009.
[9] F. Bayen, M. Flato, C. Fronsdal, A. Lichnerowicz, and D. Sternheimer, De-
formation Theory and Quantization. I. Deformation of Symplectic Struc-
tures, Annals of Physics, 110 (1978), 111–151.
[10] F. Bayen, M. Flato, C. Fronsdal, A. Lichnerowicz, and D. Sternheimer, De-
formation Theory and Quantization. II. Physical Applications, Annals of
Physics, 111 (1978), 6–110.
[11] J. Bellissard, A. van Helst, and H. Schulz-Baldes, The noncommutative ge-
ometry of the quantum Hall eﬀect, J. Math. Phys. 35(10) (1994), 5373–5451.
[12] A. Benedek and R. Panzone, The space Lp, with mixed norm, Duke math
J., 28 (1961), 301–324.
[13] F.A. Berezin, Covariant and contravariant symbols of operators, Math.
USSR Izvestia, 6 (1972), 1117–1151.
325
M.A. de Gosson, Symplectic Methods in Harmonic Analysis and in Mathematical Physics,  
Pseudo-Differential Operators 7, DOI 10.1007/978-3-7643-9992-4, © Springer Basel AG 2011 

326
Bibliography
[14] E. Binz, R. Honegger, and A. Rieckers, Field-theoretic Weyl quantization as
a strict and continuous deformation quantization, Ann. Henri Poincar´e, 5
(2004) 327–346.
[15] P. Boggiatto and E. Cordero, Anti-Wick Quantization with Symbols in Lp
Spaces, Proc. Amer. Math. Soc., 130(9) (2002), 2679–2685.
[16] P. Boggiatto, E. Buzano, and L. Rodino, Global Hypoellipticity and Spectral
Theory, Akademie Verlag, Math. Research, 92 (1996).
[17] F. Bonsall, Decompositions of functions as sums of elementary functions,
Quart. J. Math. Oxford, ser. (2), 37 (1986), 129–136.
[18] F. Bopp, La m´ecanique quantique est-elle une m´ecanique statistique partic-
uli`ere? Ann. Inst. H. Poincar´e, 15 (1956), 81–112.
[19] M. Bordemann, Deformation quantization: a mini-lecture. Geometric and
topological methods for quantum ﬁeld theory, Contemp. Math., 434, Amer.
Math. Soc., Providence, RI, (2007), 3–38.
[20] M. Bordemann, Deformation Quantization: a survey. International Con-
ference on Non-Commutative Geometry and Physics. Journal of Physics:
Conference Series 103 (2008).
[21] A. Boulkhemair, L2 Estimates for Weyl Quantization, J. Funct. Anal. 165
(1999), 173–204.
[22] C. Brislawn, Kernels of trace class operators, Proc. Amer. Math. Soc., 104(4)
(1988), 1181–1190.
[23] G. Brodimas, A. Jannusis, and N. Patargias, The Density Matrix in Phase
Space, Lettere al Nuovo Cimento, 17(4) (1976), 119–122.
[24] M. Burdet, M. Perrin, and M. Perroud, Generating Functions for the Aﬃne
Symplectic Group, Commun. Math. Phys., 58 (1978), 241–254.
[25] J. Chazarain, and A. Piriou, Introduction `a la th´eorie des ´equations aux
d´eriv´ees partielles lin´eaires, Gauthier–Villars, Paris, (1981). English transla-
tion: Introduction to the theory of linear partial diﬀerential equations, Studies
in Mathematics and its Applications, 14, North-Holland, 1982.
[26] O. Christensen, An Introduction to Frames and Riesz Bases, Birkh¨auser
(Boston, Basel, Berlin), Series Applied and Numerical Harmonic Analysis
(2003).
[27] E. Cordero and F. Nicola, Strichartz estimates in Wiener amalgam spaces
for the Schr¨odinger equation, Math. Nachr., 281(1) (2008), 25–41.
[28] E. Cordero and L. Rodino, Short-time Fourier analysis of localization oper-
ators, Frames and operator theory in analysis and signal processing, 47–68,
Contemp. Math., 451, Amer. Math. Soc., Providence, RI, 2008.
[29] H.O. Cordes, On compactness of commutators of multiplications and con-
volutions, and boundedness of pseudodiﬀerential symbols, J. Funct. Anal. 18
(1975), 115–131.

Bibliography
327
[30] F. Delduc, Q. Duret, F. Gieres, and M. Lefran¸cois, Magnetic ﬁelds in non-
commutative quantum mechanics, J. Phys: Conf., Ser. 103 (2008), 012020.
[31] N.C. Dias and J.N. Prata, Generalized Weyl–Wigner Map and Vey Quantum
Mechanics, J. Math. Phys., 42 (2001), 5565–5579.
[32] N.C. Dias and J.N. Prata, Exact master equation for a noncommutative
Brownian particle, Ann. Phys., 324 (2009), 73–96.
[33] N.C. Dias, M. de Gosson, F. Luef, and J.N. Prata, Deformation Quanti-
zation Theory for Non-Commutative Quantum Mechanics, Preprint 2009,
arXiv:0911.1209v1 [math-ph].
[34] N.C, Dias, M. de Gosson, F. Luef, and J.N. Prata, A pseudo-diﬀerential cal-
culus on non-commutative phase space. Intertwining properties and spectral
results, Preprint 2009.
[35] J.A. Dieudonn´e, Foundations of Modern Analysis, Academic Press (1969).
[36] M.R. Douglas and N.A. Nekrasov, Noncommutative ﬁeld theory, Rev. Mod.
Phys., 73 (2001), 977–1029.
[37] P.A.M. Dirac, The Principles of Quantum Mechanics, Oxford Science Pub-
lications, 4th revised edition, (1999).
[38] J. Du, M.W. Wong, A trace formula for Weyl transforms, Approx. Theory.
Appl. (N. S.) 16(1) (2000), 41–45.
[39] D.A. Dubin, M.A. Hennings, and T.B. Smith, Mathematical Aspects of Weyl
Quantization and Phase, World Scientiﬁc, (2000).
[40] Yu.V. Egorov, A.I. Komech, and M.A. Shubin, Elements of the Modern The-
ory of Partial Diﬀerential Equations, Springer, (1999).
[41] I. Ekeland and H. Hofer, Symplectic topology and Hamiltonian dynamics,
Mathematische Zeitschrift, Volume 200(3) (1989), 355–378.
[42] I. Ekeland and H. Hofer, Symplectic topology and Hamiltonian dynamics,
Mathematische Zeitschrift, 203 (1990), 553–567.
[43] G.G. Emch, Geometric dequantization and the correspondence problem, In-
ternational Journal of Theoretical Physics, 22(5) (1983), 397–420.
[44] B.V. Fedosov, A simple geometrical construction of deformation quantiza-
tion, J. Diﬀ. Geom., 40 (1994) 213–238.
[45] H.G. Feichtinger, Un espace de Banach de distributions temp´er´ees sur les
groupes localement compact ab´eliens, C. R. Acad. Sci. Paris., S´erie A–B 290
(17) (1980) A791–A794.
[46] H.G. Feichtinger, On a new Segal algebra, Monatsh. Math., 92 (4), (1981),
269–289.
[47] H.G. Feichtinger, Banach spaces of distributions of Wiener’s type and inter-
polation, in Functional Analysis and Approximation, Oberwohlfach, (1980),
Internat. Ser. Numer. Math.; 60 (1981) Birkh¨auser, Basel 153–165.

328
Bibliography
[48] H.G. Feichtinger, Banach spaces of distributions of Wiener type and interpo-
lation, In P. Butzer, S. Nagy, and E. G¨orlich, editors, Proc. Conf. Functional
Analysis and Approximation, Oberwolfach August 1980, number 69 in: Inter-
nat. Ser. Numer. Math., pages 153–165. Birkh¨auser Boston, Basel, (1981).
[49] H.G. Feichtinger, Modulation spaces on locally compact Abelian groups, Tech-
nical report, January (1983).
[50] H.G. Feichtinger, Modulation Spaces: Looking Back and Ahead Sample, The-
ory Signal Image Process, 5(2), (2006), 109–140.
[51] H.G. Feichtinger and K. Gr¨ochenig, Banach spaces related to integrable
group representations and their atomic decompositions, I. J. Funct. Anal.,
86, (1989); 307–340.
[52] H.G. Feichtinger and K. Gr¨ochenig, Gabor Frames and Time-Frequency
Analysis of Distributions, J. Functional Analysis, 146(2), (1997), 464–495.
[53] H.G. Feichtinger and N. Kaiblinger, Varying the Time-Frequency Lattice of
Gabor Frames, Trans. Amer. Math. Soc. 356(5), (2003), 2001–2023.
[54] H.G. Feichtinger and F. Luef, Wiener Amalgam Spaces for the Fundamental
Identity of Gabor Analysis, Collect. Math., 57, (2006), 233–253.
[55] H.G. Feichtinger, F. Luef, and E. Cordero, Banach Gelfand Triples for Ga-
bor Analysis. in: Pseudo-Diﬀerential Operators, Quantization and Signals.
Lecture Notes in Mathematics, Springer, 1949 (2008).
[56] M. Flato, A. Lichnerowicz, and D. Sternheimer, D´eformations 1-diff´eren-
tiables d’alg`ebres de Lie attach´ees `a une vari´et´e symplectique ou de contact,
C. R. Acad. Sci., Paris, S´erie A 279, (1974), 877–881.
[57] M. Flato, A. Lichnerowicz, and D. Sternheimer, D´eformations 1-diff´eren-
tiables d’alg`ebres de Lie attach´ees `a une vari´et´e symplectique ou de contact,
Compositio Math., 31, (1975), 47–82.
[58] M. Flato, A. Lichnerowicz, and D. Sternheimer, Crochet de Moyal-Vey et
quantiﬁcation, C. R. Acad. Sci., Paris, I, Math. 283, (1976), 19–24.
[59] G.B. Folland, Harmonic Analysis in Phase space, Annals of Mathematics
studies, Princeton University Press, Princeton, N.J. (1989)
[60] G.B. Folland, Real Analysis. Modern Techniques and Their Applications,
2nd edition, Pure and applied mathematics, Wiley (1999).
[61] M. Gerstenhaber, On the deformation of rings and algebras, Ann. Math., 79
(1964), 59–103.
[62] R.J. Glauber, The Quantum Theory of Optical Coherence, Phys. Rev., 130(6)
(1963), 2529–2539.
[63] H. Goldstein, Classical Mechanics, Addison–Wesley, (1950), 2nd edition,
(1980), 3d edition, (2002).
[64] M. de Gosson, Maslov Classes, Metaplectic Representation and Lagrangian
Quantization, Research Notes in Mathematics, 95, Wiley–VCH, Berlin,
(1997).

Bibliography
329
[65] M. de Gosson, The Principles of Newtonian and Quantum Mechanics, Im-
perial College Press, London, (2001).
[66] M. de Gosson. On the notion of phase in mechanics, J. Phys. A: Math. Gen.,
37(29), (2004), 7297–7314.
[67] M. de Gosson, Symplectic Geometry and Quantum Mechanics, Birkh¨auser,
Basel, series “Operator Theory: Advances and Applications” (subseries:
“Advances in Partial Diﬀerential Equations”), Vol. 166 (2006).
[68] M. de Gosson, Extended Weyl Calculus and Application to the Phase-Space
Schr¨odinger Equation, J. Phys., A 38 (2005), no. 19, L325–L329.
[69] M. de Gosson, Symplectically covariant Schr¨odinger equation in phase space,
J. Phys., A 38 (2005) no. 42, 9263–9287.
[70] M. de Gosson, Weyl Calculus in Phase Space and the Torres-Vega and Fred-
erick Equation, In Quantum theory: reconsideration of foundations, 3, 300–
304, AIP Conf. Proc., 810, Amer. Inst. Phys., Melville, NY, (2006).
[71] M. de Gosson, Spectral Properties of a Class of Generalized Landau Opera-
tors, Comm. Partial Diﬀerential Operators, 33(11) (2008), 2096–2104.
[72] M. de Gosson, The Symplectic Camel and the Uncertainty Principle: The
Tip of an Iceberg?, Found. Phys., 99 (2009),194–214.
[73] M. de Gosson and B. Hiley, Imprints of the Quantum World in Classical
Mechanics, Preprint 2010.
[74] M. de Gosson and F. Luef, Quantum States and Hardy’s Formulation of the
Uncertainty Principle: a Symplectic Approach, Lett. Math. Phys., 80 (2007),
69–82.
[75] M. de Gosson and F. Luef, Principe d’Incertitude et Positivit´e des Op´era-
teurs `a Trace; Applications aux Op´erateurs Densit´e, Ann. H. Poincar´e, 9(2)
(2008), 329–346.
[76] M. de Gosson and F. Luef, A new approach to the ⋆-eigenvalue equation,
Lett. Math. Phys., 85 (2008), 173–183 [on line 16 Aug. 2008;
DOI 10.1007/s11005-008-0261-8].
[77] M. de Gosson and F. Luef, Symplectic Capacities and the Geometry of Un-
certainty: the Irruption of Symplectic Topology in Classical and Quantum
Mechanics, Physics Reports, 484 (2009), 131–179
DOI 10.1016/j.physrep.2009.08.001.
[78] M. de Gosson and F. Luef, On the usefulness of modulation spaces in defor-
mation quantization, J. Phys. A: Math. Theor. 42(31) (2009) 315205 (17 pp).
[79] M. de Gosson and F. Luef, Spectral and Regularity properties of a Pseudo-
Diﬀerential Calculus Related to Landau Quantization, Journal of Pseudo-
Diﬀerential Operators and Applications, 1(1) (2010), 3–34
DOI 10.1007/s11868-010-0001-6.
[80] M.J. Gotay and G.A. Isenberg, The Symplectization of Science, Gazette des
Math´ematiciens, 54 (1992), 59–79.

330
Bibliography
[81] J.M. Gracia-Bondia, Generalized Moyal Quantization on Homogeneous Sym-
plectic spaces, Contemporary Mathematics, Amer. Math. Soc., Providence,
RI, 134 (1992) 93–114.
[82] K. Gr¨ochenig, Foundations of Time-Frequency Analysis, Birkh¨auser, Boston,
(2000).
[83] K. Gr¨ochenig and C. Heil, Modulation Spaces and Pseudodiﬀerential Oper-
ators, Integr. Equ. Oper. Theory, 34 (1999), 439–457.
[84] K. Gr¨ochenig, Composition and spectral invariance of pseudodiﬀerential op-
erators on modulation spaces, Journal d’analyse math´ematique, 98 (2006),
65–82.
[85] K. Gr¨ochenig, Time-Frequency Analysis on Sj¨ostrand’s Class Rev, Mat.
Iberoamericana, 22 (2) (2006), 703–724.
[86] H.J. Groenewold, On the principles of elementary quantum mechanics,
Physics, 12 (1946), 405–460.
[87] M. Gromov, Pseudoholomorphic curves in symplectic manifolds, Invent.
Math., 82 (1985), 307–347.
[88] A. Grossmann, Parity operators and quantization of δ-functions, Commun.
Math. Phys., 48 (1976), 191–193.
[89] A. Grossmann, G. Loupias, and E.M. Stein, An algebra of pseudo-diﬀerential
operators and quantum mechanics in phase space, Ann. Inst. Fourier, Greno-
ble 18(2), (1968) 343–368.
[90] J. Hancock, M.A. Walston, and B. Wynder, Quantum mechanics another
way, Eur. J. Phys., 25 (2004), 525–534.
[91] K. Hannabuss, An Introduction to Quantum Theory, Oxford Science Publi-
cations, Oxford University Press, (1997).
[92] B.J. Hiley, Non-Commutative Geometry, the Bohm Interpretation and the
Mind-Matter Relationship, In Proc. CASYS’2000, Li`ege, Belgium, Aug. 7–12
(2000)
[93] B.J. Hiley, Phase Space Descriptions of Quantum Phenomena, Proc. Int.
Conf. Quantum Theory: Reconsideration of Foundations 2, ed. Khrennikov,
A., V¨axj¨o University Press, V¨axj¨o, Sweden, 2003 (267–286).
[94] B.J. Hiley, On the Relationship between the Wigner-Moyal and Bohm Ap-
proaches to Quantum Mechanics: A step to a more General Theory, Found.
Phys., 40 (2010) 365–367.
[95] B.J. Hiley and R.E. Callaghan, Delayed-choice experiments and the Bohm
approach, Phys. Scr. 74 (2006), 336–348.
[96] L. H¨ormander, Fourier integral operators I, Acta Mathematica, 127(1)
(1971), 79–183.
[97] L. H¨ormander, J.J. Duistermaat, Fourier integral operators II, Acta Math-
ematica, 128(1) (1972), 183–269.

Bibliography
331
[98] G.H. Hardy, A theorem concerning Fourier transforms, J. London. Math.
Soc., 8 (1933), 227–231.
[99] S. Helgason, The Radon Transform, Birkh¨auser, Progress in Mathematics,
(1999).
[100] A.C. Hirshfeld and P. Henselder, Deformation Quantization in the Teaching
of Quantum Mechanics, American Journal of Physics, (2002), 70–537.
[101] H. Hofer and E. Zehnder, Symplectic Invariants and Hamiltonian Dynamics,
Birkh¨auser Advanced texts, (Basler Lehrb¨ucher, Birkh¨auser Verlag, (1994).
[102] L. H¨ormander, The Analysis of Linear Partial Diﬀerential Operators III,
Springer–Verlag, Berlin, (1985).
[103] R.L. Hudson, When is the Wigner quasi-probability density non-negative?,
Rep. Math. Phys., 6 (1974), 249–252.
[104] A.J.E.M. Janssen, A note on Hudson’s theorem about functions with non-
negative Wigner distributions, Siam. J. Math. Anal., 15(1) (1984), 170–176.
[105] D. Kastler, The C∗-Algebras of a Free Boson Field, Commun. math. Phys.,
1 (1965), 14–48.
[106] A. Katok, Ergodic perturbations of degenerate integrable Hamiltonian sys-
tems, Izv. Akad. Nauk., SSSR Ser. Mat. 37 (1973), 539–576, [Russian]. En-
glish translation: Math. USSR Izvestija 7 (1973), 535–571.
[107] Y. Katznelson, An Introduction to Harmonic Analysis, Dover, New York,
(1976).
[108] V.V. Kisil, Integral representations and Coherent States, Bull. Belg. Math.
Soc., 2 (1995), 529–540.
[109] M. Kontsevich, Deformation quantization of Poisson manifolds, Lett. Math.
Phys., 66 (3) (2003), 157–216.
[110] W. Kozek, On the generalized Weyl correspondence and its application to
time-frequency analysis of time-varying systems, Proc. IEEE-SP Int. Symp.
on Time-Frequency and Time-Scale Analysis, Oct. (1992), Victoria, British-
Columbia, Canada.
[111] R. Kubo, Wigner Representation of Quantum Operators and Its Applications
to Electrons in a Magnetic Field, Journal of the Physical Society of Japan,
19(11) (1964), 2127–2139.
[112] N. Kumano-go, Feynman path integrals as analysis on path space by time
slicing approximation, Bull. Sci. Math., 128 (3) (2004), 197–251.
[113] L.D. Landau, E.M. Lifshitz, Quantum Mechanics: Nonrelativistic Theory,
Pergamon Press, (1997).
[114] J. Leray, Lagrangian Analysis and Quantum Mechanics, a mathematical
structure related to asymptotic expansions and the Maslov index, MIT Press,
Cambridge, Mass., (1981); translated from Analyse Lagrangienne RCP 25,
Strasbourg Coll`ege de France, (1976–1977).

332
Bibliography
[115] P. Libermann and C.-M. Marle, Symplectic Geometry and Analytical Me-
chanics, D. Reidel Publishing Company, (1987).
[116] E.H. Lieb, Integral bounds for radar ambiguity functions and Wigner distri-
butions, J. Math. Phys. 31(3) (1990), 594–599.
[117] R.G. Littlejohn, The semiclassical evolution of wave packets, Physics Re-
ports 138(4–5) (1986), 193–291.
[118] G. Loupias and S. Miracle-Sole, C∗-Alg`ebres des syst`emes canoniques, I,
Commun. math. Phys. 2 (1966), 31–48.
[119] G. Loupias and S. Miracle-Sole, C∗-Alg`ebres des syst`emes canoniques, II,
Ann. Inst. Henri Poincar´e 6(1) (1967), 39–58.
[120] Yu.I. Lyubarski, Frames in the Bargmann space of entire functions, In En-
tire and subharmonic functions, 167–180, Amer. Math. Soc., Providence RI
(1992).
[121] G.W. Mackey. Mathematical Foundations of Quantum Mechanics, Courier
Dover Publications, (2004).
[122] R. de la Madrid, The role of the rigged Hilbert space in quantum mechanics,
Eur. J. Phys., 26 (2005), 287–312.
[123] A. Messiah, Quantum Mechanics (two volumes). North–Holland Publ. Co.,
(1991); translated from the French; original title M´ecanique Quantique.
Dunod, Paris, (1961).
[124] J. Moser, On the volume element of a manifold, Trans. Amer. Math. Soc.,
120 (1965), 286–294.
[125] J.E. Moyal, Quantum mechanics as a statistical theory, Proc. Camb. Phil.
Soc., 45 (1947), 99–124.
[126] F.J. Narcowich, Conditions for the convolution of two Wigner distributions
to be itself a Wigner distribution, Journal of Mathematical Physics, 29(9)
(1988), 2036–2041.
[127] F.J. Narcowich, Distributions of ℏ-positive type and applications, Journal of
Mathematical Physics, 30(11), (1989), 2565–2573.
[128] F.J. Narcowich,
Geometry and uncertainty, Journal of Mathematical
Physics, 31(2) (1990), 354–364.
[129] F.J. Narcowich and R.F. O’Connell, Necessary and suﬃcient conditions for
a phase-space function to be a Wigner distribution, Phys. Rev. A 34(1),
(1986), 1–6.
[130] J. von Neumann, Mathematische Grundlagen der Quantenmechanik, Sprin-
ger, Berlin (1932).
[131] F. Nicola, L. Rodino. Global Pseudo-diﬀerential Calculus on Euclidean
Spaces. Birkh¨auser, Series: Pseudo-Diﬀerential Operators, 2010.
[132] A.M. Peremolov, Generalized coherent states and some of their applications,
Sov. Phys. Usp. 20(9) (1977), 703–720.

Bibliography
333
[133] L. Polterovich, The Geometry of the Group of Symplectic Diﬀeomorphisms,
Lectures in Mathematics, Birkh¨auser, (2001).
[134] J. Radon, ¨Uber die Bestimmung von Funktionen durch ihre Integralwerte
l¨angs gewisser Mannigfaltigkeiten, Berichte ¨uber die Verhandlungen der
S¨achsischen Akademie der Wissenschaften 69 (1917) 262–277.
[135] J. Radon and P.C. Parks (translator), On the determination of functions
from their integral values along certain manifolds, IEEE Transactions on
Medical Imaging 5 (1986) 170–176.
[136] M. Reed and B. Simon, Methods of Modern Mathematical Physics, Academic
Press, New York, (1972).
[137] H.P. Robertson, The uncertainty principle, Physical Reviews, 34 (1929), 163–
164.
[138] A. Royer, Wigner functions as the expectation value of a parity operator,
Phys. Rev., A 15 (1977), 449–450.
[139] G.A. Sardanashvily, Hamiltonian time-dependent mechanics, Journal of
Mathematical Physics, 39(5) (1998), 2714–2729.
[140] W. Schempp, Harmonic Analysis on the Heisenberg Nilpotent Lie Group,
Pitman Research Notes in Mathematics, 147, Longman Scientiﬁcal and Tech-
nical, (1986).
[141] W. Schempp, Magnetic Resonance Imaging, Mathematical Foundations and
Applications, Wiley, (1997).
[142] E. Schr¨odinger, Zum Heisenbergschen Unsch¨arfeprinzip, Berliner Berichte
(1930), 296–303 [English translation: A. Angelow, M.C. Batoni, About
Heisenberg Uncertainty Relation, Bulgarian Journal of Physics 26 5/6 (1999),
193–203, and http://arxiv.org/abs/quant-ph/9903100.
[143] E. Schr¨odinger, Der stetige ¨Ubergang von der Mikro- zur Makromechanik,
Naturwissenschaften, 14(28) (1926), 664–666.
[144] L.S. Schulman, Techniques and Applications of Path Integration, Dover,
(2005).
[145] N. Seiberg and E. Witten, String theory and noncommutative geometry,
JHEP, 09 (1999), 032.
[146] K. Seip and R. Wallst´en, Density theorems for sampling and interpolation in
the Bargmann–Fock space. II, J. Reine Angew. Math 429 (1992), 107–113.
[147] M.A. Shubin, Pseudodiﬀerential Operators and Spectral Theory, Springer-
Verlag, (1987) [original Russian edition in Nauka, Moskva (1978)].
[148] K.F. Siburg, Symplectic capacities in two dimensions, Manuscripta Mathe-
matica, 78 (1993), 149–163.
[149] B. Simon, Trace Ideals and their Applications, Cambridge U. P., Cambridge
(1979).

334
Bibliography
[150] J. Sj¨ostrand, An algebra of pseudodiﬀerential operators, Math. Res. Lett.,
1(2) (1994), 185–192.
[151] J. Sj¨ostrand, Wiener type algebras of pseudodiﬀerential operators, In S´emi-
naire sur les ´Equations aux D´eriv´ees Partielles, (1994–1995), ´Ecole Polytech.,
Palaiseau, Exp. No. IV, 21.
[152] H. Snyder, Quantized Space-Time, Phys. Rev., 71 (1947), 38–41.
[153] E.M. Stein, Harmonic Analysis: Real Variable Methods, Orthogonality, and
Oscillatory Integrals, Princeton University Press, (1993).
[154] J. Struckmeier, Hamiltonian dynamics on the symplectic extended phase
space for autonomous and non-autonomous systems, J. Phys. A: Math. Gen.,
38 (2005), 1257–1278.
[155] R. Szabo, Quantum Field Theory on Noncommutative Spaces, Phys. Rep.,
378 (2003), 207.
[156] S. Thangavelu, Lectures on Hermite and Laguerre Expansions, Princeton
University Press, (1993).
[157] J. Vey, D´eformation du crochet de Poisson sur une vari´et´e symplectique,
Comment. Math. Helvet., 50 (1975), 421–454.
[158] N. Wallach, Lie Groups: History, Frontiers and Applications, 5. Symplectic
Geometry and Fourier Analysis, Math. Sci. Press, Brooklyn, MA, (1977).
[159] D.F. Walnut, Continuity properties of the Gabor frame operator, J. Math.
Anal. Appl. 165(2) (1992), 479–504.
[160] H. Weyl, Quantenmechanik und Gruppentheorie, Zeitschrift f¨ur Physik., 46
(1927).
[161] E. Wigner, On the quantum correction for thermodynamic equilibrium, Phys.
Rev., 40 (1932), 799–755.
[162] J. Williamson, On the algebraic problem concerning the normal forms of
linear dynamical systems, Amer. J. of Math., 58 (1936), 141–163.
[163] M.W. Wong, Weyl Transforms. Springer, 1998.
[164] M.W. Wong, Weyl Transforms and a Degenerate Elliptic Partial Diﬀerential
Equation, Proc. R. Soc., A 461 (2005), 3863–3870.
[165] M.W. Wong, Weyl Transforms, the Heat Kernel and Green Function of a
Degenerate Elliptic Operator, Annals of Global Analysis and Geometry, 28
(2005), 271–283.
[166] M.W. Wong, The Heat Equation for the Hermite Operator on the Heisenberg
Group, Hokkaido Math. J., 34 (2005), 393–404.
[167] H.P. Yuen, Multimode two-photon coherent states, in International Sym-
posium on Spacetime Symmetries, edited by Y.S. Kim and W.W. Zachary
North-Holland., Amsterdam (1989), 309–313.

Index
a
Weyl
←→
A , 138
adjoint of a Weyl operator, 146
aﬃne symplectic group, 21
analysis operator, 108
anti-Wick quantization, 177
auto-ambiguity function, 118
Banach ∗-algebra, 290
Banach Gelfand triple, 273
Bargmann transform, 300
Bessel equality, 185
Bopp operators, 309
Bopp pseudo-diﬀerential operator, 293
canonical commutation relations, 97
CCR, 97
chirp, 80
coeﬃcient operator, 108
Cohen’s class, 126
coherent states, 163, 171, 212
composition of Weyl operators, 147
covariance matrix, 66
cross-ambiguity function, 112, 117
cross-Wigner function, 120
cross-Wigner transform, 120
density matrix, 205
density operator, 206
dependence on ℏof πMp, 85
displacement Hamiltonian, 91
dual frame, 109
energy shell, 13
equivalent representation, 100
exponential mapping, 49
factorization of a symplectic matrix, 38
Feichtinger algebra, 261, 262, 283
Banach algebra property, 268
metaplectic invariance, 266
minimality property, 271
frame, 108
bounds, 108
operator, 108
free symplectic matrix, 31, 38, 80
Gabor
expansion, 112
frame, 107, 112, 270
transform, 125
Gelfand triple, 261, 271, 273, 275, 309
generalized eigenvalues, 273, 309
generalized eigenvectors, 273, 309
generating function, 33
generators of the symplectic group, 39
global hypoellipticity, 305, 314
Gromov width, 57
Grossmann–Royer operator, 104, 120,
137, 147
group of Hamiltonian
symplectomorphisms, 45
group of symplectomorphisms, 42
Hamilton vector ﬁeld, 6
Hamilton’s equations, 3, 10, 24
Hamiltonian symplectomorphisms, 43, 45
Hardy’s uncertainty principle, 71, 213
Heisenberg
algebra, 97
group, 96, 98
reduced, 99
inequalities, 66
335

336
Index
Heisenberg–Weyl
expansion, 270
operator, 91, 137, 271
Hermite functions, 164
Hilbert–Schmidt
norm, 187
operator, 185
H¨older inequality, 276
inhomogeneous metaplectic group, 96
intertwining property of the WPT, 302
inversion formula for the cross-Wigner
transform, 130
irreducible representation, 100
Jacobian matrix, xxii
Kirkwood–Rihaczek distribution, 238
KLM conditions, 215
Kohn–Nirenberg symbol, 154, 225
Landau problem, 312
lattice, 111
Lq spaces, 275
Maslov index, 81
metaplectic
group, 79, 83
representation, 79
Minkowski inequality, 276
mixed state, 207
modulation space M q
s , 281
modulation space M ∞
s , 285
mother wavelet, 165
Moyal
bracket, 316
identity, 128
product, 292, 316
Narcowich–Wigner spectrum, 216
NCQM, 318
non-commutative quantum mechanics,
318
observable (classical), 16
ω-Fourier transform, 320
Peetre’s inequality, 231
Poisson bracket, 10
polarized Heisenberg group, 99
positive operator, 189
pre-Iwasawa factorization, 175
probabilistic interpretation
of the Wigner transform, 142
of Weyl operators, 143
projection (on the symplectic group), 84
pseudo-diﬀerential operator, 153, 224,
233, 292
pure state, 206
purity of a quantum state, 209
quadratic
Fourier transform, 80
Hamiltonian, 249
quantization, 16
radar ambiguity function, 118
Radon transform, 143
reconstruction operator, 108
representation coeﬃcient, 100
rescaling operator, 80
Riesz basis, 111
Rihaczek distribution, 238
Robertson–Schr¨odinger
inequalities, 210
uncertainty principle, 67
Schr¨odinger representation, 101
Schr¨odinger’s equation, 247
short-time Fourier transform, 125, 261
Sj¨ostrand class, 288
Sobolev space, 155, 235
squeezed coherent states, 172
standard
symplectic form, 22
symplectic matrix, 6, 20
weight, 279
Stone’s theorem, 256
Stone–von Neumann theorem, 100
strongly continuous, 100
sub-Gaussian estimate, 212
symbol of a Weyl operator, 155
symmetric gauge, 313

Index
337
symplectic
area, 57
capacity, 70, 213
covariance for Heisenberg–Weyl
operators, 95
covariance of the WPT, 302
covariance of Weyl operators, 150, 254
form, 22
Fourier transform, 102, 215
group, 20
lattice, 112
Lie algebra, 47
matrix, 9, 20
radius, 57
symplectomorphism, 9, 23, 41
synthesis operator, 108
trace class operator, 189, 193
trace of a Weyl operator, 198
twofold covering of the symplectic group,
84
uncertainty principle, 66, 210, 213
of Hardy, 71
of Robertson–Schr¨odinger, 67
unconditional convergence, 108
unitary representation of a group, 100
vacuum state, 165
variational equation, 9
weight, 278
weighted L∞space, 285
weighted Lq spaces, 278
Weyl
correspondence, 137
group, 98
quantization, 137
symbol, 138
of an anti-Wick operator, 180
Weyl–Heisenberg frame, 107, 111, 308
Wigner transform, 120, 140
of a Gaussian, 169, 212
Williamson’s theorem, 59
Woodward ambiguity function, 118

