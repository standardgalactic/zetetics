Original Article
Fuzzy logic feedforward active
noise control with distance ratio
and acoustic feedback using
Takagi–Sugeon–Kang inference
Tongrui Peng1
, Quanmin Zhu1, M. Osman Tokhi2 and
Yufeng Yao1
Abstract
Noise, as undesired sound, severely affects the quality of human life. Currently, active noise control method has
demonstrated its capability in low-frequency noise cancellation and the advance in saving money and reducing weight
and volume of related materials used in the passive noise control technology. The widespread configuration for active
noise control technology is finite impulse response filter with filtered-x least mean squares (FxLMS) algorithm. However,
the nonlinearities in the secondary path, which mainly arise from sensors, actuators and amplifiers used in the active
noise control system, will cause instability and degrade the performance while using the FxLMS algorithm. In order to
cope with this challenge, many new approaches have been proposed and fuzzy logic control is one of these. In this paper,
a Takagi–Sugeon–Kang-type fuzzy logic control-based feedforward active noise control system with focus on the geom-
etry configuration is introduced. In contrast to previous work, all physical paths are modelled by pure time delay transfer
function and the acoustic feedback is added as part of inputs for the fuzzy logic control. Computational experiments are
implemented within the Matlab/Simulink platform, and several case studies are presented with time and frequency
domain analyses to demonstrate the cancellation ability of the proposed feedforward active noise control system and
investigate the influence of distance ratio on the overall noise cancellation performance.
Keywords
Fuzzy logic control, geometry-related constraints active noise control system, distance ratio
Introduction
Nowadays, with the fast development of industrialization and modernization, noise, deﬁned as undesired sound,
is becoming a critical problem, severely affecting the quality of human daily life.1,2 From the health perspective,
long-time exposure to high noise levels could damage the hearing ability and sometimes might cause hearing loss.3
Besides, noise could make people feel nervous/tired and affect the quality and quantity of sleep.4 From efﬁciency
perspective, noise can make people unsatisﬁed with the environmental condition, and this directly leads to low
efﬁciency especially for workers in a factory.5 In order to alleviate negative effects of noise, more and more
attention is paid to noise cancellation for both narrowband noise and broadband noise. Currently, there are two
main types of noise control method, passive noise control (PNC) and active noise control (ANC).2
1Faculty of Environment and Technology- Engineering, Design and Mathematics, Faculty of Environment and Technology, University of the West of
England, Bristol, UK
2Department of the Electrical and Electronic Engineering Division within the School of Engineering, London South Bank University (LSBU), London, UK
Corresponding author:
Quanmin Zhu, Faculty of Environment and Technology- Engineering, Design and Mathematics, University of the West of England, Bristol BS16 1QY, UK.
Email: Quan.Zhu@uwe.ac.uk
Journal of Low Frequency Noise,
Vibration and Active Control
2020, Vol. 39(1) 174–189
! The Author(s) 2019
DOI: 10.1177/1461348419840961
journals.sagepub.com/home/lfn
Creative Commons CC BY: This article is distributed under the terms of the Creative Commons Attribution 4.0 License (http://www.
creativecommons.org/licenses/by/4.0/) which permits any use, reproduction and distribution of the work without further permission
provided the original work is attributed as specified on the SAGE and Open Access pages (https://us.sagepub.com/en-us/nam/open-access-at-sage).

The PNC method mainly relies on passive technologies like absorption and insulation through several damping
materials to attenuate the undesired noise, and it performs well for higher-frequency noise cancellation. The main
principle of noise adsorption is to transform the acoustical energy into other form(s).6 However, for most indus-
trial acoustic waves, the main power is concentrated in the low-frequency range. Based on the relationship
between the acoustic wavelength and frequency, the acoustic wavelength becomes larger at the low-frequency
range and the corresponding result is that the size of corresponding absorption material required is increasing.
Meanwhile, the weight of the material is also increasing, which makes the PNC method inconvenient and costly.7
In order to overcome this problem, ANC has been proposed to attenuate low-frequency noise. The essential
principle of ANC technology is superposition, while a secondary sound wave is generated to interfere with the
primary sound wave and achieve noise cancellation at speciﬁed (observation) point(s). Compared with PNC
method, it not only successfully demonstrates its capability for removing the undesired sound at lower frequencies
but also is convenient and ﬂexible6 setting up. In the early 1930s, Lueg8 used microphone and an electronically
driven loudspeaker to successfully cancel the noise and proposed the concept of active noise control and later
registered this as the patent in the USA. As a milestone work in the ﬁeld of ANC, Leitch and Tokhi9 discovered
that geometrical arrangments have signiﬁcant effects on the performance of noise cancellation in a three-
dimensional propagation medium. They provided the framework of both feedforward and feedback ANC systems
based on geometrical arrangments and deduced the corresponding mathematical expression for the required
controller over the frequency range of interest. In this paper, the proposed fuzzy logic feedforward ANC
system is based on Leitch and Tokhi’s framework. Prior studies have already shown that the ANC system involves
three main parts, transducers, controller and acoustic/electrical paths.9,10 Among these parts, the controller is the
essential part to generate the anti-noise by adjusting the amplitude and phase of each frequency component of the
detected primary noise. In fact, the noise source is changing with time and covers a wide range of frequencies.
Therefore, the controller must be adaptive to minimize the residual error by adjusting its coefﬁcients. Currently,
there are two kinds of adaptive ﬁlters widely used in ANC systems2: linear and nonlinear. For the linear adaptive
ﬁlter, the widespread conﬁguration is ﬁnite impulse response (FIR) ﬁlter using the ﬁltered-x least mean squares
(FxLMS) algorithm and the biggest advantage is simplicity. However, nonlinearities that exist in the primary
path, and transducers such as sensors and actuators employed in the secondary path, might make the transversal
ﬁlter-based ANC scheme fail to mitigate the effect of noise.2 Therefore, several nonlinear algorithms have been
proposed to solve this problem such as Volterra FxLMS algorithm,11 bilinear FxLMS algorithm12 and ﬁltered-s
LMS algorithm.13 Besides, in order to improve the overall noise cancellation performance, neural-network-based
ANC adaptive structures have been proposed14 such as fuzzy inference systems15 and neural-fuzzy systems.16
Kipersztok17 applied fuzzy logic to the ANC technology to replace the traditional linear method for broadband
noise cancellation. Chang and Shyu15 proposed fuzzy adaptive FxLMS algorithm. They used fuzzy FxLMS
algorithm to replace the conventional FxLMS algorithm to improve the convergence speed. However, they did
not consider the effect of acoustic feedback and physical separation between sources and transducers though they
used pure time delay to model a duct plant. In this paper, Takagi–Sugeon–Kang (TSK) type fuzzy logic-based
feedforward ANC system with consideration of distance ratio and acoustic feedback is proposed to investigate the
inﬂuence of different distance ratios on overall noise cancellation performance. The acoustic feedback and the
error signal are used as input variables for the TSK-type fuzzy logic controller to generate coefﬁcients for the
adaptive ﬁlter.
The rest of the paper is arranged as follows. In the next section, detailed descriptions based on Leitch and
Tokhi9 about the geometry-related constraints are given to lay a foundation for the new development. Then, a
brief description of the fuzzy logic controller is presented, especially with a focus on the membership functions and
the fuzzy ‘if-then’ rule. This is followed by a section where the TSK-type fuzzy logic feedforward ANC system is
introduced with inclusion of acoustic feedback and distance ratio. In the simulation section, several computa-
tional experiments are conducted to bench test the cancellation feasibility of the proposed ANC system and
explore the inﬂuence of distance ratio on the overall noise cancellation performance. Finally, related conclusions
and future prospects are presented.
System description with geometry-related considerations
Figure 1 displays the feedforward ANC system with consideration of geometrical arrangement, ﬁrstly proposed by
Leitch and Tokhi for noise cancellation in the three-dimensional linear propagation medium.9,18–20 The primary
source emits an unwanted acoustic wave. It can be detected by the detector, which is placed at a distance q1 relative
to the primary source and a distance q2 relative to the secondary source. Normally, the microphone is used as the
Peng et al.
175

detector. The detected signal is fed to the controller to adjust the amplitude and phase of each frequency component,
and the generated secondary acoustic wave is emitted from the loudspeaker placed at a distance D relative to the
primary source to be superimposed on the primary acoustic wave. The distance D can determine the range of
cancellation at the observation point. The observer, placed at distances q3 and q4 relative to the primary source and
the secondary source, respectively, is an error microphone with the aim of monitoring the overall system cancellation
performance and the error signal is used to adjust coefﬁcients of the adaptive ﬁlter.21–23
Figure 2 displays the equivalent block diagram in the complex domain. The objective with the feedforward
system is to reduce the noise pressure level to zero at the observation point. Therefore, the secondary acoustic
wave must have the same amplitude and opposite phase compared with the primary acoustic wave at the obser-
vation point. This is mathematically expressed as
PR0 sð Þ þ SE0 sð Þ ¼ 0
(1)
Figure 1. Schematic diagram of feedforward ANC system.9 D: physical distance between primary source and secondary source; q1:
physical distance between primary source and detector; q2: physical distance between secondary source and detector; q3: physical
distance between primary source and observer; q4: physical distance between secondary source and observer.
Figure 2. Block diagram of feedforward ANC system. pr tð Þ: primary signal; se tð Þ: secondary signal; pro tð Þ: primary signal at observer
point; seo tð Þ: secondary signal at observer point; q1ðsÞ : transfer characteristics/function of path R1; q2ðsÞ : transfer characteristics/
function of path R2; q3ðsÞ : transfer characteristics/function of path R3; q4ðsÞ : transfer characteristics/function of path R4; MðsÞ:
transfer characteristics/function of microphone; LðsÞ: transfer characteristics/function of loudspeaker; CðsÞ: transfer characteristics/
function of controller.
176
Journal of Low Frequency Noise, Vibration and Active Control 39(1)

PR0 sð Þ ¼ SE0 sð Þ
(2)
where PR0 sð Þ represents the frequency response of pro tð Þ and SE0 sð Þ represents frequency response of seo tð Þ.
The frequency response PR0 sð Þ at the observer point is
PR0 sð Þ ¼ P sð Þq3ðsÞ
(3)
The frequency response SE0 sð Þ at the observer point is
SE0 sð Þ ¼ S sð Þq4ðsÞ
(4)
The (s) can be further expressed as
S sð Þ ¼ MðsÞCðsÞLðsÞ S sð Þq2 sð Þ þ PðsÞq1 sð Þ


(5)
Manipulating equations (2) to (5), yields
C sð Þ ¼
q3ðsÞ
MðsÞLðsÞðq2 sð Þq3 sð Þ  q1ðsÞq4ðsÞÞ
(6)
Equation (6) is the required transfer function of the controller for optimum cancellation over the frequency
range of interest and it illustrates that the characteristics of the controller depend on the transfer characteristics of
transducers and acoustic paths.
As stated above, this kind of ANC system is constructed based on the geometrical arrangement. Therefore, two
geometrical constraints should be notiﬁed while using this feedforward ANC system. Firstly, the acoustic delay
should be longer than the electrical delay, which means that the observer should be placed closer to the secondary
source compared with the primary source. Thus
q4 < q3
(7)
In Figure 1, the secondary path, deﬁned as the acoustic path between the secondary source and the observation
point, attempts to compensate for the primary path, deﬁned as the acoustic path between the primary source and
the observation point, to ensure that cancellation occurs at the observation point. Equation (7) implies that under
such condition, there is enough time for the controller to process the detected signal to generate the secondary
signal to drive the loudspeaker.
Secondly, the distance ratio is important. As can be seen from equation (6), any change in the location of the
detector or the observer with respect to the noise sources will be reﬂected in the transfer function for the con-
troller. The critical geometrical condition for optimal cancellation performance can be expressed as
q1
q2
¼ q3
q4
(8)
Using equations (6) and (8), it can be shown that that the controller will have an inﬁnite gain, under the
condition in equation (8), for the noise level at the observer point to be reduced to zero. However, this cannot be
realised in real life or in the simulation experiments. Despite this, it is interesting to explore the impact of distance
ratio on overall noise cancellation performance. Furthermore, the corresponding results will provide insight into
geometrical arrangment in real-life experiments.
Furthermore, the acoustic feedback path noted in Figure 2 will affect the system stability and noise cancellation
performance. The cause for the acoustic feedback and how to eliminate its negative effect will be discussed in a
later section.
In summary, the feedforward ANC system proposed by Tokhi and Leitch9 provides a fundamental part for the
research study in this paper.
Peng et al.
177

Fuzzy logic control
Introduction
Fuzzy logic control (FLC) or fuzzy inference system (FIS) is a commonly used soft computing technology for
modelling complex systems in the real world as it has a wide application.24,25 The fundamental part of FIS is fuzzy
sets and fuzzy logic while it works with imprecise reasoning and linguistic rules obtained by the designer who is
experienced human expert with enough capacity of expert knowledge26 to improve the system tolerating ability of
imprecision.27 The main advantage of FIS is that it can improve the reasoning and inference ability.
A FLC mechanism consists of four parts, fuzziﬁcation, knowledge base, inference engine or fuzzy logic rea-
soning and defuzziﬁcation. Fuzziﬁcation is aimed at transforming the measured crisp values to corresponding
linguistic values based on deﬁned membership functions. For example, ‘the temperature is 30 degrees’ will
corresponding to ‘the temperature is high’. The knowledge base can be divided into two subparts, the rule
base part and the database part. The database refers to the membership function, while the rule base denotes a
set of IF-THEN rules. Here, according to the type of consequent following the keyword ‘THEN’, the FIS can be
broadly divided into two types. The ﬁrst type uses fuzzy reasoning while both antecedent and consequent parts are
fuzzy values and the system behaviour is described in the natural linguistic words. This is referred to the Mamdani
model. The second type uses the rule structure that only the antecedent part uses the fuzzy and linear mathe-
matical functions are used in the consequent part. This representation is the TSK-type. The inference engine or
fuzzy logic reasoning part in the FIS imitates human thinking and reasoning. The aim of this step is to generate
the fuzzy output from the fuzzy input through the inference rules. Defuzziﬁcation is to transform the fuzzy output
to the crisp output. For FLC, there are two critical factors needed to be focused on, the membership functions
selection and the rule map, and these will be detailed in the sub-section below.35,36
Membership functions
In fuzzy logic theory, membership functions (MFs), denoted as lM, are used to map each element of the universe
of discourse to a value between zero and one. It reﬂects the extent to which the given input belongs to the set.
Currently, based on the literature review, four most common types of MFs are triangular-shaped, trapezoidal-
shaped, Gaussian-shaped and Bell-shaped.
Triangular-shaped. A triangular-shaped MF is mathematically represented as
Zðx; m; n; qÞ ¼
0;
if x  m
x  m
n  m ;
if m < x < n
q  x
q  n ;
if n < x < q
0;
if x  q
0
B
B
B
B
B
B
@
(9)
where
m; n; q
f
g is the parameter set. Figure 3 shows a graphical representation of triangular-shaped MF.
Trapezoidal-shaped. A trapezoidal-shaped MF can be expressed mathematically as
Tðx; m; n; p; qÞ ¼
0;
if x  m
x  m
n  m ;
if m < x < n
1;
if n < x < p
q  x
q  p ;
if p < x < q
0;
if x  q
0
B
B
B
B
B
B
B
B
@
(10)
where
m; n; p; q
f
g is the parameter set. This is shown graphically in Figure 4.
Both triangular-shaped and trapezoidal-shaped MFs are simple in form; as seen in Figures 3 and 4, they are
composed of simple linear segments. The triangular-shaped MF can be thought as a speciﬁc form of the
178
Journal of Low Frequency Noise, Vibration and Active Control 39(1)

trapezoidal-shaped MF and both are widely used in real-life due to their simplicity and computational efﬁciency.
However, the drawback of these two MFs is lack of smooth transition, especially at the corner points.28
Gaussian-shaped. A Gaussian-shaped MF can be expressed mathematically as
Gðx; a; aÞ ¼ eðxaÞ2
2a2
(11)
where
a; a
f
g is the parameter set. Figure 5 shows a graphical representation of Gaussian-shaped MF.
Figure 4. Trapezoidal-shaped MF.
Figure 3. Triangular-shaped MF.
Peng et al.
179

Bell-shaped. A bell-shaped MF can be expressed as
Bðx; a; c; zÞ ¼
1
1 þ xc
a

2z
(12)
where
a; c; z
f
g is the parameter set. Figure 6 shows graphical representation of a bell-shaped MF.
In contrast to the MFs in Figures 3 and 4, the Gaussian-shaped and bell-shaped MFs, shown in Figures 5
and 6, respectively, are nonlinear and smooth. Besides, compared with the Gaussian-shaped MF, the bell-shaped
MF has one additional parameter, which provides one further freedom for parameter tuning.
Figure 5. Gaussian-shaped MF.
Figure 6. Bell-shaped MF.
180
Journal of Low Frequency Noise, Vibration and Active Control 39(1)

Rule base
In order to concisely imitate human’s thinking and reasoning, the main approach in FLC for description or
evaluation of the dynamic behaviour of a system is to use a set of linguistic descriptions containing linguistic
variables and linguistic values. These linguistic descriptions are based on expert knowledge and the typical form of
the expert knowledge is:
‘IF condition Then consequence’
The ‘condition’ following the keyword IF is the premise/antecedent part, while the ‘consequence’ following the
keyword THEN is the conclusion/consequent part. For the fuzzy inference engine, ‘if-then’ rule is the main
method on which it relies to imitate human reasoning and thinking. As mentioned earlier, there are two main
types of fuzzy if-then rules, Mamdani-type and TSK-type. The basic and essential difference between these two
types is the way to generate the crisp output from the fuzzy input. The Mamdani-type uses the defuzziﬁcation
technology which guarantees the intuitive interpretability. The TSK-type, on the other hand, uses the weighted
average to generate the crisp output, and is the most powerful tool for modelling a nonlinear dynamic system.
Therefore, in this paper, the TSK-type fuzzy logic is adopted for solving any potential nonlinearities in the
feedforward ANC system.
The classical form of TSK-type if-then rule is
Rj: If q1 is Pj1 and q2 is Pj2 and . . . and qn is Pjn
then
pj ¼ mj0 þ mj1  q1 þ    þ mjn  qn;
for j ¼ 1; 2 . . . :N
(13)
where qn represents the linguistic variable or the input variable and Pjn denotes the fuzzy set representing the
linguistic value. The number N represents the total number of fuzzy rules and pj is the output variable. mjn is a
real-number parameter for the linear output equation. In this step, the choice of qn and Pj1 is the most important
thing, as the optimum parameter can efﬁciently minimize the error.
The output form of the TSK model is calculated as
p ¼
XN
j¼1bjpj
XN
j¼1bj
¼
XN
j¼1bjðmj0 þ mj1  q1 þ    þ mjn  qnÞ
XN
j¼1bj
(14)
bj ¼ Pj1 q1
ð
Þ  Pj2 q2
ð
Þ  . . .  Pjn qn
ð
Þ
(15)
where bj represents the ﬁring strength value of the rule.
TSK-type fuzzy logic0based feedforward ANC system with geometric consideration
The research outcomes from Leitch and Tokhi9 have shown that the inﬂuence of geometrical arrangement of system
components on the noise cancellation performance is signiﬁcant in a three-dimensional linear propagation medium.
Meanwhile, the TSK-type FLC has shown superior ability working with adaptive techniques and is an optimal method
for dynamic nonlinear systems. Therefore, the TSK-type fuzzy logic feedforward ANC system based on geometrical
arrangement is proposed, and the structure of the proposed fuzzy logic feedforward ANC system is displayed in
Figure 7.
Here, the controller takes the form of an adaptive FIR ﬁlter due to its concise structure.2 In contrast to the
previous structure, there are two novel points for this proposed feedforward ANC system analysed below.
Geometric configuration
As can be seen in Figure 7, four acoustic paths,q1ðsÞ, q2ðsÞ, q3ðsÞ and q4ðsÞ are all modelled by pure time delay
transfer functions, and these are formulated as
Peng et al.
181

qi ¼ Aesti;
i ¼ 1; 2; 3; 4
(16)
ti ¼ Li
v ;
i ¼ 1; 2; 3; 4
(17)
where t is the time parameter denoting the time the noise passes from the source to the transducer. The parameters
L and V represent the physical distance and velocity in the corresponding medium, respectively. There are two
merits of using pure time-delay transfer function. The ﬁrst point is that it can precisely reﬂect the actual variation
of noise passing the propagation medium through the time parameter ti. The second point is that it can build the
relationship between the distance ratio and the cancellation performance. Through equations (16) and (17), it is
easier to incorporate the variation of the distance ratio into the whole simulation process, providing convenience
to obtain the related variation of cancellation performance.
TSK-type fuzzy logic and acoustic feedback
The TSK-type FLC is used in Figure 7. There are several merits in using the TSK-type FLC. Firstly, the TSK-type
is widely popular and the most useful technology. Secondly, its superior behaviour has already been demonstrated
while cooperating with optimization and adaptive techniques, especially in nonlinear control systems. It can use a
small number of rules to describe the dynamic behaviour of a highly complex nonlinear system. A step-by-step
description of implementation of the adaptive process is given below.
Step 1: Select the input and the output variables. In this system, there are two input variables for the premise part: the
acoustic feedback signal ac n
ð Þ and the error signal e n
ð Þ. During the process of noise propagating to the obser-
vation point, the secondary source loudspeaker will emit signals to all directions, upstream and downstream.
Therefore, the detected primary source signal interferes with the acoustic feedback signal and this will affect the
accuracy and overall cancellation performance of the system. In order to resolve this issue, the acoustic signal is
used as one of the inputs of the FLC. The output variable for the FLC is the coefﬁcient value for the adaptive
FIR ﬁlter.
Step 2: Choose the membership function and the linguistic value. For the proposed FLC, the trapezoidal membership
functions (MFs) is used due to its simplicity. The linguistic value for the ﬁrst input variable, error signal, is easier.
Based on several kinds of literature17,29 and the deﬁnition of the error signal, ﬁve different fuzzy sets are employed
in this system. Table 1 provides details of the linguistic values used. 30
Figure 7. Structure for TSK-type fuzzy logic feedforward ANC system based on the geometric configuration.
182
Journal of Low Frequency Noise, Vibration and Active Control 39(1)

The acoustic feedback signal ac n
ð Þ is essentially part of the secondary signal, which is adjusted by the con-
troller and fed to the loudspeaker. The range of the acoustic signal can be broadly divided into three subsets, ‘big’,
‘medium’ and ‘small’. Considering the unknown direction of the detected signal, six different fuzzy sets, shown in
Table 2, are used for its description.
Step 3: Confirm the fuzzy rules. In this system, the range of the error signal is divided into ﬁve subsets and the range
of the acoustic feedback is divided into six subsets. Therefore, the number of fuzzy rules is 30 and the correspond-
ing details are provided in Table 3.
Table 2. Linguistic value for the acoustic feedback ac(n).
Negative big
Negative medium
Negative small
Positive small
Positive medium
Positive big
(NB)
(NM)
(NS)
(PS)
(PM)
(PB)
Table 1. Linguistic value for the error signal e(n).
Negative big
Negative small
Zero
Positive small
Positive big
(NB)
(NS)
(Z)
(PS)
(PB)
Table 3. Rule map.
IF
THEN
Acoustic
feedback (ac)
Error
signal (e)
Consequence (c)
NB
NB
cf1 ¼ P1  ac1 þ Q1  e1 þ S1
NB
NS
cf2 ¼ P2  ac2 þ Q2  e2 þ S2
NB
Z
cf3 ¼ P3  ac3 þ Q3  e3 þ S3
NB
PS
cf4 ¼ P4  ac4 þ Q4  e4 þ S4
NB
PB
cf5 ¼ P5  ac5 þ Q5  e5 þ S5
NM
NB
cf6 ¼ P6  ac6 þ Q6  e6 þ S6
NM
NS
cf7 ¼ P7  ac7 þ Q7  e7 þ S7
NM
Z
cf8 ¼ P8  ac8 þ Q8  e8 þ S8
NM
PS
cf9 ¼ P9  ac9 þ Q9  e9 þ S9
NM
PB
cf10 ¼ P10  ac10 þ Q10  e10 þ S10
NS
NB
cf11 ¼ P11  ac11 þ Q11  e11 þ S11
NS
NS
cf12 ¼ P12ac12 þ Q12e12 þ S12
NS
Z
cf13 ¼ P13ac13 þ Q13e13 þ S13
NS
PS
cf14 ¼ P14ac14 þ Q14e14 þ S14
NS
PB
cf15 ¼ P15ac15 þ Q15e15 þ S15
PS
NB
cf16 ¼ P16ac16 þ Q16e16 þ S16
PS
NS
cf17 ¼ P17ac17 þ Q17e17 þ S17
PS
Z
cf18 ¼ P18ac18 þ Q18e18 þ S18
PS
PS
cf19 ¼ P19ac19 þ Q19e19 þ S19
PS
PB
cf20 ¼ P20ac20 þ Q20e20 þ S20
PM
NB
cf21 ¼ P21ac21 þ Q21e21 þ S21
PM
NS
cf22 ¼ P22ac22 þ Q22e22 þ S22
PM
Z
cf23 ¼ P23ac23 þ Q23e23 þ S23
PM
PS
cf24 ¼ P24ac24 þ Q24e24 þ S24
PM
PB
cf25 ¼ P25ac25 þ Q25e25 þ S25
PB
NB
cf26 ¼ P26ac26 þ Q26e26 þ S26
PB
NS
cf27 ¼ P27ac27 þ Q27e27 þ S27
PB
Z
cf28 ¼ P28ac28 þ Q28e28 þ S28
PB
PS
cf29 ¼ P29ac29 þ Q29e29 þ S29
PB
PB
cf30 ¼ P30  ac30 þ Q30  e30 þ S30
NB: negative big; NS: negative small; Z: zero; PS: positive small; PB: positive big.
Peng et al.
183

According to equations (14) and (15), the output is calculated as
cf ¼
X30
j¼1bjpj
X30
j¼1bj
¼
X30
j¼1bjðPj  acj þ Qj  ej þ SjÞ
X30
j¼1bj
(18)
Table 4. The type and example of primary noise.
Type
Example
Narrowband noise
A 100 Hz periodic signal.
Broadband noise
Gaussian white noise (The value of variance
is 1 and the value of mean is zero.)
(a)
Figure 8. Validation results. (a) Narrowband noise (b) broadband noise.
184
Journal of Low Frequency Noise, Vibration and Active Control 39(1)

Case studies and simulation results
In this section, three computational experiments, namely feasibility tests with the proposed scheme, effects of
distance ratio for narrowband cancellation, and effects of distance ratio for broadband cancellation, are con-
ducted using Matlab/Simulink platform. In order to reduce the computational burden and simplify the optimi-
zation process, but not losing generality with focus on the effect of the distance ratio on the noise cancellation
performance, the zero-order TSK-type FLC is used in the simulation process. All the simulation cases use sam-
pling frequency of 1/1000 Hz and the simulation time for each case is 5 s.
Case 1: Feasibility tests
The ﬁrst case study is to benchmark the noise (with both narrowband and broadband) cancellation effects of using
the proposed TSK-type fuzzy logic feedforward ANC scheme. Table 4 summarizes the type of primary noise and
corresponding example. The case study uses both time and frequency domain plots to illustrate the simula-
tion results.
(b)
Figure 8. Continued.
Peng et al.
185

The results in the Figure 8(a1) and 8(a2) are time domain and frequency domain for the narrowband noise
cancellation while using the proposed ANC system. From time domain analysis, as noted the amplitude for the
cancelled wave is 0.89, while the amplitude for the original wave was 1. The percentage of cancellation thus was
11%. From the frequency domain analysis, the percentage of cancellation was 11.89%. Both analyses demon-
strate the cancellation capability of the proposed ANC system for the narrowband noise.
The results in Figure 8(b1) and 8(b2) are the cancellation performance for the broadband noise in both time
domain and frequency domain. The cancellation performance for the broadband noise is complex compared with
the narrowband noise. For time domain analysis, for example, the difference in the amplitude between the original
noise wave and the cancelled wave at 1500 ms was roughly 1.6, the percentage was approximately 48.5%, and the
percentage at 1900 ms was only 5.9%. For frequency domain analysis, the percentage of the cancellation could
reach approximately 30% at 60 Hz while only around 10% at 68 Hz.
Generally, the simulation results in Figure 8 demonstrate the cancellation capability of the proposed feedfor-
ward ANC system for both narrowband noise and broadband noise.
Case 2: Effects of distance ratio for narrowband cancellation
The second simulation is to investigate the inﬂuence of distance ratio for the narrowband noise while using the
TSK-type FLC feedforward ANC system. As discussed previously, three different distance conditions exist in real
life. The ﬁrst condition is that the value of the distance ratio for the detector is smaller than one. This implies that
the detector is placed close to the primary source. The second condition is that the value of the distance ratio
for the detector is greater than one but smaller than the value of the distance ratio for the observer. This means
that the detector is close to the secondary source. The third condition is that the distance ratio for the detector is
greater than the value of the distance ratio for the observer.
In Figure 9, it is clear that for the narrowband noise, different distance ratios have different effects on the
overall noise cancellation performance. The difference exists in both amplitude and frequency. For amplitude, the
optimal condition is that 1 < q3
q4 < q1
q2 and the difference between the dashed line and the dotted line is approx-
imately 3 dB. For the frequency, regardless of the distance ratio, the frequency for all conditions as noted is lower
than 100 Hz but the difference is within 0.5 Hz. This is called frequency mismatch, but the fact is that there is no
signiﬁcant difference between different conditions in this case. This result implies that for the narrowband noise
cancellation, it is better to place both transducers closer to the secondary source to achieve optimal cancellation
performance, and as the difference between the second condition and the third condition is not huge, the relative
positions for the detector and the observer should be based on actual requirements. In summary, as the
Figure 9. Comparison results for different distance ratios for narrowband noise cancellation.
186
Journal of Low Frequency Noise, Vibration and Active Control 39(1)

narrowband noise widely exists in the real life, different required performance can be achieved by adjusting the
distance ratio for the transducer.
Case 3: Effects of distance ratio for broadband cancellation
The third simulation is to investigate the inﬂuence of distance ratio for broadband noise while using the TSK-type
FLC feedforward ANC system.
The simulation results in Figure 10 reveal that the situation for the broadband noise is more sophisticated than
the narrowband noise. Firstly, similar to the frequency analysis of the narrowband noise cancellation, the fre-
quency mismatch exists and the main reason is possibly due to the different physical distances and the process of
sampling. Secondly, for the broadband noise cancellation, the effect of distance ratio is signiﬁcant and the optimal
distance ratios for different frequency ranges are different. For example, the best distance ratio between 7 Hz to
14 Hz is 1 < q1
q2 < q3
q4 and the condition changes to q1
q2 < 1 < q3
q4 for frequencies between 27 Hz and 33 Hz. In other
words, the distance ratio has a signiﬁcant inﬂuence on the broadband noise cancellation and the optimal distance
ratio is not unique. Thus, the selection of distance ratio should be based on speciﬁed requirements.
Conclusion
The study has developed a scheme of FLC-based feedforward ANC with due consideration of distance ratio and
acoustic feedback, and has validated the designed procedure though three computational experiments. The ﬁrst
case is to demonstrate the capability of noise cancellation for the proposed fuzzy logic-based ANC system for
both narrowband noise and broadband noise cancellation. Simulation results from both time domain and fre-
quency domain analyses demonstrate that the proposed feedforward ANC system can implement the task of
cancellation, and the cancellation performance for the broadband noise is more complicated than the cancellation
performance for the narrowband noise. The second and the third cases discuss the inﬂuence of distance ratio for
the overall noise cancellation. The results reveal that the effect of different distance ratios on the noise cancellation
performance is distinct and the optimal distance ratio for the different types of noise is different. Generally, the
performance of the fuzzy logic-based ANC system is better, and future work will investigate this from two aspects.
Firstly, as the current work has used zero-order TSK-type FLC with the aim of focusing on investigating the effect
of the distance ratio, further work on establishing the impact of employing the linear equation at the consequent
part with optimised parameters on cancellation performance will be carried out. Secondly, to investigate the
regional optimal distance ratio for different noise sources and solve, the frequency mismatch problems in the
TSK-type fuzzy logic feedforward ANC system.
Declaration of conflicting interests
The author(s) declare no potential conﬂicts of interest with respect to the research, authorship, and/or publication of
this article.
Figure 10. Comparison results for different distance ratios for broadband noise cancellation.
Peng et al.
187

Funding
The author(s) received no ﬁnancial support for the research, authorship, and/or publication of this article.
ORCID iD
Tongrui Peng
http://orcid.org/0000-0003-4371-3281
References
1. Seidman MD and Standring RT. Noise and quality of life. Int J Environ Res Public Health 2010; 7: 3730–3738.
2. Nithin VG and Ganapati P. Advances in active noise control: a survey, with emphasis on recent nonlinear techniques.
Signal Process 2013; 93: 363–377.
3. Sung CL, Joo YH and Jin YJ. Effects of acoustic characteristics of combined construction noise on annoyance. Build
Environ 2015; 92: 657–667.
4. Fyhri A and Aasvang GM. Noise, sleep and poor health: modeling the relationship between road trafﬁc noise and
cardiovascular problems. Sci Total Environ 2010; 408: 4935–4942.
5. Aluclu I, Dalgic A and Toprak ZF. A fuzzy logic-based model for noise control at industrial workplaces. Appl Ergon 2008;
39: 368–378.
6. Jiang JG and Li Y. Review of active noise control techniques with emphasis on sound quality enhancement. Appl Acoust
2018; 136: 139–148.
7. Elliott SJ and Nelson PA. Active noise control. IEEE Signal Process Mag 1993; 10: 12–35.
8. Lueg P. Process of silencing sound oscillations, Patent 2043416, US 9 June 1936.
9. Leitch RR and Tokhi MO. Active noise control systems. IEE Proc A Phys Sci Meas Instrum Manage Educ Rev UK 1987;
134: 525–546.
10. Kuo SM and Morgan DR. Active noise control: a tutorial review. IEEE Proc 1999; 87: 973–993.
11. Tan LZ and Jiang J. Filtered-X second-order Volterra adaptive algorithms. Electron Lett 1997; 33: 671–672.
12. Kuo SM and Wu HT. Nonlinear adaptive bilinear ﬁlters for active noise control systems. IEEE Trans Circuit Syst 2005;
52: 617–624.
13. Patra JC, Pal RN, Chatterji BN, et al. Identiﬁcation of nonlinear dynamic systems using functional link artiﬁcial neural
networks. IEEE Trans Syst, Man, Cybern B 1999; 29: 254–262.
14. Snyder SD and Tanaka N. Active control of vibration using a neural network. IEEE Trans Neural Netw 1995; 6: 819–828.
15. Chang CY and Shyu KK. Active noise cancellation with a fuzzy adaptive ﬁltered-X algorithm. IEE Proc, Circuits Devices
Syst 2003; 150: 416–422.
16. Jiang, J-S.R. ANFIS: adaptive-network-based fuzzy inference system. IEEE Transactions on Systems, Man, and
Cybernetics 1993; 23(3): 665–685.
17. Kipersztok O. Active control of broadband noise using fuzzy logic. In: Second IEEE international conference on fuzzy
systems, San Francisco, 11 March 1993. pp.906–911.
18. Leitch RR and Tokhi MO. The implementation of active noise control systems using digital signal processing techniques.
Proc Inst Acoust 1986; 8(1): 149–157.
19. Tokhi MO and Wood R. Active noise control using radial basis function networks. Control Eng Pract 1997;
5: 1311–1322.
20. Tokhi MO and Wood R. Active noise control using multi-layered perceptron neural networks. J Low Freq Noise, Vibr
Active Control 1997; 16: 109–144.
21. Tokhi MO and Mamour K. Noise control in three-dimensional propagation. In: UKACC international conference on
control ’96 (Conf. Publ. No. 427) Exeter, UK, 2–5 September 1996. pp.1097–1101.
22. Tokhi MO and Raja Ahmad RK. Theoretical development of minimum effort active noise control with feedback inclusion
architecture. J Low Freq Noise Vibr Active Control 2008; 27: 75–81.
23. Tokhi MO and Raja Ahmad RK. Analysis of geometry related constraints of minimum effort active noise control system.
J Low Freq Noise Vibr Active Control 2010; 29: 111–128.
24. Jang JSR. ANFIS: adaptive-network-based fuzzy inference system. IEEE Trans Syst, Man, Cybern 1993; 23: 665–685.
25. Shihabudheen KV and Pillai GN. Recent advances in neuro-fuzzy system: a survey. Knowledge-Based Syst 2018;
152: 136–162.
26. Francesco C, Angelo C, Giovannelli V, et al. A fuzzy decision system for genetically modiﬁed plant environmental risk
assessment using Mamdani inference 2015 42(3): 1710–1716.
27. Bosquea G, Campob ID and Echanobeb J. Fuzzy systems, neural networks and neuro-fuzzy systems: a vision on their
hardware implementation and platforms over two decades. Eng Appl Artif Intell 2014; 32: 283–331.
28. Tang AM, Quek HC and Ng GS. GA-TSKfnn: Parameters tuning of fuzzy neural network using genetic algorithms.
Expert Systems with Applications 2005; 29: 769–781.
29. Yen J, Wang L and Gillespie CW. Improving the interpretability of TSK fuzzy models by combining global learning and
local learning. IEEE Trans Fuzzy Syst 1998; 6: 530–537.
188
Journal of Low Frequency Noise, Vibration and Active Control 39(1)

30. Kipersztok O and Hammond R. Fuzzy active control of a distributed broadband noise source. In: Proceedings of 1994
IEEE 3rd international fuzzy systems conference. Orlando, FL, USA, 26–29 June 1994. pp.906–911.
31. Kuo SM and Morgan DR. Review of DSP algorithms for active noise control. In: IEEE international conference on control
applications. Conference Proceedings (Cat. No.00CH37162) Anchorage, AK, USA, 25–27 September 2000. pp.243–248.
32. Patil PD and Patel JJ. A Comprehensive review on fuzzy logic system. Int J Eng Comput Sci 2014; 3: 9160–9165.
33. Zadeh LA. Outline of a new approach to the analysis of complex systems and decision processes. IEEE Trans Syst, Man,
Cybern 1973; 3: 28–44.
34. Takagi T and Sugeno M. Fuzzy identiﬁcation of systems and its applications to modeling and control. IEEE Trans Syst,
Man, Cybern 1985; 15: 116–132.
35. Chuen C L. Fuzzy Logic in control systems: fuzzy logic controller – part I. IEEE Trans Syst, Man, Cybern 1990;
20: 404–418.
36. Chuen CL. Fuzzy logic in control systems: fuzzy logic controller – part II. IEEE Trans Syst, Man, Cybern 1990;
20: 419–435.
37. Kipersztok O and Hammond R. The use of fuzzy logic in active noise control. In: Proceedings of 3rd international
symposium on uncertainty modeling and analysis and annual conference of the North American Fuzzy Information
Processing Society, College Park, MD, USA, 17–20 September 1995. pp.577–582.
Peng et al.
189

