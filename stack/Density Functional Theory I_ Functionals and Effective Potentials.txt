80 Topics in Current Chemistry 

Density Functional Theory I 
Functionals and Effective Potentials 
Volume Editor: R. F. Nalewajski 
With contributions by 
E. J. Baerends, K. Burke, M. Ernzerhof, 
D. J. W. Geldart, O. V. Gritsenko, A. Holas, 
R. L6pez-Boada, E.V. Ludefia, N. H. March, 
J. P. Perdew, R. van Leeuwen 
With 34 Figures and 16 Tables 
Springer 

This series presents critical reviews of the present position and future trends in modern 
chemical research. It is addressed to all research and industrial chemists who wish to 
keep abreast of advances in the topics covered. 
As a rule, contributions are specially commissioned. The editors ~ind publishers will, 
however, always be pleased to receive suggestions and supplementary information. 
Papers are accepted for "Topics in Current Chemistry" in English. 
In references Topics in Current Chemistry is abbreviated Top.Curr.Chem. and is cited 
as a journal. 
Springer WWW home page: http://www.springer.de 
ISBN 3-540-61091-X SpringeroVerlag Berlin Heidelberg NewYork 
Library of Congress Catalog Card Number 74-644622 
This work is subject to copyright. All rights are reserved, whether the whole or part of the 
material is concerned, specifically the rights of translation, reprinting, reuse of illustrations, 
recitation, broadcasting, reproduction on microfilm or in any other way, and storage in data 
banks. Duplication of this publication or parts thereof is permitted only under the provisions 
of the German Copyright Law of September 9, 1965, in its current version, and permission 
for use must always be obtained from Springer-Verlag. Violations are liable for prosecution 
under the German Copyright Law. 
© Springer-Verlag Berlin Heidelberg 1996 
Printed in Germany 
The use of general descriptive names, registered names, trademarks, etc. in this publication 
does not imply, even in the absence of a specific statement, that such names are exempt from 
the relevant protective laws and regulations and therefore free for general use. 
Typesetting: Macmillan India Ltd., Bangalore-25 
SPIN: 10509048 
66/3020 - 5 4 3 2 1 0 - Printed on acid-free paper 

Volume Editor 
Prof. R. F. Nalewajski 
Jagiellonian University 
Faculty of Chemistry 
ul. lngardena 3 
30-060 Krakow, Poland 
Editorial Board 
Prof. Dr.Jack D. Dunitz 
Prof. Dr. Klaus Hafner 
Prof. Dr. Kendall A( Houk 
Prof. Dr. Sho lto 
Prof. Dr. dean-Marie Lehn 
Prof. Dr. Kenneth N. Raymond 
Prof. Dr. Charles W. Rees 
Prof. Dr. daachim Thiem 
Prof. Dr. Fritz ViJgtle 
Laboratorium ffir Organisehe Chemic 
der EidgenOssischen Hochschule 
Universitfitsstrage 6/8, CH-8006 Ziirich 
Institut fiir Organische Chemic der TH, 
Petersenstrage 15, 64287 Darmstadt, FRG 
University of California, Department 
of Chemistry and Biochemistry, 405 Hilgard Avenue, 
Los Angeles, CA 90024-1589, USA 
Faculty of Pharmaceutical Sciences, 
Tokushima Bunri University, 
Tokushima 770, Japan 
Institut de Chimie, Universit6 de Strasbourg, 
1 rue Blaise Pasc~/l, B. P. Z 296/R8, F-67008 Strasbourg-Cedex 
Department of Chemistry, University of California, 
Berkeley, CA 94720, USA 
Hofmann Professor of Organic Chemistry, Department 
of Chemistry, Imperial College of Science and Technology, 
South Kensington, London SW7 2AY, England 
Institut fflr Organische Chemie, Universitfit Hamburg, 
Mar tin-Luther-King-Platz 6, 20146 Hamburg, FRG 
Institut flir Organische Chemie und Bioehemie der Universit~t, 
Gerhard-Domagk-Stral~e 1, 53121 Bonn, FRG 

Foreword 
Density functional theory (DFT) is an entrancing subject. It is entrancing to chemists 
and physicists alike, and it is entrancing for those who like to work on mathematical 
physical aspects of problems, for those who relish computing observable properties 
from theory and for those who most enjoy developing correct qualitative descriptions 
of phenomena in the service of the broader scientific community. 
DFT brings all these people together, and DFT needs all of these people, because 
it is an immature subject, with much research yet to be done. And yet, it has already 
proved itself to be highly useful both for the calculation of molecular electronic 
ground states and for the qualitative description of molecular behavior. It is already 
competitive with the best conventional methods, and it is particularly promising in 
the applications of quantum chemistry to problems in molecular biology which are 
just now beginning. This is in spite of the lack of complete development of DFT 
itself. In the basic researches in DFT that must go on, there are a multitude of 
problems to be solved, and several different points of view to find full expression. 
Thousands of papers on DFT have been published, but most of them will become 
out of date in the future. Even collections of works such as those in the present 
volumes, presentations by masters, will soon be of mainly historic interest. Such 
collections are all the more important, however, when a subject is changing so fast- 
as DFT. Active workers need the discipline imposed on them by being exposed to 
the works of each other. New workers can lean heavily on these sources to learn the 
different viewpoints and the new discoveries. They help allay the difficulties 
associated with the fact that the literature is in both physics journals and chemistry 
journals. [For the first two-thirds of my own scientific career, for example, I felt 
confident that I would miss nothing important if I very closely followed the Journal 
of Chemical Physics. Most physicists, I would guess, never felt the need to consult 
JCP. What inorganic or organic chemist in the old days took the time to browse in 
the physics journals?] The literature of DFT is half-divided, and DFT applications 
are ramping into chemical and physical journals, pure and applied. Watch JCP, 
Physical Review A and Physical Review B, and watch even Physical Review Letters, 
if you are a chemist interested in applying DFT. Or ponder the edited volumes, 
including the present four. Then you will not be surprised by the next round of 
improvements in DFT methods. Improvements are coming. 
The applications of quantum mechanics to molecular electronic structure may 
be regarded as beginning with Pauling's Nature of the Chemical Bond, simple 

VIII 
Foreword 
molecular orbital ideas, and the Htickel and Extended HUckel Methods. The 
molecular orbital method then was systematically quantified in the Hartree-Fock 
SCF Method; at about the same time, its appropriateness for chemical description 
reached its most elegant manifestation in the analysis by Charles Coulson of the 
Htlckel method. Chemists interested in structure learned and taught the nature of 
the Hartree-Fock orbital description and the importance of electron correlation in 
it. The Hartree-Fock single determinant is only an approximation. Configurations 
must be mixed to achieve high accuracy. Finally, sophisticated computational 
programs were developed by the professional theoreticians that enabled one to 
compute anything. Some good methods involve empirical elements, some do not, 
but the road ahead to higher and higher accuracy seemed clear: Hartree-Fock plus 
correction for electron correlation. Simple concepts in the everyday language of 
non theoretical chemists can be analyzed (and of course have been much analyzed) 
in this context. 
Then, however, something new came along, density functional theory. This is, 
of course, what the present volumes are about. DFT involves a profound change in 
the theory. We do not have merely a new computational gimmick that improves 
accuracy of calculation. We have rather a big shift of emphasis. The basic variable 
is the electron density, not the many-body wavefunction. The single determinant of 
interest is the single determinant that is the exact wavefuntion for a noninteracting 
(electron-electron repulsion-less) system corresponding to our particular system of 
interest, and has the same electron density as our system of interest. This single 
determinant, called the Kohn-Sham single determinant, replaces the Hartree-Fock 
determinant as the wavefunction of paramount interest, with electron correlation 
now playing a lesser role than before. It affects the potential which occurs in the 
equation which determines the Kohn-Sahm orbitals, but once that potential is 
determined, there is no configurational mixing or the like required to determine the 
accurate electron density and the accurate total electronic energy. Hartree-Fock 
orbitals and Kohn-Sham orbitals are quantitatively very similar, it has turned out. 
Of the two determinants, the one of Kohn-Sham orbitals is mathematically more 
simple than the one of Hartree-Fock orbitals. Thus, each KS orbital has its own 
characteristic asymptotic decay; HF orbitals all share in the same asymptotic decay. 
The highest KS eigenvalue is the exact first ionization potential; the highest HF 
eigenvalue is an approximation to the first ionization potential. The KS effective 
potential is a local multiplicative potential; the HF potential is nonlocal and 
nonmultiplicative. And so on. When at the Krak6w meeting I mentioned to a physicist 
that I thought that chemists and physicists all should be urged to adopt the KS 
determinant as the basic descriptor for electronic structure, he quickly replied that 
the physicists had already done so. So, I now offer that suggestion to the chemistry 
community. 
On the conceptual side, the powers of DFT have been shown to be considerable. 
Without going into detail, I mention only that the Coulson work referred to above 
anticipated in large part the formal manner in which DFT describes molecular 
changes, and that the ideas of electronegativity and hardness fall into place, as do 
Ralph Pearson's HSAB and Maximum Hardness Principles. 

Foreword 
IX 
It was Mel Levy, I think who first called density functional theory a charming 
subject. Charming it certainly is to me. Charming it should be revealed to you as 
you read the diverse papers in these volumes. 
Chapel Hill, 1996 
Robert G. Parr 

Foreword 
Thirty years after Hohenberg and myself realized the simple but important fact that 
the theory of electronic structure of matter can be rigorously based on the electronic 
density distribution n(r) a most lively conference was convened by Professor R. 
Nalewajski and his colleagues at the Jagiellonian University in Poland's historic 
capital city, Krakow. The present series of volumes is an outgrowth of this conference. 
Significantly, attendees were about equally divided between theoretical physicists 
and chemists. Ten years earlier such a meeting would not have had much response 
from the chemical community, most of whom, I believe, deep down still felt that 
density functional theory (DFT) was a kind of mirage. Firmly rooted in a tradition 
based on Hartree Fock wavefunctions and their ref'mements, many regarded the 
notion that the many electron function,~P(r~ ... rt¢ ) could, so to speak, be traded in 
for the density n(r), as some kind of not very serious slight-of-hand. However, by 
the time of this meeting, an attitudinal transformation had taken place and both 
chemists and physicists, while clearly reflecting their different upbringings, had 
picked up DFT as both a fruitful viewpoint and a practical method of calculation, 
and had done all kinds of wonderful things with it. 
When I was a young man, Eugene Wigner once said to me that understanding in 
science requires understanding from several different points of view. DFT brings 
such a new point of view to the table, to wit that, in the ground state of a chemical 
or physical system, the electrons may be regarded as a fluid which is fully 
characterized by its density distribution, n(r). I would like to think that this viewpoint 
has enriched the theory of electronic structure, including (via potential energy 
surfaces) molecular structure; the chemical bond; nuclear vibrations; and chemical 
reactions. 
The original emphasis on electronic ground states of non-magnetic systems has 
evolved in many different directions, such as thermal ensembles, magnetic systems, 
time-dependent phenomena, excited states, and superconductivity. While the abstract 
underpinning is exact, implementation is necessarily approximate. As this conference 
clearly demonstrated, the field is vigorously evolving in many directions: rigorous 
sum rules and scaling laws; better understanding and description of correlation 
effects; better understanding of chemical principles and phenomena in terms of 
n(r); application to systems consisting of thousands of atoms; long range polarization 
energies; excited states. 

XII 
Foreword 
Here is my personal wish lists for the next decade: (1) An improvement of the 
accurary of the exchange-correlation energy E [n(r)] by a factor of 3-5. (2) A 
practical, systematic scheme which, starting from the popular local density approach, 
can - with sufficient effort - yield electronic energies with any specified accuracy. 
(3) A sound DFT of excited states with an accuracy and practicality comparable to 
present DFT for ground states. (4) A practical scheme for calculating electronic 
properties of systems of ! 03 - 10 s atoms with "chemical accuracy". The great progress 
of the last several years made by many individuals, as mirrored in these volumes, 
makes me an optimist. 
Santa Barbara, 1996 
Walter Kohn 

Preface 
Density functional methods emerged in the early days of quantum mechanics; 
however, the foundations of the modem density functional theory (DFT) were 
established in the mid 1960s with the classical papers by Hohenberg and Kohn 
(1964) and Kohn and Sham (1965). Since then impressive progress in extending 
both the theory formalism and basic principles, as well as in developing the DFT 
computer software has been reported. At the same time, a substantial insight into 
the theory structure and a deeper understanding of reasons for its successes and 
limitations has been reached. The recent advances, including new approaches to 
the classical Kohn-Sham problem and constructions of more reliable functionals, 
have made the ground-state DFT investigations feasible also for very large molecular 
and solid-state systems (of the order of 103 atoms), for which conventional CI 
calculations of comparable accuracy are still prohibitively expensive. The DFT is 
not free from difficulties and controversies but these are typical in a case of a healthy, 
robust discipline, still in a stage of fast development. The growing number of 
monographs devoted to this novel treatment of the quantum mechanical many body 
problem is an additional measure of its vigor, good health and the growing interest 
it has attracted. 
In addition to a traditional, solid-state domain of appplications, the density 
functional approach also has great appeal to chemists due to both computational 
and conceptual reasons. The theory has already become an important tool within 
quantum chemistry, with the modem density functionals allowing one to tackle 
problems involving large molecular systems of great interest to experimental 
chemists. This great computational potential of DFT is matched by its already 
demonstrated capacity to both rationalize and quantify basic classical ideas and 
rules of chemistry, e.g., the electronegativity and hardness/softness characteristics 
of the molecular electron distribution, bringing about a deeper understanding of the 
nature of the chemical bond and various reactivity preferences. The DFT description 
also effects progress in the theory of chemical reactivity and catalysis, by offering a 
"thermodynanic-like" perspective on the electron cloud reorganization due to the 
reactant/catalyst presence at various intermediate stages of a reaction, e.g. allowing 
one to examine the relative importance of the polarization and charge transfer 
components in the resultant reaction mechanism, to study the influence of the infi- 
nite surface reminder of cluster models of heterogeneous catalytic systems, etc. 
The 30th anniversary of the modem DFT was celebrated in June 1994 in Cracow, 

XIV 
Preface 
where about two hundred scientists gathered at the ancient Jagiellonian University 
during the International Symposium: "Thirty Years of Density Functional Theory: 
Concepts and Applications", Satellite Meeting of the 8th International Congress of 
Quantum Chemistry in Prague. Professors Walter Kohn, Norman H. March and 
Robert G. Parr were the honorary chairmen of the conference. Most of the reviewers 
of these four volumes include the plenary lecturers of this symposium; other leading 
contributors to the field, physicists and chemists, were also invited to take part in 
this DFT survey. The fifteen chapters of this DFT series cover both the basic theory 
(Parts I, II, and the first article of Part III), applications to atoms, molecules and 
clusters (Part III), as well as the chemical reactions and the DFT rooted theory of 
chemical reactivity (Part IV). This arrangement has emerged as a compromise 
between the volume size limitations and the requirements of the maximum thematic 
unity of each part. 
In these four DFT volumes of the Topics in Current Chemistry series, a real 
effort has been made to combine the authoritative reviews by both chemists and 
physicists, to keep in touch with a wider spectrum of current developments. The 
Editor deeply appreciates a fruitful collaboration with Dr. R. Stumpe, Dr. M. Hertel 
and Ms B. Kollmar-Thoni of the Springer-Verlag Heidelberg Office, and the very 
considerable labour of the Authors in preparing these interesting and informative 
monographic chapters. 
Cracow, 1996 
Roman F. Nalewajski 

Table of Contents 
Density Functionals: Where Do They Come From, 
Why Do They Work? 
M. Ernzerhof, J. P. Perdew, K. Burke ................... 
Nonlocal Energy Functionals: Gradient Expansions 
and Beyond 
D. J. W. Geldart .................................. 
31 
Exchange and Correlation in Density Functional 
Theory of Atoms and Molecules 
A. Holas, N. H. March ............................. 
57 
Analysis and Modelling of Atomic and Molecular 
Kohn-Sham Potentials 
R. van Leeuwen, O.V. Gritsenko, E. J. Baerends .......... 
107 
Local-Scaling Transformation Version of Density 
Functional Theory: 
Generation of Density Functionals 
E. V. Ludefia, R. L6pez-Boada ....................... 
169 
Author Index Volumes 151 - 180 ..................... 
225 

Table of Contents of Volume 183 
Density Functional Theory IV: 
Theory of Chemical Reactivity 
Density Functional Theory Calculations of Pericyclic 
Reaction Transition Structures 
O. Wiest and K. N. Houk 
Reactivity Criteria in Charge Sensitivity Analysis 
R. F. Nalewajski, J. Korchowiec and A. Michalak 
Strengthening the Foundations of Chemical Reactivity Theory 
M. H. Cohen 

Table of Contents of Volume 181 
Density Functional Theory II: 
Relativistic and Time-Dependent Extensions 
Relativistic Density Functional Theory 
E. Engel and R. M. Dreizler 
Density Functional Theory of Time-Dependent Phenomena 
E. K. U. Gross, J. F. Dobson, and M. Petersilka 
Generalized Functional Theory of Interacting Coupled 
Liouvillean Quantum Fields of Condensed Matter 
A. K. Rajagopal and F. A. Buot 
Table of Contents of Volume 182 
Density Functional Theory III: 
Interpretation, Atoms, Molecules and Clusters 
Quantum-Mechanical Interpretation of Density Functional Theory 
V. Sahni 
Application of Density Functional Theory to the Calculation of Force Fields 
and Vibrational Frequencies of Transition Metal Complexes 
A. B~rces and T. Ziegler 
Structure and Spectroscopy of Small Atomic Clusters 
R. O. Jones 
Density Functional Theory of Clusters of Nontransition 
Metals Using Simple Models 
J. A. Alonso and L. C. Balbfis 

Density Functionals: Where Do They Come from, 
Why Do They Work? 
Matthias Ernzerhof, John P. Perdew, and Kieron Burke 
Department of Physics and Quantum Theory Group, Tulane University, New Orleans, LA 70118, 
USA (In preparation for Density Functional Theory, ed. R. Nalewajski, Springer-Verlag, Berlin, 
1996) 
Table of Contents 
1 Density Functionals in Quantum Chemistry and Solid-State Physics: 
Introduction and Summary .......................... 
2 Exchange-Correlation Hole ......................... 
5 
2.1 Pointwise Decomposition of Energy ................. 
7 
2.2 Real-Space Decomposition of Energy ................. 
9 
2.3 On-Top Exchange-Correlation Hole ................. 
12 
2.4 Importance of the Uniform Gas Limit ................ 
14 
2.5 I~ong-Range Asymptotics of the Hole ................. 
15 
2.6 Relevance of the Exchange-Correlation Potential .......... 
18 
3 Understanding Nonlocality .......................... 
19 
3.1 Coupling-Constant Decomposition .................. 
20 
3.2 Hybrid Functionals ........................... 
21 
3.3 Spin Decomposition ........................... 
23 
3.4 Hybrid Density Functional-Wavefunction Methods ........ 
24 
4 Abnormal Systems and Extreme Nonlocality ............... 
25 
5 Appendices ................................... 
27 
5.1 Details of Configuration Interaction (CI) Calculations ....... 
27 
5.2 Details of MP2 Calculation of Spin-Decomposition ........ 
27 
6 References ................................... 
28 
Topics in Current Chemistry, VoL t 80 
© Springer-Vedag Berlin Heidelberg 1996 

M. Ernzerhof et al. 
Gradient-corrected or semi-local functionals (GGA's) have achieved the accuracy required to make 
density functional theory a useful tool in quantum chemistry. We show that local (LSD) and 
semi-local functionals work because they usefully model the exchange-correlation hole around an 
average electron, rather than by yielding accurate results at all electron positions. We discuss the 
system-averaged hole at small interelectronic separations, where such functionals are extremely 
accurate, and at large interelectronic separations, where the local approximation is incorrect for 
finite systems. We argue that the "on-top" hole density provides the missing link between real atoms 
and molecules and the uniform electron gas. We show how exchange-correlation potentials can be 
related to energies. We also discuss how the degree of nonlocality0 i.e., the error made by LSD, is 
related to the spatial extent of the hole. Decomposing the energy by coupling-constant and spin, we 
find that the deeper the on-top hole is, the smaller the error in the local approximation to the energy. 
We use this insight to demonstrate that Hartree-Fock hybrid functionals do not consistently 
improve on GGA. A different hybrid invokes wavefunction methods for exchange and parallel-spin 
correlation, but we show that configuration interaction wavefunction calculations with limited basis 
sets for the Ne atom make the same relative errors in the antiparallel- and parallel-spin correlation 
energies, despite the lack of a Coulomb cusp in the parallel-spin correlation hole. Finally. we review 
a recent reinterpretation of spin density functional theory, which is preferable to the standard 
interpretation in certain cases of extreme nonlocality. 
1 Density Functionals in Quantum Chemistry and Solid-State 
Physics: Introduction and Summary 
Most practical electronic structure calculations using density functional theory 
[1] involve solving the Kohn-Sham equations [2]. The only unknown quantity 
in a Kohn-Sham spin-density functional calculation is the exchange-correlation 
energy (and its functional derivative) [2] 
Ex¢=T-T~+V~e-U, 
(1) 
where T is the interacting kinetic energy, Ts is the non-interacting kinetic energy, 
V~e is the exact Coulomb repulsion, and U = S dar~dar'n(r)n(r ')/21r - r'lis the 
classical Coulomb energy associated with the density n(r). Modern density 
functional calculations are based on some approximate form of Ext. For 
example, the local spin density (LSD) approximation [2] is: 
LSD 
3 
unif 
Ex~ [n~,n~] = ~d rn(r)~x¢ (n~(r),n~(r)), 
(2) 
where 
unif 
~x¢ (nT(r), n~(r)) is the exchange-correlation energy per particle of a uni- 
form electron gas (jellium) [3, 4]. Eq. (2) is exact for an electron gas of uniform 
(jellium) or slowly-varying spin densities. 
For many years, LSD has been very popular with solid-state physicists [1], 
and quite unpopular with quantum chemists [5]. LSD achieves a remarkable 
moderate accuracy for the energies and densities of almost all systems, no matter 
how rapidly their densities vary. In fact, LSD solid-state calculations are often 
called ab initio. However, this moderate accuracy is insufficient for chemical 
purposes, and no way was known to improve the approximation systematically. 

Density Functionals: Where Do They Come from, Why Do They Work? 
Recently, a new class of functionals, called generalized gradient approxima- 
tions (GGA's) [6-14], has been developed. These take the general form 
E GGA r. 
~ 
t,,~,n~] = Sdarf(nT(r),n~(r), Vn T, Vn~), 
(3) 
where the function f is chosen by some set of criteria. The idea is that, by 
including information about the gradient, one should be able to improve the 
accuracy of the functional. Several forms for f are currently in use in the 
literature [7-1 t], but we focus on the Perdew-Wang 1991 (PW91) form [11-14], 
because it is derived without semiempirical parameters and is the 'best' func- 
tional on formal grounds [12]. Results of calculations with this form show that 
it typically reduces exchange energy errors from 10% in LSD to 1% and 
correlation energy errors from 100% to about 10% [13]. PW91 corrects the 
LSD overestimate of atomization energies for molecules and solids in almost all 
cases, it enlarges equilibrium bond lengths and lattice spacings, usually cor- 
rectly, and reduces vibrational frequencies and bulk moduli, again usually 
correctly [14]. PW91 also generaUy improves activation barriers [15] and yields 
an improved description of the phase diagram of Fe under normal or high 
pressure [16]. In almost all cases where PW91 has been carefully tested, it 
significantly improves on LSD. Thus PW91 and similar GGA's have become 
popular in quantum chemistry. 
The success of PW91 can be understood in terms of its construction as 
a systematic, parameter-free refinement of LSD. While LSD does not typically 
work well at all points in the system (Sect. 2.1), it does remarkably well for 
system-averaged quantities, such as the energy, because the average electron 
lives in a region of moderate density variation and because the LSD exchange- 
correlation hole satisfies many conditions satisfied by the exact hole. A straight- 
forward gradient expansion violates these conditions, but a real-space cutoff 
procedure restores them [8, l l], leading to an improved description of sys- 
tem-averaged quantities, as shown in Sect. 2.2. The PW91 functional is a par- 
ametrization of the result of this procedure. In particular, we study the sys- 
tem-averaged exchange-correlation hole, a function of the separation between 
any two points in the system, and demonstrate that LSD gives a remarkably 
accurate description of this quantity [17], which is improved by PW91 [17]. 
The LSD and PW91-GGA system-averaged holes agree at zero interelec- 
tronic separation, where both are nearly exact. In Sect. 2.3, we discuss how the 
near-universality of this "on-top" hole density provides the missing link between 
real atoms and molecules and the uniform dectron gas. Except very close to the 
nucleus, the local on-top hole density is also accurately represented by LSD, 
even in the classically-forbidden tail region of the electron density [18]. 
In Ref. [12], Perdew and Burke made a graphical comparison of various 
GGA's. The popular functionals for exchange (Perdew-Wang 86 [8], Becke 88 
[9], and Perdew-Wang 91 [11-14]) are similar for practical purposes, but the 
popular functionals for correlation are not. In particular, the Lee-Yang-Parr 88 
[10] functional is rather different from the Perdew-Wang 1986 [7], and 1991 
[11-14] correlation functionals. In fact, the LYP correlation energy is in error 

M. Ernzerhof et aL 
by about a factor of two in the important uniform-gas limit [18]. We discuss this 
difference further in Sect. 2.4, as we believe it has important consequences for the 
description of delocalized electrons in carbon clusters and metals, and for 
spin-magnetized systems. Indeed, because PW91 is the "most local" [12] of the 
GGA's for exchange and correlation, as defined in Sect. 3, it is the least likely to 
overcorrect the subtle LSD errors for solids. 
While the LSD exchange-correlation hole is accurate for small interelec- 
tronic separations (Sect. 2.3), it is less satisfactory at large separations, as 
discussed in Sect. 2.5. For example, consider the hole for an electron which has 
wandered out into the classically-forbidden tail region around an atom (or 
molecule). The exact hole remains localized around the nucleus, and in Sect. 2.5 
we give explicit results for its limiting form as the electron moves far away [19]. 
The LSD hole, however, becomes more and more diffuse as the density at the 
electron's position gets smaller, and so is quite incorrect. The weighted density 
approximation (WDA) and the self-interaction correction (SIC) both yield more 
accurate (but not exact) descriptions of this phenomenon. 
PW91 and other GGA's significantly improve the exchange-correlation 
energy, but the corresponding potential vxc = ~Exc/Sn(r) is not much improved 
over LSD, and is in some respects worse [20-22]. We address this point in detail 
in Sect. 2.6. From our perspective, this is neither a surprising nor disturbing 
result. We are fitting a "square peg" (the exact Ex¢[n t, n~] with its derivative 
discontinuities [23, 24]) into a "round hole" (the simple continuum approxima- 
tion of Eq. (3)). The areas (integrated properties) of a square and circle can be 
matched, but their perimeters (differential properties) remain stubbornly differ- 
ent. (For completeness, we note that the potential vx~(r), a functional derivative, 
can also be constructed from a more physical perspective [25-29].) 
While PW91 and other GGA's are more accurate than LSD, another 
factor-of-five reduction in error is needed to reach chemical accuracy. This 
might be achieved by isolating those aspects of the exchange-correlation prob- 
lem that local and semi-local approximations treat well, and using more non- 
local approaches for the remainder. To do this, we must first understand the 
origin of nonlocal effects, i.e., corrections to LSD, in the energy (Sect. 3). Because 
LSD works best in the vicinity of the electron, the shorter the range of the hole, 
the better it is described by local and semi-local approximations [18]. Further- 
more, because of sum-rules satisfied by both the exact hole and its functional 
approximation, the deeper the on-top hole is, the shorter is its range. Thus the 
depth of the on-top hole is strongly related to how accurate LSD (and, by 
extension, PW91) energies are. 
This kind of analysis is relevant to the hybrid functionats which mix exact 
Hartree-Fock with semi-local functionals and are currently popular [30, 31]. 
The exchange on-top hole is shallower than the exchange-correlation hole, and 
so the exchange energy is less local than exchange and correlation together. 
Thus GGA's might be improved by mixing some exact Hartree-Fock exchange. 
However, we show in Sect. 3.2 that the optimum amount of mixing is far from 
universal. 

Density Functionals: Where Do They Come from, Why Do They Work? 
Another possible hybrid approach combines a density functional for anti- 
parallel-spin correlation with conventional wavefunction methods for exchange 
and parallel-spin correlation. The parallel-spin correlation has no on-top hole 
density, and so is less local than the entire correlation energy, as we show in 
Sect. 3.3. This hybrid approach thus relies on the fact that the antiparallel-spin 
correlation can be accurately described by a local or semilocal density func- 
tional, and on the hope that the parallel-spin correlation contribution can be 
easily calculated within a finite basis-set approach such as the coupled-cluster 
(CC) or configuration-interaction (CI) techniques. Finite basis-set methods are 
known to be inefficient in describing the antiparallel-spin Coulomb cusp (see, 
e.g., [32-34]), and are believed to be efficient in the description of the more 
long-ranged parallel-spin correlation hole [35]. However, we show that, within 
the range of computationally-tractable basis sets, the convergence rates of the 
parallel and antiparallel-spin contributions to the correlation energy are compa- 
rable. 
So far we have not distinguished between the self-consistent spin densities 
and the exact ones, because in most systems the difference is slight. In Sect. 4, we 
discuss 'abnormal' systems, where the self-consistent spin magnetization density, 
m(r) = nt(r ) - n~(r), is very different from the exact spin density. In such systems 
LSD (and PW91) functionals, evaluated on the exact spin densities, give very 
poor energies, but these functionals perform much better self-consistently. 
A stereotypical example is the stretched H2 molecule, which has re(r)= 0 
everywhere. The LSD self-consistent solution makes the molecule (incorrectly) 
magnetized, with an 1" electron on one nucleus, and a ~ electron on the other. 
We review a re-interpretation of the standard theory [36], which shows that in 
such systems, it is in fact the on-top pair density which is well-approximated (i.e., 
differs little from its exact value) in LSD and GGA calculations for these 
systems, rather than m(r). In the absence of an external magnetic field, the spin 
magnetization density is therefore not as robust a prediction as the energy and 
the density itself. 
We use atomic units throughout (e 2 = h = m = 1), unless otherwise stated. 
2 Exchange-Correlation Hole 
In order to understand why approximate functionals yield accurate exchange- 
correlation energies, we decompose the exchange-correlation energy as follows 
[37]. We define the pair density of the inhomogeneous system as 
P~(r,r') = N(N- 
l) 
~. 
~dar3 ...~darN 
x I ~(r, o1,r',a2 .... ,r~,oN) 12 , 
(4) 
where N is the number of electrons in the system, r~, a~ are the spatial and spin 

M. Ernzerhof et al. 
coordinates of the ith electron, and ~a is the ground-state wavefunction of the 
system in which the strength of the Coulomb repulsion is given by 4e 2, where 
0 < 4 < 1, and in which the external potential varies with 4, v,,x(r), in such a way 
as to keep the spin densities n,(r) fixed [38]. The expectation value of the 
electron-electron repulsion operator is defined here as 
P~(r, r') 
(5) 
Vee,~, = S d3r S d3r ' 2It - r'[" 
The exchange-correlation hole density at r' around an electron at r for coupling 
strength 4, nx~.z(r, r'), is then defined by the relation 
Px(r, r') = n(r)(n(r') + nx¢.a(r,r')), 
(6) 
where n(r) is the density at r. We may define an exchange-correlation energy as 
a function of coupling strength 4 as simply 1/2 the Coulomb attraction between 
the 4-dependent hole density and the density of the electron it surrounds, i.e., 
Ex~,~ = 
V~e,~ - 
U 
= 1_ t 
r a3r' 
2 J- 
J- 
tr-r'] 
" 
(7) 
Note that this definition of Ex¢,~ differs from others, e.g. Ref. [39], but is 
convenient for the present purpose. 
By defining all these quantities as explicit functions of 2, we can relate the 
density functional quantities to those more familiar from quantum chemistry. 
The exchange-correlation energy of density functional theory can be shown, via 
the HeUmann-Feynman theorem [38, 37], to be given by a coupling-constant 
average, i.e., 
1 
= S d4 Exo. . 
(8) 
O 
(Note that, in the absence of explicit 4-dependence, our notation implies the 
coupling-constant averaged quantity.) On the other hand, at full coupling 
strength, 4 = 1, we return to the fully-interacting system, so that, from Eqs. (6) 
and (7), 
Ex~,~=t = V~.~=I - U = E~ - Tc, 
(9) 
where T¢ = T - T~ is the correlation contribution to the kinetic energy. At zero 
coupling strength (2 = 0), the system is the non-interacting Kohn-Sham system, 
i.e., v,,a=o is the Kohn-Sham potential, and only exchange effects remain, 
Ex~.~=0 = Ex. 
(10) 
We do not distinguish here this density functional definition of exchange energy 
from that of Hartree-Fock (HF). This simplification is well-justified, if the HF 
electron density and the exact electron density differ only slightly [40]. Sim- 
ilarly, the coupling-constant averaged exchange-correlation hole is the usual 

Density Functionals: Where Do They Come from, Why Do They Work? 
one referred to in density functional theory, while the full coupling-strength hole 
can be extracted from the exact interacting wavefunction, via Eqs. (4) and (6), 
and the exchange hole is that of the non-interacting Kohn-Sham wavefunction 
~=o- For purposes of comparison between exact quantities calculated with 
more accurate methods and density functional quantities, we typically use the 
2 = 0 and 2 = 1 contributions, which can be extracted directly from the Har- 
tree-Fock and accurate interacting wavefunctions, respectively, whose details 
are given in Appendix A. We obtain the density functional approximations to 
such quantities by undoing the coupling-constant integration in the functional 
definitions. 
The approach that we take to the question of how local and semilocal 
density functionals work for systems with large density gradients was pioneered 
by Gunnarsson, Jonson, and Lundqvist 1-41, 42]. Define u = r' - r, the separ- 
ation of two points in the system. Then the spherically-averaged hole is 
dt2u 
n~c,a(r,u) = ~ -4~-n nx¢,z(r,r + u). 
(11) 
By studying the exchange (i.e., 2 = 0) hole in Ne, Gunnarson et al. pointed out 
that the LSD approximation to this quantity was far better than the LSD 
approximation to the exchange hole prior to spherical-averaging. Then, from 
Eq. (7), the energy depends only on this spherically-averaged hole, i.e., 
00 
E~,~ = ~ du 2nu ~ dar n(r)n,c,~(r, u). 
(12) 
0 
In the subsections below, we show how this idea has been refined by further 
study of the exchange-correlation hole since that work. 
2.1 Pointwise Decomposition of Energy 
A natural way to decompose the exchange-correlation energy is in terms of the 
exchange-correlation energy per particle. Half the electrostatic potential at r due 
to the density of the hole surrounding an electron at r is 
ex~,~.(r) = S dar' nx~,x(r, r') 
= S du2nunx~,a(r,u), 
(13) 
O 
and we take this as our definition of the exchange-correlation energy per 
particle. While other definitions are also possible, this definition is unambigu- 
ous, since nxc, x(r,r') is defined in terms of the pair density, Eq. (6). Then LSD 
may be considered as making the approximation exc.x(r) 
u,lf 
= exc,~(n~(r), n~(r)). In 
Figs. 1 and 2, we plot ex(r) = exc, x=o(r) and e¢,a=l(r) = ~c,~=l(r) - e~(r) for the 
He atom, both exactly and in LSD. We see that the LSD curves are not very 

M. Ernzerhof et al. 
-0.5 
v 
-1.0 -LSD 
He 
.... 
I ..... 
I ..... 
1 .... 
f,,, 
0 
1 
2 
3 
4 
r 
Fig. 1. Exchange energy per electron in the 
He atom, both exactly (CI) and in LSD. The 
nucleus is at r = 0 
-0.05 
E 
-0.10 
.... 
I .... 
I .... 
'exact' (CI) 
He 
1 
2 
3 
r 
Fig. 2. Correlation energy per electron at full 
coupling-strength in the He atom, both exact- 
ly (CI) and in LSD. The nucleus is at r = 0 
accurate. LSD yields the wrong value at r = 0 (where V2n/n 5/3 diverges), has an 
incorrect cusp at r = 0, and decays exponentially as r ~ ~ 
(where I Vn [/n 4/a 
diverges). The He atom is particularly difficult for LSD, because of the relative 
importance of the "rapidly-varying" regions r--* 0 and r--* ~. However, the 
radial density-weighted curve, shown for the exchange energy in Fig. 3, looks 
much better. The LSD errors at small and large r are given little weight. The 
LSD 
approximation 
to 
the density-weighted integral 
of these curves, 
Ex~,~ = SdSrn(r)exe.~(r), is only in error by 16% at 2 = 0 and by 6% at 2 = 1, as 
can be seen in Table 1. (Note that we do not plot any PW91 curves, because 
PW91 invokes an integration by parts over r, and so makes meaningful predic- 
tions only for system-averaged quantities.) We conclude that, while the spheri- 
cally-averaged hole is better in LSD than the unaveraged hole, it is vital to 

Density Functionats: Where Do They Come from, Why Do They Work? 
0 
"~ -0.5 
-1.0 
He 
I 
, 
, 
[ 
, 
i 
, 
i 
[ 
, 
, 
, 
, 
1 
2 
Fig. 3. Exchange energy per electron times the 
radial density in the He atom, both exactly 
(CI) and in LSD. The area under each curve is 
the exchange energy 
Table 1. Various energies of the He atom (in eV). The approximate energies were 
evaluated on the self-consistent densities, and their errors measured relative to the 
exact energies. All numbers taken from Table 3 of Ref. [19]. (1 hartree = 27.2116 eV.) 
Energy 
LSD 
Error 
PW91 
Error 
Exact 
(%) 
(%) 
Ex 
- 23.449 
( - 16) 
- 27.470 
( - 1) 
- 27.880 
Ec 
- 3.023 
(164) 
- 1.224 
(7) 
- 1.146 
T¢ 
1.825 
(83) 
1.010 
(1) 
0.997 
Ex~ 
- 26.472 
( -- 9) 
-- 28.693 
( -- t) 
- 29.026 
Ex~,~= 1 
- 28.297 
( - 6) 
- 29.704 
( - 1) 
- 30.023 
Ec + T~ 
- 1.198 
(705) 
- 0.213 
(43) 
--0.149 
consider density-weighted quantities to understand their effect on the corres- 
ponding total energy. 
Similar remarks may be made about the exchange-correlation potential, 
vx¢(r) = 6Ex¢/&n(r), which, for the He atom, is shown very accurately in Figs. 10 
and 11 of Ref. [21]. An important piece of v,~(r) is 2e~c(r). Again, LSD is 
inaccurate at small r and large r. In fact, PW91 is even worse, having a diver- 
gence at small 1". It has been pointed out that the PW91 correlation potential 
would look closer to the exact potential if its sign were reversed! But, as in the 
case of the energy per particle, it is unclear what the effect of a poor-looking 
potential is on the quality of the energy. We show in Sect. 2.6 how a different 
decomposition yields more insight into which properties are being well-approx- 
imated by LSD and PW91. 
2.2 Real-Space Decomposition of Energy 
The real-space decomposition of the energy is in terms of u = r'-r, 
the 
separation between points in the system [43]. We define the system- and 

M. Ernzerhof et al, 
angle-averaged hole as 
dO. t 
(nxc,~(u)) = j" -T~-~ S j" dSrn(r)nxc'~(r'r + u) 
1 
= -~ ~ dar n(r)n,¢.a(r, u), 
(14) 
where f2, represents the solid angle of u, and N is the number of electrons in the 
system. Thus, for any given system, <nx¢.~(u)> is a function of one variable, u. 
The relation between this averaged hole and the exchange-correlation energy is 
immediate, from Eq. (7), 
Ex~,~ = N ~ du 2~zu (nx~,~(u)). 
(15) 
0 
Thus any good approximation to (nxc,x(u)) will yield a good approximation to 
gx¢,.~,. 
In Figs. 4 and 5, we plot the system-averaged exchange and correlation holes 
at full coupling strength in the He atom, taken from our configuration-interac- 
tion calculation. We also plot the LSD holes, and the numerical GGA holes 
(NGGA, defined below) which underlie the construction of PW91. Accurate 
analytic expressions for the uniform-gas hole are known 1-44], and were used to 
construct the LSD hole. We immediately see that LSD is doing a good job of 
modelling the hole, and GGA does even better. 
We can easily understand why LSD does such a good job. The exact 
system-averaged hole obeys many conditions which have been derived over the 
years [14, 42, 45]. Amongst the most important for our purposes I-l] are sum 
rules on the exchange and correlation contributions: 
S du4rcu 2 (nx(U)) = - 1, 
(16) 
0 
0 
-0.1 
A 
-o2 
V ~-0.3 
-0.4 
-0.5 0 
iLs  
~ 
'exact' 
(CI\.../N 
GG A 
He 
, 
, 
, 
, 
] 
, 
, 
, 
, 
I 
, 
, 
, 
, 
1 
2 
3 
U 
Fig. 4. System-averaged exchange hole den- 
sity (in atomic units) in the He atom, in LSD, 
numerical GGA, and exactly (CI). The area 
under each curve is the exchange energy 
10 

Density Functionals: Where Do They Come from, Why Do They Work? 
0.05 
0 
v 
c~ 
V 
-o.o5 
' ' '  
' 
1 
. . . .  
I ' '  
''"-- 
NGGA 
-0.10 
. . . . . .  
I 
, 
,, 
I 
. . . . .  
0 
1 
2 
3 
U 
Fig. 5. System-averaged correlation hole den- 
sity at full coupling strength (in atomic units) 
in the He atom, in LSD, numerical GGA, and 
exactly (CI). The area under each curve is the 
full coupling-strength correlation energy 
• du47tu 2 (no(u)) = O, 
0 
the non-positivity of the exchange hole: 
(nx(u))< O, 
and the cusp condition [46, 47] at u = 0, 
O(nx¢.~(u))ou ==o = ).[(n,c,~(0)) + (n(0))], 
where 
(17) 
(18) 
(19) 
1 . dr2= f 
(n(u)> = ~ j ~ 
d3r n(r)n(r + u). 
(20) 
I/ 
Now, since LSD replaces the exact hole of the inhomogeneous system by that of 
another physical system, namely the uniform gas, the LSD hole satisfies all these 
conditions. Furthermore, the on-top exchange hole, (nx(0)), is exact in LSD 
[48-50] (for systems whose exchange wavefunction consists of a single Slater 
determinant - see Sect. 4 below), while the on-top correlation contribution is 
very accurate [511 although not exact [52]. From the cusp condition, this 
implies high accuracy for all u close to 0, while the sum rules then constrain LSD 
from doing too badly as u becomes large. These features can be seen in the plots, 
and explain why the LSD curves so closely match the exact ones. 
To understand the origin of the NGGA curves, consider the construction of 
PW91 [11, 53]. Kohn and Sham [2] already recognized that a simple improve- 
ment on LSD might be provided by treating LSD as the zeroth-order term in 
a Taylor series in the gradients of the density, and therefore including the next 
higher terms. This defines the gradient expansion approximation (GEA), which 
includes terms up to I Vn 12. Such an expansion works well to improve on the 
11 

M. Ernzerhof et al. 
local approximation to the kinetic energy [54]. However, while GEA moder- 
ately improves exchange energies, it produces very poor correlation energies. 
The reason for this failure is clear from our above analysis. In making this 
extension, we are no longer approximating (nx~(u)) by the hole of another 
physical system, so that the sum rules and non-positivit ~ constraints are viol- 
ated. Thus the hole is no longer constrained by these conditions, and a poor 
approximation results. 
The real-space cutoff procedure is designed to cure these problems in the 
gradient expansion [43]. At each point r in space, all positive portions of the 
gradient-expanded exchange hole are simply thrown away. Furthermore, be- 
yond a given value of u, the rest of the hole is set to zero, with that point chosen 
to recover the exchange sum rule, Eq. (16). A similar procedure chops off the 
spurious long-range part of the correlation hole to make it respect Eq. (17). This 
recipe defines a no-parameter procedure for constructing what we call the 
numerical generalized gradient approximation to (nx~,a(u)) [17], which in turn 
yields a numerically-defined semilocal functional which obeys the exact condi- 
tions given above. The form of the correlation hole in this procedure was chosen 
[11] to restore LSD as u ~ 0, so GGA retains the accuracy of LSD at small u. 
The PW91 functional was constructed to mimic the numerical GGA for moder- 
ate values of the gradient, while also incorporating further exact conditions for 
small and large gradients. The kink at u ~ 1.8 in the NGGA exchange hole of 
Fig. 4 and the bump at u ~ 2.3 in the NGGA correlation hole of Fig. 5 are both 
artifacts of the sharp cut-offs in this procedure [17]. The figures demonstrate 
that by using the gradient expansion, while still satisfying the exact conditions, 
the numerical GGA holes are indeed better approximations to the exact ones 
than LSD, thus demonstrating why PW91 yields better energies than LSD. 
2.3 On-Top Exchange-Correlation Hole 
As mentioned above, LSD yields a reasonable description of the exchange- 
correlation hole, because it satisfies several exact conditions. However, since the 
correlation hole satisfies a zero sum rule, the scale of the hole must be set by its 
value at some value of u. The local approximation is most accurate at points 
near the electron. In fact, while not exact at u = 0, LSD is highly accurate there. 
Thus the on-top hole provides the "missing link" between the uniform electron 
gas and real atoms and molecules [18]. 
To see this in more detail, consider the ratio of the system-averaged on-top 
exchange-correlation hole to the system-average of the density itself, (n(0)), as 
defined in Eq. (20). This ratio satisfies the inequalities 
- 1 _< (nx~.~(0)) <_ 0, 
(21) 
(n(0)) 
for all systems, both exactly and in LSD. Furthermore, for either fully spin- 
polarized systems or extremely tow density, the on-top pair density vanishes, 
12 

Density Functionals: Where Do They Come from, Why Do They Work? 
making this ratio - 1, both exactly and in LSD. LSD also becomes exact in the 
high density r~ = 0 or non-interacting 2 = 0 limits, where this ratio equals - 1/2 
for spin-unpolarized systems, and the approach to this limit is also highly 
accurate (but not exact). We can see this very clearly in the universal curve 
plotted in Fig. 6, which is this ratio as a function of the average r, value in the 
system, defined for spin-unpolarized systems as 
(rs) = Sd3rn2(r)r~(r) 
Sd3rn2(r) 
' 
where 
(22) 
3 
~1/3 
r~(r) = \4--~n(r)J 
" 
(23) 
The solid curve was obtained from Yasuhara's expression for the on-top hole for 
a uniform electron gas 155,1. The circles indicate the LSD values of 
(nxc,x(O))/(n(O)). Their proximity to the uniform-gas curve indicates that the 
approximation 
LSD 
unif 
• 
= 0) 
(24) 
(nxc.~(0)) ~ n~c,a((rs), u 
is highly accurate. The crosses represent either almost-exact numerical calcu- 
lations 1-36,1 or exact analytic results for Hooke's atom [561, which consists of 
two electrons bound to a center by a spring of force constant k. The pluses 
represent CI results, which tend to underestimate the depth of the on-top hole, 
because of the difficulty in representing the cusp in a finite basis set (see Sect. 3.4). 
The importance of the accuracy of the on-top hole in LSD cannot be 
over-stressed. This accuracy is not just in the system-average, but is also there on 
a point-wise basis. In Fig. 7, we plot the ratio of the full-coupling strength 
-0.2 
A 
t- v -0.4 
A 
. -0.6 
-0.8 
-1,0 0 
i .... 
'"1 .... 
I 
1 
system-averaged 
on-top hole 
Ne 
_ 
Be 
-- 
"~k = 0.25 
H-X" i ~ 
2 
4 
<rs > 
Fig. 6. Universal curve for the system- 
averaged on-top hole density in spin-un- 
polarized systems. The solid curve is for 
the uniform gas. The circles indicate values 
calculated within LSD, while the crosses 
indicate essentially exact results, and the 
plus signs indicate less accurate CI results. 
The high-density (r~--, 0) and low-density 
(r~ --, oo) limits behave respectively like the 
weak-coupling (2--, 0) and strong-coup- 
ling (2 --,oo) limits 
13 

M. Ernzerhof et al. 
-0.2 
s.. 
~" -0.4 
~-0.6 
C 
-0.8 
-1.0 0 
.... 
I .... 
I"''''l 
.... 
He 
local on-top hole 
_ LSD 
.... 
I ..... I ..... 
) .... 
0.5 
1.0 
1.5 
2.0 
r 
Fig. 7. Local on-top exchange-correlation 
hole at full coupling strength divided by den- 
sity as a function of r in the He atom. The 
nuclear cusp produces greater LSD error for 
r--*0 
on-top exchange-correlation hole to the density as a function of r in the He 
atom, both exactly, using a very accurate wavefunction [36], and in LSD. We 
see that already for r >_ 1 (r, > 1.33), the LSD on-top hole is extremely accurate. 
Thus, even in the tail region of the density, which is vital to understanding 
chemistry, the on-top LSD hole is highly accurate. 
Successful density functional approximations such as the PW91 GGA or the 
self-interaction correction (SIC) [57] to LSD recover [19] LSD values for the 
on-top hole density and cusp. The weighted density approximation (WDA) 
[41,42], which recovers the LSD exchange hole density but not the LSD 
correlation hole density [19] in the limit u--* 0, needs improvement in this 
respect. 
2.4 Importance of the Uniform Gas Limit 
The accuracy of the on-top hole density has a crucial bearing on the validity of 
GGA functionais. LSD and GGA are limited-form approximations to Exo, a. 
These limited forms can only be exact for uniform densities. Thus any GGA 
ought to be correct, i.e., reduce to LSD, in this limit. Otherwise, it will miss the 
vital link between the uniform gas and the real system, namely the on-top hole 
density, as shown in Figs. 6 and 7. Moreover, certain real systems (e.g., close- 
packed crystals of simple metals) closely resemble a uniform electron gas. 
However, a very popular GGA in use in quantum chemistry, the Lee-Yang-Parr 
(LYP) correlation functional [10], does not satisfy this condition. In Table 2, we 
compare the correlation energy in LYP for a uniform gas, as a function of r~, and 
compare it with the essentially exact value [3, 4, 57], using the parametrization 
of Perdew and Wang [4]. We see that LYP does badly for the uniform gas, and 
therefore does not contain the information about the on-top hole found in 
functionals which reproduce this limit, such as PW91. 
14 

Density Functionals: Where Do They Come from, Why Do They Work? 
Table 2. Correlation energy of the uniform electron 
gas, comparing the highly-accurate parametrization 
of Perdew and Wang [4] with the LYP functional 
[I0] 
r~ 
LYP 
Accurate 
Error 
(%) 
0.01 
- 0.0674 
- 0.1902 
0.05 
- 0.0656 
- 0.1413 
0.1 
- 0.0635 
- 0.1209 
0.5 
- 0.0502 
- 0.0766 
1.0 
- 0.0394 
- 0.0598 
2.0 
- 0.0270 
- 0.0448 
5.0 
- 0.0135 
- 0.0282 
10.0 
- 0.0075 
- 0.0186 
- 65 
- 
54 
- 47 
- 34 
- 34 
-40 
- 52 
-60 
For the spin-unpolarized uniform electron gas, the LYP correlation energy 
functional reduces to that of Colle and Salvetti [58], on which LYP is based. 
McWeeny's work [59] may have contributed to the widespread misimpression 
that the Colle-Salvetti functional is accurate in this limit. Note however the 
McWeeny tested Eq. (9) of Ref. [58], and not the further-approximated Eq. (19) 
of Ref. [58], which is the basis of LYP and other Colle-Salvetti applications, and 
which is shown in Table 2. 
A second observation about the LYP functional is that it predicts no 
correlation energy for a fully spin-polarized system of electrons. Yet, in the 
uniform-density limit, the correlation energy at full spin-polarization is about 
half that of the unpolarized system [3, 4, 57]. Even in the Ne atom, the 
parallel-spin contribution accounts for about 24% of the total correlation 
energy (Sect. 3.4). 
A recent and much-discussed system with delocalized electrons illustrates 
the importance of a GGA recapturing the uniform and slowly-varying density 
limits. Three basic structures have been proposed for the ground state of C2o: 
a ring, a bowl, and a cage. Recent accurate calculations using diffusion Monte 
Carlo [60] place the bowl as the lowest energy structure. These structures differ 
only very slightly in their correlation energies per carbon atom, and so provide 
a very sensitive test of approximate treatments. Hartree-Fock calculations make 
the cage the highest energy and the ring the lowest, while LSD reverses this 
ordering. Various GGA functional forms, including BLYP, were tested, but only 
PW91, which does satisfy the slowly-varying constraint, yields the correct 
energy ordering, at a level of accuracy comparable to variational Monte Carlo. 
Note that the claim by the authors of Ref. [60], that no GGA works because 
several GGA forms yielded different answers, is overdrawn. 
2.5 
Long-Range 
Asymptotics 
of the Hole 
We have recently discovered [19] a new exact formula for the asymptotic 
behavior of the wavefunction of an atom or molecule, when one coordinate 
15 

M. Ernzerhof et al. 
becomes large, namely 
lim ~z(r,a, r2,a 2 ..... rN, o-N) 
r~oo 
= 
..... 
(25) 
Here q'~+) is (typically [19]) a ground-state wavefunction of the positive ion 
(assuming the N-electron system is neutral) which remains when one electron 
has been removed, and the notation {~, a} indicates a parametric dependence on 
the coordinates of the departing electron. If the remaining ion is non-degenerate, 
e.g., for He, then ~ ÷ ~ becomes independent of i as r--* oo. However, in the 
common case when the ion is degenerate, e.g., for Ne, Ar, Kr, Xe, which have 
non-spherical ions, the ionic wavefunction appearing in Eq. (25) is oriented 
relative to the direction of the departing electron, no matter how far from the 
nucleus that electron is. 
This long-range correlation effect shows up in both the first-order density 
matrix and the exchange-correlation hole for finite systems [19]. We concen- 
trate here on the exchange-correlation hole. The general asymptotic form of the 
pair density is then 
lim P~(r, r') = n~+)(r ') {0} n(r), 
(26) 
r~oo 
where 
=(N-l) 
Z 
fd 
r2"-'fd3rN -, 
o'1 ..... 
O~¢- 1 
× I ~ ÷)(r', a', r2, a2 ..... rN- 1, aN-l) {i, a} [2, 
(27) 
i.e., it is the density of the ion with coupling strength 2, oriented along the 
direction i. (Note that in the case of a non-degenerate ion, there is no orientation 
dependence.) Eq.(26) implies that the pair correlation function, 9x(r,r')= 
Px(r,r')/n(r)n(r'), does not typically tend to unity in the limit of large separ- 
ations, contrary to intuitive expectations [1]. Only for N ~ oo, i.e., a solid, will 
n~+~(r'){t ~} ~ n(r'), the uncorrelated case. In terms of the exchange-correlation 
hole density, we find 
lim nx¢,z(r, r') = n~+~(r'){~} - n(r'), 
(28) 
r--* oo 
i.e., the hole remaining behind an electron at large distances is determined by the 
)~-dependent density of the degenerate ion, oriented relative to the departing 
electron. 
We may also decompose the exchange and correlation contributions to this 
hole. At 2 = 0, the ion density is that of the Kohn-Sham potential with N - 1 
electrons, so Eq. (28) becomes 
lim n~(r, r') = - I q~KS(r'){ r} t 2, 
(29) 
r -.-~ oo 
16 

Density Functionals: Where Do They Come from, Why Do They Work? 
where ~b~ s is the highest-occupied Kohn-Sham orbital, oriented in the general 
direction L Thus the contribution of exchange to the exchange-correlation hole 
in the asymptotic limit r ~ o0 will typically be some finite fraction which varies 
with r'. 
In the case where the degeneracy is due to symmetry, symmetry arguments 
may be used to determine n~+)(r'){F}. For example, the Ne ion has an electron 
missing in a 2p orbital. For the ion density appearing in Eq. (28), the 2p hole 
points in the direction of the distant electron [19]. To illustrate these effects, we 
plot the radial exchange-correlation hole density 4nr'2nx~,~=l(r,r ') in the Ne 
atom, for several large values of r, for r II r', and fir'. In Fig. 8, we look along the 
direction of departure of the electron. The hole for r ~ ~ has the shape of the 
radial density ofa p orbital, oriented along the plot axis. For finite values oft, we 
observe a deformation of the hole, since the remaining electron in the p orbital 
moves away from the electron at position r to the other side of the atom. This 
deformation occurs even in the exchange (i.e., 2 = 0) hole. For any finite value of 
r, there is a finite probability that the electron at r is either a Is or a 2s electron, 
instead of a 2p electron, so that the exchange hole is a hybrid between a hole in 
an s-shell and a hole in a p-shell [61]. In Fig. 9, we plot the Hartree-Fock hole 
perpendicular to the direction of departure, for several values of the electron 
position. The p-orbital hole in the ion density vanishes for all x', so, from 
Eq. (29), the exchange hole also vanishes for all x' as r ~ ~. However, correla- 
tion causes the ion density to relax as the electron leaves, and the density moves 
in toward the nucleus, becoming more compact, to partially fill the hole left 
behind. This effect is greatest when the electron is furthest, i.e., as r--, ~. In 
Fig. 10, we plot the full coupling-strength exchange-correlation hole perpen- 
dicular to the direction of departure, for the same values of the electron position. 
Comparison with Fig. 9 shows that correlation dominates the shape of this hole. 
In the limit r ~ ~, the LSD hole incorrectly spreads out over all space, while 
the SIC and WDA holes behave [19] exactly or approximately like Eq. (29). The 
0 
~ 
-2 
-3 
' 
I 
. . . .  
I 
-2 
0 
X' 
5 
Ne 
2 
Fig. 8. Full coupling-strength radial exchange- 
correlation hole density around an electron at 
x = 3, 5, ~, plotted along the direction of the 
departing electron 
17 

M. Ernzerhof et al. 
0 
-0.05 
->, 
x- 
-0,10 
-0,15 
-0.20 
2 
, 
f 
. . . .  
I 
.... 
I , 
-2 
0 
2 
y' 
Fig. 9. Hartree-Fock radial hole density 
around an electron at x = 2, 3, ~, plotted 
perpendicular to the direction of the depart- 
ing electron 
1.0 
O.5 
~ 
0 
-0.5 
No 
2_,J 
.... 
t ....... 
I, 
-2 
0 
2 
y' 
Fig. 10o Full coupling-strength radial ex- 
change-correlation hole density around an 
electron at x = 2, 3, ~, plotted perpendicular 
to the direction of the departing electron 
LSD system-averaged hole decays as the uniform-gas hole decays: both ex- 
change and correlation decay as u -a, but these long tails cancel in their sum, to 
yield an exchange-correlation hole which vanishes as u- 3. This power law decay 
is quite incorrect in a finite system, when compared with the exponential decay 
of the hole due to that of n(r). However, the cancellation of exchange and 
correlation reduces the error due to this tail, and so accounts, to some extent, for 
the cancellation of errors between the LSD exchange and correlation energies. 
The GGA behavior, on the other hand, provides an exponential decay for large 
values of u, because of the real-space cut-offs [17]. 
2.6 Relevance of the Exchange-Correlation Potential 
In this subsection, we make a simple and direct connection between point-wise 
quantities and system-averaged quantities. In Sect. 2.1, we noted several papers 
18 

Density Functionals: Where Do They Come from, Why Do They Work? 
which detail the idiosyncrasies of the approximate exchange-correlation poten- 
tials, and their considerable deviation from the exact potential. We then showed 
in Sect. 2.2 how system-averaged quantities were much better approximated by 
the density functionals. This then raises the question: can we relate the potentials 
to some more physically meaningful system-averaged quantities, to see how 
significant the LSD and PW91 errors in the potentials are? 
The answer is yes, in a very general way, as has been discussed before 
[62, 63]. Consider any parameter in the external potential, called 7. For definite- 
ness, we choose the internuclear separation in a diatomic molecule. Then the 
exchange-correlation energy depends parametrically on this quantity. Now 
imagine making an infinitesimal change in 7. The differential change in Exc is 
dExc~ _ S darvxc(r) d-~Tr), 
(30) 
i.e., this change is determined by a system-average of the exchange-correlation 
potential. Thus one may relate system-averages of the potential to differential 
changes in the energy. Note that, since the particle number does not change with 
7, there are no difficulties associated with derivative discontinuities. In the 
specific case we have chosen, the quantity dE,c/d7 has direct physical sig- 
nificance, as it goes into the equation determining the equilibrium bond length. 
Note that, within a fully self-consistent calculation, the equilibrium value of the 
bond length can be determined directly from the density and external potential 
alone, but that approximate functionals are usually tested on the exact density, 
to determine their accuracy. Thus calculations of such quantities might prove 
very useful in studying the efficacy of functionals. 
We have applied a slight variation of this general idea to the exchange- 
correlation potential of the He atom [18]. The virial theorem applied to the 
Kohn-Sham system yields [39]: 
Ex = - ~ dSrn(r)r • Vvx(r) 
(31) 
and 
Ec + Tc = - ~ d3rn(r)r • Vv¢(r). 
(32) 
Thus, just as in the case of the energy densities, the small- and large-r behaviors 
of the potential receive very little weight in the energy integrals, leading to the 
dramatic results of row 6 of Table 1. These results indicate that the potential in 
PW91 is far better than that of LSD in terms of energies (and is also the right 
way up). 
3 Understanding Nonlocality 
In this section, we examine the concept of nonlocality, in the sense of how much 
error LSD makes. We have seen in the previous section that LSD is most 
19 

M. Ernzerhof et at. 
accurate near u = 0, and least accurate at large u. Thus the deeper the hole is at 
the origin, and therefore, from the sum rule, the shorter its range in u, the better 
approximated it should be in LSD. 
3.1 Coupling-Constant Decomposition 
We tested this idea [18] by examining the holes and corresponding energies 
of three different coupling constants: 2 = 0 (exchange), ,t = 1 (full coupling 
strength), and averaged over 2 (as in the actual Exc). Since the on-top correlation 
hole is negative, the shallowest of these holes is the exchange hole, followed by 
the coupling-constant averaged hole, and the deepest is the full coupling- 
strength hole. This behavior is illustrated for the uniform electron gas in Fig. 6 of 
Ref. [18], and these qualitative features should be shared by the system-aver- 
aged holes of most inhomogeneous systems. This is borne out by the results of 
Table 2 of Ref. [18], in which the error in LSD atomic energies, measured 
relative to their PW91 counterparts, was tabulated for the energies of the three 
different holes. This error is largest for exchange and least for full coupling 
strength, and this effect becomes less significant as we approach the high-density 
limit. This is consistent with our idea that the deeper the on-top hole is, the more 
local is the corresponding energy. 
An alternative way to see this effect is to consider the enhancement factor 
over local exchange in PW91. We may write any GGA energy, for spin- 
unpolarized systems, as 
EGGA 
~.~ = ~ darn(r)sx(rs)Fxc.x(r~,s), 
(33) 
where 
s = I Vn L/2krn, 
(34) 
k~ = (37z2n) 1/3 is the Fermi wavevector, and 
Fx~,~(r~,s)=(1 +rs~r~)Fx~(,~x~,s), 
(35) 
where the differentiation with respect to r~ undoes the coupling-constant integral 
implicit in F~¢(r~,s). Eq. (35) at 2 = 1 was found in Ref. [64], and used t 
calculate Tc in Ref. [65]. Then the enhancement factors for exchange, exchange- 
correlation, 
and 
exchange-correlation 
at 
full 
coupling 
strength 
are 
F~(s) = F~,~=o(r~,s) = Fxc.~(r~ = O,s), F~c(r~,s) = ~d2Fx~.~(r~,s), and Fx~,~=l x 
(r~, s), respectively. In Figs. 11 and 12 we plot Fx,(r~, s) and Fx,.~ = l(r~, s) for PW91. 
At the LSD level, we would have F~,~(r~, s) = F~o.x(r~, s = 0), i.e., horizontal lines. 
Since the full coupling-strength curves change far less as a function of s, the full 
coupling-strength functional of Fig. 12 is more local than its coupling-constant 
averaged counterpart of Fig. 11. Furthermore, the greatest nonlocality occurs at 
r~ = 0, which is the exchange curve. These results further confirm our intuitive 
idea that the degree of nonlocality is strongly related to the spatial extent of the 
hole. 
20 

1.6 
1.4 
It. 
1.2 
1.0 
Density Functionals: Where Do They Come from, Why Do They Work? 
.... 
I .... 
I .... 
0 
1 
2 
3 
s =lVnll2kFn 
Fig. ll. Enhancement factor over local ex- 
change, Fxo(rs, s), for spin-unpolarized systems 
in the PW91 GGA 
1.6 
1.4 
kk 
1.2 
1.0 0 
.... 
t .... 
I .... 
-rs=3 
~ 
S
,
 
I .... 
I .... 
1 
2 
3 
s =lVnl/2kFn 
Fig. 12. Full coupling-strength enhancement 
factor over local exchange, Fxc.a=~(r,,s), for 
spin-unpolarized systems in the PW91 GGA 
3.2 Hybrid Functionais 
Following the "B3" proposal of Becke [30], several schemes for mixing Har- 
tree-Fock into density functional treatments have appeared in the literature 
[30, 31]. To get the correct energy for the slowly-varying electron gas, this 
hybrid functional must simplify to [18] 
Exc ~ (1 -- a)E GGA q- aEx nF q- E~ GA. 
(36) 
This "BI" form has recently been proposed independently by Becke [66], to 
reduce the number of empirical parameters in the original "B3" form. 
To determine how much HF is needed, we consider systems where s is 
significantly greater than 1, but where GGA still works reasonably well. In 
Ref. [18], we examined the ionization potentials, electron affinities, and electro- 
negativities of a variety of atoms, as well as the atomization energies of several 
21 

M. Ernzerhof et al. 
closed-shell hydrocarbon molecules. By examining root-mean-square errors in 
the energies, we found results consistent with those of Becke [30], namely that 
a ~ 0.2 slightly improved the PW91 results. However, in Table 3, we list a var- 
iety of root-mean-square energy errors A~ for some other systems, for several 
values of the mixing parameter a: a = 0 corresponds to no mixing (PW91), 
a = 0.2 corresponds to the amount of mixing recommended by Becke (BI), a = 1 
corresponds to Hartree-Fock exchange and PW91 correlation, while dmi n is the 
minimum root-mean-square error, achieved at a = ami n. The first row reports 
the electronegativity errors calculated over a subset of atoms, namely those in 
which the ground-state term of the negative ion is the same as that of the 
positive ion [13], the two ionic configurations differing by (ns) 2. Now a = 0 is 
clearly better than a = 0.2, and only marginally worse than the optimum value 
a = 0.03. These results are consistent with the suggestion that local (and 
semilocal) approximations to ionization potentials and electron affinities suffer 
from interterm and interconfigurational errors in their treatment of exchange 
[1]. These 12 term-conserving s-process electronegativities should not suffer 
from this error, and indeed need far less mixing with Hartree-Fock. However, 
this row also shows that a = 0.2 is not optimal for these processes. 
The last row of Table 3 lists the error in the atomization energy of a single 
hydrocarbon molecule, C2. This molecule is "abnormal", in the sense that no 
single determinant dominates its wavefunction [67]. It has low-lying excited 
states close to its ground-state. The HF atomization energy is seriously in error 
[13]. Hence the a = 0.2 error is far greater than the PW91 (a = 0) error. 
Although the adiabatic connection formula of Eq. (8) justifies a certain 
amount of Hartree-Fock mixing, there are situations in which a should vanish. 
In a spin-restricted description of the molecule H2 at infinite bond length 
(Sect. 4) the Hartree-Fock or 2 = 0 hole is equally distributed over both atoms, 
and is independent of the electron's position. But the hole for any finite 2, 
however small, is entirely localized on the electron's atom, so no amount of 
Hartree-Fock mixing is acceptable in this case. 
Thus we have argued that the only hybrid form which is correct for the 
slowly-varying densities is that of Eq. (36), with a value of a between 0 and 0.2. 
Note that the approximation a = 1, which reproduces exact exchange, ignores 
the cancellation of nonlocalities between the exchange and correlation energies, 
and the fourth column of Table 3 shows how poor the latter approximation is. 
Table 3. Various properties evaluated using the hybrid functional of Eq. (36). 
We report root-mean-square errors in energies Aa (in eV) as a function of the 
mixing parameter a, and the optimum value of a. The properties and data sets 
on which they are evaluated are described in the text. All results were extracted 
from Tables V and VII of Ref. [13]. (1 eV = 23~06 kcal/mole.) 
Energy 
Ao 
Ao. 2 
A1 
Amtn 
amin 
X (term-conserving) 
0,08 
0.11 
0.51 
0.07 
0,03 
Ealo~ (open-shell) 
0,19 
0.66 
4,08 
0.02 
0.04 
22 

Density Functionals: Where Do They Come from, Why Do They Work? 
As discussed in the previous sections, LSD works well, and GGA does better, 
by modelling the system-averaged hole in a way which respects the sum rules, 
amongst other things. A much better way to construct a hybrid functional 
[54, 68"1 would be to construct a hybrid hole, in which the small-separation 
contributions would be modelled in LSD (or GGA), which works well here, and 
the large-separation contributions would be modelled by some approximation 
designed to work at large distances, e.g., the random phase approximation [35"1, 
or the correct asymptotic limit [19]. 
3.3 Spin Decomposition 
Another way to separate short- and long-range effects is via the spin decomposi- 
tion. We may decompose Eq. (4) by writing 
P,l(ro',r'a') = N(N -- 1) 
Z 
Sdar3 "'Sdars 
0"3, ..., ON 
x I 7t~( r, tr, r', tr', .... rs, trN)12, 
(37) 
where tr = T or +, which in turn leads to a spin-decomposed hole: 
P,l(ra, r'tr') = no(r)(no,(r') + nx¢,a(rtr, r'C)), 
(38) 
where no(r) is the density of spin tr, and to a spin-decomposed energy: 
EO,~, 
Note that both 
P 
' 
-- no(r)no(r') 
~dar~ d3r ' a(ra'r~_r,i 
, 
S dar ~ d3r' P~(r T,r' ~) - nr(r)n~(r' ) 
tr-r'! 
(39) 
antiparallel holes (T $ and ~ T) give the same contribution to 
the energy, and are conventionally added together into one antiparallel contri- 
bution, E~c!a as defined here. 
We focus on the correlation energy only, as all the exchange energy is in the 
parallel-spin channels. Before we consider the question of locality of the different 
spin contributions, we first note that, contrary to assumptions in the literature 
[69, 701, while the antiparallel contribution is typically most of the correlation 
energy, the parallel contribution is often not negligible. For spin-unpolarized 
systems, if N = 2, all the correlation is antiparallel, while for N ~ ~ 
in the 
uniform gas, only 60% is antiparallel. As far as we know, all other spin- 
unpolarized systems fall between these two extremes. As we report below, for 
Ne, a full 24% of the correlation energy is in the parallel-spin channels. 
We now consider the locality of the antiparallel-spin contribution to the 
correlation energy, relative to the total correlation energy. The holes corres- 
ponding to both these contributions obey the zero sum rule, Eq. (17). However, 
the parallel-spin on-top correlation hole vanishes, suggesting that this hole will 
23 

M. Ernzerhof et al. 
extend further out from the electron's position, and therefore be less well- 
approximated by LSD. In Table 4 we compare the full correlation energy with 
just the antiparallel-spin contribution. We used the approximate GGA for 
antiparallel spin described in Ref. [35], which predicts that 20% of the correla- 
tion energy of Ne is from antiparallel spin. Clearly, the antiparallel contribution 
is much more local than the total. 
3.4 Hybrid Density FunctionaI-Wavefunction Methods 
The results of the previous section suggest that a good hybrid method might 
treat antiparallel spin using a GGA, while using a wavefunction treatment for 
parallel-spin [54]. Since the parallel-spin hole has no cusp and is of greater 
spatial extent, this contribution should be more accessible to a wavefunction 
method beginning from one-particle wave functions, such as CI. 
To test this idea, we performed Moller-Plesset (MP2) [71] perturbation 
calculation for the Ne atom, in which we spin-decomposed the correlation 
energy. The details of the calculation are given in Appendix B. These results are 
very close to values which may be extracted from Ref. [72], which we discovered 
after completing this work. We chose Ne because it is well known that MP2 
gives an accurate account of the correlation energy of this atom. The parallel- 
and antiparallel-spin contribution to the MP2 correlation energy (Ez) for 
a number of different gaussian basis sets are given in Table 5. As expected, the 
MP2 correlation energy is very close in almost all cases to the correlation energy 
obtained from multireference configuration-interaction (CI) calculations. We 
assume that the MP2 spin-decomposed correlation contributions are as close to 
the spin-decomposed correlation energies of the elaborated CI calculations as 
the total correlation energies are. Comparison of the parallel- and antiparal- 
lel-spin correlation contributions obtained with the 14s9p4d3flg basis set 
(which gives a CI correlation energy close to the exact value of -0.3917 
Table 4. Errors in LSD correlation en- 
ergies, relative to PW91, for several 
atoms (%). The results were calculated 
from the entries in Table lII of 
Ref. 1-35] 
Atom 
AE, 
AE~ s 
H 
236 
0 
He 
145 
58 
Li 
162 
60 
N 
114 
37 
Ne 
94 
42 
Ar 
85 
37 
Kr 
71 
32 
Xe 
64 
30 
24 

Density Functionals: Where Do They Come from, Why Do They Work? 
Table 5. Gaussian basis sets and corresponding spin-decomposed correlation energies (in hartree) 
for the Ne atom 
Basis set 
Ecl 
E 2 
E T 1 + E , L 
E r 
E7 +e~ 
E2 
4s2p 
- ~t2204 
- 0.12390 
- 0.03127 
- ~09263 
0.25 
3s2pld 
-0.14852 
-0.14892 
-0.04231 
-0.10661 
0.28 
5s3pld 
-0.22420 
-0.22795 
-0.05998 
-0.16797 
0.26 
14s9p4d3f 
- 0.34936 
- 0.34556 
- ff08297 
- 0.26258 
0.24 
14s9p4d3f19 
-~35822 
-0.35476 
-ff08365 
-0.27111 
0.24 
(hartree) 1"73]) shows that the parallel-spin contribution is a significant fraction 
(24%) of the total correlation energy. 
From the last column of the table, we see that the ratio of the parallel-spin to 
the total correlation energy is remarkably independent of the size of the basis set. 
Contrary to expectation, the parallel-spin correlation contribution appears to 
be about as difficult to account for within a finite basis-set approach as the 
antiparallel-spin correlation. Our investigation does not provide a careful study 
of the basis-set saturation behavior in MP2 calculations, such as is given in Refs. 
[74, 72, 75, 33]. However, our results show that, with small- and moderate-sized 
basis sets which are sufficiently flexible for most purposes and computationally 
tractable in calculations on larger systems, there is no evidence that the paral- 
lel-spin correlation contribution converges more rapidly than the antiparal- 
lel-spin contribution. A plausible explanation for this effect is that, for small 
interelectronic separations, the wavefunction becomes a function of the separ- 
ation, which is difficult to represent in a finite basis-set approach for either spin 
channel. The cusp condition of Eq. (19) is a noticeable manifestation of this 
dependence, but does not imply that the antiparallel-spin channel is more 
difficult to describe with a moderate-sized basis set than the parallel channel. In 
fact, in the parallel correlation hole, there is a higher-order cusp condition, 
relating the second and third derivatives with respect to u [76]. 
It is also clear from Table 5 that the absolute basis-set truncation error in Ne 
is about three times bigger for the antiparallel-spin correlation energy than for 
parallel. Thus the proposed spin-analysis hybrid of Ref. [35] may yet have some 
(limited) utility. 
4 Abnormal Systems and Extreme Nonlocality 
We define a "normal" system as one in which the hole density at the weakly- 
interacting end of the coupling-constant integration is close to that of a single 
Slater determinant. In such a system, the local and gradient-corrected holes, 
evaluated for the exact spin-densities, are nearly exact near the position of the 
25 

M. Ernzerhof et al. 
electron they surround. As a result, the exchange-correlation energy is approx- 
imately a local functional of the exact spin densities. In this section, we show that 
accurate on-top hole densities in "abnormal" systems like stretched H2 are 
found for a quite different reason: the self-consistent spin magnetization density 
goes wrong, in order to make the on-top hole density (and the associated energy) 
right [36]. 
At the equilibrium bond length of H2, the LSD or GGA equations have 
a single self-consistent ground-state solution with re(r)= 0. But, at a larger 
internuclear separation, this solution bifurcates and a second solution of 
"broken symmetry" and lower energy appears. In the limit of infinite separation, 
this second solution describes one hydrogen atom with an electron of spin up on 
the left, and another with an electron of spin down on the right. The molecular 
dissociation energies calculated for these two solutions pose a dilemma: The 
LSD or GGA energy is nearly exact for the broken-symmetry solution with 
qualitatively incorrect spin densities, and seriously in error if the correct physical 
spin symmetry (singlet [77]) is imposed on the spin densities, as shown in 
Table 1 of Ref. [36]. (This symmetry-breaking also occurs in Hartree-Fock 
theory.) 
Evidently, the LSD and GGA approximations are working, but not in the 
way the standard spin-density functional theory would lead us to expect. In 
Ref. [36], a nearly-exact alternative theory, to which LSD and GGA are also 
approximations, is constructed, which yields an alternative physical interpreta- 
tion in the absence of a strong external magnetic field. In this theory, n~(v) and 
n+(r) are not the physical spin densities, but are only intermediate objects (like 
the Kohn-Sham orbitals or Fermi surface) used to construct two physical 
predictions: the total electron density n(r) from 
fi(r) = nt(r ) + n~(r), 
(40) 
and the full-coupling strength on-top electron pair density P~= l(r,r) from its 
LSD or GGA approximation 
/~= ,(r, r) = p~si[ (nt(r) ' n~(r); u = 0), 
(41) 
where p28i[ (n¢, n+; u = 0) is the full coupling-strength on-top pair density for an 
electron gas with uniform spin densities n t and n~. 
Since (for fixed n¢ + n+) P~"=i[(n~, n~; u = 0) is an even function ofn T - n~, this 
alternative interpretation encounters no LSD or GGA spin-symmetry dilemma. 
In the separated-atom limit for H2, it correctly makes P~ = l(r, r) = 0 for r in the 
vicinity of either atom, since (by the Pauli exclusion principle) P~"=if(n~, nt; u = O) 
vanishes when either n~ or n~ vanishes. 
The two physical interpretations of LSD and GGA are about equally 
plausible in a "normal" system. But, especially in "abnormal" systems, these 
approximations may be more faithful to the alternative theory, because of the 
close relationship between P~= ,(r, r) and the electron-electron potential energy 
of Eq. (5). Thus, accurate total energies are expected to accompany accurate 
26 

Density Functionals: Where Do They Come from, Why Do They Work? 
on-top pair densities. Indeed, the new interpretation helps to explain why LSD 
and GGA yield accurate total energies, and why in practice spin-density func- 
tional calculations of the energy are more accurate than total-density ones even 
in the absence of an external magnetic field, where formally n(r) by itself suffices. 
Of course, when there is a strong external magnetic field coupled to the physical 
spin magnetization density re(r), the alternative interpretation (which makes no 
prediction for m(r)) is inappropriate. 
Acknowledgements. This work has been supported by NSF grant DMR95-21353 and by the 
Deutsche Forschungsgemeinschaft. We thank Andreas Savin for supplying us with accurate values 
of the local on-top hole density in the He atom. 
Note added in proof: Since this article was written, a method for improving the 
energy of semilocal functionals, using the ideas of Section 3.1, has appeared [83], 
and further examples of abnormal systems have been identified [84]. 
5 Appendices 
5.1 Details of Configuration Interaction (CI) Calculations 
The wave functions for the Ne and Be atoms which we used in this work are 
described in detail in Ref. [19]. 
The CI wave function for the He atom was calculated with the COLUM- 
BUS program system [78, 79], which contains a program for the generation of 
the one- and two-particle density matrix of multireference single- and double- 
excited CI wave functions [79]. The gaussian basis set used for this calculation 
was an uncontracted 9s4p3d basis, as contained in the MOLCAS basis set 
library [80]. The correlation energy obtained with this basis set was - 0.04014 
hartree. To generate the data used in Fig. 2 the gaussian basis set was further 
augmented with two f functions with exponents 1.5 and 0.6. The resulting wave 
function gives a correlation energy of - 0.04101 hartree. 
5.2 Details of MP2 Calculation of Spin-Decomposition 
The total correlation energy, as obtained from a second-order Moller-Plesset 
(MP2) [71] calculation, can easily be split into parallel- and antiparallel-spin 
contributions. The MP2 correlation energy E2 is given by [81] 
1 
(~J~I VI a/7)((~'fl VI ~i/7) - <Tj~ VI/7~)) 
e2 : 
- 
E 
.
.
.
.
.
.
.
 
, 
(B1) 
where i" and fare the indices of the spin orbitals which are occupied at the 
Hartree-Fock level, and ~ and/7 are indices of unoccupied spin orbitals. The 
27 

M. Ernzerhof et al. 
orbitals ¢p~ are obtained from a Hartree-Fock calculation and the e~ denote the 
orbital 
energies. 
The 
expectation 
values 
(7]'1V146) 
are 
given 
by 
(~;[ V I ~tb > = S d3rldar2rP~(rl)tpa(rl) <azl a~><aq~;> ¢pj(r2) opt(r2). 
The 
sum 
in 
Eq. (B1) will now be decomposed into sums over all possible spin combinations. 
With this aim in view we split offthe spin component T or ~ of the spin orbitals 
and obtain 
.~_= 
~ 
+ 
~ 
+ 
~ 
+ 
~ 
+ 
~ 
+ 
~ 
(B2) 
ij~b 
albliljT 
a.~b~ilj.~ 
at, bli~j$ 
alblilj~f 
a~bli~.j~ 
a~b~i'fj~. 
The first two terms on the right hand side of this equation involve only 
parallel-spin electrons and therefore give rise to parallel-spin correlation contri- 
butions of the form 
E~ f + E~2~ = _ ~ (ijl V[ ab>((ij[ V1 ab) - (ijI VI ba)), 
(B3) 
ijab 
~a ~- ~b -- ~i -- ~'j 
with 
(ijlVlab) =~darldar2tPi(rO%(rO,.~-,~q~j(rE)%(r2). The third and fourth 
terms describe the interaction of electrons with antiparallel spin. The contribu- 
tion from these terms is given by 
E~= 
- ~ 
[(/'([V-]ab~-[2- . 
(B4) 
i jab ~a + F'b -- ~i -- ~j 
Note that the exchange integral (i ~j T1Vl b Ta $) vanishes in this case. The last 
two terms of Eq. (B2) show a spin flip of the electrons as they are excited from 
orbital i to orbital a and from orbital j to orbital b. This contribution vanishes, 
since the Coulomb interaction between the particles does not cause a spin flip. 
The contracted 4s2p, 3s2pld, and 5s3pld basis sets in Table 4 are the 
double-zeta, double-zeta plus polarization, and triple-zeta plus polarization 
basis sets from the TURBOMOLE [82] basis-set library. The CI calculations 
with these gaussian basis-sets were of single-reference single- and double-excited 
CI type. The multireference CI calculation for the Ne atom with the uncontrac- 
ted 14s9p4d3fbasis is described in Ref. [19]. This calculation was repeated with 
an additional g function with the exponent 2.88 leading to the results for the 
14s9p4d3flg basis set reported in Table 4. 
6 References 
1. Jones RO, Gunnarsson O (1989) Rev Mod Phys 61:689 
2. Kohn W, Sham LJ (1965) Phys Rev 140: A 1133 
3. Vosko SH, Wilk L, Nusair M (1980) Can J Phys 58:1200 
4. Perdew JP, Wang Y (1992) Phys Rev B 45:13244 
5. Fulde P (1991) Electron Correlations in Molecules and Solids. Springer, Berlin Heidelberg 
New York 
28 

Density Functionals: Where Do They Come from, Why Do They Work? 
6. Langreth DC, Mehl MJ (1983) Phys Rev B 28:1809 
7. Perdew JP (1986) Phys Rev B 33: 8822; 34:7406 (E) 
8. Perdew JP, Wang Y (1986) Phys Rev B 33:8800 (1989); 40:3399 (E) 
9. Becke AD (1988) Phys Rev A 38:3098 
10. Lee C, Yang W, Parr RG (1988) Phys Rev B 37:785 
11. Perdew JP (1991) in: Electronic Structure of Solids "91, edited by P. Ziesche and H. Eschrig 
(Akademie Verlag, Berlin) 
12. Perdew JP, Burke K, in: Proceedings of the 8th International Congress of Quantum Chemistry, 
19-24 June, 1994, Prague, to appear in Int. J. Quantum Chem. 
13. Perdew JP, Chevary JA, Vosko SH, Jackson KA, Pederson MR, Singh DJ, Fiolhais C (1992) 
Phys Rev B 46:6671 (1993); 48:4978 (E) 
14. Burke K, Perdew JP, Levy M (•995) in Modern Density Functional Theory: A Tool for Chemistry, 
edited by J. M. Seminario and P. Politzer (Elsevier, Amsterdam) 
15. Hammer B, Jacobsen KW, Norskov JK (1993) Phys Rev Lett 70:3971 
16. Stixrude L, Cohen RE, Singh DJ (1994) Phys Rev B 50:6442 
17. Burke K, Perdew JP, Ernzerhof M, Accuracy of density functionals and system-averaged ex- 
change-correlation holes, in preparation for Plays Rev Lett 
18. Burke K, Perdew JP, Ernzerhof M, Why semilocal functionals work: Accuracy of the on-top hole 
density, in preparation for J Chem Phys 
19. Ernzerhof M, Burke K, Perdew JP, Long-range asymptotic behavior of ground-state wavefunc- 
tions, one-matrices, and pair densities, submitted to J Chem Phys 
20. Umrigar C J, Gonze X, in High Performance Computing and its Application to the Physical 
Sciences, Proceedings of the Mardi Gras 1993 Conference, edited by D. A. Browne et al. (World 
Scientific, Singapore, 1993) 
21. Umrigar CJ, Gonze X (1994) Phys Rev A 50:3827 
22. Filippi C, Umrigar CJ, Taut M (1994) J Chem Phys 100:1290 
23. Perdew JP, Parr RG, Levy M, Balduz JL Jr (1982) Phys Rev Lett 49:1691 
24. Perdew JP, in: Density Functional Methods in Physics, edited by R. M. Dreizler and J. da 
Providencia (Plenum, NY, 1985), p. 265 
25. Harbola MK, Sahni V (1989) Phys Rev Lett 62:489 
26. Sahni V, Harbol MK (1990) Int J Quantum Chem S 24:569 
27. Wang Y, Perdew JP, Chevary JA, MacDonald LD, Vosko SH (1990) Phys Rev A 41:78 
28. Holas A, March NH (1995) Phys Rev A 51:2040 
29. Levy M, March NH, Line-integral formulas for exchange and correlation potentials separately, 
submitted to Phys. Rev. A. 
30. Becke AD (1993) J Chem Phys 98:1372 
31. Barone V (1994) Chem Phys Lett 226:392 
32. Kutzelnigg W, Ktopper W (1991) J Chem Phys 94:1985 
33. Termath V, Klopper W, Kutzelnigg W (1991) J Chem Phys 94:2002 
34. Klopper W, Kutzelnigg W (1991) J Chem Phys 94:2020 
35. Perdew JP (1993) Int J Quantum Chem S 27:93 
36. Perdew JP, Savin A, Burke K (1995) Phys Rev A 51:4531 
37. Parr RG, Yang W (I 989) Density Functional Theory of Atoms and Molecules (Oxford, New York) 
38. Langreth DC, Perdew JP (•975) Solid State Commun 17:1425 
39. Levy M, Perdew JP (1985) Phys Rev A 32:2010 
40. Gfrling A, Ernzerhof M (1995) Phys Rev A 51:4501 
41. Gunnarsson O, Lundqvist BI (1976) Phys Rev B 13:4274 
42. Gunnarsson O, Jonson M, Lundqvist BI (1979) Phys Rev B 20:3136 
43. Burke K, Perdew JP, in: Thirty Years of Density Functional Theory, 13-16 June, 1994, Carcow, 
to appear in Int J Quantum Chem 
44. Perdew JP, Wang Y (1992) Phys Rev B 46:12947 
45. Levy M, in: Density Functional Theory, eds. R. Dreiz!er and E. K. U. Gross, NATO ASI Series 
(Plenum, New York, 1995) 
46. Kimball JC (1973) Phys Rev A 7:1648 
47. Davidson ER (1976) Reduced Density Matrices in Quantum Chemistry (Academic Press, New 
York) 
48. LSwdin PO (•955) Phys Rev 97:1490 
49. Ziegler T, Rauk A, Baerends EJ (1977) Theoret Chim Acta 43:261 
50. Harris J (1984) Phys Rev A 29:1648 
29 

M. Ernzerhof et al. 
51. Burke K, Perdew JP (1995) Mod Phys Lett B 9:829 
52. Burke K, Perdew JP, Langreth DC (1994) Phys Rev Lett 73:1283 
53. Perdew JP, Burke K, Wang Y, Real space cutoff'construction of a generalized gradient approxi- 
mation: derivation of the PW91 Junctional, submitted to Phys Rev B 
54. Perdew JP (1994) Int J Quantum Chem 49:539 
55. Yasuhara H (1972) Solid State Commun 11:1481 
56. Taut M (1993) Phys Rev A 48:3561 
57. Perdew JP, Zunger A (1981) Phys Rev B 23:5048 
58. Colle R, Salvetti O (1975) Theoret Chim Acta 37:329 
59. McWeeny R (1976) in: The New World of Quantum Chemistry: Proceedings of the Second 
International Congress of Quantum Chemistry, eds. B. Pullman and R. G. Parr (Reidel, Dor- 
drecht) 
60. Grossman JC, Mitas L, Raghavachari K (1995) Phys Rev Left 75:3870 
61. Buijse MA, Baerends EJ (1995) in: Density Functional Theory of Molecules, Clusters, and Solids, 
ed. D. E. Ellis (Kluwer Academic Publishers, Amsterdam) 
62. Vosko SH, Lagowski JB (1986) in: Density Matrices and Density Functionals, edited by R. M. 
Erdahl and V. H. Smith Jr (Reidet, Dordrecht) 
63. Handy NC, Toser DJ, Laming GJ, Murray CW, Amos RD (t994) Isr J Chem 33:331 
64. Perdew JP (1992) Phys Lett A 165:79 
65. G6rling A, Levy M, Perdew JP (1993) Phys Rev B 47:1167 
66. Becke AD (1996) J Chem Phys 104:1040 
67. Grey RS, Schaefer III HF (1992) J Chem Phys 96:6854 
68. Fuentealba P, Savin A (1994) Chem Phys Lett 217:566 
69, Stoll H, Golka E, Preul3 H (1980) Theoret Chim Acta 55:29 
70. Proynov El, Salahub DR (19941J Chem Phys 49:7874 (1994) 
71. Moller C, Plessett MS (1934) Phys Rev 46:618 
72. Eggarter E, Eggarter TP (1978) J Phys B 11:2069 
73. Davidson ER, Hagstrom SA, Chakravorty SJ (1991) Phys Rev A 44:7071 
74. Jankowski K, Malinowski P (1980) Phys Rev A 21:45 
75. Jankowski K, Malinowski P, Polasik M (1979) J Phys B: Atom Molec Phys 12:3157 
76. Rajagopal AK, Kimball JC, Banerjee M (1978) Phys Rev A 18:2339 
77. Ashcroft NW, Mermin ND (1976) Solid State Physics (Holt, Rinehart, Winston NY), problem 
2 of Chapter 2 
78. Shepard R, Shavitt I, Pitzer RM, Comeau DC, Pepper M, Lischka H, Szalay PG, Ahlrichs R, 
Brown FB, Zhoa J-G (1988) Int J Quantum Chem 142:22 
79. Shepard R, Lischka H, Szalay PG, Kovar T, Ernzerhof M (1992) J Chem Phys 96:2085 
80. MOLCAS version 2, 1991, Andersson K, Fl/ischer MP, Lindh R, Malmqvist P-~, Olsen J, Roos 
BO, Sadlej A, University of Lund, Sweden, and Widmark P-O. IBM Sweden 
81. Szabo A, Ostlund NS (1982) Modern Quantum Chemistry (MacMillan, New York) 
82. Ahlrichs R, B/ir M, H~iser M, Horn H~ K61nel C (1992) Chem Phys Lett 94:2978 
83. Burke K, Perdew JP, Levy M (1996) Phys Rev A April 1. 
84. Perdew JP, Ernzerhof M, Burke K, Savin A, On-top pair-density interpretation of spin-density 
functional theory, with applications to magnetism to appear in Int. J. Quantum Chem. 
30 

Nonlocal Energy Functionals: Gradient Expansions 
and Beyond 
D. J. W. Geldart 
Department of Physics, Dalhousie University, Halifax, Nova Scotia, Canada B3H 3J5 
Table of Contents 
1 Introduction .................................. 
2 Constructing the Energy Functional ..................... 
3 Global Symmetries, Boundary Conditions and Universality 
Subclasses ................................... 
4 Local Density Approximations and Gradient Expansions ........ 
5 Low Density Regimes ............................. 
6 Gradient Coefficients at Finite Temperature and Limiting Cases .... 
7 Summary .................................... 
8 Appendix: Energy of lnhomogeneous Electron Gas ............ 
9 References ................................... 
32 
33 
35 
40 
43 
47 
50 
51 
54 
Topics in Current Chemistry, Vol. 180 
© Springer-Verlag Berlin Heidelberg 1996 

D. J. W. Geldart 
1 Introduction 
The determination of the ground state energy and the ground state electron 
density distribution of a many-electron system in a fixed external potential is 
a problem of major importance in chemistry and physics. For a given Hamil- 
tonian and for specified boundary conditions, it is possible in principle to obtain 
directly numerical solutions of the Schr6dinger equation. Even with current 
generations of computers, this is not feasible in practice for systems of large total 
number of electrons. Of course, a variety of alternative methods, such as 
self-consistent mean field theories, also exist. However, these are approximate. 
The publication in 1964 of the seminal paper by Hohenberg and Kohn on 
the theory of the inhomogeneous electron gas marked a major advance in the 
rigorous description of many-electron systems and laid the foundation for 
extensive developments which have resulted in a wealth of new insights and 
successful applications [1]. The results of their paper are summarized in two 
theorems. The first theorem establishes a one-to-one correspondence between 
a given nondegenerate ground state density function n(r) and (to within a con- 
stant) the external potential V(r) in which the interacting electrons are situated. 
As a consequence, the ground state energy can be expressed as the functional 
EEn] = ~d°r V(r)n(r) + Y[ n] 
(1) 
where explicit reference to V(r) is not required for Fin]. The second theorem 
states that when E [hi is varied over the allowed class of ground state density 
functions, for a given V(v), the minimum value obtained is the true ground state 
energy and this minimum occurs when the density function is the true ground 
state density. The original theorems of Hohenberg and Kohn have been ex- 
tended to multicomponent systems, to electronic systems in magnetic fields, to 
superconductors, to quantum field theoretic systems, and other areas. The 
generalizations to various ensembles include thermal ensembles at finite temper- 
ature. Discussions of these important extensions, together with appropriate 
references are given elsewhere in this volume. 
The theorems of Hohenberg and Kohn are truly remarkable. The formula- 
tion of the theorems is conceptually very nontrivial, but their proofs are simple 
once the ideas have been formulated; there are no large-scale manipulations of 
equations. A rigorous logical framework is established for the treatment of 
inhomogeneous many-electron systems, with the case of a homogeneous system 
being tautological. The possibility of a logical description of inhomogeneous 
systems in terms of F[n] is established, but information about the properties of 
this functional must be obtained by other means (such as explicit studies as 
described in the following). In generalized formulations, there is even freedom 
concerning the choice of the variable functions to be used in describing the basic 
functional, although some choices will be better that others. At the same time, 
these powerful ideas have had immensely important practical consequences. The 
density functional procedures which have developed from them, coupled with 
32 

Nonlocal Energy Functionals: Gradient Expansions and Beyond 
the representation of Kohn and Sham [2] for the kinetic energy contribution to 
F In], have become the current state of the art techniques for obtaining accurate 
numerical results for the properties of atoms, molecules, clusters, and many 
condensed matter systems. 
There is no doubt that further extensions and adaptations of density func- 
tional theory to new materials and new physical properties will be made in the 
near future and that important applications will follow. The continuing develop- 
ment of energy functionals which accurately describe an ever wider variety of 
physically different situations is essential. Systems of reduced dimensionality 
(such as heterojunctions) or of restricted geometry, strongly correlated electron 
systems, the low density regions of electronic systems, phase diagrams and all of 
thermodynamic properties at finite temperature, and complex liquids are a few 
examples. The universal functional applies to all of these cases, of course, but 
what is the most effective way to gain understanding of the various aspects of its 
structure? 
I believe that progress in achieving a full density functional description of 
such a wide variety of systems will be enhanced if attention is focused at this 
point on features of energy functionals which distinguish between different 
physical situations. Sometimes the differences may be sufficiently fundamental 
as to warrant descriptions in terms of "universality subclasses". Understanding 
gained from systematic study of different, well defined types of such functionals 
will be useful for extending our understanding of the universal aspects of density 
functional theory, for developing increasingly better approximate energy func- 
tionals which span wider ranges of physical systems, and also for practical 
applications. 
In this contribution, I will first discuss some general properties and classi- 
fications of physical systems and their functionals F [n] according to their global 
symmetries and global boundary conditions. The role of gradient expansions in 
systematic exploration of the structure of energy functionals in the case of slowly 
varying density distributions is then discussed. Convergence properties of such 
expansions are considered. Technical details are given in an Appendix. Impor- 
tant differences between finite systems and the thermodynamic limit of extended 
systems are pointed out. The development of new structure in the low density 
regime is emphasized. Results of recent calculations of the leading exchange 
gradient contributions to the free energy at finite temperature are summarized. 
The status of exchange-correlation gradient contributions, and of their general- 
izations, to the ground state energy is discussed. 
2 Constructing the Energy Functional 
It is clear that the functional Fin], which plays such a prominent role in the 
theory of Hohenberg and Kohn, must be a quantity of unusual complexity. It is 
33 

D. J. W. Geldart 
useful to consider an explicit algorithm for its construction. The discussion wilt 
be pedestrian, but hopefully will also be clear. 
In order to generate information about the functional F[n] consider an 
electrically neutral system containing a strictly finite number N of electrons, 
interacting via Coulomb interactions, moving in a fixed one-body potential V(r) 
in a space of D dimensions. For this V(r), evaluate the appropriate ground state 
expectation value of the Hamiltonian and of the density operator. The corres- 
ponding value ofF[n] is determined by using Eq. (1). Now repeat this process by 
varying V(r) in ways allowed by the physically imposed symmetries and the 
global boundary conditions which were imposed. Again using Eq. (1), the 
procedure can be thought of as building up a vast catalogue of numerical results 
for F[n] for this class of allowed density functions. It is sufficient to index the 
different values of Fin] by the density function, n(r), alone because of the 
one-to-one correspondence between the one-body potential and the ground 
state density. These values of F[n] will depend on the type of interactions in the 
system (in this case, Coulombic), the dimensionality of the space, and on all of 
the parameters entering the Hamiltonian (such as the particle masses). The 
values of F[n] will also depend on the global boundary conditions which have 
been assumed for exactly the same reason that the solutions of the original 
Schr6dinger equation depend on the boundary conditions which are imposed. 
This procedure can be repeated for a variety of symmetries and global boundary 
conditions. Next, include spin and orbital magnetic interactions and external 
magnetic fields, in which case the catalogue of F[n] values now contains 
important relativistic effects. Such studies can be extended to study the thermo- 
dynamics of finite systems in thermal equilibrium at a finite temperature [3, 4]. 
This discrete "case by case" study is a reasonably well defined and concrete, 
although pedestrian, approach to obtaining information about F[n]. Careful 
study of this collection of data sets can yield substantial insight into the 
structure of the functional. There are now two issues. How "complete" is this 
information and how can this information be used? The information may be 
considered to be reasonably "complete" if a sufficiently representative set of 
density functions has been studied for each class of physical system of interest. 
Next, it is hoped that study of these representative data sets will result in 
sufficient insight and general understanding of the density function dependence 
that practical algorithms can be proposed for reliable approximations to F[n] 
for the classes of systems which have been studied. The accuracy of suggested 
approximants when extrapolated to new situations can be tested and refine- 
ments introduced as appropriate. 
The procedure which I have indicated proceeds by explicitly accumulating 
data on different types or classes of physical systems. Approximate functionals 
which have been developed for a given class of system need not automatically 
give adequate representations for different classes of systems. To describe this 
fact, it is useful to recognize explicit universality "subclasses". Consider an 
example. It is feasible to imagine that the above procedures could result in the 
construction of functionals of the density which give highly accurate descrip- 
34 

Nonlocal Energy Functionals: Gradient Expansions and Beyond 
tions of both simple Fermi-liquid-like systems and heavy fermion materials. It is 
also reasonable to expect that the description of the high temperature oxide 
superconductors, including the rich variety of their phase transitions, could also 
be incorporated, with some extensions of the functionals. These systems would 
thus belong to the same universality subclass and be explicitly described by the 
same functional. Other physical systems, of the same universality subclass, could 
be included as the theory is further extended and unified. On the other hand, 
physical systems which differ in more "global" ways, by virtue of symmetries, 
boundary conditions, geometrical constraints or topologies, or by certain types 
of limiting procedures, may require their own subclasses of the universal func- 
tional. Of course, the universal functional is defined by the totality of all of its 
subclasses. 
3 Global Symmetries, Boundary Conditions and 
Universality Subclasses 
It is natural in this constructive approach to focus attention on global symmet- 
ries and boundary conditions in the development of functionals for specific types 
of systems. One of the most important global effects concerns the effect of 
different boundary conditions on the density in strictly bounded geometries 
versus fully extended geometries. These considerations were implicit in all of the 
above discussion because the ground state energy on the left hand side of Eq. (1) 
requires that the boundary conditions on the ground state wave function be 
specified. This sharply distinguishes between finite, or bounded, systems and 
extended systems. Atoms and molecules are two examples of small systems with 
bounded geometries. Of course, there are also large systems having bounded 
geometry. The essentially bulk properties of a large system in thermodynamic 
limit can be described by the boundary conditions of an appropriate extended 
systems. Of course, it is only the interior of a macroscopic specimen, far away 
from all surfaces, that can be modeled as being a part or subvolume of an 
extended system. The density of electrons in such a case is more nearly "uni- 
form" in that it never is essentially zero over a large portion of the space. Of 
course, the electronic density in the interior of any real metal or semiconductor, 
for example, is not uniform on truly microscopic distance scales. In fact, the 
range of variation may be very large, but the point is that the density does not 
vanish in the way characteristic of an isolated bounded system. This difference 
has very fundamental consequences. 
The particle density in an isolated bounded system is required to be zero at 
the boundary point at infinity. This introduces gaps (or discreteness) in the 
excitation spectrum, at low energy, which are not present in extended systems. 
The presence of shell structure, and whether the shells are open or closed, is 
35 

D. J. W. Geldart 
a related global effect which is also particularly evident in small systems. In the 
case of strictly extended systems, periodic boundary conditions on the density 
are more suitable and the thermodynamic limit of large particle number, N, and 
large volume, f2, is to be taken with finite average density, N/f2. Of course, 
extended systems can also have subtle global effects. The interesting structure of 
functionals which can describe the band gap discontinuities in semiconductors, 
as a consequence of gaps in the single particle spectrum, is one example. Other 
examples could be given in which the structure of the low energy excitation 
spectrum is seen to play a major physical role. For the purpose of constructing 
approximate functionals for practical computations, it can be convenient to 
recognize these different types of physical systems as subclasses of the universal 
functional FEn ] . 
There is an important case which is intermediate between small bounded 
systems and macroscopic fully extended systems, namely the description of the 
surface region of a macroscopic metal. The correlation functions which describe 
density fluctuations in the surface region are extremely anisotropic and of long 
range, very unlike their counterparts in the bulk, and the thermodynamic limit 
must be taken with sufficient care. Consider the static structure factor for a large 
system of N particles contained within a volume O, 
N S (q, q) = 5 d D r 5 d D r' exp [iq" (r - r')] S (r, r'). 
(2) 
12 
t2 
Both N and f2 are macroscopically large but strictly finite. (When the thermo- 
dynamic limit is taken later, their ratio is to be held fixed and finite.) There is no 
doubt that S(q, q) is exactly zero at q = 0 (due to particle number conservation) 
and that its limit as q -~ 0 is also zero (since the volume and associated length 
scales, L, are strictly finite). However, the structure of Eq. (2) implies that the 
characteristic wavenumbers at which S(q, q) becomes dominated by the particle 
conservation sum rule are of order 1/L, at large L. This wave number region 
disappears in the large N and f2 limit with the consequence that S(q, q) will tend, 
after the thermodynamic limit, to a nonuniversal (generally nonzero), geometry 
dependent limiting value. 
The corresponding situation at finite temperature is also instructive. Sup- 
pose that density correlation functions have been calculated in a grand canoni- 
cal ensemble, with particle number conserved on the average. It is fully expected 
that the static structure factor thus calculated will be in agreement with an 
experimental determination by neutron scattering, for example, in the accessible 
wave number range for a macroscopic sample. However, the q -~ 0 limit of this 
grand canonical S(q, q) is fixed by the thermodynamic sum rule relating the 
mean square number fluctuations to the compressibility. The quantities in this 
sum rule, and therefore the limiting value in question, are material dependent, 
temperature dependent, generally nonzero, and certainly not universal. The 
point is again that taking the thermodynamic limit has removed from S(q, q) the 
structure which was important for ensuring the particle conservation sum rule 
for finite systems. Note that this nonuniversality of the small q limit of the grand 
36 

Nonlocal Energy Functionals: Gradient Expansions and Beyond 
canonical static structure factor occurs even for a bulk system of uniform 
density, for which "perfect screening" considerations hold [5]. The differences 
between the grand canonical structure factor and its counterpart calculated with 
particle number strictly observed, which occur only at wavelengths of order the 
linear dimensions of the system, disappear when the thermodynamic limit is 
taken at fixed finite q. 
It is therefore clear that particle number conservation considerations are not 
sufficient to determine S(q, q) at very small but finite q. In the case of broken 
translational symmetry, as certainly occurs in the vicinity of a surface, the 
perfect screening of density fluctuation matrix elements, which is characteristic 
of homogeneous systems, does not hold due to nonconservation of momentum, 
and the small q limit of S(q, q) is nonuniversal even in the zero temperature case. 
Consequently, discontinuities in certain correlation functions are not un- 
common in the thermodynamic limit. Other examples are known. For example, 
Kirzhnits made a similar point concerning the static dielectric function [6]. The 
mathematical reason why such discontinuities are not prohibited is that the 
commutation rule, [N, H] = 0, becomes meaningless in the thermodynamic 
limit. The reader is referred to the literature for additional discussion [7, 8]. 
This discussion has emphasized the fundamental differences between finite 
(whether small or large) and fully extended systems. An energy functional which 
describes, for example, 1 cm 3 of silicon or lead, contains a great deal of informa- 
tion about its surface properties as well as its bulk properties. However, all such 
surface information disappears from the functional when the thermodynamic 
limit is taken. I must emphasize that this process is irreversible! Information on 
physical quantities which are sensitive to the delicate correlations in the bound- 
ary regions cannot be found in energy functionals of the corresponding extended 
system. This is another example of the importance of the global boundary 
conditions and the related universality subclasses. 
It is important to note that it is feasible, in principle, to postpone the strict 
thermodynamic limit and to consider energy functionals of very large but finite 
systems which have surface effects explicitly included. The same possibility 
applies to correlation functions, which exhibit long-range correlations in the 
vicinity of surfaces. It would be very desirable for applications to have repres- 
entations which explicitly exhibit the "crossover" behaviour between large but 
finite and extended bulk systems. Analogous crossover behaviour is well known 
in large but finite systems which undergo second order phase transitions and 
exhibit long correlation lengths due to proximity to a critical point. In these 
cases, the corresponding "finite size scaling" representations, which also exhibit 
discontinuities in the infinite volume limit, have been found to be very powerful 
and are often indispensable in practice in the analysis of data. I emphasize again 
that information characterizing surface and finite size effects is irrevocably lost if 
the 1/L -.-, 0 limit is taken. It is impossible to describe finite size features of the 
long wave-length structure factor in terms of elementary bulk (1/L = 0) proper- 
ties just as it is impossible to describe correctly the finite temperature properties 
of a system in terms of ground state (T = 0) functionals. 
37 

D. J. W. Geldart 
Applications of density functional theory to practical computations of prop- 
erties of physical systems at finite temperature will be increasingly important in 
the future. It is useful to consider how global symmetries and boundary condi- 
tions suggest universality subclasses in this situation. Suppose that in the finite 
temperature extension of density functional theory, a functional has become 
available which adequately describes the thermodynamic properties of materials 
of the 3d transition series and the 4flanthanide series, many of which undergo 
magnetic phase transitions. This functional, denoted by F [n, m; T], will depend 
on the electron density n(r), the density of magnetization re(r), and the temper- 
ature [4]. Now how does this functional lead to a prediction of the thermodyn- 
amic properties near a critical point? The order of the transition, critical 
exponents, and critical amplitude ratios must be correctly given, in principle. It 
is reasonable to expect that short distance details and "noncritical" degrees of 
freedom will be suppressed as T approaches T~ and that the predictions will be in 
agreement with those of a coarse grained Ginsburg-Landau-Wilson effective 
Hamiltonian or free energy [9]. 
It is well known that these effective Hamiltonians fall into Wilson's "univer- 
sality" classes which are defined by the number of degrees of freedom of the 
order parameter, the symmetries of the effective Hamiltonian, the dimensional- 
ity D of the space (which is related to a global boundary condition in the case of 
quasi- one-and-two-dimensional systems), with certain other features sometimes 
becoming relevant. All effective Hamiltonians within a given Wilson universality 
class have precisely the same critical characteristics, including critical exponents 
and critical amplitude ratios, near the critical point. Evidently, F[n, m; T] 
contains equivalent information, in addition to other features which are domi- 
nant in other domains of temperature or pressure. Free energy functionals, 
F [n, m; T-], defined within density functional theory could then be categorized 
according to their properties near magnetic critical points, if desired. Of course, 
this is generally distinct from the classification into universality subclasses 
according to a global boundary condition, for example. 
I now want to address the question of whether a description in terms of 
universality subclasses is useful. For orientation, consider the corresponding 
question in the case of the Wilson effective Hamiltonians near a critical point. 
Are the Wilson universality classes absolutely necessary? The answer is "no" in 
the sense that it could be argued that everything was already contained in the 
partition function defined in terms of the microscopic model Hamiltonian 
anyway and an explicit calculation based on a universally defined quantity 
would provide all of the results. Of course, this is obviously perverse and the 
time scale for making progress in this "straightforward" way is very long. The 
answer is unequivocally "yes" in several other senses. The overall level of 
understanding of critical phefaomena advanced greatly by knowing which gen- 
eral features of a coarse-grained Hamiltonian are crucial and which are irrel- 
evant. Also, on facing a new problem, it might happen that a general considera- 
tion of its order parameter and the symmetries of the associated effective 
Hamiltonian would lead to its identification in terms of a known Wilson 
38 

Nonlocal Energy Functionals: Gradient Expansions and Beyond 
universality class. In this case, the critical properties of thermodynamic quantit- 
ies in the new problem immediately become known since all members of a given 
class, irrespective of any differences in their microscopic origins, have the same 
critical behaviour. Further calculation is not needed. There is no need to turn to 
the (possibly insurmountable) task of evaluating the microscopically based 
partition function for the new problem. This is certainly useful! 
Now return to finite temperature applications of density functional theory. 
There is the usual exact statistical mechanics algorithm for generating partition 
functions and the corresponding free energies in terms of thermodynamic 
variables. Of course, this is exactly the same fundamental algorithm which 
applies in critical phenomena. Now this "first principles" approach is sidestep- 
ped in critical phenomena by the functional integral representation for a coarse 
grained average effective partition function which emphasizes the long 
wavelength degrees of freedom and the symmetries of the order parameter. 
Explicit calculations in this representation are made possible by the renormaliz- 
ation group methods developed by Wilson I-9]. Of course, these results are 
restricted in their validity to an appropriate vicinity of critical points. An 
essential goal of density functional theory is the development of suitable free 
energy functionals of the relevant particle densities such that practical, quantit- 
atively reliable calculations of thermodynamic properties can similarly be per- 
formed without the need for returning to the microscopic partition function for 
each new application. In other words, the "first principles" approach is to be 
sidestepped by the concept of the universal free energy in a very general and 
rigorous way. It will be necessary to describe in density functional terms the 
fundamental differences which exist between physical systems, as well as the 
similar aspects which they share, in order to achieve the goal of a unified 
accurate approach to new classes of systems. Explicit recognition of universality 
subclasses can be useful for clarifying procedures in some aspects of this 
endeavour. 
How are suitable approximations to the universal free energy functional to 
be obtained? It is necessary to make use of the fundamental partition function of 
statistical mechanics, of course. With this finite temperature algorithm, generate 
numerical data sets for free energies at temperature T for classes of physical 
systems. Following the same principles as for the ground state energy problem, 
extensive study of such collections of these data sets must provide the basis for 
constructing representations which express these free energies as functionals of 
the particle density (or densities in muiticomponent cases). The proposed func- 
tionals are to be used in computations in fairly general circumstances, not just at 
critical points, and are to be subjected to extensive testing and updating, as new 
situations are described, just as was the case for the ground state problems. 
It is evident that the task of producing high quality free energy functionals is 
challenging. All available guidance should be considered. In particular, there is 
no doubt that general considerations, such as global symmetries, will play a role 
and that different types of systems can be classified according to universality 
subclasses. Of course, their structure will be much richer than was the case for 
39 

D. J. W. Geldart 
ground state problems. In spite of this complexity, the prospects for progress are 
very good. A great deal is known about finite temperature many-body systems, 
ranging from low temperature expansions in dense systems to viriat expansions 
for low density systems and to critical phenomena and systems which exhibit 
broken symmetries. This knowledge must be translated into density functional 
language. 
The above discussion focused on fundamental differences which may exist 
between different physical systems of interest. There can also be important 
differences between different density regimes of a single physical system, pro- 
vided the overall inhomogeneity in density is sufficiently strong. 
4 Local Density Approximations and Gradient Expansions 
In ground state applications of density functional theory, it is convenient to 
extract the Hartree energy from Fin]. The representation proposed by Kohn 
and Sham for the remainder has become the standard approach for most 
practical computations [2]. Their introduction of a noninteracting reference 
system described by orbitals explicitly recognizes the crucial nonlocality of the 
kinetic energy and also serves the important role of controlling the class of 
density functions which an approximate energy functional is allowed to sample. 
Having introduced this functional representation for the kinetic energy, the only 
remaining contribution to Fin] is, by definition, the exchange-correlation 
contribution, Exc In], to the ground state energy. Similar procedures apply to the 
free energy at finite temperature. It is the exchange-correlation contribution 
which contains the difficulties. The simplest approximation to Exc is the local 
density approximation in which the exchange-correlation energy is approxim- 
ated by its value in a locally uniform density system, with small corrections due 
to density gradients 
Exc In] = ~ d 3 rn(r) e~c (n (r)) + 0 ((Vn (r))2). 
(3) 
If the nonlocal gradient corrections are neglected altogether, the local density 
approximation for Ex~[n] results. In many applications of density functional 
theory, it has been found to be important to extend the definition of the energy 
functionals to include spin polarization. The dependence of the exchange-cor- 
relation energy on spin T and spin $ electrons separately can be determined. 
The local spin density approximation to the exchange correlation energy is then 
defined by 
Ex clocal [/1 T , rl ,~ ] = ~ d 3 r n (r) e~c (n r (r), n ~ (r)) 
(4) 
where n(r) = n r (r) + n ~ (r). 
Many density functional applications to atoms, molecules, clusters, and solid 
state systems have been made, based on the spin-polarized Kohn-Sham scheme 
40 

Nonlocal Energy Functionals: Gradient Expansions and Beyond 
with Eq. (4) used for the exchange-correlation energy. The overall accuracy has 
been typically a few percent in many of these applications. Of course, whether or 
not this level of accuracy is sufficient depends on the objectives of the problem 
under consideration. There are cases where major contributions to the relevant 
energy, or energy differences, come from regions of space which are not well 
treated by local approximations. In such cases, errors will be more serious. Some 
examples are the total ionization energies of atoms, in particular the ionization 
energies of the innermost tightly bound electrons, sp and sd atomic transfer 
energies, the relative stability of electronic configurations and molecular bond 
energies. In general, substantial errors are expected if the quantities of interest 
are particularly sensitive to the electron densities either very near to or very far 
from nuclei. 
Various reasons have been advanced for the relative accuracy of spin- 
polarized Kohn-Sham calculations based on local (spin) density approximations 
for Ext. However, two very favourable aspects of this procedure are clearly 
operative. First, the Kohn-Sham orbitals control the physical class of density 
functions which are allowed (in contrast, for example, to simpler Thomas-Fermi 
theories). Second, local density approximations for E~c[n], are mild-mannered, 
unbiased, and everywhere finite and do not interfere with that controlling role. 
This applies near nuclei, in the low density regimes of atoms and molecules, and 
even far from a metallic surface. 
There have been intense efforts to include corrections to Eq. (4) and thereby 
to increase the level of accuracy by addressing the inevitable nonlocal structure 
of Exc In]. Of course, accounting for nonlocality, particularly in sensitive regions 
of the electron density distribution, is very difficult due to the rather limited 
a priori knowledge of exchange and correlation in general inhomogeneous 
many-electron systems. In this contribution, insight will be generated by first 
studying limiting cases for which rigorous results can be obtained. 
A systematic approach to learning something about Exc[n] in cases where 
the particle density is slowly varying in space was already indicated by Hohen- 
berg and Kohn [1]. The local density approximation is taken as a starting point 
and corrections to it are generated by perturbation expansions taken to arbit- 
rarily high order. The domain of validity of this approach is limited, of course, 
but the information gained is precise within that domain. From symmetry 
arguments, these nonlocal corrections are taken to be represented as an infinite 
series of terms involving integrals over gradients of the density 
E~ In] = S dD r {B~c(n(r))(V n (r)) 2 + Cxc(n(r))(V 2 n(r)) 2 
+ Dxc(n(r))(V 2 n(r))(Vn(r)) 2 + Ex~(n(r))((Vn(r))2) 2 
+ 0(V 6) + (nonanalytic terms)}. 
(5) 
The nonanalytic terms indicated in Eq. (5) are consequences of the singular 
logarithmic factors which contribute terms such as k 2 ln(k2), k 4 ln(k z) and so on 
to the long wavelength expansions of correlation functions describing interac- 
ting many-fermion systems in their ground states [7, 8]. These terms are not 
41 

D. J. W. Geldart 
artifacts of long range Coulomb interactions, but appear even for short range 
interaction systems. The singular character of these contributions can be cir- 
cumvented by taking account of finite temperature [10, 11] but there are 
nevertheless implications for effective ion-ion interactions and spin-spin interac- 
tions [7, 8]. Derivations of the leading gradient coefficient, Bx~, were given by 
Ma and Brueckner [12] for the correlation component at high density and by 
Sham [13] for the first order exchange contribution. An exact self-consistent 
Hartree-Fock calculation of the exchange component [14, 15, 16] and an ap- 
proximate calculation of the correlation component of Bxc in the range of 
metallic densities [17, 18] were then given. This was followed by a variety of 
extensions and applications to multicomponent spin-polarized systems [9] and 
to electron-hole liquids [20] and droplets [21]. The full derivation of the values 
of the coefficients, Bxc and so on, is somewhat technical. Extensive reviews with 
full references to the derivations and to applications of the results are available 
in the literature [7, 8]. An outline of the derivation is given in the Appendix. 
I want to focus here primarily on the meaning of the procedures and on the 
convergence properties of the results. 
The most convenient and general way to derive Eq. (5) involves subjecting an 
otherwise uniform system to a very weak and slowly varying static external 
potential V(r). The shift in the energy and the density are calculated to all orders 
in V(r). A Lagrange inversion then gives V(r) as a power series in the density shift 
and the result can be used to express the energy shift as an infinite series in 
powers of the density shift. The coefficients of this functional Taylor series 
involve not only the linear but also all of the higher order nonlinear density 
response functions of the uniform system at its density no. These response 
functions are then expanded in powers of wavenumbers at long wavelength. The 
resulting series in powers of both wavenumbers and density shifts must then be 
rearranged and partially resummed to obtain two essential results. (1) The 
coefficients of the series expansion are now all evaluated at the local density n(r). 
(2) The functional expansion parameters are now the entire set of all of the 
derivatives of the local density. The leading term of this expansion is the local 
density approximation and the rest of the series of gradient corrections is Eq. (5). 
This rearrangement and partial resummation of the perturbation expansion 
is an extremely important step in the derivation of the gradient expansion series. 
Every term in Eq. (5) has contributions to all orders in powers of the external 
potential V(r). As a consequence, the final result no longer has any reference to 
no of the initial uniform system and so is of general validity within the universal- 
ity subclass of slowly varying density systems, even though the overall variation 
of the density may be large throughout the system. The corresponding calcu- 
lations at finite temperature for the gradient expansion for the contributions to 
the noniocal free energy follow a similar path, although the technical details are 
more involved. 
Now consider the convergence properties which might be expected for this 
method. There are four major points. (1) Each coefficient in Eq. (5) is based on 
a partial resummation of a perturbation expansion containing nonlinear re- 
42 

Nonlocal Energy Functionals: Gradient Expansions and Beyond 
sponse functions to infinite order. No general conclusions about the conver- 
gence of the overall process can be drawn by study of only the lowest order 
linear response function. Instead, considerations of convergence must be based 
on the global functional structure of such expansions and are strongly depen- 
dent on the density profile. (2) The exact ground state linear and nonlinear 
response functions, for both particle number density and spin density, exhibit 
nonanalytic wavenumber dependence at long wavelength, as indicated in Eq. (5). 
This nonanalytic behaviour occurs even for very smooth applied potentials V(r) 
and is due to the sharp Fermi surface. The convergence problem associated with 
this type of nonanalyticity is overcome by always working at finite temperature 
since thermal smearing removes the sharpness of the Fermi surface. At this 
point, the existence of all of the gradient coefficient functions in Eq. (5) can be 
taken as established. (3) The next step is to insert the density profile for the 
problem at hand into Eq. (5) and to carry out the integration over the space. For 
dimensional reasons, the terms with high powers of gradients must have high 
powers of n (r) occurring in the denominators of the respective integrands. These 
terms give large contributions to the series. Note that this implies at once that 
the gradient series can have problems in low density situations, even if care has 
been taken with finite temperature and boundary conditions to ensure that the 
density does not actually vanish [22]. At this point, the existence of each of the 
integrals in Eq. (5) is assured. (4) Next, even if all expansion coefficients and all 
integrals exist, the actual sum of the series of gradient correction terms may be 
divergent. This corresponds to a global divergence of the gradient expansion. 
Provided the density profile is contained in the domain of slowly varying density 
variations, it is not unreasonable, based on experience with other perturbation 
expansions in many-body problems, to conjecture that the series may be 
asymptotic and that it might be usefully resummed (if actually required) by 
a suitable resummation procedure. 
It is important to observe, however, that even if the series turns out to be 
only asymptotic, the use of an appropriate finite number of the low order terms 
of the series can still give accurate results, provided the density variation is slow 
enough. Important insight into the nonlocal energy and free energy and the 
correlation functions can be obtained in a controlled and precise way for this 
subclass of system. 
5 Low Density Regimes 
There are many problems of interest where the particle density becomes very 
small and may even vanish. Can the information obtained from the gradient 
expansions be of any use in such cases? First, note that an estimate of the 
nonlocal contributions to the energy can be given by Eq. (5), provided the series 
is truncated at an optimal point (certainly prior to the occurrence of any 
43 

D. J. W. Geldart 
extremely large contributions due to integrals over low density regions). This 
approach has been applied to a variety of situations, with results that are better 
than perhaps should be expected in view of its extreme simplicity. The import- 
ance of an optimal truncation of the gradient series is particularly striking in 
cases where applications are made to bounded systems where the particle 
density actually vanishes. Certainly, as was previously discussed, gradient ex- 
pansions in the form of Eq. (5) do not treat correctly the low density regions of 
bounded systems. 
If the elementary form of the gradient expansion for E~,c[n] is of limited use 
for bounded systems, is there any possibility that the conjectured resummation 
of the asymptotic series could still be applicable? Information on this point is 
sparse but, as will be seen, the answer appears to be no. The utility of such 
a resummed asymptotic functional series, or of a convergent gradient series 
should that turn out to be the case, is limited to the universality subclass of 
sufficiently slowly varying density profiles. The conditions which are required to 
establish this functional series, and its convergence, cannot be satisfied in the 
case of an isolated bounded system. The character of the low density electron 
system, with high density gradients, is so different from the character of the low 
density gradient system, at high density, that it is to be expected that the 
gradient series, whether resummed or otherwise, will either diverge in an 
uncontrollable way or else "converge" to a result which has no relation to the 
physical problem at hand. In other words, the divergence of the gradient series, 
in this application, is physically real and unavoidable. Resummation and related 
devices can atone for bad mathematical behaviour engendered by awkward 
perturbation expansions carried out within a specific class of system, but they 
cannot bridge the gap between two universality subclasses which differ by global 
boundary conditions. 
The treatment of the low density regions of electronic systems has tradition- 
ally posed problems for density functional theory and information is sparse. In 
order to appreciate more fully the fundamental character of the low density 
regime, it is instructive to reconsider the perturbation expansions which led to 
gradient expansions but to avoid the long wavelength approximations for the 
various density response functions. The exchange-correlation contribution to 
the ground state energy shift in the presence of an applied static external 
potential, V(r), is given by standard second order perturbation theory in terms 
of the induced density shift, fin(k), by Eq. (A.7) of the Appendix 
AEx,.[n] - 
2f2~ I fin(k)12 v.,~c(k) 
(6) 
where the linear response function, n(k), of the interacting many-electron system 
of uniform density, no, has been expressed in terms of the residual, short range, 
attractive exchange-correlation interaction, vxc(k), thereby removing reference 
to the Lindhard function, no(k), for the noninteracting electrons of the Kohn- 
Sham procedure. The previous approximation of replacing vxc(k) by its small 
44 

Nonlocal Energy Functionals: Gradient Expansions and Beyond 
k expansion, which leads ultimately to gradient expansions, is appropriate only 
if the dominant contributions to Eq. (6) come from long wavelength Fourier 
components. This requires that n(r) be slowly varying in space, which would be 
consistent. On the other hand, this approximation is certainly very poor when 
the density has rapid spatial variation. 
What can be done to extract the rigorous information to order (9(V 2) which 
is contained in Eq. (6) in cases where the weak external potential and the density 
profile have rapid variations in some regions of the physical system? Insight is 
obtained by considering the case of very low uniform density, no. The contribu- 
tions to Eq. (6) which are due to very rapid variation of the density come from 
large k Fourier components for which the wavenumbers are much larger than 
the fixed wavenumber scales of the problem, including the Fermi wavenumber, 
kr, and the Thomas-Fermi screening length, kTF. It is important to appreciate 
that, for essentially dimensional reasons, the limit of vxc(k) at large k and fixed 
finite density can also be achieved by the limit of low density at fixed finite k. 
Analysis of the perturbation expansions for the density response functions of the 
uniform density electron system confirms this expectation and shows that vxc(k) 
takes on a particularly revealing form. For D = 3 systems in the limit of large 
wavenumber, vxc(k)~ - (4n e2/k2)•xc where 7xc is a numerical constant (?.c = 
1/2 in a self-consistent Hartree- Fock approximation) [23]. Note that there is no 
longer any reference to density scales! More detailed information for this large 
k and low density regime is generated by again considering a systematic 
expansion in powers of V(r). The structure, for general D, of the rearranged 
series for the sum of the Hartree and the exchange-correlation energies in the 
low density regime is of the form [8, 24] 
1 dOrSdOr, n(r)v( r 
r')[1 
7xc(r,r )]n(r') 
En [n] + Exc [n] = ~ S 
- 
- 
' 
(7) 
This result has several important features which will be briefly discussed. An 
extremely large cancellation between the direct Coulomb (Hartree) energy and 
the exchange-correlation energy occurs in the low density regions of an elec- 
tronic system. The same degree of cancellation occurs for the functional deriva- 
tive of Eq. (7), which can also be constructed, so that the potentials which enter 
the Kohn-Sham equations have the correct behaviour in tow density regimes. In 
particular, the regions of atoms and molecules which are far from nuclei are 
correctly represented. (The cancellation is complete in the case of the hydrogen 
atom, of course.) The physics of this cancellation is very important for a number 
of atomic and molecular problems, including self-interaction corrections, the 
ionization energies of few electron atoms, and molecular bond strengths. Con- 
versely, insight into the character of energy functionals in low density regimes 
can be obtained by systematic study of properties of small molecules and 
clusters. 
These considerations concerning low density regions apply not only to 
bounded systems but also to low density extended electron systems. A classic 
45 

D. J. W. Geldart 
example is given by the charge modulated states of the Wigner crystal in which 
the electron density may be very small but is nevertheless nonzero [8]. A precise 
treatment of low density regimes may also be relevant to an understanding of 
strongly inhomogeneous anisotropic extended many-electron systems which 
exhibit subtle charge and spin correlations due to regions of low carrier density. 
The cuprates and bismuthates of current interest are examples of this category. 
I have emphasized that insight into energy functionals can be obtained by 
systematic procedures based on perturbative expansions, in powers of an ex- 
ternal potential, for which various rearrangements and partial resummations 
are possible, leading to useful results. In the high density regions of a system, 
short range nontocality can be included by gradient expansions. The nonlocal 
correlations in low density regions are of a very different, longer range, charac- 
ter. Both types of region will often occur in a single system of physical interest, of 
course, and the contributions of both types of region are included in the 
perturbation expansions. The simplest example of this is given by Eq. (6), in 
which the long wavelength contributions (leading to gradient expansions) are 
essentially disjoint from the large wavenumber contributions (leading to the low 
density nonlocal structures). Similar separations occur in higher order contribu- 
tions. It is clearly not to be expected that any resummation of the long 
wavelength expansions could reproduce the structure of the short wavelength, 
low density regime. As previously concluded, the gradient expansion, however 
rearranged, must diverge when applied to a bounded system. Extended systems 
in the thermodynamic limit are in a different universality subclass and rear- 
ranged gradient expansions can be justified. However, a representation based on 
Eq. (7) will be more appropriate for the regions in which the density gradients 
are large. A functional which explicitly combines both the high and low density 
regimes, as well as the crossover between them, is required for general applica- 
tions. Both Eq. (5) and Eq. (7) would then be contained as limiting cases. Such 
a functional is not yet available. 
A number of suggestions have been made for semiempirical or otherwise 
approximate representations for the nonlocal contributions to Exc[n]. A com- 
prehensive review has been given in the monograph of Dreizler and Gross [25]. 
Information from the high density, low gradient regime required for application 
of Eq. (5) is incorporated into these representations in such a way that the 
approximations are correct in the domain of slowly varying density. The low 
density regions are controlled by explicit constraints imposed on the functional 
forms. In this manner, the two very different density regimes are incorporated 
into a simple energy functional in an approximate way. These approximate 
functionals are widely used and have been useful in a wide variety of situations. 
They are currently important components of state of the art computational 
algorithms. 
46 

Nonlocal Energy Functionals: Gradient Expansions and Beyond 
6 Gradient Coefficients at Finite Temperature and Limiting Cases 
I have emphasized the need to extend practical density functional computations 
to new areas of applications including systems of reduced dimensionality or 
restricted geometry and, especially, systems at finite temperature. The major 
problem is obtaining adequate approximations for the exchange-correlation 
contributions to the free energy. A systematic approach is required for the 
nonlocal contributions beyond the local density approximation and it is natural 
to consider gradient expansions. In this section, I will briefly discuss the results 
of a recent calculation [26] of B~(no; T) which determines the leading nontrivial 
nonlocal contribution to the free energy to first order in the interparticle 
two-body interaction, v(r - r), and to first order in (Vn(r)) 2. This provides the 
finite temperature exchange counterpart of B~c(n(r)) of Eq. (5). The correspond- 
ing correlation contributions will be required for practical applications but 
results are not yet available. Finite temperature calculations for reduced dimen- 
sionality geometries have also been considered [27]. 
The procedures are similar to those used for the ground state energy. 
A general static external potential is treated in perturbation theory and the 
expansions are rearranged and resummed. The unperturbed system is of uni- 
form density and fully extended and the thermodynamic limit is taken at the 
outset. Particular care is required to treat the chemical potential correctly. The 
result for D = 3 and arbitrary two-body interaction is [28, 29] 
Bx(no; T)= m~o~ 
drv(r) ~gL\~oo, ] - 2~n'o] Vo V~ + -6 Fo F'~' 
" 
h2['l 
2 
1 .... 
1 no [Vo v~ + (v~) 2] + ~m [~ Fo V F~o ''~ 
+~FoFo -6n~o 
+~F~V 2F~'- 
VF~.VF~ 
(8) 
where primes and superscripts denote derivatives with respect to the chemical 
potential/~o(T) of an extended system of uniform density no = no(/to(T)), and 
Fo = Fo(r; T) is the Fourier transform of the Fermi distribution function at 
temperature T. 
The case of bare Coulomb interactions, v(r) = e2/r, is of particular interest 
[29]. In this case, Eq. (8) can be evaluated analytically and expressed in closed 
form, after lengthy calculations, in terms of standard Fermi-Dirac integrals 
72m z 
- -~ t~__~jj 
(9) 
~i~(~#)) 
where q = lto(T)/kB T and the Fermi-Dirac integral is defined by 
1 
7 
xPdx 
, (P > 
1). 
(10) 
~(r/) - F(1 + P) o 1 + e x-" 
47 

D. J. W. Geldart 
The limiting values in the degenerate (low T) and the classical (high T) limits are 
easily obtained from Eq. (9). It is interesting that Bx(no; T) changes sign in the 
intermediate temperature region [29]. The low temperature limiting value is of 
special interest, as will be discussed in the following. This limit is given by 
B~ = - ~ze2/18k 4 and will be referred to as the "thermal limit". 
The case of a Yukawa interaction, v(r) = (e2/r)exp( - )~r), where )~ may be 
thought of as simulating static screening, is also of interest. The previously used 
method of analysis is not suitable in this case and so results were obtained 
numerically after expressing Eq. (8) in wavenumber space [30]. In order to make 
contact with previous studies of ground state properties, special attention was 
given to low temperatures, T/TF ,~ 1 where Tv is the Fermi temperature, and to 
weak static screening, 2/kv ~ 1. The limiting behaviour of Bx(no; T, 2) is not 
uniform when both Tand 2 are both small. The temperature controls the limit if 
2 is taken to zero before the temperature; that is, Bx(n0; T, 2 = 0) ~ B~ as T~ 0. 
On the other hand, the static screening controls the limit if the temperature is 
taken to zero before 2; that is, B~(no; T= 0, 2)~ B~[ = (7/8)B~ = -7~ze2/ 
144k 4 as 2-~ 0. This latter value, which will be referred to as the "static 
screening" limit had been deduced by Sham in his study of the exchange 
gradient coefficient for the electron gas in its ground state [13]. 
The fact that there are two different limiting values for a single physical 
object is due to the potentially singular contributions to Eq. (8) from large 
interparticle separations. A regularization procedure is required. The static 
screening regularization of the physical bare Coulomb case introduces a factor 
ofexp( - 2r) into the integrand of Eq. (8). It can be shown that the effect of finite 
temperature is to introduce into the integrand of Eq. (8) a factor of 
[tcr/sinh(~r)] 2 at large distance and low temperature, where K = ~kBT/hvr 
describes how the ballistic motion of an electron of velocity vr is damped by 
purely thermal fluctuations. It is the fact that thermal damping changes the 
power of r at large r in Eq. (8) in addition to introducing an exponential 
damping factor that leads to different limiting results for these two procedures. 
In addition to these two different limiting values, there is yet another 
theoretical value of Bx(no), for the ground state. The leading exchange correc- 
tions to the density response function, or equivalently vxc(k) of Eq. (6), were 
computed numerically for a wide range of k by Geldart and Taylor [23]. The 
curvature of the exchange contribution as a function of k in the long wavelength 
expansion determines Bx(no). It was observed by Sham (see his Table I) that the 
data of Geldart and Taylor [23] implied an exchange gradient coefficient close 
to (lO/7)B~C(no) = B~(no) [13]. We wilt refer to this value as the "ground state 
limit". 
It must be emphasized that the computation of vxc(k) at small k is very 
delicate, and must not be crudely pursued. There is a great deal of structure in 
the integrand of the multiple wavenumber integrals due to incipient singularities 
of the bare Coulomb potential and of the repeated energy denominators which 
are characteristic of perturbation expansions. In fact, the contributions of the 
individual Feynman graphs had already been calculated analytically in the 
48 

Nonlocal Energy Functionals: Gradient Expansions and Beyond 
(k ~ 0) limit and shown to be logarithmically divergent at small wavenumber 
[31]. Geldart and Taylor took advantage of the explicit Pauli principle restric- 
tions, and carried out a sequence of transformations and rescalings in such 
a way that absolutely all of the possible irregular behaviour was removed 
analytically. The resulting integrand was smooth in the new variables and the 
numerical multiple integration was relatively straightforward. Consequently, 
the accuracy obtained (at the level of fractions of 1%) was not only reasonable, 
particularly in view of limitations of computers of the late 1960s vintage, but was 
also even superior to some of the much later work on the same problem. It 
should be emphasized that the goal of the entire procedure of transforming and 
rescaling had been to obtain numerical stability by ensuring analytical cancella- 
tion of the singularities which were known to exist in the individual Feynman 
graphs at small k. For this reason, extensive testing of the integration routines 
was carried out in the regime of small k, much smaller than the step size of 0.1 kp 
of the published table which was available to Sham. The numerical results were 
very close to the value surmised by Sham, which led to B~'~(no). 
The same Feynman graphs for the leading exchange contributions have been 
studied subsequently by various groups, some of which were apparently un- 
aware of the earlier work of Geldart and Taylor [23]. The most accurate 
numerical work has been done by Chevary and Vosko who also emphasized the 
need to take care with the Pauli principle restrictions [32]. This paper also 
contains references to other numerical work. An analytical evaluation of Vxc(k) 
has also been given by Engel and Vosko [33] and this treatment was completed 
by Glasser [34]. The most recent numerical work, and especially the exact small 
k expansion of the analytical result confirm completely the "ground state limit", 
B~(no) and confirm that the numerical results of Geldart and Taylor [23] 
are accurate to a fraction of 1%. Note that in this ground state case (T~ 0) 
with bare Coulomb interactions (2 = 0), it is k itself which controls the limiting 
value. 
What is to be done with this plethora of values for what would have seemed to 
be a single physical quantity? The first point is that physically meaningful 
applications of gradient expansions to extended systems with continuous 
spectra demands that exchange and correlation contributions be treated to- 
gether. Of course, it is often convenient to separate these two types of contribu- 
tions. This is permissible provided a regularization procedure is consistently 
used with exactly the same procedures for both the exchange and the correlation 
components. Thus, the procedure of Sham is perfectly acceptable for treating 
exchange provided the same limiting procedure is used for correlation in the 
ground state, subject to the clear understanding that it is always the sum of the 
exchange and the correlation contributions which is physically meaningful for 
these extended systems. In this situation, the "static screening" parameter 2 is 
merely a convenient device. For applications at finite temperature, the temper- 
ature automatically provides a regularization, which is also physically real 
rather than a device. In fact, there are never any divergent integrals even for bare 
Coulomb interactions! After calculations of the corresponding correlation 
49 

D. J. W. Geldart 
components are completed, the full Bxc(no; T) will be available for physical ap- 
plications. I emphasize that these comments apply only to extended systems. 
Finally, I am unaware of reasons why any of the above possible candidates 
for the exchange gradient coefficient should be correct when applied to 
a bounded system. The semiempirical procedures based on fitting to the non- 
local exchange energies of atoms are more appropriate in this situation, even 
though they lack a complete, theoretical foundation at present [35, 36, 37, 38]. 
7 Summary 
The theorems of Hohenberg and Kohn established a rigorous foundation for the 
description of inhomogeneous systems using the particle density as the natural 
variable. Based on their powerful ideas, modern density functional theory has 
not only provided a theoretical framework for discussing general inhomo- 
geneous many-particle systems but also has developed into a highly effective 
computational tool for state of the art computations in practical chemical and 
condensed matter systems. Extensions of density functional methods to ever 
wider varieties of new physical situations (phenomena in reduced dimensional- 
ity, strongly correlated localized electronic materials, phase diagrams of mater- 
ials, complex liquids, and all of finite temperature phenomena are some exam- 
ples) will become increasingly important. The identification of the key features of 
the subtle exchange-correlation contributions to the energy functionals in these 
new situations will continue to be challenging and rewarding. 
The universal functional Fin] of Eq. (1) is a very special quantity. Its 
existence as the logical cornerstone of density functional theory may be taken as 
assured by the Hohenberg and Kohn theorems [1] and their extensions. How- 
ever, explicit properties of F In] are not available, a priori, and it is necessary to 
construct procedures, based on Eq. (1) or its generalizations, to discover the 
essential properties. I have emphasized that this constructive approach to 
generating practical approximants to the universal energy functional focuses 
attention on global symmetries and boundary conditions and their natural role 
in classifying systems according to universality subclasses. I have discussed in 
some detail the fundamental differences which exist between finite, bounded 
systems and fully extended systems in their thermodynamic limit as well as the 
differences between high density, low gradient regions and low density, high 
gradient regions of a single system. I have described a systematic approach to 
studying the exchange-correlation energy functional of these inhomogeneous 
systems, based on rearrangements and partial resummations of perturbation 
expansions. The convergence properties of the long wavelength gradient expan- 
sions have been examined. An alternative nonlocal structure, which is character- 
istic of the low density regime, has also been indicated. Both the long wavelength 
50 

Nonlocal Energy Functionals: Gradient Expansions and Beyond 
expansions and the short wavelength expansions are contained in the same 
perturbatively constructed exchange-correlation functional. The gradient ex- 
pansion for the free energy of an extended system at finite temperature was 
discussed. Results were given for the leading contribution, of first order in the 
two-body interaction and of second order in density gradients, to the exchange 
gradient coefficient. 
In closing, I want to stress again the essential importance of understanding 
in a fundamental way the nonlocal structure of exchange-correlation contribu- 
tions to energy functionals. I believe that a full appreciation of the variety of 
ways that this nonlocal structure manifests itself, according to the different 
physical circumstances, will be vital for the construction of improved repres- 
entations of F[n] as the domain of applications of density functional theory 
continues to be extended into exciting new areas. 
Acknowledgements, This research was supported by the Natural Sciences and Engineering Research 
Council (NSERC) of Canada, by the Atmospheric Environment Service (AES) of Environment 
Canada, and by the Gordon Godfrey Foundation at The University of New South Wales, Australia. 
It is a pleasure to acknowledge the contributions of E. Dunlap, M.L. Glasser, D. Neilson, M.R.A. 
Shegelski, E. Sommer, and R. Taylor. I owe a special debt of gratitude to Mark Rasolt for sharing his 
insights and enthusiasm during the course of so much of this work. | thank T, L'Ecuyer for his 
assistance in preparing the manuscript. This contribution was based in part on an earlier work [24], 
with permission of the publisher. 
8 Appendix: Energy of Inhomogeneous Electron Gas 
Local (spin) density approximations provide instructive starting points for the 
discussion of energy functionals. Provided the space of density functions is 
appropriately constrained, their numerical results may be even surprisingly 
accurate. This suggests that it would be useful to study systematically the 
gradient corrections to local approximations. A simple model for doing so is the 
weakly inhomogeneous electron gas which is formed by imposing a weak 
external potential V(r) on an otherwise uniform neutral system. The external 
potential is taken to be suffÉciently weak that perturbative expansion can be 
freely utilized, provided the external potential does not promote any change of 
overall symmetry or instability. This can be assumed for the present discussion 
(a case to the contrary is given by the analysis of band gap discontinuities in 
semiconductors [8]). In this way, we have a tractable model system to study not 
only the nonlocal contributions to Exc but also the effect of inhomogeneities on 
some subtle quantities, such as the structure factor. 
In the presence of the static imposed external potential, which couples to the 
total charge density, the energy of the electron gas is shifted by an amount 
1 
~.,) 
(A.1) 
AE= ~-~ .x(k)I K,,t(k){2 + O( 3 
51 

D. J, W. Geldart 
where g(k) is the static (zero frequency, ~ = 0) wave number dependent den- 
sity-density correlation function of the uniform interacting electron gas. 
z(k) = - n(k)/[1 + v(k)n(k)] 
(a.2) 
where v(k) and n(k) denote the Coulomb interaction and the static irreducible 
screening function, respectively. In order to identify the exchange-correlation 
contributions, we introduce the Fourier components of n(r) -no = 6 n(r). From 
linear response, 
~n(k) = z(k) V~xt (k) 
(A.3) 
and we rewrite (A. 1) as 
1 
AE = A E[n] = -f~ ~ 6n(k)Z / g(k) + ... 
1 ~ V~x,(k)6n(k) + AF[n] 
(A.4) 
2~2 
The Hartree contribution is next removed from AF[n] by 
1 ~6n(k)2/g(k) + ... 
A ~[n3 - 
2~ 
= .
.
.
.
 
1 ~6n(k)[v(k) + 1/n(k)]6n(-k) + 
20 k 
= A E,, In] + A G In] 
(A.5) 
The kinetic energy of the Kohn-Sham reference system, also to second order in 
V~,, is 
1 
A Er[n] = ~-0 ~[6n(k)[2/no(k) + ... 
(A.6) 
where no(k) is the Lindhard function. Thus the exchange-correlation energy shift 
is extracted from (A.5) as 
1 ~6n(k) z [n(k)_ ~ _ no(k)-'] + "'" 
(A.7) 
AE~c[n] = -~ k 
which is rigorous to order V~Zt and is useful provided ~(k) is known for all k for 
which 6n(k) is significant in the sum (A.4). 
The calculation of n(k) is an important and very nontrivial many-body 
problem and requires the approximate solution of a Bethe-Salpeter equation. 
Our present objective is to generate gradient corrections to the LDA so (A.7) can 
be simplified by assuming that 6n(r) is so slowly varying in space (in addition to 
being of small magnitude) that 6n(k) is essentially zero except for very small k. 
A small k expansion of n(k) = a- 1 _ bk 2 + ... (similarly for no(k)) then yields 
the small k expansion for Kxc(k) ==- n(k) -1- no(k)-1 =_ Kxc + ½ k 2 K"c(O) + .... 
52 

Nonlocal Energy Functionals: Gradient Expansions and Beyond 
The exchange-correlation functional is then obtained as 
Exc[n] = E:,jno) + AExc[n] 
= E~jno) + ~d3r [½K~jO)(rn(r)) 2 + ¼K"~(O)(Vrn(r)) 2 + ""]. 
(A.8) 
Making use of 6n(k = O)= O, dE~ON =/~ and a Ward identity O#/Ono = 
z(0)-1 = a, the first two terms of (A.8) provide the first two terms (only) of the 
expansion in powers of 6n of 
1 
tP 
E~ °a = S d3 r [Axjno) + ~ Axc(no)(cSn(r)) 2 + ---] 
(A.9) 
where A~ (n(r)) = n(r)~(n (r)). The third term of (A.8) gives the leading gradient 
correction 
Egxc In] = f d 3 r Bxjno) (Vn(r)) 2 -q- --, 
(A. 10) 
on using Vrn(r)= Vn(r) with Bxjno)= ~(0). 
Taken together, (A.9) and 
(A. 10) give the leading inhomogeneity corrections to Exc [n] for a many-electron 
system having a density which is almost constant and also very slowly varying in 
space. Its range of validity is therefore very limited. However, rigorous applica- 
tions can be given within this domain. 
Explicit calculations of Bxjno) were first carried out by Ma and Brueckner 
[12] and by Sham [13] for the correlation and exchange contributions, respec- 
tively, in the high density limit (rs ,~ 1). The evaluation of the required Feynman 
graphs in the metallic and intermediate density range and the extension to 
include iterations of the scattering processes was given in a self-consistent 
random phase approximation [17, 18]. The results can be expressed as 
Bxjno) = e 2 no 4/3 Cxc(rs) 
(A.11) 
For convenience of applications, numerical results for C~c(rs) can be pres- 
ented as [39] 
10-3(2.568 + ar~ + br 2) 
Cxc(rs) = 1 +crs + dr 2 + lObr 3 
(A.12) 
where Cxj0) = 2.568 x 10-3 is the value in the high density limit. The coeffi- 
cients in (A.12) were obtained by fitting to data for r~<t0 as a = 23.266, 
b = 7.389 x 10 -3, c = 8.723 and d = 0.472. The Pade form (A.12) can also be 
used to extrapolate to lower density. The above discussion applies to a un- 
polarized (one component, essentially) electron gas. Ground state results are 
also available for the spin-polarized (two components) electron gas [19] and 
multicomponent electron-hole droplets [20, 21] in the high density limit. Re- 
suits for finite temperature gradient corrections to the first order exchange free 
energy, via the coefficient Bxjno, T), are also known [26] although the corres- 
ponding correlation contributions are not known. 
We will not describe here any details of the calculation of B~jno) but refer to 
the literature and particularly to a fairly comprehensive recent review [7]. The 
53 

D. J. W. Geldart 
basic technical problem is that a Bethe-Salpeter equation must be solved to 
(9(k2). The first and probably the simplest general procedure for obtaining such 
exact solutions was given by Geldart and Rasolt [14]. It is well known that 
Ward identities (also often referred to as Ward-Pitayevski identities in the 
present context) determine the structure of solutions of integral equations for 
four-point scattering functions, three-point vertex functions, and two-point 
correlation functions in the k ~ 0 limit. By purely algebraic matrix manipula- 
tions of these integral equations, it is also possible to extract the leading 
k dependence. This method yields a formal, but exact, result for Bxc(no) for 
arbitrary static two-body interaction within a self-consistent Hartree-Fock 
approximation. Explicit results were given for a Yukawa static screened 
Coulomb interaction v(r)= (eZ/r)exp(-2r) and the 2 ~ 0 + limiting case was 
considered to simulate bare Coulomb interactions. This work was submitted as 
a report to the National Research Council of Canada in 1972. Response from 
seminars on the subject and apparent interest prompted us to submit the paper 
for publication [16]. The same conclusion was reached, using other methods, by 
Kleinman [15]. Only the procedures based on Ward identities and integral 
equations have been extended to the case of dynamically screened electron- 
electron interactions [17, 18]. 
9 References 
1. Hohenberg P, Kohn W 0964) Phys Rev 136:864 
2. Kohn W, Sham LJ (1965) Phys Rev 140:Al133 
3. Mermin ND (1965) Phys Rev 137:A1441 
4. Kohn W, Vashishta P 11983) In: Lundqvist S, March NH (eds) Theory of the Inhomogeneous 
Electron Gas. Plenum, New York, p 79 
5. Pines D, Nozieres P (1966) The Theory of Quantum Liquids. Benjamin, New York 
6. Kirzhnits DA (1976) Ups Fiz Nauk 119:357 [(19761 Soy Phys Usp 19: 530] 
7. Geldart DJW, Rasolt (1987) In: March NH, Deb BM (eds) The Single Particle Density in 
Physics and Chemistry. Academic, London, p 151 
8. Geldart DJW, Rasolt M (1992) In: M.P. Das and D. Neilson (eds) Strongly Correlated Electron 
Systems. Nova Science, New York, p 123 
9. Wilson KG, Kogut J (1974) Phys Reports 12:75 
10. Geldart DJW, Rasolt M (1977) Phys Rev B 15:1523 
1 l. Geldart DJW, Rasolt M (1980) Phys Rev B 22:4079 
12. Ma SK, Brueckner KA (1968) Phys Rev 165:18 
13. Sham LJ (1971) In: Marcus PJ, Janak JF, Williams AR (edsl Computational Methods in Band 
Theory. Plenum, New York, p 458 
14. Geldart DJW, Rasolt M (1972) Report submitted to the National Research Council of Canada 
15. Kleinman L (1974) Phys Rev B 10:2221 
16. Getdart DJW, Rasolt M, Ambladh CO (1975) Sol State Commun 16:243 
17. Rasolt M, Geldart DJW (1975) Phys Rev Lett 35:1234 
18. Geldart DJW, Rasolt M (19761 Phys Rev B 13:1477 
19. Rasolt M (1977) Phys Rev B 16:3234 
20. Rasolt M, Geldart DJW (1977) Phys Rev B 15:979 
21. Rasolt M, Geldart DJW (1977) Phys Rev B 15:4804 
54 

Nonlocal Energy Functionals: Gradient Expansions and Beyond 
22. It may be convenient to consider the entire system to be confined within a very large container 
having inpenetrable walls if realistic equilibrium of vapour and condensed phases is important. 
In cases of immediate interest, the true vapour phase is not an essential feature and the relatively 
small volume occupied by the condensed phase is the more important thermodynamical 
variable. There are still subtleties associated with taking the thermodynamic limit, particularly 
when isolating surface and bulk effects, but the problems with vanishing density of particles can 
be controlled. 
23. Geldart DJW, Taylor R (1970) Can J Phys 48:155 
24. Geldart DJW (1995) In: Gross EKU, Dreizler RM (eds) Density Functional Theory. Plenum, 
New York, p 33 
25. Dreizler RM, Gross EKU (1990) Density Functional Theory. Springer, Berlin Heidelberg 
New York 
26. Geldart DJW, Dunlap E, Glasser ML, Shegelski MRA (1983) Sol State Commun 88:81 
27. Geldart DJW, Glasser ML, Dunlap E (unpublished) 
28. Dunlap E, Geldart DJW (1994) Can J Phys 72:1 
29. Glasser ML, Geldart DJW, Dunlap E (1994) Can J Phys 72:7 
30. Shegelski MRA, Geldart DJW, Glasser ML, Neilson D (1994) Can J Phys 72:14 
31. Geldart DJW (1964) Corrections to the Random Phase Approximation for an Interacting 
Electron Gas. Thesis, McMaster University, Hamilton 
32. Chevary JA, Vosko SH (1990) Phys Rev B 42: 5320. This paper also contains references to earlier 
numerical work. 
33. Engel E, Vosko SH (1990) Phys Rev B 42:4940 
34. Glasser ML (1995) Phys Rev B 51:7283 
35. Herman F, Van Dyke JP, Ortenburger IB (1969) Phys Rev Left 22:807 
36. Boring AM (1970) Phys Rev B 2:1506 
37. Becke AD (1986) J Chem Phys 84:4524 
38. Becke AD (1988) Phys Rev A 38: 3098. References to other work aimed at providing generaliz- 
ations of simple gradient expansions are also given in this work. 
39. Rasolt M, Geldart DJW (1986) Phys Rev B 34:1325 
55 

Exchange and Correlation in Density Functional Theory 
of Atoms and Molecules 
A. Holas 1 and N.H. March 2 
1Institute of Physical Chemistry of the Polish Academy of Sciences, 44/52 Kasprzaka, PL-01-224 
Warsaw, Poland 
2Inorganic Chemistry Laboratory, University of Oxford, South Parks Road, Oxford OX1 3QR, 
England 
Table of Contents 
List of General Abbreviations 
1 Background and Outline 
........................... 
59 
2 Various Approaches to the Ground-State Problem 
............ 
61 
2.1 The Hohenberg-Kohn Theory 
..................... 
61 
2.2 The Hartree-Fock Method 
....................... 
63 
2.3 The Kohn-Sham Approach ....................... 
64 
2.4 The Hartree-Fock Method Posed as a Density Functional Theory 
68 
2.5 The Exact Ground-State Problem Posed as the Hartree-Fock 
Method 
.................................. 
71 
2.6 The Optimized Potential Method 
................... 
73 
2.7 The Exact Ground-State Problem Posed as the Optimized 
Potential Method 
............................ 
75 
3 Determination of the Exchange and Correlation Potentials 
from Accurate Many-Body Wave Functions ................ 
76 
4 Long-Range Asymptotic Form of Potentials ................ 
77 
4.1 Kohn-Sham Potential 
.......................... 
77 
4.2 Exchange Potential for a Pure-State System in the Conventional 
DFT 
.................................... 
78 
4.3 Exchange Potential for a Pure-State System in the Spin DFT 
. . 
80 
4.4 Exchange Potential for a Mixed-State System ............ 
81 
Topics in Current Chemistry. Voi 180 
© Springer-Verlag Berlin Heidelberg 1996 

A. Holas and N. H. March 
5 Exchange and Correlation Potentials in a Line-Integral Form 
..... 
5.1 Differential Virial Theorems 
...................... 
5.2 Force Equations 
............................. 
5.3 Exact Expression for the Exchange-Correlation Potential, 
Applicable to Mixed-State Systems 
.................. 
5.4 Expressions for the Exchange and Correlation Energy 
of Mixed-State Systems ......................... 
5.5 Approximate Expression for the Exchange Potential ........ 
5.6 Alternative Formulation of the Kohn-Sham Approach Generalized 
for Mixed-State Systems 
........................ 
5.7 Approximate Correlation Energy and Potential of Some Mixed 
Systems 
.................................. 
6 Summary .................................... 
7 Appendices ................................... 
7.1 Some Properties of Density Matrices ................. 
7,2 Differential Virial Theorem for the Hartree-Fock Solution 
.... 
8 References ................................... 
84 
84 
86 
87 
89 
92 
94 
98 
100 
101 
101 
103 
105 
List of General Abbreviations 
DFT density functional theory 
DM 
density matrix 
DS 
Dirac-Stater 
GS 
ground-state 
HF 
Hartree-Fock 
HK 
Hohenberg-Kohn 
KS 
Kohn-Sham 
OP 
optimized potential 
QM 
quantum mechanical 
SCS 
spin compensated system 
TFD 
Thomas-Fermi-Dirac 
List of Specific Subscript/Superscript Abbreviations 
app 
approximate 
c 
correlation 
58 

Exchange and Correlation in Density Functional Theory of Atoms and Molecules 
D 
determinantal 
ee 
electron-electron (interaction) 
eft 
effective 
ens 
ensemble 
es 
electrostatic 
ext 
external 
ferro 
ferromagnetic 
ncl 
non-classical 
para 
paramagnetic 
s 
single-particle (noninteracting) 
x 
exchange 
xc 
exchange-correlation 
The exchange and correlation energies and potentials, occurring in various density functional theory 
approaches and schemes are reviewed and their definitions compared. The ways of their determina- 
tion and their long-range properties are discussed. General expressions for the exchange and 
correlation energy and the long-range asymptotic form of the exchange potential are obtained for 
mixed-state systems. Line-integral expressions for the exchange and correlation potentials, valid 
both for pure-state and mixed-state systems are derived. Approximation to the electrostatic-plus- 
exchange energy and corresponding potential for arbitrary mixed-state systems and approximation 
to the correlation energy and potential for a specific class of mixed-state systems are proposed. They 
are expressible in terms of any approximate functional of the density for the exchange energy and 
correlation energy, respectively, known for pure-state systems. 
1 Background and Outline 
The origins of density functional theory (DFT) are to be found in the statistical 
theory of atoms proposed independently by Thomas in 1926 [1] and Fermi in 
1928 [2]. The inclusion of exchange in this theory was proposed by Dirac in 
1930 [3]. In his paper, Dirac introduced the idempotent first-order density 
matrix which now carries his name and is the result of a total wave function 
which is approximated by a single Slater determinant. The total energy underly- 
ing the Thomas-Fermi-Dirac (TFD) theory can be written (see, e.g. March [4], 
[5]) as 
1 
O@TFD[ #'/] ~--- Ck ~ d3r {#'1(!')} 5/3 "{- ~ d31" H(I')/Jen(ll ") -I- ~ ~ d3r #'l(l')/)es(¥) 
-- C, ~ d3r{n(r)} 4/3 + e,n. 
(1) 
In Eq. (1) the individual terms on the r.h.s, are in order (i) the TF kinetic energy 
with ck = [3h2/(lOm)] [3/(8Z)] 2/3, (ii) the electron-nuclear potential energy with 
yen(r) the bare nuclear one-body potential energy (in an atom having nuclear 
charge Ze, v,n = - Ze2/r), (iii) the classical electrostatic energy of the charge 
59 

A. Holas and N. H. March 
cloud of density n(r), vdr) being the electrostatic potential created by n, (iv) the 
Dirac exchange energy, with cx = (3/4)e2(3/n) 1/3 and (v) the nuclear-nuclear 
potential energy in multicentre system: either molecule or solid. 
The variational principle 
6(~TF o -- #TFDJ]/') 
= 0 
(2) 
with the variation 6 with respect to n(r) subject to the constraint 
X[n] 
- ~ d3r n(r) = ~,' 
(3) 
with N the total number of electrons, yields from Eq. (1) 
~TFD = )ck{n(r)} 2/3 + Yen(r) + Yes(r) -- ~Cx{rl(r)} 1/3. 
(4) 
In Eq. (2), #TED is the Lagrange multiplier taking care of the normalization 
constraint (3). It has the interpretation of the chemical potential of the electronic 
cloud and is written explicitly in Eq. (4) in the TFD approximation. It is seen 
from that equation that /[/TED can be viewed as built up from the sum of three 
different pieces: 
(i) a kinetic part, ~ck{n(r)} 2/3, 
(ii) a "Hartree" potential vn(r) = v~.(r) + v,s(r), 
(iii) an exchange contribution - ~ c~ {n(r) } l/a. 
While Dirac [3] chose to solve Eq. (4) as a quadratic equation for n ~/3 in 
terms of the Hartree potential vn(r), it was Slater in 1951 ([6]; see also [4]) who 
chose an alternative, and more fruitful, route by regarding Eq. (4) as demonstrat- 
ing that it could be viewed as a "modified Hartree" equation, with the Hartree 
potential vn(r) now supplemented by the exchange nl/3-potential (the so-called 
Dirac-Slater (DS) exchange potential), to yield a total one-body potential energy 
/)TFD(r) = /)H(r) + /)xDS(r) 
(5) 
where the DS exchange (x) potential is given by 
vxOS(r) 
4 
1/3. 
(3/4)e2(3/n)l/3. 
(6) 
= 
- 
~Cx{n(r)} 
, 
cx = 
Slater then proposed returning to one-electron Schr6dinger equations (and 
therefore one-electron wave functions q~i and corresponding eigenvalues ~i) but 
now using not the Hartree-Fock (non-local) potential in these equations but the 
simplified potential 
• 
DS 
vs(r, [n]) = v~,(r) + v~(r; [n]) + vx (r; [n]). 
(7) 
DS 
Here it is now understood that VH = re. + re, and vx are no longer to be 
calculated from the approximate TFD Euler equation (4) but rather using 
a density n(r) given by the ground-state sum 
N 
n(r) = Y. ,~,(r)4,*(r), 
(8) 
i=1 
where ~b~(F) are one-electron wave functions generated (self-consistently) by the 
60 

Exchange and Correlation in Density Functional Theory of Atoms and Molecules 
one-body potential energy vs(r; In]) in Eq. (7), with v Ds (r; In]) given in terms of 
n in (8) by Eq. (6). 
As will be developed in more detail below, the paper by Hohenberg and 
Kohn (1964) [7], which proved the existence theorem that the ground state 
energy is a functional of n(r), but now without the approximations (valid for 
large N) in the explicit energy functional (1), formally completed the TFD 
theory. The work of Kohn and Sham (1965) [8] similarly gave the formal 
completion of Slater's 1951 proposal. 
Since the terms exchange energy and correlation energy (and corresponding 
potentials) are used in various contexts with a slightly different meaning, we 
shall discuss this problem in detail in Sect. 2 for some well known approaches. In 
Sect. 3 various ways of reconstruction of the exchange and correlation potentials 
from accurate many-body wave functions are reviewed shortly. Section 4 is 
devoted to long-range properties of potentials and Kohn-Sham orbitals. Finally, 
in Sect. 5, a line-integral form of exchange and correlation potentials is 
presented, applicable to all types of mixed-state systems, together with analysis 
of expressions for corresponding energies. 
2 Various Approaches to the Ground-State Problem 
2.1 The Hohenberg-Kohn Theory 
Our object of interest is a many electron finite system (such as an atom, 
molecule, cluster etc.), having, by assumption, a nondegenerate ground state 
(GS) (this assumption will be removed in Sects. 4.4 and 5). The number of 
electrons N and the electron-nuclei potential energy v(r) = Yen (r) (the so-called 
external potential) are given and common for all schemes to be discussed. The 
GS energy Eos and the GS wave function ~cs of the system can be found from 
a variational principle as 
EGs = min (~l~- + ql + ~l ~) = (~Gsl~- + ~ + ~l ~Gs), 
(9) 
T 
where the variational wave function ~(xl, x2 ..... x~) here and other wave 
functions elsewhere are assumed to be normalized. The notation xi = (&, si) for 
the i-th space and spin coordinate is adopted. The kinetic, electron-electron (ee) 
repulsion, and electron-nuclei attraction (external) energy operators, respect- 
ively, are defined as 
N 
g-= Y, t,; 
t, = -½v?, 
(lO) 
l=1 
N-1 
N 
o~ = ~ 
y~ u(r,,rj); 
u(ri,rj)= 1/Ir,--ral, 
(11) 
i=1 j=i 
61 

A. Holas and N. H. March 
N 
:~ = Z v(r,). 
(12) 
i=1 
Atomic units are used throughout. 
Following Levy's constrained-search formulation [9-1 (see also [10]) we can 
perform the minimization in Eq. (9) in two steps, namely 
min fmin (~i3- + o/~ + ~'l ~}~ ' 
(13) 
Eas = 
n 
{tp~ n 
) 
where by ~ --+ n we denote such 5 u which integrates to the given electron density 
n(r) (see Appendix A). The variational density n(r) here and elsewhere is assumed 
to be constrained to the given number of electrons, Eq. (3). Finally, Eq. (13) can 
be rewritten as 
Ec;s = min G[n] = min {FnK[n] + E~xt[n]} = FHK[nos] + Eext[nos], 
n 
tl 
(14) 
where the Hohenberg-Kohn (HK) functional is 
FHK[,n] = min (~13- + q/[ q'> = <~HK[n] l J- + ql[ ~HK['n] >, 
(15) 
the external (ext) energy functional is 
Eextl-n] = j" d3r n(r) v(r), 
(16) 
and the GS density nos(r) corresponds to the integrated ~as of Eq. (9). Formula- 
tion of the GS problem as minimization in terms of the density, Eq. (14), and 
existence theorem for FnK[,n] were given first by Hohenberg and Kohn [,71. 
Owing to the wave function symmetry and operators structure, the expecta- 
tion values of 3- and ~ can be written in terms of? = 7[~] and ~2 = ~2[~] or 
p = p[V] and n2 = n2[V] - the reduced density matrices (DM) or spinless 
reduced DMs, generated from q~ (see Appendix A): 
(~ 13-1 t/,> = T[D] = ~ dx(-½) V~7(xl;x2)lx~ = x2 = x 
= ~ dx½ v1 v2~(xl;x2)tx, = ~ = 
]~1- p] 
I dZr(_½) 
2 
"r 
= 
= 
Vlp(r 1, 2)lrl=rz=r 
= ~ dZr½ V1 V2p(Iel; r2)Irl = r z = r' 
(17) 
<q' Iq?l ~> = E¢¢[-¢2] = ~ dxdx'¢2(x, x')u(r, r') 
= /~ee[n2] = f d3rd3r'n2(r,r')u(r'r')" 
(18) 
The diagonal second-order DM n 2 in Eq. (18) can be divided into its uncor- 
related and correlated parts, Eq. (284), which leads to 
Eee[n2] = E~[n] +/~nel[-n, h2], 
(19) 
where 
E~[n] = ½ ~ d3r d3r'n(r) n(r')u(r, r') 
(20) 
62 

Exchange and Correlation in Density Functional Theory of Atoms and Molecules 
is the classical electrostatic (es) energy of the electronic cloud of density n(r), and 
/~,~l[n, h2] = ½~ d3rdar'n(r) n(r')h2(r, F)u(r, r') 
(21) 
is the non-classical (ncl) part of the electron-electron interaction energy; h2 (r, r') 
is known as the pair-correlation function. 
It will be convenient to split the result of minimization in Eq. (15) into the 
kinetic and interaction energy terms according to Eqs. (t7)-(19) 
HK 
FnK[n] = THK[n] + E~K[n] ----- TaX[n] + Ees[n] + E.¢l [n]. 
(22) 
where 
T HK In] 
i~[ pHK [11] ]; 
HK 
= 
= 
E,~l In] 
E,~,[n,h~K[n]]. 
(23) 
Here pnK[n] and h~[n] are DMs generated by ~unK[n]. 
2.2 The Hartree-Fock Method 
In a well known practical but approximate method to solve the GS problem, 
known as the Hartree-Fock (HF) approximation (see e.g. [10]), the domain of 
variational functions 7 ~ in Eq. (9) is narrowed to those that are a single Slater 
determinant (D) ~/'D, constructed out of orthonormal spin orbitals ~q(x): 
~"/D = ~D[I/I1, ---, I/~N] : (U!)- 1/2 det{d/i(xj)}~i, j: 1,...,N}, 
(24) 
SO 
E nv-~s = min (7~0 t~ " + ~ + ~7"17~D) = (q,~F j- + ~ + ~¢717~nF-,oS 
/ • (25) 
~o 
Because the functional space of 7to is narrower than the space of ~, the "upper 
bound" property holds 
HF 
EGs --< Eos. 
(26) 
The difference between these two energies 
E¢ °M = Ecs -- Egs v _< 0. 
(27) 
is the conventional quantum mechanical (QM) correlation (c) energy. Here it is 
a single number characterizing the {N, v} system, but in Sect. 2.5 it will be 
considered also as a functional of the density, and its value will be estimated. 
Owing to Eq. (24), the minimization (25) can be rewritten as 
EHFGs = 
min 
{fHV[~/1 
..... ON] + Eext[nO[l~l ..... I~N]]}, 
(28) 
~i ..... ~N 
where 
N 
nD(r; [~1 ..... ~N]) = ~ ~ lq/i(r,s){ 2 
(29) 
i=1 
s 
63 

A. Holas and N. H. March 
is a density corresponding to the ~D in Eq. (24), while fnF, using Eqs. (17)-(21), 
equals 
f"F[~ .... 0N] = f.Fr.,, 
, 
~ ,  ..... 
Or,] + Eo~[n~[q ', ..... q~N]] 
+ E~ ~ [0, ..... 0N], 
(30) 
thus it is a sum of the kinetic energy 
N 
--HF 
T 
[01 ..... ON]= fUpD]= • 
<0i1_½17210i> ' 
(31) 
i=l 
the electrostatic energy (20), and the exchange (x) energy 
/~nv [0,, ..., 0N] =/~.~, [ nD, h~]. 
(32) 
The 1-st order DM pD and the pair-correlation function hz °, occurring in the 
above equations, are functionals of 01 ..... 0N, being generated by ~D, Eq. (24), 
according to rules given in the Appendix A. 
The conventional exchange energy /~v[Ol ..... 0N] of the HF method 
should not be confused with the exchange energy functionals of density, dis- 
cussed in the following sections. 
Minimization in Eq. (28), subject to normalization conditions for Oi, gives 
the HF differential eigenequations (see, e.g. [10]) 
(-½ V 2 + v + ve~ + ~v)~Ol = ei~i, 
i = 1,...,N, 
(33) 
where, besides the kinetic energy operator, there are two (multiplicative) poten- 
tials: external and electrostatic, the last in a form 
6Ees [n] = ~ dar,n(r,)u(r, ' r), 
(34) 
vo~(r; [n]) - 
an(~) 
Ox , 
to be taken in Eq. (33) with n = nD[Ol,---,q~N], and an integral operator nF 
a functional of ~ .... ,0u, called the 'nonlocal' exchange HF potential (see 
Appendix B); it should not be confused with exchange (multipticative) potentials, 
discussed in the following sections. 
Equations (33) can be solved numerically in an iterative manner, leading 
E nv and the determinantal 
finally to self-consistency. In this way the energy 
GS 
wave function at minimum ~UnV 
CS are obtained and available for many systems: 
from simple atoms to large molecules, neutral or ionized. 
2.3 The Kohn-Sham Approach 
The success of a determinantal approach, leading to one-electron equations in 
the HF approximation, served as inspiration for applying it to the exact GS 
problem. Stemming from the ideas of Slater [6], the method was formally 
completed in the work of Kohn and Sham (KS) [8], and is traditionally known 
as KS approach. We recall it now using again a Levy's constrained-search 
64 

Exchange and Correlation in Density Functional Theory of Atoms and Molecules 
formalism. The basic quantity of the KS approach is the noninteracting kinetic 
energy functional 
T~[n] - TKS[n] = min (I~DI~II~D) = (~S[n] [~-[4~D~S[n]). 
(35) 
eden 
Here it is assumed that the density n(r) possesses a property of being "non- 
interacting v-representable', which is true for most of systems [for general 
densities, the restriction that a variational wave function should be determi- 
nantal must be removed in Eq. (35)]. 
The reason for calling ~[n] the noninteracting kinetic energy functional is 
recognized immediately when the GS problem of a system of N noninteracting 
electrons, moving in an external potential v~(r), is considered. In analogy with 
Eq. (9) we write 
E~s = min (I~D l~- -1- q?~ I~D) = (4~St '~ + ~ 14~S)- 
(36) 
OD 
Here, by definition, there is no electron-electron interaction operator ~, while 
is defined similarly to ~ in Eq. (12), but with v(r) replaced by v~(r). The 
variational function can be chosen to be determinantal, because such a function 
describes a noninteracting system. By performing the minimization in two steps: 
external over n and internal over q~D "-* n [compare Eqs. (13)-(16)] we arrive at 
E6s = min ted 
~"~min (~D ]~- ]~bD) + S d3rn(r)vs(r)}, 
i.e., using Eq. (35) and an analogue of Eq. (16) 
ESxt[n] = S d3r n(r) Vs(r), 
at 
(37) 
(38) 
E~s = min #s In] = min { T~ [n] + E:x, [n] } 
n 
n 
= T~ [n~s] + Eg,t [n~s], 
(39) 
But the noninteracting GS problem may be solved alternatively by varying 
in Eq. (35) the N spin orbitals ¢i(x) comprising the determinantal @D [compare 
Eq. (24)]. With an imposed normalization condition on ¢i(x) this leads obvious- 
ly to one-electron SchrSdinger equations 
(--½ V z + v,)¢i = e~¢,. 
(40) 
The GS wave function ~s in Eq. (36) is a determinant of N lowest-energy 
eigenfunctions ¢~(x) of Eq. (40). Then for the GS density and kinetic energy of 
Eq. (39) we have 
N 
n~s(r ) = Z Z I¢i(r,s)l 2, 
s 
i=1 
T~ [n~s] = f dar ts(r; [n~s]), 
(41) 
(42) 
65 

A. Holas and N. H. March 
where the noninteracting kinetic energy density is 
N 
n s 
tdr; [ ~s])= ½~ Y'. [V~(r,s)[ 2. 
(43) 
si=l 
We are ready now to present the KS method for solving the GS problem 
of the original--interacting electron system, By adding and subtracting 
T~[n] - TKS[n] in Eq. (22), the functional FHK[n] is rewritten as 
with 
F HK In] = ~ In] + E~ In] + E~c In], 
E~¢[n] = FnK[n] -- E¢s[n] - TKS[n] 
HK 
= {TnK[n] -- TKS[n]} + Enel[n]. 
(44) 
(45) 
The exchange-correlation (xc) energy functional defined above is shown to 
consist of two contributions: a difference between the interacting and nonin- 
teracting kinetic energy functionals and the nonclassical part of the electron- 
electron interaction energy functional. Using Eq. (44) we rewrite Eq. (14) as 
Ecs = rain gin] = min{T~[n] + vKS[n]} = ~[nGS] + vKS[nGS], (46) 
n 
n 
where the KS effective potential energy functional is 
vKS[n] = Eext[n] + Eel[n] + Exc[n]. 
(47) 
In order to see that the minimization in Eq. (46) can be performed using methods 
developed for the noninteracting problem (39), we compare the variation of the 
interacting system energy functional g In] in (46) 
~,3 {fiT~[n] fi~]) 
(48) 
fie [.] = j a r ~ ~--n~- + 
,~.(r) 
with the variation of the noninteracting system energy functional cg ~ In] in (39) 
(fiTs[.] 
) 
6g~[n] _- ~ d3r\-~ 
+ v~(r) fin(r). 
(49) 
These two variations can become equivalent if the role of the noninteracting 
potential is played by the functional derivative of vKS[n]. Thus, the GS density 
nGs(r) and, consequently, Ts[n6s] can be calculated from the solutions of the 
so-called KS equations [compare Eq. (40)]: 
l-½ v 2 + v~s)~, ~s = s~s~ s, 
(5o) 
where the effective KS potential is [see Eq. (47)] 
fivKS[n] -- v(r) + v~(r; [n]) + Vx¢(r; [n]). 
(51) 
VKs(r; [n]) -- 
6n(r~ 
66 

Exchange and Correlation in Density Functional Theory of Atoms and Molecules 
Here yes is given in (34), while the exchange-correlation potential of the KS 
approach is obviously 
6Exc[n] 
vxc(r; [n]) = -
-
 
(52) 
&(r) 
At self-consistency, VKs(r; In]) should be evaluated with n = nGs(r). This density 
is calculated from ~b~S(x) is a similar way as n~s(r) in Eq. (41) from ~i(x). 
The KS exchange-correlation energy is customarily partitioned into the 
exchange and correlation contributions: 
Ex¢[n] = Ex[n] + Ec In], 
(53) 
of which the exchange-only part Ex In] is defined (see e.g. in [10]) as a nonclassi- 
cal part of the KS electron-electron interaction energy: 
KS 
Ex[n] = E~S[n] ~- E,,cl[n] = (q)~S[n]{~{~S[n]) -- Ees[n], 
(54) 
where q~oS[n] is the minimizer in (35). This definition can be also rewritten in 
a form 
E~[n] =/~,¢,[n, h2KS[n]], 
(55) 
[see Eq. (21)], where the KS pair-correlation function h~ s [n] is given in terms of 
the spin orbitals c~i(x) comprising ~DKS[n] [see Appendix A, Eq. (281) or (283) 
together with (278) and (279)1. 
The correlation contribution is obviously a difference between Exc and E~. 
From the partition (53) follows the partition of the potential (52) as 
Vxc(r; In]) = Vx(r; In]) + v¢(r; In]). 
(56) 
However, there is no explicit expression known for calculating in practice [e.g. in 
terms of occupied ~b~(x) or n(r)] the exchange potential defined formally as 
6E,,[n] 
Vx(r; In]) = 6n(r--~" 
(57) 
With the help of Eqs. (45), (54), (35), (22) and (15) we can calculate the correlation 
energy from Eq. (53) as 
E¢[n] = E~S[n] = (~ttHK[n] I~" q- °g I ~r/rlK[n]) 
- (q~S[n] l~" + qli~t~S[n]) 
= (TnK[n] -- T~S[n]) + (E~n~ In] - E~S[n]) 
= T~S[n] + U~[n], 
(58) 
showing two sources of the correlation energy: from the differences in (i) kinetic 
energies, and (ii) electron-electron interaction energies, due to differences be- 
tween the HK and KS wave functions. 
It is obvious from Eq. (58) that 
E¢ In] < 0, 
(59) 
67 

A. Holas and N. H. March 
because ~HK[-n] is a minimizer of (.Y- + ~), Eq. (15). The next inequality 
TKS[n] = (~nK[n][~-I~HK[n]) -- (q~S[n]lJ-[q)~S[n]) > 0 
(60) 
holds because 4~KDS [hi is a minimizer of (J-) [see Eq. (35) and a comment below 
it]. Finally 
u~S[n] < 0 
(61) 
as a difference of inequalities (59) and (60). 
It proves convenient for further considerations to rewrite Eq. (46) for the 
exact GS problem in a form 
E~s = min {FKS[n] + Ee~t[n] + E~[n] }, 
(62) 
n 
i.e. in terms of the KS functional [an analogue of the HK functional, Eq. (15)] 
defined as 
FKS[n] = <~S[n][~ + ~lq~S[n]> = T,[n] + E¢,[n] + E,[n], 
(63) 
with q)~S[n] defined in Eq. (35). 
2.4 The Hartree-Fock Method Posed as a Density Functional Theory 
Since the HF approximation plays so important a role in understanding various 
atomic and molecular systems, it is interesting to analyze it in terms of a DFT 
(see [11]). For that reason we apply to Eq. (25) the two-step minimization, as in 
Eq. (13), and obtain 
En~ = min 6 ~ HF [n] = min {FHF [n] + Eext [n] } 
n 
n 
FHFrn HF1 
E 
rnnvq 
(64) 
-~" 
L 
GS d + 
ext L 
GS _] 
where Eext [n] was already defined in Eq. (16) while the specific HF functional is 
FnV[n] = min (7~a [J" + '~/ll ~D) = (TS~F[ n] I~ + 41 ~P~F[n] ). (65) 
It can be conveniently partitioned: 
HF 
FnV[n] = THE[n] + Eee [n] = THF'[n] + Eel[n] + EHF[n], 
(66) 
with 
T nF In] = < ~P ~v In] I~-[ ~P ~v In] >, 
(67) 
HF 
Eoo In] = <~gF[n] l~?l ~g~[n] >. 
nos(V), occurring in Eq. (64), coincides with the density 
The HF GS density 
nF 
calculated according to Eq. (29) from ~ [the solutions of the HF equations 
(33)], because the two ways of calculation of E~ g are equivalent. By adding and 
subtracting the noninteracting kinetic energy functional to HF functional in 
68 

Exchange and Correlation in Density Functional Theory of Atoms and Molecules 
Eq. (66), similarly as in the case of HK functional in Eq. (44), and using the 
definition (63), we obtain 
where 
FnF[n] = T~[n] + Ee~[n] + Ex[n] + EcnF[n], 
E~ F In] = FnF [n] -- F Ks [n] 
= (THE[n] -- TKSEn]) + (EnV[n I --E~S[nl). 
(68) 
(69) 
Thus, the minimization in Eq. (64) can be performed alternatively as a solution 
of an equivalent noninteracting electron problem, leading to equations 
with 
. HF x ./. HF 
(-½ v 
+ 
+ 
+ 
+ 
= 
(70) 
OE~F[nl 
HF 
-
-
 
(7t) 
v¢ (r;[n])= 
6n(r) 
' 
analogously as minimization (46) led to KS equations (50). Here, at self-consis- 
tency, the density occurring in ves(r;[n]), Vx(r;[n]), and vncV(r;[n]) is 
n(r) = n~Fs(r), while the corresponding 
HF 
Ts [riGS ] and E x [ngs v] can be calculated as 
expectation values [see Eqs. (35) and (54)1 with the determinantal wave function 
q~KSr~nF7 constructed from the HF-KS spin orbitals ~b~ F - the solutions of(70). 
D 
LttGS J, 
These orbitals are different from ~i [the solutions of the original HF equations 
(33)] because the sum of the local potentials (vx + v~ F) in Eq. (70) replaces the 
nonlocal, integral operator potential ~v present in Eq. (33). The differences 
between ~b~ nF and ~'i are discussed in detail in [l l], using the Be atom system as 
an example. 
Interesting inequalities can be obtained [121: 
AT[n] = THE[n] -- TKS[n 1> 0 
(72) 
and [see Eq. (69)1 
AF[n] =_ En~ F [n] < 0. 
(73) 
They follow immediately from 
(~nF In] [~l 7Jg F In].> > (~s [n] I~1~ s [n] >, 
(74) 
and from [see Eqs. (65) and (63)] 
<eoSFEn]l 3 + ~l~gF[n]> < <4~KS[n] l J- + a/gl~KDS[n]>, 
(75) 
because minimizations in Eq. (35) and (65) are performed in the same space, and 
4 ~Ks is the minimizer of <~> whereas To nF is that of <J- + q~>. By subtracting 
the inequality (72) from (73) one obtains [12] 
AE~[n] = E~nF[n] -- EXS[n] < 0. 
(76) 
69 

A. Holas and N. H. March 
To avoid confusion, let us note that the notation AEc [n] and EcHF[n] is used 
in [t2] for the objects denoted here as E~nF[n] and (E~S[n] - E~nF[n]), respec- 
tively. 
It should be noted that in the case of the helium isoelectronic series (singlet 
GS of a two-electron system), because only one orbital ¢(r) is sufficient to 
construct the determinantal wave function and to obtain the density as 
n(r) = 2 [~O(r)] 2, the minimization over n in Eq. (64) is equivalent to the minimiz- 
ation over ~, in Eq. (28). Therefore the HF-KS and HF equations and their 
eigenfunctions are the same, q~(r)= ~bHv(r), and consequently AT[n] = 
AEx[n ] = En~F[n] = O. 
G6rling and Ernzerhof [12] performed quantitative investigation of A Tin] 
and AEx[n] at n(r) 
nF 
= n~s(r) for some closed-shell atomic systems: Be, Ne, Mg, 
At, Ca. For that reason they solved HF equations (33), using Gaussian basis sets 
nGs (r) = 
[13] for qti, and in terms of these functions they calculated 
nv 
nD(r, [~1 ..... ~//N ] ), 
Eq. (29), 
T HF 
HF 
~HF r,/, 
[riGs] = 
LV'I ..... @N], Eq.(31), 
and 
EHF r. HF-~ 
HF 
x LttGSJ = Ex [~9t .... 
• 
~ku], Eq. (32). Next, in order to find ,'rKSr"rtF'IL,,GS_I and 
EKSr.HFn these authors used a procedure of Ref. [14] to find such a single- 
x Lr~GS J~ 
particle potential vs(r), which, when substituted in Eqs. (40), results in n~s(r), 
n~s(r). The calculated spin orbitals 47 [solu- 
Eq. (41), identical with the given nF 
tions 
of (40)] 
are 
next 
used 
to 
obtain 
,TKSr'nFnL,GSJ-- T~Encs]nF and 
EKsr. HF-~ 
E rnnF7 according to definitions (42) and (54). 
x 
I_t~GSJ ~-~ 
xL GSA 
The results obtained in [12] show 
AT/T HF < 4 x 10 -5 
(77) 
and 
AEx/En~ v < 4.4 x 10 -4 
(78) 
for the systems considered. 
It is interesting that the following approximate relation can be noted 
(although it was not mentioned in [12]) from these results 
AE~ [ng F] ~ - 2ATEngF], 
(79) 
satisfied with an accuracy better than 3%. This can beexplained in terms of the 
virial theorem relation for atoms: (o~ + .t7) = _ 2(Y ), valid both for the GS 
in the HF approximation [see Eqs. (64) and (66)] 
E 
rnrlv-t 
HF 
,v 
E 
rrfflFl 
'~THFrrtrtF-I 
(80) 
and for the exact GS problem in the HK formulation [see Eqs. (14) and (22)] 
E~n~ [nGS] + E~t[n~s] = --2TH~[nGs] • 
(81) 
The last relation can be rewritten in terms of the KS functionals [see Eqs. (58), 
(63) and (54)] 
EKSrn 
-~ 
UKSrn 
E~[n6s]+ 
~ L ~sJ+ 
~ L ~sj+E~xt[nGs] 
= _ 2(TKS[n~s] + T~S[nGs]). 
(82) 
70 

Exchange and Correlation in Density Functional Theory of Atoms and Molecules 
By neglecting in Eq. (82) the small terms: O([n~s -- n rlFlxGsd), T~ s, and U~ s, an 
approximate relation is obtained 
E 
rnnF1 
L-KSr_rlF1 
E 
rnHF1 
2TtSrn rlF1 
(83) 
esk 
GSJ q- ~x 
LtzGS.I "[- 
extL GSJ ~'~ -- 
L GSJ- 
The difference between relations (80) and (83) gives (79). 
It follows from the relation (79) that both contributions to the HF correla- 
tion energy A T + AE~ = E~ F are of comparable magnitude and partially cancel 
out, leading to 
E HF ,,~ - AT,.~ ½AEx. 
(84) 
In combination with the results (77) and (78) it gives 
EHF/~nF=IEncFI/THF <4xlO-5; 
~ 
,~ 
<2.2X10 -4. 
(85) 
¢ 
/L'GS 
A~, HF / ~;~ HF 
We see that the HF correlation energy E¢ uF is a very small quantity indeed - four 
orders of magnitude smaller than the exchange energy. When compared with the 
known results for the KS correlation energy E~ s --- E¢ or the QM one [Eq. (27)], 
it happens to be two orders of magnitude smaller. 
A small value of I AExI demonstrates that the total exchange energy, cal- 
culated in the HF method, quite accurately represents the exchange energy of 
HF 
KS method. Although this and all previous conclusions are drawn for n = ncs, 
= 
-n Ks because these two 
one may expect them to be valid also for n 
n~s = 
cs, 
densities (for a given system) are quite close. 
2.5 The Exact Ground State Problem Posed as the Hartree-Fock Method 
Taking into account the fact established in the previous section that E HF is close 
to E~ s = Ex and, on the other hand, that an exact expression for the exchange 
potential Vx = 6Ex/6n is not known, one may wish to modify the HF method in 
such a way that it would lead to the exact GS energy and density (Baroni and 
Tuncel [151). This can be easily obtained from Eq. (68) rewritten as 
Ts[n] + Ees[n] + Ex[n] = FnV[n] - EcnF[n], 
(86) 
and substituted into Eqs. (46), (47) and (53) to obtain 
HF 
HF 
E~s = min {FnV[n] + Eext[n]} = FnF[ncs] + Eext[n~s], 
(87) 
n 
where the effective external potential energy in this "corrected HF method" is 
defined to be 
HF 
E~, In] = E~xt [n] + Ec [n] - En~ v [n], 
(88) 
i.e. the bare external potential energy E¢~t, Eq. (16), corrected by the difference 
between the KS and HF correlation energy functionals. The exact GS problem, 
formulated as minimization in Eq. (87), can be solved, however, as a traditional 
HF method, via HF equations similar to (33), but with the bare external 
71 

A. Holas and N. H. March 
potential v(r) replaced there by the HF "effective" one 
HF 
~Eo,, In] 
,~(ec In] - E~ "~ In]) 
HF 
. 
vox,(r, [n]) = - -  
= v(r) + 
(89) 
~n(r) 
~n(r) 
One can be easily convinced that this "prescription" is correct, if one compares 
the variation of the functionals minimized in Eqs. (87) and (64); the last minimiz- 
ation being equivalent to that in Eq. (28), solved via Eq. (33). Because the 
effective external potential (89) depends functionally on n(r), an iterative 
method, leading to self-consistency, must be employed. 
The corrected HF method described above for the exact GS problem was 
discussed earlier, among others, by Parr and Yang [103 and termed by them the 
HF-KS method. However, the contribution of v~ v = 6E~F/fn to the effective 
external potential (89) was not included there. The consequences of such neglect 
are discussed below, see the paragraph starting a few lines after Eq. (94). 
It should be noted that the "correction" to E~xt[n] in Eq. (88) is nonpositive: 
Ec[n] - EcnF[n] < 0. 
(90) 
This follows from [see definitions (58) and (69)] 
E¢ In] - Ey E [n] = (F HK In] -- F KS [hi) -- (F rlr [hi -- F KS In] ) 
= 
<tl-'tHK [ n]I ~- q- ~/I t/tHK[n] 
> 
- <~/'~F[n] 1 ~" + q)l ~F[ n] > 
(91) 
and the fact that both 7"~V[n] and ~nK[n] are the minimizers of <J + q/>, the 
function ~gV[n] in a "narrower" space, see Eqs. (65) and (15). 
We are ready now to estimate the conventional quantum mechanical cor- 
relation energy E~ M defined in Eq. (27). Using Eqs. (87) and (64), we rewrite it as 
HF 
~FI-IF rnrtVq 
l-IF 
E QM = (FHF[n~s] + E~xt[nGS]) -- t 
L GSJ + E~xt[ncs]) 
17HF I-~HF1 
E 
F/,/HF1 
/'~ / f'~HHF12't 
-7. j.,ext LttGSJ -- 
extL GS.J -'~ ~'~'~L 
GSA ) 
E rnHrl 
ErtFrn HF1 
o~rfn HF12~ 
(92) 
= 
eL GSJ- 
c 
I_ GSJ "]- 
I,I- 
GSJ 
1" 
Functional Taylor series expansion of the functional minimized in Eq. (87), in 
powers of 6nn~F (r) 
,F 
= Inks(r) -- nos(r)] has been employed first, and Eq. (88) used 
in the last step. So E~ °u is close to KS correlation energy functional taken for the 
GS density of HF approximation, corrected by the (much smaller) HF correla- 
tion energy, and a small remainder of the second order in the density difference. 
The last quantity gives an estimate to the "large parentheses" term of Eq. (28) 
in [t2], 
By taking into account that E~ °M characterizes the {N, v} system, while N and 
v (within a trivial additive constant) are determined by the HF GS density n nvGs 
(an analogue of HK theorem), the QM correlation energy can be considered 
a functional of nnVGS (see Harris and Pratt [16]) 
EQM 
eQMr.nVl 
(93) 
= 
it., c 
LttGS J • 
72 

Exchange and Correlation in Density Functional Theory of Atoms and Molecules 
Thus Eq. (92) gives an approximation to this functional in terms of KS and HF 
correlation energy functionals. Rewriting Eq. (27) with the help of (93) and (64) 
we obtain 
envr..nr~ 
~QM r.rlF1 
(94) 
EGS = ~, 
LttGS j + L,¢ 
Lr~GS d, 
which demonstrates that if the functional E~ M In] is known, the exact GS energy 
for the given system can be obtained by performing a single HF calculation. 
Unfortunately, the true GS density cannot be obtained in this way, contrary to 
the corrected HF method in Eq. (87), which, however, requires a few iterations of 
the HF calculations to gain the self-consistency. 
Let us note that if the exact GS problem in the corrected HF form, Eq. (87), is 
approximated by a similar problem in which E~ F [n] is neglected in Eq. (88), and 
its solution for the energy and density is denoted by Ecs and hcs, then 
HF " 
EGS 
EGS + Ec [riGS] + O[(h~s -- nGs) 2] 
(95) 
holds, as obtained via the functional Taylor expansion of the functional mini- 
mized in Eq. (87), in powers of [hcs(r ) - riGs(r)]. So, because of the inequality 
(73), the considered approximation possesses a "lower-bound"-like property 
Ecs < Ecs, 
(96) 
and the above inequality should in practice be "sharp", because the second- 
order terms in Eq. (95) are expected to be small, as compared with the magnitude 
of the leading negative term HF 
E¢ . Unfortunately, the considered approximation 
belongs to "formal" ones, because the exact KS correlation energy functional 
E¢ [n] is not known. A practical and accurate approximation can be obtained, 
however, if besides the neglect of EcnV[n], the best modern approximation, say 
EAPP[n], for E~[n] is used in Eq. (88). As pointed out in [12] (see also Sect. 2.4), 
the neglect of E~ F leads to a small error (about 0.02% of E~), so the main error is 
now due to the difference EApP[n] -- E~[n]. Therefore the total error of such 
approximation may be expected to be significantly smaller than an error of 
analogous approximate use of the KS scheme, in which, besides the same 
approximation EAPP[n] for E¢[n], some approximation EApp[t'/] for the ex- 
change energy functional E~ In] must be applied, in order to have an explicit 
approximate expression for Vx(r;[n]), Eq. (57). 
2.6 The Optimized Potential Method 
This method is usually thought as an approach allowing one to find the exact 
exchange potential. It may be considered [171 as an approximation to the exact 
GS problem, similar to the HF approximation: namely, the solution of the 
optimized potential (OP) approximation - the energy E °P and the wave function 
~o~ _ stems from the following minimization problem 
E°~ = min (~fJ 
+ ~ + ~PI~3} = {~csl~°e 
,~ + ~ + ~ ~'Gs/-a~OP\ (97) 
73 

A. Holas and N. H. March 
Here q~, means such determinantal wave function, which is the GS function to 
a noninteracting N-electron system with some local potential vs(r) [see Eqs. (36) 
and (40)]. Obviously, spin orbitals ¢~(x) 
the solutions of Eq. (40) - and 
~0~ constructed of them, are functionals of the potential v~(r): ~ = q~[vs]. So 
Eq. (97) can be rewritten as 
E°~ = min <4~[v~] t~ + ~ + (~14~[v~]) 
s 
OP 
/q~ rv°P11~ + ~ + ~ Iq~D[vas]) 
(98) 
\ 
DL GSJ 
There are algorithms allowing one, for the given external potential v(r), to find 
the OP ov 
Vas(r) [i.e. the minimizer in Eq. (98)] via solution of an integral equation, 
and, subsequently to get cb °P 
~ Vv°P~ and 
oP 
Gs = 
D L GSJ 
EGS- Actually, in the case of 
spherical spin-polarized and general spin-unpolarized atoms, an algorithm is 
known (see e.g. [18]), which leads to accurate results, whereas for remaining 
systems, an algorithm yielding an approximate solution only is available (see e.g. 
in [19] and [20]). 
Owing to the HK theorem, applied now to a noninteracting problem, we 
know that the potential v#) is determined (within a trivial additive constant) by 
the GS density of the system [compare Eqs. (36), (37), and (35)]. So Eq. (98) can 
be further transformed to the form 
E°~ = min (¢~S[n] I~ + ~ + ¢[4~oKS[n] ). 
(99) 
n 
This can be finally expressed in terms of the following functional [see definitions 
(63) and (16)1 
.~KS[n ] = (eras[n] i~- + o?~ + ¢']q~S[n]) = FKS[n] + Eext[n]. 
(100) 
Therefore 
E °eas = min {FKS[n] + E¢~t[n] }, 
(101) 
n 
or 
E°~ = min ~KS [n] = ~_.'~ KS r- I_nGs_l 
.°P'l 
(102) 
n 
Two inequalities, connected with the OP-GS and HF-GS quantities are 
known [12]: 
oP 
o~KSrnnVl 
(103) 
EGS<-- 
I_ GS.I, 
EHF 
oP 
(104) 
~Gs < EGs. 
The first inequality follows immediately from minimization (102), while the 
second one holds due to the fact that the variational functional space involved in 
minimization (97) is narrower than in (25). 
By expanding ~KS[nHF] in a functional Taylor series in powers of [n~(r) - 
n ov ~r ~ 
ov 
nGs(r) we 
Gst J] around 
obtain from Eq. (102) 
,~KSI-.HFq 
__ 
OP 
HF 
/.IOP'I 2 "~ 
(105) 
t_"asJ 
Eas = O([nGs - 
~sJ p- 
74 

Exchange and Correlation in Density Functional Theory of Atoms and Molecules 
This gives an explanation to the finding of G6rling and Ernzerhof in their 
calculations [12] that "the equal sign practically holds for the relation (103)". 
Let us calculate now the variation of CKS[n], Eq. (100), using (63) with (34) 
and (57), 
(6Ts[n]6n(r) 
) 
diCKS[n] = ~ dSr \ 
+ v(r) + yes(r) + vx(r) 6n(r) 
(106) 
and compare it with the variation (49) of the noninteracting system energy 
functional (39). We conclude, that at minimum (i.e. at self-consistency), when (98) 
and (102) are equivalent, the following equality holds 
/) 
r ' 
oP 
/) 
r" 
oP 
v°~(r;[v]) 
v(r) + ~s(,[n~s]) + x( , [nGs]). 
(107) 
Because v(r) is given and vos(r) easily calculable from the known density, Eq. (34), 
the KS exchange potential vx(r) is readily available from the OP solution 
v 
• 
oP 
v°Ptr ~ It should be noticed, however, that this exchange potential x(r, [n~s]) 
-- 
GS~ 
f" 
differs slightly from the exchange potential v~(r; [ncs]) occurring in the exact 
GS problem solved by the KS method [see Eqs. (50), (51) and (56)1, because the 
hOP: , 
densities ostr) and n~s(r) are slightly different. 
2.7 The Exact Ground-State Problem Posed as the Optimized Potential Method 
Let us rewrite the exact GS problem in Eq. (62) in a form 
oP 
E(~s = min {F~S[n] + Eext[n] }, 
tl 
where 
(108) 
OP 
Eex,[n] = Eext[n] + E¢[n]. 
(109) 
Next, when we compare the variation of the functional minimized in Eq. (108) 
with that in Eq. (101), we conclude that the exact GS problem can be solved by 
algorithms of the OP method, if an OP "effective" external potential 
6E°P[n] 
v°~(r ;[n])- 
6n(r~ - v(r) + v¢(r; I-n]) 
(110) 
is used instead of the bare external potential v(r) in the original OP approxima- 
tion. Since this potential is a functional of the density (and, therefore, of the 
optimized noninteracting system potential vs), an iterative procedure, leading to 
self-consistency, must be applied. Such scheme is implicitly present in [201. 
At self-consistency, the optimum potential of this "corrected OP method" 
equals 
bCOP~. 
6s ~'; [v]) = {v(r) + re(r; [nrs])} + vos(r; [nrs]) + vx(r; [nrs]), (111) 
[see Eq. (107) with (110)1, i.e. it coincides with the effective one-body potential of 
the KS method, Eq. (51), at its self-consistency. 
75 

A. Holas and N. H. March 
It is worth noticing that a practical and accurate approximate scheme may 
be obtained from the formally exact corrected OP method described above, if 
the best modern approximations EcApP[n] and vApP[n] = 6EAPP/fn for E~ [hi 
and v¢ [n] are used in Eqs. (108) and (109). Such an approach to the exact GS 
problem should be more accurate than a similar approach to the KS method, 
because for the last, besides the correlation energy and potential, also the 
exchange energy and potential must be somehow approximated. 
3 Determination of the Exchange and Correlation Potentials 
from Accurate Many-Body Wave Functions 
As discussed in previous sections, reliable approximate expressions for exchange 
and correlation energies and potentials (as functionals of the density) are 
necessary to perform DFT calculations in practice. In order to check the 
accuracy of such expressions, one needs exact results for comparison. As an 
input for this program, some accurate many-electron wave function may be 
used, obtained from e.g. configuration interaction or Hylleraas-type calculations 
for a particular system. Having accurate GS density nrs(r) determined from such 
a function, the effective KS potential, Eq. (51), leading to this density, can be 
established numerically by various methods (see e.g. [21], [14], [22], [23], [24] 
and references therein). After subtracting the external and electrostatic poten- 
tials, the remaining Vxc(r; [nrs]) is obtained with high accuracy. Next, methods 
leading to its separation into the exchange and correlation contributions will be 
discussed. 
For the helium isoelectronic series, the exact exchange potential is known to 
be vx(r; [n~s]) = - ½yes(r; [n~s]), so, after subtracting it from vxc, an accurate 
v¢(r; [nGs]) is available in this case, see Umrigar and Gonze [25]. 
For more complicated systems, the exact Vx(r; [ncs]) may be estimated by 
nas (r) obtained from the HF 
applying the above discussed scheme to the density HF 
calculations (see e.g. in [21]). In this way the potential 
[ncs]) 
= 
[nas]) + V¢ (r, 
HF 
(112) 
vHV(r) 
vx(r; 
HF 
HF . 
is determined [see Eq. (70)], In view of the very small value of =nVr.nVq 
L, c 
kUGS.l as 
compared with Ex [see Eq. (85)], the corresponding potential v HF may be also 
n~s(r) and 
expected to be very small as compared to v~; further, the densities l-IF 
n~s(r) (for a given system) are quite close. Therefore v~nF(r) may be considered 
a good estimate of vx(r;En~s]). A quantitative estimate for the difference 
[os]) - Vx(r; [nGs]) exists for helium: it corresponds to a gap between the 
Ux(r ; n HF 
solid and dotted lines on Fig. 11 of [25]. Its value amounts to a few percent of 
vc(r; [n~s]). Yet another way to estimate Vx(r; [n~s]) from the results of HF 
calculations is offered by Eq. (219) of Sect. 5.5 below. The potential v,(r ;[nGs]) 
may be also estimated via OP calculations for a given system. From the 
76 

Exchange and Correlation in Density Functional Theory of Atoms and Molecules 
[nos]) 
determined optimum potential, Eq. (107), one immediately obtains Vx(r; 
oP 
(see e.g. [20] and [18]), which may differ only slightly from vx(r; [nos]) due to 
a small remainder O([n°~(r) - ncs(r)]). 
Finally, an exact vx(r;[nos]) may be determined in practice by applying the 
corrected OP method iteratively. In this case the correlation potential, deter- 
mining the effective external potential in Eq. (110) during (t' + 1)-th iteration, is 
defined as 
v(f + 1)(r) = vx¢(r ; [n~s]) - v~)(r), 
(113) 
where v~)(r) is the exchange part of the optimum potential v~e~(r) obtained in the 
E-th iteration: 
= v(e)(r) 
{v(r) + v~)(r)} 
ves(r; 
~') 
Vx(r; 
~e) 
-- 
- 
[nGS]) -- 
[nGS]) 
(114) 
[compare Eq. (111)]. Here n~)s(r) is the density obtained in the Y-th iteration. As 
initial conditions, 
(o) 
n°Ptr ~ and 
v~°)(r) 
vx(r; 
oP 
riGs(r) = GS~ ) 
= 
[nGs]) 
(115) 
should be taken. At convergence, 
(~) 
nGs(r) ~ nGs(r) and v~t)(r) --, Vx(r; [riGS]) 
- compare Eq. (114) and (111). 
4 Long-Range Asymptotic Form of Potentials 
4.1 Kohn-Sham Potential 
Knowledge of all terms of the KS potential in Eq. (51) for a large distance from 
an atomic or molecular center is interesting both for setting the proper asymp- 
totic behavior for the solutions of the KS equations (50), and for checking the 
accuracy of approximations for v~(r) and re(r) in this region, 
The external potential of a molecule having, as its framework, M nuclei of 
the charges Zs, fixed at positions Rs, is obviously 
M 
Zj 
v(r) = 
E 
s=l 
Ir- RjI" 
(116) 
So its large-r expansion is 
=---+O 
; Z= Z Z,. 
(117) 
r 
/=1 
The same expansion for the electrostatic potential (34) [u defined in (11)] is 
- 
= - 
+ o 
, 
(118) 
vos(r; In]) = r 
r 
where in the second step the constraint (3) was applied. According to Almbladh 
77 

A. Holas and N. H. March 
and von Barth [26], the exchange-correlation potential behaves as 
Vx~(r; [n])1 
(1), 
= - - + O 
(119) 
r 
where the exponent of the second term is p = 4 for a nondegenerate spin- 
unpolarized GS or for the spin-up potential of a spin-polarized GS, otherwise 
p=3. 
It should be noted that potentials vos(r) and vx~(r), being defined as a func- 
tional derivatives with respect to the density constrained by Eq. (3), are deter- 
mined with accuracy to arbitrary additive constant only. In each case this 
constant is fixed traditionally be requiring the potential to be zero at infinity, 
similarly as in the case of the Coulomb potential due to the nuclei, Eq. (116). 
The sum of the results (117) (119) - the asymptotic expression for the total 
KS potential 
= 
----+O 
, 
r 
where 
Zeff=Z-N+ 
1, 
(t 20) 
(121) 
- shows a spherical symmetry of its leading term, so any eigenfunction of the KS 
equation (50) possesses also this property and equals 
~KS(r) = Ciacpi~(r){1 + O(r-1)}, 
rpi~(r) = ra'°exp(--xiar), 
(122) 
with 
tCia = (--2/;KS) 1/2, ilia = Zeff/tQa -- 1, 
(123) 
where e~s is an eigenvalue corresponding to cKS, while Cia is a normalization 
constant. 
As proven in [26], the KS eigenvalue corresponding to the uppermost 
occupied KS orbital equals the negative of the exact ionization potential I. 
Therefore the density (41), in the large-r region, behaves as 
n(r) oc r2t~°exp(--2Kor){1 + O(r-1)} 
(124) 
with 
to0 = (2I)1/2; 
flo = Ze,/~Co - 1. 
(125) 
4.2 Exchange Potential for a Pure-State System in the Conventional DFT 
The long-range asymptotic form of the exchange potential, a constituent of the 
exchange-correlation potential (56), will be discussed in this and the remaining 
subsections. Since the known derivations of this form are very complicated and 
involve an analysis of an integral equation of the OP method (see, e.g. [17], [27], 
78 

Exchange and Correlation in Density Functional Theory of Atoms and Molecules 
[19]), it may be interesting to re-derive this form here in a simple and direct way. 
The most common case of a system having a nondegenerate GS (a pure-state 
system) is considered in the current subsection. 
As a starting point we take the formula (54) for the exchange energy 
Ex expressed in terms of the first-order DM ~,(x;x') -- 7KS(x;x ') [see Eq. (272), 
where the KS spin orbitals should be employed: ~bi(x ) = ~S(x; [n])]. With the 
help of Eqs. (18) and (268) with (273) for p = 2 we have 
Ex In] = Eee [¢2 In] ] - Ees [n] 
1 
• 
t 
¢. 
= - ½~ dxdx'~ 
~¢(x,x )7(x ,x), 
(126) 
with 
and 
N 
7(x;x') = ~ q6j(x)ga*(x') 
(127) 
i=l 
N 
n(r) : ~ ~(rs; rs): ~ ~ I~j(x)l z. 
(128) 
s 
s 
i=l 
The variation of the electron density (128) equals 
N 
6n(r) = ~ ~ (rkj(x)6e~*(x) + c.c.), 
(129) 
s 
i=1 
where variations t~(~j of spin orbitals may bc thought as induced by a variation 
of an effective single-particle potential, generating these KS orbitals (but this 
detail does not play any role in the further considerations). The variation of the 
exchange energy (126) can bc calculated in a similar way to be 
{~(x; x')6~(x'; x) + 6~(x; x')~(x'; x)} 
6Ex 
½ dx dx' 
= - 
- -  
~1 
2 ¢i(x')¢(x')~j(x)6~?(x) + c.c. 
½fdxdx'lr 
~'lj 
~=1 
(130) 
In the second step, after substituting the expression (127) for 7(x; x'), four terms 
were obtained in the integrand, reduced subsequently to two terms only by 
renaming integration variablcs x +-~ x', in two of four terms. Next, the Coulomb 
potential is expanded formally in a power series of r'/r: 
(131) 
Owing to the exponential decay of KS orbitals, Eq. (122), integrations over dx' 
79 

A. Holas and N. H. March 
are convergent for all terms of this series. The result of these integrations 
represents thus an asymptotic series in powers of 1/r. Its leading term, due to 
orthonormality of KS orbitals, is simply 61j, so 
1 
N 
6E~=--~d3rr{~j~=~(e~j(x)f~*(x)+c-c-)+O(1)} . 
(132) 
This variation can be rewritten with the help of Eq. (129) as 
6E~=-~d3rl{fn(r)+O(~)} 
(133) 
which means that 
- 
- + 0 
(134) 
6n(r) 
r 
- the same result as obtained in a different way in [171 or [27]. Let us note that, 
contrary to the papers mentioned, our derivation does not rely on a special role 
of the uppermost occupied orbital or on the presence (or absence) of a degener- 
acy of the uppermost KS eigenvalue. 
What is remarkable for the leading term of the result (134) is that its form is 
universal - the same for all possible finite systems, regardless of their number of 
electrons or the nature of their nuclear framework. It coincides with the leading 
term of the asymptotic expansion for Vx~(r), Eq. (119), which means that the 
correlation potential re(r) does not play any role in the asymptotic region. 
Owing to its universal form -1/r, vx(r) provides just the term + 1 in the 
expression (121) for the effective charge Z¢tt of the leading term of the KS 
potential in Eq. (120), thus allowing for an interpretation as the following simple 
physical picture: if one places one electron far away from nuclei and other 
electrons near nuclei, then the electron "sees" an effective charge Z,ff e, which is 
a sum of the total nuclear charge + Ze and the charge of all remaining electrons 
-(N - 1)e. 
4.3 Exchange Potential for a Pure-state System in the Spin DFT 
The spin DFT is formulated in terms of two electron densities: nt(r) and n~(r), 
corresponding to the spin-up and spin-down subsystems [see Eqs. (274)-(279), 
in which the KS orbitals should be employed ~bi,(r)- ~b~S(r; [n])]. The ex- 
change energy can be calculated according to Eqs. (55) and (21) with the pair 
correlation function h~ s given in Eq. (281), namely 
Ex[n~,n~]=~f-x .... L.-~J,l-nq' a= T, ~, 
(135) 
where 
1 
= 
- 
= 
_ 
r 
)po(r, 
r) 
E~o,,o[.o] 
E,o,,o[p,] 
½~ dsrdsr .
.
.
.
 
~ 
p,(r; 
(136) 
80 

Exchange and Correlation in Density Functional Theory of Atoms and Molecules 
with 
and 
Na 
• 
¢ 
q~io(r) ~bi,(r ), 
(137) 
p,(r,r)= 
Z 
* 
' 
i=1 
N~ 
n.(v) = p~(r;r)-- ~ IqS,,(r)l 2. 
(138) 
i=1 
Since Eqs. (136)-(138)for a particular subsystem a, in terms of orbitals ~bi~(r), 
look the same as Eqs. (126)-(128) in terms of spin orbitals ~bj(x), all steps leading 
to the previous result (134) can be repeated again, leading now to the spin- 
polarized exchange potential 
vx~(r) rEx[n~,n~JrE~xC~r°[n,,]l( 
1 ) 
= - - + 0 
(139) 
5n~(r) 
6n~(r) 
r 
~ 
" 
This result should be, of course, consistent with the result for the conventional 
DFT 
of a 
spin-compensated 
(paramagnetic) 
system characterized 
by 
n~(r) = n~(r) = ½n(r). From Eq. 035) its exchange energy can be written as 
E~ara[n ] 
I~f .... I-i 
"1 
= ~x 
L~nd + E~C,~O[½n] = "~JL~X'~ 
17ferroF 1L~njn, 
(140) 
while the exchange potential calculated in Eq. (134) is 
Vx(r) fE~'~[n]t3Ex[n] 
1 ( 1 )  
.
.
.
.
 
+ 0 
(141) 
6n(r) 
6n(r) 
r 
~ 
" 
On the other hand, differentiating Eq, (140) we obtain 
Vx(r) = 2 ~d3r ' ) "6Ef~°[a] 6~(r')~ 
= fiE f .... 
[~] 
__ 
1 +O (1) 
6.(0 
r 
' 
(142) 
where, in the last step, the result (139) was employed. As expected, the results 
(141) and (142) are identical. 
4.4 Exchange Potential for a Mixed-State System 
A mixed-state description of a given system (see e.g. in [10] or [28]) is necessary 
in such situations, among others, when the GS is degenerate and/or when 
a non-integer average number of electrons is of interest. The first-order spinless 
ensemble DM and the ensemble electron density, characterizing this system, are 
in a form 
p(r; r') = p~"S(r; r') + p~"S(r; r'), 
(143) 
n(r) = n~nS(r) + n]"S(r), 
(144) 
81 

A. Holas and N. H. March 
where 
with 
p~"~(r; r') = ~.l'j~io(r)¢j~(r ), 
(145) 
J 
n~"S(r) = Z f~-I q~j~(r) l ~, 
(146) 
J 
0_<~_< 1; ~.fj~=N~; 
N=N t +N+, 
(147) 
J 
[comp. Eqs. (137) and (138) for pure-state system]. The subsystem and total- 
system electron numbers A~ and N are allowed to be noninteger. It will be 
convenient to number the KS orbitals ~bj~(r) in each spin subsystem according 
to the following order of the corresponding eigenvalues 
gj~_< ~j+l,~, J= 1,2,.... 
(148) 
The expression for the exchange energy in terms of ~bjo and ~, used by 
Krieger et al. [19] can be neatly rewritten in a form 
= 
Ex 
[p~ J 
(149) 
Ex 
2 
~ferro 
ens 
~r 
[see definitions (145) and (136) for p~n~ and/~r,o]. 
For the variation of the density (keeping the occupation numbers fixed) we 
obtain from Eqs. (144) and (146) 
6n(v)= ~ 6n~'"(r)= ~fj~(4aj~(r)fc~*~(r + 
. 
(150) 
[comp. Eq. (129)], while for the variation of the exchange energy, from Eqs. 
(149), (136) and (145), we find 
1 
6Ex 
Yf 
½--°dxdx'l 
o 
- 
in a way similar to that leading from Eq. (126) to (130). Repeating next the same 
steps as done in Eq. (131) and below it, we arrive at the following analogue of 
Eq. (132) 
6E,=-~,d3r!{~f~,(4aj,(r)aqa*~(r)+c.c.)+O(!)} • 
(152, 
a 
~../ 
Contrary to the pure-state case, now 6E~ in Eq. (152) cannot be directly written 
in terms of 6n~ in Eq. (150), because, for fractional occupation numbers, the 
inequality f~, #.~, holds. However, due to the exponential decay of KS orbitals, 
Eq. (122), for r large enough (say r > R,), the density n~'~(r) in Eq. (146) is 
composed solely of contributions due to g. orbitals of the highest occupied 
82 

Exchange and Correlation in Density Functional Theory of Atoms and Molecules 
degenerate energy level era.: 
where 
nT~(r) = 
~ 
fm.~Id~m,~(r)l 
z, 
for r > R~, 
(153) 
m t 
m" =m--g.+ 
l,m--g~+ 2 ..... m 
am-go,.<em'~<a.+l,, 
and J~.=0 
for j>m. 
(154) 
For the variation of the KS orbital in the large-r form (122) we have 
SO 
6q~i.(r)/ Oi~(r) = 6Ci./Ci. + ln(r)difl~ - rfx~ ~_.~ - rrxi~, 
(155) 
6~bi,(r) = Ci,cS~oi,. for large r. 
(156) 
Therefore the variation of the density (153) in the large-r region is 
~n~n~(r) = [~ fm, ~ l C., ~12 ] 2qgm~(r)rtp.,~(r) , 
(157) 
because the radial part ~om,(r) is common for all 4~m,,(r). Similarly, Eq. (152) can 
be rewritten as 
rEx:--~ 
{,ra~.,}d3r!f[~f2,~lC.,~1212qgm~(r)t~q~m.(r) 
f remaining/ 
[ region 
J 
By comparing Eqs. (157) and (158) we obtain finally 
with 
rEx 
a~ 
e.~ 
= - -- 
for large r, 
(159) 
vx~ (r) = ,~nT~(r) 
r ' 
Em, f2,.ICm,~l 2 
a. = E,~, f,.'. ]Cm'.l 2" 
(160) 
It should be noted that the large-r region, where the result (159) is valid, may 
happen to be very distant when the energy level em-g.,¢ is close to the highest 
occupied level era. [see Eq. (154)]. 
For nondegenerate era. level (#~ = 1) the expression (160) simplifies to 
a. =fro., 
(161) 
giving thus in Eq. (159) the same result as obtained by Krieger et al. in [19] in 
a different way, while our result (160) allows for a generalization of their result to 
a degenerate situation. 
83 

A. Holas and N. H, March 
Concluding this subsection, we remark that the expression (149) for the KS 
exchange energy of a mixed-state system is only approximate. The exact expres- 
sion (204) is obtained in Sect. 5.4 and compared with the approximate one (149). 
The exact expression (236) for asymptotic v~"~ s is obtained in Sect. 5.6. 
However, expression (149) may be viewed as a definition of a specific 
exchange energy, say Ex App, (being thus somehow different from the KS exchange 
energy Ex[n] = EKS[n] -- Ees[n], where EeKe s in terms of KS DM n 2 is given in 
Eq. (18) as/~¢~[n2]). Then the difference Ex[n] - EApp[n] can be absorbed into 
the corresponding correlation energy contribution, because, actually, a total 
exchange-correlation energy only is defined for mixed-state functionals (see e.g. 
in [28]). 
Although Krieger et al. [19] quote Perdew's paper [29] as a source for the 
expression (149), but this expression happens to be an infinite-size system limit 
of a more general formula (Eqs. (115)-(117) of [29]) obtained by Perdew for 
a finite system. But even that formula is not exact, because contributions due to 
electrostatic interactions inside pure subsystems were not balanced there with 
the global electrostatic energy (see Sect. 5.4 for details). 
5 Exchange and Correlation Potentials in a Line-Integral Form 
5.1 Differential Virial Theorems 
A differential virial theorem represents an exact, local (at space point r) relation 
involving the external potential v(r), the (ee) interaction potential u(r,r'), the 
diagonal elements of the 1st and 2nd order DMs, n(r) and nz(r,r'), and the 1st 
order DM p(rl;r2) 'close to diagonal', for a particular system. As it will be 
shown, it is a very useful tool for establishing various exact relations for a many 
electron systems. The mentioned dependence on p may be written in terms of the 
kinetic energy density tensor, defined as 
- -  
+ - -  
p(r + r';r + r")l¢=r=o. 
(162) 
t~p(r:[p])= ~ ar'~ar'~ ar'#ar; 
This is a real, symmetric tensor, the trace of which is the non-negative kinetic 
energy density (scalar) 
3 
ttr; [p]) = ~ t,,(r; [p]) > 0, 
(163) 
~t=l 
leading to the global kinetic energy 
T-- <~ IJ'l~> = T[P] = ~ d3r t(r; [p]), 
(164) 
[comp. Eq. (17), its last form]. 
84 

Exchange and Correlation in Density Functional Theory of Atoms and Molecules 
The differential virial theorem, obtained by us in [30], has the form of the 
following identity 
n(r) 
v(r) + 2 S d3r'n2( r, r') 
u(r, r') - ¼ V 2 ~r~ n(r) 
+ 2~---~pt,p(r;[p])=O. 
(165) 
No assumptions concerning potentials u(r, r') and v(r) (like Coulombic charac- 
ter), unless they lead to bounded solutions 7" of the Schr6dinger equation [see 
Eqs. (10)-(12)] 
(~- + ~ + ~)71 = ET', 
(166) 
were involved in obtaining the relation (165). The reduced DMs occurring in 
Eq. (165): nz(r,V), p(r;r') and n(r) are generated from the normalized 7' by 
applying a reduction ofTN = 7"7"* [see Appendix A, Eqs. (265)-(270)]. It should 
be mentioned also, that no assumption concerning the nature (as GS or excit- 
ed-state) of the solution 7" or a degeneracy of its energy level E were invoked. 
The number N of the system electrons does not appear explicitly in Eq. (165). 
Furthermore, this equation is linear in DMs. All together, this leads to 
the conclusion, that the theorem remains true if each DM Pt is replaced by a 
_ (N2) 
"mixture" of pure-state matrices pt 
: 
Pr = Z Ps~PV ~) 
(167) 
u~ 
where the probabilities Psa satisfy conditions 
0< pu~< 1, 
~Ps~ = 1, 
(168) 
N2 
and where the index N denotes the (integer) number of electrons in a pure 
system, while 2 denotes a set of quantum numbers, characterizing its particular 
eigenstate. In this way Eq. (165) may be applied to ensembles with a noninteger 
average number of electrons, with a degenerate GS and in many other circum- 
stances. 
From the differential virial theorem (165) for interacting electron systems 
one can obtain immediately an analogous theorem for noninteracting systems, 
just by putting u = 0 and replacing the external potential v(r) with vs(r): 
-¼172 ~ 
0 
nS(r)-~r Vdr) 
ff~r n~(r) + Z Z ff~rpt,a(r; [p~]) = O. 
(169) 
This equation relates the single-particle external potential vs(r), the 1st order 
DMp~(ra;r2) and its diagonal element nS(r) for a noninteracting system. As 
previously, this matrix can describe a mixed-state system also, thus having the 
ensemble DM form (143) with (145) in terms of single-particle (e.g. KS) orbitals 
q~j,(r) and occupation numbers fj, [Eq. (147)]. 
85 

A. Holas and N. H. March 
The differential virial theorem (169) for noninteracting systems can alterna- 
tively be obtained [31], [32] by summing (with the weights f~,,) similar relations 
obtained for separate eigenfunctions ~b~,(r) of the one-electron Schr6dinger 
equation (40) [in particular the KS equation (50)]. Just in that way one can 
obtain, from the one-electron HF equations (33), the differential virial theorem 
for the HF (approximate) solution of the GS problem, as is shown in Appen- 
dix B, Eq. (302), in a form: 
~ 
17 2 
nnF(r) 
v(r) + 2 ~ dar'nnF(r, r') ~r~ u(r, r') - ¼ 
nnF(r) 
+ 2 Z ~r~ t'a(r; [onF]) = 0. 
# 
(170) 
Here nHF(r, r'), prtF(r; r') and nrlF(r) denote the reduced DMs generated from the 
GS HF determinantal wave function ~/%s,nF Eq. (25), in terms of the self-consistent 
solutions tpj(x) of the HF equations (33) (see appendix A for details). It is 
surprising that, despite the approximate (in the sense of the HF method) 
character of these DMs n2 aF, pnF and n nF for a given system, they satisfy the 
same relation with v(r) and u(r,r') as the exact DMs n2, p and n do [compare 
Eq. (170) with Eq. (165)]. 
Many interesting integral relations may be deduced from the differential 
virial theorem, allowing us to check the accuracy of various characteristics and 
functionals concerning a particular system (for noninteracting systems see e.g. in 
[31] and [32]). As an example, let us derive here the global virial theorem. 
Applying the operation ~ dar~, r, to Eq. (165), we obtain 
2T = ~ darn(r)r • Vv(r) + 2 ~ dardar'nz(r,r')r • Vu(r,r') 
(171) 
[Eqs. (163) and (164) have been used]. Eq. (171) represents the virial theorem in 
its most general form (see e.g. in Levy and Perdew [33]). In the case of 
Coulombic u(r,r'), Eq. (11), the second integral in Eq. (171) can be evaluated, 
using the symmetry of n2, to be -Eee. So, in this case, Eq. (171) gives 
2T + Eee = ~ darn(r)r • Vv(r) 
(172) 
- the familiar virial theorem for a Coulombically interacting system. 
5.2 Force Equations 
The differential virial theorems (165), (170) and (169), can be rewritten as 
Vv(r) = - f (r; [u, n, p, n2]), 
(173) 
Vv(r) = -- f(r; [u, n rlF, prtF, nHF] ), 
(174) 
Vv~(r) = --f~(r; In', p']), 
(175) 
86 

Exchange and Correlation in Density Functional Theory of Atoms and Molecules 
where the following "force" fields are introduced 
f(r; [u,n,p, n2]) 
= {--¼V lTZn(r) + z(r; [p]) + 2 ~ dar'n2(r,r')Vu(r,r')}/n(r), 
(176) 
f~(r; InS, pSI) =f(r; [0,nS, pS,0]) = {-¼V VZnS(r) + z(r; [pS])}/nS(r), 
(177) 
with the vector field [see Eq. (162)] 
z~(r; [p]) = 2 ~ ~rp t,p(r; [p]). 
(178) 
Eqs. (173)-(175) offer an interesting possibility to analyze in 3 dimensions only 
(instead of 3N dimensions) the inaccuracies of any approximate solution for the 
N-electron eigenfunction 7, by asking, what is the actual external potential 
which would lead to ~ as its exact solution. The gradient of this potential may 
be calculated in terms of the low-order DMs, generated from this 7 j, as the left 
hand side of Eqs. (173)-(175) and compared then with the gradient of the 
original external potential used for calculations. In particular, the quality of 
a solution in sensitive regions, such as those close to nuclei, at interatomic bonds 
or at large distances, is easy to visualize. The analysis discussed may be applied 
to full interacting problem solutions, Eq. (173), (e.g. from configuration interac- 
tion or Hylleraas type calculations), to HF method solutions, Eq. (174), and to 
KS or OP method solutions, Eq. (175). 
5.3 Exact Expression for the Exchange-Correlation Potential, 
Applicable to Mixed-State Systems 
Equation (173) may be viewed as a differential equation for the potential v(r). 
Because f(r) = - Vv(r), the force field f(r) is conservative. Therefore, it follows 
that the potential at point to, say, is the work done in bringing an electron from 
infinity to ro against the force field f(r): 
ro 
v(ro) = - ~ dr.f(r). 
(179) 
oo 
Since f(r) is conservative, the value of the line integral in Eq. (179) does not 
depend on the path of integration chosen. Note that Eq. (179) has been written 
such that v(~) = 0: a standard choice of gauge for the potential. Eq. (179) may be 
used for the analysis, mentioned in the previous subsection, of approximate 
solutions, to be performed now in terms of the potential itself, rather than its 
gradient. 
Using Eqs. (173) and (175), we are going to find an equation for the gradient 
of the exchange-correlation potential of the KS approach (the results of our 
investigation [30] will be recalled and generalized). Since these equations hold 
87 

A. Holas and N. H. March 
for mixed-state systems (for interacting and noninteracting cases, respectively), it 
is worthwhile to extend the definition (45) of Exc[n] to mixed-state systems, by 
considering FnK[n] and TKS[n] -~ Ts[n] to be defined for such systems. For 
that reason, minimizations (15) and (35) of (~ + o~) and (5") should be 
replaced by minimizations 
FHK[n] = inf Tr{~(J + ~)} = Tr{~nK[n](°ff " + ~)}, 
(180) 
TKS[n] = inf Tr{~J'} = Tr{~Ks[n] °if-}, 
(181) 
~n 
over such ensemble density operators ~, which yield the prescribed density n(t) 
via 
n(v) = Tr{~r~(r)}. 
(182) 
The operators 5Y-, ql, tl, occurring above, should be taken in the second-quantiz- 
ation form, free of explicit dependence on particle number, and "Tr" means the 
trace in Fock space (see e.g. [10] for details). Problems of existence and 
functional differentiability of generalized functionals F nK[n] and T KS[n] are 
discussed in [281; the functional FH~[n] is denoted there as FLIrt] or Ffr,c[n] or 
Ffr,~ In] (depending on the scope of ~), similarly for T Ks In]. Note that DMs can 
be viewed as the coordinate representation of the density operators. 
By requiring the density n~:S(r) of the equivalent noninteracting system of the 
KS method to be the same as the density nnK(r) of the original interacting system 
described by the HK formalism: nKS(r) = nnK(r) = n(r), the KS potential of the 
former system is given in Eq. (51), where v~c(r; [n]), defined in Eq. (52), corres- 
ponds to Exc[n], generalized above for mixed-state systems to be: 
Ex~[n] = Tr {~nK[n]j - + ~)} - Tr{~KS[n]~ } -- EesEn]. 
(183) 
So, keeping in mind the decomposition (51) of v~(r) = VKs(r; [n]), we subtract 
Eq. (173) from Eq. (175) to obtain 
g(v~(r) + v~¢(r)) =f(r; [u, n, p, n2]) -- fs(r; In, p~S]) 
(184) 
where pKs(r; r') is the first-order DM constructed, with the help of Eqs. (143) and 
(145), of KS orbitals ~bj Ks - the solutions of the KS equation (50), and the 
corresponding density n(r) = nKS(r) - with the help of Eqs. (144) and (146). But, 
using Eq. (34), we have 
Vv~(r) = I d3r'n(r') Vu(r, r'). 
(185) 
After subtracting Eq. (185) from Eq. (184) we arrive finally at the result 
Vvxe(r) = -fxe (r; [u, n, pgS, p, n2]) 
(186) 
with 
f~(r ;[u,n, pKS, p, n2])= {z(r; [pKS])--z(r;[p])+ S d3r'(Vu(r,r')) 
/
\
 
88 

Exchange and Correlation in Density Functional Theory of Atoms and Molecules 
(see Eq. (i78) for the definition of z). The force fieldf~c(r) is conservative because it 
stems from the potential vxc(r), i.e. f,~(r)= - Vvx,(r). Therefore, in complete 
analogy with Eq. (179) we have 
ro 
v~e(ro) = vx¢(ro; [n]) = - S dr.f~¢(r; [u,n, pKS, p, n2]), 
(188) 
oo 
where again the above line integral is independent of the particular path chosen 
for integration. The DMs n2, p and pKS are functionals of n, as obtained from 
the density operators ~HK[n] and ~[n], 
Eqs. (180) and (181), in the form 
Tr{~r~K~2}, Tr(~HK/~,} and Tr{~Ks/~:). 
Eq. (188) represents an exact expression for vx~(r) in terms of objects written 
explicitly as arguments of f~. Our construction of Vx~ covers such mixed-state 
situations as e.g. a degenerate GS, a fractional particle number, a mixture of the 
GS and excited states. 
By applying all above considerations to the HF method posed as the DFT in 
Section 2.4, where the equivalent noninteracting electron problem leads to the 
HF-KS equations (70), we obtain from Eqs. (174) and (175) 
HF 
. 
v~(~o; [n"~]) = v,(r0; [n"~]) + Vc (to, [n"~]) 
r0 
=_ 
~ dr.f~c(r;~ 
HF HF HF HF~, 
LU, n 
,P~s,P 
,n2 j), 
(189) 
o0 
where n HF, pHF and n~ IF are constructed of the HF orbitals ¢~ [the solutions of the 
HF equations (33)] while pr~ is constructed of the HF-KS orbitals ~HF [the 
solutions of the HF-KS equations (70)]; the densities are identical: nr~F(r ~ 
KS,, ! = nrtF(r). 
Eq. (189) represents an exact expression for the exchange-correlation potential 
HF 
. 
v~¢ (r, [nr~F]), Eqs. (57) and (71), occurring in the HF-KS theory (Sect. 2.4). 
5.4 Expressions for the Exchange and Correlation Energy of Mixed-State Systems 
We can generalize the partitioning (53) of the exchange-correlation energy for 
a pure-state system to an analogous partitioning for a mixed-state system, by 
adopting the following generalization of Eq. (54) for the exchange energy 
Ex[n] =- E~[n] = Tr {~KS[n]ql} - Ees[n] = E~[n] - Ees[n], 
(190) 
whre the ensemble density operator ~KS[n] is a minimizer in Eq. (181). Then 
Eq. (58), defining the correlation energy, is generalized to 
Eo[n] - E~ ~[n] = E~o[n] -/~x[n] 
= Tr{(~nK[n] -- ~KS[n])~" } + Tr{(~n~[n] -- ~[n])~ 
} 
= T~S[n] + U~[n], 
(191) 
where the ensemble density operator ~n~[n] is a minimizer in Eq. (180). 
89 

A. Holas and N. H. March 
The exchange energy Ex[n] and the components T~S[n] and u~S[n] of the 
correlation energy written in terms of the ensemble DMs, corresponding to the 
above density operators, are 
Ex[n] = ~ d3rd3r'u(r,r'){n~S(r,r ') - ½n(r)n(r') }, 
(192) 
Tc[n] = THK[n] - TKS[n] 
= ~[pnK _ pKS] = ~ dar ~ t~,(r; Ep nK - pKS]), 
(193) 
~t 
UcEn] = E•?En] - E~S[n] = ~ dard3r'u(r,r'){n~'(r,r ') - n~S(r,r')}. 
(194) 
In order to have an expression for the mixed-system exchange energy (192) in 
terms of the single-particle KS orbitals qS;,(r), we need such an expression for the 
ensemble DM nz Ks - the diagonal of p~S. When the ensemble density operator 
~KS[n] is characterized by the following decomposition into its pure-state contri- 
butions 
~KS [n] = Y'. FU;.~Ks"KSo5 
(U~I LnJ 
~ ~ , 
(195) 
N2 
then analogous decomposition holds for DMs. In particular 
= 
pN~,v.s,2~-,r'), 
(t96) 
N2 
[comp. Eqs. (167) and (168)]. Because t, Ks,2 of Eq. (196) is a pure-state sec- 
ond-order DM of a noninteracting system, it can be written (see Appendix A) in 
terms of the first-order spin-polarized idempotent DMs 
p~)(r;r') 
~, 
(s.~.) 
* 
, 
= 
Oj, Oj~(r)~j,(r ), 
(197) 
J 
with occupation numbers 
(.uz) = 0 or 1; V 0 (N~) 
tv (Nx)" N~ N*) 
N] N*) 
,~ 
z_, J~ =_,~ 
, 
+ 
= N, 
(198) 
J 
where N~ Na~ and N are integers. According to Eqs. (280) and (281) we have for the 
pure-state DM 
nKs,2(r,r ) = ½ 
P~ 
~., 
-- 
(N'~4 (Iv, tv"12"i . 
(199) 
½{ip~'~%,;,-')l 
~ + 
p~ 
• 
) 
Therefore the ensemble DMs n~ s and pKS for a mixed system described by 
Eq. (195) are 
n~S(~, r') = Y', .Ks ~(~ ,. ~,~ 
(200) 
pNAr~KS. 
2~./~ I 
I~ 
pKS(r; r') = ~ p~Sp~Z)(r; r'), 
(201) 
90 

Exchange and Correlation in Density Functional Theory of Atoms and Molecules 
where [see (197)] 
p~Ss~)(r ; r') = Z p~)(r ; r'). 
(202) 
t7 
Alternative forms of the ensemble DMs pKS __ p and p~S _ p~,S are given by 
Eq. (143) and Eq. (145) with the occupations 
f~, 
~ _KS,~N~) 
(203) 
~- 
I.)N2Uja 
, 
N2 
and of the ensemble density n(r) by Eq. (144) with (146). 
Thus, the mixed-state exchange energy (192) in terms of orbitals is 
Ex = E~x s = ~ d3rdZr'u(r,r'){q,(r, r') + q,(r,r') + qt,(r,r')}, 
(204) 
where 
with 
qa(r, r') = -- ½ ~ Fajj, (oj.(r)c~*a(r')q~j,.(r')q~*,.(r) 
jj, 
2 
t 
2 
+ ½ ~ a~jj, Iq~j~(r)l Iq~j,o(r )l , 
(205) 
jj" 
qt + (r,r') = ~, Gr +jj, lc~jT(r)121q6j,~ (r')l 2 , 
(206) 
jj' 
F, jj, = ~ pNao j,-KS'~Nz)'~Nz)t~j' 
, , 
(207) 
52 
G,r,r,jj, 
~ 
KS ,a(N;.),a(N2) 
= 2., pu~ej,, vj,,,, -fj,,fj,,,, 
(208) 
N2 
[see Eq. (203) for f~,]. The contribution to Ex in (204), in a form of the sum of all 
terms having G,,,#, as coefficients, represents a difference between the weighted 
sum of electrostatic-type energies of pure-state subsystems and the global 
electrostatic energy, present in the definition (190). We note that, contrary to the 
pure-state case in Eq. (135), the exchange between opposite spin electrons 
too takes place in the mixed-state system, due to the qr+ term in Eq. (204). The 
approximate expression (149) for the mixed-state system exchange energy, 
discussed in Sect. 4.4, corresponds to F, rjj, replaced by fj, fj,, and G,,,jj, replaced 
by 0 in Eqs. (205) and (206). 
Concerning the separation of the exchange energy Ex from the total ex- 
change-correlation energy 
Ex¢[n] = Ex[n] + (T~S[n] + U~SEn]), 
(209) 
we see that, in order to obtain Ex alone, it is enough to neglect the differences 
between the interacting-system DMs and corresponding KS (equivalent non- 
interacting-system) DMs in the expression for Ex¢, i.e. to neglect (p - pKS) in the 
expression (193) for 
KS 
T¢ , and (n 2 -- n~ s) in the expression (194) for UcKS. 
91 

A. Holas and N. H. March 
5.5 Approximate Expression for the Exchange Potential 
Now we adopt the above observation, concerning Exc and E~, in order to split 
the exact expression for vx¢ in Eq. (188) into the sum of v~ pp and vapP; interpreting 
these terms as approximate exchange potential and approximate correlation 
potential, respectively. Thus 
Vx¢(ro; [n]) = v~PP(ro; In]) + vaPp(ro; In]) 
ro 
ro 
= - 
~ dr.fx(r)- 
S dr.fc(r), 
(210) 
where the force fields are given by 
fx(r) = f~(r; [u, n, nzXS]) 
= -- {2S d3r'[Vu(r,r')] 
[nKS(r,r ') -- ½n(r)n(r')]}/n(r), 
(211) 
L(r) =L(r; [u, n, p -- pKs, n2 -- nKS]) 
= --{z(r; [p -- pKs]) + 2 j" d3r'[ Vu(r, r')] [n2(r,r') - n2r'S(r,r')]}/n(r). 
(212) 
Although we know that the total force field f~c is conservative, we lack such 
knowledge concerning the separate pieces fx or f~. Therefore some specific path 
of integration must be chosen to complete the definition (210). Seemingly the 
most natural path is along the radius on which the point ro lies. As the center of 
the coordinate system a position of the nucleus is chosen in the case of single-ion 
system, the center of symmetry for a symmetrical molecule, and some 'inner' 
point for molecule or cluster with lower symmetry. Then 
v~PP(ro; In]) = ~ dr e.f~(re); 
e = ro/ro. 
(213) 
ro 
The same path must be used for the calculation of v~ pp in order to leave the sum 
vx¢ unchanged. 
Using the separation of the pair-distribution function n~ s into its uncor- 
related and correlated parts, Eq. (284), and noting that the combination 
px(rl, r2) ---- h~S(rl, r2)n(r2) 
(214) 
is customarily called the exchange hole at r 2 of an electron at rl, we rewrite 
Eq. (211) as 
fx(r) = -~ d3'rpx(r,r)Vu(r,r').' 
(215) 
For the case of Coulombic u(r,r'), as in Eq. (11), Eq. (215) leads to 
(r - r') 
(216) 
fx(r) = ~ d3r'px(r,r ') Ir - FI a. 
We recognize f~(r), given by Eq. (216), to be identical with the force field 8x(r) 
92 

Exchange and Correlation in Density Functional Theory of Atoms and Molecules 
proposed by Harbola and Sahni [34] (in their exchange-only version). This 
means that our approximation v]PP(r) to the exact Vx(r) coincides with the 
Harbola-Sahni approximation. Since these two approximations were derived by 
using completely different reasoning, their coincidence strongly enhances expec- 
tation that this function is very close to the exact vx(r). See [35] for the latest 
review of the Harbola-Sahni work formalism approach to the theory of elec- 
tronic structure. 
The line-integral approximation v~PP(r;[n]), Eq. (213) with (211) or (2 t6), to 
the exact vx(r; [n]) seems to be especially accurate. First of all, its asymptotic 
behavior for pure-state systems is the same as the behavior of the exact vx in 
Eq. (134), therefore guaranteeing the proper asymptotic form of KS orbitals. 
Next, it satisfies exactly the Levy-Perdew [33] identity 
E~[n] = - S d3r n(r)r. Vvx(r; [n]), 
(217) 
and the scaling identity 
v~(r; [nz]) = 2Vx(2r; [n]), 
(218) 
where the scaled density is defined as nz(r)= •3n(2r). 
All three issues were 
discussed in [30]. Extensive numerical investigations, for various atomic sys- 
tems, of vx~PP(r) understood as the Harbola-Sahni exchange-only potential (see 
[35] and references therein), demonstrate that it is very close to the exact v~(r), 
reconstructed by means of OP methods. Therefore this approximation for the 
exchange potential, when used within the KS equations together with some 
available approximation for the correlation potential, should lead to a very 
accurate GS density and energy. It is worth noting about such scheme that: (i) it 
may be applied for various mixed-state problems (see Sect. 5.4), (ii) both Ex and 
Vx app are expressible [via n2KS(r, r') and n(r), Eqs. (192) and (211)] in terms of KS 
orbitals and their occupation numbers (see Sect. 5.4) (iii) the form of the 
expressions mentioned indicates, that there is no need for a Coulomb self-energy 
correction (a serious difficulty in the case of other approximations to the 
exchange potential and energy). 
The line-integral expression (189), for the exchange-correlation potential of 
the HF-KS approach in Sect. 2.4, offers an interesting way to reconstruct the 
exchange potential for a given system, from the known HF solution for this 
system. Being alternative to schemes discussed in Sect. 3, this method provides 
an expression for the exchange potential solely in terms of the HF orbitals in the 
form 
HF 
Vx(ro; [n]) ~ vxc (ro 
roe; [tiHF]) 
S dre. f~c(re; I_I-u, tirlF, t,.rlF, k,.HF, tirlF-I 
;2 3/, 
(219) 
r0 
[the path along the radius, as in Eq. (213), is chosen]. Besides neglect of small 
terms of the order of O([n - 
titlE]) (what is done also in all other schemes), here 
the difference between DMs pnF and l-IF 
PKS has been neglected, as compared with 
93 

A. Holas and N. H. March 
the exact expression (189). In order to interpret this approximation, let us 
consider such replacement of uv 
pHF 
PKS by 
applied to 
E~V[ nnv] = Ex[ -nHv] + EcHF[nHF], 
(220) 
expressed also in terms of u, n HF, ..F .nF n.V 
~'KS,~" , 2 • It would mean neglecting A T [the 
kinetic energy term of the HF correlation energy, Eqs. (69) and (72)] hut 
retaining AEx [the interaction energy term, Eq. (76)]. Because both A T and AEx 
are very small [see Eqs. (84) and (85)], therefore Eq. (220) in the approximation 
discussed results in Ex[n nv] with high accuracy. By analogy, the line integral 
(219) is expected to give Vx(ro; [nHV]) with high accuracy. 
5.6 Alternative Formulation of the Kohn-Sham Approach Generalized 
for Mixed-State Systems 
The traditional partitioning of the KS electron-electron interaction energy into 
the sum of the electrostatic and exchange energy is rooted in the fact, that the 
DM n~S(rl, r2) = nD(rl, r2), giving the electrostatic plus exchange contributions 
[comp. Eqs. (192) and (190)], splits for pure-state systems into ½n(rl)n(r2) and 
-½{IpT(rl;r2)l 2 + Ipx(rl;r2)l 2} [as is given by Eqs. (280) and (281)]. But there 
is no such natural splitting for the ensemble DM n~ s of a mixed-state origin. The 
resulting expression (204) for the exchange energy is quite complicated. There- 
fore it seems worthwhile to consider an alternative formulation of the KS 
approach, in which a sum of these two contributions is treated as a whole 
[comp. Eq. (190)]: 
e~S[n] = Tr{~KS[n]~} = {Ees[n] + Ex[n]}, 
(221) 
and, accordingly, 
6E~S[n] 
KS 
. 
Vee (r, [n]) 
-
-
 
-- {Yes(r; [n]) + vx(r; [n])}. 
(222) 
~n(r) 
In the coordinate representation, Eq. (221) takes the form 
E~ s[n] = gee [n2 Ks] = ~ dSr dSr'u( r, r')n~S( r, r'), 
(223) 
and, using Eq. (200), the form 
EKS[n] 
~.KS~ r.(N~) 7 
(224) 
= 
/ ~FN2L~eeLr~KS, 
21 , 
N~, 
. 
(N2) 
where - ~Na~ is given in Eq. (199). This form oI nKs, 2 demonstrates a cancellation 
t/KS, 2 
of the self-interaction terms for each pure-state subsystem separately. 
The decomposition (224) of E~ s into its pure-state contributions allows us to 
find the long-range expansion of its functional derivative, using previous results 
94 

Exchange and Correlation in Density Functional Theory of Atoms and Molecules 
(118) and (134) obtained for pure-state systems: 
= 
d3ra" 
 
'(r) 
+ - -  
= I d3r 
+0 
75 
(g -1) r" Ks~ (Nx), r, 
(225) 
2 
According to Eq. (201), the variation of the density n(r) = pKS(r; r) is 
an(r) = ~, eNa""Ks~KSx"(N~)t'~t'*. 
(226) 
N2 
Let us consider first the case of a system which is a mixture of pure states, 
including both GS solutions (many, if the GS energy is degenerate) and excit- 
ed-state solutions, but having the same (integral) number N of electrons. As the 
summation over N is absent now, we recognize an(r) to be present in Eq. (225) 
and therefore find 
aE~S[n]N--I 
(1) 
- - - - - + O  
; at(p~S =0forN'¢N). 
(227) 
an(r) 
r 
-~ 
This result for the considered class of mixed-state systems happens to be 
identical with the result for a pure-state system with the same number of 
electrons. 
In order to handle the case of a system which is a mixture of pure states 
corresponding to various numbers of electrons, we must consider such large-r 
region, where the density is predominantly composed of the contributions due 
to the orbitals of the highest occupied energy level [see Eqs. (153)-(157)] with 
the occupations given by (203) because of the decomposition (197). Thus 
(~V 0 (N~) 
} 2¢p=.(r) 6q>,..(r), 
for 
> R.. 
(228) 
= 
.,. 
IC.,.l 
2 
r 
After substituting this expression into Eqs. (226) and (225) [and separating in the 
last equation the large-r region of integration, similarly as in Eq. (158)] we arrive 
at the following results: 
(i) for the spin DFT, where ~0r, r (r) ~ ~p,~ (r), because of a spin-dependent KS 
potential: 
where 
aEee[nt,n~] _ (N)m ~ - 1 
6n~(r) 
r 
, for large r, 
(229) 
-KS 
KS 
, 
= 
v,.,~ Cm,~l 2 
2 
m' 
(230) 
(231) 
95 

A. Holas and N. H. March 
(ii) for the conventional DFT, where q~mr(r)= q~m,(r)= ~o,,(r), because of 
a spin-independent KS potential: 
where 
6Go[hi 
(N). 
- 1 
6nO') 
, for large r, 
(232) 
} 
= 
P~m~ 
PNm, • 
(233) 
Results (229) and (232) can be also represented as a sum of the total electrostatic 
and total exchange contributions. For the first contribution we have I-comp. 
Eq. (118)] 
.
.
.
.
 
+ O 
(234) 
6n(r) 
6n~(r) 
r 
where 
So 
with 
I 3r'n(r') 
2 
Ks 
= 
= 
PN2 I d3r'n(K~2)(¥') 
2 
N Z 
KS 
= 
PN~ • 
N2 
N 
2 
(235) 
6Ex 
A,. 
(ii) 
6Ex 
A 
for large r, 
(236) 
(i) 6n~(r) - 
r ' 
gn(r---~ -- - r; 
A,= 1 + lV-(N)mo; 
A= I + N-(N)m. 
(237) 
We see that the coefficient A, obtained from the exact expression (224) for 
Ece = Ees + Ex is different from a,, Eq. (160), obtained from the approximate 
expression (149) for EI. 
The effective KS potential VKS(r; In]) in the present formulation is 
KS 
. 
VKs(r; [n]) = v(r) + v¢e (r, [n]) + re(r; In]), 
(238) 
which follows directly from Eqs. (51), (56) and (222). Eq. (184) can be rewritten as 
V(vcKS(r) + vc(r))= -- { fee(r) +f~(r)}, 
(239) 
where 
fee(r) =fee(r; [u,n,n~S]) = - 2{~ d3r'(Vu(r,r'))nKS(r,r')}/n(r), 
(240) 
and f¢ is given by Eq. (212). From Eq. (239) the following exact expression for 
the "internal" potential term of VKS [i.e. due to all (ee) interactions] is obtained 
ro 
KS 
. 
ve~ (ro, [n]) + v~(ro, In]) = - ~ dr. { ft,(r) +f~(r)}, 
(241) 
oo 
valid for an arbitrary path of integration. Repeating arguments of the previous 
96 

Exchange and Correlation in Density Functional Theory of Atoms and Molecules 
subsection, it may be regarded as a sum of two approximate terms 
KS 
. 
app 
. 
vapp(ro; 
Vee (ro, [hi) -{- Vc(ro; In]) = Vee (ro, [n]) + 
In]), 
where 
(242) 
v~a~PP(ro = roe; In]) = ~ dr e. fee(re; [u, n, n~S]), 
(243) 
re 
v~PP(r0 = roe; In]) = S dr e. fc(re; [u,n,p HK - pKS, nnzK -- n~S]). 
(244) 
ro 
In terms of the previously defined approximation (213) we have 
v.ppt,. In]) = yes(r; In]) + v]PP(r; In]) 
(245) 
because the integration of the electrostatic contribution gives an exact result on 
an arbitrary path. 
Similarly as in the case of the energy E~ s in Eq. (224), the potential v~ p can 
be written as a sum of contributions connected with pure states because, with 
the help of Eqs. (200) and (240), the force of Eq. (243) has the form 
n(N~)tr~ 
f~e(r; [u,n,n~S]) 
~ 
Ks Ks ~ ~ :tNZ)tr ~ 
= 
Pu~ ~,ee 
,,, 
¢246) 
N,~ 
where 
,.- 
(N2) (N~.) 1"~ 
f~(r) 
= f~o(r; Lu, nKs , nKs, zJJ 
(247) 
is the KS (ee) force due to the pure N2 state alone. It is interesting to note that 
the weighting factor, present in the decomposition (246) of the force f~e into its 
pure-state components, is a product of the probability Ks 
PN~ and the r-dependent 
ratio of densities n~)(r)/n(r). Because of this r-dependent factor, the approxim- 
ate potential v~rP(r), Eq. (243), cannot be equal to a weighted sum of correspond- 
ing potentials generated by pure-state subsystems. 
In practice, the majority of KS calculations for pure-state systems is per- 
formed with E~S[n] of Eq. (221) and Ks . 
Vee (r, [n]) of Eq. (222) approximated by 
Ees[n] + ExApP[n] and by ve~(r; [n]) + VxAPP(r; [n]), where ExAPP[n] denotes here 
a particular approximation to the exchange energy functional, e.g. in the local 
density form [fourth term in the TFD energy functional (1)] or some form of 
more sophisticated generalized gradient approximations, and the corresponding 
potential is v~PP(r; [n]) = 6EAxPP[n]/rn(r). The decompositions (224) and (246) 
suggest the following approximations for mixed-state systems, as analogues of 
the above-mentioned approximations: 
Z pN~{eos[nKs ] + e~P"[n~']}, 
(248) 
Vee (ro = roe; In]) ~. 
dre. fA~P(re), 
(249) 
ro 
97 

A. Ho|as and N. H. March 
where 
.,,s 
v){vos(,.; 
+ 
f~PP(r)= Zeu:~ n(r) ~-- 
NJ. 
(250) 
5.7 Approximate Correlation Energy and Potential of Some Mixed Systems 
The correlation energy of a mixed-state system is given by Eq. (191) with (193) 
and (194), where pKS and n Ks are given by Eqs. (20t) and (200), while pnK and 
n HK are 
pHK(r; r') = ~ .HK ~(NA), 
VNA PHK IF; g'), 
(251) 
NA 
= E 
. 
,. 
t'~A'mK, 2~r, r 1, 
(252) 
NA 
as corresponding to the density operator ~nn[n] of Eq. (180) decomposed as 
~HKI-r/] = Z FNA"HK c~(NA)~z' 
HK L-/r"l, 
(253) 
NA 
where A denotes a set of quantum numbers characterizing a particular eigen- 
state ~NA(X~ .... XN) of the interacting N electron system. Then p~) and 
n(NA) 
. (NA) 
HK,2 are obtained by reduction of the N-th order DM ?HK, S = 7S = ~NA~A 
['see Eqs. (265)-(269) of Appendix A]. 
In some applications, such mixed-state systems may be of interest, for which 
their interacting and equivalent non-interacting pure-state systems are de- 
scribed by the same sets of quantum numbers, {A} -= {2}, and they are decom- 
posed in Eqs. (253) and (195) with the same probabilities: 
.K 
KS 
(254) 
Pm =PNa 
for allN2. 
Then the exact correlation energy has a form similar to (224), namely 
E~[n] 
"C ~KS ~,IN~J 
(255) 
where 
" 
# 
r -tN~t -- ,~;½] 
(256) 
is the correlation energy due to the pure N2 state alone. 
The decomposition (255) of the correlation energy [for mixed-state systems 
satisfying Eq. (254)] into its pure-state components suggests the following 
approximation for these systems 
Ee '~ E .KS IUApp F.(N~-)I 
(257) 
/JN;tL, e 
LI~KS -I , 
in terms of any available approximation EfPP[n] to the correlation energy 
functional known for pure-state systems. 
98 

Exchange and Correlation in Density Functional Theory of Atoms and Molecules 
Here the density of the N2 state of the noninteracting system 
n~s~)(V) = p~sX)(r ; r) = y" p~a~(r ; r) 
(258) 
(t 
has been chosen to represent this state, because it is available within the KS 
approach. Another possible choice - the density n~)(r) of the N2 state of the 
interacting system - cannot be determined within the KS scheme. These two 
densities may be different, in principle, although quite close. But the ensemble 
densities must be equal, according to the definition of the equivalent nonin- 
teracting system: 
VNZ"KS [rJ 
nrfK(r) 
2 
HK. (NA)z x 
= 
= 
pNAnHK Iv). 
N2 
NA 
(259) 
For mixed-state systems satisfying Eq. (254), the force (212) of the approxim- 
ate correlation potential (244) can be rewritten with the help of Eqs. (251), (252), 
(201) and (200) as a weighted sum 
n(Ua)t,~ 
KS ~,~! 
f~(r; [u, n, pnK _ pKS, nznK _ n~S]) = Z p~S ~ 
f~Nz)(r), 
(260) 
NX 
where 
f~Nz)(r ) 
,,, 
~ 
(N~) ~u~ 
~(uz~ .(N~) _ n~)2] ) 
(261) 
=J~tr; [-U, nKS ,PHK -- PKS ,"HK, 2 
is the correlation force due to the pure N2 state alone. Due to Eqs. (246) and 
(260), the total force (fee + f~) occurring in the expression (241) for the internal 
potential (re Ks + re) of VKs is decomposed into pure-state contributions as 
n(N2~ 
.KS KS (r) ~ r~¢r~ 
Ae(r) +L(r) = ~ vuz n-n-n-n-n-n--~- ~'"" '' +f~uz)(r)}, 
(262) 
N2 
With the force (262) and its components (247) and (261), Eq. (241) represents an 
exact expression for the internal potential, applicable to the mixed-state systems 
satisfying Eq. (254). 
The form (260) of the correlation force suggests the following approximation 
for it in terms of the approximation E~PP[n] to the correlation energy functional 
for pure-state systems, used already in (257): 
 tr) 
s:..(.) 
2 
Ks 
, 
= 
PNz ~ 
(- V) 
(263) 
which leads to the approximation for the correlation potential 
v~PP(ro = roe; [n]) = S dr e. f~PP(re) 
(264) 
rO 
written in terms of the KS orbitals. If, besides the above approximation for the 
correlation potential, Ve Ks is also approximated in the form of (249), their sum can 
be evaluated as a common line integral involving the force (f~gP +f~PP). 
99 

A. Holas and N. H. March 
While there is no way to estimate a priori the accuracy of the propositions 
(257) and (264), it would be interesting to compare the quality of the results 
obtained in calculations using the correlation energy in the form of(257) and the 
correlation potential in the form of (264), including the force (263), with the 
results of analogous calculations using just E App [/e/] and 6E App [/'/]/l~/q (r). 
6 Summary 
The notion of the exchange energy as the nonclassical part of the electron- 
electron interaction energy evaluated in the HF method [Eq. (32)] and of the 
correlation energy, as a difference between the exact GS energy and its HF 
approximation [Eq. (27)] evolved during the development of the DFT from 
a collection of separate numbers, characteristic for particular systems, to univer- 
sal functionals of the density, Ex In] and Ec In], defined precisely within the KS 
approach [Eqs. (54) and (58) for pure-state systems, and (190) and (191) for 
mixed-state ones]. As discussed in Sect. 2, their meaning is, in general, retained, 
and their values [for n(r) = n~s(r) 
the density of a given system] are close to 
original ones. Their functional derivatives - potentials - are important ingredi- 
ents of many calculational schemes leading to the solution of the GS problem. 
However, as demonstrated in Sects. 2 and 3, the potentials occurring in various 
approaches differ slightly due to (minute) differences in the densities determined 
there and due to the inherent approximations of these approaches. 
Long-range asymptotic properties of KS orbitals were recalled in Sect. 4, as 
dictated by asymptotic properties of all potentials of KS equations. A new, 
simple and direct method was applied to obtain the asymptotic form of the 
exchange potential. For pure-state systems the known results were confirmed in 
Sects. 4.2 and 4.3, while for mixed-state systems a new, exact result was obtained 
in Sect. 5.6. 
Many interesting results of the paper are based on differential viriat the- 
orems. The theorem (165), pertaining to the exact N-interacting electron sys- 
tems, was taken from our previous work [30]; that (169), pertaining to the 
noninteracting electron systems, was obtakned from the previous one by remov- 
ing the interaction; while the theorem (170), concerning the HF solution, was 
obtained here in Appendix B. These theorems happen to be general enough to 
describe mixed systems of any complexity. The major result of the present study, 
obtained from these theorems, is the line-integral formula (188) for the ex- 
change-correlation potential vxc(r) for mixed-state systems, in terms of the 
quantities directly derivable from the second-order DM of the interacting 
system, of the first-order DM of the noninteracting (KS) system, and of the 
electron-electron interaction potential. The simplification in which the interac- 
ting system DMs are replaced by the independent-particle KS equivalents 
(which means neglecting correlation) leads to the approximate exchange poten- 
100 

Exchange and Correlation in Density Functional Theory of Atoms and Molecules 
tial v~,PP(r) in line-integral form (213) with the force (215). For the Coulombic (ee) 
interaction u(r,r') [the force is (216)], this potential is then found to coincide 
with the Harbola-Sahni exchange-only potential of their work-formalism ap- 
proach (see [34] and [35]). 
The decompositions (224) and (246) of the electrostatic-plus-exchange energy 
and force for arbitrary mixed-state systems, into their pure-state components, 
suggest analogous decompositions (248) and (250) for approximations in terms 
of any approximate exchange energy functional known for pure-state systems. 
Similarly, the decompositions (255) and (260) for the correlation energy and 
force, for mixed-state systems satisfying (254), suggest approximations (257) and 
(263) in terms of any approximate correlation energy functional for pure-state 
systems. We expect that these approximations for the exchange and correlation 
energies and potentials may allow one to obtain better results than previously in 
the KS-type calculations for mixed-system problems. 
7 Appendices 
7.1 Some Properties of Density Matrices 
The N-th order density matrix (DM) generated from a normalized wave func- 
tion ~ of a N-electron system is defined as 
¢ 
P 
~ 
t 
t 
~]N(Xl ..... XN; Xl ..... XN) ~- ~//(Xl ..... XN) 1II 
(Xl ..... XN). 
(265) 
The p-th order reduced DM (for p < N) is given in terms of it (see e.g. ref. [10]) 
as 
..... xp;x'l ..... X'p)=(Np)Sdxp+I...dxNTN, 
(266' 
~p(Xl 
where S dxi means integration S d3ri and summation over si together with the 
replacement of x~ by xl in the integrand. In many applications spinless DMs are 
sufficient 
• ' 
' 
" ' 
x~)i~i=~," 
(267) 
p,(rl .... ,re, r1 ..... re)= 
~, 
~p(xl .... ,x,,x~ ..... 
Xl,...,$p 
The diagonal elements of DMs are denoted by 
~p(Xl ..... xp) = ~,p(xx .... ,xp; xl ..... Xp) > 0, 
(268) 
np(rl .... ,rp) = pp(rl .... ,re; rl ..... rp) > 0. 
(269) 
The subscript '1' can be omitted. The basic quantity of DFT - the electron 
number density - is thus 
n(r) = p(r;r) = Z ~(rs) = ~ 7(rs;rs). 
(270) 
s 
s 
101 

A. Holas and N. H. March 
From the definition (266) of Vp one finds the following property: 
dxpT'p(xl .... , xp; x'x .... , x'~) 
N+l-p 
- 
7~,- l(xx 
..... xp_ 1; x'l ..... x'p_ 1), 
(271) 
P 
since u 
N -~ 
N+~-p 
(~)(~_~) 
- -  
For 
density matrices generated from a determinantal wave function ~uD 
(which occurs, e.g., in the HF method or the KS approach), the p-th order matrix 
can be obtained from the 1-st order one 
N 
~(x;x') = ~(x;x')= 
Y~ ~(x)~*(~'), 
j=l 
as the following determinant (see e.g. [10]): 
D 
. 
t 
~l(xl,x~), 
D 
. 
1 
. 
~,~ ~Xl ..... x~, x; ..... x'~) = ~. 
e~(x.; x'~), 
(272) 
°t 
"', 
~l(xl, xp) 
• .., 
~'(x~;x~) [ 
(273) 
The set {q~j(rs), j = 1 ..... N} of orbitals used for the construction of 7 j° can be 
split into two subsets 
and 
where 
{~b~r(r)c~(s), i= 1 ..... N1} 
(274) 
{~b~(r)/~(s), i= 1,...,N+} 
(275) 
N, + N~ = N. 
Then the corresponding 1st order matrix [see Eq. (272)] is 
~'(x; x') = p~'(r; r')~(s)~(s') + p~'(r; ~')/~(s)/~(~'), 
where 
(276) 
(277) 
Na 
p~(r;r') 
Y, 
* ' 
= 
~bi,(r)q~i~(r ); a = T, ~ • 
(278) 
i=l 
Dz¥ rt~ 
The matrices p~(r;r') and p~ t ; ) are idempotent with respect to indices r,r', 
while To(X; x') is idempotent with respect to x, x'. From Eqs. (277) and (267) an 
expression for the spinless 1st order matrix and its diagonal elements follows, 
namely 
D'r r"" 
nt~(r). 
(279) 
pD(r;r')= p~(r;r')+ p~ ; ), 
nD(r)=n~(r)+ 
The diagonal element of the 2nd order DM, calculated according to Eqs. (273) 
and (277), is known to be 
n~(r~, r2) = ½nD(rl)n°(r2) { 1 + hD(rl, r2) }, 
(280) 
102 

Exchange and Correlation in Density Functional Theory of Atoms and Molecules 
where 
hD(r~,r2) = 
{IP~(r,;r2)l 
= + lpt~(r,;r2)l 2} 
-- 
nD(rl)nD(r2) 
< 0. 
(281) 
For spin-compensated systems (SCS), i.e. when 
p~, = p~, = ½pD, 
(scs), 
(282) 
Eq. (281) simplifies to 
1 IpD(rl ;r2)l 2 
(SCS). 
(283) 
hD2(rl'r2) -- 
2 nD(rl)nD(r2) ' 
For DMs generated from a general wave function ~, relation analogous to 
Eq. (280), namely 
n2(rl,r2) = ½n(rl)n(r2){1 + h2(rl,r2)}, 
(284) 
serve as definition of h2 (el, r2)- the pair-correlation function. It should be noted 
that for the determinantal case the correlations take place between the same 
spins only [in Eq. (281), fp~(rl ;r2)l z is just p~(rl ;rz)p~(r2 ;el)]. 
The following sum rule [-stemming from Eq. (271)] holds for h2: 
Sd3rzh2(rl,r2)n(r2) = - 1; for any rl. 
(285) 
7.2 Differential Virial Theorem for the Hartree-Fock Solution 
The so-called nonlocal exchange potential b~F, a component of the HF differen- 
tial equation (33), is an integral operator (see e.g. [10]): 
(~nF~k)(x) = S dx'w(x, x')~(x'), 
(286) 
with the kernel 
w(x, x') = - u(r, r')v(x; x'), 
(287) 
where u(r, r') is the (real and symmetric) electron electron attraction potential, 
and 
N 
7(x;x') = ~ ~j(x)~*(x') 
(288) 
j=l 
is the first-order DM, generated by the determinantal HF wave function 7~D 
[Eq. (24)] in terms of N lowest-energy eigenfunctions ~Os(x ) - the solutions of the 
HF equation (33). Using the above definition of Ox nv and the notation for 
complex functions f=f~+ 
if~ and for spatial derivatives f~ = Of(r)/c~r~, 
f,p = 02f(r)/(Or, Orp), etc., we can rewrite the HF equation (33), separated into 
103 

A. Holas and N. H. March 
its real and imaginary components, as 
()'{ 
( 
v(~) + ~o~(~) - ~j = 
~(x) 
½~ 4'J~/pp(x) - f dx' 
w~(x, x')q,~(x') 
--w3(x,x')~(x'))}, 
(289) 
o(~)+~o~(~)-~j= ~,~(x) 
~ ~,~l,,(x)- ~ ~' w'~(x,x')~,~(x ') 
+ w~(x,x,)O~(x,))}, 
1290) 
where 
w~(x, x') = - u(r, r')~(x; x') 
_- 
¢~ 
) 
'~ 
, 
- 
u(v,f) Z { ~ (x ~j (x) + ~](x)~,](x')}, 
(291) 
j=l 
W-~(X,X ') = -- u(~,r')~3(x ; x ') 
N 
= - u(r,r') Y" {¢~. (x)~(x') - ff~(x)~b~a(x')}. 
(292) 
j=l 
Next, we differentiate both sides of Eqs. (289) and (290) with respect to r,, 
afterwards we multiply the first equation by (~,~(x)) ~ and the second one by 
(ff~(x)) 2, and finally we add together these two equations and sum the result 
over j to obtain 
(v(r) + v~(r)~ 7(x;x)= ~ K~(x) + ~ 
dx'W~(x,x'), 
(293) 
\ 
/ ¢t 
fl~ 
$ 
where 
N 
j=l 
~ 
3 
3 
- ~j/~(x)~i/,,(x ) - ~b)/~(x)¢ilat~(x)}, 
(294) 
N 
W~(x,x ) 
y~ 
~ 
' 
~ 
~ 
' 
~ 
~ 
' 
' = 
{w (x,x)[q~j/~(x)~ 
(x) + ~/,(x)q,j(x 
)] 
j=l 
+ w~(x, x')[q,~1~(x)q,~Ix') 
- q,~(~)q,~ix')] 
- w?~,x,)[¢;~x)~4(x,) + ~,~(x)q,~ix')] 
- w3/,(x,x')[~b3(x)qJ~(x ') - ~O~(x)~k~(x')] }. 
(295) 
Eq. (294) can be rewritten as 
= 
, 
~' 
~ 
+ q~(x)q,~(x) 
t~ 
-(O~(x)O~,(x) + O~/~(x)O~,,(x))/,}- 
104 
(296) 

Exchange and Correlation in Density Functional Theory of Atoms and Molecules 
Therefore, using expression (270) for the density, reducing 7 into p according to 
Eq. (267) and applying the definition (162) of the kinetic energy tensor, we obtain 
from Eq. (296) 
K~pp(x) = ¼ n/~pp(r) - 2t~p/p(r ; [p]). 
(297) 
$ 
After substituting into Eq. (295) the differentiated w(x, x') taken from Eqs. (291) 
and (292), we observe cancellation of all terms involving derivatives of wave 
functions, thus 
W~(x,x') = u/~(r,r'){E~(x;x')] ~ + [~,~(x; x')] 2 } 
= u/,(r, r')7(x; x')7(x'; x). 
(298) 
With the results (297) and (298) inserted, Eq. (293) takes the form 
~/~,(,.) ~ ~(x; x) + ~ .1" dx'u/,,(,.,,.'){~,(.,,:; x)~,(x'; x') - ~,(x; x')~,(x'; x)} 
s 
s 
+y.. 
1 
{-~n/,~p + 2t,~/p(r; [p])} = 0. 
(299) 
# 
We have used n(r) = ~$ y(x, x) to represent in terms of 7 the contribution due to 
the differentiated yes(r; In]) [Eq. (34)]. The integrand in Eq. (299) may be put in 
a concise form, if we use Eq. (273), for p = 2, valid for DMs of determinantal 
origin, therefore applicable to the HF case: 
, 
t 
r 
If 
,l x 
.Xt 
. 
r 
. 
t 
. 
t 
72(xl,x2, xa,x2) = 7~r~ 1, 1)7(xz,x2) - 7(xl,x2)7(x2,xx)} 
(300) 
and use Eqs. (269) and (267) to obtain 
r/z(rl,r2) = Z 72(rlSl,r2s2, rlst,r2s2). 
(301) 
$152 
Thus, finally Eq. (299) can be rewritten as the following differential virial 
theorem for the HF solution of the GS problem 
n(r)v/~(r) + 2 ~ dar'n2(r,r')u/~(r, r') + ~ {-¼ n/~pp(r) + 2t~a/a(r; [p])} = 0, 
(302) 
where the reduced DMs nE(rl,rz) , p(r;r') and n(r), occurring in this equation, 
are generated from ~kj(x) - the solutions of the HF equations. 
8 References 
1. Thomas LH (1926) Proc Camb Phil Soc 23:542 
2. Fermi E (1928) Z Phys 48:73 
3. Dirac PAM (1930) Proc Camb Phil Soc 26:376 
4. March NH (1975) Self-Consistent Fields in Atoms. Perfgamon Press, Oxford 
105 

A. Holas and N. H. March 
5. March N H (1992) Electron Density Theory of Atoms and Molecules. Academic Press, London 
6. Slater JC (1951) Phys Rev 81:385 
7. Hohenberg P, Kohn W (1964) Phys Rev 136:B864 
8. Kohn W, Sham LJ (1965) Phys Rev 140: A1133 
9. Levy M (1979) Proc Natl Acad Sci USA 76:6062 
t0. Parr RG, Yang W (1989) Density-Functional Theory of Atoms and Molecules. Oxford University 
Press, New York 
11. Holas A, March NH, Takahashi Y, Zhang C (1993) Phys Rev A 48:2708 
12. Grrling A, Ernzerhof M (1995) Phys Rev A 51: 450t 
13. Schmidt MW, Ruedenberg K (1979) J Chem Phys 71:3951 
t4. Grrling A (1992) Phys Rev A 46:3753 
15. Baroni S, Tuncel E (1983) J Chem Phys 79:6140 
16. Harris RA, Pratt LR (1985) J Chem Phys 83:4024 
17. Talman JD, Shadwick WF (1976) Phys Rev A 14:36 
18. Engel E, Vosko SH (1993) Phys Rev A 47:2800 
19. Krieger JB, Li Y, Iafrate GJ (1992) Phys Rev A 45:101 
20. Li Y, Krieger JB, lafrate GJ (1993) Phys Rev A 47:165 
21. Almbladh C-O, Pedroza AC (1984) Phys Rev A 29:2337 
22. Wang Y, Parr RG (1993) Phys Rev A 47:R1591 
23. Ludefia EV, Lrpez-Boada R, Maldonado J (1993) Phys Rev A 48:1937 
24. Leeuwen R van, Baerends EJ (1994) Phys Rev A 49:2421 
25. Umrigar CJ, Gonze X (1994) Phys Rev A 50:3827 
26. Almbladh C-O, Barth U von (1985) Phys Rev B 3l: 3231 
27. Engel E, Chevary JA, Macdonald LD, Vosko SH (1992) Z Phys D 23:7 
28. Dreizler RM, Gross EKU (1990) Density Functional Theory. Springer, Berlin Heidelberg New 
York 
29~ Perdew JP (1985) in: Dreizler RM, Providencia J da (eds) Density Functional Methods in Physics. 
Plenum, New York, p 265 (NATO ASI Series B: Physics Vol. 123) 
30. Holas A, March NH (1995) Phys Rev A 51:2040 
31. Holas A, March NH (1994) J Mol Structure (Theochem) 315:239 
32. Holas A, March NH (1995) Int J Quantum Chem (in press) 
33. Levy M, Perdew JP (1985) Phys Rev A 32:2010 
34. Harbola MK, Sahni V (1989) Phys Rev Lett 62:489 
35. Sahni V (1995) in: Calais JL, Kryachko E (eds) Structure and Dynamics." Conceptual Trends. 
Kluwer, Dordrecht 
106 

Analysis and Modelling of Atomic and Molecular 
Kohn-Sham Potentials 
Robert van Leeuwen 1, Oieg V. Gritsenko 2 and Evert Jan Baerends 2 
1 Department of Theoretical Physics, University of Lund S61vegatan 14A, S-22362, Lund, 
Sweden 
2 Afdeling Theoretische Chemie, Vrije Universiteit De Boelelaan 1083, 1081 HV, Amster- 
dam, The Netherlands 
Table of Contents 
List of Symbols and Abbreviations ............................... 
108 
1 Introduction ............................................... 
108 
2 Key Concepts and Formulas .................................. 
110 
3 Construction of Kohn-Sham Potentials from Electron Densities ....... 
115 
4 Energies from Potentials ..................................... 
119 
5 Properties of Kohn-Sham Potentials ............................ 
122 
5.1 Invariance Properties with Respect to Symmetries .............. 
122 
5.2 Long Range Asymptotics ................................. 
124 
5.3 Atomic Shell Structure ................................... 
126 
5.4 Molecular Bond Midpoint Properties ....................... 
134 
5.5 Derivative Discontinuities and Charge Transfer ................ 
141 
6 Approximate Kohn-Sham Potentials ............................ 
148 
6.1 The Weighted Density Approximation ....................... 
148 
6.2 Gradient Approximations for the Potential ................... 
150 
6.3 The Krieger-Li-Iafrate Approximation ....................... 
157 
Topics in Current Chemistry Vol. 180 
© Springer-Verlag Berlin Heidelberg 1996 

R. van Leeuwen et al. 
7 Conclusions and Outlook ..................................... 
163 
8 References ................................................ 
164 
The basic concepts of the one-electron Kohn-Sham theory have been presented and the structure, 
properties and approximations of the Kohn-Sham exchange-correlation potential vxc have been 
overviewed. The discussion has been focused on the most recent developments in the theory, such as 
the construction of vx~ from the correlated densities, the methods to obtain total energy and energy 
differences from the potential, and the orbital dependent approximations to v~,. The recent 
achievements in analysis of the atomic shell and molecular bond midpoint structure of vxc have been 
summarized. The consistent formulation of the discontinuous dependence of v~ on the particle 
number and its effect on the spatial form of v,, c and charge transfer within the system have been 
presented. The recently developed direct approximations of the long- and short-range components 
of vxc have been overviewed. 
List of Symbols and Abbreviations 
DFT 
GGA 
LDA 
OPM 
CI 
BLYP 
PW91 
SIC 
KLI 
WDA 
GEA 
B88PW91C 
density functional theory 
generalized gradient approximation 
local density approximation 
optimized potential model 
configuration interaction method 
combination of the approximate exchange functional of Becke 
and the Coulomb correlation functional of Lee, Yang and Parr 
approximation of the exchange-correlation functional by Per- 
dew and Wang (1991) 
self-interaction correction method 
approximation for the exchange and exchange-correlation po- 
tentials of Krieger, Li and Iafrate 
weighted density approximation 
gradient expansion approximation 
combination of the approximate exchange functional of Becke 
(1988) and the Coulomb correlation functional of Perdew and 
Wang (1991) 
1 Introduction 
Density functional theory (DFT) [1] has become an important computational 
tool within quantum chemistry [2, 3]. As has been tested in several studies [4-7] 
DFT yields results for many molecular systems which are comparable in 
108 

Analysis and Modelling of Atomic and Molecular Kohn-Sham Potentials 
accuracy to the results obtained with the more traditional methods of quantum 
chemistry. They are however obtained at much lower cost, making DFT an 
important tool in the study of large molecular systems, impossible with the more 
conventional methods of quantum chemistry. 
The increase in accuracy of the density functional method in the past decade 
is mainly due to the introduction of the generalized gradient approximations 
(GGAs) for the exchange-correlation energy which give large improvements in 
energetics over the more conventional local density approximation (LDA). 
The work on GGAs was initiated by Langreth, Perdew and Mehl [8-10] 
who proposed gradient functionals derived from momentum space cutoffs that 
were introduced to enforce known constraints to the exchange-correlation hole 
obtained from gradient expansions of slowly varying densities. In later work, 
Perdew et al. [11-14] obtained accurate gradient functionals for the exchange- 
correlation energy by similar cutoffs of the exchange-correlation hole in real 
space. A more phenomenological, but important, contribution has been made 
by Becke [6, 15] who obtained a widely used GGA for the exchange energy. The 
Perdew-Wang exchange-correlation functional [11,13,14] or the Becke 
exchange functional [15] in combination with the correlation functional of 
Perdew [10] or Lee et al. [16] have turned out to be very successful in the 
calculation of molecular bond energies and geometries (for a recent review of the 
Becke and Perdew-Wang approach see [17]). 
Although the GGAs give large improvements in exchange-correlation 
energies, the corresponding exchange-correlation potential still has significant 
deficiencies. For instance, they do not reproduce the required asymptotic 
Coulombic - 1/r behavior [18-21] in finite systems such as molecules. As 
a result of this, a too low absolute value for the highest occupied Kohn-Sham 
orbital, which should be equal to the ionization energy of the system [18], is 
obtained. Furthermore the required atomic shell structure, characterized by 
peaks at the atomic shell boundaries [19-21], is not correctly reproduced with 
the LDA and GGA approximations [22]. Another serious deficiency is the 
erroneous (Coulombic) singularity of the GGA potentials near the atomic 
nucleus [20, 23]. These deficiencies, of course, demonstrate that the GGA 
density functionals for the exchange-correlation energy do not have the correct 
density dependence, even if they reproduce quite well experimental energies. 
This clearly indicates a need for improved Kohn-Sham potentials, especially for 
the calculation of properties that depend sensitively on the quality of the 
electron density, such as polarizabilities and other response properties. 
In this review we will give an overview of the properties (asymptotics, 
shell-structure, bond midpoint peaks) of exact Kohn-Sham potentials in atomic 
and molecular systems. Reproduction of these properties is a much more severe 
test for approximate density functionals than the reproduction of global quanti- 
ties such as energies. Moreover, as the local properties of the exchange-correla- 
tion potential such as the atomic shell structure and the molecular bond 
midpoint peaks are closely related to the behavior of the exchange-correlation 
hole in these shell and bond midpoint regions, one might be able to construct 
109 

R. van Leeuwen et al. 
better exchange-correlation functionals (which are usually based on exchange- 
correlation hole considerations) by studying the local properties of the ex- 
change-correlation potential. 
2 Key Concepts and Formulas 
The basic quantity in density functional theory is the energy functional Ev which 
within constrained search [24, 25] is defined as 
E~ [{p.}] = fp(r)v(r)dr + Vz [{p.}] 
(1) 
where p~ are the spin densities and p is the total density which is given as the 
sum of the spin densities p = p T + p ~ • Here v is the external potential of the 
system (for instance for the case of a molecule it is the nuclear frame) and the 
functional FL is defined as 
FLE{P,~}] = 
inf TrD(T+ 1~) . 
(2) 
In this functional the infimum of the expectation value of the kinetic energy 
operator 2 ? and the interparticle interaction operator 1~ is searched over all 
N-particle density matrices which integrate to the prescribed spin densities {p,}. 
The energy functional Ev attains its minimum for the ground state densities {p,} 
corresponding to the external potential v. The functional FL is independent of 
v (as follows directly from its definition) and is in this sense universal. Once 
approximations for FL are found it can be applied to a wide range of physical 
systems ranging from atoms and molecules to solids and surfaces. The func- 
tional FL as defined above has the nice mathematical property that its functional 
differentiability can be proven [26, 27] at the ground state densities {p,} 
corresponding to potential v of a certain class, providing a rigorous foundation 
for the variational equations in DFT. The functional FL is usually split up as 
1 /'p(r~)p(r2).. 
Ex~[{p.}] 
1"7--- -----; 
arxar2 
+ 
eLI{P,.}] = TL[{p~,}] + ~ 3 Irl -- r21 
(3) 
where TL is defined as 
TL[{p~,}]= inf TrbT. 
(4) 
fi ~ {p.) 
As all functionals except the exchange-correlation functional Exc are defined, 
Eq. (3) actually defines Ext. As shown by Kohn and Sham [28] (for a rigorous 
110 

Analysis and Modelling of Atomic and Molecular Kohn-Sham Potentials 
derivation see [26, 27]) the variational problem can be rewritten as 
1 2 
v+~([{p.}];r)]~b,.(r) 
8i~b++(r) 
[ -~v 
+ 
= 
(5) 
p+(r) = ~fl, l qS,+(r)l 2 
i 
~" p(r') 
v++([{p+}];r) = v(r) + jg-L-iq dr' + vx++([{p.}]; r) 
Vxc.([{p+}]; r) - 
ap#(r) 
where f~, are the orbital occupation numbers. For the nondegenerate ground 
states JS, = 1 for the occupied orbitals ~bi, and f~, = 0 for the unoccupied 
orbitals, so that TL reduces to the kinetic energy functional of the noninteracting 
particles T~ [{p,}]: 
No 
1 
2 
• 
T,[{p.}]=~;q~*(r)(-~V)O,.(r)dr 
,6) 
Equations (5) will be referred to as the Kohn-Sham equations. The effective 
potential v, is called the Kohn-Sham potential. By applying the Hohen- 
berg-Kohn theorem [29] to a non=interacting system it can be uniquely deter- 
mined (to within a constant) by the electron density. The quantity vxc, the 
exchange-correlation potential, is equal to the functional derivative of Ext. In 
practice it is usually calculated in the local density approximation (LDA) or 
using generalized gradient approximations (GGAs). The functional Exc 
can be further split up into an exchange and a correlation part. The exchange 
functional is defined as 
1 [p(rl)p(r2)dr ,1 r 
Ex[{p~}] 
= <~k~[p]l !#zl~k~[p]> - ~jIT~ 
~ 
~,, 2 
(7) 
where ~[p] is the Kohn-Sham determinant obtained from the solution of the 
Kohn-Sham equations. The correlation functional is defined as 
Z++ [{p+}] = Ex+[{p~}] - e~[{p.}] 
. 
(8) 
The exchange and correlation potentials v~ and vc are defined as the func- 
tional derivatives with respect to the electron density of the corresponding 
functionals: 
v~.([{p.}]; r) = 6Ex [{p#}] 
6p.(r) 
(9) 
v~+([{p,}];r) = ,~E~ [{p,}] 
ap.(r) 
(10) 
111 

R. van Leeuwen et al. 
To study the structure of the exchange-correlation energy functional, it is 
useful to relate this quantity to the pair-correlation function. The pair-correla- 
tion function of a system of interacting particles is defined in terms of the 
diagonal two-particle density matrix Fo,o2 (for an extensive discussion of the 
properties of two-particle density matrices see 1-30] ) as 
Fol~ 2 (rl, r2) 
(11) 
#~,~(rlr2)- p~,(rl) p~(r2) 
We further define the coupling constant integrated pair correlation function 
[31, 32] by 
O.~.2([{p.}];rl, r2) = 
g.,~2 ([{p.}], x, rz)d2 . 
(12) 
Here ~ 
9,1o2 is the pair-correlation function corresponding to the ground state of 
the Hamiltonian 
~ 
= 7~+ I?~ + ;,I~" 
(13) 
where the two-particle interaction l~now has coupling strength 2 and where the 
external potential l~a is now chosen for each 2 in such a way that the densities 
{p.} remain constant as a function of 2. In this way the limit 2 = I corresponds 
to the fully interacting system with external potential v and the limit 2 = 0 
corresponds to a noninteracting system with the Kohn-Sham potential v~ as an 
external potential. The exchange-correlation functional can now be written in 
terms of the coupling constant integrated pair-correlation function as 
1 
f p,,(rl)p#2(r2)l_rl_l 
Z ~T2 t 
E~[(p,}] 
-- 5~ 2~'~ 
(Oo,::([{p,}];r,, 
r2)- 
1) dr: dr2 . 
(t4) 
This expression is very useful in the construction of approximate exchange- 
correlation functionals and in the analysis of the different long and short range 
properties of the exchange-correlation potential. Note that the exchange-cor- 
relation energy Exc as defined here also contains the difference Tc = T- T, 
between the kinetic energy of the fully interacting system and the kinetic energy 
of the Kohn-Sham system. One can readily show that Tc is always a positive 
quantity [1]. In terms of the pair-correlation functions one has 
- 0#,,,([{Po}]; rl, r2)) drt dr2. 
(15) 
This expression shows explicitly how the coupling constant integration intro- 
duces the kinetic part of Ext. We can further split up # into an exchange part 
g, and a correlation part Of: 
Oo,.~([P]; rlr2) = g,,#to2([{P#}]; rl, r2) + #cata2([P]; rl, r2) 
(16) 
112 

Analysis and Modelling of Atomic and Molecular Kohn-Sham Potentials 
where gxol~2 is defined by 
gxozo2([{Po}-I; r,, r2) = 1 - ;i 
17s~l(rl, 
r 2 ) [  2 
(17) 
~°l°2 p,z (rl)p.t (r2) 
where 
N~ 
~so(rl, r2) = ~ fioq~io(r,)~b*(r2) 
(18) 
i 
is the one-particle density matrix for the Kohn-Sham system. The form of 
g~ shows that like spin electrons are uncorrelated in the exchange-only approxi- 
mation. We further define 
gs~([{po)]; r,, r2) = gx~o([(P~)]; rl, rz) 
(19) 
which we will call the pair-correlation function of the Kohn-Sham system. This 
allows us to write the exchange and correlation energy functionals as 
1~-, /'po(rl)p,(r2) ...... 
Ex[{po}] = 
z~J i-r~1-~21 t0~otHpo?j;rl, r2)- 1)drldr2 
2 a 
= 1 E fp,(r,)px,(rl., r2)dr, dr2 
(20) 
2 o J 
Ir, - r2l 
E~[{po}] = 1 E ~Po,(rOPo~(r2) 
0~.~2([{P.}];rt, r2)dr~dr2 
2 ~.2 ./ 
lrl - r21 
=20~,~1 
~ ~p~(rl)&o~2(rl,l__~_l 
~2 I r2)drldr2 
(21) 
where we defined the exchange or Fermi hole function as 
lyso(rl, r2)l 2 
Pxo(rl, r2) -- 
pa(rl) 
(22) 
and the coupling constant integrated correlation hole or Coulomb hole function 
by 
P~o,~2(r,, r2) = po2(r2)0colo2(rl, r2) . 
(23) 
Note that the exchange hole is not affected by the coupling constant 
integration as the density and therefore the Kohn-Sham orbitals also remain the 
same during the integration. The exchange and correlation holes satisfy the 
important sum rule properties 
fp~o(rl, rz)dr2 = 
- 
(24) 
1 
~ f Pc~,~2(rl, r2)dr2 = 0 . 
(25) 
113 

R. van Leeuwen et al. 
The exchange and correlation holes are important concepts in DFT as many 
approximate functionats are based on modelling of these functions [11, 32-34]. 
They also help to explain the success of DFT in chemical bonding situations 
[35, 36]. 
Finally we mention some basic relations which are essential in the discussion 
of explicitly orbital dependent functionals. Examples of such functionals are the 
Kohn-Sham kinetic energy T~ and the exchange energy Ex which are dependent 
on the density due to the fact that the Kohn-Sham orbitais are uniquely 
determined by the density. The functional dependence of the Kohn-Sham 
orbitals on the density is not explicitly known. However one can still obtain the 
functional derivative of orbital dependent functionals as a solution to an integral 
equation. Suppose we have an explicit orbital dependent approximation for 
Ex~ in terms of the Kohn-Sham orbitals; then 
c~p~(r) 
f 
6Ex~ &~i~2(rl) 6v~(r2) drldr2 + c.c. 
(26) 
= ~2 
6~i~(rl) ~v~,2(r2) ~p~(r) 
From this equation one finds that the exchange-correlation potential can 
alternatively be obtained as the solution to the integral equation [37, 38] 
f 
g~,(rl, r2)v~¢~(r2)dr2 = Q,(rl) 
(27) 
where the function X~, is the static density response function of the Kohn-Sham 
system 
is/ 
c~p,(rl) _ 
~S~ ~b*(rl)Gi~(rl, r2) q~ia(r2) + C.C. 
(28) 
Z~(rl, r2) = 6v~.(r2) 
i 
where Gi, is the Greens function 
Gi~(rl, r2) = E q~jcr(r0q~*~(r2) 
(29) 
j ~ i 
gjcr -- gia 
The function Q, is defined as 
Q~(rl) = 
~b*(rt)G~(rl, r2)vxc, i~(r2)4h~(r2) dr2 + c.c. 
(30) 
where 
1 
cSExc 
(31) 
v~c,i~(r) = ~, (r) cS~b*.(r) 
The above equations are especially suitable for obtaining the exchange 
potential, as this potential is implicitly dependent on the density but explicitly 
on the Kohn-Sham orbitals. The above equations are, furthermore, very useful 
114 

Analysis and Modelling of Atomic and Molecular Kohn-Sham Potentials 
for considering Kohn-Sham orbital dependent approximations to Exc and vx,. 
Neglect of correlation leads to the exchange-only optimized potential model 
(OPM) equations [21, 39-41]. Until now the OPM has been applied only to 
atomic systems, for which the Coulomb correlation has little effect on the 
electron density distribution. In this case the solution of the OPM equations 
leads to a very accurate exchange potential 
vO¢VM(r) = flEx6po(r)[{po}'] p°'~ 
(32) 
which should be close to the exact exchange potential 
v~o(r) = 6E~ [{p.}] 
(33) 
The importance of orbital dependent functionals for a correct representation 
of the atomic shell structure, the correct properties of v~¢ for heteronuclear 
molecules, and the related particle number dependent properties will be dis- 
cussed in Sect. 5.5. 
3 Construction of Kohn-Sham Potentials from Electron Densities 
As the exact form of the energy functional Exc [p] is unknown, approximations 
for this quantity must be introduced for practical applications. However the 
exact form of its functional derivative vxc(r) = ¢SExc/6p(r) can be studied once 
accurate ground state densities are available, as the Kohn-Sham potential v~ is 
uniquely (that is up to a constant) determined by the electron density. This 
observation follows immediately from the Hohenberg-Kohn theorem as applied 
to a non-interacting system of electrons. Therefore, having an accurate repre- 
sentation of the electron density p (for example from a configuration interaction 
calculation), one should (using the Kohn-Sham equations) be able to construct 
an accurate representation of the Kohn-Sham potential v~. Knowledge of the 
external potential v then immediately yields v,.¢. For the simple case of a spin 
unpolarized two-electron system this problem can be solved in a straightforward 
way, as the orbital density ]~b 12 of the only doubly occupied Kohn-Sham orbital 
~b must be equal to the electron density. The Kohn-Sham equations then 
immediately yield 
t' 
1 V2x/~ 
(p(r') dr' - v(r). 
(34) 
v~c(r) = ~ ~
.
 
+ # - Air - r'l 
In this way, accurate results for v~¢ have been obtained for the helium atom and 
helium-like ions as well as for the hydrogen molecule 1-42-44]. However, for 
a system with more electrons the problem is less easily solved. The first 
115 

R. van Leeuwen et al. 
calculations of vxc from a correlated electron density for a system with more than 
two electrons were carried out by Almbladh and Pedroza [45] for the three- and 
four-electron systems of the lithium and beryllium atoms. They used a method 
that had been applied before by yon Barth [46] to construct the exchange 
potential vx from the Hartree-Fock density for the case of the beryllium atom 
(see [47]). This method was based on an approximate expansion of the potential 
in some fit functions depending on parameters which can be optimized to yield 
a minimum density difference with the exact target density. Aryasetiawan and 
Stott [48] used a different method in which they needed to solve a set of coupled 
differential equations. However application of this method to other systems than 
spherically symmetric atoms (see [49, 50] for an application to a series of atoms) 
such as molecular systems seems to be quite involved. 
Recently a few other methods for constructing vxc have been proposed whose 
application to general molecular systems is feasible. G6rling and Ernzerhof 
[51, 52] has revived an iterative method of Werden and Davidson [53-] based on 
the relation 
= fX[ 1 (r, r') 3p(r') dr' 
(35) 
6v,(r) 
where ZJ 1 is the inverse static density response function of the Kohn-Sham 
system which relates a change 3p in the electron density to a change 6v~ in the 
Kohn-Sham potential. This relation has been used before [53] to construct the 
Kohn-Sham potential for a model problem. For the Kohn-Sham system the 
function Z[ 1 can be directly calculated from the Kohn-Sham orbitals and 
eigenvalues. At an iteration n, the density difference 6p = p,, - p between the 
density p, at an iteration n and the exact density p determines, by the above 
relation, an updated Kohn-Sham potential v, + 3vs. From this updated Kohn- 
Sham potential we can calculate new orbitals and eigenvalues and construct 
a new Z[ 1. This procedure is then repeated until convergence is reached. The 
difficulty in this procedure originates from the fact that X~- x is only determined 
up to a constant as, for a change of vs by a constant, the density does not change. 
This implies that the constant function is an eigenfunction with eigenvalue 0 for 
the integral kernel ~,. This has to be taken into account when defining ~-1 (see 
[53]). 
A very different approach has been followed by Zhao et al. [54-57-1 who 
based their method on the constrained search definition of the Kohn-Sham 
kinetic energy. It follows from this definition that, from all Slater determinants 
which yield a given density, the Kohn-Sham determinant will minimize the 
kinetic energy. Suppose we have an exact density Po. If one minimizes the 
Kohn-Sham kinetic energy under the constraint 
1 ~Ap(rl) Ap(rz! dri dr2 = 0 
(36) 
C[p, po] = 2 3 
Irl-r21 
where Ap(r) = p(r) - po(r) and where Po is the target density, one obtains the 
116 

Analysis and Modelling of Atomic and Molecular Kohn-Sham Potentials 
Euler-Lagrange equations 
12 
+(1 
2f~drll~p,(r)=e,~b,(r ) (37) 
N 
p(r) = ~ I~i(r)l 2 
(38) 
i 
where v and vtt are the external and the Hartree potentials (the latter being 
corrected with the Fermi-Amaldi self-interaction correction) and 2 is a Lagrange 
multiplier. In the limit where Ap(r) approaches zero, the orbitals ~b~ will yield the 
exact density Po. As the Coulomb integral of Ap then goes to zero the parameter 
2 must go to infinity at the solution point and the Kohn-Sham potential is given 
as 
Vs(r) = v(r)+ lim F2 f Ap(rl) dr 1 _ lvn(r)]" 
(39) 
x-.~ l_ JIr- rll 
The potential vs can then be found by solving Eq. (37) for a number of values for 
2 which can then be extrapolated to infinity. The procedure also works for other 
constraints like 
C [p, Po] = lAp(r) 2 dr = 0 
(40) 
but the Coulombic constraint at Eq. (3b) leads to faster convergence in practical 
applications due to the built-in Coulombic asymptotics of the potential. Some 
recent applications of the procedure can be found in [56, 57] where the ex- 
change-correlation potential is obtained for all the atoms He through Ar. The 
method is however straight-forwardly applicable to general systems such as 
molecules. 
Another procedure has been devised by Wang and Parr [58] and yet another 
by van Leeuwen and Baerends 1-20]. As the procedures are similar in spirit we 
will only describe the procedure of the latter authors in some detail. Let us split 
up the Kohn-Sham potential into the external potential part v(r) and the 
electronic part re: 
vs(r) = v(r) + re(r) 
(41) 
where the electronic part is defined as 
v~(r) = ~ p(r0 dr1 
Jlr - rll 
+ vxc(r) 
(42) 
which is a repulsive potential. Suppose the exact density is given by Po and we 
have a starting density pO and a starting potential v ° (for instance from an LDA 
calculation). We then define an iterative procedure by 
p"-l(r) 
v~(r) = po(r) v~- l(r) 
(43) 
117 

R. van Leeuwen et al, 
where the potential v"~ can be used to generate a new density from the solution of 
the Kohn-Sham equations. The procedure is then iterated until lP"(r) - po(r)l 
becomes lower than some threshold. The way the procedure works can be 
understood intuitively. If the density at a point r is too low, p"- 1 (r) < po(r), then 
v g- l(r) is multiplied by a factor smaller than one making the potential less 
repulsive at this point, which is a correction in the right direction. The opposite 
happens if p"- l(r) > p0(r), in which case v,"- 1 (r) is multiplied by a factor larger 
than one making the potential more repulsive at this point, again yielding 
a correction in the right direction. Using similar arguments one can also devise 
alternative procedures of the form 
v~(r) =f(p"- 1(r)/p0(r)) v~- l(r) 
(44) 
wherefis a function satisfying f(1)= 1 or 
v"(r) = v~-~(r) + g(p"-l(r) 
- p0(r)) 
(45) 
where g is a function satisfying g(0) = 0. The procedure devised by Wang and 
Parr [58] is of the latter form. Recently Gritsenko et al. [59] obtained, by an 
iterative procedure of the form in Eq. (43), the exchange-correlation potentials of 
the molecules Hz and LiH from the corresponding configuration interaction 
(CI) densities. The results for H2 compare well with the results of Buijse et al. 
[43] who calculated the exchange-correlation potential of this two-electron 
system in a straightforward way. The work by Gritsenko et al. on LiH provides 
the first rather accurate results on the exchange-correlation potential for a mo- 
lecular system with more than two electrons. The results for H2 and LiH are 
displayed in Figs. 1 and 2. In Fig. 1 we plot the exchange and the exchange- 
correlation potential along the bond axis for the H2 molecule at equilibrium 
distance. Note the difference in qualitative behavior between the exchange and 
the exchange-correlation potential in the bond midpoint region. Correlation 
effects build in a peak structure on top of the exchange potential. The origin of 
this structure is discussed in Sect. 5.4. In Fig. 2 the exchange-correlation poten- 
tial for the LiH molecule at equilibrium distance is displayed along the bond 
-0,70 - 
-0,75 - 
-0.80 - 
.-:, 
=. -0.85- 
-0.90- 
-0.95- 
-1.00- 
0 
012 
' 
0.4 
] 
/'/" 
Vx 
/¢" 
' 
i0 
' .... 
016 
0,8 
1 
112 
1,4 
z (a. u.) 
Fig. 1. Exchange and exchange-correla- 
tion potentials for Hz. Potentials are 
plotted along the bond axis as functions 
of the distance z from the bond mid- 
point. The H nucleus is at z = 0.7005 
a.n. 
118 

0" 
-0.5 
-1.0 
=. -1.5 
-2.0- 
-2.5- 
-3.0 
Analysis and Modelling of Atomic and Molecular Kohn-Sham Potentials 
.... .. 
VxcLDA ............ 
\',, il 
V 
° 
z (a. u.) 
Fig. 2. Exchange-correlation potential 
and its LDA approximation along the 
bond axis of LiH as functions of the 
distance z from the bond midpoint. The 
Li nucleus is at z = --1.508 a.u. and 
H is at z = 1.508 a.u, 
axis. Further insight in the properties of molecular Kohn-Sham potentials can 
be obtained if we apply the methods described above to more molecular 
systems. The study of accurate Kohn-Sham potentials in the case of molecular 
dissociation where correlation effects are large may give more insight into the 
successes and deficiencies of the presently used exchange-correlation func- 
tionals. Further analysis of exchange-correlation potentials for different molecu- 
lar systems is in progress. 
4 Energies from Potentials 
In the previous section we have shown several ways of constructing nearly exact 
exchange-correlation potentials from a given electron density. As the exchange- 
correlation potential is equal to the functional derivative of the exchange- 
correlation functional E= taken at the exact ground state density we might ask 
whether we could obtain some information on the exchange-correlation energy 
from the constructed potentials (of course the density immediately fixes the 
value of Exc from the constrained search definitions of the functionals FL and 
TL but this does not provide a practical method). 
We will therefore look more closely into the relation between vx~ and E~. 
Suppose we have a parametrization of a set of electron densities y(t) starting at 
y(0) = Po and ending in y(1) = Pl. Then we have [60-] 
~ldtdE~¢ 
.I~ dt (dr ~Ex~[7(t)'] dT_((t) 
Exc[pl'] - Ex~[Po-] = Jo 
dt = .- 
J 
6p(r) 
dt 
= 
dt drv~([y(t)];r) dT(t) 
(46) 
dt 
where the outcome of the last integral is path-independent. In general, for 
119 

R. van Leeuwen et al. 
a given exchange-correlation potential vx~, we can define the line integral of 
vxc along a path from Po to Pl as 
f v~¢-f~dtfdrvx~([~,(t)];r)d~-t t) . 
(47) 
If we calculate the above line integral for an arbitrary approximate v~ the 
result will, in general, be dependent on the path ), used. However path indepen- 
dence is guaranteed [60] if vxc satisfies the condition 
6v~c(r) 
6v~c(r') 
- 
0. 
(48) 
6p(r') 
6p(r) 
This is a vanishing curl condition implying (just as for ordinary vector fields) 
that v~ is the functional derivative of some energy functional Ext. In that case 
Eq. (46) is valid for any path ~ from Po to Pl. Let us first apply the above 
formulas to the calculation of exchange-correlation energy differences from 
a given exchange-correlation potential. The above equations clearly show that 
for this purpose it is not sufficient to know v~¢ for one density, one needs to know 
Vx~ along a line of densities. As an illustration we take the straight path from 
P0 to Pl given by 7(0 = Po + tap with Ap = Pl - P0. In that case we obtain 
E~[po + Ap] - E~[po] = 
drAp(r) 
dtv~c([po + tAp];r). 
(49) 
When we use a simple Simpson rule for the t-integration we can approximate 
the above integral as 
E~o [Po + Ap] - ExXpo] 
1 
2 
= f drAp(r)(-~v~([Po];r) + -3 vx~([Po + ~APl; r ) 
+ ~v~([po + Ap]; r)) 
(50) 
which requires the knowledge of v~ for three different densities. The above 
procedure proves to be exactly equivalent to the transition state method for 
energy differences developed by Ziegler and Rauk [61] carried out to the third 
order in Ap. This method may easily be extended to higher order numerical 
quadrature in t which however requires the knowledge of v~c for a larger set 
of densities. For molecular bond energies, where Ap is given by the defor- 
mation density of the molecule, Eq. (50) is usually accurate enough for practical 
application [61]. 
We can also calculate the total exchange-correlation energy in the same way 
by integrating the density from 0 to p. To do this one could for instance choose 
the path ?(t) = tp. This path, however, has the disadvantage of not conserving 
the particle number which can therefore be fractional, giving theoretical prob- 
lems if one wants to assign a potential to the corresponding density. A more 
120 

Analysis and Modelling of Atomic and Molecular Kohn-Sham Potentials 
appealing path choice is the scaling path 
7(t) = pt(r) = t3p(tr) 
(51) 
which is particle number conserving; thus 
f,(t)dr=fp(r)dr=N 
(52) 
along the path. If we take an atomic or molecular density and let t approach 
zero, then the density Y(0 becomes increasingly diffuse and approaches zero in 
every point of space. From the relations [62] 
Exc[pd = tE~[p] + Ec[pO 
(53) 
and 
where b 
lim 1 Ec [Pt] = - b [p] 
(54) 
t--,O t 
[p] is a positive functional it follows that [62] 
lim Exc [p,] = 0 
(55) 
l~O 
and Eq. (46) yields 
Exc[P]=f2dtfdrvxA[Pd;r)~f~ 
= 
dt drv~([pt]; r) [3t2p(tr) + t3r x V~p(tr)] 
=fdrf~dtlv~c([Pt];1-r) 
\ 
t 
(56) 
in which we performed the substitution tr ~ r. This equation gives an explicit 
relation between the exchange-correlation energy and the exchange-correlation 
potential in terms of a line integral along a scaling path. The direct evaluation of 
the above line integral (for instance by means of numerical integration in the 
t-variable) requires the knowledge of vx~ for a number of scaled densities Pt. The 
exchange-correlation potentials corresponding to these scaled densities are not 
directly obtainable from accurate CI-densities, as the external potential ot which 
generates Pt in the interacting system is in general not known. The explicit 
relation between v, and v~([pt]; r) follows from the scaling property of the 
Kohn-Sham potential 
vs([p,]; r) = t 2 vs([p]; tr) 
(57) 
which together with 
v~([pt]; r) = vt(r) + tvH([p]; tr) + vxc([pt]; r) 
(58) 
121 

R. van Leeuwen et al. 
p(r') dr' 
vn([p];r) = Jtr'- 
rl 
(59) 
where vn is the Hartree potential, yields 
vx~([pJ; r) = t2v~c([p]; tr) + t2v(tr) - v,(r) + t(t - 1)VH([p]; tr) 
(60) 
where v is the external potential for t = t. The unknown quantity v, prevents the 
direct calculation of the line integral for Ext. As a practical scheme one might be 
able to develop accurate approximations for Vxc([pt]; r) which are constructed to 
fit the t = 1 limit accurately and which are, furthermore, constructed to obey the 
known limits and inequalities [63] with respect to density scaling. Such approxi- 
mations can be used directly in the line integral to determine the exchange- 
correlation energy. 
Another path of densities for line integration has been proposed [64], which 
was parametrized by the Lagrange multiplier 2 of Eq. (37). It starts with 
p corresponding to 2 = 0 and terminates at the 2 = ~ solution. 
5 Properties of Kohn-Sham Potentials 
5.1 lnvariance Properties with Respect to Symmetries 
It follows from the definition of the functionals FL and TL that the exchange- 
correlation functional is invariant under the rotation and translation of the 
electron density. This follows directly from the fact that the kinetic en- 
ergy operator T and the two-electron operator W are invariant with respect to 
these transformations. This also has implications for the exchange-correlation 
functional. 
The formalism of line integrals as discussed in the previous section provides 
an easy way to obtain conditions on the energy functional in the case where the 
exchange-correlation potential has some invariance or symmetry property [601. 
Suppose for instance that we vary the densities along our path y by varying our 
path parameter t but that the potential vxc has some symmetry property under 
such changes. Using Eq. (46) we then can deduce some properties of Ext. In the 
following we will apply this idea to rotation, translation and scaling properties 
of Ext. 
If we define the path 7(t) by 
7(0 = p(r + tR) 
(61) 
in which R is an arbitrary translation vector, and suppose that E~c is a transla- 
tional invariant, then we find that E~¢[?(t)] = Ex~[p] is constant as a function of 
122 

Analysis and Modelling of Atomic and Molecular Kohn-Sham Potentials 
t and 
0 
Similarly 
dE~[y(t)][ 
f" 6Ex~ 
~t)l 
dt 
t=l 
t=l 
= fdrv~,([y(1)];r) R x Vp(r + R) 
d 
(62) 
= [drv~([p];r + R)R x Vp(r + R) 
d 
(63) 
As the above Eqs. (62) and (63) yield the same result for all densities p and 
translation vectors R it follows that 
vxc([p(r + R)]; r) = vxc([p(r)]; r + R) . 
(64) 
Thus vxc with the translated density inserted yields the same value in point r as 
vx~ with the original density inserted in point r + R. Moreover we find from the 
above analysis that [60, 65] 
fdrvx~([p]; r) Vp(r) . 
(65) 
0 
We can derive a similar result from the rotational invariance if we define 
a path V(0 by 
7(0 = p(R(t)r) 
(66) 
where R(t) is a rotation in three dimensional space which rotates the vector 
r around a vector co by an angle t. If the functional E~ is invariant under 
rotations we find that E~c[y(t)] = E~c[p] is constant as a function of t and that 
[60] 
v~([p(R(O)r)]; r) = vxc([p(r)];R(O)r) . 
(67) 
So if we insert in vx~ the rotated density, then we obtain the same value in point 
r as vx~ with the original density in the rotated point R(O) r [20,60,65]: 
fdrv~¢([p]; r)r x Vp(r) . 
(68) 
0 
The constraints at Eqs. (65) and (68) are important checks on the accuracy of 
(non-variationally derived) approximate potentials, as they are usually not 
fulfilled by approximate potentials except in those cases where the fulfillment of 
these constraint is caused for symmetry reasons such as the spherical symmetry 
in atoms with a nondegenerate ground state. In the case of molecules these 
constraints will in general not be equal to zero for non-variationally derived 
potentials. 
123 

R. van Leeuwen et al. 
5.2 Long Range Asymptoties 
The exchange-correlation potential possesses a natural splitup into a long range 
and a short range part. The division into these two different parts is based on 
Eq. (14) for the exchange-correlation energy in terms of the coupling constant 
integrated pair-correlation function. If we take the functional derivative of this 
equation we find that we can write vxc as [66] 
vxc. ([{p~}]; rl) = ~¢, ~c,~ ([{P.}]; r) + f~,. 
([{p~}]; r) 
(69) 
where the screening potentials is defined as 
f P'l(r2) (.q~l.~([{p.}];rl, r2)- 1)dr2 
(70) 
as 
and the screening response potential as 
-resp 
• r 
= 
v~,,~,.,([(p.}], 1) 
1 ~, ~p,2(rz)po3(r3) 6~.,.,([{p.}];r2, r3) dr2drs. 
2.~.a J 
Ir2 -- rat 
t~Pa~(rt) 
(71) 
We will discuss in detail in the next section this potential, which incorporates 
the main features of the atomic shell structure. The screening potential is just the 
potential of the coupling constant integrated exchange-correlation hole. Due to 
the fact that this hole integrates to one electron, the screening potential has 
Coulombic long range asymptotics 
1 
f~,~.([{p.}];r) ,-~ -- 
(r--* ~) 
(72) 
r 
where r = [r[ and the same asymptotics has been proven [18] for the total v~,,.: 
1 
v~,~,([{p.}];r) ~ - 
- 
(r ~ oe) . 
(73) 
r 
From these formulas it follows that, being the difference of v~. and ~ ...... the 
• 
-resp 
response potential v~.=~,~ has an asymptotic decay which is faster than Coulombic. 
A quantity which is sensitively dependent on the asymptotic properties of the 
exchange-correlation potential is the value of the orbital energy of the highest 
occupied Kohn-Sham orbital. It can be shown [18,67] that this quantity is 
equal to minus the ionization energy of the system. Reproduction of this 
quantity therefore represents a severe test for approximate density functionals. 
However, typical errors for the most widely used density functional, the local 
density approximation (LDA), are 5 eV. A related deficiency of the LDA is that 
it does not reproduce bound state solutions for negative ions• The origin of this 
error can be traced to the incorrect asymptotic decay of the LDA exchange- 
correlation potential. This potential has an exponential decay into the vacuum 
as can be seen directly from the expontial decay of the density itself. The LDA 
electron is therefore too weakly bound and, for negative ions, even unbound• 
124 

Analysis and Modelling of Atomic and Molecular Kohn-Sham Potentials 
This breakdown of LDA in the outer region of the atom or molecule is also 
reflected in the exchange-correlation energy per particle exc(r) which can equiva- 
lently be seen as the potential due to the exchange-correlation hole and which 
has an asymptotic decay like - 1/2r. The LDA in this case again gives an 
exponential decay. In the electron gas this quantity exc is usually expressed in 
terms of the Wigner-Seitz radius r~ representing the mean electronic distance 
1 
which is proportional to p-~. If the local density approximation is applied to 
the outer regions of atoms and molecules, r, grows exponentially and loses its 
meaning as a mean interelectronic distance which should grow linearly. The bad 
representation of this quantity by LDA explains the failure of LDA in this 
region. 
One might now wonder if the current gradient corrections, which yield large 
improvements over the LDA in energetics, give any improvement for this 
asymptotic failure of LDA. This is however not the case as is immediately 
apparent from the fact that the GGAs give almost no improvement in the LDA 
eigenvalues, being generally also in error by 5-6 eV. We display some atomic 
results for some widely used GGAs in Table 1. The column VWN represents the 
LDA functional in the Vosko-Wilk-Nusair [68] parametrization of the electron 
gas data. The functional BLYP denotes the Becke exchange [15] in combination 
with the Lee-Yang-Parr [16] correlation functional and BP86 denotes the 
Becke exchange [15] with the Perdew 1986 [10] correlation functional. The 
functional PW91 represents the Perdew-Wang 1991 [11,13, 14, 69] exchange- 
correlation functional (used together with Perdew's parametrization of electron 
Table 1. Ionization energies in atomic units from the highest occupied 
Kohn-Sham orbital. The mean absolute deviation from experiment is 
denoted by A 
ATOM 
VWN 
BLYP 
BP86 
PW91 
EXPT 
He 
0.570 
0.585 
0.584 
0.583 
0.903 
Li 
0.t16 
0.1tl 
0.120 
0.119 
0.198 
Be 
0.206 
0.201 
0.209 
0.207 
0.343 
B 
0.151 
0.143 
0.151 
0.149 
0.305 
C 
0.228 
0.218 
0.228 
0.226 
0.414 
N 
0.309 
0.297 
0.309 
0.308 
0.534 
O 
0.272 
0.266 
0.267 
0.267 
0.446 
F 
0.384 
0.376 
0.379 
0.379 
0.640 
Ne 
0.498 
0.491 
0.494 
0.494 
0.792 
Na 
0.113 
0.106 
0.115 
0.113 
0.189 
Mg 
0.175 
0.168 
0.177 
0.174 
0.281 
AI 
0.111 
0.102 
0.114 
0.112 
0.220 
Si 
0.170 
0.160 
0.173 
0.171 
0.300 
P 
0.231 
0.219 
0.234 
0.233 
0.385 
S 
0.228 
0.219 
0.223 
0.222 
0.381 
C1 
0,305 
0.295 
0.302 
0.301 
0.477 
Ar 
0.382 
0.373 
0.381 
0.380 
0.579 
A 
0.173 
0.180 
0.172 
0.173 
125 

R. van Leeuwen et al. 
gas data). The numbers for the BLYP functional were taken from [70], and the 
other data were calculated by a numerical atomic code [71]. Our self-consistent 
results for the eigenvalues of the PW91 functional are in excellent agreement 
with the results of [70]. From the table it follows that the GGAs hardly improve 
the LDA eigenvalues. The BLYP functional yields even worse eigenvalues than 
LDA. 
5.3 Atomic Shell Structure 
For the study of the atomic shell structure properties of the exchange-correla- 
tion potential, the division of vxc in a long range and a short range part is 
particularly useful. One can split up the long range potential v ...... and the short 
range potential vx~.'e~v~, further into an exchange and a correlation part. The 
exchange-correlation potential t,~, = vx + vc can now be written as an exchange 
and a correlation part with corresponding screening and screening response 
potentials: 
vx~([{p~}];r) = v ..... ,([{p~}];r) + v~,~([{p~}];r) 
(74) 
and 
G(E{p,}]; 
r) = 
..... ([{p.}]; r) + 
r) 
(75) 
where the potentials v ..... and f~ .... and their responses are defined as in Eqs. (70) 
and (71) with ~ replaced by g~ and 0~ + 1. The potential v~.,c~ has a Coulombic 
asymptotic behavior due to the fact that the exchange hole integrates to one 
electron. There is no Coulombic term in ~,~¢, as the coupling constant integrated 
Coulomb hole integrates to zero electrons. 
The exchange-correlation potential Vx¢ reflects the atomic shell structure (see 
below). The shell structure of v~ arises from that of the pair-correlation function 
~. The shell structure of the latter, in its turn, originates from the antisymmetry 
property of the wavefunction of the system and is mainly an exchange effect. We 
will therefore consider first the exchange-only case. The influence of correlation 
effects on the atomic shell structure will be discussed at the end of this section. 
In Fig. 3 fie plot the pair-correlation function of the OPM ~oe~a t, 
~sa 
~'1, r2) 
-
-
 
1 
for the case of the beryllium atom. As in the Be atom only s shells are occupied, 
this function only depends on the radial distances rl = [r~l and r2 = Irz[ of 
electrons 1 and 2 from the atomic nucleus and not on the angle between vectors 
rl and r2. This is a convenient feature for analysis. As Be is a closed shell atom, 
g~ is equal for up and down spin, i.e., g~r = g~l- In the Be atom the boundary 
between the ls shell and 2s shell is at a radial distance of about 1 bohr. From 
Fig. 3 we can see that O~,(rl, rz) -- 1 is close to - 1 along the diagonal where 
r~ ~ r2. This is an effect of the Pauli principle, the probability that two electrons 
of the same spin are at the same position is zero. A rather striking feature of 
g~o(r~, r2) - 1 is that it is close to - 1 if r~ and r2 are in the same shell, but is 
close to zero if r~ is in one shell and r2 is in the other. This is in agreement with 
126 

Analysis and Modelling of Atomic and Molecular Kohn-Sham Potentials 
0 
~ 
-0.2 
-0.4 
-0.6 
-0.8 
2.5 
-1.0 
2.0 
...... 
1.5 
o 
.... :::iii!:;:!::!::::.:....._ 
........ 
1.0 
r2 
0.5 
Fig. 3. The pair-correlation function of the OPM e~(rl, r2) -- I for Be as a function of the radial 
distances r 1 and r2 of electrons 1 and 2 
the well known fact that the exchange hole surrounding a reference electron at 
position rl has the shape of the shell in which the reference position is located. 
This holds irrespective of where the reference electron is located in that shell, 
which agrees for given rl with gs,(rl, r2) - 1 being approximately - 1 for r2 in 
the same shell but switching to zero when r2 crosses the boundary region of the 
other shell. The plots demonstrate that this atomic shell structure of the 
pair-correlation function is very distinct. 
The exchange-only potentials are given by 
f p~(r2) 
r2) - 1) dr2 
(76) 
Ux, Scr~r([ {pa} ]'~ r l) 
--721 (g'*([{P'}]; r,, 
,.,, 
. 
ag,,([{p,}]; r,, 
.
.
.
.
.
 
ar i ar2 
vx,~c,,([{p,}],r3) = 
j 
It1 -- r21 
6p,(r3) 
(77) 
the potential v ...... being just the potential of the Kohn-Sham exchange hole. It 
is identical to the average Hartree-Fock potential introduced by Slater [39, 721 
except for the fact that the orbitals involved are Kohn-Sham orbitals instead of 
Hartree-Fock orbitals. Due to fact that the exchange hole integrates to one 
electron, this potential (also denoted as Slater potential Vs) has long range 
Coulombic - 1/r asymptotics in finite systems. It is also a smooth function of 
the radial coordinate r in atoms. The other part of the exchange potential 
vx,'esPscr, is short range and repulsive. 
In order to better understand the structure of the v'e~P~.~c,¢ potential we must 
calculate the functional derivative of the Kohn-Sham pair-correlation function. 
This function describes the sensitivity of the exchange screening between two 
electrons at rl and r2 to density changes at point r3. One property of this 
127 

R, van Leeuwen et al. 
function is readily derived. As gso(rl, ra) = 0 for any electron density it immedi- 
ately follows that 
6gs~' (rl, rl) = 0 . 
(78) 
8p~(r3) 
This puts a constraint on approximate functional derivatives of gs,- In 
general from the definition of gs, it follows that 
6g~,'(rl, rz) 
_ (7,o,(r1, 
, 67~'(rl, r2) 
) 
1 
dip,(r3) 
= 
r2) ~ 
r-~ + c.c. p,,(rl)p,,(r2) 
6(rl --r3) 
6(rz--rs)'](g~,(rl, r2)-- 1)6a,. • 
(79) 
p,(r0 
~ 
p,(r2) 
f 
From the constraint at Eq. (78) it follows that the functional derivatives of 
7~, must contain delta functions in order to cancel the delta functions in the 
second part of the above equation for rl equal to rz. As 7~o depends explicitly on 
the orbitals we therefore have to calculate the functional derivative of the 
Koh~Sham orbitals with respect to the density which is given by [66] 
&bio,(r0 = _ 6,~, ~Gi.(rl, r~)~bi~(r4)xLl(r4, rs) dr~ . 
(80) 
6P,(r3) 
3 
From this equation it follows that 6gs,/fip,, is diagonal in the spin indices. 
We will therefore in the following put a = a'. Note that ZL ~ is defined up to an 
arbitrary constant, as a density variation 6p,(r) determines the potential vari- 
ation 6v,,(r) only up to a constant (see also [66] ). To find an explicit expression 
for the above functional derivative we must find an expression for the inverse 
density response function ZL x. In order to do this we make the following 
approximation to the Greens function (see Sharp and Horton [39], Krieger et al. 
[213): 
G~,(rl, rz) = ~gi (6(rl - r2) 
q~,.(rl) ~b~(rz)) 
(81) 
where Agi, is some mean energy difference. Just as the exact Greens function of 
Eq. (29), the above approximate Greens function projects orbital ¢~, to zero. 
This approximate Greens function leads to a simplified expression for the 
density response function. The inverse of this function is derived in [66] using an 
approximation which fixes the arbitrary constant (i.e., the gauge of potential v~) 
so that v~o ~ 0 in infinity. It is given by 
N.- 1 
1 ~ia(r2)12 q~ka(r3)12 
(82) 
xLl(rz, r3) - 6(rz - r3) + 
~ ~5 
a,(r2) 
ik 
a,(r2)ao(r3) 
where 
N, 
2f~ 
av(rl) = T 
~ -- ~ 
I~bi~(rx)12 
(83) 
128 

Analysis and Modelling of Atomic and Molecular Kohn-Sham Potentials 
and where the q'Zk are given by 
2f}, ([_/q.)~ ~ 
(84) 
~'~ = 
- ae,--S 
for i, k = 1 ..... N, - 1. Matrix No is given by 
-o 
2A" ~ tgb'o(r)lz[~--ko(r)t2 dr 
(85) 
N ~k = 
Agko .l 
ao (r) 
for i, k = 1 ..... N, - 1. With this inverse density response function one obtains 
[66] 
6O,o(r~, r2) = So(rl, r2, r3) + Do(rx, r2, r3) 
(86) 
6Po(r3) 
where S. is a part we will call, for reasons to be explained, the steplike part. The 
steplike part So and delta function part Do are in the additional approximation 
Agio = Ago explicitly given by 
(ffso(rl, r3) 
Po(---gso(rl, 
rl) 
r2)) 
Do(rt,r2, r3)=3(rl- 
r3)\ 
and 
where 
(g,.(r2, r3) -_ g,, (rl, r2!) 
+ 3(r2 -- r3) \ 
po(r2) 
S.(rl, r2, r3) - 
~'~,(rl. r2) y. 4~*(rl)4~i,(rz)~2~k 14~k°(r3)12 
P,(rl)p.(r2) i 
k 
p,(r3) 
I?..(r,,rz)12~r.[-14~.(r,)l z 
14~.(rz)l z] 
/~ bkl 
-
-
 
.3ff 
p~(rOp~(r2) u 
[_ po(r~) 
po(r2) ] 
Iq~t~(r3)l 2 
× -
-
 
p,(r3) 
(87) 
(88) 
(~ = (/-_ ~7,)-1 
(89) 
for i, k = 1 .... , No - 1 and zero otherwise. Matrix M" is defined as 
-~Tk =f~o ;! q~i°(r) 12 Iq~k°(r) 12 dr 
p,(r) 
(90) 
for i, k = 1 ..... No - 1. Note that So as given by Eq. (88) satisfies the relation 
So(r1, rl, r3) = 0 in accordance with the constraint at Eq. (78). This constraint is 
not satisfied for this function So if we take all the average orbital energies Agio to 
be different [731. The delta function part Do of Eq. (87) unlike So, does not 
129 

R. van Leeuwen et al. 
satisfy D,(rl, rl, r3) = 0; however it satisfies this constraint in an integral sense: 
fD~(rl, 
r3)drl = 0 
(91) 
rl, 
i 
Some properties of the function S, are readily derived from Eq. (88) and they 
are illustrated in Fig. 4, where we plot the S, part of the functional derivative 
6gs(rl, rz)/6p(r3) for the Be atom as a function of r2 and r3 with rl being fixed at 
0.1 bohr which is well within the Is shell. When electrons at rl and r2 are well 
separated in different atomic shells, the one-particle density matrix 7s,(rl, r2) is 
small and consequently the function S, should also be small. If on the other 
hand the two electrons are close to each other within the same atomic shell then, 
because S, is exactly zero for rl = rz, the function S, will also be very small. 
Indeed, S, in Fig. 4 is small when the other electron at r2 is situated either in the 
ls shell or in the 2s shell. This function only becomes large when electron 
2 crosses the boundary between the ls and 2s shells at a radial distance of about 
1 bohr. However, S, is then only large when r 3 is also located within ls shell. 
The step structure of S, as a function of r 3 is determined by factors of the 
form I~ka(r3)Iz/p.(r3) (see Eq. 88), each factor being approximately a constant if 
r3 is within atomic shell k. The contribution of this factor to the total function 
S, is governed by the constants (Tk describing the coupling of the density 
perturbation in shell k with an electron in shell i. These constants are largest if 
i = k. Figure 4 clearly displays the step structure of S, as a function of r 3 in the 
region around rz = 1 bohr. 
The discussed step structure of S, yields the corresponding structure of 
Ox ,respscm, which follows from the insertion of Eqs. (86)-(88) into Eq. (77). After 
multiplication by the function p(rt)p(r2)/I rl - r21 and integration over rl and r2, 
the r 1, r2-dependent parts of S, yield coefficients in front of the abovementioned 
ra-dependent functions Iq~k,(r3)12/p,(r3). The latter are not involved in the 
integration, so that the step structure of S, is transferred to _:,,~,'esv~,,. Carrying out 
o_1 
.. 
2.5 
"" 
1.0 
15 
~
~
0
.
5
 
r3 
r2 
~.o 
2.5 0 
Fig. 4. The So part of the functional derivative 3as.(rl, r2)/3pa(r3) as a function of the radial 
distances r2 and r3. Electron 1 is located at rl = 0.l bohr 
130 

Analysis and Modelling of Atomic and Molecular Kohn-Sham Potentials 
"P 
[73] that 
this integration, one finds for v ..... 
resp 
/ 
x 
i 
Vx. scra it) ------- 
N~ 
(a~,.)-' pi.(r) 
i 
which yields for the exchange potential 
"~'P "" = W jr) + 
v~,(r) = v~.~,,(r) + v ..... tr) 
+ W,(r) - v~ ..... (r) 
(92) 
N~- 1 
i 
N¢ 
~ (A~i~)- I pi.(r) 
i 
(93) 
In the above expressions we defined [39] 
N, 
W,(r) = i 
(94) 
N. 
~(Agi,)- 1 pi,(r) 
i 
where Pi, = f, ] q~i,I z and 
1 
N.f./~ ~bi,(r2) t~ka(r2). --, . . 
1 
~E x 
v,,(rl)= 
~b*~-(rl)~__" 
]~r2i 
ar2q~k'lrg--f~cP*(rl)ffb,,(rl) 
(95) 
which is equal to the orbital-dependent exchange potential within the Har- 
tree-Fock approximation (except for the fact that we do not use Hartree-Fock 
orbitals). Note that W, is equal to the average exchange potential or Slater 
potential [72] except for the energies Agi,. In fact this expression for the 
potential W, already appeared in the work of Sharp and Horton [39] in which 
they discuss the Slater potential. The constant g~, is defined as 
= fv,o(r) l @io(r)l 2 dr 
z3io 
(96) 
and fxo~ is a similar average for the exchange potential v~ over the orbital density 
I@~0t 2. It is easily recognized that the first term in Eq. (92) represents a step 
function. If r is located in shell I, so that all other orbitals have small amplitude 
at r, the function P~o(r)/p jr) will be almost equal to a constant of the order 1, 
which will be multiplied by the value of fi, - fxoi. The term W, - v ..... in 
Eq. (92) represents the difference between two long range potentials both having 
a Coulombic - 1/r behavior and it therefore decays faster than Coulombic. In 
the approximation Ag~ = Ago the potential W, reduces to the Slater potential 
v ..... and only the first term survives in Eq.(92). If we apply this same 
131 

R. van Leeuwen et al. 
approximation we obtain for the exchange potential the potential of Krieger et 
al. [2t]: 
vx, (r) = ,'7" 
p,(r) 
t- 
i 
p,(r) 
(97) 
We finally observe that if one multiplies Eq. (93) by ~°(A~i,)-lpi,(rl) and 
integrates over rt one can easily show that vx~ satisfies 
where m = N, corresponds to the highest occupied Kohn-Sham orbital ~bm,. 
This equation is exactly valid within the so-called optimized potential model 
(OPM) [21, 40, 41] exchange potential and also, as observed by Krieger et al., for 
the approximate exchange potential vx,, 
rLt [21]. 
.oP~ and ,,,e~p.oe~ and their sum, 
In Fig. 5 we plot for the beryllium atom v ..... 
~.s¢,, 
the exchange potential vx- 
oeM. In an OPM calculation [40] the exchange poten- 
tial and the orbitals ~b~ are obtained directly. The screening potential vx.-oeM~,~ is 
then calculated from the OPM orbitals according to Eq. (70), using g,, as 
defined in terms of the orbitals in Eqs. (18) and (19). The screening response 
potential is then simply the difference-v~°PM -- v~," 
oeM. ""'-,, ~ also display in Fig. 5 the 
V 
rasp 
x,scr 
-1 
-
-
 
OPM 
12 
...... KLI 
0.001 
0.01 
0.1 
10 
1 
Radial distance (Bohr) 
Fig. 5. The OPM and KLI exchange 
potentials with their components (in 
a.u.) for Be 
132 

Analysis and Modelling of Atomic and Molecular Kohn-Sham Potentials 
potentials vx," 
rLI~,, and vx,'c'P'KzJ=,, . The orbitals used to calculate the KLI potentials 
are not the OPM orbitals but are obtained from a self-consistent solution of 
Eq. (97). In Fig. 6 we present the same quantities for the krypton atom. As we 
can see from these figures the - oP~ and - XLZ 
vx.,c,~ 
vx,~,~ are so close that they cannot be 
distinguished on the scale presented. The step structure of the potential 
re, p.oeM is approximated quite closely by Vx,~r,~ 
, 
vx,~:,,, 
,e~p,xz.~ 
the largest difference being 
a constant within the ls shell. This testifies to the accuracy of the approximation 
to the Greens function used in the derivations. With respect to the accuracy of 
the KLI potential we observe that the only noteworthy difference with the OPM 
exchange potential is the smoothing of the intershell peak at the atomic shell 
boundaries in the KLI exchange potential. 
Let us now discuss the correlation effects on the atomic shell structure. We 
plot in Fig. 7 some of the described potentials for the case of the beryllium atom. 
The exact exchange-correlation potential vxc is calculated from an accurate CI 
(Configuration Interaction) density using the procedure described in 1-20]. The 
potentials v~, v ..... and vx,,,'~P,c, are calculated within the optimized potential 
model (OPM) [21,40,41] and are probably very close to their exact values 
which can be obtained from the solution for v~ of the OPM integral equation 
[21,40,41] by insertion of the exact Kohn-Sham orbitals instead of the OPM 
10 
-10 
-20 
-30 
- 
V 
resp 
~,,.,_~ 
x,scr Vx 
[] 
OPM 
........... 
"' 
,scr 
...... 
KLI 
-40-,. ...... ~ 
........ 
; 
........ 
; 
........ 
; 
........ 
; 
, 
0.001 
0.01 
0.1 
10 
1 
Radial 
distance 
(Bohr) 
Fig.6. The OPM and KLI exchange 
potentials with their components (in 
a.u.) for Kr 
133 

R. van Leeuwen et al. 
O 
-1- 
-2- 
-3 
.................................................................... "% 
\\ 
[] 
/ 
/I 
- 
/// 
... v,, o oPM 
// 
.
.
.
.
.
.
 
V~ ^ :esp,OPM 
_
~
,
 
; 
x,scr 
.; 
..... 
-4 
'' 
' 
' 
' 
. . . .  
i 
.
.
.
.
.
.
.
.
 
I 
' 
' 
' ' ' " 1  
0.01 
0.1 
10 
1 
Radial distance (bohr) 
Fig. 7. The exchange-correlation poten- 
tial and the OPM exchange potential 
with their components (in a.u.) for Be 
OPM 
" 
orbitals. We further plotted v,,c - 
v~,,sc, which can be regarded as an approxima- 
tion to ,,,e,p 
+ vc ,c,. Note the very clear step structure in v~:.]~. This potential is 
V xc, scr 
almost constant within the Is-shell and drops rapidly to zero at the atomic shell 
boundary between the ls and the 2s shell at a radial distance of about 1 bohr. As 
. oeM this step structure is somewhat 
can be seen from the graph of v~¢-v ..... 
smoothed by correlation effects but, as these effects are less important than the 
exchange effects, the step structure is still clearly visible. So the effect of 
correlation is mainly a smoothing of the atomic shell structure due to the fact 
that the correlation potential has a dip at the atomic shell boundaries [48, 74]. 
This behavior of the correlation potential is related to the fact that at the atomic 
shell boundaries the exchange hole is not so strongly localized around the 
reference position as when the latter is within a shell. This makes the effect of the 
correlation hole more noticeable at the atomic shell boundaries. A more detailed 
discussion of these points for the case of the Be and Ne atoms is given in [74]. 
5.4 Molecular Bond Midpoint Properties 
The number of studies on the exact exchange-correlation potential for molecular 
systems is very limited. Except for a thorough study by Buijse et al. [43] on the 
134 

Analysis and Modelling of Atomic and Molecular Kohn-Sham Potentials 
hydrogen molecule and a recent work by Gritsenko et al. [59] on the hydrogen 
molecule and lithium hydride LiH, we are not aware of any study on molecular 
exchange-correlation potentials. Such a study is however of great interest to 
workers in quantum chemistry where the use of density functional methods has 
become commonplace, as it may help to explain the success of the presently used 
density functionals and also show their limitations. 
In molecular systems new types of correlation come into play as compared 
to the atomic situation. In the case of molecular dissociation the so-called 
left-right correlation will cause a correct distribution of the electrons over the 
atomic fragments in the dissociation limit [75]. This correlation shows up as 
large changes in the molecular wavefunction in the bond region of dissociating 
molecules. How this influences the exchange-correlation potential we will dis- 
cuss in the following. 
For a spin restricted two-electron system such as the hydrogen molecule the 
occupied orbitals can explicitly be expressed in the electron density as 
$i = x/~. 
Substituting this in the Kohn-Sham equations then yields an 
explicit expression of the Kohn-Sham potential expressed in the exact ground 
state density. Buijse et al. [43] carried out a thorough investigation of this 
potential for the hydrogen molecule at various distances. The basic quantity in 
the analysis of Buijse et al. is the conditional probability amplitude 
• (r2 ..... rNIr~) defined by [76,77] as 
• (rl ..... rN) 
O(r2 ..... rNlr0 = xfp(rO/N 
(99) 
where qu is the ground state wavefunction of the system. The amplitude gives 
a description of the (N - 1)-electron system when one of the electrons is known 
to be at position rl. The amplitude squared gives the probability that the other 
electrons are at positions r2 ..... rN if one electron (the reference electron) is 
known to be at position rl. All the correlation effects of the system are contained 
in this quantity. 
These correlation effects particularly show up in this case of the hydrogen 
molecule when we move the position of the reference electron along the bond 
axis from one atom to the other atom. Due to the Coulomb correlation of the 
electrons we have that, if one electron is known to be at a given atom, then the 
probability amplitude is large that the other electron will be at the other atom. 
This changes rapidly when the reference electron crosses the bond midpoint 
region because in that case the other electron has to switch quickly from one 
atom to the other atom. A quantity which measures this change in conditional 
amplitude (the so-called left-right correlation effect) as we move our reference 
electron is the so-called kinetic potential defined by 
1 {" 
2 
l) kin(rl) 
J[V101 dr2-., drN . 
(100) 
This potential is clearly positive. The origin of the name of this potential stems 
135 

R. van Leeuwen et al. 
from the fact that it contributes to the kinetic energy of the system which is given 
by 
l ~VP)2dr + fp(r)vu~(r)dr . 
(101) 
T=~ 
P 
This follows directly from the definition of the kinetic energy and the formula at 
Eq. (99). Note that the first term in the above formula is the von Weisz/icker 
kinetic energy Tw[p] which for a two-electron system is equal to the Kohn- 
Sham kinetic energy T~[p]. The term with vu~ therefore contributes to the 
correlation energy E~ of the system. For the general case of a multi-electron 
system E¢ can be expressed as [74] 
E~[p] + ~ p(r)v~,s~,(r)dr + T¢[p] 
(102) 
T~[p] = f p(r)(vk,,(r) -- V,,k,,(r))dr = f p(r)v~,k,,(r)dr 
(103) 
where vc,~ is the potential of the Coulomb hole calculated at full strength of 
interaction 2 = 1 and v,,u, is the kinetic potential corresponding to the 
Kohn-Sham Slater determinant wave function. From the functional differenti- 
ation of Eqs. (102) and (103) correlation potential v~ can be obtained as 
,~p 
'~ ~-~ 
(104) 
v~(r) = v ..... (r) -~ V ..... (r) .~- I)c, kin(r ) -Ji- I)c,kln[It J • 
As the Kohn-Sham wave function has a delocalized exchange hole, and there- 
fore lacks the left-right correlation, v,,k~ is expected to display different bond 
midpoint features to vu~. In fact, V~.k~ is zero for two-electron systems, so that 
T~ [P] and vc reduce in this case to 
Tc [p] = fp(r) vu~(r) dr 
00s) 
(106) 
~- 
~resp ~r~ 
,~respfr't 
vc(r) 
v .... (r) + ...... -, + t,~i~(r) + ~ki~ ~-, - 
As has been shown in [431, vki~ is an important constituent of the 
Kohn-Sham correlation potential. In the dissociation limit Vk~ even becomes 
equal to the correlation potential vc in the bond midpoint region. By numerical 
calculation the following properties of the kinetic potential were observed 
[43,781. 
First of all this potential is peaked on the bond midpoint. As a result of this 
the total exchange-correlation potential is also peaked in this region. This peak 
in Vgi~ is not surprising from its definition. The changes in the conditional 
amplitude as we move our reference electron is the largest in the bond midpoint 
region as explained before. Secondly the peak in the kinetic potential gets higher 
when we dissociate the molecule. This is also what one expects since the 
left-right correlation effects grow stronger as we dissociate. This can also be seen 
from the well-known Hartree-Fock error for a dissociating system. The Har- 
tree-Fock one-determinant wavefunction upon dissociation no longer gives an 
136 

Analysis and Modelling of Atomic and Molecular Kohn-Sham Potentials 
accurate description of the division of the electrons over the atomic fragments 
by putting too much weight on ionic terms [79]. 
Let us discuss this property of the Hartree-Fock approximation in more 
detail in connection with the properties of the GGA exchange and correlation 
potentials in molecular systems, in particular the bond midpoint region. As has 
been discussed, the correlation potential exhibits a peak structure in dissociating 
molecules which is related to the left-right correlation effect. This left-right 
correlation effect consists mainly of the so-called near-degeneracy or non-dy- 
namical correlation. The lack of this type of correlation is the main reason for 
the failure of the Hartree-Fock approximation in dissociating molecules. As is 
well-known to quantum chemists, this type of correlation is readily described by 
extending the Hartree-Fock wave function by a smaller number of proper 
dissociation Slater determinants. This has a considerable effect on the shape of 
the exchange-correlation hole. From a completely delocalized hole in the Har- 
tree-Fock approximation (Fermi hole) it changes to a hole that is more or less 
localized around the reference electron [75]. This feature is illustrated in Fig. 8 
(taken from [75] and [79]) for the dissociating hydrogen molecule. If we now 
turn to density functional theory we observe that the LDA and GGA exchange 
holes are always localized around the reference electron. This means that they 
not only give a pretty accurate description of the exchange hole in atoms but 
also describe the long range non-dynamical correlation in dissociating molecu- 
les. This explains the fact that the exchange functionals which are constructed to 
reproduce exchange energies of atoms yield reasonable binding energies for 
molecules, even when no gradient corrected correlation functionals are used in 
the calculation [6]. The additional correlation functionals such as the PW91 
correlation functional yield correct correlation energies in atoms and have 
a correlation hole which is always located around the reference electron and 
may therefore be regarded as providing the remaining dynamical correlation (as 
well as part of the correlation energy contained in the kinetic energy functional). 
From the above we can expect that, if the functional derivatives of the GGA 
functionals give a good representation of the properties of the exchange-correla- 
tion hole, the near-degeneracy correlation properties responsible for the bond 
midpoint peak will show up in the exchange potentials rather than the correla- 
tion potentials. 
We illustrate the behavior of vc and its components vu. and vc .... (denoted as 
Vco,d- V he) for the hydrogen molecule in Figs. 9 and 10. Figure 9 displays 
Vki. and v~ (denoted as v~XS,) at an equilibrium distance of 1.4 bohr and Fig. 10 
displays the same quantities at a bond distance of 5 bohr. The sum (v~'~f, + v~,i~ p) 
denoted as v N- 1 is also presented. The most noticeable features in Figs. 9 and 10 
are the wells of v~,=, and v¢ around the H nucleus and the peaks of vu, and v~ at 
the bond midpoint. From these plots we can clearly see the growth of the peak 
structure at the bond midpoint upon dissociation of the molecule, vc inherits the 
bond midpoint peak of vu, and the well around the nucleus of vc ..... with the 
height of the peak and the depth of the well being very close (at the bond 
distance of 5 bohr) to those of Vkl, and v ...... respectively. 
137 

R. van Leeuwen et al. 
Fermi hole + 
Coulomb hole 
= 
total hole 
0.1 
RH-H = 1.4 bohr 
e 
-0.1 
-0.2 
-0.3 
~ 
~ 
i 
~ 
~ 
~ 
I
I
I
I
I
I
I
 
e 
1
1
1
1
1
1
1
 
0.1 
RH-H = 2.1 bohr 
e 
-0.1 
-0,2 
-0.3 
~ 
~ 
~ 
~ 
f 
~ 
I 
0.1 
RH-H = 3.0 bohr 
e 
-0.1 
-0.2 
-0.3 
L 
~ 
, 
, 
, 
, 
0.1 
0 
-0.1 
-0,2 
-0.3 
RH. H = 5.0 bohr 
e 
e 
,
1
1
1
1
1
1
t
 
e 
I
t
l
l
l
l
l
 
I 
I 
I 
~ 
I 
I 
I 
e 
I 
I 
I 
1 
I 
I 
I 
0 
e 
e 
I 
I 
I 
~ 
I 
..... I 
I 
I 
I 
I 
I 
I 
I 
2 
3 
4 
5 
6 
7 
0 
1 
2 
3 
4 
5 
6 
7 0 
1 
2 
3 
4 
5 
6 
7 
a.u. 
a.u. 
a,u. 
Fig. 8. Fermi hole, Coulomb 
hole and total hole in H2 at various bond distances. In all plots the 
reference electron is placed at 0.3 bohr at the left of the fight H atom 
In the limit of infinite bond distance the width of the peak of the potential 
vu. approaches zero and the height of the peak approaches a value equal to the 
ionization energy of the molecule [43, 78]. The asymptotic expression for 
T~ = T-Ts 
can be obtained with T calculated with the Heitler-London 
138 

Analysis and Modelling of Atomic and Molecular Kohn-Sham Potentials 
0.15- I 
vKS 
I 
........... 
V icrr 
| 
----- VN-1 
0.05 ~.......-~. -- -- ~ "" "~"" ""~'.-.., 
- ..... Vc°nd-VHF 
10 \ 
1.0 
2.0,,,I ~- 
3.0 .......... 4.0 
I 
\ 
R(au)~ 
.i ......... 
-o.o51 ~ 
....--"" 
> 
-0.15 
"\',--'"" 
-0.25 
Fig. 9. Correlation potential V~,o s, and 
its components for H2 at the equilib- 
rium bond distance of 1.4 a.u. Poten- 
tials are plotted along the bond axis 
as functions of the distance R from the 
bond midpoint. The H nucleus is at 
R = 0.7 a.u. 
0.4 
0.3 
0.2 
0.1 
0 
> 
-0.1 
"0.2 
-0.3 - 
-0.4 
KS 
Vcorr 
_ _ 
~''"\~'~..~._ 
.......... 
0""-,, 
~1'.0 ........... 2:0 
310 
4:0 
"%,, 
4__..." 
Fig. 10. Correlation potential V~oS,, and 
its components for H2 at the bond dis- 
tance of 5.0 a.u. Potentials are plotted 
along the bond axis as functions of the 
distance R from the bond midpoint. The 
H nucleus is at R = 2.5 a.u. 
wavefunction [80] and T~ calculated with the minimal basis Slater determinant 
wavefunction, which yields 
2(ToS,,b 
- 
T~b)(1 -- Sob) 
T~ = 
(I + Sab)(1 + S~) 
(107) 
Here To, Ta~ are the kinetic integrals 
T. = 
- ~ 
a (r)V2a(r)dr 
(108) 
139 

R. van Leeuwen et al. 
l X 
Tab = 
-- ~ 
a*(r)VZb(r)dr 
and Sab is the overlap integral 
0o9) 
S~b = f a* (r)b(r) dr 
(110) 
of the ls-type atomic orbitals a(r) and b(r) located on the H atoms A and B, 
respectively. Tc for the hydrogen molecule decreases with the decreasing Sab and 
Tab at longer bond distances and it becomes zero in the infinite separation limit, 
but the traditional correlation energy T - 
T nr is large (equal to minus the large 
correlation energy of - 0.2565 a.u. [75]). 
This can also be deduced from a coupling constant argument with the use of 
Eq. (15) [81]. In this equation Tc is expressed in terms of the coupling constant 
integrated pair-correlation function and the full (2 = 1) pair-correlation func- 
tion. The Hamiltonian at coupling constant 2 consists of a two-particle interac- 
tion term ~./r12 and an external potential va which is defined in such a way that 
the density remains the same for all 2. Let us now consider the H2-molecule at 
large bond distance R. The interaction term 2/r~2 for 2 > 0 will favor wave- 
function configurations in which the two electrons are residing on different 
atoms (i.e. the Heitler-London wavefunction). The density corresponding to this 
ground state wavefunction qJ~ will be exactly equal to the density corresponding 
to the wavefunction q?~ at full coupling strength, which at large R is a wavefunc- 
tion describing two weakly interacting hydrogen atoms. From these consider- 
ations it follows that 
lim qJz=q~a 
if2>0 
(111) 
R~oD 
while the external potential v). in the infinite separation limit R --, c~ approaches 
a value equal to its 2 = 1 value vl around each hydrogen atom. Note that the 
above relation is not true for the 2 = 0 wavefunction which will be just 
a Kohn-Sham determinant with a doubly occupied a 0 orbital. The 2 = 0 region 
however becomes unimportant in the coupling constant integration for the 
pair-correlation function and we have 
lim f 1 g~,-2([{P-)]; rl, r2)d)~ = g~,,2([{p,}]; rl, r2)d2 
R~oo Jo 
= g~l.o2([{P~}]; rl, r2) 
(112) 
and it follows that Tc becomes zero in the infinite dissociation limit. As an 
illustration we plot in Fig. 11 several kinetic energy terms as a function of the 
bond distance corresponding to the dissociating H2-molecule. The quantity 
Tcl represents the nearly exact kinetic energy calculated from a full-CI wave- 
function, The quantity T~ corresponds to the Kohn-Sham kinetic energy cal- 
culated from the CI-density. We further plotted the kinetic energy T nr corres- 
140 

Analysis and Modelling of Atomic and Molecular Kohn-Sham Potentials 
2.0- 
1.8- 
1.6- 
1.4 - 
TsLDA 
-, 
/ 
t.2- ~
,
 
1.0- 
"." .
.
.
.
.
.
.
.
.
.
.
.
 
0.8 - 
T HF 
"'¢~.'.-. 
S 
........................... 
1.0 
2.0 
3.0 
4.0 
5.0 
6.0 
7.0 
8.0 
9.0 
Bond distance (Bohr) 
Fig. 11. The CI, HF, LDA and Kohn-Sham kinetic energies (in a.u.) for H2 as functions of the bond 
distance 
ponding to a Hartree-Fock wave-function and the LDA Kohn-Sham kinetic 
energy T~, ~a. The difference T cl- T~ represents the quantity To. As can be 
deduced from this plot Tc becomes zero in the dissociation limit. 
The conclusions reached here apply equally well to general multi-electron 
homonuclear molecules. In this case the value of T~ in the dissociation limit 
becomes equal to the sum of the T, contributions of the atomic fragments. The 
).-integrated exchange-correlation hole for a reference electron on one of the 
atomic fragments will then be equal to the 2-integrated hole of the atom itself. 
The properties of the exchange-correlation in heteronuclear molecules are 
discussed in the next section. 
5.5 Derivative Discontinuities and Charge transfer 
Up to now we have been discussing the local properties of the exchange- 
correlation potential as a function of the spatial coordinate r. However there are 
also important properties of the exchange-correlation potential as a function of 
the particle number. In fact there are close connections between the properties as 
a function of the particle number and the local properties of the exchange- 
correlation potential. For instance the bumps in the exchange-correlation po- 
tential are closely related to the discontinuity properties of the potential as 
a function of the orbital occupation number [38]. For heteronuclear diatomic 
molecules for example there are also similar connections between the bond 
midpoint shape of the potential and the behavior of the potential as a function of 
the number of electrons transferred from one atomic fragment to another when 
141 

R. van Leeuwen et al. 
the two atoms are brought together [82, 83]. Another important physical 
process where the particle number is changed is ionization. 
More insight into these processes is obtained by studying the particle 
number dependent properties of density functionals. This of course requires 
a suitable definition of these density functionals for fractional particle number. 
The most natural one is to consider an ensemble of states with different particle 
number (such an ensemble is for instance obtained by taking a zero temperature 
limit of temperature dependent density functional theory [84]). We consider 
a system of N + co electrons where N is an integer and 0 < co _< 1. For the 
corresponding electron density we then have 
fp(r)dr = N + co 
(113) 
I 
This density can be obtained from the ensemble density matrix 
D,o = (1 - co)bN + o)b~+ 1 
(114) 
where b u and [)~ + ~ are N and N + 1-particle density matrices. We now extend 
our definition of the functional FL to fractional particle number with 
F~'[p] = min Trbo~(f+ g') 
(115) 
where the minimum is searched over all density matrices of the form of Eq. (114). 
The energy functional is then defined as 
U~[p] = F'~[p] + f p(r)v(r)dr . 
(116) 
The ground state energy of this fractional system is then obtained by 
EN+,~ = min E~ [p] 
(117) 
p 
where the minimum is searched over all densities integrating to N + 69 electrons. 
It is however readily shown from the definition of E7 that the ground state 
energy of the N + e)-electron system is given by [1] 
EN+,~ = (1 - CO)EN + COEN+ 1 
(118) 
where EN and EN+ 1 are the ground state energies of the N and N + 1-electron 
system. The corresponding ground state density is given by 
pN+,o(r) = (1 - co)pu(r) + copz~,+ l(r) 
(119) 
where PN and PN ÷ 1 are the ground state energies of the N- and N + 1-electron 
system. 
Corresponding to the interacting N + co-electron system we now define 
a Kohn-Sham potential v~(r; N + co). This is a local potential defined by the 
requirement that it must yield the same density pN+,o in a fictitious noninteract- 
142 

Analysis and Modelling of Atomic and Molecular Kohn-Sham Potentials 
ing Kohn-Sham system: 
[ - ½ V 2 + v, ([pu +,~]; r)] ~i (r) = 8i(N + ~o) tpi(r) 
(120) 
N 
pN+~,(r) = ~ Iq~i(r)l 2 + ml4)N+l(r)[ 2 . 
(121) 
i=1 
So the highest occupied Kohn-Sham orbital has a fractional occupation 
number ~o. The fact that v~ is uniquely defined by PN + o, follows directly from the 
Hohenberg-Kohn theorem applied to the non-interacting system. The proof of 
the Hohenberg-Kohn theorem for systems with noninteger number of electrons 
proceeds along the same lines as for systems with integer particle number 
(alternatively it can be obtained from the zero temperature limit of temperature 
dependent density functional theory [82]). We further split up v~ as 
vAr;N + 09) = v(r) + ~ p(r') dr' + v~¢(r;N + to) 
(122) 
Jlr - r'l 
(for convenience we use the notation v~(r; N + 09) = vA[pN+,o]; r)). This equation 
actually defines v~,. One can, however, show that v~ is obtained as the functional 
derivative of the exchange-correlation energy functional E~% defined by 
1 [';(r) p (r') 
E~c[p] = F'°[p] - 
T~°[p] - - ~ j ~  
drdr'. 
(123) 
However we do not need this property in the following discussion. Now as 
v~ is defined up to a constant we are free to choose a suitable value. As usual this 
constant is fixed by requiring the potential to be zero at infinity: 
lim v~(r;N + 09) = 0 . 
(124) 
r~oo 
As the Hartree and external potential also vanish in this limit we have equiva- 
lently 
lim vxc(r; N + to) = 0. 
r-~oo 
Using this equation we find the following 
Kohn-Sham orbital densities: 
[~bi(r)t 2 ~ e- 2 -x/'E~'r 
(r--* o0) . 
asymptotic 
(125) 
behavior of the 
(126) 
As the fractionally occupied orbital ~bN + x has the slowest decay, the asymp- 
totic behavior of the density for 0 < 09 < 1 is determined by this orbital and 
given by 
pN+,~(r) ~ e - zj2~,~u +,~r 
(r ~ 
~ ) . 
(127) 
On the other hand we know that PN+,o is a linear combination of N- and 
N + 1-particle densities for which the the asymptotic behavior is determined by 
143 

R. van Leeuwen et al. 
the ionization energies IN and IN + ~. One has 
p~+l(r)--* e -2v~'~ 
(r~ 00) 
(128) 
with a similar equation for PN. As the ionization energy for an N + l-particle 
system is smaller than that of an N-particle system we have IN+ 1 < IN. This 
means that PN+ 1 has a slower asymptotic decay. Therefore for 0 < to K 1 we 
have 
pN+to(r) ~ e- 2 ~  
(r---* co ). 
(129) 
If we compare this with Eq. (127) we find 
eN+I(N+o2)= --IN+I=eN+I(N+ 1) (0<to< 
1) 
(130) 
which means that the eigenvalue of the highest occupied Kohn-Sham orbital is 
independent of the occupation number 09 for 0 < 09 < 1. This interesting con- 
clusion has been verified numerically in the exchange-only OPM model by 
Krieger et al. [21] (this conclusion has also interesting consequences for the 
Slater transition state method [85] for the calculation of excitation energies.) 
Let us now turn to the properties of v= as a function of 09. We compare the 
potentials v=(N + 09) to the potential v~(N) for small to. The densities produced 
by these potentials are then similar in regions where the density PN dominates 
PN+~. For spherical systems one has for example a radius R(to) for which 
P.,~+~, ~ PN for r < R(09). An appropriate definition of such a radius is for 
example given by the equation 
(t - to)pN(R(to)) = toPN+ 1 (R(to)) . 
(131) 
If we use the fact that to is small and the asymptotic property 
pN(r)~ ANe -~ 
(r~ oo) 
(132) 
where ~U = 2x/~N, one finds 
R(to) = (ctN - ~N+ 0 -lln -- As 1 
AN+ I o3 
(133) 
÷ - (~N - ~N+ ,)- 1 Into 
(to ~ 0) 
which becomes infinite as expected when to approaches zero. As v~(N + o2) and 
Vxc(N) generate the same density in the region r < R(to) they can at most differ 
by a constant A in this region. For r --* 0o both v~(N + to) and vxc(N) become 
zero by definition. Therefore one has 1-83] 
v~(r;N + to)- Vxc(r;N)= { 
/f 
T < R(o2) 
(134) 
if 
r ~> R(to) . 
In the limit to J. 0 the radius R(¢o) becomes infinite and both potentials differ by 
a constant a everywhere, we will now show that A is unequal to zero. If we now 
insert vxc(N + to) = Vx~(N) + A in the Kohn-Sham equations for the N + to- 
particle system and use the fact that for small to the orbitals in the region 
144 

Analysis and Modelling of Atomic and Molecular Kohn-Sham Potentials 
r < R(og) are equal to the orbitals of the N-particle system, we obtain 
ei(N + 09) = ei(N) + A 
(w .[ O) . 
In particular we have for i = N + 1 that 
(135) 
A = lim(es+l(N + co) - eN+I(N)) = -- IN+I -- es+l(N) 
(136) 
where we used the og-independence of es + I(N + ~o) of Eq. (130). Therefore A is in 
general nonzero. Using eN÷ z(N + 1) = - IN÷ i one therefore finds the following 
discontinuity in v~c: 
lim Vxc(r;N + co) - Vxc(r;N) = ~N+I(N q- 1) - 8N+I(N) 
. 
(137) 
tolo 
Numerical results on Eq. (136) can be found in [82]. The reference also shows 
that the change from 0 to A in the difference Vx~ (N + co) - Vx~ (N) is quite rapid 
and has a steplike behavior with the step moving to infinity as co ~ 0. 
From the above considerations we can now also see how the atomic shell 
structure is related to the discontinuities in Vxc as a function of the orbital 
occupation. As a new shell is filled with fractional occupation co a steplike 
function is added to the Kohn-Sham potential. This step function has value 
A for r < R(~o) and becomes zero for larger values of r. As co increases and the 
shell gets filled the step moves inward. If the shell is finally completely filled the 
step function stabilizes at a value of r which is at the atomic shell boundary of 
the last two filled atomic shells [38]. The atomic shell structure is thus introduc- 
ed by adding a series of step functions. This is perfectly consistent with our 
former results in which we showed that the short range part of vxc which was 
responsible for the atomic shell structure consists of a superposition of steps. 
This conclusion, which has also been reached by Krieger et at. [38], shows that 
in order to obtain an accurate exchange-correlation potential correctly describ- 
ing the atomic shell structure one must construct exchange-correlation func- 
tionals with the correct derivative discontinuities at integer particle number. 
This is however rather difficult using density functionals depending on the total 
density or its gradients. However, as shown by Krieger et al. [21], one can 
construct accurate exchange-correlation potentials possessing the integer 
discontinuity property by using orbital-dependent exchange-correlation 
functionals. 
We will now consider the consequences of the integer discontinuity for the 
chemical bonding situation. For this purpose we consider a system of two 
well-separated atoms A and B with different ionization energies [83]. We study 
the energy change in the system when charge is transferred from one atom to the 
other. For each atom we therefore have to study the change in total energy when 
we change the number of electrons. From Eq. (118) we find 
lim dEN + o, 
0,1o ~o 
-EN+I-EN= 
--AN 
(138) 
145 

R. van Leeuwen et al. 
where AN is the electron affinity of the N-electron system. So the right derivative 
of Es+,o yields minus the electron affinity. Let us now calculate the left deriva- 
tive. If in Eq. (118) we make the replacements N --* N - 1 and to --, 1 - to we 
obtain 
EN-,o = toEN-I + (1 -- to)EN • 
(139) 
From this equation we find 
lim OEN-~ = EN-1 --EN = IN 
(140) 
~o~o 
~to 
where IN is the ionization energy of the N-electron system. This means that the 
left derivative of EN +,~ is given by minus the ionization energy of the system. We 
therefore have 
St(N+og)=t3EN+,,, 
(-At,, 
if 0<o9<1 
8to 
IN 
if 
--l<to<0 
. 
(141) 
We thus find that the derivative of the total energy with respect to the particle 
number is a discontinuous function with discontinuities located at the integer 
particle numbers N. We now turn back to the problem of two different atoms at 
large distance from each other. In this system the discontinuity of # is essential 
for keeping both atoms neutral. This is readily shown. Suppose st is a continuous 
function of the particle number. Without restriction, we can assume that st(A) > 
#(B). Then removing a positive number 6to of electrons from A to B yields the 
total energy change 6E = (St(B) - st(A))6oo < 0. This leads to the paradoxical 
result that the total energy is minimized with a net positive charge on A and 
a net negative charge on B [86]. However using Eq. (141) it is easily seen that the 
total energy 
E = EA-~ + EB+,~ 
(142) 
is minimized for to = 0. The discontinuous behavior of the energy as a function 
of the particle number is therefore essential for a correct division of charge over 
the atomic fragments. Functionals which lack this discontinuity, such as the 
LDA and GGA, will therefore lead to an incorrect division of charge over the 
atomic fragments. This can be explicitly shown for the local density approxima- 
tion [38, 82] which gives for the NaC1 molecule at large distance an energy 
minimum for Na + °'*C1-0.4. Explicitly orbital dependent approaches such as the 
OPM approach, the Krieger-Li-Iafrate approach and the Perdew-Zunger 
self-interaction-correction (SIC) method [87] however yield correct neutral 
fragments. 
Let us now take closer look at the relation of this charge transfer discontinu- 
ity and the shape of the exchange-correlation potential. We again take the 
example of two atoms A and B with ionization energies IA and IB at a large 
interatomic distance RaB [83]. We assume that I A < IB- These ionization ener- 
gies are equal to minus the highest occupied Kohn-Sham orbital energies of the 
146 

Analysis and Modelling of Atomic and Molecular Kohn-Sham Potentials 
atomic fragments. We will now show that flow of charge from A to B is 
prevented by the formation of a region of an additional constant positive 
exchange-correlation potential of value Is - IA around atom B. This shifts the 
orbital energies of atom B by a constant and makes the highest occupied orbital 
energy of atom B equal to the one of atom A. 
Now the molecule M = AB at large separation has an ionization energy 
IN equal to the lowest ionization energy of one of the atomic fragments, in our 
case IM = IA. This means that the highest occupied molecular orbital ~bM satis- 
fies 
[ -- ½V 2 + v~(r)] ~bM(r) = -- I~tq~M = -- la~bM 
(143) 
where ~ff is the molecular Kohn-Sham orbital. This further implies that the 
asymptotic decay of the density pu of the molecule M is determined by the decay 
of atomic density Pa of atom A. The density of atom A will have a dominant 
contribution at distances from the molecular system large compared to the 
interatomic distance Ran. Around atom A ~bM will be approximately equal to the 
highest atomic orbital ~b a of atom A and around atom B it will be approximately 
equal to the highest atomic orbital q~B of atom B. We therefore have around A 
[ --½V 2 + v~(r)]~bm(r) = - IM~ba = -- IadpA 
(144) 
which means that v~ is close to the Kohn-Sham potential v~ of atom A which 
will go to zero at large distance from atom A. Around atom B we have however 
[ -- ½V 2 + v~(r)] q~M(r) = - IM~bn = 
-- ladpn . 
(145) 
Now we know that the asymptotic decay of the density far from atom B (but 
not so far that Pn still dominates the molecular density pu) is determined by the 
ionization energy lB. The asymptotic decay of the density pn is however also 
determined by the highest occupied Kohn-Sham orbital ~bn. Then Eq. (145) 
implies that the Kohn-Sham potential cannot go to zero in the asymptotic 
region of atom B otherwise the density decay around atom B would be 
determined by IA. As the Hartree and the external potential go to zero in the 
outer asymptotic region it follows from Eq. (145) that the only possibility is that 
the molecular exchange-correlation potential vx M around atom B is given by 
M 
vxc(r) = vnc(r) + IB - Ia 
(146) 
where v~c is the exchange-correlation potential of atom B in the absence of atom 
A. We therefore see that the exchange-correlation potential around an isolated 
atom can change by a finite amount upon introduction of an atom with 
a different ionization energy at an arbitrarily large distance. 
Density functionals without integer discontinuity such as the LDA or GGA 
functionals do not show this kind of behavior. Within these approximations 
147 

R. van Leeuwen et al. 
charge would flow from A to B until the highest occupied orbital energies of 
fragments A and B become equal and therefore no constant shift of the ex- 
change-correlation potential arises. It may therefore well be possible to improve 
the current density functionals in chemical bonding situations by the inclusion 
of orbital-dependent terms. 
6 Approximate Kohn-Sham Potentials 
6.1 The Weighted Density Approximation 
An important concept in DFT is the exchange-correlation hole p~c and its 
coupling constant average. The importance follows immediately from the fact 
that the exchange-correlation energy E~c can be directly expressed in terms of 
this hole function. Therefore a considerable amount of work has been carried 
out aiming to improve existing density functionals by direct approximations of 
the exchange and exchange-correlation hole 1-32-34]. The current GGAs of 
Perdew and Wang for instance are derived by putting exactly known constraints 
on the exchange-correlation hole obtained from the gradient expansion. This is 
a semi-local approach as the properties of GGA exchange-correlation holes 
depend mainly on the local density and the gradient of the density at the 
position of the reference electron. A completely nonlocal approach which also 
directly approximates the exchange-correlation hole is the weighted density 
approximation developed by Alonso and Girifalco [90, 91] and Gunnarsson et 
al. [92,93]. The exchange-correlation hole p~c is expressed in the coupling 
constant averaged pair-correlation function by 
p~c~l~2(rl, r2) = p,2(r2)(g~l~(rl, r2) - 1) . 
(147) 
In the WDA # is approximated (for a spin-unpolarized system) by 
~,,,:(rl, r2) = ~,1,~(1rl - r2 l; ~(rl)) 
(148) 
where fi is a certain average density and ~ a suitable approximation usually 
determined in order to satisfy known exact properties. The functional depend- 
ence of ~ on the spin densities p~ is determined from the sum rule 
f 
p, z(rz)(~,~,2(trl -- r2l;/~(rl)) -- 1)dr2 = - 6,~ 2 
(149) 
(in the case of a spin polarized system one has two average densities PT and t~). 
The exchange-correlation functional now becomes 
1 V ~P~(rl)P'~(r2)(~ ~ (Jr1 -- r2l;fi(r0) - 1)drldr2. 
(15o) 
148 

Analysis and Modelling of Atomic and Molecular Kohn-Sham Potentials 
From this expression one obtains the exchange-correlation potential by func- 
tional differentiation 
v:,c,~(rl) = 
f Pa2(r2) .... 
1~ ~" p~2(r2) .... 
+ ~2.,/,------, tY~l~2l, lrl -- rzl;/3(r2)) -- 1)dr2 
2:~231rl - r21 
q- 1 ~ 
~p~2(r2)P~3(r3)a~3 (ir2 _ r3l;/~(r2) ) 
2~2,~3 
Ir2--r3t 
C~/9 (r2) . 
× -
-
 
at2 dr3 
(151) 
where the derivative 6#/6/9 is obtained by differentiation of the sum rule [94, 95]. 
The first term in the above equation has a long range asymptotic behavior of 
- 
1/2r in finite systems due to the fulfillment of the sum rule. However, due to 
the fact that the approximation at Eq. (148) does not exhibit the exact symmetry 
property O(rl, r2) = ~(r2, rl), the second term decays faster than Coulombic (for 
plots of these separate parts of vxc in atoms see [94]). Such a behavior could be 
corrected using symmetric approximations to the pair-correlation function, for 
instance by using the argument/~(rl) + ~(r2) instead of P(rl) [96]. Another way 
to correct the potential is to make the WDA approximation after functional 
differentiation. One then obtains 1-97, 98] 
vx~l(rl) = ~3{r I _ r2 t (g~l~2(Irl -- r2t; p(rl)) -- 1)dr2 
-b 12 ~2~33~ fpo2(r2)P~3(r3)0~2¢3(]r 
2
1
r
2
 
_ r31 
_ r31;~(r2) ) °P~t 
[rl)~p(r2)dr2 dr3 . 
(152) 
In this nonvariational approach for v~ the first term represents the potential 
of the exchange-correlation hole which has long range - 1/I" asymptotics. We 
recognize the previously introduced splitup into the screening and screening 
response part of Eq. (69). As discussed in the section on the atomic shell 
structure the correct properties of the atomic shell structure in vx¢ arise from 
a steplike behavior of the functional derivative of the pair-correlation function. 
However the WDA pair-correlation function does not exhibit this step structure 
in atoms and decays too smoothly [94]. A related deficiency is that the intershell 
contributions to E~c are overestimated. Both deficiencies arise from the fact that 
it is very difficult to represent the atomic shell structure in terms of the smooth 
function/~. Substantial improvement can be obtained however from a WDA 
scheme dependent on atomic shell densities [92, 93]. In this way the overes- 
timated intershell contributions are much reduced. Although this orbital-depen- 
149 

R. van Leeuwen et al. 
dent WDA scheme has never been applied self-consistently (which requires the 
functional derivatives of the orbital densities) we can predict that the short range 
part of Vxc involving the derivatives 30/3~i will be different in different atomic 
shells and reproduce the required step structure for this potential. 
Although the WDA scheme improves Vxc compared to LDA and GGA and is 
based on appealing physical ideas, it has practical disadvantages. The most 
important problem in actual calculations is determination of the average ~ from 
the sum rule. This requires a three-dimensional integration for each point rl of 
the density argument ~(rl). This makes the WDA expensive for other than 
spherical systems, such as molecules. The method has however been applied to 
solids in the atomic sphere approximation where it has been shown to correct 
substantially the overbinding of the LDA for the cohesive energies [99]. An 
application to molecular systems has recently been announced [95]. The ques- 
tion as to whether the method can compete with the accurate GGA results in 
molecular systems remains to be answered. In this respect the application to 
solid state problems, where the GGAs have less improvement over the LDA 
[100], seems more promising. 
6.2 Gradient Approximations for the Potential 
Gradient corrections to the local density approximation for the exchange- 
correlation energy Ex~ in the form of the GGAs have been very successful within 
quantum chemistry in the calculation of molecular binding energies. However 
the corresponding exchange-correlation potential vx¢ still has serious defi- 
ciencies, which shows that the success of the present GGAs is based on cancella- 
tion of local errors. It is therefore useful for further improvement of DFT to 
study the local properties of the various gradient corrected exchange and 
exchange-correlation potentials and to compare them with exact ones. This 
enables us to identify local errors of the gradient approximations which clearly 
show up in vx~ but which can cancel in Exc. A severe test of the gradient 
functionals for the exchange energy in this respect is the reproduction of the 
atomic shell structure and the Coulombic asymptotics. A corresponding severe 
test for the accuracy of the gradient functionals for the correlation energy is 
the correct description of molecular bond midpoint properties in dissociating 
molecules. 
We will treat the case of the exchange functional first. The functionals for 
correlation will be dealt with at the end of this section. For the discussion of 
gradient functionals for the exchange we introduce some commonly used nota- 
tion: 
1 
kr(r) = (37t2p(r)) ~ 
(153) 
x(r)= 231Vp(r)] s(r) 
IVp(r)[ 
(154) 
, 
= ~kr(r)p(r) 
p(r)~ 
150 

Analysis and Modelling of Atomic and Molecular Kohn-Sham Potentials 
( 
Vp(r) 
~2=s(r)2 
t/(r)= V2p(r) 
~(r) = \2kF(r)p(r)J 
4k~(r)p(r) 
2 V2p(r) 
(155) 
y(r) = 27 
s 
p~ 
These are all dimensionless combinations of the density and the density gradi- 
ents and Laplacians. This enables one to obtain the correct scaling properties of 
the exchange functional. We plot the quantities x and y for the krypton atom in 
Fig. 12. The exchange energy density within the LDA is given by 
e~DA (p) = 
3~(r) p(r) . 
(156) 
The gradient expansion for the exchange has the form [101] 
fdre~DA(p)(1 + Cx2 ~ -t- Cx,l.[?] 2 "~- C~?]~ Aft C~2~ 2] _[_ ,,.) 
(157) 
Ex[p] 
in which we have displayed the terms up to fourth order. In this expression the 
coefficients c~2 = 10/81 and cx4 = 146/2025 are known from linear response 
theory. The coefficients c~ and c~ which are determined from nonlinear re- 
sponse theory are not known, although some estimates have been given 
[ l01, 102]. In the following we leave out the spin dependence. The spin polarized 
form of the exchange functional is however directly obtained from the above 
expression by 
ExEPT, Pl] = ½(Ex[2p T] + Ex[2p~]) 
(158) 
which yields for the corresponding exchange potential 
&Ex[pt, p~] 
vx~([p.]; r) = 
&p.(r) 
- vx([2p.]; r) 
(159) 
60- 
50- 
40- 
30- 
20 
10 
0- 
0 
" '\ 
,/" 
i 
. 
x 
/<.y 
o'.s 
;.o 
;.s 
2'.o 
f.s 
r (a. u.) 
Fig. 12. Dimensionless arguments x and 
y for Kr 
151 

R. van Leeuwen et al. 
where 
aEx[p] 
vx(Ep]; r) = -
-
 
(16o) 
5p(r) 
Approximating the exchange functional by a finite number of terms of the 
gradient expansion yields the gradient expansion approximation (GEA). How- 
ever, when exponentially decaying densities are inserted, the GEA for the 
exchange yields infinite results for the fourth and higher order terms. This 
indicates that infinite summations must be carried out in order to yield sensible 
results for finite systems (note that this divergency does not occur for solids). The 
generalized gradient approximations can be considered as such partial resum- 
mations of the gradient series. For this reason the GGAs are often required to 
reproduce the known coefficients of the gradient expansion in the limit of slowly 
varying densities. The most widely used gradient functionals only depend on the 
first order derivative through the variable s or equivalent x and are of the form 
E~[p] = 
°a(p)F(s(r))dr= !e~°a(p)g(x(r))dr. 
(161) 
In the widely used Becke functional [15] for the exchange, for instance, the 
function g(x) is given by 
1 
cx 1 + 613x sinh-ix 
c~ = 
Useful local quantities which can be investigated to test the local properties 
of the GEA and GGA approximations for the exchange functional are the 
exchange hole, the long-range screening potential which is equal to the potential 
of the exchange hole or the Slater potential, and the exchange-correlation 
potential. The gradient expansion of the exchange hole has been derived by 
Perdew et al. [12, 103, 104] on the basis of the Kirzhnits expansion for the 
Kohn-Sham one-particle density matrix [1]. This GEA expansion for the 
exchange-hole has been compared with exact exchange holes in atomic systems 
by Slamet and Sahni [105, 106]. Their analysis shows that the GEA hole is not 
negative definite and has spurious long range oscillations. The GGA holes due 
to Perdew and Wang cure these deficiencies by means of real-space cutoffs of the 
exchange hole which are determined from the sum rules. For an extensive 
discussion we refer to [14]. 
Related local quantity of interest is the potential of the exchange hole or the 
Slater potential Vs. This potential is given by the expression at Eq. (70) of the 
screening potential where one should replace the ~ by its exchange-only equiva- 
lent given at Eq. (19). If one calculates this potential from the gradient expansion 
of the exchange hole one finds that it diverges. This divergency is removed in the 
GGA. The corresponding Slater potential from the GGA exchange hole of [103] 
has been presented in [106]. The exchange energy is related to the Slater 
152 

Analysis and Modelling of Atomic and Molecular Kohn-Sham Potentials 
potential by 
'f 
E~[p] = ~ p(r)vs(r)dr. 
(163) 
Noting the GGA expressions for Ex of Eq. (161) one is tempted to write 
1 
1 
V~GA(r) = 2p~(r) F(s(r)) =2p~(r)g(x(r)). 
(164) 
However this is in general not allowed as, in the construction of the GGA energy 
expression, partial integrations have been carried out [12] to remove the 
Laplacian terms (for instance the GEA Vs explicitly contains Laplacian terms 
[104] which can be removed in the energy expression by partial integration). 
However noting the similarity of the dimensionless gradient and Laplacian 
terms ~ and r/for atoms, Eq. (164) can still be a rather good approximation for 
atoms (however ¢ and r/ have quite different behavior in clusters calculated 
within the jellium model [101]). For the Becke functional it is legitimate to use 
Eq. (164) as this functional has been designed to reproduce Vs, and in particular 
its long range Coulombic asymptotics. If we use this equation for the second 
order GEA and for the Becke exchange we obtain the expressions 
1 
VsGEA(r) = -- 3 
p~(r) [1 + 21~lx2(r)] 
(165) 
1 
Vs~GA(r) = -- p~(r) 3 ~ 
+ 2~21 + 6~2x(r)sinh-1 x(r 
(166) 
where B1 = 0.005 is the GEA coefficient of Herman et al. [107, 108] which has 
been shown to be an optimal value for atomic systems and ~2 = 0.0042 is the 
GGA coefficient of Becke [15]. In Fig. 13 we plot the exact Vs, and the Slater 
potentials for the GEA and Becke GGA for the cadmium atom as a function of 
the radial coordinate. As one can see from this figure, the LDA potential decays 
too fast in the outer region of the atom whereas the GEA potential diverges in 
this region. The Slater potential of the GGA gives the best fit of the exact Slater 
potential and has, furthermore, the correct asymptotics. This is a general trend 
for atomic systems [22]. The GGA therefore, gives not only in the energy but 
also locally in the exchange hole potential, an improvement over the LDA. 
We now turn to the corresponding exchange potentials. The GGA exchange 
potential is given by 
1 
v~A(r) = ~ p~(o(x) -xg'(x) + x2g"(x)) 
+ (g'(x) - xg"(x)) 
t~pt~jp~jp 
V2p 
~,J=~ 
IVpl a 
g'(x)--iVpl 
(167) 
where g' and g" are the first and second derivatives of g with respect to x. In the 
region near to the atomic nucleus and in the outer asymptotic region of an atom 
or molecule the density has an exponential decay p(r) = Ne -~'. If we insert this 
153 

R. van Leeuwen et al. 
0 
-0.5 
-1.0 - 
=. -1.5 - 
-2.0 - 
-2.5 - 
-3.0 - 
0 
V S 
.......................................................... 
I 
i 
f .... 
i 
I 
I 
1 
2 
3 
4 
5 
6 
r (a. u.) 
Fig. 13. Slater potentials of OPM, LDA, GEA and GGA for Cd 
density in the above equation for -O~A 
vx 
we obtain 
4 1( 
x 2 ,,,x," ~+2 
, 
/)xGGA(r) ~" -3P'3kg(X) -- Xg'(X) + --£g t )) 
r g (x) . 
(168) 
From this equation one finds that Vx-oGa has a Coulombic singularity near the 
atomic nucleus. Furthermore it follows that if the GGA reproduces the correct 
asymptotic behavior of the Slater potential 
1 
Vs ~ 
-- 
(r-~ co) 
(169) 
r 
which requires 
1 
X 
g(X) 
(X ~ 
oO ) 
(170) 
6 In (x) 
then v~ aa has a r- 2 behavior for r ~ oo, which is particularly true for the Becke 
functional [109]. Therefore the proper asymptotic behavior for the Slater 
potential Vs and the exchange potential vx cannot be simultaneously satisfied for 
functionals of the form in Eq. (161). This was first shown by Engel et al. [19]. It is 
however possible to satisfy both constraints if one extends the GGA with 
Laplacian terms [1113]. In order to improve the GGA exchange potential Engel 
and Vosko [111] used a Pad6 approximant of the form 
fe~OA(p) 1 + al~ + a2~ 2 + a3( 3 dr 
(171) 
EExV93[p] 
J 
1 + bl~ + b2~ 2 + b3~ 3 
in which al and bl were restricted to yield the correct gradient coefficient 
154 

Analysis and Modelling of Atomic and Molecular Kohn-Sham Potentials 
Cx2 = al -- bl. The coefficients were then determined to give an optimal local fit 
of the Levy-Perdew integrand by minimizing the expression 
A2 = ~ 
4nr213pa(r) + r xVpA(r))(v~V,93([pA];r) 
-- Vx, a ([PA]; r))Idr 
(172) 
where A runs over a number of atoms and Pa, Ex, A and Vx, A represent the 
density, exchange energy and potential of an exchange-only OPM calculation. 
This procedure improves the atomic shell structure of the exchange potential. 
The price that has to be paid for this improvement is a worsening of the 
exchange energy. More importantly the GGA deficiencies for small and large 
r are not cured by the above procedure. The deficiencies of the GGA exchange 
potential near the atomic nucleus and in the outer asymptotic region can 
however be cured using a nonvariational procedure by direct approximation of 
the exchange potential of the form 
1 
1 
v~([p]); r) = v~ °A ([p]); r) + 2~p-~(r)f(x(r),y(r)) . 
(173) 
This approximate form satisfies the required scaling properties of the exchange 
potential. The corresponding exchange energy can then be calculated using the 
Levy-Perdew relation. An appropriate choice which ensures finiteness at the 
atomic nucleus and correct long range asymptotics is given by a Pad~ type 
expression of the form [22] 
a~ x 2 
a~ y + arl y 2 
f(x,y) = - 1 + 3a~xsinh-lx 
+ 
1 + brxy 2 
(174) 
The parameters in this expression can then be optimized by minimizing for 
a range of atomic systems the quantity 
AI = ~ 
[4nr2pA(r)(v~,a([pA];r) - Vx, A([pA-];r))]2 dr 
(175) 
or, alternatively, the quantity 
lfo° 
A2 2 
,1 E~, A 
~ 
[4~r2(30A(r) + r x VOA(r))(V{,A([OA]; r) 
-- Vx, A([OA]; r))] 2 dr 
(176) 
where A runs over a number of atoms and Ex, ~ and vx, A represent the exchange 
energy and potential of an exchange-only OPM calculation. Both minimization 
procedures were carried out by Gritsenko et al. [22] and yielded corresponding 
approximate 
exchange 
potentials 
v{ 1 and 
v{~ with 
parameter 
sets 
(a~, a~, a{, ~) = (0.0123, 0.0087, 0.0004, 0.0011) and (0.0204, 0.0086, 0.0005, 0.0022). 
In Fig. 14 we plot for the cadmium atom the difference between the LDA 
potential and the exchange potential of OPM, GEA, Becke GGA and the Pad~ 
approximants v{ ~ and v{~ which therefore represents the nonlocal correction to 
155 

R. van Leeuwen et al. 
6 - - .... 
~.<---..., 
.VNLGE 
A 
s- "V" \U 
3~ 
'"'k .j'~ 
~ 
VNL GGA 
VNL f2 
6 780.01 
3 4 5 6 780'.I 
2 
3 4 5 6 789i 
r (a. u,) 
Fig. 14. Non-local corrections of OPM, GEA, GGA and of the fitting potentials to the LDA 
exchange potential for Cd 
the LDA exchange potential. From this figure we can see that the GGA 
correction to the LDA exchange potential deviates considerably from its exact 
value. It diverges in the core region and its atomic shell structure is not 
pronounced enough. A better reproduction of the atomic shell structure is 
provided by the GEA potential (an even better reproduction of the shell 
structure is provided by the fourth order GEA [101]). This potential however 
diverges both in the core and the asymptotic outer region of the atom. The best 
overall fit is achieved by the potential v{ 1 obtained by minimization of quantity 
AI. It also yields better exchange energies as obtained from the Levy-Perdew 
relation at Eq. (196)]. The values of the exchange energies of the fitting poten- 
tials v{' and v~ 2 are better than the LDA and GEA values, although worse than 
the GGA value. This shows the subtle cancellation of local errors for the GGA 
exchange potential in the Levy-Perdew energy expression also noted by Engel 
and Vosko [1 1 1]. The fit v~ • obtained by minimizing A2 yields a better fit of the 
outer asymptotic region and gives better values for the highest occupied orbital 
energies [22]. The possibility of obtaining a better overall fit which incorporates 
both the advantages of v{ ' and ~" is however severely restricted due to the 
concerted behavior of the variables x and y (see Fig. 12). As a result a better fit 
for the inner part of vx produces at the same time a worse fit for the outer region 
and vice versa. For further improvement of the current approximations one 
therefore needs other gradient parameters that should have distinctly different 
behavior in the core and valence regions. 
A more difficult problem is to obtain the correct gradient approximation for 
the exchange-correlation potential. This is because the correlation potential has 
a more difficult spin dependence and must also describe the correlations be- 
t56 

Analysis and Modelling of Atomic and Molecular Kohn-Sham Potentials 
tween unlike spin electrons. One approach is to modify the exchange-correlation 
potentials of the GGA (which incorporate these spin correlations) in such a way 
that finiteness at the nucleus and the correct long-range asymptotics are ob- 
tained. However the current GGA correlation potentials seem to give large local 
errors in atomic systems [44]. A similar conclusion has been reached for the 
behavior of the GGA correlation potential in molecular systems [78]. A simple 
GGA for the exchange-correlation potential has been proposed in [20] which 
yielded much better values for the highest occupied Kohn-Sham eigenvalues 
(for an application of this potential in the calculation of photoionization cross 
sections see [112]). However, due to its too simple form, it lacks the correct spin 
dependence. The correct representation of the exchange-correlation potential 
remains a challenge for approximate DFT. 
6.3 The Krieger-Li-lafrate Approximation 
As we discussed, approximate orbital dependent expressions for the exchange- 
correlation functional greatly improve the description of properties which are 
sensitive to the non-local effects of electron correlation, such as the atomic shell 
structure or the dependence of energy and potential on the particle number. It is 
therefore worthwhile to explore the advantages and limitations of approximate 
orbital dependent exchange-correlation functionals and potentials. Such orbital 
dependent expressions for exchange and correlation have been proposed by 
Colle and Salvetti [113-115], Becke and Roussel [34, 116] and Dobson [117]. 
Self-consistent OPM calculations using the Colle-Salvetti formula have recently 
been reported [70]. Also the successful combination of exact orbital dependent 
exchange and GGA exchange-correlation proposed by Becke [88, 118] using 
a coupling constant integration argument can be regarded as an orbital depen- 
dent exchange-correlation functional. Construction of the corresponding ex- 
change-correlation potential requires the solution of the integral at Eq. (27) for 
vxc, This is awkward for practical applications. However, Krieger, Li and Iafrate 
[21,38] showed that it is possible to transform this integral equation into 
a manageable form. They obtain the following exact expression for vx~: 
vx~.(r) = y, 
"7 
p,(r) 
pi~(r) 
+ 2 "7" 
p.(r)) 
(177) 
where Pi~ are the orbital densities and fx¢~i and rio are defined by 
~pi~ (r) vxc, (r) dr 
J 
(178) 
~0 = fp~, (r) v,~(r) dr. 
(179) 
157 

R. van Leeuwen et at. 
The function Pi~ is defined by 
Pi. (r) - 
, 1 fdr' [vxc. (r') - v,. (r')] Gi. (r, r') ~b,.* (r') 
(180) 
and G~, is defined in Eq. (29). This set of equations must be solved self-consis- 
tently. This can however be done for any given approximation for any orbital 
dependent approximation E~c [{~b~o}] without having to solve an integral equa- 
tion. The function Pi, furthermore satisfies the condition 
fPi~r(r) 
(r) dr = 0 
(181) 
m 
In practical applications the term in the exchange-correlation potential involv- 
ing this function turns out to be very small for atomic systems. Its main effect is 
an improved description of the peaks at the atomic shell boundaries. Neglect of 
this term still leads to an accurate approximation for the atomic exchange- 
correlation potential. 
The term v~, in the above equation involves two-electron integrals over 
orbitals which can make the construction of vx~ rather expensive in molecular or 
solid state calculations. For an application of the KLI potential in bandstruc- 
ture calculations Li et al. [119] approximated this term using the SIC functional 
of Perdew and Zunger 1-873 by 
Lsof[lk[sp, 2pj, r) 
- 1  
q.'~ 
( 
f p,(r') 
) 
v,,(r) = v~¢ 
v~L~°([p,, O]; r) + j[~_r, ldr' 
(182) 
LSD 
"r 
where v~ ([p~, p~], ) is the exchange-correlation potential of the local spin 
density (LSD) formalism. Note that, in contrast to the Perdew-Zunger SIC 
formalism, the KLI potential is still local, In the above approximation the 
potential still preserves its desirable integer discontinuity, atomic shell structure 
and Coulombic asymptotics. 
Let us consider some other approximations to the KLI potential. We 
consider subsequently the exchange and exchange-correlation versions of the 
KLI potential. In the exchange-only case one has 
vKLt(r) 
KLI 
KLl. reSPlr ~ 
(183) 
= v ..... (r) + v ...... 
-, 
written as the sum of a long and a short range part where 
2 
Ku 
~ t ~i(r)t 
" " 
(184) 
t~i(r) 12 
(185) 
KLl.resp{ ~ ~ EWx, i 
v~,~ 
,r~ 
~ 
p(r) 
and where the functions u,(r) and the constants w~.~ are defined as 
1 
6E,,[{4~,}] 
(186) 
ui,~(r) = ~*(r) 
6q~(r) 
158 

Analysis and Modelling of Atomic and Molecular Kohn-Sham Potentials 
wx,, = ft~,(r)12(v~L'(r) - ui.:,(r))dr 
(187) 
where vx.sc, is equal to the Slater potential Vs as calculated from Coulomb 
integrals over Kohn-Sham orbitals. In order to avoid the calculation of two- 
electron integrals, we propose a GGA-like approximation for Vs and derive some 
approximate orbital energy dependent expressions for the constants w~ [120]. 
For Vs we propose 
vs ~A (r) = 2e~ GA (r) . 
(188) 
If we use the Becke exchange energy density [15] then (for the spin unpolarized 
case, we have 
1 
e~Ga(r ) 
p½[~(3)~ 
fix 2 
] 
(189, 
= 
- 
+ 
1 +6flxsinh-lx 
1 
4. 
where x = 2~ [Vp I/p~ and fl = 0.0042. Our vs ~a exhibits the correct asymptotics 
1 
v~a(r) ~ 
(r ~ oo) 
(190) 
r 
and at the same time we have a rather accurate description of the exchange 
energies from our Vs ~a as 
1 t" 
G~- 
_t 
E~ ~A [p] = ~ Jp (r) Vs ~ (r) dr = _P(r) e~ ~A (r) dr 
(191 ) 
which is known to yield accurate exchange energies. For the constants 
wi = Vxi - vi we propose an approximation in terms of the orbital energy ei. 
From gauge invariance requirements we can infer that wi can only depend on an 
energy difference. We therefore make the following ansatz 
wi =f(;t - ei) 
(192) 
where # = eN is the highest occupied Kohn-Sham eigenvalue (equal to the 
ionization energy in the exact case). Scaling properties of the Kohn-Sham 
orbital energies and the exchange potential then determine the form of the 
function f and we obtain 
w i = K [P]x/~ -- el 
(193) 
where K[p] is a functional satisfying 
K [Pal = K [p] 
(194) 
where pz(r) = 23p(2r). Note that wt~ = 0 as can also be proven for the KLI- 
potential. If we further approximate this functional by a constant and require 
our exchange potential to be exact for the homogeneous electron gas, we obtain 
159 

R. van Leeuwen et aL 
K = 8~v/2/3g 2 ~ 0.382 and the potential of the form [120] 
8v/2 / 
t ~bi(r)12 
(195) 
We can however also determine the functional form of the functional K[p] by 
requiring v~ to satisfy the Levy-Perdew [121] relation 
Ex[Ol = 
p (r) vs (r) dr = 
(3p(r) + rxVp(r))vx(r)dr 
(196) 
which yields 
K[p"1 
= 
where 
Ii[p] 
I2[p] 
(197) 
I~[p] = f (~p(r) + rxVp(r))vs(r)dr 
(198) 
[p] = f0p(r) + r x Vp(r)) R(r)dr 
(199) 
I2 
~' 
--Iq~'{r)12 
(200) 
R(r) 
= 
- 
i 
p(r) 
The functionals I~ and I2 both scale like /[pal = ;tl[p] showing the correct 
scaling property of the functional K[p]. The above equations can be solved 
self-consistently and provide the more advanced approximation [120"1 
L 
I~ 
--tqS~(r)12 
(201) 
v~)(r) = vsaaa(r) + 
- ~2x/#- e,- p(r) 
which also yields the exact exchange potential in the homogeneous electron gas 
limit. 
In Table 2 we present some results for the highest occupied Kohn-Sham 
orbital obtained from the approximate potentials v~ 1) and v~ ) denoted as GGA1 
and GGA2. The approximations S1 and $2 are obtained by replacing the GGA 
approximation for the Slater potential by the exact self-consistently calculated 
Slater potential while retaining our approximations for the screening response 
potential. From this table we can see that the best value for the highest occupied 
Kohn-Sham orbital are obtained from the approximations $1 and $2 using the 
exact Slater potential indicating that the largest error is in the GGA approxima- 
tion to the Slater potential. A more careful analysis shows that this is indeed the 
case. Local errors in the GGA Vs in the region dose to the atomic nucleus lead to 
a considerable overestimation of the integral I~ of Eq. (198) and the functional 
K[p], For this reason the approximation GGA1 with the fixed constant K per- 
forms better than GGA2. The approximation GGA1 turns out to give an 
accurate local representation of the Kohn-Sham exchange potential which, due 
160 

Analysis and Modelling of Atomic and Molecular Kohn-Sham Potentials 
Table 2. Orbital energies of the highest occupied Kohn-Sham orbital. The mean absolute deviation 
from OPM is denoted by A 
ATOM 
OPM 
KLI 
$2 
SI 
GGA2 
GGA1 
Be 
0.309 
0.309 
0.308 
0.303 
0.280 
0.301 
Ne 
0.851 
0.849 
0.830 
0.821 
0.723 
0.753 
Mg 
0.253 
0.252 
0.248 
0.248 
0.234 
0.247 
Ar 
0.591 
0.589 
0.573 
0.570 
0.534 
0.548 
Ca 
0.196 
0.195 
0.186 
0.186 
0.181 
0.190 
Zn 
0.293 
0.292 
0.307 
0.307 
0.312 
0.318 
Kr 
0.523 
0.522 
0.503 
0.503 
0.481 
0.490 
Sr 
0.179 
0.178 
0.167 
0.169 
0.167 
0.174 
Cd 
0.265 
0.265 
0.263 
0.264 
0.271 
0.278 
Xe 
0.456 
0.455 
0.433 
0.434 
0.421 
0.428 
A 
0.001 
0.013 
0.014 
0.036 
0.027 
to its simplicity, has the virtue of being applicable to large molecular systems 
and solids. 
We will now study the problem of approximating the more general case of the 
exchange-correlation potential. We propose similar approximations as for the 
exchange-only case. For the screening part we take a GGA-like approximation 
GGA 
v ...... (r) = 2e~a(r)= 2e~(r) + 2gPcW91(r) 
(202) 
where ex n denotes the exchange energy density due to Becke [15] as described in 
.ew91 denotes the correlation energy density of the 
the previous section and ~c 
Perdew-Wang (PW91) [11, 13, 14] correlation functional. In this way we obtain 
accurate exchange-correlation energies from 
1 f 
G~A 
E~a[p] =~ p(r)vxc, s.(r)dr = E~n[p] + E~ w9a [p] 
(203) 
and also obtain the correct asymptotics due to the correct asymptotic decay of 
the Becke exchange energy density 
1 
GGA 
v ..... 
(r)--, 
- 
- 
(r--, 
~ 
). 
(2o4) 
r 
For the constants wxc, i we assume a similar relation as for the exchange 
wxc,, =/~= [p] v/~- ~i. 
(205) 
The only difference with the exchange case is that the functional Kx~ [p] does not 
obey a simple scaling relation in Eq. (197) as in the exchange case. We determine 
the functional form of Kx~ by requiring our approximate vx~ to satisfy the 
relation due to Averill and Painter [122] and Levy and Perdew [121] 
E~[p] = ~ p(r)vx~,~,(r)dr = 
v~(r)(30(r) + r x Vo(r))dr - Tc[O ] 
(206) 
161 

R. van Leeuwen et al. 
K=[p] = 
-
-
 
where 
where Tc = T-- Ts is the difference between the exact and Kohn-Sham kinetic 
energy which can be proven to be positive. We then obtain the following 
expression for K~: 
I~ [p] 
(207) 
I2[P] 
I~[p] = f (~p(r) + r.Vp(r))v~¢,~,(r)dr- T~Ep] . 
(208) 
The integral 12 has the same form as given by Eq. (199) in the previous section. 
Due to the appearance of the T~ [p] term in the equation for I~ [p] the functional 
K~ [p] lacks a scaling property as in Eq. (197). The quantity T~ [p] is to be 
calculated within the GGA approximation from the relation 
dE~ [px] x = 
_ E~ [p] 
. 
(209) 
In the PW91 approximation for the correlation energy this becomes 
= fp(r) t~(r) dr 
T~ [P] 
d 
where 
(210) 
PW91 
Ec 
to(r) = - rs(r) ~(r) 
- ~c"ew91"-~*~ 
(211) 
1 
where rs(r) = (&rp/3)-s is the Wigner-Seitz radius. The above relation follows 
from the fact that rApx(r))= 2-1r~(p(2r)) is the only non-dimensionless para- 
meter in the PW91 correlation energy density. Our final exchange-correlation 
potential has a similar form as the one obtained in the exchange-only approxi- 
mation 
Vxc(r) 
ti~A 
I1 
~ 
Iq~i(r)l 2 
(212) 
i 
One can still use a simpler exchange-like expression for wxc,~ with the 
constant K~c. A possible option to determine this constant is to use the 
essentially accurate potentials v~c constructed from the correlated densities as 
described in Sect. 3. One can insert v~ and the model response potential into the 
expression for vx~,~," 
N 
--I~i(r)12 
(213) 
Vx~ ~,(r) = Vxc(r) -- 
K,,~ ~../p -- ei- 
' 
~ 
p(r) 
With Eq. (213) K~ can be fitted using the requirement that the integral of 
162 

Analysis and Modelling of Atomic and Molecular Kohn-Sham Potentials 
Table 3. Orbital energies of the highest occupied Kohn-Sham orbital compared to the experimental 
ionization energy. The mean absolute deviation from experiment is denoted by A 
ATOM 
EXPT 
OPM 
B88PW91C 
$2 
S1 
GGA2 
GGA1 
He 
0.903 
0.918 
0.582 
0.955 
0.955 
0.928 
0.928 
Be 
0.343 
0.309 
0.206 
0.330 
0.329 
0.302 
0.330 
N 
0.534 
0.571 
0.310 
0.577 
0.568 
0.516 
0.529 
Ne 
0.792 
0.851 
0.491 
0.858 
0.839 
0.749 
0.772 
Na 
0.189 
0.182 
0.111 
0.184 
0.182 
0.170 
0.179 
Mg 
0.281 
0.253 
0.173 
0.269 
0.266 
0.259 
0.269 
P 
0.385 
0.392 
0.225 
0.399 
0.390 
0375 
0.380 
Ar 
0.579 
0.591 
0.378 
0.605 
0.593 
0.567 
0.572 
A 
0.025 
0.191 
0.029 
0.024 
0.024 
0.012 
Vx~,s~, should reproduce Exc[p] : 
Exc[p] =-2 p(r)vxc .... (r)dr . 
(214) 
With v~ and 4~i constructed via the procedure [20] for the Ne atom, we 
obtain the value Kxc = 0.470. In Table 3 we present some results for the highest 
occupied Kohn-Sham eigenvalue which should be equal to the ionization 
energy of the system. The approximation of Eq. (212) is denoted GGA2. If we 
replace in this equation the functional Kxc by the constant Kx~ = 0.470 we 
obtain an approximation called GGA1. The potentials S1 and $2 denote the 
same potentials in which we replace the exchange part of the screening potential 
(that is two times the Becke energy density) by the exact exchange expression, 
which is the Slater potential Vs. The column B88PW91C denotes the eigenvalues 
from the exchange-correlation functional consisting of the Becke exchange and 
the Perdew-Wang 91 correlation energy. From this table we can see that the 
approximations S1 and S2 with the exact Slater potential yield results close to 
the exchange-only OPM results, indicating that the correlation correction to the 
potential is too small. However if we use the GGA approximation to the Slater 
potential then, due to the errors introduced in Vs, there is a fortuitous error 
cancellation which brings the highest occupied Kohn-Sham eigenvalues closer 
to the correlated ones. However, important local errors in the GGA approxima- 
tion, especially in the core region, still prevent a uniformly accurate representa- 
tion of the exchange-correlation potential. More work has to be done to correct 
these errors. The accurate approximation of the exchange-correlation potential 
and functional in molecules remains an even greater challenge. 
7 Conclusions and Outlook 
In this review we have given an overview of the properties of exact and 
approximate exchange-correlation potentials. We have shown how the local 
163 

R. van Leeuwen et al. 
properties of the pair-correlation function and the exchange-correlation hole 
show up in the various constituents of the exchange-correlation potential and 
determine the shape of vxc, such as its atomic shell and the bond midpoint 
properties. The exchange-correlation hole determines not only the local proper- 
ties of vxc but also directly relates to the exchange-correlation energy Exc. The 
exchange-correlation potential turns out to be a quantity which is incorrectly 
represented by most of the existing approximate density functionals. Presently 
the most widely used approximation in quantum chemistry in the calculation of 
molecular properties is the GGA approach. However the current GGAs have 
important deficiencies with respect to their exchange-correlation potentials, 
notably the incorrect long range asymptotics. A much better representation of 
the properties of the exchange-correlation potential is provided by the use of 
orbital dependent density functionals, such as the OPM and KLI schemes. The 
OPM and KLI approaches are the only approaches thus far which have been 
able to describe correctly the particle number dependent properties of E~ and 
v~. Moreover the KLI approach does provide a simple and accurate approxi- 
mation for vxc which incorporates the correct atomic shell structure. A practical 
disadvantage of the orbital dependent approach however is that the calculation 
of Exc and v~ is just as expensive as a Hartree-Fock calculation, which prohibits 
the application to large molecular systems. The method is nevertheless still 
applicable to molecules of intermediate size. As shown by Becke [88, 116, 118], 
a combination of GGAs and orbital dependent density functionals turns out to 
be very successful in the accurate prediction of molecular bond energies. In view 
of the rapid developments in this field we can expect further improvements of the 
GGA and orbital dependent density functionals in the near future. This requires, 
among other things, a better understanding of the success of the current 
approaches. The study of local properties such as the exchange-correlation hole 
and the exchange-correlation potential in atomic and molecular systems can be 
of great help in this respect and can provide important guidance in the search for 
more accurate density functionals. 
Acknowledgements. This work was supported in part by the Swedish Natural 
Science Research Council and the Netherlands Institution Fundamental Onder- 
zoek der Materie (FOM). 
8 References 
1. Dreizler RM, Gross EKU (1990) Density functional theory: an approach to the quantum 
many-body problem. Springer, Berlin, Heidelberg New York 
2. Ziegler T (1991) Chem Rev 91:651 
3. Fan L, Ziegler T (1995) In: Ellis DE (ed) (1995). Electronic density functional theory of 
molecules, clusters and solids. Kluwer, Dordrecht 
4. Johnson BG, Gill PMW, Pople JA (1992) J Chem Phys 98:5612 
164 

Analysis and Modelling of Atomic and Molecular Kohn-Sham Potentials 
5. Oliphant N, Bartlett RJ (1994) J Chem Phys 100:6550 
6. Becke AD (1992) J Chem Phys 96:2155 
7. Eriksson LA, Pettersson LGM, Siegbahn PEM, Wahlgren U (1995) J Chem Phys 102: 
872 
8. Langreth DC, Mehl J (1983) Phys Rev B28:1809 
9. Langreth DC, Perdew JP (1980) Phys Rev B21:5469 
10. Perdew JP (1986) Phys Rev B33:8822 
11. Perdew JP (1991) Physica B172:1 
12. Perdew JP, Wang Y (1986) Phys Rev B33:8800 
13. Perdew JP, Chevary JA, Vosko SH, Jackson KA, Pederson MR, Singh DJ, Fiolhais 
C (1992) Phys Rev B46:6671 
14. Perdew JP (1991) In: Ziesche P, Eschrig H (eds) Electronic Structure of Solids 
1991. Akademie Verlag, Berlin 
15. Becke AD (1988) Phys Rev A38:3098 
16. Lee C, Yang W, Parr RG (1988) Phys Rev B37:785 
17. yon Barth U (1994) In: Kumar V, Andersen OK, Mookerjee A (eds) Methods of 
Electronic Structure Calculations. World Scientific 
18. Almbladh CO, yon Barth U (1985) Phys Rev B31:3231 
19. Engel E, Chevary JA, Macdonald LD, Vosko SH (1992) Z Physik D23:7 
20. van Leeuwen R, Baerends EJ (1994) Plays Rev A49:2421 
21. Krieger JB, Li Y, Iafrate GJ (1992) Phys Rev A45:101 
22. Gritsenko OV, van Leeuwen R, Baerends EJ (1996) Int J Quantum Chem 57:17 
23. Ortiz G, Ballone P (1991) Phys Rev B43:6376 
24. Levy M (1979) Proc Natl Acad Sci USA 76:6062 
25. Lieb E (1982) Int J Quantum Chem 24:243 
26. Englisch H, Englisch R (1983) Phys Stat Sol 123:711 
27. Englisch H, Englisch R (1983) Phys Stat Sol 124:373 
28. Kohn W, Sham LJ (1965) Phys Rev 140A: 1133 
29. Hohenberg P, Kohn W (1964) Phys Rev 136B: 864 
30. McWeeny R (1960) Rev Modern Phys 32:335 
31. Gunnarsson O, Lundqvist BI (1976) Phys Rev B13:4274 
32. Becke AD (1988) J Chem Phys 88:1053 
33. Tschinke V, Ziegler T (1989) Can J Chem 67:460 
34. Becke AD, Roussel MR (1989) Phys Rev A39:3761 
35. Cook M, Karplus M (1987) J Phys Chem 91:37 
36. Tschinke V, Ziegler T (1991) Theoret Chim Acta 81:65 
37. Krieger JB, Li Y, Iafrate GJ (1992) Phys Rev A46:5453 
38. Krieger JB, Li Y, Iafrate GJ (1995) In: Gross EKU, Dreizler RM (eds) Density Functional 
Theory. NATO ASI Series B337 
39. Sharp RT, Horton GK (1953) Phys Rev 90:317 
40. Talman JD, Shadwick WF (1976) Phys Rev A14:36 
41. Engel E, Vosko SH (1993) Phys Rev A47:2800 
42. Smith DW, Jagannathan S, Handler GS (1979) Int J Quantum Chem Syrup 13:103 
43. Buijse MA, Baerends EJ, Snijders JG (1989) Phys Rev A40:4190 
44. Umrigar CJ, Gonze X (1994) Phys Rev A50:3827 
45. Almbladh CO, Pedroza AC (1984) Phys Rev A29:2322 
46. von Barth U (1984) In: Phariseau P, Temmerman W (eds) The Electronic Structure of 
Complex Systems. NATO ASI Series B113 
47. von Barth U (1986) Chem Scr 26:449 
48. Aryasetiawan F, Stott MJ (1988) Phys Rev B38:2974 
49. Nagy A (1993) J Phys B26:43 
50. Chen J, Esquivel RO, Stott MJ (1994) Phil Mag B69:1009 
51. G6rling A (1992) Phys Rev A46:3753 
52. G6rling A, Ernzerhof M (1995) Phys Rev A51:4501 
53. Werden SH, Davidson ER (1982) In: Local Density Approximations in Quantum 
Chemistry and Solid State Physics. Plenum Press, New York 
165 

R. van Leeuwen et al. 
54. Zhao Q, Parr RG (1992) Phys Rev A46:2337 
55. Zhao Q, Parr RG (1993) J Chem Phys 98:543 
56. Zhao Q, Morrison RC, Parr RG (1995) Phys Rev A50:2138 
57. Morrison RC, Zhao Q (1995) Phys Rev A51:1980 
58. Wang Y, Parr RG (t993) Phys Rev A47: R159t 
59. Gritsenko OV, van Leeuwen R, Baerends EJ (1995) Phys Rev A52:1870 
60. van Leeuwen R, Baerends EJ (1995) Phys Rev A51:170 
61. Ziegler T, Rauk A (1977) Theoret Chim Acta 46:1 
62. Levy M (1991) Phys Rev A43:4637 
63. Levy M (1995) In: Gross EKU, Dreizler RM (eds) Density Functional Theory. NATO 
ASI Series B337 
64. Parr RG, Ghosh SK (1995) Phys Rev A51:3564 
65. Hui Ou-Yang, Levy M (1990) Phys Rev Lett 65:1036 
66. van Leeuwen R, Gritsenko OV, Baerends EJ (1995) Z. Physik, D33:229 
67. Levy M, Perdew JP, Sahni V (1984) Phys Rev A30:2745 
68. Vosko SH, Wilk L, Nusair M (1980) Can J Phys 58:1200 
69. Perdew JP (1995) In: Gross EKU, Dreizler RM (eds) Density Functional Theory NATO 
ASI Series B337 
70. Grabo T, Gross EKU (1995) Chem Phys Lett 240:. 141 
71. Herman F, Skilman F (1963) Atomic Structure Calculations. Prentice-Hall Inc 
72. Slater JC (1951) Phys Rev 81:385 
73. van Leeuwen R (1994) Kohn-Sham Potentials in Density Functional Theory. PhD 
thesis, Vrije Universiteit, Amsterdam, The Netherlands 
74. Gritsenko OV, van Leeuwen R, Baerends EJ (1994) J Chem Phys 101:8955 
75. Buijse MA, Baerends EJ (1995) In: Ellis DE (ed) Electronic Density Functional Theory of 
Molecules, Clusters and Solids, Kluwer, Dordrecht 
76. Hunter G (1975) Int J Quantum Chem Syrup 9:311 
77. Hunter G (1986) Int J Quantum Chem 29:197 
78. van Leeuwen R, Baerends EJ (1994) lnt J Quantum Chem 52:711 
79. Buijse MA (1991). Electron Correlation. PhD thesis, Vrije Universiteit, Amsterdam, The 
Netherlands 
80. Slater JC (1963) Quantum Theory of Molecules and Solids, volume 1. McGraw-Hill 
81. Perdew JP, Savin A, Burke K (1995) Phys Rev A51:4531 
82. Perdew JP (1985) In: Dreizler RM, da Providencia J (eds) Density Functional Methods in 
Physics. NATO ASI Series B123 
83. Almbladh CO, von Barth U (1985) In: Dreizler RM, da Providencia J (eds) Density 
Functional Methods in Physics. NATO ASI Series B123 
84. Mermin ND (1965) Phys Rev 137: A144t 
85. Slater JC (1963) Quantum Theory of Molecules and Solids, volume 4. McGraw-Hill 
86. Perdew JP, Parr RG, Levy M, Balduz JL (1982) Phys Rev Lett 49:1691 
87. Perdew JP, Zunger A (1981) Phys Rev B23:5048 
88. Becke AD (1993) J Chem Phys 98:1372 
89. Becke AD (1993) J Chem Phys 97:9173 
90. Alonso JA, Girifalco LA (1977) Solid State Commun 24:135 
91. Alonso JA, Girifalco LA (1978) Phys Rev B17:3735 
92. Gunnarsson O, Jonson M, Lundqvist BI (1977) Solid State Commun 24:765 
93. Gunnarsson O, Jonson M, Lundqvist BI (1979) Phys Rev B20:3136 
94. Ossicini S, Bertoni CM (1985) Phys Rev A31:3550 
95. Gritsenko OV, Cordero NA, Rubio A, Balb~ts LC, Alonso JA (1993) Phys Rev A48:4197 
96. Yamashita I, Ichimaru S (1984) Phys Rev B29:673 
97. Przybylski H, Borstel G (1984) Solid State Commun 49:317 
98. Przybylski H, Borstel G (1984) Solid State Commun 52:713 
99. Fritsche L, Gu YM (1993) Plays Rev B48:4259 
t00. Caus~i M, Zupan A (1994) Chem Phys Lett 220:145 
101. Engel E, Vosko SH (1994) Phys Rev B50:10498 
102. Svendsen PS, von Barth U (1995) Int J Quantum Chem 56:351 
166 

Analysis and Modelling of Atomic and Molecular Kohn-Sham Potentials 
103. Perdew JP (1985) Phys Rev Lett 55:1665 
104. Wang Y, Perdew JP, Chevary JA, Macdonald LD, Vosko SH (1990) Phys Rev A41:78 
105. Slamet M, Sahni V (1991) lnt J Quantum Chem Symp 25:235 
106. Slamet M, Sahni V (1992) Int J Quantum Chem Symp 26:333 
107. Herman F, van Dyke JP, Ortenburger IB (1969) Phys Rev Lett 22:807 
108. Herman F, Ortenburger IB, Van Dyke JP (1970) Int J Quantum Chem Symp 3:827 
109. Lee C, Zhou Z (1991) Phys Rev A44:1536 
110. Jemmer P, Knowles PJ (1995) Phys Rev A51:3571 
111. Engel E, Vosko SH (1993) Phys Rev B47:13164 
112. Stener M, Lisini A, Decleva P (1995) Int J Quantum Chem 53:229 
113. Colle R, Salvetti O (1975) Theoret Chim Acta 37:329 
114. Colle R, Salvetti O (1979) Theoret Chim Acta 53:55 
115. Colle R, Salvetti O (1990) J Chem Phys 93:534 
116. Becke AD (1994) Int J Quantum Chem Symp 28:625 
117. Dobson JF (1992) J Phys Condens Matt 4:7877 
118. Becke AD (1993) J Chem Phys 98:5648 
119. Li Y, Krieger JB, Norman MR, Iafrate GJ (1991) Phys Rev B44:10437 
120. Gritsenko OV, van Leeuwen R, van Lenthe E, Baerends EJ (1995) Phys Rev A51:1944 
121. Levy M, Perdew JP (1985) Phys Rev A32:2010 
122. Averill FW, Painter GS (1981) Phys Rev B24:6795 
167 

Local-Scaling Transformation Version of 
Density Functional Theory: 
Generation of Density Functionals 
Eduardo V. Ludefia* and Roberto L6pez-Boada 
Centro de Quimica, Instituto Venezolano de lnvestigaciones Cientificas, IV1C, Apartado 21827, 
Caracas 1020-A, Venezuela 
Table of Contents 
1 Introduction .................................. 
170 
2 Space Coordinate-Density Transformations 
............... 
173 
2.1 The Pioneers 
.............................. 
173 
2.2 Local-Scaling Transformations .................... 
178 
2.3 Local-Scaling Transformations and the Topology of the Density 
180 
2.4 Density-Transformed One-Particle Orbitals and Their Use in the 
Construction of Energy Functionals ................. 
182 
2.5 Application of Space-Coordinate Density Transformations to 
Atomic Orbitals ............................. 
186 
2.6 The Transformation of N-Particle Wavefunctions ......... 
189 
2.7 General Space-Coordinate Density Transformations ....... 
193 
2.8 Momentum-Coordinate Density Transformations ......... 
195 
3 Relationship Between "Density-Driven" and Local-Scaling 
Transformations ............................... 
197 
4 The Construction of Approximate Energy Density Functionals 
by Means of Local-Scaling Transformations ............... 
200 
4.1 Functional N-Representability and the Notion of "Orbits" 
. . . 
200 
* Author to whom all correspondence should be addressed. 
Topics in Current Chemistry, Vol. 180 
© Springer-Verlag Berlin Heidelberg 1996 

E.V. Ludefia and R. L6pez-Boada 
4.2 Construction of the Energy Density Functional Within 
an "Orbit" 
203 
4.3 Intra-Orbit Optimization of Energy Density Functionals 
.... 
205 
4.4 Euler-Lagrange Equation for Intra-Orbit Optimization of p(~) 
206 
4.5 Euler-Lagrange Equations for the Intra-Orbit Optimization of 
N Orthonormal Orbitals: Kohn-Sham-Like Equations 
..... 
207 
4.6 Inter-Orbit Optimization 
....................... 
210 
4.7 An Application of Intra- and Inter-Orbit Optimization: 
Hartree-Fock Calculations for the Li and Be Atoms ....... 
211 
4.8 Energy Density Functionals for Excited States 
.......... 
213 
5 Approximate Explicit Energy Functionals Generated by 
Local-Scaling Transformations ....................... 
215 
5.1 Explicit Hartree-Fock Functionals 
................. 
215 
5.1.1 Explicit Kinetic Energy Functional .............. 
216 
5.1.2 Explicit Exchange-Only Functional .............. 
2t7 
5.1.3 Results of Explicit Analytic Energy Density Functionals 
for the Li and Be Atoms .................... 
219 
6 Calculation of Kohn-Sham Orbitals and Potentials by 
Local-Scaling Transformations ....................... 
7 References 
.................................. 
219 
222 
We review in the present work the local-scalin 9 transformation version of density fimctional theory 
both for ground and excited states. The historical development of the concept of space-coordinate 
density-transformation and of its effect on the formulation of several versions of density functional 
theory is discussed. We then present the various steps in the elaboration of the local-transformation 
version and indicate some of its accomplishments with respect to the N-representability problem for 
the energyfunctionats. Examples are given showing how the application of these methods to atomic 
sample systems lead to Hartree-Fock energies that are undistinguishable from the SCF values. In 
addition, the explicit construction of analytic density functionals for the energy, via local-scaling 
transformations, is discussed and is exemplified for the particular case of the Hartree-Fock 
approximation for atoms. Finally, applications of local-scaling transformations to the direct solu- 
tion of the Kohn-Sham equations are reviewed. 
1 Introduction 
The demands that materials science, fine chemistry, molecular biology, and 
condensed-matter physics exert on the quantum mechanical methods which 
have been developed throughout the years for the purpose of calculating the 
properties of many-particle systems, are really quite formidable. The point is 
that these disciplines have an exacting need for working methods that lead to 
170 

Local-Scaling Transformation Version of Density Functional Theory 
accurate results for "molecules" formed by thousands of electrons and hundreds 
of nuclei. As is well-known, straightforward tackling of such very large systems 
through variational or perturbation-theory methods stemming from the 
Schr6dinger equation is not possible nowadays, as the computational difficulties 
that emerge defy even the most sophisticated supercomputers. It is in this 
respect that density functional theory - because it avoids the usual complexities 
of the standard treatments and leads at the same time to quite reasonable results 
- has become a very promising alternative for the calculation of many-particle 
systems, both at the quantal and semi-classical levels. [1-4]. 
Density functional theory was first formulated - albeit incipiently - by 
Thomas and Fermi in 1927 [5, 6] (for reviews on this theory see the already 
classic works of March [7] and Lieb [8]). Basically, the idea of this theory was to 
bypass the Schr6dinger equation and to recast the many-body problem in terms 
of a "statistical approximation", where the energy is expressed as a functional of 
the one-particle density. Notwithstanding the allure of this idea, its actual 
development proceeded rather slowly in the first four decades, during which 
a number of authors painstakingly added density-dependent terms, obtained 
through gradient expansions, to the original Thomas-Fermi energy expression, 
[9-15]. 
The turning point ocurred in 1964 when Hohenberg and Kohn [t7] ad- 
vanced a theorem which states that the exact ground-state energy is a functional 
of the exact ground-state one-particle density. Although this is just an existence 
theorem, it lent support - in a formal sense - to the earlier generalizations of the 
Thomas-Fermi theory, and opened the gate to new searches of the energy as 
a functional of the one-particle density. The growth of density functional theory 
after 1964 has been exponential. Presently, density functional theory has un- 
doubtedly attained, a prominent place among the theories that deal with the 
quantum many-particle problem [16]. But will it finally replace the more 
traditional variational and perturbational approaches based on the Schr6dinger 
equation? Will it become the choice theory for calculations that demand an 
energy accuracy of the order of cm - 1.9 Or is it doomed to remain a theory well 
suited for giving "fairly reasonable" results at a low price, but the results of 
which can be neither improved nor compared to the strict upper bounds yielded 
by conventional quantum mechanics (i.e., bond energies computed by taking the 
difference between a molecule and isolated atoms)? 
Within the Hohenberg-Kohn approach [17, 18], the possibility of trans- 
forming density functional theory into a theory fully equivalent to the Schrfdin- 
ger equation hinges on whether the elusive "universal" energy functional can 
ever be found. Unfortunately, the Hohenberg-Kohn theorem, being just an 
existence theorem, does not provide any indication of how one should proceed 
in order to find this functional. Moreover, the contention that such a functional 
should exist - and that it should be the same for systems that have neither the 
same number of particles nor the same symmetries (for an atom, for example, 
those symmetries are defined by L 2, L~, ~2, Sz and the parity operator I~l) - 
certainly opens the door to dubious speculation. 
171 

E.V. Ludefia and R. Lfpez-Boada 
But there is a more basic difficulty in the Hohenberg-Kohn formulation 
[19-21], which has to do with the fact that the functional N-representability 
condition on the energy is not properly incorporated. This condition arises 
when the many-body problem is presented in terms of the reduced second-order 
density matrix; in that case it takes the form of the N-representabitity problem 
for the reduced 2-matrix [19, 22-24] (a problem that has not yet been solved). 
When this condition is not met, an energy functional is not in one-to-one 
correspondence with either the Schr6dinger equation or its equivalent varia- 
tional principle; therefore, it can lead to energy values lower than the experi- 
mental ones. 
In the Hohenberg-Kohn formulation, the problem of the functional 
N-representability has not been adequately treated, as it has been assumed that 
the 2-matrix N-representability condition in density matrix theory only implies 
an N-representability condition on the one-particle density [21]. Because the 
latter can be trivially imposed [26, 27], the real problem has been effectively 
avoided. 
It is in response to the questions posed above concerning the limitations of 
the Hohenberg-Kohn formulation of density functional theory that the local- 
scaling transformation version of density functional theory has been advanced 
[20, 25, 28-32, 94, 99, 108-112]. This new theory addresses precisely those 
fundamental aspects which are either ignored or treated superficially in former 
theories. It develops well-defined procedures for the construction of N-represen- 
table energy functionals expressed in terms of the one-particle density. It turns 
out, however, that in order to preserve a one-to-one correspondence between 
these functionals and the usual Schr6dinger equation, i.e., in order to satisfy the 
functional N-representability condition, it is necessary that these functionals 
depend both on the number of particles N, and on the symmetry, which - in the 
case of an atom, for example - is described by the quantum numbers of a specific 
spectroscopic term. Thus, the energy functionais are specific to a particular 
system and do not refer solely to ground states. 
In spite of the specificity evinced by energy functionals advanced in the 
context of the local-scaling version of density functional theory, these func- 
tionals do share some very basic forms regardless of the system under considera- 
tion, and it is in this sense that one can talk about a "universal form" of energy 
density functionals. One must bear in mind, however, that these expressions 
must be multiplied by specific correction factors in order to include the details 
pertaining to particular systems (see for details Sects. 5.1.1 and 5.1.2). Moreover, 
these forms are quite similar to those that appear in the approximate energy 
functionals constructed in the context of the Hohenberg-Kohn theory. Thus, 
the local-scaling version of density functional theory that is being reviewed here 
not only provides an adequate perspective from where to assess previous works, 
but it also furnishes systematic ways for constructing new energy functionals 
and improving already existing ones. 
In Sect. 2, we discuss a class of transformations which we label as "space- 
coordinate (and also momentum-coordinate) density transformations" and 
172 

Local-Scaling Transformation Version of Density Functional Theory 
illustrate how they have already been used in quantum mechanics for a con- 
siderable number of years. Local-scaling transformations correspond to particu- 
lar combinations of the former. We also review in this Section the application of 
these transformations to orbitals and their implications in density functional 
theory. In Sect. 3, we compare the local-scaling version of density functional 
theory with the density-driven version of Cioslowski and show that the latter is 
a finite-basis realization of the former. In Sect. 4, we deal with the construction 
of implicit energy-density functionals and summarily discuss the functional 
N-representability problem. We also discuss "intra-orbit" and "inter-orbit" 
energy-density optimizations. In Sect. 5, we deal with the analytic representation 
of the energy density functionals generated in the context of the local-scaling 
transformation version of density functional theory and discuss their relation- 
ship to the usual approximate expressions for Hohenberg-Kohn-based energy 
density functionals. In Sect. 6, we review applications of local-scaling trans- 
formations to the determination of Kohn-Sham potentials and energies. 
2 Space Coordinate-Density Transformations 
2.1 The Pioneers 
Space-coordinate density transformations have been used by a number of 
authors in various contexts related to density functional theory [26, 27, 53-64, 
85-87]. As the free-electron gas wavefunction is expressed in terms of plane 
waves associated with a constant density, these transformations were introduced 
by Macke in 1955 for the purpose of producing modified plane waves that 
incorporate the density as a variable. In this manner, the density could be then 
be regarded as the variational object [53, 54]. Thus, explicitly a set of plane 
waves (defined in the volume V in ~3 and having uniform density Po = N/V): 
qbr,~(-~) = e i~j'~ for j = 1 ..... N 
is carried into the new deformed plane waves: 
~br,,(7) = 
e ir'''~(~} 
(1) 
(2) 
The space transformation implied in the above expressions carries a vector 
into another vector ~(~): 
? = (x, y, z) -~ ~(?) = (RI(F), R2(~), R3(~)) 
(3) 
and the transformation is defined by the condition: 
P(~) 
N = det [aRi(x, y, z)/~xj[ 
(4) 
173 

E.V. Ludefia and R. L6pez-Boada 
where x~ = x, x2 = y and x3 = z. As this determinant is the Jacobian J(R; F) of 
the transformation, Macke actually introduced the following orbital trans- 
formation: 
~k(7) = [J(R; F)] la ~k(Rff)) 
(5) 
An extension of Macke's formulation to the 1-matrix was given by March and 
Young in 1958 [55]. These authors applied these generalized transformations to 
the free-electron gas 1-matrix D~(7, F') which is carried into the new 1-matrix 
D 1 (7, 7'): 
D1(7, 7') = [J(R; 7)J(R'; F')]~/ZD~(R, ~') 
(6) 
where J(R; 7) is the Jacobian of the transformation. Of course, when we take 
F = F' this reduces to the Jacobian problem relating the density of the free 
electron gas po(7) and a density p(7): 
p(7) = J(R; 7) po(R(7)) 
(7) 
In illustration, March and Young [55] constructed an idempotent 1-matrix 
which, for example, for the one-dimensional case with N odd (N = 2m + l, for 
m integer) is given by: 
po(x', x) = 
~ 
exp -- 2r~ikx' exp 2rcikx 
(8) 
k=-m 
with a similar expression for N even, and showed that for both cases the 
1-matrix could be written in compact form as: 
sin N~z(x' - x) 
(9) 
po(x', x) = sin rc(x' - x) 
Although they did not obtain a closed-form analytic expression for the three- 
dimensional case, they dealt with a trasformed one-matrix for the single Slater 
determinant constructed from plane waves, and rewrote the energy in terms of 
this transformed matrix. The conditions on the transformation were not im- 
posed through the Jacobian but rather through the equations: 
3 
p(x, y, z) = I-I fi(x, y, z) 
(10) 
i=1 
and 
c~R~(x, y, x)gRj(x, y, x) 
gR~(x, y, x)c~R~(x, y, x) 
+ 
c?x 
~x 
~y 
c~y 
+ c~R¢(x, y, x)c~R~(x, y, x) =f2(x, Y, z)5o 
(tl) 
c~z 
gz 
Equations (11) guarantee the orthogonality of the transformation. 
Both in the work of Macke [53] and of March and Young [55], the orbital 
transformation is restricted to plane waves. A more general formulation, how- 
174 

Local-Scaling Transformation Version of Density Functional Theory 
ever, was advanced in 1960 by Hall [56]. This author discussed the unitary 
transformation that keeps the overlap between a pair of untransformed and 
transformed one-particle orbitals invariant. Consider, for example, the ortho- 
normal set {¢i(r, 0, q~)} from which one obtains transformed orbitals through 
the relation: 
(dS(r)FS(r) 
~i(r, O, qb) = \ dr ] 
r qJi(f(r), O, c~) 
(12) 
The invariance of the overlap under this transformation is easily shown. Thus, 
for the untransformed orbitals, the overlap is: 
S,tqD = f drre f ctOsinO f 
O, 
O, ¢) 
(13) 
Similarly, for the transformed ones, we have: 
f drr2 f dOsinO f d¢,l'*(r,O,¢)¢j(r,O,¢) 
=farr faOsinOfa+ as(r)s(r): 
dr 
-~ qg*(f(r), O, dp)4os(f(r), 0, ¢) 
=faf(r)f(r)efaOsinOfa, q'*(f(r),O,¢) oM(r),O,O)=S,S( o) 
(14) 
The general Jacobian problem associated with the transformation of a density 
p1(7) into a density pe(F) (where these densities differ from that of the free- 
electron gas) was discussed by Moser in 1965 [58]. This work was not performed 
in the framework of orbital transformations - which might have interested 
chemists, nor was it done in the context of density functional theory - which 
might have attracted the attention of physicists. It was a paper written for 
mathematicians and, as such, it remained unknown to the quantum chemistry 
community. In the discussion that follows, we use the more accessible reformula- 
tion of Bokanowski and Grebert (1995) [65] which relies heavily on the work of 
Zumbach and Maschke (1983) [61]. Let us define as &a N = L2A(#P u) the space of 
square-integrable antisymmetric complex functions (the subindex A denotes 
antisymmetry with respect to the spatial variables ~). Let us consider an 
arbitrary N-electron wavefunction ~1 ~ &as, from which we obtain the density 
Pl - P~ as follows: 
j-d3r2 "'" d3~x l~bl( ~, 72 ..... 7N)I 2 
(15) 
pl(~) 
N 
Similarly, let us consider a wavefunction 42 e &aN, that yields the density 
Pz = p~. The set of all densities coming from N-particle functions in Hilbert 
space is denoted by ,/f~ 
~C~= {P~)IP ~ q~ e &aN} 
(16) 
175 

E.V. Ludefia and R. L6pez-Boada 
The Jacobian problem associated with these densities is that of finding the 
diffeomorphismf(;) for the density transformation [58, 65]: 
V~, 
pzff)= J(f,-~)p,(f(~)) 
(17) 
In Moser's treatment [58], and more recently, in that of Bokanowski and 
Gr6bert [65, 66], the transformation vector f~) in Eq. (17) is obtained by 
successive applications of the density transformations appearing in Eq. (7) (this 
is given explicitly in Eq. (27) below): 
and 
V~, 
P2(7)= J(Rp~;~)po(Rp,(~)) 
(18) 
V~, 
p,(~) = J(-~p,; 7)po(Rp,(~)) 
(19) 
where in general, po(~), comes from the integration of the N-particle function 
q~o ~ LZa(V N) (where V is defined as the unit cube V = [0, 113): 
N .ivy_, d3~2 "" d3~N Iq~o~, 7z ..... ~N)I 2 
(20) 
po(~) 
The N-particle function ~o 6 L](VN) is given, in general as a linear combination 
of Slater determinants constructed from plane waves, thus extending the 
treatment of both Macke [53, 54] and of March and Young [55]. Thus, we 
have ~o =ZKCKzr, where Zr is the Slater determinant ZK=(N)-l/Zdet 
[~b~l ..... qbr, N] and ~,(~) is the plane wave defined in Eq. (1), with momentum 
~ Z 3. Clearly, in view of this definition of ~o ~ Lz(VN), the resulting density is 
Po(~) = N/V, provided that the expansion coefficients satisfy the equation: 
r Ak,kj 
0 forK#L 
and ki#kj 
(21) 
~ "~K'~L ,L = 
K=I L=I 
where according to Ref. [67]: 
A~ = ( - 1) '+j when {K - k,} = {L - kj} 
(20) 
and zero otherwise. 
In order to determine explicitly the transformation vector Rp(~)= 
(R1, R2, R3) connecting densities pff) and p0(~), its components are defined, 
following Zumbach and Maschke [61], as: 
~ ~- o0 dx' p(x', y, z) 
Rx(x, y, z) = ~+o~ dx'p(x', y, z) 
nz(y, z) = ~+ ~ ~r_ ~ dx'dy'p(x', y', z) 
(23) 
y',z) 
~+~+_~_ 
~z oo dx'dy'dz'p(x', y', z') 
R3(z) = ~+~ ~+~ ~+~dx'dy'dz'p(x', y', z') 
176 

Local-Scaling Transformation Version of Density Functional Theory 
It follows from this definition that: 
BRI(x, y, x) 
1 
ex 
= p(x, y, z) S~_o 
° dx' p(x', y, z) 
00 
t 
X t 
ORz(y, x) 
~_ 00 dx p( , y, z) 
ff dx'f00 
- 00 
a- 00 dy'p(x', y', z) 
¢3y 
BR2(x, y, x) 
Ox 
= 0 
(24) 
dRa(x, y,x! = 
dx' 
dy'p(x', y', z) 
gz 
N.J_® 
., _ 00 
BR3(x, y, x) = BR3(x, y, x) _ 0 
Bx 
By 
In view of the above equations, the Jacobian of the transformation yields 
p(x, y, z)/N: 
" BRI(x, y, z) 
BR2(x, y, z) 
OR3(x, y, z) 
#x 
gx 
Ox 
BRI(X , y, z) 
63R2(x, y, z) 
gRa(x , y, z) 
By 
By 
By 
BR dx, y, z) 
BRz(x, y, z) 
OR3(x, y, z) 
gz 
Oz 
Bz 
BR t(x, y, z)BR 2(x, y, z)BR a(x, y, z) 
1 
- 
Bx 
By 
Bz 
= -~ p(x, y, z) 
(25) 
which we write in a more succint form as [61]: 
J(Ro; ~) = p(~---)) 
(26) 
N 
In terms of the transformations for the vector components given by Eqs. (23) and 
using the result of Eq. (26), the general transformation connecting densities 
Pl and P2 may now be expressed as [58, 65]: 
f = (/~p,)-I o/~p2 
(27) 
which leads to a Jacobian: 
j(fff); ~) = 
P2ff) 
Pl(f(?)) 
(28) 
We show in Sect. 2.7 how Eq. (27) can be implemented for the calculation of the 
transformation function f(~). 
177 

E.V. Ludefia and R. L6pez-Boada 
Although we have employed Zumbach and Maschke's technique for produ- 
cing the transformation vectors Rpl and Ro~, these vectors have been used in 
a wider context for the purpose of finding the transformation that connects two 
arbitrary densities p~(~) and p2(7), associated to N-particle wavefunctions 
(b~ ~ L~a~, and ~2 ~ £'eN, respectively. In this important sense, the procedure 
advanced by Moser [58] frees us in principle from a plane-wave basis and allow 
us to search for general transformations between arbitrary one-particle orbital 
sets. This is precisely what is done through local-scaling transformations. 
2.2 Local-Scaling Transformations 
Local-scaling transformations, or point transformations, are generalizations of 
the well-known scaling transformations. The latter have been widely used in 
many domains of the physical sciences. Scaling transformations carry a vector 
7 ~ 9t 3 into f(~) = 2F, where 2 is just a constant. In the case of local-scaling 
transformations, 2 is a function (i.e., 2---2(7)). Notice that the transformed 
vectorf(;) e ~3 conserves the same direction as the original one and is given by 
f(F) - 2(F)E In terms of the operatorfassociated with this transformations, we 
can relate ~ and f(~) by: 
7 f.~f(~) 
(29) 
In order to see that they correspond to the general transformations studied 
by Moser [58], consider the effect of applying a local-scaling transformation, 
denoted by the operatorf to each of the coordinates appearing in the wavefunc- 
tion ~1(71 ..... ;N) ~ ~N. Hence, the resulting wavefunction ~2(~1 ..... 7N) ~ ~ 
is given by: 
q'2(F1 ..... ~N) ---~1(71 
..... ~N) 
N-times 
N 
= 
Iq 
..... 
(30) 
i=1 
where J(f(~); ~) is the Jacobian of the transformation. In order to guarantee 
uniqueness, we restrict these transformations to those having positive definite 
Jacobians. It is clear that the transformed wavefunction maintains its normaliz- 
ation. Moreover, the following relation is obtained between the density 
P2 - P~(-fi) of the transformed wavefunction and the density Pl - P~,(~) of the 
initial wavefunction: 
p2(7 ) = j(f(F); ~)p,(f(~)) 
(31) 
This fundamental relation between the densities arises from: 
p2(-il)=Nfd372...fd37Nl~2(Ti 
..... 7N)I 2 
178 

Local-Scaling Transformation Version of Density Functional Theory 
= J(f(~l); ~1) N f d3 f(~2)"'" f d3f(~N)]~l(?(~l) ..... f(~N))] 2 (32) 
= j(f(~); ~) p,(f(~)) 
where we have used Eq. (15) and the relation: 
da7 J(f(-~,); 7,) = daf(~,) 
(33) 
The Jacobian J(f(~); 7) = J(2(~)3; ~) of the local-scaling transformation can 
be evaluated explicitly by calculating the determinant: 
J(,~(~)~; 3) = 
dx 
Ox 
Ox 
O2(~)x 
O2(~)y 
d2(~)z 
0y 
Oy 
dy 
O2(~)x 
02(~)y 
~2(7)z 
Oz 
Oz 
dz 
=23(~)[1 +3" gln2(~)] 
(34) 
It is also useful to express this Jacobian in terms of the function f(~) of 
2(~) = f(-~)/r: 
J(f(;); ~ = ?. ~f3 (7) 
(35) 
r 3 
Substituting Eq. (35) into Eq. (31), using polar coordinates (i.e., ~ = (r, 0, ~b)), and 
selecting a fixed ray at angles 0o and ~bo, we obtain the following first order 
differential equation for the transformation function: 
t~f(r, 0o, ~o) 
r2 
p2(r, 0o, ~o) 
(36) 
c~r 
-f2(r, 0o, dpo) pt(f(r, 0o, C~o), 0o, q~o) 
The total transformation functionf(r, 0, 4)) can be obtained by spanning over all 
values angular. The existence of a unique solution to Eq. (36) is guaranteed if 
the following condition is satisfied along each one of the rays: 
f; 
dxxZ pl (x, 0o, C~o) = 
dyy2 p2(y, 0o, ¢o) 
(37) 
For the spherically-symmetric case Eq. (36) becomes: 
dr(r) 
r 2 
pE(r) 
dr -f2(r) pdf(r)) 
(38) 
which is given in integrated form by: 
If{ r) 
ft O 
dXX2 P 1 (X) = 
dyy 2 P2 (Y) 
(39) 
,1o 
179 

E.V. Ludefia and R. L6pez-Boada 
when we take the boundary condition at r = 0, or equivalently, by: 
f 
fr o 
dxx2pl(x) = 
dyy2p~(y) 
(40) 
(r) 
when we take this condition at infinity. 
The full-fledged introduction of local-scaling transformations into density 
functional theory took place in the works of Kryachko, Petkov and Stoitsov 
[28-30, 32, 34], and of Kryachko and Ludefia [1, 20, 31, 33, 35-37]. 
2.3 Local-Scaling Transformations and the Topology of the Density 
Through extensive analyses of accurate one-particle densities, Bader et al. 
[89, 88] have been able to determine the topological properties that characterize 
these objects. Consider, for example, a one-electron density corresponding to the 
ground state of a molecule - whose nuclei are fixed by the vectors {R~}~=1 
- which we indicate by: 
p(F; {R,}~= 1) = P(F; Q) 
(41) 
where Q denotes the nuclear configuration which fixes the molecular geometry. 
The density has an associated vector field of gradient paths, i.e., paths of steepest 
descent, given by: 
d~(s) - 
Vp(7(s); Q) 
(42) 
ds 
In the neighborhood of a critical point, these gradient paths can be written as: 
d~(s) _ A(7(s); Q)-i(s) 
(43) 
ds 
where A(;(s); Q) is the Hessian matrix (A 0 = O2p/OxiOxg. The critical points are 
characterized by the eigenvatues 21, 22, and 23 of the Hessian matrix. When 
21, 22, 23 > 0, the critical point corresponds to a minimum; when 21, 22, 23 < 0, 
to a maximum; the two kinds of saddle points are defined by 2~, 22 > 0, 23 < 0 
and 2~ > 0, 22, 23 < 0. Some of these properties are depicted in Fig. 1 for the 
particular case of the diatomic molecule LiH. 
In addition to the critical points an important feature appearing in one- 
electron densities are the closed contour curves corresponding to a given value 
of the density [20]. These closed equidensity curves envelop each one of the 
nuclei up to the bond critical point located along the bond path joining two 
nuclei. Other closed equidensity contours envelop both nuclei, etc. This is shown 
schematically in Fig. 2 for the LiH molecule. 
Let us now show that when we apply a local-scaling transformation to 
a closed contour $1(~; C) of Pl (defined by pl(~) - C = 0), we obtain a closed 
180 

Local-Scaling Transformation Version of Density Functional Theory 
Fig. 1. Schematic representation of the one-electron density of LiH 
Fig. 2. Equidensity curves for LiH 
contour of/)2 (see Fig. 3). The transformed contour is: 
S2(F; C)= J(f(F);r-')S,(f(F); C)= F ;-~ .... ]S,(f(r); C) 
(44) 
LPltJtr)ll 
where, in the right-hand side of Eq. (44), we have used the explicit expression for 
the Jacobian given in Eq. (31). It is clear that the transformed contour has the 
same functional form as the initial one. At eachpoint in ~3, the Jacobian creates 
a positive and bounded factor multiplying $1 (f(~); C), for all allowable values of 
C. The continuity, positivity and finiteness of the Jacobian guarantees that a set 
of closed equidensity contours in the initial density is mapped into a correspon- 
ding set of closed equidensity contours in the transformed density. In addition, it 
follows that local-scaling transformations map the topological features of the 
initial density into the transformed one. 
It is clear that arbitrary one-particle densities of a molecular system need not 
have the same topology. In fact, only those belonging to the same "structural 
region" will share this property. To make these concepts clearer, consider two 
nuclear configurations X and Y belonging to the nuclear configuration space 
{/~} in the context of the Born-Oppenheimer approximation. The correspond- 
ing one-electrons densities are p(~; X) and p(~; Y), respectively. Consider the 
181 

E.V. Ludefia and R. L6pez-Boada 
Fig. 3. Schematic representation of the transformation of a closed density contour curve ofp~ (dark 
contour on the left-hand side) into that of P2 (dark contour right) by local-scaling transformations 
two vector fields Vp(F; X) and Vp(F; Y). The nuclear configurations X and Yare 
equivalent if there exists a homeomorphism between the vector fields Vp(-~; X) 
and Vp(-~; Y). It is precisely this homeomorphism that guarantees that they have 
the same topological features, i.e., that they are contained in the equivalence 
class or "structural region" of the particular molecular graph or molecular 
structure. In plain words, if we stretch a molecule without either breaking the 
bonds or changing in any way the number and types of critical points, we can 
transform densities throughout the whole space of allowable "stretches" by 
application of local-scaling. In particular, for clamped nuclei we can transform 
densities of approximate wavefunctions into the exact density corresponding to 
the clamped nuclear positions. At this point let us introduce the set of one- 
particle densities 
JVB --= { p(~; Q) Ip 
satisfying Bader's topological features} 
(45) 
Clearly, the set JVn is a subset of jIr, of Eq. (16), i.e., dV'n c X,. The set JV'B will be 
useful in the definition of "orbit" advanced in Sect. 4.1. 
2.4 Density-Transformed One-Particle Orbitals and Their use in the 
Construction of Energy Functionals 
Let us consider now the application of local-scaling transformations to sets of 
single-particle functions or orbitals. As it was shown in Sect. 2.1, a set of plane 
waves gives rise to the transformed orbitals described by Eq. (2). In particular, 
the application of this transformation to one-dimensional plane-waves leads to 
Harriman's "equidensity orbitals" [27], which are given by: 
p(a, b, c) 
t~k(a, b, c) = X] 
U 
exp [ik f(a)] 
(46) 
where the one-dimensional phase factor is defined as: 
f(a) = 2n ~ ~(a')~(a')da' 
,d ao 
(47) 
182 

Local-Scaling Transformation Version of Density Functional Theory 
In this expression, a is one of the coordinates a, b and c in three-dimensions, 
whose volume element is d3~ = ~(a)fl(b)7(c)dadbdc and where: 
F'f" 
~(a) = 
p(a, b, c)fl(b)?,(c)dbdc 
(48) 
bo 
co 
Note that these orbitals satisfy the "equidensity" condition ~k*(a, b, c) qJk(a, b, c) = 
p(a, b, c)/N; hence, a single Slater determinant constructed from these orbitals 
yields the density: 
N 
p(a, b, c) = ~ ~b~(a, b, C)~lk(a , b, c) 
(49) 
k=l 
In polar coordinates, we have the following explicit form for these "equidensity 
orbitals" [27]: 
g'k(r,O,q~)=~exp[i(k 
N+I) 
] 
2 
f(r) 
(50) 
where an additional phase factor, exp [- iN+~2f(r)], has been added for the 
purpose of minimizing the kinetic energy [61, 63, 64]. 
The density-transformed orbitals given by Eq. (50) can be used directly in the 
construction of closed analytic expressions for the 1-matrix in the single-deter- 
minantal case: 
N 
o~(~,, ~2) = ~ 
4,~(~1)~,~(~2) 
(51) 
k=l 
Substituting the explicit form of Eq. (50) into Eq. (51) and carrying out the 
summation, one obtains [64]: 
1 
sin ~ F(rl, r2) 
(52) 
D)(?,, 32) = ~ ,,,/P(~,)P(~2) sin½F(r~, r2) 
where F(r~, re) =-f(r~) -- f(r2). Note that in view of Eq. (47), the phase factorf(r) 
depends upon the density P(0: 
f(r) -f([p]; r). 
(53) 
Clearly then, the closed expression for the density-transformed 1-matrix in 
Eq. (52) (i.e., the l-matrix constructed from transformed orbitals) is a function of 
the single-electron density p(~). Hence, when we express the total energy of an 
N-particle system (in the single-determinantal approximation) in terms of the 
transformed one-matrix described by Eq. (52), one can readily obtain an energy 
functional which depends on p. This fact, which has been exploited by several 
authors [59-62, 85], is considered below with particular reference to the work of 
Ludefia [60]. 
Consider the N-electron Hamiltonian: 
1 
N 
S-1 
N 
1 
I~v 
: r "~- frext + 0 -~" i=l 
-- ~ 17~ + I=aZ v(-ri) + i=71 j=i+lZ i~ i _ ~jI (54) 
183 

EN. Ludefia and R. L6pez-Boada 
where v(Ti) is the external potential for coordenate 7~. The energy, expressed as 
a functional of the normalized wavefunction • ~ &°,v, is: 
E[~] = (~rHvl ~> 
(55) 
When • = ~o adopts the form of a normalized single Slater determinant formed 
from density-transformed orbitals, the energy functional is: 
E[%] = r[%] + E,x, [%] + V [%] 
(56) 
: T[~p] .-~ Eext[~#] + Ecoulomb[~#] "~ Ex[(~#] 
where T[%] is the kinetic energy, Eex, [%] the energy contribution due to the 
external potential, Eco,,o,,b [%], the Coulomb (or Hartree) energy, and Ex [%] 
the exchange energy. The energy functional of Eq. (56) can be expressed exactly 
in terms of the 1-matrix 
i - -, 
Dp(rl, tO, and the one particle density p(7): 
E[%]= f 
f d37p(7)v(r-3 
if 
fp(71)p(~2) 
(57) 
+2 
d371 d3~2 171-721 
f 
f 
D~(71,~2)D~(-rz,-rl) 
1 
d371 d3~2 
2 
171 - 721 
Introducing the closed analytic expression for D~ given by Eq. (52), we obtain for 
the kinetic energy term [641: 
1 f 
VeDo(rl, 7' 
(58) 
1 fd3_~[17;p(~)32+~7(~(l_ 1 ) ( 
Substituting for r the radius of the Fermi sphere re = (3/4rc p)-1/3, we can 
rewrite the kinetic energy as: 
(59) 
r[%] = r., [%] + \U~j 
where Tw is the Weisz/icker term. Note that the last term in Eq. (59) is just 
a corrected Thomas-Fermi kinetic energy expression. 
The exchange energy contribution is also a functional of the one-particle 
density: 
1 
Dp(rl, r2)Dp(r2, rl) 
Ex[%] = - ~ 
d3-~I d3-~2 
17--~ "~72--~[ 
1 F 
~d27 p(71)p(72) sin 2 ~[f(rl)--f(rz)] 
(60) 
- 
~ 
J d371 ,1 
2 I~ ---~21 sin 2 ½If(r1) -f(r2)]" 
184 

Local-Scaling Transformation Version of Density Functional Theory 
In the particular case when p is spherically symmetric, the exchange energy can 
be rewritten in the simpler form [60]: 
Ex[~o] = - 
drlr~(rl)vx(f([p]; rl) 
(61) 
where (for example, for N even) [60]: 
N 
N 
ta-k 
Vx(f([p];r,)) = ~ ~ ~ (cO),(cO)~c'~-k(- 1) k 
i=l j=l 
k=O 
× l [cosWf-~ sin°'f-~ P~,,k(f (rl)) 
(62) 
+ sin~'~ 
coskf~Q~.k(f(rl))l 
In Eq. (62) 09 = i -j + k and c m is the binomial coefficient, 
1 ('I~r°df(r2). o,f(r2)_kf(r2) 
P,o.k(f(q)) = ~ JO 
~ 
sm --~--cos 
-~ 
(63) 
and 
1 .f~ tq'df(r2) 
~,f(r2) . kf(r2) 
Q,o.k(f(rl)) = ~ 
~ 
cos --~--sln 
~ 
(64) 
Note again that because of Eq. (53), the exchange energy given by Eq. (61) is an 
implicit functional of p. (For a similar formulation of this problem, see [114].) 
A generalization of Harriman's orbitals has been proposed by Gosh and 
Parr [63]; it is based on a description similar to that of Zumbach and Maschke 
[61] but uses polar spherical coordinates: 
I~od~'p(r, O, r~') 
f,(r, O, qb) = ~2~dc~p(r, O, d?) 
0 
2~ 
t • 
So So dO sin O'd~b' p(r, 0', q¥) 
(65) 
f2(r, O) = SoS~o~dOsinOd~p(r, O, 4) 
f 3(r) = 
dr' r' 2 dO sin Odd~p(r', O, d~). 
,0 
For the spherically symmetric case, this transformation leads to: 
k = ~/2~t 
f2 = (1 - cos 0)/2 
(66) 
f3 =f(r) 
and the corresponding transformed three-dimensional plane wave can be 
185 

E.V. Ludefia and R. L6pez-Boada 
written as 
~kktr.(r, O, (9)= ~,0, 
C~) expi27t[kf(r) + (//2)(1 - cos0) + (m/2)q~] 
(67) 
where k, l, m are quantum numbers. The kinetic energy term that ensues from 
these orbitals has been discussed by Gosh and Parr [63], but -- as these authors 
point out - there appear singularities which might not lead to improved 
expressions for this functional. 
2.5 Application of Space-Coordinate Density Transformations 
to Atomic Orbitals 
We illustrate here a specific example of the application of local-scaling trans- 
formations to atomic orbitals El 11]. Consider the R~s(r) and R2s(r) orbitals of 
the Raffenetti type for the beryllium atom [71]: 
12 
R.s(r) = ~, C.sjzj{r) 
(68) 
j=l 
expanded in terms of ls Slater orbitals: 
g~(r) = (2~j)3/2/2! 1/z exp( - ~jr) 
(69) 
with exponents ~j = ~13~ that depend only on the parameters ~ and 13. The 
twelve-term expansion of Eq. (68) is sumciently flexible to describe the Har- 
tree-Fock wavefunction of the beryllium atom quite accurately [71]. 
The density associated with the Hartree-Fock-Raffenetti wavefunction is 
denoted by p~Z(r). We take this to be the initial density in our local-scaling 
transformation, i.e., p l(r) = pt]~ 2 (r). We take as the final density, that associated 
with the 650-term CI wavefunction of Esquivel and Bunge [73], which we call 
p2(r) = pc1(r). These two densities are practically about the same, as can be seen 
clearly in Fig. 4, where we have also plotted their difference. The transformed 
radial orbitais are given by: 
/ 
P cz(r) 
R TAr) = jf(r); 
r) R.s(f (r) ) = ~/ p~r) 
) R.s(f (r)) 
(70) 
The transformation function f(r) is computed by solving either Eq. (39) or 
(40) numerically, depending on whether we take the boundary condition at zero 
or at infinity. In practical applications, Eq. (40) is preferred; thus, we rewrite the 
integrated equation as: 
F(f(r)) = 
dxx2pl(x) - 
dyyZp2(y) = 0 
(71) 
(r) 
186 

500 
/~ 
4xr2(pc1(r)-p~(r)) x 10 3- 
p~(~)- 
I 
i 
"-"f 
4OO 
300 
200 
100 
0 
-100 
-200 
-300 0 
Local-Scaling Transformation Version of Density Functional Theory 
4 
6 
8 
10 
r (bohrs) 
Fig. 4. Comparison of Raffenetti and Esquivel and Bunge densities for beryllium atom. [Repro- 
duced with permission from Fig. 1 of Ludefia et aL [111]] 
where both densities are normalized to N. In general, when the one-electron 
densities are selected to have the following form: 
K 
p(r) = ~, alrb~exp( - ci)r 
(72) 
i=1 
(which, incidentally, is just the form of the Raffenetti and B unge densities p~t~. 2 (r) 
and pc1(r), respectively), the integrals appearing in Eq. (71) can be obtained 
analytically in closed form. The transformation function f(r) can then be 
calculated at each point r by the Newton method [48]: 
f. + ~ (r) = f.(r) -- F(f.(r))/F'(f.(r)) 
(73) 
where 
F'(f) =f2p2(f ) 
(74) 
Although the method converges well, it is numerically unstable both for small 
values of r (r < 10 -4) and for large values of r (r > 20). The unstability at the 
small r limit can be remedied by applying the McLaurin expansion to the 
densities appearing in Eq. (71): 
dxx2pl(x) 
= 
dxx2pl(x) 
- 
dxxZpt(O) 
o 
o 
-4zc 
r a, 
r~ 1, 
(75) 
187 

E.V. Ludefia and R. L6pez-Boada 
fj~r} dyy2pz(y) 
N [ ~  
1 
= -~ - 
f(r) 3, f(r) ,~ 1 
(76) 
It follows, therefore, that when r (andf(r)) go to zero, an approximate solution 
to Eq. (71) is: 
['P'(O)l'/3 
(77) 
f(r) = LP~J r 
For large values of r, the dominant terms in the density expansions (see Eq. (72)) 
are those with the smallest exponents. Moreover, because the exponential term 
is the dominant one, we can approximate F(f(r)) in Eq. (71) by: 
F(f(r)) = P(r)exp( - Ar) - e(r)exp( - Bf(r)) = 0 
(78) 
with A = min {ci ~ } and B = min {c~}. When r is large, this leads to the approxim- 
ate solution: 
A 
f (r) = -B r 
(79) 
In Fig. 5, we present plots for the transformation functionf(r), for the Jacobian 
of the transformation J(f(r); r), and for the derivative of the transformation 
function, df(r)/dr corresponding to the example at hand. Selected values for the 
transformed orbitals are presented in Table 1, where we have also listed the 
corresponding values of the Hartree-Fock-Raffenetti orbitals, as well as the 
difference between untransformed and transformed orbitals for the sake of 
completeness. 
l 
I 
i 
J(f, 
7 
0 
! 
I 
! 
0 
3 
6 
9 
r (bohra) 
Fig. 5. Graph of the local-scaling transformation function f(r) and related quantities 
188 

Local-Scaling Transformation Version of Density Functional Theory 
Table 1. Selected values of the Raffenetti-Hartree-Fock orbitals lsnr and 2she for Be, of their 
locally-scaled transformed functions lsrnr and 2srr and of their differences d 1~ = (lsnF - Isle) and 
A2, = (2sue -- 2s~F). [Reproduced with permission from Table t Ludefia et al. [Ill]] 
r(bohrs) 
lsnF 
lsrF 
AI~ 
2snv 
2srr 
d2~ 
0.09735 
2.816731 
2.815507 
0.001224 
- 0.506750 
-- 0.506534 
-- 0.000216 
0.21599 
1.785544 
1.784217 
0.001327 
- 0.301088 
- 0.300898 
-- 0.000189 
0.31426 
1.235548 
1.234669 
0.000880 
- 0.183859 
- 0.183820 
- 0.000039 
0.41632 
0.848934 
0.848758 
0.000176 
- 0.096321 
- 0.096472 
0.000150 
0.52628 
0.570176 
0.570811 
- 0.000635 
- 0.029220 
- 0.029474 
0.000254 
0.60575 
0.428996 
0.430208 
-- 0.001212 
0.006530 
0.006387 
0.000143 
0.73067 
0.275433 
0.277403 
-- 0.001969 
0.047078 
0.047799 
-- 0.000721 
0.92365 
0.139958 
0.141070 
-- 0.001112 
0.083892 
0.088085 
-- 0.004193 
1.01443 
0.102036 
0.101597 
0.000439 
0.093826 
0.099183 
-- 0.005357 
1.22364 
0.049491 
0.047283 
0.002209 
0.105225 
0.109704 
-- 0.004479 
1.34391 
0.032735 
0.030793 
0.001942 
0.106814 
0.110390 
-- 0.003576 
1.40840 
0.026245 
0.024540 
0.001705 
0.106643 
0.109848 
-- 0.003205 
1.54683 
0.016359 
0.015138 
0.001221 
0.104514 
0.107143 
-- 0.002629 
1.62106 
0.012706 
0.011698 
0.001008 
0.102624 
0.105028 
-- 0.002404 
1.69886 
0.009756 
0.008933 
0.000823 
0.100237 
0.102440 
-- 0.002203 
1.78039 
0.007401 
0.006736 
0.000665 
0.097395 
0.099413 
-- 0.002018 
1.95537 
0.004099 
0.003677 
0.000421 
0.090538 
0.092200 
-- 0.001662 
2.14756 
0.002148 
0.001892 
0.000257 
0.082447 
0.083736 
-- 0.001289 
2.47182 
0.000727 
0.000617 
0.000111 
0.068895 
0.069564 
-- 0.000669 
2.84505 
0.000211 
0.000170 
0.000041 
0.054834 
0.054858 
-- 0.000024 
3.12468 
0.000084 
0.000065 
0.000019 
0.045767 
0.045405 
0.000362 
3.59648 
0.000018 
0.000013 
0.000005 
0.033330 
0.032546 
0.000785 
3.76908 
0.000010 
0.000007 
0.000003 
0.029598 
0.028724 
0.000874 
4.13952 
0.000003 
0.000002 
0.000001 
0.022855 
0.021883 
0.000972 
4.54638 
0.000001 
0.000000 
0.000000 
0.017130 
0.016154 
0.000976 
2.6 The Transformation of N-Particle Wavefunctions 
The uniqueness of the density transformation has an important implication: any 
two one-particle densities p1(7) and p2(7) having the same topology, i.e., 
Pl(-:), P2(~)e ,/VB (see Eq. (45)) are uniquely connected by the local-scaling 
transformation which is a solution to Eq. (36). In Hilbert space we have an 
infinite number of N-particle wavefunctions that yield a given density. This 
means that if we apply this particular local-scaling transformation to an arbit- 
rary wavefunction ~ 
that associates with the density pl (7)(where the superin- 
dex [i] indicates a given wavefunction selected from the infinite set), then 
- according to Eq. (30) - the transformation yields a wavefunction a~tiJ Note 
~P2" 
that we keep the same superindex in this transformed wavefunction, because it is 
uniquely generated from ~i~. 
In order to exemplify these ideas, we construct three initial or generating 
wavefunctions for the 1S state of the helium atom, and generate two types of 
189 

E.V. Ludefia and R. L6pez-Boada 
transformed wavefunctions by applying local-scaling transformations. These 
two cases are itemized below: 
• All transformed wavefunctions yield the "exact" (Benesch [68]) one-particle 
density. 
• All transformed wavefunctions yield the Hartree-Fock (Boyd [72]) one- 
particle density. 
We take the initial wavefunctions to be very limited configuration-interac- 
tion expansions, containing only s orbitals. Thus, we take as the first wavefunc- 
tion in the one formed by all single and double excitations generated from the 
basic configuration [ls 2] by substitutions comprising the 2s orbital; for the 
second wavefunction, we span over the 2s and 3s orbitals; and for the third one, 
we use orbitals Is', 2s' and 3s'. Hence, are all these wavefunctions are "full CI" 
wavefunctions for such bases. Explicitly, these wavefunctions are 
~[a U= Cls2[ ls 2] + C:,2~[ ls2s] + C2s212s ~] 
(80) 
t~21 = Cls2[ls 2] + C2s212S 2] + C3s213s 2] + CI,2,[ls2s] 
and 
+ Cls3s[ls3s] + C2s3s[2s3s] 
(81) 
q,~3j = Cl~,2[ls,Z] + Czs,2[2s,Z] + Ca~,213s,2] + Cl~,2~,[ls'2s'] 
+ Cls,3s,[ls'3s'] + C2s,3~,[2s'3s']. 
(82) 
The orbitals ns and ns' are expanded in terms of Slater functions: 
ns(r) = ~ c,~jzj(r) 
(83) 
j=l 
with g~(r) = Njr"J- 1 exp( - 2:) and z~(r) = N~r"J- 1 exp( - 2~r). In Table 2, we 
list the CI expansion coefficients of the generating wavefunctions. In Tables 3, 
4 and 5, we list the values of the parameters for the orbitals entering in 
wavefunctions ~t11, ~tbzJ and ~t31, respectively, 
The wavefunctions described by Eqs. (80), (81) and (82) are associated with 
the one-particle densities p,(r), pb(r), and pc(r), respectively. For example, the 
Table 2. Configuration interaction expansion coefficients for 
the wavefunctions 
C1: 
- 0.96861 
0.96084 
- 0.98862 
C2: 
0.03370 
-- 0,02994 
0.05557 
C3: 
- 0.00530 
0.00763 
C1~2~ 
0.24628 
- 0.21596 
- 0.13717 
Cls3, 
- O. 17093 
0.02252 
C2~3, 
0.00184 
-- 0.01268 
190 

Local-Scaling Transformation Version of Density Functional Theory 
Talbe 3. Orbital parameters for ~a function 
i 
Cts~ 
c2s~ 
nl 
).i 
1 
0.84347 
-- 1.08553 
i 
2.36923 
2 
0.21087 
1.35844 
2 
1.67585 
Table 4. Orbital parameters for ~b function 
i 
¢ls, 
C2s~ 
C3s, 
?ll 
~i 
1 
1.00000 
-- 2.11677 
1.11180 
1 
2.00 
2 
0.00(O 
2.34109 
-- 1.77632 
2 
2.20 
3 
0.000~ 
0.00(O 
1.34909 
3 
1.30 
Table 5. Orbital parameters for ~¢ function 
i 
Cls T 
C2s ' 
C3s, 
Hi 
~i 
1 
1.00000 
- 2.90019 
5.38297 
1 
1.45987 
2 
0.00000 
3.06775 
- 13.16192 
2 
1.83110 
3 
0.00000 
0.00000 
8.32176 
3 
2.14871 
explicit form of pa(r) is: 
pa(r) = nl:(ls(r)) 2 + nl~2~(ls(r)2s(r)) + n2:(Zs(r)) 2 
where 
(84) 
n,: = (2C2: + C~2~) 
nt~2~ = 2x//2Cls2s(Cls 2 + C2s2) 
(85) 
n2: = (C2,z~ + 2C~,2) 
The "exact" one-particle density for the helium atom is assumed in this case to 
be that of Benesch [68]: 
14 
7 
p .... ,(r)= 
~. a,r"e-kr+ 
~. bnrne -2kr 
(86) 
n=l 
n=l 
For the Hartree-Fock density, we take that of Boyd [72]: 
15 
pttv(r) = 
~ 
ckr"~e - z: 
(87) 
k=l 
191 

E.V. Ludefia and R. L6pez-Boada 
The transformation functions f(r) for the case considered here have been 
calculated by solving Eq. (36). Selected values of these transformations are listed 
in Table 6. 
The superindices [1], [2] and [3] that label wavefunctions ~lj, ~21 and q~sl, 
respectively, indicate the different subclasses of wavefunctions that can be 
generated from the initial ones by means of local-scaling transformations. Thus, 
although wavefunctions ~zj and ~I. 31 have the same form, the fact that they 
contain different orbitals makes it impossible to transform one into the other by 
means of local-scaling transformations. The particular subclasses of wavefunc- 
tions that are generated from some given, but otherwise arbitrary, initial or 
generating wavefunctions are called "orbits". Note that these "orbits" are sets of 
N-particle wavefunctions and have nothing in common with atomic or molecu- 
lar "orbitals". 
Thus, for example, from wavefunction ff~tbZl we can generate an "orbit" which 
contains - among the infinite number of wavefunctions obtained through the 
application of local-scaling transformation, the particular wavefunctions 
~tbZ~,F and ~'b.'~t2ip,,,,. The important aspect of "orbits" is that the uniqueness of the 
local-scaling transformation associates a different one-particle density p e JVj~ 
with each wavefunction in an "orbit". In other words, for all wavefunctions 
within an "orbit", there is a one-to-one correspondence between wavefunctions 
and one-particle densities. Moreover, all wavefunctions belonging to an "orbit" 
can be constructively generated. 
To complete this section, we present in Table 7 some energy values for the 
initial, as well as for the transformed wavefunctions q, tu, 4,~21 and #~31 discussed 
above. The energies in the first column correspond to the expectation values of 
the untransformed wavefunctions. The second and third columns are those of 
Table 6. Selected values for the transformation functions f(r) 
exact 
fc (r) 
f b (r) 
f c 
(r) 
,f b 
(r) 
r 
fa 
(r) 
ful~(r ) 
..... 
lie 
..... 
ttb" 
0.00070 
0.00070 
0.~70 
0.00071 
0.00071 
0.00070 
0.00070 
0.03895 
0.03894 
0.03884 
0.03988 
0.03978 
0.03889 
0.03879 
0.13569 
0.13565 
0.13530 
0.13782 
0.13754 
0.13554 
0.13520 
0.19679 
0.19670 
0.19623 
0.19904 
0.19857 
0.19661 
0.19613 
0.26963 
0.26949 
0.26889 
0.27132 
0.27073 
0.26945 
0.26885 
0.35796 
0.35780 
0.35780 
0.35780 
0.35780 
0.35780 
0.35780 
0.46732 
0.46723 
0.46657 
0.46481 
0.46416 
0.46740 
0.46674 
0.60622 
0.60652 
0.60612 
0.59941 
0.59903 
0.60683 
0.60643 
0.78849 
0.78999 
0.79032 
0.77604 
0.77635 
0.79037 
0.79069 
1.03822 
1.04278 
1.04466 
1.02147 
1.02332 
1.04287 
1.04474 
1.40138 
1.41248 
1.41742 
1.39573 
1.40093 
1.41128 
1.41619 
2.86944 
2.89079 
2.90968 
3.37882 
3.40908 
2.88787 
2.90695 
3.88840 
3.88391 
3.90478 
4.96967 
5.00238 
3.90333 
3.92496 
4.98703 
4.98704 
4.94333 
6.55808 
6.58243 
4.99914 
5.01661 
6.24795 
6.08257 
6.10331 
8.23826 
8.26792 
6.24235 
6.26488 
192 

Local-Scaling Transformation Version of Density Functional Theory 
Table 7. Energy values for the initial and locally-scaled 
wavefunctions #,, ~b and #c (energies in hartrees) 
Pinitial 
PltF 
PBenesh 
C~On-opt 
~.,{ls2s} 
~b,{ls2s3s} 
~o{ls2s3s} °p' 
C~ ~ 
~a 
~b 
-2.877415 
-2.877220 
-2.877396 
-2.867977 
-2.876634 
-2.876793 
-2.878605 
-2.878295 
-2.878507 
-2.877226 
-2.877398 
-2.877031 
-2.876996 
-2.878522 
-2.878580 
the transformed wavefunctions with final densities PHF and Peenesch, respectively. 
The coefficients in the first three lines are those that were originally chosen. 
Those in the last three lines have been optimized, keeping the final density fixed. 
It is of interest in the present context to note that although all six energy values 
in the last column correspond to wavefunctions that associate with the same 
exact one-particle density (we assume here that this exact density is approxim- 
ated well by that of Benesch [68]), these values are quite different. This clearly 
illustrates the fact that the energy functional does not depend on the density 
alone, but it also depends on the form of the generating wavefunction, which - in 
turn - determines the shape of the exchange and correlation holes (see Sect. 4.2). 
2.7 General Space-Coordinate Density Transformations 
Let us now elaborate on the relation given by Eq. (27):f= (kpl)- 1 o Rp2 Clearly, 
from this relation we obtain: 
k,+, of= 
(88) 
Now let us determine the effect of the operators on both sides of Eq. (88) on the 
vector 7 = (r, 0, 49). When we operate with Rp2 on the vector 7 = (r, 0, 49), we 
obtain: 
kp27 - R,2(r , O, 49) = (Rp~,,(r, O, 49), Rpve(r, O, 49), Rp~,,~(r, 0, q~)) 
(89) 
The effect of the operators on the left hand-side of Eq. (88) on F is: 
R+o,+ off 
= Rp, of(r, O, 49) 
= Rp,(f,(r, O, q~),fo(r, O, 49),f+(r, O, 49)) 
= (Rp,.r(f.fo, f+), Rp,,o(f.,fo, f+), Rat,+(f.,fo, f+)) 
(90) 
193 

E.V. Ludefia and R. L6pez-Boada 
Equating the vector components of Eq. (89) with those of Eq. (90) we obtain the 
set of equations: 
Rp2,r(r, O, 49) = Rp.r(f,,]o, f4,) 
Ro2,o(r, O, 4)) = Ro.o(fi,fo,f,) 
(91) 
Rov4,(r, O, 49) = Ro.e(fr, fo, f o) 
Introducing the measure: 
#o(r, 0, 49) = p(r, 0, 49)r 2 sin 0 
(92) 
we define the vector components in polar coordinates as (see Gosh and Parr 
[63], or Zumbach and Masche [61]): 
~o~olo dr dO d49 It(r, 0', 49') 
Rp,r(r, O, 49) = 
+oo 
. 
2 . . . . .  
"', 
~o ~o~o dr dO d¢ bt(r, O, 49') 
0 
2r~ 
t 
~olo dO d49/.t(r, 0', 49') 
Ro.o(r, O, 49) = 
~ 
2. 
, 
, 
Iofo dO d49 kt(r, 0', 49') 
Io* a49'~(r, o, 49') 
Ro,~,(r, O, 49) = i2.d49,#(r, O, 49') 
(93) 
(94) 
(95) 
The equalities given by Eq. (91) can be now explicitly written. Thus, for the 
r component, we have: 
fr 
X 
2~t 
f 
~ 
t 
r 
~ 
~ 
r~ 
2n 
p 
t 
t 
t 
_ 
~oSo dr dO a49 .~2(r, O, 49') 
~o ~o~o df.dfodf*#al(f,,fo, f4,) 
~o 
So 
. 
2. 
.
.
.
.
.
.
 
- 
Io* 
" 
2 .
.
.
.
 
r' 
~oIo df, dfodf~#p,(f,,fo, f,) 
~o~o dr dO de lt,2( , 0', ¢') 
(96) 
For the 0 component, we are led to the expression: 
~o A2 .
.
.
.
.
 
~o df o df elap~ (f.f o, f 43 _ ~°o ~2~ dO' a49' pp2(r, 0', 49') 
(97) 
-- 
n 
2n 
, 
r 
r 
~o ~oZ .
.
.
.
.
.
 
dfo df4,t2p ~ (f,,fo, f,~) 
~o ~o dO d49 #a2(, O, 49') 
Finally, for the 49 component, we have the result: 
f~ 
t 
~ 
t 
Io df ¢l~p~(f,,Jo, f ¢) _ ~od49' #p~( r, O, 49') 
(98) 
2~ 
, 
, 
- 
2~ 
, 
r 
0 
' 
For spherically symmetric densities, Eqs. (95), (97), and (98) become: 
fY'df' f'2 p, 
f" 
4re 
dr, r,2 p2(r,) 
(99) 
4__~n 
(f;) = N- 
o 
N $o 
1 
-- cosfo _ 1 -- cos 0 
(1130) 
2 
2 .......... 
and 
f, _ ~_ 
(101) 
2~ 
2~ 
194 

Local-Scaling Transformation Version of Density Functional Theory 
Equation (99) is completely equivalent to Eq. (39). Thus, the transformations 
discussed here and the local-scaling transformations coincide in this spherically 
symmetric case. It is clear however, that the procedure outlined in this Section is 
much more flexible than the one presented in Sect. 2.2. 
Let us also consider the application of these transformations to diatomic 
molecules. We note that the density transformations carry the initial prolate 
spheroidal coordinates (C, r/, 4) into the transformed coordinates (Cp, %, q~). The 
equations that define these transformations are [119]: 
~ ,p(t/', ()(~2 _ t/,2)dt/, _ .[~, p,(t/', ~p)((2 _ t/,2)dt/, 
j"_, p(r/', ~')(( 2 -- r/'2) dr/' - j"_, p, (r/', (p)(~ "2 - rl'2)dtf 
and 
(102) 
~1_, ~¢ p(q,, (,)(~,2 _ t/'2)dt/' d~' _ j'~ j'~ip,(r/, 
' (,)((,2 _ rl,2)drl, d~, 
N/2rc 
N/2rc 
(103) 
2.8 Momentum-Coordinate Density Transformations 
Let us consider an N-particle wavefunction ~p,~l ..... ~N) (where for simplicity 
we disregard spin) associated with the one-particle density pl(~), and let us 
obtain the Fourier transform of this wavefunction by means of: 
~,,(Pl ..... P~') = (2~Z)- 3m2 f d3~, "" f d3-~Nexp( -- i k~= ~k'-~k ) 
x 4~p,(71, ..., 7N) 
(104) 
The momentum wavefunction is associated with the momentum density 71(P) 
through the relation 
..... 
Yl(P) 
N 
From the momentum density one can find the radial momentum density by 
integration over the angular variables ~ in momentum space: 
j'd~rp 2 7(P) 
(106) 
l(p) 
as well as the spherically symmetric isotropic Compton profile (within the 
impulse approximation): 
If 
p- 1 X(p) 
(107) 
J(q) = ~ ql 
Note that the momentum density 7(P) is not the Fourier transform of the 
position density p(F). 
195 

E.V. Ludefia and R. L6pez-Boada 
Just as it was done in position space, we can introduce local-scaling trans- 
formations in momentum space, in view of the fact that the momentum densities 
satisfy the following conditions: 
1. ?(~) is nonnegative everywhere in M~. 
2. Id3~?(~) = N. 
3. ?(fi) is a continuously differentiable function of fie Map, i.e., each component 
of Vp?(fi) is a continuous function of ~. 
4. Any equidensity path 7(P) = C is closed and continuous and the whole set of 
these paths covers the entire space of ~pa when C ranges over the domain of 
values of a given ?(fi). 
Thus, we can consider the following local-scaling transformation in momentum 
space: 
. ~-.. 
P(P) F 
p---~p(p) = -- 
(108) 
P 
Given two momentum densities ?2(P) and 71 (P) satisfying the above constraints, 
we obtain as a result of this transformation: 
72(P) = J(P(P); P)71(P(P)) 
(109) 
where J(P(~); fi) is the Jacobian of the transformation. Again, as in the case of 
position space, we restrict these transformations to those having positive definite 
Jacobians, in order to guarantee uniqueness. 
In analogy with the position-space treatment, we have the following explicit 
expression for the Jacobian: 
j(p(fi);fi) 
P" V~p3(p) 
(ll0) 
-
-
 
p3 
For the spherically symmetric case we have: 
dP(p) 
p2 
72(P) 
(111) 
dp = p2(p) 71(p(p)) 
which in integrated form becomes: 
f PlP) 
fo' 
dxxZyl(x) = 
dyy2~;2 (y) 
(112) 
do 
It follows from the above considerations that local-scaling transformations 
can be advanced in momentum space on an equal footing with those in position 
space. In particular, wavefunctions in momentum space can be transformed so 
as to generate new wavefunctions that have the property of belonging to an 
"orbit". 
Local-scaling transformations have been employed [39] in order to obtain 
a one-particle density in position space from the one-particle density in mo- 
mentum space, and vice versa. This problem arises from example when we have 
a 7(,~), obtained from experimental Compton profiles, and wish to calculate the 
corresponding p(~) [98]. 
196 

Local-Scaling Transformation Version of Density Functional Theory 
3 Relationship Between "Density-Driven" 
and Local-Sealing Transformations 
In a recent monograph (1990) on the "density driven" approach, Cioslowski 
[77] summarizes the development of density functional theory as follows: 
First in their celebrated paper Hohenberg and Kohn [17] have shown that 
the electronic wavefunction of the ground state is entirely determined by the 
corresponding density. This provided a nonconstructive proof of the existence 
of the density functional for the electronic energy, E[p]. It had taken [sic] 15 
years before the next step was reached. The constrained search approach 
[78, 84, 86] yielded an implicit construction for the functional E[p]. A rigor- 
ous prescription for E [p] was given, but its algebraic form (either direct or 
indirect) remained unknown. Various approaches to this problem, often 
connected with the efforts to find a Schrrdinger-like equation for the 
electron density, followed soon [62, 79-83, 92, 93]. However, an explicit 
construction of E[p] has become only known recently [74-76] 
The explicit construction to which Cioslowski refers is that provided by the 
"density-driven" approach, advanced in 1988. But, already in 1986, an alterna- 
tive way for carrying out this explicit construction had been set forward by 
Kryachko, Petkov and Stoitsov [28]. This new approach - based on local- 
scaling transformations - was further developed by these same authors [29, 30, 
32, 34], by Kryachko and Ludefia [1, 20, 31, 33, 35-37], and by Koga [51]. In 
this Section we show that Cioslowski's "density-driven" method corresponds to 
a finite basis representation of the local-scaling transformation version of 
density functional theory [38]. 
It is instructive, however, in order to establish the connection between the 
usual methods in quantum chemistry - based on molecular orbitals - and the 
local-scaling transformation version of density functional theory, to discuss 
Cioslowski's work in some detail. 
Consider the orthonormal set of one-particle functions {~bk,(~)} for k~ = 
1 ..... m, with rn greater than the number of particles N, from which an ordered 
set of M = (N) Slater determinants: 
det 
~K -- ~ 
[~bk~(7~)..- ~,bk,,(7~)] 
(113) 
is constructed (K denotes the ordered set of indexes kl < k2 < 
"" < kN). The 
N-electron wavefunction ~u in this finite basis is given by: 
M 
= ~. CK~K -- ~;~t 
(114) 
K 
197 

E.V. Ludefia and R. L6pez-Boada 
and the 1-matrix takes the form: 
DI(F,F) = ~ 
~ D~,.kjq~k,(F)dpkfl-~') 
(115) 
ki=l kj=l 
where Dlk,.ks =-- D~,.k~ [C] is the following function of the variational coetficients 
(see Eq. (22)): 
M 
M 
CKCLAI~ 
(i 16) 
K=I L=I 
The total energy becomes a functional of (~ and (~: 
1 ~, 
~ oli,k3[~] fd3-~fd3-~,~7(~k,(F-,)V~)k~(-~, ) 
f 
+ J d3Fp(F)v(F) + 2 
IF1 - F2I 
ki=l kj=l kk=l kl=l 
xfd3Flf d3F24)ki(-~l)4)ki(-~l)4)kk('~2)~)k'('~2)[~l 
-- F2[ 
(117, 
where the first term is the kinetic energy and the last term is the exchange- 
correlation energy. Note that the tensor lki,kj.kk.k I l-C] in this last term takes 
specific forms, depending on the orbital approximation. Thus, in the Hartree- 
Fock case, it becomes the product of the 1-matrix expansion coetficients. Any 
variation of this energy expression must be constrained by the orthogonality 
conditions on the orbitals: 
f d3F~(r-~pkj(r ~) = 
(118) 
(~k,k 3 
The gist of Cioslowski's work is to set up an energy functional that depends 
on the density, in the context of the constrained-search approach of Levy [841. 
This functional is, therefore, defined by: 
eEp] = min(e[~, C]} 
I,/,,C)~ p 
(119) 
where p denotes a fixed density. The possibility of carrying out this constrained 
search hinges upon the construction of all wavefunctions that yield the fixed 
density. This problem is solved in Cioslowski's approach by introducing a den- 
sity-dependent set of one particle functions or orbitals. These functions are given 
explicitly by: 
~k,([P]; ~ = fl- 1/2(r-')P{ r-') ~ (S- l/2)~ikS Fl~kj(F') 
(120) 
kj = 1 
198 

Local-Scaling Transformation Version of Density Functional Theory 
where: 
ki=l kj=l kk=l kl=l 
(121) 
and the generalized overlap matrix S is a Hermitian positive-definite solution of 
the equation: 
Skik j = f d3-;CkU'~)~k,(';)[~ - l(~)p(~) 
(122) 
Clearly, the energy functional constructed with these transformed orbitals must 
satisfy 
E[~[p], (~] = E[p, ~, C'] 
(123) 
as the transformed N-particle wavefunction becomes ~ = ~,KCK Mr, where the 
Slater determinants ~K are constructed from the transformed orbitals. Thus, the 
energy functional E[p, ~, C] can be minimized with respect to p(;), to the 
vector ~ formed by the initial Slater determinants, and also to the vector 
comprising the expansion coefficients. Clearly, this functional attains its 
minimum at p(~) = po(~) (where Po(~) is the exact ground state density), pro- 
vided that the space spanned by the initial Slater determinants is infinite and 
that the set of expansion coefficients is optimal. 
Let us now consider the transformed orbitals from the perspective of local- 
scaling transformations. For a fixed set of single-particle functions {~bk,(~)} and 
a fixed set of expansion coefficients {CK}, the wavefunction given by Eq. (114) is 
also fixed and yields a one-particle density p~(~). We now consider the local- 
scaling transformation that carries this density into a density p(7) and obtain the 
corresponding transformed orbitals: 
~lk,(~)-~- [J(f(~)',-f)]l/2~k~(f(~))= F p(~) ll/2~k,(f(~)) 
(124) 
Lp,(f(~))J 
Let us now expand the function ~k,(f(~)) appearing in Eq. (124) in terms of the 
one particle set {~k, ( )}k,=1. 
~k,(f(~)) = ~ 
Wk,kp~kp(-F) 
(125) 
kp= i 
where the expansion coefficients Wk,k. are - for the moment - undetermined. It 
follows from Eqs. (125) and (115) that the one-particle density p~ evaluated at 
the position vector f(~) becomes: 
= 
k~,k,., kjk~ Wk,kdpk~(~)qbk~(-~) 
(126) 
ki=l kj=l k~,=l kq=l 
The conditions that explicitly define the transformation matrix I4." can be 
obtained by noting that the overlap is not modified by local-scaling transforma- 
199 

E.V. Ludefia and R. L6pez-Boada 
tions: 
f 
(127) 
Moreover, since we assume that the set {q~k,(~)} is orthonormal, it follows that 
Sk,k~(~) = Sk,k~(4~) = 6k~kj" In order to establish the connection with Cioslowski's 
work, let us define the matrix element of the Jacobian of the transformation as: 
~d3~ P(~) 
(~v(F~) ~kq (~) 
(128) 
gk ko-- j 
Using Eqs. (128) and (125), we obtain from the first line of Eq. (127) the following 
condition on the matrix elements of W: 
Sklkj(O ) = (~kikj = ~, 
~ Wk~k, WkikqSkpkq 
(129) 
kp=l kq=l 
Making use of the property of a semi-definite one-body operator, say, £: 
(i1£1j> = <i[ £1/2£a/EIj> = ~(i1£1/21k> (kt £1/2 l J> 
(130) 
k 
it is easily seen that Eq. (129) is satisfied if: 
W= g-1:2 
(131) 
The identification with Cioslowski's work becomes evident if we let p,~(f(-~)) = 
It is clear, therefore, that Cioslowski's approach based on "density-driven" 
orbitals [74, 75, 77], corresponds to a finite orbital representation of the 
local-scaling transformation version of density functional theory [38]. 
4 The Construction of Approximate Energy Density Functionals 
by Means of Local-Scaling Transformations 
4.1 Functional N-Representability and the Notion of "Orbits" 
We have already introduced the notion of"orbit" in Sect. 2.6. Here we formalize 
this concept and show its implications for the functional N-representability 
problem. 
200 

Local-Scaling Transformation Version of Density Functional Theory 
Consider the class of N-particle wavefunctions {~iJ}~= 1 contain all wave- 
functions in Hilbert space that yield the same (but arbitrary) generating density 
pg(~) e JVB. For any given final density p(~) e -VB, there exists a unique coordi- 
nate transformation that carries pg(~) into p(~). This transformation is given, in 
general, by Eq. (27). When we apply the operatorfto each of the coordinates of 
a particular wavefunction ~tkJ belonging to the above class, we obtain, in 
analogy with Eq. (30): 
v__v_a 
N-times 
N 
= [I [3(f(~,); ~,)]'/2 4)~kl(f(~,) ..... f(~n)) 
(132) 
i=1 
Thus, for any p(7) ~ ..,V~ there exists a unique wavefunction 4~ kJ, generated by 
means of local-scaling transformation from the arbitrary generating wavefunc- 
tion 4~ kl. The set of all the wavefunctions thus generated, yielding densities p(~) 
in ./VB, is called an "orbit" and is denoted by (~1: 
~)~1_- {4)~llo~m__,p(~); 4~me~N; p(~)eW.} 
(133) 
We emphasize once more that the term "orbit" should not be confused with the 
word "orbital", which, in its usual connotation in quantum chemistry, denotes 
a one-particle function. 
The uniqueness of the local-scaling transformation guarantees that within an 
orbit 0~C '~'~v there exists a one-to-one correspondence between one particle 
densities, p(~) ~Jf B and N-particle wavefunctions, ~l e 60tffC~¢N. Note, more- 
over, that Hilbert space corresponds to the union of all "orbits": 
,.~ = L.)?=, E~ 
(134) 
Using the definition of the energy functional advanced in Eq. (55), we can state 
the variational problem leading to E~ as: 
E~= inf {E~[~]} 
(135) 
However, taking into account Eqs. (132) and (134), it clearly follows that the 
variational principle can be reformulated in terms of these "orbits" as 1-20] (see 
Fig. 6): 
E~= 
inf 
{inf {E~[qb~l] }} 
(136) 
over all orbits 
lil 
1il 
~C~aN 
~p etude 
where the inner variation is carried out within a particular "orbit" Cu~, whereas 
the outer variation spans all orbits making up Hilbert space. 
Because of the one-to-one correspondence between one-particle densities, 
p(~) e Jff~, and N-particle wavefunctions, ~le tPtff within each one of the 
201 

E.V. Ludefia and R. L6pez-Boada 
x~ 
o~J 
... 
o~ 
... 
o~ 
... 
oU ~ 
... 
F,~ 
¢~ 
... 
,~! 
... 
,c;~ 
... 
,~f~l 
... 
PHF 
O[1] 
.., 
0[2] 
... 
O[i] 
,.. 
¢~[HK] 
... 
pm, 
on,, 
pm. 
-,,.,, 
: 
: 
: 
; 
: 
: 
: 
: 
: 
p 
¢~,1 
... 
¢~1 
... 
¢~1 
... 
¢~1 
... 
: 
: 
: 
: 
: 
: 
: 
: 
: 
%o, 
.,. 
%, 
... 
_,...°,,/ ... 
Fig. 6. Many-to-one correspondance between wavefunctions in &aN and one-particle densities; 
~KI is the Hohenberg-Kohn orbit, i.e., the orbit that contains the exact ground-state wavefunction 
"orbits", we can formally write: 
E,,[4'~l(~l ..... ~,.4)] = E~,[i=I~ ~ ~/p(~3/p,(f3q'~q(fl ..... fN) 1 
=- ~,,[p(F); 4'~q(fl ..... fN)] 
(137) 
where since we assume that the orbit-generating wavefunction 4~t~ q is known we 
emphasize in the last line the fact that the functional depends solely (although 
implicitly through f([p]; r-')) on the object density, pff). The particular form in 
which the transformed vector depends on the object density can be obtained by 
solving Eq. (91). For this reason, the variational principle of Eq. (136) can be 
recast as [20]: 
E~ = 
inf 
{ i nf {Sv[p(7);q, toq]} } 
(138) 
over all orbits P( 
½ 
O~CLG, 
g- .~ 
Notice too that in view of the one-to-one correspondence between densities and 
wavefunctions within an orbit, the variation of #vl'p(F); ~rl with respect to the 
one-particle density p(F) is equivalent to the variation of Ev [q~t~ 1] with respect to 
the wavefunction ~ 
e d~tff. This equivalence guarantees functional N-represen- 
tability and illustrates the basic role of the notion of"orbit" in this respect. Note 
also that an approximate functional that does not satisfy Eq. (137) at all points 
of variation fails to comply with the unavoidable functional N-representability 
condition. 
202 

Local-Scaling Transformation Version of Density Functional Theory 
4.2 Construction of the Energy Density Functional Within an "Orbit" 
Let us now show how one can proceed to the actual construction of the energy 
functional, g~,[p(7); ~t~]]. We start from: 
E[q~ j] = ~ 
da;, V~, ~;D~tq(;,,F~)I~ ., =~, + 
d3;p(;)v(;) 
+ f f 
- ~21~' ;2) 
(139) 
In order to rewrite this functional in terms of the generating 1- and 2-matrices, 
we use the following expressions [20]: 
• 
/ 
p(7,)/ 
P(;'l! 
D~tq(f(;,),f(;~) ) 
(140) 
O,t,~(;,, ;;)= V p~(f(;1)) Vp~(f(L)) 
and 
P(;,) 
P(;2) 
D~t,l(f(;,),f(;2);f(;,),f(;2)) 
D2tq (;,. ;2; ;1. ;5) = p.(f(;,)) P.(f(;2)) 
(141) 
In addition, we decompose the 1-matrix that appears in the right-hand side of 
Eq. (140) into its local and non-local components: 
DI[i'(?(;1),.?(;~ 1 )) = [pg(?(;1))] 1/2 [pg(?(7 i ))]1/2 51[i](?(71),?(;, t )) 
(142) 
where/~[il is the non-local part of the l-matrix. Similarly, for the 2-matrix in the 
right-hand side of Eq. (141), we have: 
D~ti~(f (;,),f (;2); f (;1),f (;2)) 
= ½Po(f(;O)Po(f(;2))(1 + ~Jc.,(f(;0,f(;:))) 
(143) 
where ~.~ztiJxc,~ is the non-local exchange-correlation factor. Substituting the 
expressions for the 1- and 2-matrices into Eq. (139), we obtain after some simple 
algebra [20]: 
E[~] _= cD(~); m~'~[{~}]] 
1 fd3  
8 
p(7) 
1 
3- 
+ fd3-@(;)v(;)+ ~ fd rx 
(d3;2P(;I)P(-~2)(I + ~-%.,(f(;1).f(72))) 
X 3 
I;1 - ;2f 
,f 
(144) 
203 

E.V. Ludefia and R. L6pez-Boada 
Bearing in mind that the transformation vector is an implicit function of the 
density, namely: 
f(~ =f([p]; r-') 
(145) 
whose particular form can be obtained by solving Eq. (91), it is clear that 
Eq. (144) expresses the energy as a functional of the one-particle density p(~) 
within an orbit d~. Notice that in the present case the functional given by 
Eq. (144) is of a "dynamic type" as any change in the density p(~) brings about 
the corresponding change in the form of the functional, through the introduction 
of f([p(~)]; ;) into the non-local parts of the energy expression. It is precisely 
this dynamical character that allows the functional to modify itself, so as to 
maintain the one-to-one correspondence with E[~bt~ 1] that is required by 
Eq. (137) in order to comply with functional N-representability. 
In Fig. 7, we present a general scheme, comprising the intra- and inter-orbit 
optimizations appearing in the variational problem described by Eq. (138). We 
discuss this optimization process with reference to only three of the infinite 
number of orbits into which Hilbert space is decomposed. These orbits are (_9~, 
(9 9 and tP~ rl. 
(9~ is an arbitrary initial orbit, which is selected by choosing an initial 
wavefunction. In order to make these ideas clearer, consider, for example, an 
arbitrary wavefunction ~t0q E(_gtff, that can be a configuration interaction 
wavefunction (or, in general, some trial wavefunction incorporating inter-par- 
ticle coordinates [96, 97]). This wavefunction must allow for a proper repres- 
entation of the important physical aspects of the problem at hand. Thus, if we 
wish to generate an energy density functional that describes exchange and 
correlation fairly well, we must select a configuration interaction wavefunction 
that contains the minimal set of configurations necessary for the description of 
electron correlation. For example, neither of the helium wavefunctions de- 
scribed by Eqs. (80), (81), and (82) would suit this purpose, because an adequate 
description of electron correlation demands that at least we add [p2], and [d 2] 
configurations. However, it is not necessary that the configuration-interaction 
wavefunction selected as an orbit generating wavefunction should contain 
parameters that have been optimized in an actual calculation. We can just 
simply guess these values and proceed to improve the arbitrary initial wavefunc- 
tion by means of local-scaling transformations [49, 50]. 
Orbit d~.~ is reached by optimization of the energy density functional 
through inter-orbit jumping. This process, which is illustrated in Fig. 7 by means 
of a sequence of arrows, is discussed in detail below. The inter-orbit jumping 
process is repeated until one finally reaches orbit (9~ m. This is the orbit where, 
by definition, one finds the exact ground state wavefunction ~ that satisfies 
H~eo = E~o~,. For this reason, we call this the 
the Schr6dinger equation ^ 
Hohenberg-Kohn orbit. Clearly, within ,~emtnKl, the application of local-scaling 
transformations to any initial wavefunction leads to the exact ground-state 
wavefunction as well as to the exact ground-state density. 
204 

Local-Scaling Transformation Version of Density Functional Theory 
.
.
.
.
.
.
 
/ 
"~ 
t 
¢/ ",~ 
t 
/ 
N 
~[p(<,); ~1] 
t 
a[p(<,); $~1] 
t 
~[pC~,,); ~t-~] 
$ 
$ 
$ 
$ 
$ 
$ 
^[SKI 
,,,, ¢,, 
$ 
$ ~ 
_+f 
Fig. 7. Schematic representation of intra-orbit and inter-orbit optimizations 
4.3 Intra-Orbit Optimization of Energy Density Functionais 
The intra-orbit optimization process is shown schematically in each one of the 
columns of Fig. 7, underneath the orbit symbol. Thus, with particular reference 
to the column below ~0tff, let us assume that the orbit-generating function Ct~J is 
chosen. Since this function is explicitly known, we can obtain explicit expres- 
205 

E.V. Ludefia and R. Ldpez-Boada 
sions for the non-local part of the t-matrix .Oxom(-i, F) as well as for the non-local 
part of the 2-matrix, that is, for the exchange-correlation factor .¢'-~,g(7~;~2). 
These quantities enter into the energy functional described by Eq. (144) as 
functions of the transformed vector f(7), namely, as ,D~om(f([p];7),]'([p];F)) 
and J,-t~]c.~(f([e];71); f([p]; 72)). Now, if it were possible to obtain the trans- 
formed vector f([p]; 7) as an explicit function of the one-particle density p(7), 
then we could also rewrite the energy functional of Eq. (144) as an explicit 
functional of p(~). However, since f([p]; 7) is known through the solution of an 
equation, we cannot obtain the f([p]; ?) as an explicit function of the density in 
actual cases. In fact, in most cases, all we can obtain is a numerical solution for 
f([p]; 7). 
Moreover, the construction of functionals for the energy that depend 
explicitly on the one-particle density is, of course, quite feasible, if one uses 
analytic approximations for the transformed vector f([p]; 7). Such an alterna- 
tive is open if, for instance, one resorts to the use of Pad6 approximants. We 
discuss this way of dealing with this problem in Sect. 5. 
As indicated in Fig. 7, the next step after either an explicit or an implicit 
energy density functional 8[p(7); 4~m]o has been constructed is to devise an 
intra-orbit optimization procedure. For this purpose, one introduces the auxili- 
ary functional f2[p(7); 4~m],0 made up of the energy functional d~[p(r-'); <bt0q], plus 
the auxiliary conditions which must be imposed on the variational magnitudes. 
Notice that there are many ways of carrying out this variation, but that - in 
general - one obtains Euler-Lagrange equations by setting 60[p(-~); ~toq] = O. 
In Sections 4.4, and 4.5, we treat the intra-orbit variation with respect to p(7), 
and to the set of N orthonormal orbitals { q~(7)}7= ~, respectively. 
4.4 Euler-Lagrange Equation for Intra-Orbit Optimization of PC) 
Assuming that the variational magnitude in the functional 8[p(7); qN~l] of 
Eq. (144) is the density p(7), we can set up the following auxiliary functional: 
(2[p(7); cl)til] - g[p(7); cI, til] _  t,l ( f d37 pC;) - N) 
(146) 
where ptil is the Lagrange multiplier that accounts for the normalization of the 
density. Setting this variation equal to zero: 
6f2[p(;); ~tl]] = 0 
(147) 
@(7) 
we obtain, the Euler-Lagrange equation for the one-particle density [90, 911: 
1 F vP(7)  2 1 v p(7) + vt l 
7) + 
+ v,,([p(7)]; 7) 
8L~J 
4 p(7) 
+ 
7) = 
(148) 
206 

Local-Scaling Transformation Version of Density Functional Theory 
In Eq. (148), v(7) is the external potential and vu([p(7)];7), the Hartree or 
Coulomb potential. In addition, we observe the presence of v~! 0, arising from the 
non-local part of the kinetic energy (see Eq. (144)): 
,{ 
4J.g(Ep(7)]; 7)) = ~ [ g~m(f(7);f(7')')]~, 
= ~.s,=s 
+ p(7)a--~)([~Dlo['l(.f(7);f(7')')]~,.'~,.,=s} (149) 
and of V~]c,g([p(?)]; 7), the exchange-correlation potential, coming from the 
non-local part of the electron-electron interaction: 
vt~c,.(Ep(~)]; 7) = ~t,~ , 
p(7) agt~Jc'~([P(7)]; 7) 
oxc, o~ [p(7)]; 7) + 
(150) 
ap(7) 
In Eq. (150), the exchange-correlation energy density is defined by (see Eq. (144)): 
1 (da~2 p(72) ~~Jc.,(f(7,); f(72)) 
¢~'[x]c,,([p(71)]; 7,) = 
~ J 
[-~-l ~2 [ 
(151) 
The optimal energy for intra-orbit variation is attained at 8[p~l,(?); ¢~q]. 
Because the functional N-representability condition is fulfilled, this value is an 
upper bound to E~ (i.e., to the optimal energy within the Hohenberg-Kohn orbit 
as #[p~,~J(7); ¢,~x,j] = E:). 
The question arises of why not to carry out this energy minimization for an 
energy functional that has been defined from the outset in the Hohenberg-Kohn 
orbit. The answer is that if we wish to construct the exact energy density 
functional 
¢[p(~);~mq], 
we must depart 
from some orbit-generating 
wavefunction ~mq, which - upon local-scaling transformation of its coordi- 
nates - yields the exact wavefunction a~tnrj 
=pg 
= ~o. The problem is that, finding 
such an orbit-generating wavefunction would be as complicated as finding 7~o ~. 
The Hohenberg-Kohn orbit, nevertheless, is important from a conceptual point 
of view as the Kohn-Sham equations are realized within this orbit. 
4.5 Euler-Lagrange Equations for the lntra-Orbit Optimization 
of N Orthonormal Orbitais: Kohn-Sham-Like Equations 
Let us define the subclass 6e~¢ consisting of all single Slater determinants: 
~so[qt~. 
_ det 
[q 
P 
Ill ..... 7N) = N~ 
[~p' I(FI)"'" ~b[~!N(~/)] 
(152) 
constructed from the transformed orbitals: 
[0 
k&(fff)))] 
(153) 
207 

E.V. Ludefia and R. L6pez-Boada 
where these orbitals are obtained by local-scaling transformations of the 
¢~,t0 ~N 
Following Kohn and Sham [95], we assume that 
generating set ~'ea.kSk=l. 
Eq. (152) describes a non-interacting system. It is clear that SeN is not a subspace 
of Z~N, since a linear combination of Slater determinants does not in general 
yield a single Slater determinant. Applying the same arguments as those of 
Section 4.1, we conclude that SeN can be decomposed into the orbits d~: 
(;~ = {~soti]l~soti~____~p(F); ~sotil~ SeN; p(r-') ~ JffB} 
(154) 
The union of all orbits exhausts the subclass: SeN = t J~ ld)t~. The one-particle 
density associated with the single Slater determinant of Eq. (152) (i.e., the density 
of a non-interacting system) is: 
N 
p(F) = ~ J~t~?k(F)l 2 
(155) 
k=l 
It is of interest to write down the kinetic energy for this wavefunction (i.e., the 
kinetic energy for a non-interacting system): 
VF'Wg,,k~, 11r' =F 
k=l 
1 
d3 [ 
2 
8 j 
1 fd3Fp(F) ~,b~som(f(F),f(F,))l~,= ~ 
(156) 
+5 
where b~ s°t~l is the non-local part of the 1-matrix of the non interacting system. 
Following Kohn and Sham [95], let us consider the energy density func- 
tional for the interacting system given by Eq. (157), but let us assume that the 
one-particle density for the interacting system appearing in ¢ [p;4 ~t°] is given by 
Eq. (155). Under this assumption we can write this functional as 8[{q~?k(F)}; 
~t0]. Introducing the auxiliary functional: 
rf,,,,ll] l~t~. tlbli]q 
3- ,tq- 
tq F 
--k~ 1 t~ Ak,(fd r~p,k(r)c~p,, )--6,,) 
(157) 
where the {~.k/} are the Lagrange multipliers that enforce orbital orthonormality, 
and explicitly decomposing the energy functional into its various contributions, 
we obtain: 
+ ~XC, aLP~ ), 
208 

Local-Scaling Transformation Version of Density Functional Theory 
where 
Eex,[;(7)] = ~ d%,(7)v(7), Eco.,o,~ [p(7)] = (1/2) ~ d3711 d37~p(70p(7~)171 - 7,1-, 
and 
KStq 
1 f d37p(7) 
exc.,[p(r3; ~t,~[{.~}]] = 
1 
3~ 
~;d r I ;8372 P(71)P(72)Jb"[X]C"(?(T')'?(72)) 
+ 
171 
- 
721 
(159) 
the variation of the functional Qr~tq ~D~.~ptq~ with respect to 
L't~Yp,k~ I.{, 
g d 
Explicitly, 
one-particle orbitals is given by 
t,~ 
- 
+ 
(E~,Ep(7)] + eco.,o.~Ep(7)] 
6q~,,k(r) 
+ E~S[~([p(7)];~m)] 
6p(7) 
N 
N 
6 
v~,,,~ , 
k=l,=, 
64~,,k(r) 
x ( f dS7 flp*'~](7)flP[p?t(-f) -- (~kl) = O 
(160) 
and leads to the following system of Kohn-Sham-like single particle equations: 
I- - ½V" + v(7) + v,,([p(7)]; 7) + vK~!~([,O(7)]; 7)-I 4,t,~,,,,,,(7) 
= Z 2k'q~t~°J".'(~) 
(161) 
/=1 
The potentials v(F), and VH([p(F)]; F) of Eq. (161) are precisely those of Eq. (148). 
The exchange correlation potential vKS!~([p (F)]; r-)] is, nonetheless, quite differ- 
ent from the one described by Eq. (150). Note that the Kohn-Sham-like 
exchange-correlation potential contains a kinetic energy contribution arising 
from the difference between the interacting and non-interacting systems. This 
term is positive and thus lowers the negative contribution corresponding to the 
exchange-correlation energy proper. 
Let us finish this Section by discussing the relationship between the 
Kohn-Sham-like equations advanced above and the actual Kohn-Sham equa- 
tions. From the perspective of local-scaling transformations, we can analyze this 
relationship as follows. First of all, we assume that, for an interacting system, we 
are able to select an orbit-generating wavefunction ~tnrl belonging to the 
g 
Hohenberg-Kohn orbit d~KJc.LPN. (Of course, it must be understood that this is 
possible only in a formal sense, since it is clearly as difficult to obtain ~tfK] as to 
solve the exact N-particle problem). Knowledge of this wavefunction allows us 
to calculate the non-local part of the 1-matrix, r)~tnKl(71, 7'1) and the exchange- 
correlation factor ~"xc.g~,l,72), which are needed for the construction of 
209 

E.V. Ludefia and R. L6pez-Boada 
tq F " ~vl 
d'[{q~p,k( )}, g ]. In addition, since the non-local part of the 1-matrix for the 
single Slater determinant (for a non-interacting system) also appears in 
Eqs. (159) and (160), it is necessaxy that we select a generating function _gcbS°trsl in 
a particular orbit (9~sJc6eN. This wavefunction satisfies the condition of minim- 
izing the kinetic energy for the non-interacting system when p(r-')= 
exact 
Po 
, 
namely, for the exact ground-state density. For this reason we denote this orbit 
as the Kohn-Sham orbit and label it with the superscript [KS]. 
The minimum of the Kohn-Sham functional is attained for the transformed 
wavefunctions 4~xr2,,o ~ 6~xlCZ~,v and ~'pg~°~a's°trst e (9~s3cseN, namely, when the 
variational density is equal to that of the exact ground-state: p(7) = p~o~oct(-F). At 
this extremum, one obtains the Kohn-Sham equations, which - in canonical 
form - are given by [95]: 
exact ~ 
. 
KS[HK] 
exact ~ 
.~ 
[HK] 
[ - ½ V 2 + v(F) + vu([po 
(r)],7) + Vxc,g ([Po 
(r)],r)]~pg .... ,k(r) 
KS 
[HK] 
= owk ~po~ .... .k(r). 
(162) 
4.6 Inter-Orbit Optimization 
Having examined the process of intra-orbit optimization in the previous 
Sections, let us turn our attention to "inter-orbit jumping". This process is 
shown in Fig. 7 by means of steps indicated by arrows, each of which involves 
the transformation of a "density-optimal" wavefunction ~op,~tq ._~ ,~z~'vtq into another 
wave function 
tq 
4Popt(Popt ). We denote the latter as the orbit-generating wave- 
function 4~tj I for orbit C~ j. 
The possibility for "inter-orbit jumping" comes about from the fact that the 
e[po ,(r3, 
[{f,}]] is a 
energy functional E[~opt]tq = 
tq 
. tq 
" 
minimum just within (.gtff, 
but is not the global minimum, which occurs at the exact density and at the 
Hohenberg-Kohn orbit (gtff r~. Thus, variation of the energy functional 
[i] ~. q~[oq 
[Popt(r), 
I-{.~}] ] at fixed density pto~;) - where the variational magnitude 
is the wavefunction cbt~l[{f~}] - can lead to a lower energy. This minimum is 
attained at the wavefunction 
til 
Oort(Popt). As this wavefunction yields an energy 
which is lower than the lowest possible one in orbit d)tff, it is clear that the 
improved wavefunction cannot belong to this orbit. Hence, we take it to be the 
~o.,(Po,,) - 
[48, 50]. 
orbit-generating function for orbit (9~ and write 
tq 
4,~J 
Let us note, however, that in spite of the fact that the "orbit jumping" 
optimization is carried out at fixed density, the resulting wavefunction, 
[q 
Oopt(popt) = @~l, is not necessarily associated with the fixed density pto/~t(7). For 
this reason, it is then possible to apply a local-scaling transformation to it and 
produce an optimized wavefunction which, at the same time, is associated with 
t~ith.op t. Moreover, we can 
the fixed density. We denote this wavefunction by 
til 
optimize the density within orbit (gtfl and obtain the new wavefunction ~t. The 
energy functionals associated with these wavefunctions satisfy the following 
inequalities: 
ul 
tq _ E[q~tgq], 
i ~j 
(163) 
210 

Local-Scaling Transformation Version of Density Functional Theory 
4.7 An Application of lntra- and Inter-Orbit Optimization: 
Hartree-Fock Calculations for the Li and Be Atoms 
We describe in this Subsection the application of local-scaling transformations 
to the calculation of the energy for the lithium and beryllium atoms at the 
Hartree-Fock level [113]. (For other reformulations of the Hartree-Fock 
problem see [114] and references therein.) The procedure described here in- 
volves three parts. The first part is orbital transformation already discussed in 
Sect. 2.5. The second is intra-orbit optimization described in Sect. 4.3 and the 
third is inter-orbit optimization discussed in Sect. 4.6. 
In a way, the applications of the local-scaling-transformation version of 
density functional theory, which we have selected to discuss here, are not 
spectacular, in the sense that they refer to very small systems containing three 
and four electrons, respectively. Moreover, they are taken at the Hartree-Fock 
level, which means that electron correlation is not included. These applications 
might consequently, seem to be rather limited in terms of their accomplishments 
compared to those involving the calculation of exchange and correlation ener- 
gies of very large molecular systems. There is, however, a basic difference that we 
would like to stress. Whereas Hohenberg-Kohn-Sham density functional the- 
ory calculations of large (and also small) electronic systems rely on the use of 
approximate energy density functionals (either at the Hartree-Fock or at the 
correlated levels), the Hartree-Fock energy density functionals constructed in 
the calculations that we review here lead, through a process of intra- and 
inter-orbit optimizations, to the Clementi-Roetti [69] SCF values for these 
atoms. In other words, the present examples, although they deal with small 
systems, illustrate the upper-bound character of the local-scaling- transforma- 
tion version of density functional theory, and show how one can construct 
energy functionals that depend implicitly on the one-particle density and lead to 
values comparable to the usual quantum chemistry ones. 
Although, in the present Subsection, we have chosen to discuss this problem 
from the point of view of locally-scaled one-particle orbitals, in Sect. 5 we 
reconsider this same problem with respect to the construction of explicit energy 
density functionals 
Let us consider for the lithium atom the Raffenetti orbitals [71] described in 
Eqs. (68) and (69). However, in order to emphasize the presence of variational 
parameters in these orbitals, we rewrite them as follows: 
M 
R.,([~ti], N~, 
llj 
. 
{C,,j}], r) = ~ C,,~(2~fl~)3/z/(z)l/z exp( - ~flJr) 
(164) 
y=l 
Note that a particular orbit, therefore, is determined by fixing the values of the 
M 
parameters c,, fl and {C,,j}~= ~. Thus, employing these orbitals, we can construct 
a single Slater determinant for the configuration [lsZ2s], that is the generating 
wavefunction of orbit d~tfl: 
p~ I, sl ...,~3, s3) = ~[qlr~ [i] fl[i], 
[i] 
. 
{C,~j}], ;,, s~, 
73, s3) 
(165) 
' 
pg~,L 
, 
--,, 
211 

E.V. Ludefia and R. L6pez-Boada 
where s, is the spin coordinate and Po is the density associated with this 
generating wavefunction. Again, as was discussed in Sect. 2.5, the locally scaled 
orbitals for a transformation connecting pg(r) and p(r) are (cf. Eq. (70)): 
Rrtr,m Bin, ~Cm.~,+ r) = / 
p(r) 
R.A[a[,I ,tim, {Ctilj}];f(r)) 
(166) 
It follows, therefore, that the transformed Slater determinant ~rm also depends 
upon the parameters era,/~q, {Cnsjm} that define the transformed orbitals. 
Moreover, if we select the following representation for the one-particle density: 
0(7) = p([{a/, bi, c~}],~) = 
~ air b' exp( - eir) 
i=o 
(167) 
we can rewrite the energy density functional as: 
g[p(r); ~1] = ~f[{a,, b,, ci}; era, fit,l, {C~iljI ] 
(168) 
The intra-orbit optimization process is carried out by varying the density 
parameters {al, b~, ci} while keeping the wavefunction (or orbital) parameters 
ctm, flt~], ~Cm2 fixed. Alternatively, inter-orbit optimization is accomplished by 
~ 
nsJI 
optimizing the wavefunction parameters for the energy functional 
{C.~}] 
(169) 
¢[pto/lpXr); ~to'l] = 8 [ {a~'", b °p', c°P'}; 0~ Eq, fl[il, 
[il 
This procedure is carried out in subsequent steps until convergence is attained. 
At each step, however, new transformed orbitals are obtained as linear combina- 
tions of the old ones. In order to show that the choice of initial orbitals is not 
critical, the same procedure was carried out for the beryllium atom, using 
single-( orbitals in the configuration [ls22s2]: 
Rtli~(r) -- ((([/])3/7~)1/2 exp( - (f il r) 
(170) 
R~](?) = ((([~1)3/(7z(3), 2 - 32 + 1)))1/2(1 - ([~])], r)exp( - (~1 r) 
with 2 = ((1 + (2)/3(1 • In Fig. 8, some energy values corresponding to intra- and 
inter-orbit optimization for the beryllium atom are presented. The particular 
optimization path shown in Fig. 8 is one of the infinitely many paths available. 
In particular, the one presented in Fig. 8 starts from the single-( wavefunction 
with an energy of - 14.556740 hartrees. Note that the converged energy is 
undistinguishable from the SCF value of Clementi and Roetti [69]. 
In Table VIII, we present the local-scaling- transformation-energy results for 
lithium and beryllium and compare them with results obtained with other 
methods. It is worth mentioning that the Hartree-Fock results for these atoms 
are a first instance of accurate energy values obtained within the context of 
a formalism based on density functional theory. 
212 

Local-Scaling Transformation Version of Density Functional Theory 
°1 
~a [I]= -14.556740 
1 
g~ = -14.570001 
-E~ 2] = -14.572215 
1 
g~ = -14.573011 
E~{ = -14,573021 
trll I 
p~J 
eg" 
Fig. 8. Intra- and inter-orbit energy convergence for an initial single-( wavefunction for the 
beryllium atom (energy in hartrees) 
Table 8. Comparison of approximate Hartree -~ Fock energy 
values for Li and Be atoms (hartrees) 
Li 
Be 
SCF" 
- 7.4327267 
- i4.573021 
Local-Scaling b 
- 7.4327267 
- 14.573021 
H-F limit ~'a'~ 
- 7.4327269 
- 14.573023 
a Clementi - Roetti [69], b Ludefia et al. [113], c Froese-Fischer 
[117], d Bunge et aL 170], "Koga et al. [t18] 
4.8 Energy Density Functionais for Excited States 
In conventional quantum mechanics, a wavefunction describing the ground or 
excited states of a many-particle system must be a simultaneous eigenfunction of 
the set of operators that commute with the Hamiltonian. Thus, for example, for 
an adequate description of an atom, one must introduce the angular momentum 
and spin operators £2, g2, £z, Sz and the parity operator H, in addition to the 
Hamiltonian operator. 
In variational treatments of many-particle systems in the context of conven- 
tional quantum mechanics, these symmetry conditions are explicitly introduced, 
either in a direct constructive fashion or by resorting to projection operators. In 
the usual versions of density functional theory, however, little attention has been 
payed to this problem. In our opinion, the basic question has to do with how to 
incorporate these symmetry conditions - which must be fulfilled by either an 
exact or approximate wavefunction - into the energy density functional. 
The symmetry problem is solved trivially in the local-scaling version of 
density functional theory, because the symmetry conditions can be included in 
213 

E.V. Ludefia and R. Lrpez-Boada 
the choice of orbit-generating or initial wavefunction ~tgil [36]. Since it is from 
this initial wavefunction that we obtain ~tij and ~-~-tilxc,g, namely, the non-local 
quantities appearing in the energy functional of Eq. (50), it follows that the 
symmetry properties of the parent wavefunction are transferred to the varia- 
tional functional. Notice, therefore, that the symmetry of the wavefunction is 
carried into the symmetry of the non-local parts of the 1- and 2-matrices 
~tq and ~tiJxc, g, respectively, and hence into the Fermi and Coulomb holes. 
In the constructive approach to density functional theory reviewed here, the 
extension to excited states is straightforward, provided that the orbit-generating 
wavefunction q~t.~!0({?~, s~}) ~ d~tff satisfies both wavefunction- and Hamiltonian 
orthonormalities: [51"1: 
(~t~)pl~!p) 
= 6.,,,, 
(171) 
and 
< ¢,t.~)p I fi I ~!o) = ~ [P.(~); q,t,?o [ { f(~,), s,} ] 3•.,,. 
(172) 
Eqs. (171) and (172) require that. in addition to etq..p, we generate all other 
{~,..o},.=o, as it is with respect to them that the above 
lower-lying state functions 
tq .- 
conditions are to be fulfilled. We illustrate in what follows a possible - but 
certainly, not the only - course of action open to us. 
Let us assume that the orbit-generating wavefunction for the nth state is 
given in the form of a configuration interaction wavefunction (i.e., a linear 
combination of configuration state functions): 
M 
~?,({~,, s,})= E '-,,o~',,0e" 
,t.csvtq, sF, 
l ,, s,}) ~ (?.~csvt,lt0 
0 
(173) 
I=1 
. 
. 
,~csvt~l - 
m.csv,] 
a.csv[~]~ and ~csvt~]t is its com- 
where C~ = (Cl,g ..... CM.o), ~-~ 
= ~.x,g 
..... VM,o J 
plex conjugate. In this case, wavefunction and Hamittonian orthogonality are 
satisfied if the expansion coefficients are generated by solving the eigenvalue 
problem: 
HC~ t = E.SC~* 
(174) 
where the matrix elements of H and S are 
/,hCSFtill g~l,I, CSVti]\ 
SI d 
/,I,CSFti] ,hCSetil\ 
(175) 
HI3 = \tyl,g 
I Jt~t I~d,g 
/, 
~ 
\~Fl, g 
tIJd,g 
/ 
Considering a particular excited state n, we can obtain a local-scaling 
transformation function f.(~) connecting the initial density p..g(~) with the 
object density p.(F), and generate the transformed wavefunctions: 
M 
m 
CSF[i] 
" 
~7",~CSVtqt 
(176) 
,ht,~ ~, s,})= Z c,.~,.. 
({,',.s,}) 
=- ~. 
,. ,, 
I=1 
for all states m = 0 ..... n. 
However, although the locally scaled transformed wavefunctions preserve 
the orthonormality condition, they fail to comply with Hamiltonian ortho- 
gonality. Of course, one can recombine the transformed wavefunctions so as to 
satisfy the latter requirement, by solving once more the eigenvalue problem 
214 

Local-Scaling Transformation Version of Density Functional Theory 
given by Eq. (174)for the Hamiltonian matrix constructed from the transformed 
wavefunctions [51]: 
Hip., ~.~]~t = E.S[pn, ~..] ~t 
(177) 
Note that in the present case the matrix elements depend on the final density p.. 
Moreover, because this density is obtained from the transformed wavefunction, 
they also depend on the expansion coefficients. For this reason, Eq, (177) must 
be solved iteratively. Such a procedure has been applied - in a sample calcu- 
lation - to the 2 ~S excited state of the helium atom. The upper-bound character 
of the energy corresponding to the energy functional for the transformed 
wavefunction ~t~!p ({~}) with respect to the exact energy E.. ~.~, is guaranteed by 
the Hylleraas-Undheim-MacDonald theorem. 
The procedure described above has been generalized by introducing a con- 
certed local-scaling transformation that carries an initial density pg(F)= 
1 
M-I 
~ 
1 
M-1 
uYj:o pj, g(r) into a final density p(F) = x~Y~:o pj(r). This generalization [52] 
corresponds to Katriers super-particle approach. 
5 Approximate Explicit Energy Functionals Generated 
by Local-Scaling Transformations 
We review in this Section some recent work by Ludefia, L6pez-Boada and Pino 
[113] on the construction of energy functionals that depend explicitly upon the 
one-particle density, but which are generated in the context of the local-scaling- 
transformation version of density functional theory. This work does not con- 
sider the general case involving exchange and correlation, but restricts itself to 
the exchange-only Hartree-Fock approximation. 
5.1 Explicit Hartree-Fock Functionais 
For the Hartree-Fock case, the energy functional E[4~ s°til] for the density- 
transformed single Slater determinant given by Eq. (152), may be rewritten as 
a functional of the one-particle density: 
lf 
lsot,,.., 
f 
g[p; ~SDtil'] = 2 
da-~l~lT~,Dp 
(rx, rl)l~,,=7, + 
d3-~p(F)v(F) 
+~ / 
I / a r2 7:---:q, 
J 
d 
Irl -- r21 
f 
/* 
FIlSD[i]/~ 
~ "~r~lSD[i]t_ ~ 
|~3 ~ ~'p 
~,'1, s2/z'p 
~r2, ~1) 
1 
d3~l /a r 2 
7-.----- 
(178) 
2 
j 
Irl - ~21 
215 

E.V. Ludefia and R. L6pez-Boada 
Note that the non-local part of the kinetic energy as well as the exchange energy 
are implicit functionals of the one particle density. In this Section we discuss 
how one can rewrite and approximate these terms so as to express them as 
explicit functionals of p(r-'). 
5.1.1 Explicit Kinetic Energy Functional 
The kinetic energy can be rewritten as a sum of the Weisz/icker term [10] (a local 
component which depends only on the density) plus a non-local one: 
if 
T[crpSOtil]=.~ dST. [ ~p(~)]: 
p(7) 
1 fdSTp(_i) ~ ~,[)~sot,l(f(7), f(F))l;, = ~ 
(179) 
+5 
The non-local part of the 1-matrix is 
D ~t'J( f (71)' f (7'~) ) 
(180) 
b~[q(f(-~l),f(~'x)) = [po~(-~,))],/2 [p.(f(~,))]u2 
We assume, furthermore, that the generating 1-matrix can be expressed as: 
N 
D~S°t'l(f(7),f(-~')) = Z ~b*j(f(7))q~,j(f(W)) 
(181) 
j=l 
It has been shown elsewhere that when Eqs. (180) and(181) are substituted into 
Eq. (179), use is made of the chain rule V; = V]f ~f(7), and ~j7(7) is refor- 
mulated according to Eq. (36), one is led to: 
1 t" 
r 4 
F N 
r[~So °1'1] = rw[p] + -~ J a~O~(~) y,(~)p2(?(7) ) ~E=, I D¢,.J(/(~))I ~ 
1 (V?pa(f(7))) z-] 
(182) 
- 
l 
Moreover, when the relation 2(7) = f(-~)/r is introduced in Eq. (182) through the 
expression 
~(~) = (p(~) 
1 
~1~ 
\po(f(~)) (1 + 7- ~ln)~(~))) 
(183) 
obtained from Eq. (34), the kinetic-energy functional adopts the more familiar 
form: 
T[~ °'''3 = Tw[p] + ~ Jf dSTpSfS(~) A~( [p(7) ]; -~) 
(184) 
where 
AN([p(?)]; 7) = ((1 + 7. ~ln 2(7)) 4/3 tN(f(7)), 
(185) 
216 

Local-Scaling Transformation Version of Density Functional Theory 
and 
1~=, 
l (VfPg(f(-r)))2-] 
(186) 
tN(f(7))=pSo/a(f(-~)) 
I Vfdp"'~(f(7))[2 
4 
p,(f(7)) 
] 
Note that AN([p(7)]; 7) depends upon the number of particles N and, in this 
sense, is specific to the particular problem at hand, i.e., it is not universal. This, of 
course, is not surprising, as - within the constructive approach to energy density 
functional theory reviewed here (as well as in Cioslowsk'is density-driven 
method)- no such a "universal" functional arises. (The allegation concerning the 
existence of this functional, in the context of the Hohenberg-Kohn formalism, 
seems to us to be based on a misunderstanding.) We should remark, however, 
that if we take the first two terms in the non-local contribution to the kinetic 
energy expression, namely, pSla(7) and (1 + 7. V~ln 2(F)) 4/a, and introduce in the 
latter the first-order approximation to 2(7) that is, 2(F)~(p(F)/pg(f)) 1/3, (see 
discussion below) we get a general and "universal" part of the kinetic energy 
functional, that depends exclusively on the one-particle density p(~): 
pS/a(7)(1 + ~" I~ln(p('r)/pg(f))l/3) 4/3 
(187) 
Thus, in a very natural way, a "universal" factor arises in the kinetic energy 
functional which is modulated by the function tN(f), where the latter contains 
specific information pertaining to the N-electron system at hand. 
For the elucidation of the specific nature of the N-particle modulating factor 
tu(f), we first have to know the explicit form of the vector function 
f(~) =f([p(~); ~). This may be done by means of an iterative approximation, 
based on the following relation: 
p(7) 
].3 
2(i)(~) = 
p,(2"- I)(F)F)(1 + F" ~ln 2 (i- I)(F)F)J 
(188) 
where the initial value for the iteration is 2(°)(7)= 1. Another way to obtain 
analytic approximations tof(~) is to use Pad6 approximants. As has been shown 
elsewhere [113], we have, for the spherically symmetric case: 
2p°(r) AQ(r) 
(189) 
2"" I + 2p~(r)ra + [rdp,(r)/dr + 2p,(r)]dQ(r) 
where 
AQ(r) = 
dr' r'2p(r ') - 
dr' r'2pg(r ') 
(190) 
Other Pad6 approximants are also studied in Ref. [113] and references therein. 
5.1.2 Explicit Exchange-only Functional 
Let us now consider the exchange energy. Starting from the definition: 
1 ~* 
/~ 
/)lSOti](7 7qNlSOtil¢-; 
_ 
d3F 
3 F, ~p 
v,' t~o 
t., F') 
= 
jd 
(191) 
217 

E.V. Ludefia and R. L6pez-Boada 
using Eqs. (140) and (181), and assuming that we have spherical symmetry, we 
can rewrite Eq. (191) as: 
1 N 
- 
E 
where we have defined 
,,j,(?) = 
f drrp(r) (ajk(f)Pks(f) + aks(f)Pjk(f)) (192) 
1 
Po(f) 
(193) 
and 
Pig(f) = 
df'f '2 ask(f') 
(194) 
In order to compare expression (192) with the usual approximations to the 
exchange energy, we rewrite this Equation as: 
1 ~ k~ ~ f 
l(ajk(f)Pkfif)+aks(f)Pjk(f)) 
Ex[~ s°[il] = -- ~ 
dr r2p(r) 
i= 1 = 
r 
Po(f) 
(195) 
Bearing in mind that 1/r = 2(r)/fand, putting 2(r) in the explicit form given by 
Eq. (183), we can rewrite Eq. (195) as follows: 
soti] 
1 f 
Ex[epo ] = - ~ drr2pg/3(r)BN([p(r)];r) 
(196) 
I 
I 
-]~/3 
BN([p(r)]; r) = 
(1 + 7- 17~ln),(F))J 
;(N(f) 
(197) 
where 
and 
xN(f) -- 
,*/3 
fPo (f) S =1k=1 
Again, as in the case of the kinetic energy, here too we can extract an approxim- 
ate expression that is "universal" from the first two factors in the exchange 
energy density; this expression is approximate in the sense that we have replaced 
2(7) by the first-order term of Eq. (188): 
F 
1 
1 ~/3 . 
p4/3(r) 
(199) 
L(1 + 7- ~ln~(?))_] 
we observe that the first factor is precisely Dirac's expression for the exchange 
energy [9]. The role of the function xN(f) is again that of modulating the 
"universal" part of the exchange functional, so as to introduce the particularities 
of a given system. As was done for the kinetic energy functional, it is also 
possible in the case of the exchange functional to obtain an analytic expression 
218 

Local-Scaling Transformation Version of Density Functional Theory 
for the function zs(f) by resorting to the iterative solutions for 2(r) (Eq. (188)), 
or else by employing Pad6 approximants (Eq. 189)). 
5.1.3 Results of Explicit Analytic Energy Density Functionals for the Li and Be 
Atoms 
Let us now incorporate the results of Eqs. (184) and (196) and rewrite the 
implicit energy density functional given by Eq. (179) as: 
1 
1 ~ 3 
5/3 
+ ~ ]d Fp(F) AN([p(F)];F) 
e[a, sore] #[p; a, s°m] = ~ jar 
p-~ 
f 
1 fd3~ 1 ~'d3 ~ p(F,)p(F2) 
+ dd3Fp(F)v(F) ~_ 
j 
2 ~ 
+ 
I j'dr r2 p 4/3( r) BN( [p( r) ]; r) 
(200) 
2 
As discussed above, this still remains as an implicit functional of the one-particle 
density, in view of the fact thatf(r) = f([p]; r). Nevertheless, when we introduce 
the analytic Pad6 approximant forf([p]; r) given by Eq. (189), we can transform 
Eq. (200) into an explicit functional of p. 
The resulting functional has been evaluated for the initial orbitals of the 
lithium and beryllium atoms given in Section 4.6. Using the same process of 
intra- and inter-orbit optimization carried out in Section 4.6, but substituting, 
in each step, the value for f(r) given by the Pad6 approximant obtained from 
Eq. (189), energy values were obtained for the Li and Be atoms that are 
indistingishable from those previously calculated with the exact values off(r), 
namely, when Eq. (40) is solved. 
These preliminary results indicate that the possibility of finding explicit 
functionals of the one-particle density for arbitrary systems is not too far away. 
Clearly, these constructivefunctionals are both symmetry as well as system-size 
dependent. In this sense, our constructive approach leads to energy density 
functionals which are not universal. Nevertheless, Eqs. (184) and (196) show (for 
the Hartree-Fock case) a remarkable structure for the kinetic energy and 
exchange functionals. A considerable part of these functionals is common to all 
systems, regardless of their symmetry or size. This property, can perhaps 
be favorably exploited in the construction of approximate energy density 
functionals. 
6 Calculation of Kohn-Sham Orbitals and Potentials 
by Local-Scaling Transformations 
It has been shown by Levy and Perdew [100] that it is possible to solve the 
Kohn-Sham equations by means of a density-constrained variation of the 
219 

E.V. Ludefia and R. L6pez-Boada 
kinetic energy of a non-interacting system. Since the density constraint is easily 
imposed by means of local-scaling transformations, it turns out that the lo- 
cal-scaling-transformation version of density functional theory may be success- 
fully applied to solve the Kohn-Sham problem. 
The difficulty of this problem can be appreciated by noticing that in order to 
solve the Kohn-Sham equations exactly, one must have the exact exchange- 
correlation potential Vx 
rs which, moreover, must be obtained from the exact 
exchange-correlation functional E~S[p(?)] given by Eq. (160). As this functional 
is not known, the attempts to obtain a direct solution to the Kohn-Sham 
equations have had to rely on the use of approximate exchange-correlation 
functionals. This approximate direct method, however, does not satisfy the 
requirement of functional N-representability. 
As opposed to the direct method, the "inverse method" (corresponding to the 
density constrained variation of the kinetic energy) does not require that we 
EKs 
-~ 
know the exact exchange-correlation functional 
xc[P( )], but just the exact 
ground-state one-particle density p(~). These densities can be obtained, in 
general, from experiment [98], although for the purpose of carrying out very 
precise calculations, it is customary to use densities obtained from highly 
accurate quantum mechanical wavefunctions. 
We have reviewed here the implementation of the inverse method for going 
from densities to potentials, based on local-scaling transformations. For com- 
pleteness, let us mention, however, that several other methods have also been 
advanced to deal with this inverse problem [101-111]. Consider the decomposi- 
tion of 5e.,cCL~'N into orbits {60tfl}. Such orbits are characterized by the fact that 
there is a one to one correspondence between wavefunctions ~0.a'Vl ~ vsem[~l and 
J 
one-particle densities pj e J¢'~ Hence, the minimization of the energy at fixed 
density clearly defines a process of "orbit-jumping", where one searches for the 
optimal wavefunction associated with the fixed density. Observe that if this is 
the exact ground-state density pgX,,, then, the energy minimum is attained at 
~sotrs] 
~sD namely, at the single determinant ~s~ formed by Kohn-Sham 
pg~t 
= 
KS~ 
orbitals. The interesting part of this whole procedure is that, in fact, one does not 
need to minimize the total energy, but just the kinetic energy corresponding to 
a non-interacting system. The reason is that, as has been shown by Lieb [87], the 
minimum of the kinetic energy Ts (see Eq, (157)) of a non-interacting system is 
attained at the solutions of the Kohn-Sham equation (Eq. (161)). In other 
words, it satisfies the following variational principle: 
SD[k] 
^ 
SD[k] 
--- 
min 
{<4~p= .... I Tlq~p: .... ) } 
(201) 
It is now easy to establish the equivalence between the variational principle 
given by Eq. (201) and the Kohn-Sham equations. For this purpose, let us 
220 

Local-Scaling Transformation Version of Density Functional Theory 
introduce the auxiliary functional: 
f2rs,4,til t~t. ~li1"1 
T~[~,~li] t~it. ~till 
--;d4xo)(-r)(kL=l(~*p'ik](-r)~)l~'k('F)--Dexact ) 
4 
*[il" 
[i] 
~_ 
--.~=l t~=l 
8kt(~d X~)p,k(r)t~p,t( ) 
~k,) 
(202) 
where the generalized Lagrange multiplier ~o(7) guarantees that the variational 
density p(7) is equal at all stages of this variation to po ~xac'. Upon variation of this 
auxiliary functional with respect to the orthonormal orbitals ~b*t~,J(r-'), one ob- 
tains a system of equations that, in diagonal form, are the canonical 
Kohn-Sham equations: 
E 
} 172 "~ (D('r)] ~l[pHgKxJc, k(-r) 
[HK] 
-- 
- 
. 
= gk~ko: .... ,k(r) 
(203) 
The presence of the Lagrange multiplier function 09(7) is fundamental in this 
variation, as it this multiplier that assumes the role of the effective Kohn-Sham 
potential: 
(D(-r) =i KStHK][ F ..... t[-~']. 7) = D(7) -1- l)H(Epexact(7) ]; 7) 
Ueff 
~ LYo 
% tlJ, 
, KS[HKI l r ..... it =~ 1. ~ 
(204) 
-~" t'XC, g tLYo 
t" J.l,t ] 
Thus, it is clearly equivalent to solving the Kohn-Sham equations or to dealing 
with the constrained variational principle for Ts. 
The way in which local-scaling transformations have been used for the 
minimization of the kinetic energy functional is as follows [108-111]. An 
arbitrary Slater determinant ~oti] is selected to be the orbit-generating 
wavefunction for OtflCSeN. This wavefunction is constructed from orbitals 
{t~k(['{0~J}];~)} that depend on some variational parameters {~f~)}. For a par- 
ticular choice of these parameters, say {~J}, we have a particular one-particle 
density pg([ {~f~J} ]; 7). For a given fixed final density p~a"(~) we have - accord- 
ing to Eq. (36) - a unique local-scaling transformationf(~) from which we can 
generate the set of locally-scaled transformed orbitals {~t~! .... .k(~)} (see 
Eq. (70)). Every time the orbital parameters are changed, one produces a new 
wavefunction belonging to a different orbit. This follows from the one-to-one 
correspondence between N-representable densities and wavefunctions within 
a oiven orbit. As a result, optimization of these transformed orbitals in the kinetic 
energy expression leads to the minimum value 
tKS] 
T~[ {4b,g .... .k} ] corresponding to 
the parameters {a~kXSl}, since this minimum is attained at the Kohn-Sham orbit 
d~s]. In consequence, one obtains the orbitals {q~sL, k}, which are, in general, 
non-canonical Kohn-Sham orbitals. When we put these orbitals in canonical 
form, can be obtained from them the effective potential vr~]}nxl([p~x"(~)];r -') 
quite directly, by inversion of the canonical Kohn-Sham equations. 
221 

E.V, Ludefia and R. L6pez-Boada 
Acknowledgment. E.V.L. would like to express his gratitude to the Consejo 
Nacional de Investigaciones Cientificas y Tecnol6gicas, CONICIT, of 
Venezuela, for its support of the present work through Project S1-2500. He also 
gratefully acknowledges support of this work by the Commission of European 
Communities through Contract No. CI1"-CT93-0333. His personal thanks go 
to Prof. Roman Nalewajski for having organized a fine and stimulating meeting 
on density functional theory in Cracow in 1994: the presentations in that 
meeting motivated the construction of the explicit functionals advanced here. 
We hope that they will contribute toward a unification of seemingly disparate 
approaches to density functional theory, The authors would like to thank Jorge 
Maldonado, Elmer Valderrama and Jestis Rodriguez for their help in the 
preparations of Tables and Figures. 
References 
1. Kryachko ES, Ludefia EV (1990) Energy density functional theory of many-electron systems. 
Kluwer Academic Publishers, Dordreeht. 
2. Parr RG, Yang W (1989) Density functional theory of atoms and molecules. Oxford University 
Press, Oxford. 
3. Dreizler RM, Gross EKU (1990) Density functional theory. Springer-Verlag, Berlin. 
4. March NH (1992) Electron density theory of atoms and molecules. Academic Press, 
New York. 
5. Thomas LH (1927) Proc Cambridge Phil Soc 23:542 
6. Fermi E (1927) Rend Accad Naz Lincei 6:602 
7, March NH (~957) Adv in Phys 6:1 
8. Lieb EH (1981) Rev Mod Phys 53:603 
9. Dirac PAM (1930) Proc Cambridge Phil Soc 26:376 
10. Weizs/icker von CF (1935) Z Phys 96:431 
11. Kirzhnitz DA (1957) Zh Eksp Teor Fiz 32:115 
12. Hodges CH (1973) Can J Phys 51:t428 
13. Grammaticos B, Voros A (1979) Ann Phys 129:153 
14. Murphy DR (1981) Phys Rev A24:1682 
15. Yang W (1986) Phys Rev A34:4575 
16. Borman S (1990) Chem Eng News 68:22 
17. Hohenberg PC, Kohn W (1964) Phys Rev 136B: 864 
18. Hohenberg PC, Kohn W, Sham LJ (1990) Adv Quantum Chem 21:7 
19. L6wdin PC) (1987) In: Erdahl R, Smith VH (eds) Density matrices and density functionals, 
Reidel D, Dordrecht, p 21 
20. Kryachko ES, Ludefia EV (1991) Phys Rev A43:2179 
21. Kryachko ES, Ludefia EV (1992) In: Proto AN, Aliaga JL (eds) Condensed matter theories, 
Vol 7. Plenum, New York, p 101 
22. Coleman AJ (1963) Revs Mod Phys 35:668 
23. Coleman AJ (1987) In: Erdahl R, Smith VH (eds) Density matrices and density functionals. 
Reidel R, Dordrecht, p 5 
24. See also, Reference [1], Section 4.4. 
25. See also, Reference [1], Chapters 7 and 8. 
26. Gilbert TL (1975) Phys Rev B12:2111 
27. Harriman JE (1981) Phys Rev A24:680 
28. Petkov IZh, Stoitsov MV, Kryachko ES (1986) Int J Quantum Chem 29:149 
29. Kryachko ES, Petkov IZh, Stoitsov MV (1987) Int J Quantum Chem 32:467 
30. Kryachko ES, Petkov 1Zh, Stoitsov MV (1987) Int J Quantum Chem 32:473 
31. Kryachko ES, Ludefia EV (1987) Phys Rev A35:957 
222 

Local-Scaling Transformation Version of Density Functional Theory 
32. Kryachko ES, Petkov IZh, Stoitsov MV (1988) Int J Quantum Chem 34: 305E 
33. Kryachko ES, Ludefia EV (1991) Phys Rev A43:2194 
34. Petkov IZh, Stoitsov MV (1991) Nuclear density functional theory. Oxford University Press, 
New York 
35. Kryachko ES, Ludefia EV (1992) In: Fraga S (ed) Computational chemistry: Structure, 
interactions and reactivity Elsevier, Amsterdam, 1992, p 136. 
36. Ludefia EV, Kryachko ES (1992) Rev Mex Astr y Astrofis 23:95 
37. Kryachko ES, Ludefia EV (1992) New J Chem 16:1089 
38. Kryachko ES, Ludefia EV (1991) J Chem Phys 95:9054 
39. Kryachko ES, Koga T (1989) J Chem Phys 91:1108 
40. Koga T, Yamamoto Y, Kryachko ES (1989) J Chem Phys 91:4785 
41. Koga T (1990) Phys Rev A41:t274 
42. Koga T (1990) Phys Rev A42:3763 
43. Koga T (1990) J Chem Phys 93:5856 
44. Koga T, Yamamoto Y (1990) Phys Rev A42:6336 
45. Koga T, Kryachko ES (1991) J Chem Phys 94:2910 
46. Kryachko ES, Koga T (1992) Int J Quantum Chem 42:591 
47. Koga T, Matsuyama H (1992) Phys Rev A45:5266 
48. Kryachko ES, Ludefia EV, Koga T (1993) In: Clementi E (ed) Methods and techniques in 
computational chemistry, Vol B: Medium size systems. METECC-94, STEF, Cagliari, p 23 
49. Koga T, Yamamoto Y, Ludefia EV (1991) J Chem Phys 94:3805 
50. Koga T, Yamamoto Y, Ludefia EV (1991) Phys Rev A43:5814 
51. Koga T (1991) J Chem Phys 95:4306 
52. Kryachko ES, Ludefia EV, Koga T (1992)J Math Chem 11:325 
53. Macke W (1955) Phys Rev 100:992 
54. Macke W (1955) Ann Phys (Leipzig) 17:1 
55. March NH, Young WH (1958) Proc Roy Soc London 72:182 
56. Hall GG (1960) Proc Roy Soc London 75:575 
57. Ten Hoor MJ (1988) lnt J Quantum Chem 33: 563; (1989) J Chem Ed 66:633 
58. Moser J (1965) Trans Amer Math Soc 120:286 
59. Percus JK (1978) Int J Quantum Chem 13:89 
60. Ludefia EV (1983) J Chem Phys 79:6174 
61. Zumbach G, Maschke K (1983) Phys Rev A28: 544; (1984) Ibid A29: 1585E 
62. Nyden MR, Parr RG (1983) J Chem Phys 78:4044 
63. Ghosh SK, Parr RG (1985) J Chem Phys 82:3307 
64. Ludefia EV (1986) In: Malik FB (ed) Condensed matter theories, Vol 1. Plenum, New York, 
p 183 
65. Bokanowski O, GrEbert B (1996) Math Models and Meth Appl Sci 6 
66. Bokanowski O, Gr6bert B (1995) Int Rep MIP No 95-18 UFR-MIG, Univ P Sabatier, 
Toulouse, France 
67. Davidson ER (1976) Reduced density matrices in quantum chemistry. Academic Press, New 
York, p 135 
68. Benesch R (1971) J Phys B, Atom Mol Phys 4:1403 
69. Clementi E, Roetti C (1974) At Data and Nucl Data Tables 14:177 
70. Bunge CF, Barrientos JA, Bunge AV (1993) At Data and Nucl Data Tables 53:113 
71. Raffenetti CR (1973) J Chem Phys 59:5936 
72. Boyd RJ (1977) Can J Phys 55:452 
73. Esquivel RO, Bunge AV (1987) Int J Quantum Chem 32:295 
74. Cioslowski J (t988) Phys Rev Lett 60:2141 
75. Cioslowski J (1988) J Chem Phys 89:4871 
76. Cioslowski J (1989) Int J Quantum Chem $23 
77. Cioslowski J (1990) Adv Quantum Chem 21:303 
78. Payne PW (t979) J Chem Phys 71:490 
79. Hunter G (1975) Int J Quantum Chem 9:237 
80. Hunter G (1981) Int J Quantum Chem 19:755 
8t. Hunter G (t986) lnt J Quantum Chem 29:197 
82. March NH (1985) Phys Lett l13A: 66 
83. Dawson KA, March NH (1984) J Chem Phys 81:5850 
84. Levy M (1979) Proc Natt Acad Sci USA 76:6062 
223 

E.V. Ludefia and R. L6pez-Boada 
85. Lieb EH (1982) In: Feshbach H, Shimony A (eds) Physics as natural philosophy: Essays in 
honor of Laszlo Tisza on his 75th Birthday, M1T Press, Cambridge, MA, p 111 
86. Lieb EH (1983) int J Quantum Chem 24:243 
87. Lieb EH (1985) In: Dreizler RM, da Providencia J (eds) Density functional methods in physics, 
Plenum, New York, p 31 
88. Bader RFW, Nguyen-Dang TT, Tal Y (1981) Rep Progr Phys 44:893 
89. Bader RFW, Tal Y, Anderson SE, Nguyen-Dang TT (1980) lsr J Chem 19:8 
90. Hunter G (1985) In: Erdahl R, Smith VH (eds) Density matrices and density functionals. Reidel, 
Dordrecht, p 583 
91. Reference 4, Section 8.11. 
92. Levy M, Perdew JP, Sahni V (1984) Phys Rev A30:2745 
93. Lassettre EN (1985) J Chem Phys 83:1709 
94. Kryachko ES, Ludefia EV (1992) lnt J Quantum Chem 43:769 
95. Kohn W, Sham LJ (1965) Phys Rev 140A: 1133 
96. Caffarel M (1989) In: Defranceschi M, Delhalle J (eds) Numerical determination of the 
electronic structure of atoms, diatomic and polyatomic molecules. Kluwer Academic Pub- 
lishers, Dordrecht, p 85 
97. Morgan III JD (1989) In: Defranceschi M, Delhalle J (eds) Numerical determination of the 
electronic structure of atoms, diatomic and polyatomic molecules. Ktuwer Academic Pub- 
lishers, Dordreeht, p 49 
98. For a recent review, see the Naturforsch Z (1993) Proceedings of the Sagamore X Conference 
on Charge, Spin and Momentum Densities, 48a (1/2) 
99. Kryachko ES, Ludefia EV, L6pez-Boada R, Maldonado J (1993) In: Blum L, Malik FB (eds) 
Condensed Matter Theories, Vol 8. Plenum, New York, p 373 
100. Levy M, Perdew JP (1985) In: Dreizler RM, da Providencia J (eds) Density functional methods 
in Physics. Plenum, New York, p 11 
101. Talman JD, Shadwick WF (1976) Phys Rev A14:36 
102. Werden SH, Davidson ER (1984) In: Dahl JP, Avery J (eds) Local density approximations in 
quantum chemistry and solid state physics. Plenum, New York, p 33 
103. Almbladh CO, Pedroza AC (1984) Phys Rev A29:804 
104. Aryasetiawan F, Stott MJ (1988) Phys Rev B38:2974 
105. Zhao Q, Parr RG (1992) Phys Rev A46:2337 
106. Zhao Q, Parr RG (1993) J Chem Phys 98:543 
107. Wang Y, Parr RG (1993) Phys Rev A47:R1591 
108. Ludefia EV, L6pez-Boada R, Maldonado J, Koga T, Kryachko ES (1993) Phys Rev A48:1937 
109. Ludefia EV, L6pez-Boada R, Matdonado J (1994) In: Clark JW, Sadiq A, Shoaib KA (eds) 
Condensed matter theories, Vol. 9. Nova Science Publishers, Commack, NY, p 97 
1 I0. Ludefia EV, L6pez-Boada R, Maldonado J (1995~ J Mol Struct (Theochem) 330:33 
11 t. Ludefia EV, Matdonado J, L6pez-Boada R, Koga T, Kryachko ES (1995)J Chem Phys 102: 
318 
112. Ludefia EV, Kryachko ES, Koga T, L6pez-Boada R, Hinze J, Maldonado J, Valderrama 
E (1995) In: Seminario JM, Politzer P (eds) Theoretical and computational chemistry: density 
functional calculations. Elsevier, Amsterdam, p 75 
113. Ludefia EV, L6pez-Boada R, Pino R (1996) In: Ludefia EV, Vashishta P, Bishop RF (eds) 
Condensed matter theories, Vol 11. Nova Science Publishers, Commack, NY, p 51 
114. Holas A, March NH, Takahashi Y, Zhang C (1993) Phys Rev A48:2708 
115. Ludefia EV, L6pez-Boada R, Maldonado J, Valderrama E, Koga T, Kryachko ES, 
Hinze J (1995) Int J Quantum Chem 56:285 
116. Pino R, Ludefia EV, L6pez-Boada R (t995) In: Navarro J, de Llano M (eds) Condensed matter 
theories, Vol 10. Nova Science Publishers, Commack, NY, p 189 
117. Froese-Fischer C (1977) The Hartree Fock method for atoms. J Wiley, New York 
118. Koga T, Tatewaki H, Thakkar AJ (1993) Phys Rev A47:4510 
119. This transformation was found by O. Bokanowski and E.V. Ludefia. The important fact is that 
the nuclei remain invariant. 
224 

Author Index Volumes 151-180 
Author Index Vols. 26-50 see VoL 50 
Author Index Vols. 51-100 see Vol. 100 
Author Index Vols. 101-150 see Vol. 150 
The volume numbers are prinled in italics 
Adam, W. and Hadjiarapoglou, L.: Dioxiranes: Oxidation Chemistry Made Easy. 164, 45-62 
(1993). 
Alberto, R.: High- and Low-Valency Organometallic Compounds of Technetium and 
Rhenium. 176, 149-188 (1996). 
Albini, A., Fasani, E. and Mella M.: PET-Reactions of Aromatic Compounds. 168, 143-173 
(1993). 
Allan, N.L. and Cooper, D.: Momentum-Space Electron Densities and Quantum Molecular 
Similarity. 173, 85-111 (1995). 
Allamandola, L.J.: Benzenoid Hydrocarbons in Space: The Evidence and Implications. 153, 
1-26 (1990). 
Anwander, R.: Lanthanide Amides. 179, 33-I 12 (1996). 
Anwander, R.: Routes to Monomeric Lanthanide Alkoxides. 179, 149-246 (1996). 
Anwander, R., Herrmann, W.A.: Features of Organolanthanide Complexes. 179, 1-32 (1996). 
Artymiuk, P. J., Poirette, A. R., Rice, D. W., and Willett, P.: The Use of Graph Theoretical 
Methods for the Comparison of the Structures of Biological Macromolecules. 174, 73- 
104 (1995). 
Astruc, D.: The Use ofp-Organoiron Sandwiches in Aromatic Chemistry. 160, 47-96 (1991). 
Baerends, E.J., see van Leeuwen, R.: 180, 107-168 (1996). 
Baldas, J.: The Chemistry of Technetium Nitrido Complexes. 176, 37-76 (1996). 
Balzani, V., Barigelletti, F., De Cola, L.: Metal Complexes as Light Absorption and Light 
Emission Sensitizers. 158, 31-71 (1990). 
Baker, B.J. and Kerr, R.G.: Biosynthesis of Marine Sterols. 167, 1-32 (1993). 
Barigelletti, F., see Balzani, V.: 158, 31-71 (1990). 
Bassi, R., see Jennings, R. C.: 177, 147-182 (1996). 
Baumgarten, M., and Mt~llen, K.: Radical Ions: Where Organic Chemistry Meets Materials 
Sciences. 169, 1-104 (1994). 
Bersier, J., see Bersier, P.M.: 170, 113-228 (1994). 
Bersier, P. M., Carlsson, L., and Bersier, J.: Electrochemistry for a Better Environment. 170, 
113-228 (1994). 
Besalfi, E., Carb6, R., Mestres, J. and Sol~, M.: Foundations and Recent Developments on 
Molecular Quantum Similarity. 173, 31-62 (1995). 
Bignozzi, C.A., see Scandola, F.: 158, 73-149 (1990). 
Billing, R., Rehorek, D., Hennig, H.: Photoinduced Electron Transfer in Ion Pairs. 158, 151- 
I99 (1990). 
225 

Author Index Volumes 151-180 
Bissell, R.A., de Silva, A.P., Gunaratne, H.Q.N., Lynch, P.L.M., Maguire, G.E.M., McCoy, 
C.P. and Sandanayake, K.R.A.S.: Fluorescent PET (Photoinduced Electron Transfer) 
Sensors. 168, 223-264 (1993). 
Blasse, B.: Vibrational Structure in the Luminescence Spectra of Ions in Solids. 171, 1-26 
(1994). 
Bley, K., Gruber, B., Knauer, M., Stein, N. and Ugi, I.: New Elements in the Representation 
of the Logical Structure of Chemistry by Qualitative Mathematical Models and Corre- 
sponding Data Structures. 166, 199-233 (1993). 
Brandi, A. see Goti, A.: 178, 1-99 (t996). 
Brunvoll, J., see Chen, R.S.: 153, 227-254 (1990). 
Brunvoll, J., Cyvin, B.N., and Cyvin, S.J.: Benzenoid Chemical Isomers and Their Enumera- 
tion. 162, 181-221 (1992). 
Brunvoll, J., see Cyvin, B.N.: 162, 65-180 (1992). 
Brunvoll, J., see Cyvin, S.J.: 166, 65-119 (1993). 
Bundle, D.R.: Synthesis of Oligosaccharides Related to Bacterial O-Antigens. 154, 1-37 
(1990). 
Burke, K., see Ernzerhof, M.: 180, 1-30 (1996). 
Burrell A.K., see Sessler, J.L.: 16I, 177-274 (1991). 
Caffrey, M.: Structural, Mesomorphic and Time-Resolved Studies of Biological Liquid Crys- 
tals and Lipid Membranes Using Synchrotron X-Radiation. 151, 75-109 (1989). 
Canceill, J., see Collet, A.: 165, 103-129 (1993). 
Carb6, R., see Besalfi, E.: 173, 31-62 (1995). 
Carlson, R., and Nordhal, A.: Exploring Organic Synthetic Experimental Procedures. 166, 
1-64 (1993). 
Carlsson, L., see Bersier, P.M.: 170, 113 -228 (1994). 
Ceulemans, A.: The Doublet States in Chromium (III) Complexes. A Shell-Theoretic View. 
171, 27-68 (1994). 
Clark, T.: Ab Initio Calculations on Electron-Transfer Catalysis by Metal Ions. 177, 1-24 
(1996). 
Cimino, G. and Sodano, G.: Biosynthesis of Secondary Metabolites in Marine Molluscs. 
167, 77-116 (1993). 
Chambron, J.-C., Dietrich-Buchecker, Ch., and Sauvage, J.-P.: From Classical Chirality to 
Topologically Chiral Catenands and Knots. 165, 131-162 (1993). 
Chang, C.WJ., and Scheuer, P.J.: Marine Isocyano Compounds. 167, 33-76 (1993). 
Chen, R.S., Cyvin, S.J., Cyvin, B.N., Brunvoll, J., and Klein, D.J.: Methods of Enumerating 
Kekul6 Structures. Exemplified by Applified by Applications of Rectangle-Shaped 
Benzenoids. 153, 227-254 (1990). 
Chen, R.S., see Zhang, F.J.: 153, 181-194 (1990). 
Chiorboli, C., see Scandola, F.: 158, 73-149 (1990). 
Ciolowski, J.: Scaling Properties of Topological Invariants. 153, 85-100 (1990). 
Collet, A., Dutasta, J.-P., Lozach, B., and Canceill, J.: Cyclotriveratrylenes and Cryptophanes: 
Their Synthesis and Applications to Host-Guest Chemistry and to the Design of New 
Materials. i65, 103-129 (1993). 
Colombo, M. G., Hauser, A., and Gtidel, H. U.: Competition Between Ligand Centered and 
Charge Transfer Lowest Excited States in bis Cyclometalated Rh 3+ and Ir 3+ Complexes. 
171, 143-172 (1994). 
Cooper, D.L., Gerratt, J., and Raimondi, M.: The Spin-Coupled Valence Bond Description 
of B enzenoid Aromatic Molecules. 153, 41-56 (1990). 
226 

Author Index Volumes 151-180 
Cooper, D.L., see Allan, N.L.: 173, 85-111 (1995). 
Cordero, F. M. see Goti, A.: 178, 1-99 (1996). 
Cyvin, B.N., see Chen, R.S.: 153, 227-254 (1990). 
Cyvin, S.J., see Chen, R.S.: 153, 227-254 (1990). 
Cyvin, B.N., Brunvoll, J. and Cyvin, S.J.: Enumeration of Benzenoid Systems and Other 
Polyhexes. 162, 65-180 (1992). 
Cyvin, S.J., see Cyvin, B.N.: 162, 65-180 (1992). 
Cyvin, B.N., see Cyvin, S.J.: 166, 65-119 (1993). 
Cyvin, S.J., Cyvin, B.N., and Brunvoll, J.: Enumeration of Benzenoid Chemical Isomers 
with a Study of Constant-Isomer Series. 166, 65-119 (1993). 
Dartyge, E., see Fontaine, A.: 151, 179-203 (1989). 
De Cola, L., see Balzani, V.: 158, 31-71 (1990). 
Dear, K.: Cleaning-up Oxidations with Hydrogen Peroxide. 164, (1993). 
de Mendoza, J., see Seel, C.: 175, 101-132 (1995). 
de Silva, A.P., see Bissell, R.A.: 168, 223-264 (1993). 
Descotes, G.: Synthetic Saccharide Photochemistry. 154, 39-76 (1990). 
Dias, J.R.: A Periodic Table for Benzenoid Hydrocarbons. 153, 123-144 (1990). 
Dietrich-Buchecker, Ch., see Chambron, J.-C.: 165, 131-162 (1993). 
Dohm, J., V6gtle, F.: Synthesis of(Strained) Macrocycles by Sulfone Pyrolysis. 161, 69-106 
(1991). 
Dutasta, J.-P., see Collet, A.: 165, 103-129 (1993). 
Eaton, D.F.: Electron Transfer Processes in Imaging. 156, 199-226 (1990). 
Edelmann, F.T.: Rare Earth Complexes with Heteroallylic Ligands. 179, 113-148 (1996). 
Edelmann, F.T.: Lanthanide Metallocenes in Homogeneous Catalysis. 179, 247-276 (1996). 
El-Basil, S.: Caterpillar (Gutman) Trees in Chemical Graph Theory. 153, 273-290 (1990). 
Ernzerhof, M., Perdew, J. P., Burke, K.: Density Functionals: Where Do They Come From, 
Why Do They Work? 190, 1-30 (1996). 
Fasani, A., see Albini, A.: 168, 143-173 (1993). 
Fontaine, A., Dartyge, E., Itie, J.P., Juchs, A., Polian, A., Tolentino, H., and Tourillon, G.: 
Time-Resolved X-Ray Absorption Spectroscopy Using an Energy Dispensive Optics: 
Strengths and Limitations. 151, 179-203 (1989). 
Foote, C. S.: Photophysical and Photochemical Properties of Fullerenes. 169, 347-364 (1994). 
Fossey, J., Sorba, J., and Lefort, D.: Peracide and Free Radicals: A Theoretical and Experi- 
mental Approach. 164, 99-113 (1993). 
Fox, M.A.: Photoinduced Electron Transfer in Arranged Media. 159, 67-102 (1991). 
Freeman, P.K., and Hatlevig, S.A.: The Photochemistry of Polyhalocompounds, 
Dehalogenation by Photoinduced Electron Transfer, New Methods of Toxic Waste Dis- 
posal. 168, 47-91 (1993). 
Fuchigami, T.: Electrochemical Reactions of Fluoro Organic Compounds. 170, 1-38 (i 994). 
Fuller, W., see Grenall, R.: 151, 31-59 (1989). 
Galen, A., see Seel, C.: 175, 101-132 (1995). 
Gehrke, R.: Research on Synthetic Polymers by Means of Experimental Techniques Em- 
ploying Synchrotron Radiation. 151, 111-159 (1989). 
Geldart, D. J. W.: Nonlocal Energy Functionals: Gradient Expansions and Beyond. 190, 
31-56 (1996). 
227 

Author Index Volumes 151-180 
Gerratt, J., see Cooper, D.L.: 153, 41-56 (1990). 
Gerwick, W.H., Nagle, D.G., and Protean, P.J.: Oxylipins from Marine Invertebrates. 167, 
117-180 (1993). 
Gigg, J., and Gigg, R.: Synthesis of Glycolipids. 154, 77-139 (1990). 
Gislason, E.A., see Guyon, P.-M.: 151, 161-178 (1989). 
Goti, A., Cordero, F. M., and Brandi, A.: Cycloadditions Onto Methylene- and Alkylidene- 
cyclopropane Derivatives. 178, 1-99 (1996). 
Greenall, R., Fuller, W.: High Angle Fibre Diffraction Studies on Conformational Transi- 
tions DNA Using Synchrotron Radiation. 151, 31-59 (1989). 
Gritsenko, O. V., see van Leeuwen, R.: 180, 107-168 (1996). 
Gruber, B., see Bley, K.: 166, 199-233 (1993). 
Gtidel, H. U., see Colombo, M. G.: 171, 143-172 (1994). 
Gunaratne, H.Q.N., see BisseU, R.A.: 168, 223-264 (1993). 
Guo, X.F., see Zhang, F.J.: 153, 181-194 (1990). 
Gust, D., and Moore, T.A.: Photosynthetic Model Systems. 159, 103-152 (1991). 
Gutman, I.: Topological Properties of Benzenoid Systems. 162, 1-28 (1992). 
Gutman, I.: Total n-Electron Energy of Benzenoid Hydrocarbons. 162, 29-64 (1992). 
Guyon, P. M., Gislason, E.A.: Use of Synchrotron Radiation to Study-Selected Ion-Molecule 
Reactions. 151, 161-178 (1989). 
Hashimoto, K., and Yoshihara, K.: Rhenium Complexes Labeled with 186/188Re for Nuclear 
Medicine. 176, 275-292 (1996). 
Hadjiarapoglou, L., see Adam, W.: 164, 45-62 (1993). 
Hart, H., see Vinod, T. K.: 172, 119-178 (1994). 
Harbottle, G.: Neutron Acitvation Analysis in Archaecological Chemistry. 157, 57-92 (1990). 
Hatlevig, S.A., see Freeman, P.K.: 168, 47-91 (1993). 
I-Iauser, A., see Colombo, M. G.: 171, 143-172 (1994). 
Hayashida, O., see Murakami, Y.: 175, 133-156 (1995). 
He, W.C., and He, W.J.: Peak-Valley Path Method on Benzenoid and Coronoid Systems. 
153, 195-210 (1990). 
He, W.J., see He, W.C.: 153, 195-210 (1990). 
Heaney, H.: Novel Organic Peroxygen Reagents for Use .in Organic Synthesis. 164, 1-19 
(1993). 
Heidbreder, A., see Hintz, S.: 177, 77-124 (1996). 
Heinze, J.: Electronically Conducting Polymers. 152, 1-19 (1989). 
Helliwell, J., see Moffat, J.K.: 151, 61-74 (1989). 
Hennig, H., see Billing, R.: 158, 151-199 (1990). 
Herrmann, W.A., see Anwander, R.: 179, 1-32 (1996). 
Hesse, M., see Meng, Q.: 161, 107-176 (1991). 
Hiberty, P.C.: The Distortive Tendencies of Delocalized 7t Electronic Systems. Benzene, 
Cyclobutadiene and Related Heteroannulenes. 153, 27-40 (1990). 
Hintz, S., Heidbreder, A., and Mattay, J.: Radical Ion Cyclizations. 177, 77-124 (1996). 
Hirao, T.: Selective Transformations of Small Ring Compounds in Redox Reactions. 178, 
99-148 (1996). 
Hladka, E., Koca, J., Kratochvil, M., Kvasnicka, V., Matyska, L., Pospichal, J., and Potucek, 
V.: The Synthon Model and the Program PEGAS for Computer Assisted Organic Synthe- 
sis. 166, 121-197 (1993). 
Ho, T.L.: Trough-Bond Modulation of Reaction Centers by Remote Substituents. 155, 81- 
158 (1990). 
228 

Author Index Volumes 151-180 
Holas, A., March, N. H.: Exchange and Correlation in Density Functional Theory of Atoms 
and Molecules. 180, 57-106 (1996). 
H6ft, E.: Enantioselective Epoxidation with Peroxidic Oxygen. 164, 63 -77 (1993 ). 
Hoggard, P. E.: Sharp-Line Electronic Spectra and Metal-Ligand Geometry. 171, 113-142 
(1994). 
Holmes, K.C.: Synchrotron Radiation as a source for X-Ray Diffraction-The Beginning. 151, 
1-7 (1989). 
Hopf, H., see Kostikov, R.R.: 155, 41-80 (1990). 
Indelli, M.T., see Scandola, F.: 158, 73-149 (1990). 
Inokuma, S., Sakai, S., and Nishimura, J.: Synthesis and Inophoric Properties of 
Crownophanes. 172, 87-118 (1994). 
Itie, J.P., see Fontaine, A.: 151, 179-203 (1989). 
Ito, Y.: Chemical Reactions Induced and Probed by Positive Muons. 157, 93-128 (1990). 
Jennings, R. C., Zucchelli, G., and Bassi, R.: Antenna Structure and Energy Transfer~in 
Higher Plant Photosystems. 177, 147-182 (1996). 
Johannsen, B., and Spiess, H.: Technetium(V) Chemistry as Relevant to Nuclear Medicine. 
176, 77-122 (1996). 
John, P., and Sachs, H.: Calculating the Numbers of Perfect Matchings and of Spanning 
Tress, Pauling's Bond Orders, the Characteristic Polynomial, and the Eigenvectors of a 
Benzenoid System. 153, 145-180 (1990). 
Jucha, A., see Fontaine, A.: 151, 179-203 (1989). 
Jurisson, S., see Volkert, W. A.: 176, 77-122 (1996). 
Kaim, W.: Thermal and Light Induced Electron Transfer Reactions of Main Group Metal 
Hydrides and Organometallics. 169, 231-252 (1994). 
Kavarnos, G.J.: Fundamental Concepts of Photoinduced Electron Transfer. 156, 21-58 (1990). 
Kelly, J. M., see Kirsch-De-Mesmaeker, A.: 177, 25-76 (1996). 
Kerr, R.G., see Baker, B.J.: 167, 1-32 (1993). 
Khairutdinov, R.F., see Zarnaraev, K.I.: 163, 1-94 (1992). 
Kim, J.l., Stumpe. 
and Klenze, R.: Laser-induced Photoacoustic Spectroscopy for the 
Speciation of', ransuranic Elements in Natural Aquatic Systems. 157, 129-180 (1990). 
Kikuchi, J., see Murakami, Y.: 175, 133-156 (1995). 
Kirsch-De-Mesmaeker, A., Lecomte, J.-P., and Kelly, J. M.: Photoreactions of Metal Com- 
plexes with DNA, Especially Those Involving a Primary Photo-Electron Transfer. 177, 
25-76 (1996). 
Klaffke, W., see Thiem, J.: 154, 285-332 (1990). 
Klein, D.J.: Semiempirical Valence Bond Views for Benzenoid Hydrocarbons. 153, 57-84 
(1990). 
Klein, D.J., see Chen, R.S.: 153, 227-254 (1990). 
Klenze, R., see Kim, J.I.: 157, 129-180 (1990). 
Knauer, M., see Bley, K.: 166, 199-233 (1993). 
Knops, P., Sendhoff, N., Mekelburger, H.-B., VSgtle, F.: High Dilution Reactions - New 
Synthetic Applications. 161, 1-36 (1991). 
Koca, J., see Hladka, E.: 166, 121-197 (1993). 
Koepp, E., see Ostrowicky, A.: 161, 37-68 (1991). 
Kohnke, F.H., Mathias, J.P., and Stoddart, J.F.: Substrate-Directed Synthesis: The Rapid 
229 

Author Index Volumes 151-180 
Assembly of Novel Macropolycyclic Structures via Stereoregular Diels-Alder Oli- 
gomerizations. 165, 1-69 (1993). 
Kostikov, R.R., Molchanov, A.P., and Hopf, H.: Gem-Dihalocyclopropanos in Organic Syn- 
thesis. 155, 41-80 (1990). 
Kratochvil, M., see Hladka, E.: 166, 121-197 (1993). 
Kryutchkov, S. V.: Chemistry of Technetium Cluster Compounds. 176, 189-252 (1996). 
Kumar, A., see Mishra, P. C.: 174, 27-44 (1995). 
Krogh, E., and Wan, P.: Photoinduced Electron Transfer of Carbanions and Carbacations. 
156, 93-116 (1990). 
Kunkeley, H., see Vogler, A.: 158, 1-30 (1990). 
Kuwajima, I., and Nakamura, E.: Metal Homoenolates from Siloxycyclopropanes. 155, 1-39 
(1990). 
Kvasnicka, V., see Hladka, E.: 166, 121-197 (1993). 
Lange, F., see Mandelkow, E.: 151, 9-29 (1989). 
Lecomte, J.-P., see Kirsch-De-Mesmaeker, A.: 177, 25-76 (1996). 
van Leeuwen, R,, Gritsenko, O. V. Baerends, E. J.: Analysis and Modelling of Atomic and 
Molecular Kohn-Sham Potentials. 180, 107-168 (1996). 
Lefort, D., see Fossey, J.: 164, 99-113 (1993). 
Lopez, L.: Photoinduced Electron Transfer Oxygenations. 156, 117-166 (1990). 
L6pez-Boada, R., see Ludena, E. V.: 180, 169-224 (1996). 
Lozach, B., see Collet, A.: 165, 103-129 (1993). 
Ludena, E. V., L6pez-Boada: Local-Scaling Transformation Version of Density Functional 
Theory: Generation of Density Functionals. 180, 169-224 (I 996). 
Mining, U.: Concave Acids and Bases. 175, 57-100 (1995). 
Lymar, S.V., Parmon, V.N., and Zarnarev, K.I.: Photoinduced Electron Transfer Across Mem- 
branes. 159, 1-66 (1991). 
Lynch, P.L.M., see Bissell, R.A.: 168, 223-264 (1993). 
Maguire, G.E.M., see Bissell, R.A.: 168, 223-264 (1993). 
Mandelkow, E., Lange, G., Mandelkow, E,-M.: Applications of Synchrotron Radiation to 
the Study of Biopolymers in Solution: Time-Resolved X-Ray Scattering of Microtubule 
Self-Assembly and Oscillations. 151, 9-29 (1989). 
Mandelkow, E.-M., see Mandelkow, E.: 151, 9-29 (1989). 
March; N. H., see Holas, A.: 180, 57-106 (1996). 
Maslak, P.: Fragmentations by Photoinduced Electron Transfer. Fundamentals and Practical 
Aspects. 168, 1-46 (1993), 
Mathias, J.P., see Kohnke, F.H.: 165, 1-69 (1993). 
Mattay, J., and Vondenhof, M.: Contact and Solvent-Separated Radical Ion Pairs in Organic 
Photochemistry. 159, 219-255 (1991). 
Mattay, J., see Hintz, S.: 177, 77-124 (1996). 
Matyska, L., see Hladka, E.: 166, 121-197 (1993). 
McCoy, C.P., see Bissell, R.A.: 168, 223-264 (1993). 
Mekelburger, H.-B., see Knops, P.: 161, 1-36 (1991). 
Mekelburger, H.-B., see SchrOder, A.: 172, 179-201 (1994). 
Mella, M., see Albini, A.: 168, 143-173 (1993). 
Memming, R.: Photoinduced Charge Transfer Processes at Semiconductor Electrodes and 
Particles. 169, 105-182 (1994). 
230 

Author Index Volumes 151- 180 
Meng, Q., Hesse, M.: Ring Closure Methods in the Synthesis of Macrocyclic Natural Pro- 
ducts. 161, 107-176 (1991). 
Merz, A.: Chemically Modified Electrodes, 152, 49-90 (1989). 
Meyer, B.: Conformational Aspects of Oligosaccharides. 154, 141-208 (1990). 
Mishra, P. C., and Kumar A.: Mapping of Molecular Electric Potentials and Fields. 174, 27- 
44 (1995). 
Mestres, J., see Besal6, E.: 173, 31-62 (1995). 
Mezey, P.G.: Density Domain Bonding Topology and Molecular Similarity Measures. 173, 
63-83 (1995). 
Misumi, S.: Recognitory Coloration of Cations with Chromoacerands. 165, 163-192 (1993 ). 
Mizuno, K., and Otsuji, Y.: Addition and Cycloaddition Reactions via Photoinduced Elec- 
tron Transfer. 169, 301-346 (1994). 
Mock, W. L,: Cucurbituril. 175, 1-24 (1995). 
Moffat, J.K., Helliwell, J.: The Lane Method and its Use in Time-Resolved Crystallography. 
151, 61-74 (1989). 
Molchanov, A.P., see Kostikov, R.R.: 155, 41-80 (1990). 
Moore, T.A., see Gust, D.: 159, 103-152 (1991). 
Mallen, K., see Baumgarten, M.: 169, 1-104 (1994). 
Murakami, Y., Kikuchi, J., Hayashida, O.: Molecular Recognition by Large Hydrophobic 
Cavities Embedded in Synthetic Bilayer Membranes. 175, 133-156 (1995). 
Nagle, D.G., see Gerwick, W.H.: 167, 117-180 (1993). 
Nakamura, E., see Kuwajima, I.: 155, 1-39 (1990). 
Nishimura, J., see Inokuma, S.: 172, 87-118 (1994). 
Nolte, R. J. M., see Sijbesma, R. P.: 175, 25-56 (1995). 
Nordahl, A., see Carlson, R.: 166, 1-64 (1993). 
Okuda, J.: Transition Metal Complexes of Sterically Demanding Cyclopentadienyl Ligands. 
160, 97-146 (1991). 
Omori, T.: Substitution Reactions of Technetium Compounds. 176, 253-274 (1996). 
Ostrowicky, A., Koepp, E., V6gtle, F.: The "Vesium Effect": Synthesis of Medio- and 
Macrocyclic Compounds. 161, 37-68 (1991). 
Otsuji, Y., see Mizuno, K.: 169, 301-346 (1994). 
P~link6, I., see Tasi, G.: 174, 45-72 (1995). 
Pandey, G.: Photoinduced Electron Transfer (PET) in Organic Synthesis. 168, 175-221 (1993). 
Parmon, V.N., see Lymar, S.V.: 159, 1-66 (1991). 
Perdew, J. P. see Ernzerhof. M.: 180, 1-30 (1996). 
Poirette, A. R., see Artymiuk, P. J.: 174, 73-104 (1995). 
Polian, A., see Fontaine, A.: 151, 179-203 (1989). 
Ponec, R.: Similarity Models in the Theory of Pericyclic Macromolecules. 174, 1-26 (1995). 
Pospichal, J., see Hladka, E.: 166, 121-197 (1993). 
Potucek, V., see Hladka, E.: 166, 121-197 (1993). 
Proteau, P.J., see Gerwick, W.H.: 167, 117-180 (1993). 
Raimondi, M., see Copper, D.L.: 153, 41-56 (1990). 
Reber, C., see Wexler, D.: 171, 173-204 (1994). 
231 

Author Index Volumes 151-180 
Rettig, W.: Photoinduced Charge Separation via Twisted Intramolecular Charge Transfer 
States. 169, 253-300 (1994). 
Rice, D. W., see Artymiuk, P. J.: 174, 73-104 (1995). 
Riekel, C.: Experimental Possibilities in Small Angle Scattering at the European Synchro- 
tron Radiation Facility. 151,205-229 (1989). 
Roth, H.D.: A Brief History of Photoinduced Electron Transfer and Related Reactions. 156, 
1-20 (1990). 
Roth, H.D.: Structure and Reactivity of Organic Radical Cations. 163, 131-245 (1992). 
Rouvray, D.H.: Similarity in Chemistry: Past, Present and Future. I73, 1-30 (1995). 
Riasch, M., see Warwel, S.: 164, 79-98 (1993). 
Sachs, H., see John, P.: 153, 145-180 (1990). 
Saeva, F.D.: Photoinduced Electron Transfer (PET) Bond Cleavage Reactions. 156, 59-92 
(1990). 
Sakai, S., see Inokuma, S.: 172, 87-118 (1994). 
Sandanayake, K.R.A.S., see Bissel, R.A.: 168, 223-264 (1993). 
Sauvage, J.-P., see Chambron, J.-C.: 165, 131-162 (1993). 
Schafer, H.-J.: Recent Contributions of Kolbe Electrolysis to Organic Synthesis. 152, 91-151 
(1989). 
Scheuer, P.J., see Chang, C.W.J.: 167, 33-76 (1993). 
Schmidtke, H.-H.: Vibrational Progressions in Electronic Spectra of Complex Compounds 
Indicating Stron Vibronic Coupling. 171, 69-112 (1994). 
Schmittel, M.: Umpolung of Ketones via Enol Radical Cations. 169, 183-230 (1994). 
SchrOder, A., Mekelburger, H.-B., and V0gtle, F.: Belt-, Ball-, and Tube-shaped Molecules. 
172, 179-201 (1994). 
Schulz, J., V6gtle, F.: Transition Metal Complexes of (Strained) Cyclophanes. 172, 41-86 
(1994). 
Seel, C., Gal~m, A., de Mendoza, J.: Molecular Recognition of Organic Acids and Anions - 
Receptor Models for Carboxylates, Amino Acids, and Nucleotides. 175, 101-132 (1995). 
Sendhoff, N., see Knops, P.: 161, 1-36 (1991). 
Sessler, J.L., Burrell, A.K.: Expanded Porphyrins. 161, 177-274 (1991). 
Sheldon, R.: Homogeneous and Heterogeneous Catalytic Oxidations with Peroxide Rea- 
gents. 164, 21-43 (1993). 
Sheng, R.: Rapid Ways of Recognize Kekul6an Benzenoid Systems. 153, 211-226 (1990). 
Sijbesrna, R. P., Nolte, R. J. M.: Molecular Clips and Cages Derived from Glycoluril. 175, 
57-100 (1995). 
Sodano, G., see Cimino, G.: 167, 77-116 (1993). 
Sojka, M., see Warwel, S.: 164, 79-98 (1993). 
Sol/t, M., see BesalO, E.: 173, 31-62 (1995). 
Sorba, J., see Fossey, J.: 164, 99-113 (1993). 
Spiess, H., see Johannsen, B.: I76, 77-122 (1996). 
Stanek, Jr., J.: Preparation of Selectively Alkylated Saccharides as Synthetic Intermediates. 
154, 209-256 (1990). 
Steckhan, E.: Electroenzymatic Synthesis. 170, 83-112 (1994). 
Steenken, S.: One Electron Redox Reactions between Radicals and Organic Molecules. An 
Addition/Elimination (Inner-Sphere) Path. 177, 125-146 (1996). 
Stein, N., see Bley, K.: 166, 199-233 (1993). 
Stoddart, J.F., see Kohnke, F.H.: 165, 1-69 (1993). 
Soumillion, J.-P.: Photo induced Electron Transfer Employing Organic Anions. 168, 93-141 
(1993). 
232 

Author Index Volumes 151-180 
Stumpe, R., see Kim, J.I.: 157, 129-180 (1990). 
Suami, T.: Chemistry of Pseudo-sugars. 154, 257-283 (1990). 
Suppan, P.: The Marcus Inverted Region. 163, 95-130 (1992). 
Suzuki, N.: Radiometric Determination of Trace Elements. 157, 35-56 (1990). 
Takahashi, Y.: Identification of Structural Similarity of Organic Molecules. 174, 105-134 
(1995). 
Tasi, G., and P(tlink6, I.: Using Molecular Electrostatic Potential Maps for Similarity Studies. 
174, 45-72 (1995). 
Thiem, J., and Klaffke, W.: Synthesis of Deoxy Oligosaccharides. 154, 285-332 (1990). 
Timpe, H.-J.: Photoinduced Electron Transfer Polymerization. 156, 167-198 (1990). 
Tobe, Y.: Strained [n]Cyclophanes. 172, 1-40 (1994. 
Tolentino, H., see Fontaine, A.: 151, 179-203 (1989). 
Tomalial D.A.: Genealogically Directed Synthesis: Starbust/Cascade Dendrimers and 
Hyperbranched Structures. 165, (1993). 
Tourillon, G., see Fontaine, A.: 151, 179-203 (1989). 
Ugi, I., see Bley, K.: 166, 199-233 (1993). 
Vinod, T. K., Hart, H.: Cuppedo- and Cappedophanes. 172, 119-178 (1994). 
V6gtle, F., see Dohm, J.: 161, 69-106 (1991). 
VOgtle, F., see Knops, P.: 161, 1-36 (1991). 
V6gtle, F., see Ostrowicky, A.: 161, 37-68 (1991). 
V6gtle, F., see Schulz, J.: 172, 41-86 (1994). 
V6gtle, F., see SchrOder, A.: 172, 179-201 (1994). 
Vogler, A., Kunkeley, H.: Photochemistry of Transition Metal Complexes Induced by Outer- 
Sphere Charge Transfer Excitation. 158, 1-30 (1990). 
Volkert, W. A., and S. Jurisson: Technetium-99m Chelates as Radiopharmaceuticals. 176, 
123-148 (1996). 
Vondenhof, M., see Mattay, J.: 159, 219-255 (1991). 
Wan, P., see Krogh, E.: 156, 93-116 (1990). 
Warwel, S., Sojka, M., and Rt~sch, M.: Synthesis of Dicarboxylic Acids by Transition-Metal 
Catalyzed Oxidative Cleavage of Terminal-Unsaturated Fatty Acids. 164, 79-98 (1993). 
Wexler, D., Zink, J. I., and Reber, C.: Spectroscopic Manifestations of Potential Surface 
Coupling Along Normal Coordinates in Transition Metal Complexes. 171, 173-204 (1994). 
Willett, P., see Artymiuk, P. J.: 174, 73-104 (1995). 
Willner, I., and Willner, B.: Artificial Photosynthetic Model Systems Using Light-Induced 
Electron Transfer Reactions in Catalytic and Biocatalytic Assemblies. 159, 153-218 (1991 ). 
Yoshida, J.: Electrochemical Reactions of Organosilicon Compounds. 170, 39-82 (1994). 
Yoshihara, K.: Chemical Nuclear Probes Using photon Intensity Ratios. 157, 1-34 (1990). 
Yoshihara, K.: Recent Studies on the Nuclear Chemistry of Technetium. 176, !-16 (1996). 
Yoshihara, K.: Technetium in the Environment. 176, 17-36 (1996). 
Yoshihara, K., see Hashimoto, K.: 176, 275-192 (1996). 
Zamaraev, K.I., see Lymar, S.V.: 159, !-66 (1991).Zamaraev, K.I., Kairutdinov, R.F.: Pho- 
toinduced Electron Tunneling Reactions in Chemistry and Biology. 163, 1-94 (1992). 
233 

Author Index Volumes 151-180 
Zander, M.: Molecular Topology and Chemical Reactivity ofPolynuclear Benzenoid Hydro- 
carbons. 153, 101-122 (1990). 
Zhang, F.J., Guo, X.F., and Chen, R.S.: The Existence of Kekul6 Structures in a Benzenoid 
System. 153, 181-194 (1990). 
Zimmermann, S.C.: Rigid Molecular Tweezers as Hosts for the Complexation of Neutral 
Guests. 165, 71-102 (1993). 
Zink, J. I., see Wexler, D.: 171, 173-204 (1994). 
Zucchelli, G., see Jennings, R. C.: 177, 147-182 (1996). 
Zybill, Ch.: The Coordination Chemistry of Low Valent Silicon. 160, 1-46 (1991). 
234 

