Annals of Mathematics, 162 (2005), 1031–1063
The density of discriminants
of quartic rings and ﬁelds
By Manjul Bhargava
1. Introduction
The primary purpose of this article is to prove the following theorem.
Theorem 1. Let N(i)
4 (ξ, η) denote the number of S4-quartic ﬁelds K
having 4 −2i real embeddings such that ξ < Disc(K) < η. Then
(a)
lim
X→∞
N(0)
4 (0, X)
X
=
1
48

p
(1 + p−2 −p−3 −p−4);
(b)
lim
X→∞
N(1)
4 (−X, 0)
X
=
1
8

p
(1 + p−2 −p−3 −p−4);
(c)
lim
X→∞
N(2)
4 (0, X)
X
=
1
16

p
(1 + p−2 −p−3 −p−4).
Several further results are obtained as by-products. First, our methods
enable us to count all orders in S4-quartic ﬁelds.
Theorem 2. Let M(i)
4 (ξ, η) denote the number of quartic orders O con-
tained in S4-quartic ﬁelds having 4−2i real embeddings such that ξ<Disc(O)<η.
Then
(a)
lim
X→∞
M(0)
4 (0, X)
X
= ζ(2)2ζ(3)
48 ζ(5) ;
(b)
lim
X→∞
M(1)
4 (−X, 0)
X
= ζ(2)2ζ(3)
8 ζ(5)
;
(c)
lim
X→∞
M(2)
4 (0, X)
X
= ζ(2)2ζ(3)
16 ζ(5) .
Second, the proof of Theorem 1 involves a determination of the densities
of various splitting types of primes in S4-quartic ﬁelds. If K is an S4-quartic
ﬁeld unramiﬁed at a prime p, and K24 denotes the Galois closure of K, then the

1032
MANJUL BHARGAVA
Artin symbol (K24/p) is deﬁned as a conjugacy class in S4, its values being ⟨e⟩,
⟨(12)⟩, ⟨(123)⟩, ⟨(1234)⟩, or ⟨(12)(34)⟩, where ⟨x⟩denotes the conjugacy class
of x in S4. It follows from the Chebotarev density theorem that for ﬁxed K
and varying p (unramiﬁed in K), the values ⟨e⟩, ⟨(12)⟩, ⟨(123)⟩, ⟨(1234)⟩, and
⟨(12)(34)⟩occur with relative frequency 1 : 6 : 8 : 6 : 3. We prove the following
complement to Chebotarev density:
Theorem 3. Let p be a ﬁxed prime, and let K run through all S4-quartic
ﬁelds in which p does not ramify, the ﬁelds being ordered by the size of the
discriminants. Then the Artin symbol (K24/p) takes the values ⟨e⟩, ⟨(12)⟩,
⟨(123)⟩, ⟨(1234)⟩, and ⟨(12)(34)⟩with relative frequency 1:6:8:6:3.
Actually, we do a little more: we determine for each prime p the density
of quartic ﬁelds K in which p has the various possible ramiﬁcation types. For
instance, it follows from our methods that a proportion of precisely
(p+1)2
p3+p2+2p+1
of S4-quartic ﬁelds are ramiﬁed at p.
Third, Theorem 1 implies that relatively many—in fact, a positive pro-
portion of!—quartic ﬁelds do not have full Galois group S4. Indeed, it was
shown by Baily [1], using methods of class ﬁeld theory, that the number of
D4-quartic ﬁelds having absolute discriminant less than X is between c1X and
c2X for some constants c1 and c2. This result was recently reﬁned to an ex-
act asymptotic by Cohen, Diaz y Diaz, and Olivier [7], who showed that the
number of such D4-quartic ﬁelds is ∼cX, where c ≈.052326 . . . . Moreover,
it has been shown by Baily [1] and Wong [26] that the contributions from the
Galois groups C4, K4, and A4 are negligible in comparison; i.e., the number
of quartic extensions having one of these Galois groups and absolute discrimi-
nant at most X is o(X) (in fact, O(X
7
8+ϵ)). In conjunction with these results,
Theorem 1 implies:
Theorem 4. When ordered by absolute discriminant, a positive propor-
tion (approximately 17.111%) of quartic ﬁelds have associated Galois group D4.
The remaining 82.889% of quartic ﬁelds have Galois group S4.
As noted in [6], this is in stark contrast to the situation for polynomials,
since Hilbert showed that 100% of degree n polynomials (in an appropriate
sense) have Galois group Sn. Theorem 4 may be broken down by signature.
Among the quartic ﬁelds having 0, 2, or 4 complex embeddings respectively,
the proportions having associated Galois group S4 are given by: 83.723%,
93.914%, and 66.948% respectively.
Finally, using a duality between quartic ﬁelds and 2-class groups of cubic
ﬁelds, we are able to determine the mean value of the size of the 2-class group
of both real and complex cubic ﬁelds. More precisely, we prove

DISCRIMINANTS OF QUARTIC RINGS AND FIELDS
1033
Theorem 5. For a cubic ﬁeld F, let h∗
2(F) denote the size of the exponent-
2 part of the class group of F. Then
(a)
lim
X→∞

F h∗
2(F)

F 1
= 5/4 ;
(1)
(b)
lim
X→∞

F h∗
2(F)

F 1
= 3/2 ,
(2)
where the sums range over cubic ﬁelds F having discriminants in the ranges
(0, X) and (−X, 0) respectively.
The theorem implies, in particular, that at least 75% of totally real cubic
ﬁelds, and at least 50% of complex cubic ﬁelds, have odd class number.
It is natural to compare the values 5/4 and 3/2 obtained in our theorem
with the corresponding values predicted by the Cohen-Martinet heuristics (the
analogues of the Cohen-Lenstra heuristics for noncyclic, higher degree ﬁelds).
There has been much recent skepticism surrounding these heuristics (even by
Cohen-Martinet themselves; see [9]), since at the prime p = 2 they do not
seem to agree with existing computational data.∗In light of this situation,
it is interesting to note that our Theorem 5 agrees exactly with the (original)
prediction of the Cohen-Martinet heuristics [8]. In particular, Theorem 5 is a
strong indication that, in the language of [8], the prime p = 2 is indeed “good”,
and the fact that Theorem 5 does not agree well with current computations is
due only to the extremely slow convergence of the limits (1) and (2).
The cubic analogues of Theorems 1, 3, and 5 for cubic ﬁelds were obtained
in the well-known work of Davenport-Heilbronn [15]. Their methods relied
heavily on the remarkable discriminant-preserving correspondence between cu-
bic orders and equivalence classes of integral binary cubic forms, established by
Delone-Faddeev [16]. It seems, however, that Davenport-Heilbronn were not
aware of the work in [16], and derived the same correspondence for maximal
orders independently; had they known the general form of the Delone-Faddeev
parametrization, it would have been possible for them (using again the results
of Davenport [13]) simply to read oﬀthe cubic analogue of Theorem 2.† Mean-
∗A computation of all real cubic ﬁelds of discriminant less than 500000 ([17]) shows that
(
0<Disc(F )<500000 h∗
2(F))/(
0<Disc(F )<500000 1) equals about 1.09, a good deal less than
5/4; the analogous computation for complex cubic ﬁelds of absolute discriminant less than
1000000 ([18]) yields approximately 1.30, a good deal less than 3/2!
†We note the result here, since it seems not to have been stated previously in the literature.
Let M3(ξ, η) denote the number of cubic orders O such that ξ < Disc(O) < η. Then
lim
X→∞
M3(0, X)
X
= π2/72,
lim
X→∞
M3(−X, 0)
X
= π2/24.

1034
MANJUL BHARGAVA
while, the cubic analogue of Theorem 4 may be obtained by combining the
work of Davenport-Heilbronn [15] with that of Cohn [10].‡
An important ingredient that allows us to extend the above cubic results
to the quartic case is a parametrization of quartic orders by means of two in-
tegral ternary quadratic forms up to the action of GL2(Z) × SL3(Z), which we
established in [3]. The proofs of Theorems 1–5 thus reduce to counting integer
points in certain 12-dimensional fundamental regions. We carry out this count-
ing in a hands-on manner similar to that of Davenport [13], although another
crucial ingredient in our work is a new averaging method which allows us to
deal more eﬃciently with points in the cusps of these fundamental regions. The
necessary point-counting is accomplished in Section 2. This counting result,
together with the results of [3], immediately yields the asymptotic density of
discriminants of pairs (Q, R), where Q is an order in an S4-quartic ﬁeld and R
is a cubic resolvent of Q. Obtaining Theorems 1–5 from this general density
result then requires a sieving process which we carry out in Section 3.
The space of pairs of ternary quadratic forms that we use in this arti-
cle, as well as the space of binary cubic forms that was used in the work of
Davenport-Heilbronn, are both examples of what are known as prehomoge-
neous vector spaces. A prehomogeneous vector space is a pair (G, V ), where
G is a reductive group and V is a linear representation of G such that GC
has a Zariski open orbit on VC. The concept was introduced by Sato in the
1960’s, and a classiﬁcation of all prehomogeneous vector spaces was given in
the work of Sato-Kimura [22], while Sato-Shintani [23] developed a theory of
zeta functions associated to these spaces.
The connection between prehomogeneous vector spaces and ﬁeld exten-
sions was ﬁrst studied systematically in the beautiful 1992 paper of Wright-
Yukie [27]. In that paper, they laid out a program to determine the density of
discriminants of number ﬁelds of degree up to ﬁve by considering adelic versions
of Sato-Shintani’s zeta functions as developed by Datskovsky and Wright [11]
in their work on cubic extensions. Despite looking very promising, the program
has not succeeded to date beyond the cubic case, although the global theory
of the adelic zeta function in the quartic case was developed in the impressive
1993 treatise of Yukie [28], which led to a conjectural determination of the
Euler products appearing in Theorem 1 (see [29]).
The reason that the zeta function method has required such a large amount
of work, and has thus presented some related diﬃculties, is that intrinsic to
the zeta function approach is a certain overcounting of quartic extensions.
Speciﬁcally, even when one wishes to count only quartic ﬁeld extensions of Q
having, say, Galois group S4, inherent in the zeta function is a sum over all
‡Their work implies that, when ordered by absolute discriminant, 100% of cubic ﬁelds
have associated Galois group S3.

DISCRIMINANTS OF QUARTIC RINGS AND FIELDS
1035
“´etale extensions” of Q, including the “reducible” extensions that correspond
to direct sums of quadratic extensions.
These reducible quartic extensions
far outnumber the irreducible ones; indeed, the number of reducible quartic
extensions of absolute discriminant at most X is asymptotic to X log X, while
we show that the number of quartic ﬁeld extensions of absolute discriminant
at most X is only O(X). This overcount results in the Shintani zeta function
having a double pole at s = 1 rather than a single pole. Removing this double
pole, in order to obtain the desired main term, has been the primary diﬃculty
with the zeta function method.
One way our viewpoint diﬀers from the adelic zeta function approach is
that we consider integer orbits as opposed to rational orbits. This turns out to
have a number of signiﬁcant advantages. First, the use of integer orbits enables
us to apply a convenient reduction theory in terms of Siegel sets. Within these
Siegel sets, we then determine which regions contain many irreducible points
and which do not. We prove that the cusps of the Siegel sets contain most
of the reducible points, while the main bodies of the Siegel sets contain most
of the irreducible points.
These geometric results allow us to separate the
irreducible orbits from the reducible ones from the very beginning, so that we
may proceed directly to the “irreducible” integer orbits, where geometry-of-
numbers methods are applicable. The aforementioned diﬃculties arising from
overcounting are thus bypassed.
A second important advantage of using integer orbits in conjunction with
geometry-of-numbers arguments is that the resulting methods are very ele-
mentary and the treatment is relatively short. Finally, the use of integer orbits
enables us to count not only S4-quartic ﬁelds but also all orders in S4-quartic
ﬁelds.
Nevertheless, the adelic zeta function method, if completed in the future,
could lead to some interesting results to supplement Theorems 1–5. For ex-
ample, it may yield functional equations for the zeta function as well as a
precise determination of its poles, thus possibly leading to lower bounds on
ﬁrst order error terms in Theorem 1–5. It is also likely that the zeta function
methods together with the methods introduced here would lead to even further
applications in these and other directions.
We fully expect that the geometric methods introduced in this paper will
also prove useful in other contexts. For example, with only slight modiﬁcations,
the methods of this paper can also be used to derive the density of discriminants
of quintic orders and ﬁelds. These and related results will appear in [4], [5].
We note that, in this paper, we always count quartic (and cubic) number
ﬁelds up to isomorphism. Another natural way to count number ﬁelds is as
subﬁelds of a ﬁxed algebraic closure ¯Q of Q. It is easy to see that any iso-
morphism class of S4-quartic ﬁeld corresponds to four conjugate subﬁelds of
¯Q, while an isomorphism class of D4-quartic ﬁeld corresponds to two conju-

1036
MANJUL BHARGAVA
gate subﬁelds of ¯Q. Adopting the latter counting convention would therefore
multiply all constants in Theorems 1 and 2 by a factor of four. Moreover, the
proportion of S4-quartic ﬁelds in Theorem 4 would then increase to 90.644%
(by signature: 91.141%, 96.862%, and 80.202%). Theorems 3 and 5, of course,
would remain unchanged.
2. On the class numbers of pairs of ternary quadratic forms
Let VR denote the space of pairs (A, B) of ternary quadratic forms over
the real numbers. We write an element (A, B) ∈VR as a pair of 3×3 symmetric
real matrices as follows:
2 · (A, B) =




2a11
a12
a13
a12
2a22
a23
a13
a23
2a33

,


2b11
b12
b13
b12
2b22
b23
b13
b23
2b33



.
(3)
Such a pair (A, B) is said to be integral if A and B are “integral” quadratic
forms, i.e., if aij, bij ∈Z.
The group GZ = GL2(Z)×SL3(Z) acts naturally on the space VR. Namely,
an element g2 ∈GL2(Z) acts by changing the basis of the lattice of forms
spanned by (A, B); i.e., if g2 =
 r s
t u

, then g2 · (A, B) = (rA + sB, tA + uB).
Similarly, an element g3 ∈SL3(Z) changes the basis of the three-dimensional
space on which the forms A and B take values; i.e., g3·(A, B) = (g3Agt
3, g3Bgt
3).
It is clear that the actions of g2 and g3 commute, and that this action of GZ
preserves the lattice VZ consisting of the integral elements of VR.
The action of GZ on VR (or VZ) has a unique polynomial invariant. To
see this, notice ﬁrst that the action of GL3(Z) on V has four independent
polynomial invariants, namely the coeﬃcients a, b, c, d of the binary cubic form
f(x, y) = f(A,B)(x, y) = 4 · Det(Ax −By),
where (A, B) ∈V .
We call f(x, y) the binary cubic form invariant of the
element (A, B) ∈V .
Next, GL2(Z) acts on the binary cubic form f(x, y), and it is well-known
that this action has exactly one polynomial invariant, namely the discriminant
Disc(f). Thus the unique polynomial invariant for the action of GZ on VZ is
Disc(4 · Det(Ax −By)). We call this fundamental invariant the discriminant
Disc(A, B) of the pair (A, B). (The factor 4 is included to insure that any pair
of integral ternary quadratic forms has integral discriminant.)
The orbits of GZ on VZ have an important arithmetic signiﬁcance. Recall
that a quartic ring is any ring that is isomorphic to Z4 as a Z-module; for
example, an order in a quartic number ﬁeld is a quartic ring. In [3], we showed
how quartic rings may be parametrized in terms of the GZ-orbits on VZ:

DISCRIMINANTS OF QUARTIC RINGS AND FIELDS
1037
Theorem 6. There is a canonical bijection between the set of GZ-equiv-
alence classes of elements (A, B) ∈VZ and the set of isomorphism classes of
pairs (Q, R), where Q is a quartic ring and R is a cubic resolvent ring of Q.
Under this bijection, we have Disc(A, B) = Disc(Q) = Disc(R).
A cubic resolvent of a quartic ring Q is a cubic ring R equipped with a
certain quadratic resolvent mapping Q →R, whose precise deﬁnition will not
be needed here (see [3] for details). In view of Theorem 6, it is natural to try
to understand the number of GZ-orbits on VZ having absolute discriminant
at most X, as X →∞. The number of integral orbits on VZ having a ﬁxed
discriminant D is called a “class number”, and we wish to understand the
behavior of this class number on average.
From the point of view of Theorem 6, we would like to restrict the elements
of VZ under consideration to those which are “irreducible” in an appropriate
sense. More precisely, we call a pair (A, B) of integral ternary quadratic forms
in VZ absolutely irreducible if
• A and B do not possess a common zero as conics in P2(Q); and
• the binary cubic form f(x, y) = Det(Ax −By) is irreducible over Q.
Equivalently, (A, B) is absolutely irreducible if A and B possess a common zero
in P2 having ﬁeld of deﬁnition K, where K is a quartic number ﬁeld whose
Galois closure has Galois group either A4 or S4 over Q. In terms of Theorem 6,
absolutely irreducible elements in VZ correspond to pairs (Q, R) where Q is an
order in either an A4 or S4-quartic ﬁeld. The main result of this section is the
following theorem:
Theorem 7. Let N(V (i)
Z ; X) denote the number of GZ-equivalence classes
of absolutely irreducible elements (A, B) ∈VZ having 4−2i zeros in P2(R) and
satisfying |Disc(A, B)| < X. Then
(a)
lim
X→∞
N(V (0)
Z ; X)
X
= ζ(2)2ζ(3)
48
;
(b)
lim
X→∞
N(V (1)
Z ; X)
X
= ζ(2)2ζ(3)
8
;
(c)
lim
X→∞
N(V (2)
Z ; X)
X
= ζ(2)2ζ(3)
16
.
Theorem 7 is proved in several steps. In Subsection 2.1, we outline the
necessary reduction theory needed to establish some particularly useful funda-
mental domains for the action of GZ on VR. In Subsection 2.2, we describe a
new “averaging” method that allows one to eﬃciently count points in various
components of these fundamental domains in terms of their volumes. In Sub-
sections 2.3–2.5, we investigate the distribution of reducible and irreducible

1038
MANJUL BHARGAVA
integral points within these fundamental domains. The volumes of the result-
ing “irreducible” components of these fundamental domains are then computed
in the ﬁnal Subsection 2.6, proving Theorem 7.
In Section 3, we will show how similar counting methods—together with
a sieving process—can be used to prove Theorems 1–5.
2.1.
Reduction theory.
The action of GR = GL2(R) × SL3(R) on VR
has three nondegenerate orbits V (0)
R , V (1)
R , V (2)
R , where V (i)
R
consists of those
elements (A, B) in VR having 4 −2i common zeros in P2(R).
We wish to
understand the number N(V (i)
Z ; X) of absolutely irreducible GZ-orbits on V (i)
Z
having absolute discriminant less than X (i = 0, 1, 2). We accomplish this by
counting the number of integer points of absolute discriminant less than X in
suitable fundamental domains for the action of GZ on VR.
These fundamental regions are constructed as follows. First, let F denote
a fundamental domain for the action of GZ on GR by left multiplication. We
may assume that F ⊂GR is semi-algebraic and connected, and that it is
contained in a standard Siegel set, i.e., F ⊂N′A′KΛ, where
K = {orthogonal transformations in GR};
A′ = {a(t1, t2, t3) : 0 < t−1
1
≤c1 t1, 0 < (t2t3)−1 ≤c1 t2 ≤c2
1 t3},
where a(t1, t2, t3) =

t−1
1
t1

,
 (t2t3)−1
t2
t3

;
or
A′ = {a(s1, s2, s3) : s1 ≥1/√c1, s2, s3 ≥1/ 3√c1},
where a(s1, s2, s3) =

s−1
1
s1

,
 s−2
2 s−1
3
s2s−1
3
s2s2
3

;
N′ = {n(u1, u2, u3, u4) : |u1|, |u2|, |u3|, |u4| ≤c2},
where
n(u1, u2, u3, u4) =

1
u1
1

,

1
u2
1
u3
u4
1

;
Λ = {λ : λ > 0},
where λ acts by

λ
λ

,
 1
1
1

,
and c1, c2 are absolute constants. For example, the well-known fundamental
domains in GL2(R) and GL3(R) as constructed by Minkowski satisfy these
conditions for c1 = 2/
√
3 and c2 = 1/2.
Next, for i = 0, 1, 2, let ni denote the cardinality of the stabilizer in GR
of any element v ∈V (i)
R . (One easily checks that ni = 24, 4, 8 for i = 0, 1, 2
respectively.) Then for any v ∈V (i)
R , Fv will be the union of ni fundamental

DISCRIMINANTS OF QUARTIC RINGS AND FIELDS
1039
domains for the action of GZ on V (i)
R .
Since this union is not necessarily
disjoint, Fv is best viewed as a multiset, where the multiplicity of a point x
in Fv is given by the cardinality of the set {g ∈F | gv = x}. Evidently, this
multiplicity is a number between 1 and ni.
Furthermore, since Fv is a polynomial image of a semi-algebraic set F,
the theorem of Tarski and Seidenberg on quantiﬁer elimination ([25], [24])
implies that Fv is a semi-algebraic multiset in VR; here by a semi-algebraic
multiset R we mean a multiset whose underlying subsets Rk of elements in
R having multiplicity k are semi-algebraic for all 1 ≤k < ∞.
The semi-
algebraicity of Fv will play an important role in what follows (cf. Lemmas 9
and 15).
For any v ∈V (i)
R , we have noted that the multiset Fv is the union of ni
fundamental domains for the action of GZ on V (i)
R . However, not all elements
in GZ\VZ will be represented in Fv exactly ni times. In general, the number of
times the GZ-equivalence class of an element x ∈VZ will occur in Fv is given
by ni/m(x), where m(x) denotes the size of the stabilizer of x in GZ. Since we
have shown in [3] that the stabilizer in GZ of an absolutely irreducible element
(A, B) ∈VZ is always trivial, we conclude that, for any v ∈V (i)
R , the product
ni · N(V (i)
Z ; X) is exactly equal to the number of absolutely irreducible integer
points in Fv having absolute discriminant less than X.
Thus to estimate N(V (i)
Z ; X), it suﬃces to count the number of integer
points in Fv for some v ∈V (i)
R . The number of such integer points can be
diﬃcult to count in a single such Fv (see e.g., [13], [2]), so instead we average
over many Fv by averaging over certain v lying in a box H.
2.2.
Averaging over fundamental domains.
Let H = {(A, B) ∈VR :
|aij|, |bij| ≤10 for all i, j; |Disc(A, B)| ≥1}, and let Φ = ΦH denote the
characteristic function of H. Then since Fv is the union of ni fundamental
domains for the action of GZ on V (i) = V (i)
R , we have
(4)
N(V (i)
Z ; X)
=

v∈V (i) Φ(v) · #{x ∈Fv ∩V (i)
Z
abs. irr. : 0 < |Disc(x)| < X} |Disc(v)|−1dv
ni ·

v∈V (i) Φ(v) |Disc(v)|−1dv
,
where points in Fv ∩V (i)
Z
are as usual counted according to their multiplicities
in Fv.
The denominator on the right-hand side of (4) is, by construction,
a ﬁnite absolute constant Mi greater than zero. We have chosen to use the
measure |Disc(v)|−1dv because it is a GR-invariant measure.
More generally, for any GZ-invariant set S ⊂VZ, we may speak of the
number N(S; X) of irreducible GZ-orbits on S having absolute discriminant
less than X. Then N(S; X) can be expressed similarly as

1040
MANJUL BHARGAVA
(5)
N(S; X)
=
2

i=0

v∈V (i) Φ(v) · #{x ∈Fv ∩S abs. irr. : 0 < |Disc(x)| < X} |Disc(v)|−1dv
ni ·

v∈V (i) Φ(v) |Disc(v)|−1dv
.
We shall use this deﬁnition of N(S; X) for any S ⊂VZ, even if S is not
GZ-invariant.
Note that for disjoint S1, S2 ⊂VZ, we have N(S1 ∪S2) =
N(S1) + N(S2).
Using the fact that |Disc(v)|−1dv is the unique GR-invariant measure on
V (i) (up to scaling), we may also express formula (5) for N(S; X) as an integral
over F−1 ⊂GR. Let dg be a left-invariant Haar measure on GR, which is
uniquely deﬁned up to scaling. Then we may write
N(S; X)
=
2

i=0
1
Mi

v∈V (i)

x∈Fv∩S abs. irr.
|Disc(x)|<X
Φ(v) |Disc(v)|−1dv
=
2

i=0
c′
Mi

g∈F −1

x∈V (i)∩S abs. irr.
|Disc(x)|<X
Φ(gx) dg,
(6)
where c′ is an absolute constant depending only on the scaling of the Haar
measure dg. In particular, since F−1 ⊂KA′−1N′Λ ⊂KN ′A′−1Λ, we have the
upper bound
N(S; X) ≪

g∈KN ′A′−1Λ

x∈S abs. irr.
|Disc(x)|<X
Φ(kna−1λx) s−2
1 s−6
2 s−6
3
d×λ d×s dn dk.
(7)
Note that, in the latter integral, it suﬃces to restrict λ ∈Λ to within the range
[X−1/12, c], where c = (max{|Disc(x)| : x ∈H})1/12 is an absolute constant.
Indeed, if x ∈S with 1 ≤|Disc(x)| < X and λ is outside the range [X−1/12, c],
then |Disc(kna−1λx)| = λ12|Disc(x)| will lie outside the range [1, c12]; in that
case, kna−1λx /∈H and the integrand will be zero.
Now since K and N ′ are compact, there exists a compact set H′ such that
H′ ⊃N′KH. In fact, we may set
H′ = {(A, B) ∈VR : |aij|, |bij| ≤60 for all i, j; |Disc(A, B)| ≥1}
as it is easy to check that the latter set contains N′KH. Let Ψ denote the
characteristic function of H′. Then (7) implies
N(S; X) ≪
 c
λ=X−1
12
 ∞
s1,s2,s3= 1
2
σ(S) s−2
1 s−6
2 s−6
3 d×s d×λ,
(8)
where σ(S) = σ(S; λ, s1, s2, s3) is given by
σ(S) =

(A,B)∈S abs. irr.
|Disc(A,B)|<X
Ψ

λ · a(s1, s2, s3)−1(A, B)

.

DISCRIMINANTS OF QUARTIC RINGS AND FIELDS
1041
Noting that 2 λ · a(s1, s2, s3)−1(A, B) is
(9)
 2 λs1s4
2s2
3a11
λs1s2s2
3a12
λs1s2s−1
3 a13
λs1s2s2
3a12 2 λs1s−2
2 s2
3a22 λs1s−2
2 s−1
3 a23
λs1s2s−1
3 a13 λs1s−2
2 s−1
3 a23 2 λs1s−2
2 s−4
3 a33

,
 2 λs−1
1 s4
2s2
3a11
λs−1
1 s2s2
3a12
λs−1
1 s2s−1
3 a13
λs−1
1 s2s2
3a12 2 λs−1
1 s−2
2 s2
3a22 λs−1
1 s−2
2 s−1
3 a23
λs−1
1 s2s−1
3 a13 λs−1
1 s−2
2 s−1
3 a23 2 λs−1
1 s−2
2 s−4
3 a33

,
we see that λ · a(s1, s2, s3)−1(A, B) will lie in H′ only if (A, B) lies in the box
deﬁned by the inequalities
(10)
|a11|≤
60
λs1s4
2s2
3 ; |a12|≤
60
λs1s2s2
3 ; |a13|≤60s3
λs1s2 ; |a22|≤60s2
2
λs1s2
3 ; |a23|≤60s2
2s3
λs1 ;
|a33|≤60s2
2s4
3
λs1 ;
|b11|≤60s1
λs4
2s2
3 ;
|b12|≤60s1
λs2s2
3 ;
|b13|≤60s1s3
λs2 ; |b22|≤60s1s2
2
λs2
3 ; |b23|≤60s1s2
2s3
λ
; |b33|≤60s1s2
2s4
3
λ
.
Hence σ(S) is at most the number of absolutely irreducible points in S lying
in the box (10). In practice, we will choose our sets S ⊂VZ for which it is easy
to estimate the number of points in S lying in the box (10). This will allow
for accurate estimates of N(S; X).
We note that the same counting method may be used even if we are
interested in counting both reducible and irreducible orbits in VZ. For any
set S ⊂VZ, let N∗(S; X) be deﬁned by (5), but where the phrase “abs. irr.”
is removed. Thus for a GZ-invariant set S ⊂VZ, N∗(S; X) counts the total
number of GZ-orbits in S having absolute discriminant nonzero and less than
X (not just the irreducible ones). By the same reasoning, we have
N∗(S; X) ≪
 c
λ=X−1
12
 ∞
s1,s2,s3= 1
2
σ∗(S) s−2
1 s−6
2 s−6
3 d×s d×λ,
(11)
where σ∗(S) = σ(S; λ, s1, s2, s3) denotes the number of integer points in S
satisfying (10).
The expression (5) for N(S; X), its analogue for N∗(S, X), the upper
bounds (8) and (11), and the inequalities (10) will be useful in the sections
that follow.
2.3. Preliminary estimates. We begin with some estimates that must be
satisﬁed by the coeﬃcients of any element (A, B) ∈Fv, where v ∈H.
Lemma 8. Let v ∈H. Suppose (A, B) ∈Fv has entries given by (3) and
satisﬁes |Disc(A, B)| < X. Let S be any multiset consisting of elements of the
form aij or bij. Let m denote the number of a’s which occur in S, and let
n = |S| −m denote the number of b’s; let i, j, and k = 2 |S| −i −j denote the
number of indices in S equal to 1, 2, and 3 respectively. If m ≥n, 2i ≥j + k,
and i + j ≥2k, then

s∈S
s = O(X|S|/12).

1042
MANJUL BHARGAVA
Proof. Note that Fv ⊂Λ′N′A′Kv, where N′, A′, and K are as in Sec-
tion 2.1 and Λ′ = {λ ∈R : 0 < λ < X1/12}. For a multiset S as in the lemma,
it is clear that the value of f = 
s∈S s is bounded on Kv, since K and H are
compact. Next, the values of f on A′Kv are simply sn−m
1
sj+k−2i
2
s2k−i−j
3
times
the values of f on Kv. If m ≥n, 2i ≥j+k, and i+j ≥2k, then it is clear that
sn−m
1
sj+k−2i
2
s2k−i−j
3
is absolutely bounded, and hence the values of f on A′Kv
are also bounded. Finally, N′ is compact, and it acts only by lower triangular
transformations; thus f also takes bounded values on N′A′Kv. Therefore, the
values of f on Λ′N′A′Kv are at most O(X|S|/12) in size. This is the desired
conclusion.
Lemma 8 gives those estimates on the entries of (A, B) that follow imme-
diately from the fact that F is contained in a Siegel set.
The following two lemmas will also be useful. The ﬁrst is essentially due
to Davenport [12], [14]. To state the lemma, we require the following simple
deﬁnitions. A multiset R ⊂Rn is said to be measurable if Rk is measurable
for all k, where Rk denotes the set of those points in R having a ﬁxed multi-
plicity k. Given a measurable multiset R ⊂Rn, we deﬁne its volume in the
natural way; that is, Vol(R) = 
k k · Vol(Rk), where Vol(Rk) denotes the
usual Euclidean volume of Rk.
Lemma 9. Let R be a bounded, semi-algebraic multiset in Rn having max-
imum multiplicity m, where R is deﬁned by at most k polynomial inequalities
each having degree at most ℓ. Then the number of integer lattice points (counted
with multiplicity) contained in the region R is
Vol(R) + O(max{Vol( ¯R), 1}),
where Vol( ¯R) denotes the greatest d-dimensional volume of any projection of
R onto a coordinate subspace obtained by equating n −d coordinates to zero,
where d takes all values from 1 to n −1. The implied constant in the second
summand depends only on n, m, k, and ℓ.
Although Davenport states Lemma 9 only for compact semi-algebraic sets,
his proof adapts without essential change to the more general case of bounded
semi-algebraic multisets.
The following eﬀective special case of Lemma 9 will be particularly useful.
Lemma 10. Let c > 0, and let B be a closed box in Rn each of whose
faces is parallel to a coordinate hyperplane and each of whose edges has length
at least c. Then the number of integer points in B is at most C · Vol(B), where
C is an absolute constant depending only on c.

DISCRIMINANTS OF QUARTIC RINGS AND FIELDS
1043
The proof of Lemma 10 is trivial. Furthermore, it is easy to see that we
may take C = max{⌈c⌉/c, 1+1/⌈c⌉}n, with equality if and only if B is an
appropriately placed n-dimensional hypercube in Rn whose edges each have
length either c or ⌈c⌉(whichever gives the bigger value of C).
Notation.
In what follows, we use ϵ to denote any positive real number.
Thus we say “f(X) = O(X1+ϵ)” if f(X) = O(X1+ϵ) for any ϵ > 0.
2.4. Estimates on reducible pairs (A, B). In this section we describe the
relative frequencies with which absolutely irreducible elements sit inside various
parts of the multiset Fv, as v varies over the box H.
Lemma 11. Let v take a random value in H uniformly with respect to the
measure |Disc(v)|−1 dv. Then the expected number of absolutely irreducible ele-
ments (A, B) ∈Fv ∩VZ such that a11 = 0 and |Disc(A, B)| < X is O(X11/12).
Proof. Let V (0) denote the set of (A, B) ∈VR such that a11 = 0. Note
that if an element (A, B) ∈V (0) is absolutely irreducible, then we must have
b11 ̸= 0, for otherwise (1, 0, 0) ∈P2(Q) would be a common zero of A and B.
We wish to show that N(V (0); X), as deﬁned by (5), is O(X11/12). To
estimate N(V (0); X), we partition V (0) into two sets: V (0∗), consisting of
those elements (A, B) ∈V (0) for which a12 ̸= 0; and V (00), consisting of those
(A, B) where both a11 = a12 = 0. Then we have N(V (0); X) = N(V (0∗); X)+
N(V (00); X). We estimate the latter two terms in two cases.
Case I. N(V (0∗); X). In this case, estimate (8) becomes
N(V (0∗); X) ≪
 c
λ=X−1
12
 ∞
s1,s2,s3= 1
2
σ(V (0∗)) s−2
1 s−6
2 s−6
3 d×s d×λ,
(12)
where σ(V (0∗)) is at most the number of integer points in the box deﬁned by
the inequalities (10) together with the conditions
a11 = 0, |a12| ≥1, |b11| ≥1.
(13)
The number of integer points (a12, · · · , b33) ∈R11 satisfying the latter re-
quirements can be positive only if the quantities
60
λs1s2s2
3 and
60s1
λs4
2s2
3 are each
at least 1, since |a12|, |b11| ≥1. In that case, the conditions (10) and (13)
deﬁne a union of four boxes in R11, each of whose sidelengths is seen to be
bounded below by 2−11. By Lemma 10, it follows that the number of integer
points in B is bounded above by an absolute constant times Vol(B). Since
Vol(B) ≪λ−11s1s4
2s2
3, we have
σ(V (0∗)) ≪λ−11s1s4
2s2
3.
(14)

1044
MANJUL BHARGAVA
Equation (12) then implies
N(V (0∗); X) ≪
 c
λ=X−1
12
 ∞
s1,s2,s3= 1
2
λ−11s−1
1 s−2
2 s−4
3 d×s d×λ = O(X11/12)
(15)
as desired.
Case II. N(V (00); X). If we have (A, B) with a11 = a12 = 0 then a13 ̸= 0
and a22 ̸= 0, or else the cubic form invariant f(x, y) = Det(Ax −By) would
be reducible. Therefore, by estimate (8), the expected number of absolutely
irreducible elements (A, B) ∈V (00) with |Disc(A, B)| < X is
N(V (00); X) ≪
 c
λ=X−1
12
 ∞
s1,s2,s3= 1
2
σ(V (00)) s−2
1 s−6
2 s−6
3 d×s d×λ,
(16)
where σ(V (0∗)) is bounded above by the number of integer points in the box
deﬁned by the inequalities (10) and the conditions
a11 = 0, a12 = 0, |a13| ≥1, |a22| ≥1, |b11| ≥1.
(17)
The conditions (10) and (17) deﬁne a region B ⊂R10. This region can have
an integer point only if the quantities
60s3
λs1s2 ,
60s2
2
λs1s2
3 , and
60s1
λs4
2s2
3 are each at least
1. In that case, we observe that B is the union of eight boxes each of whose
sidelengths is at least 2−8. By Lemma 10, the number of integer points in B
is at most C(2−8) · Vol(B) ≪λ−10s2
1s5
2s4
3. Hence from (16) we have
N(V (00); X) ≪
 c
λ=X−1
12

s1,s2,s3
λ−10s−1
2 s−2
3 d×s d×λ = O(X10/12 log X),
(18)
since equations (10) and (17) together imply that s1 ≤60
λ ≤60X1/12. This
yields the lemma.
Thus, for the purposes of proving Theorem 7, we may assume that a11 ̸= 0.
Lemma 12. Let v ∈H. The number of (A, B) ∈Fv such that a11 ̸= 0,
|Disc(A, B)| < X, and f(x, y) = Det(Ax −By) is reducible is O(X11/12).
Proof. Any cubic ring R = R(f) of discriminant n such that f(x, y) is a
reducible cubic form sits in a unique cubic Q-algebra K = R ⊗Q ∼= Q ⊕F,
where F is a certain quadratic Q-algebra (indeed, F depends only on the
squarefree part of n). Let us write Disc(R) = k2Disc(K). Then the number of
quartic Q-algebras L having discriminant dividing Disc(R) = k2Disc(K), and
such that the cubic resolvent of L is K, is O(h∗
2(K)Disc(R)ϵ) by the work of
Baily [1].§ Since K is of the form Q ⊕F, where F is a quadratic Q-algebra,
§Although Baily states all results for “cubic ﬁelds”, it is clear that his arguments hold
also when every occurrence of “ﬁeld” is replaced by “´etale Q-algebra”.

DISCRIMINANTS OF QUARTIC RINGS AND FIELDS
1045
we have h∗
2(K) = O(Disc(K)ϵ) by genus theory. Hence the total number of
possibilities for the quartic Q-algebra L, given R = R(f), is O(Disc(R)ϵ).
Now any quartic ring Q such that the cubic resolvent ring of Q is R must
be an order in such an L, and the index of this order in OL (the ring of integers
of L) must divide k. In particular, for a ﬁxed choice of L the number of Q ⊆L
with Rres(Q) = R(f) is at most the number of orders of index k in OL. For
any integer k > 0, let EP(n) denote the product of all factors pe occurring in
the prime power decomposition of n such that e ≥8. Then it follows from a
result of Nakagawa [20, Theorem 1] that the number of orders of index k in
the ring of integers in an ´etale quartic Q-algebra L is at most O(EP(k2)1/4+ϵ),
independent of L.
Let s = 16/27. We divide the set S of reducible cubic forms f(x, y) into
two sets: S1, the set of all reducible cubic forms f with EP(Disc(f)) ≥Disc(f)s,
and S2, the set of all reducible cubic forms f with EP(Disc(f)) < Disc(f)s.
We treat ﬁrst the (A, B) ∈Fv with f(x, y) ∈S1 and |Disc(f)| < X. It is a
standard fact that the number of positive integers n < X such that EP(n) ≥ns
is O(X1−7
8s+ϵ). Furthermore, it is easy to see (see e.g., Datskovsky-Wright [11],
Nakagawa [21]) that the number of orders of a given index k in the maximal
order of a cubic Q-algebra K is at most O(k1/3+ϵ), independent of K; it follows
that the number of reducible f(x, y) with a given discriminant n is at most
O(n1/6+ϵ). Hence the total number of classes of reducible cubic forms f ∈S1
satisfying 0 < |Disc(f)| < X is at most O(X1−7
8s+ϵ · X
1
6+ϵ).
Finally, given an f ∈S1 with 0 < |Disc(f)| < X, the number of quartic
Q-algebras L of discriminant at most Disc(R(f)), such that the cubic resolvent
of L is K =R(f)⊗Q, is O(Disc(f)ϵ) = O(Xϵ); and the maximal number of or-
ders Q of index k in OL is at most O(EP(k2)1/4+ϵ) = O(X1/4+ϵ). We conclude
that the total number of (A, B) ∈Fv with f(x, y) ∈S1 and |Disc(f)| < X is
O(X1−7
8s+ϵ · X
1
6+ϵ · Xϵ · X
1
4+ϵ).
(19)
To similarly treat the (A, B) ∈Fv with f(x, y) ∈S2 and |Disc(f)| < X,
we may invoke a result of Davenport [13, Lemma 3], the proof of which implies
that the total number of reducible forms f(x, y) = ax3 + bx2y + cxy2 + dy3
arising from an (A, B) ∈Fv such that a ̸= 0 and |Disc(f)| < X is at most
O(X3/4+ϵ). In particular, the total number of such cubic forms f ∈S2 is at
most O(X3/4+ϵ). Now given an f ∈S2, the number of quartic Q-algebras L
having discriminant at most Disc(R(f)), such that the cubic resolvent of L is
K = R(f) ⊗Q, is O(Disc(f)ϵ) = O(Xϵ); and the number of orders Q of index
k in OL is at most O(EP(k2)1/4+ϵ) = O(k
1
2s+ϵ) = O(X
1
4s+ϵ). Therefore, the
total number of (A, B) ∈Fv with f(x, y) ∈S2, a ̸= 0, and |Disc(f)| < X is
O(X
3
4+ϵ · Xϵ · X
1
4s+ϵ).
(20)
Choosing s = 16/27 yields O(X97/108+ϵ) in both (19) and (20), and thus both
are O(X11/12).

1046
MANJUL BHARGAVA
It remains only to show that the number of (A, B) satisfying the conditions
of the lemma, for which a = Det(A) = 0, is also at most O(X11/12). To this
end, note that Det(A) = 0 is a quadratic equation in a23, with nonzero leading
coeﬃcient a11. It follows that once all entries of A except for a23 are ﬁxed,
then a23 too is determined up to at most two possibilities by the equation
Det(A) = 0.
Let S denote the set of all (A, B) ∈VZ such that Det(A) = 0, so that
the entry a23 of A is determined up to two possibilities by the other entries
of A. Then estimate (11) applies to N∗(S; X), where σ∗(S) is the number of
points in S in the region deﬁned by (10) but where we assume a23 takes values
in a set of cardinality at most two. Thus we may consider the 11-dimensional
region B deﬁned by (10) in the 11 variable entries of (A, B) excluding a23. This
region B can have an integer point only if
60
λs1s4
2s2
3 ≥1 (since |a11| must be at
least 1). In that case, B is seen to be a union of two boxes in R11 each of whose
sidelengths is at least 2−14; by Lemma 10, we have
σ∗(S) ≪2 · Vol(B) ≪2 · λ−11s1s−2
2 s−1
3
so that
N∗(S; X) ≪2
 c
λ=X−1
12
 ∞
s1,s2,s3= 1
2
λ−11s−1
1 s−8
2 s−7
3
d×s d×λ = O(X11/12),
as was desired.
Let T denote the set of twelve variables {aij, bij}.
Note that a11 ̸= 0
together with the estimate a2
11t = O(X1/3) for t ∈T (Lemma 8) shows that
t = O(X1/3)
for all t ∈T.
Lemma 13. Let v take a random value in H uniformly with respect to the
measure |Disc(v)|−1 dv. Then the expected number of integer points (A, B) ∈
Fv such that a11 ̸= 0, |Disc(A, B)| < X, and A and B have a common zero in
P2(Q) is O(X11/12+ϵ).
Proof. We introduce some simple notation that will be needed during the
course of the proof. First, let R1(y, z), R2(x, z), R3(x, y) denote the resultants
of the two quadratic forms A(x, y, z) and B(x, y, z) with respect to the variables
x, y, z respectively. The Ri’s are thus binary quartic forms.
Next, denote by A12(x, y), A13(x, z), A23(y, z) the binary quadratic forms
obtained from A(x, y, z) by setting z, y, x equal to zero respectively. Deﬁne
B12(x, y), B13(x, z), and B23(y, z) analogously.
Associate with these pairs
(A12, B12), (A13, B13), (A23, B23) of binary quadratic forms their discriminant
invariants D12, D13, D23 given by
Dij = Disc(Det(Aijx −Bijy)).

DISCRIMINANTS OF QUARTIC RINGS AND FIELDS
1047
Equivalently, Dij is the resultant of the binary quadratic forms Aij(x, y) and
Bij(x, y) with respect to y, divided by x4. The discriminants Dij are forms of
degree four in the entries of (A, B). We note also that D12 is the coeﬃcient
of x4 in R2(x, z) and of y4 in R1(y, z), with the analogous interpretations for
D13 and D23.
Now ﬁx v ∈H, and let (A, B) be an element in Fv with |Disc(A, B)| < X
for which A and B have a common rational zero (r, s, t) ∈P2(Q). We choose
r, s, t to be integers having no common factor. If there is more than one rational
zero, we choose (r, s, t) so that as many of the r, s, t are zero as possible.
We write r = (r, s)(r, t)r0, s = (r, s)(s, t)s0, t = (r, t)(s, t)t0, where (m, n)
denotes the greatest common divisor of m and n (set (m, 0) = (0, n) = 1 for
convenience).
Let us consider ﬁrst the case where rst ̸= 0 (so that A and B have no
common rational point in P2 with a coordinate equal to zero). To bound the
number of possibilities for (A, B) in this case, we examine the discriminants
D12, D13, D23.
If any of these discriminants, say D12, is equal to zero, then the corre-
sponding pair of quadratic forms (A12, B12) must have a common zero (r′, s′)
in P1. By assumption, this zero cannot be rational, for otherwise (r′, s′, 0)
would be a common rational zero of (A, B) having a zero coordinate. There-
fore, if D12 = 0, then A12, B12 possess the same pair of conjugate zeros (deﬁned
over some quadratic extension of Q), and thus A12 and B12 are scalar multi-
ples of each other. Pick u, v ∈Z such that uA12 −vB12 = 0. Then clearly
f(u, v) = Det(uA−vB) = 0, so that f(x, y) is reducible over Q. Such elements
(A, B) with f(x, y) reducible have already been handled, by Lemma 12.
We may therefore assume that D12 ̸= 0, D13 ̸= 0, and D23 ̸= 0. If all
aij, bij aside from possibly b23 are nonzero, then the estimate (Lemma 8)

t∈T\{b23}
t = O(X11/12)
(21)
implies that the number of nonzero choices for the variables in T \ {b23} is
O(X11/12+ϵ). If some elements of T \ {b23} are equal to 0, we may replace
those variables in (21) by a11, and the estimate still remains true by Lemma 8.
Thus the number of choices for the remaining nonzero variables in T is still
O(X11/12+ϵ).
Once the variables in T \ {b23} have been chosen, they also determine
the quantities D12 and D13, which by assumption are nonzero. Since the co-
eﬃcients of x4 in R3(x, y) and R2(x, z) are D12 and D13 respectively, and
R3(r, s) = R2(r, t) = 0, it follows that t0 and s0 divide D12 and D13 respec-
tively.
Thus the number of possibilities for s0 and t0 are bounded by the
number of factors of D12 and D13 respectively. Since D12D13 = O(X2/3) by
Lemma 8, the number of possibilities for s0, t0 is at most O(Xϵ). Now r divides

1048
MANJUL BHARGAVA
(the nonzero quantity) A23(s, t), and as A23(s, t) is clearly at most O(X2) in
absolute value, the number of choices for r is also at most O(Xϵ). The factors
(r, s), (r, t), and (s, t) are also determined up to O(Xϵ) choices, as they are
factors of r, r, and a11 respectively. Finally, since B(r, s, t) = 0, the value
of b23 is uniquely determined by T \ {b23}, r, s, and t. Hence the number of
choices for b23, given T \ {b23}, is at most O(Xϵ), and so the total number of
choices for T is O(X11/12+ϵ).
We consider next the cases where exactly one of r, s, t is equal to zero (so
that A and B do not have a common rational point in P2 with two coordinates
equal to zero).
If r = 0 and st ̸= 0, then
A23(s, t) = B23(s, t) = 0.
(22)
We can assume that at least one of a22, b22 (say b22) and at least one of a33,
b33 (say b33) is nonzero, for otherwise (0, 1, 0) or (0, 0, 1) would be a rational
zero of (A, B) with two zero coordinates. Since

t∈T\{a23,b23}
t = O(X10/12)
(23)
(where as before zero variables are replaced by a11), we see that the number
of choices for T \ {a23, b23} is bounded by O(X10/12+ϵ). Once these choices
are made, (22) implies that s divides b33 and t divides b22; hence the number
of possibilities for s and t is bounded by the number of factors of b33 and b22
respectively; so s and t can take at most O(Xϵ) values (since b22 and b33 are
both O(X1/3)). The values of a23 and b23 are then determined by T \{a23, b23},
r, s, and t. Thus the total number of possibilities for (A, B) in this case is
O(X10/12+ϵ).
The case s = 0, rt ̸= 0 is handled similarly; the equation (23) is simply
changed to
a11

t∈T\{a13,b13}
t = O(X11/12),
(24)
and we ﬁnd in conclusion that there are at most O(X11/12+ϵ) choices for (A, B)
in this case.
The case t = 0, rs ̸= 0 is a bit more diﬃcult. Proceeding in the same
manner, we ﬁnd a12 and b12 are determined up to O(Xϵ) possibilities once a11,
a22, b11, and b22 are ﬁxed. However, equation (24) now becomes
a2
11

t∈T\{a12,b12}
t = O(X12/12),
(25)
and this does not yield a satisfactory estimate. Nevertheless, we can still show
that the expected number of possibilities in this case, as v ranges over H, is at
most O(X10/12+ϵ).

DISCRIMINANTS OF QUARTIC RINGS AND FIELDS
1049
Indeed, let S denote the set of (A, B) ∈VZ such that A and B have a com-
mon zero of the form (r, s, 0) with rs ̸= 0, so that a12 and b12 are determined up
to O(Xϵ) possibilities by the remaining variables. Then estimate (11) applies
to N∗(S; X), where σ∗(S) is the number of points in S in the region deﬁned
by (10) but where we assume a12, b12 take values in sets of cardinality at most
O(Xϵ). Thus we may consider the 10-dimensional region B deﬁned by (10) in
the ten variables of T \{a12, b12}. This region B can have an integer point only
if
60
λs1s4
2s2
3 ≥1 (since |a11| must be at least 1). In that case, B is a union of two
boxes in R10 each of whose sidelengths is bounded from below; by Lemma 10,
we have
σ∗(S) ≪Vol(B)O(Xϵ)2 ≪λ−10s2
2s4
3O(Xϵ)
so that
N∗(S; X) ≪O(Xϵ)
 c
λ=X−1
12
 ∞
s1,s2,s3= 1
2
λ−10s−2
1 s−4
2 s−2
3
d×s d×λ = O(X10/12+ϵ).
We now consider the cases where exactly two of r, s, t are equal to zero.
This condition implies that either a11 = b11 = 0 (which does not occur by
hypothesis), a22 = b22 = 0, or a33 = b33 = 0.
If a33 = b33 = 0, then the estimate

t∈T\{a33,b33}
t = O(X10/12)
(26)
(again with variables equal to zero replaced by a11) shows that there are at
most O(X10/12+ϵ) possibilities for the variables in T.
Finally, suppose a22 = b22 = 0. We show that as v ranges over H, on
average one expects O(X10/12) values for (A, B) in this case. Let S denote
the set of (A, B) ∈VZ for which a22 = b22 = 0. Then we have as before the
estimate (11) for N∗(S; X). The value of σ∗(S) is the number of integer points
in the region deﬁned by (10) together with the condition a22 = b22 = 0. As
before, this deﬁnes a region B in R10 which—whenever it has an integer point—
becomes the union of two boxes whose edges are parallel to the coordinate axes
and whose lengths are bounded from below. Now Vol(B) ≪λ−10s−4
2 s4
3, so by
Lemma 10, we obtain
N∗(S; X) ≪
 c
λ=X−1
12
 ∞
s1,s2,s3= 1
2
λ−10s−2
1 s−10
2
s−2
3
d×s d×λ = O(X10/12).
This completes the proof of Lemma 13.
2.5. Cutting the cusps. Let 0 < δ < 1
12.
Lemma 14. Let v take a random value in H uniformly with respect to
the measure |Disc(v)|−1 dv. Then the expected number of (A, B) ∈Fv with
|Disc(A, B)| < X such that 0 < |a11| < Xδ is O(X11/12+δ).

1050
MANJUL BHARGAVA
Proof. We partition VR into ∪V (m), where V (m) denotes the subset of
VR such that |a11| = m. To handle N∗(V (m); X) for m ≥1, we use again
the estimate (11). In this case, the quantity σ∗(V (m)) is equal to the number
of integer points (A, B) satisfying the inequalities (10) and the condition that
|a11| = m. This set of integer points can be nonempty only if
60
s1s4
2s2
3 is at least
m. In that case, the region B deﬁned by (10) and |a11| = m is the union
of two 11-dimensional boxes (contained in the hyperplanes of VR deﬁned by
a11 = ±m) whose sidelengths are all bounded below by an absolute constant.
By Lemma 10,
σ∗(V (m)) ≪Vol(B) ≪λ−11s1s4
2s2
3.
Estimate (11) thus gives
N(V (m); X) ≪
 c
λ=X−1
12
 ∞
s1,s2,s3= 1
2
λ−11s−1
1 s−2
2 s−4
3 d×s d×λ = O(X11/12)
where the implied constant is independent of m. Hence
N∗(∪1≤m≤XδV (m); X) =
⌊Xδ⌋

m=1
N(V (m); X) = XδO(X11/12) = O(X11/12+δ),
as desired.
Lemma 15. Let v take any value in H ∩V (i). Let RX = RX(v) denote
the submultiset of points in Fv having absolute discriminant less than X, and
let R(δ)
X = {(A, B) ∈RX : |a11| ≥Xδ}. Then the number of integral elements
in R(δ)
X is
Vol(R(δ)
X ) + O(X1−δ+ϵ),
where Vol(R(δ)
X ) denotes the volume of the multiset R(δ)
X .
Proof. Let R(δ)
X
be as in the statement of the lemma. Then it is easy
to see that the region R(δ)
X
is bounded; indeed, the conditions |a11| ≥Xδ
and a3
11t = O(X1/3) imply that t = O(X1/3−3δ) for all t ∈T. Furthermore,
the various boundaries of R(δ)
X are deﬁned by a bounded number of algebraic
surfaces of bounded degree. By Lemma 9, it follows that the number of integer
points in the multiset R(δ)
X is
Vol(R(δ)
X ) + O(Vol( ¯R(δ)
X ))
(27)
where Vol( ¯R(δ)
X ) denotes the greatest r-dimensional volume of a projection of
R(δ)
X onto any of the r-dimensional coordinate subspaces (1 ≤r ≤11) in VR.
Let T again denote the set of twelve variables {aij, bij}, let T ′ be any
proper subset of T, and consider the projection of R(δ)
X onto the coordinate

DISCRIMINANTS OF QUARTIC RINGS AND FIELDS
1051
hyperplane ZT ′ given by
ZT ′ = {t = 0 : t ∈T \ T ′}.
We know by Lemma 8 that for (A, B) ∈R(δ)
X ,
|a11|12−|T ′| ·


t∈T ′
t
 < C1X
for some constant C1. Since |a11| ≥Xδ, and 12 −|T ′| ≥1, it follows that


t∈T ′
t
 < C1X1−δ.
(28)
Furthermore, we have seen that |a11| ≥Xδ implies that for any t ∈T ′,
|t| < C2X1/3
(29)
for some constant C2. Thus the projection of R(δ)
X onto ZT ′ is contained in the
|T ′|-dimensional region deﬁned by (28) and (29). This region is seen to have
volume at most
O(X1−δ+ϵ),
for any proper subset T ′ ⊂T.
Therefore, (27) implies that the number of integer points in R(δ)
X is given
by
Vol(R(δ)
X ) + O(X1−δ+ϵ),
(30)
where the implied constant may be chosen independently of v ∈H ∩V (i). This
is the desired conclusion.
Lemma 16. Let v take a random value in H ∩V (i) uniformly with respect
to the measure |Disc(v)|−1 dv, and let RX = RX(v) and R(δ)
X = R(δ)
X (v) be as
in Lemma 15. Then the expected size of Vol(RX) −Vol(R(δ)
X ) is O(X11/12+δ).
Proof. Let Ei(X) denote the expected value of Vol(RX(v))−Vol(R(δ)
X (v)),
as v varies over H ∩V (i). We may write
Ei(X) = 1
Mi

v∈V (i)

x=(A,B)∈RX (v)
|a11|<Xδ
Φ(v) dx |Disc(v)|−1dv,
(31)
where both dv and dx denote Euclidean measure on R12. Let us denote by
V (i)(δ, X) ⊂V (i) the set {(A, B) ∈V (i) : |a11| < Xδ, |Disc(A, B)| < X}.

1052
MANJUL BHARGAVA
Following (6)–(8) and the proof of Lemma 14, we then have
Ei(X) = c′
Mi

g∈F −1

x∈V (i)(δ,X)
Φ(gx) dx dg
≪

g∈KN ′A′−1Λ

x∈V (i)(δ,X)
Φ(kna−1λx) s−2
1 s−6
2 s−6
3
dx d×λ d×s dn dk
≪

λ, s1,s2,s3

x∈V (i)(δ,X)
Ψ

λ · a(s1, s2, s3)−1(A, B)

s−2
1 s−6
2 s−6
3
dx d×s d×λ
≪
 c
λ=X−1
12
 ∞
s1,s2,s3= 1
2
 Xδ
a11=−Xδλ−11s−1
1 s−2
2 s−4
3
da11 d×s d×λ
= O(X11/12+δ).
Choose δ = 1/24. Then Lemmas 11–16 yield
Proposition 17. Let v take a random value in H ∩V (i) uniformly with
respect to the measure |Disc(v)|−1 dv, and let RX = RX(v) denote the sub-
multiset of points in Fv having absolute discriminant less than X. Then the
expected number of absolutely irreducible integral elements in RX is
Vol(RX) + O(X23/24+ϵ).
Therefore, even though the total number of lattice points in RX far ex-
ceeds the volume of RX in general, the above proposition states that the
number of absolutely irreducible lattice points in RX will essentially be equal
to the volume as X →∞.
2.6. Computation of the fundamental volume. To prove Theorem 7, it
remains only to compute Vol(RX(v)), where RX(v) is deﬁned as in Lemma 15.
We will see that this volume depends only on whether v lies in V (0), V (1), or
V (2); here V (i) again denotes the GR-orbit in VR consisting of those elements
(A, B) for which A and B possess 4 −2i common zeros in P2(R).
Before performing this computation, we state ﬁrst some propositions re-
garding the group G = GL2 × SL3 and its 12-dimensional representation V .
Proposition 18. The group GR acts transitively on V (i), and the isotropy
groups for v ∈V (i) are given as follows:
(i)
S4, if v ∈V (0);
(ii) C2 × C2, if v ∈V (1); and
(iii) D4, if v ∈V (2).

DISCRIMINANTS OF QUARTIC RINGS AND FIELDS
1053
In view of Proposition 18, it is convenient to use the notation ni to denote
the order of the stabilizer of any vector v ∈V (i). Proposition 18 implies that
we have n0 = 24, n1 = 4, and n2 = 8.
Now deﬁne the usual subgroups K, A+, N, and ¯N of GR as follows:
K = {orthogonal transformations in GR};
A+ = {a(t) : t ∈R×4
+ }, where a(t) =

t1
t2

,
 t3
t4
(t3t4)−1

;
N = {n(u) : u ∈R4}, where n(u) =

1
u1
1

,

1
u2
1
u3
u4
1

;
¯N = {¯n(x) : x ∈R4}, where ¯n(x) =

1
x1
1

,
 1
x2
x3
1
x4
1

.
It is well-known that the natural product map K × A+ × N →GR is an
analytic diﬀeomorphism. In fact, for any g ∈GR, there exist unique k ∈K,
a = a(t1, . . . , t4) ∈A+, and n = n(u1, . . . , u4) ∈N such that g = k a n. In
particular, the element ¯n(x) ∈¯N can also be factored uniquely in this way;
the corresponding value of a is provided in the following proposition.
Proposition 19. Let ¯n(x1, . . . , x4) ∈¯N. Set
q = 1 + x2
1, r = 1 + x2
2 + (x2x4 −x3)2, s = 1 + x2
3 + x2
4.
Then ¯n = k a(t1, t2, t3, t4) n, where
t1 = 1/√q, t2 = √q, t3 = 1/√r, t4 = √r/√s.
Deﬁne an invariant measure dg on GR as follows. Choose an invariant
measure dk on K so that

K 1 dk = 1, and deﬁne

GR
f(g)dg =

K

R4

R×4
+
f(kna)d×t du dk
=

K

R4

R×4
+
t−1
1 t2t−4
3 t−2
4 f(kan)d×t du dk.
Let dy = dy1 dy2 · · · dy12 be the standard Euclidean measure on VR.
Proposition 20. For any f ∈L1(GR),

GR
f(g)dg =
1
32π3

R×4

R4

R4 f(¯n(x)n(u)a(t))dx du d×t.

1054
MANJUL BHARGAVA
Proof. We apply Proposition 19 to change variables, using the value of
the deﬁnite integral
 ∞
−∞
 ∞
−∞
 ∞
−∞
 ∞
−∞
1
qrs dx1 dx2 dx3 dx4 = 2π3.
Proposition 21. For i = 0, 1, or 2, let f ∈C0(V (i)), and let y denote
any element of V (i). Then

g∈GR
f(g · y)dg = ni
6π3

v∈V (i) |Disc(v)|−1f(v) dv.
Proof. It suﬃces to prove the equality for
y =




1
−1

,


−1
1



∈V (0),
y =




1
1
−1

,


1
1



∈V (1), or
y =




1
1

,


1
1



∈V (2).
Put
(z1, . . . , z12) = ¯n(x)n(u)a(t) · y.
Then the form Disc(z)−1dz1 ∧· · · ∧dz12 is a GR-invariant measure, and so we
must have
Disc(z)−1dz1 ∧· · · ∧dz12 = c dx ∧du ∧d×t
for some constant factor c. An explicit calculation shows that c = −3/16 in all
three cases. By Proposition 18, GR is an ni-fold covering of V (i) via the map
g →g · y, where ni = 24, 4, or 8 for i = 0, 1, or 2 respectively. Hence

GR
f(g · y)dg = ni ·
1
32π3 · 16
3

V (i) |Disc(v)|−1f(v)dv
= ni
6π3

V (i) |Disc(v)|−1f(v)dv,
as desired.

DISCRIMINANTS OF QUARTIC RINGS AND FIELDS
1055
Finally, for a vector vi ∈V (i), we obtain using Proposition 21 that
Vol(RX(vi)) = 6π3
ni
 X1/6
0
t6d×t ·

GZ\G1
R
dg
= 6π3
ni
· X
6 · ζ(2)
π
· ζ(2)ζ(3)
2π2
= ζ(2)2ζ(3)
2ni
X,
proving Theorem 7.
3. Pairs of ternary quadratic forms and Theorems 1–5
Theorem 6 and Theorem 7 together now immediately imply the following
Theorem 22. Let M∗(i)
4
(ξ, η) denote the number of isomorphism classes
of pairs (Q, R) such that Q is an order in an S4-quartic ﬁeld with 4 −2i real
embeddings, R is a cubic resolvent ring of Q, and ξ < Disc(Q) < η. Then
(a)
lim
X→∞
M∗(0)
4
(0, X)
X
= ζ(2)2ζ(3)
48
;
(b)
lim
X→∞
M∗(1)
4
(−X, 0)
X
= ζ(2)2ζ(3)
8
;
(c)
lim
X→∞
M∗(2)
4
(0, X)
X
= ζ(2)2ζ(3)
16
.
To obtain ﬁner asymptotic information on the distribution of quartic rings
(in particular, without the weighting by the number of cubic resolvents), we
need to be able to count absolutely irreducible GZ-equivalence classes in VZ
lying in certain subsets S ⊂VZ. If S is deﬁned, say, by ﬁnitely many congruence
conditions, then this can easily be done; we have
lim
X→∞
N(S ∩V (i); X)
X
= ζ(2)2ζ(3)
2ni

p
µp(S),
(32)
where µp(S) denotes the p-adic density of S in VZ, and ni = 24, 4, or 8 for
i = 0, 1, or 2 respectively. This reﬁnement of Theorem 7 is proved in exactly
the same way as the original theorem.
We recall from [3, §4.10], however, that the set S of elements (A, B) in
VZ corresponding to maximal orders is deﬁned by inﬁnitely many congruence
conditions. To prove that (32) still holds for such a set, we require a uniform
estimate on the error term when only ﬁnitely many factors are taken in (32).
This estimate is provided in Section 3.2.
In Section 3.3, we then use the
estimate to complete the proofs of Theorems 1–5.
3.1.
Nowhere overramiﬁed quartic ﬁelds.
Let Q be an order in an
S4-quartic ﬁeld, and let p ∈Z be a prime such that Q is maximal at p. We

1056
MANJUL BHARGAVA
say p is overramiﬁed in Q if (p) factors into primes in Q as P 4, P 2, or P 2
1 P 2
2 ;
similarly, the archimedean prime of Z (the “prime at inﬁnity”) is overramiﬁed
in Q if it factors into the product of two ramiﬁed places (i.e., if Q is totally
complex). A maximal quartic order Q (or the quartic ﬁeld K4 in which it lies)
is nowhere overramiﬁed if no prime of Z (ﬁnite or inﬁnite) is overramiﬁed in Q.
The signiﬁcance of being “nowhere overramiﬁed” is as follows. Given an
S4-quartic ﬁeld K4, let K24 denote its Galois closure. Let K3 denote a cubic
ﬁeld contained in K24 (the “cubic resolvent ﬁeld”), and let K6 be the unique
quadratic extension of K3 such that the Galois closure of K6 over Q is K24.
Then one checks that the quadratic extension K6/K3 is unramiﬁed precisely
when the quartic ﬁeld K4 is nowhere overramiﬁed.
Conversely, if K3 is a
noncyclic cubic ﬁeld, and K6 is an unramiﬁed quadratic extension of K3, then
the Galois closure of K6 is an S4-extension K24 which contains up to conjugacy
a unique, nowhere overramiﬁed quartic extension K4.
3.2. A uniformity estimate. Let us denote by Vp the set of all (A, B) ∈VZ
corresponding to quartic orders Q that are maximal at p and in which p is not
overramiﬁed. Let Wp = VZ −Vp. In order to apply a simple sieve to obtain
Theorems 1–5, we require the following proposition, analogous to Proposition 1
in [15] (though our proof is signiﬁcantly simpler).
Proposition 23. N(Wp ; X) = O(X/p2), where the implied constant is
independent of p.
Proof. The set Wp may be naturally partitioned into two subsets: W(1)
p ,
the set of points (A, B) ∈VZ corresponding to quartic rings not maximal at p;
and W(2)
p , the set of points (A, B) ∈VZ corresponding to quartic rings that are
maximal at p but also overramiﬁed at p.
We ﬁrst treat W(1)
p . We will need the following lemma.
Lemma 24. The number of maximal S4-quartic orders (equivalently, the
number of S4-quartic ﬁelds) having absolute discriminant less than X is O(X).
Lemma 24 follows immediately from Theorem 22, since we have shown
previously that every quartic ring has at least one cubic resolvent ring ([3,
Corollary 4]).
To estimate N(W (1)
p ; X) using Lemma 24, we wish to know for any mul-
tiple k of p that (a) the number of subrings of index k in a maximal quartic
ring Q is not too large relative to k; and (b) the number of cubic resolvents
that such a subring can possess is also not too large relative to k. For (a), a
much stronger result than we need has been proved by Nakagawa [20], whose
methods imply that the number of orders having index k =  pei
i in a maxi-
mal quartic ring Q is at most O( p(2+ϵ)⌊ei/4⌋
i
), where  pei
i denotes the prime

DISCRIMINANTS OF QUARTIC RINGS AND FIELDS
1057
power decomposition of k. Any such order will of course have discriminant
k2Disc(Q).
As for (b), we have shown in [3, Corollary 4] that the number of cubic
resolvents of a quartic ring having content n is σ(n), where σ denotes the
usual sum-of-divisors function. (Recall that the content of a quartic ring Q
is the largest integer n such that Q = Z + nQ′ for some quartic ring Q′.) In
particular, rings having content 1 possess a single cubic resolvent.
Since every content n quartic ring Q arises as Z+nQ′ for a unique content 1
quartic ring Q′, and Disc(Q) = n6 Disc(Q′), we conclude
N(W(1)
p ; X) <
∞

n=1
σ(n)
n6
 ∞

e=1
p(2+ϵ)⌊e/4⌋
p2e

q̸=p
 ∞

e=0
q(2+ϵ)⌊e/4⌋
q2e

O(X) = O(X/p2),
as desired.
We turn next to W(2)
p . Let us say a quadratic extension K6 of a noncyclic
cubic ﬁeld K3 is acceptable if the Galois closure of K6 over Q has Galois group
a transitive subgroup of S4. For a ﬁxed K3, let g(n) denote the number of
acceptable quadratic extensions whose conductor has absolute norm n.
To
estimate g(n), we require two lemmas. The ﬁrst lemma is due to Baily [1]:
Lemma 25 (Baily).
K6 is an acceptable quadratic extension of K3 if and
only if NK3/QDisc(K6/K3) is the square of an ideal in Z.
The next lemma gives an upper bound on the sum of h∗
2(K3) over all cubic
ﬁelds K3 having absolute discriminant less than X.
Lemma 26. We have

K3
h∗
2(K3) = O(X),
(33)
where the sum ranges over all cubic ﬁelds K3 having absolute discriminant less
than X.
Lemma 26 follows from Lemma 24 as Theorem 5 will follow from Theo-
rem 1.
Now it is a consequence of Lemma 25 that g(n) = 0 for nonsquare n. On
the other hand, for a square integer n = m2, class ﬁeld theory implies that
g(m2) < κ h∗
2(K3) 3ω(m),
(34)
where ω(m) denotes the number of prime factors of m, and κ is a constant
bounded independently of K3 (it corresponds to the even and inﬁnite places;
see [1] for details).

1058
MANJUL BHARGAVA
Lemma 26 and (34) now imply that, for some constant c′′,
N(W(2)
p ; X) ≤κ

K3

p|m
m2|Disc(K3)|<X
3ω(m)h∗
2(K3)
≤3κ

p2m2<X
3ω(m)

|Disc(K3)|<X/(p2m2)
h∗
2(K3)
≤3κc′′ X
p2

p2m2<X
3ω(m)
m2
< 3κc′′ X
p2

m
3ω(m)
m2 .
As the last sum converges absolutely, this concludes the proof of the proposi-
tion.
3.3. Proofs of Theorems 1–5.
Proof of Theorem 1.
As in [3], let Up denote the set of all (A, B) ∈VZ
that correspond to pairs (Q, R) for which Q is maximal at p, and let U = ∩pUp.
Then U is the set of (A, B) ∈VZ corresponding to maximal quartic rings Q.
In [3, Lemma 23], we determined the p-adic density µp(Up) of Up:
µp(Up) = (p −1)4 p (p + 1)2 (p2 + p + 1)(p3 + p2 + 2p + 1)/ p12.
(35)
Suppose Y is any positive integer. It follows from (32) and (35) that
lim
X→∞
N(i)(∩p<Y Up; X)
X
= ζ(2)2ζ(3)
2ni

p<Y
[p−12p (p2 −1)2(p3 −1)(p4 + p2 −p −1)],
where we use the notation N(i)(S; X) for N(S ∩V (i); X). Letting Y tend to
inﬁnity, we obtain immediately that
lim sup
X→∞
N(i)(U; X)
X
≤ζ(2)2ζ(3)
2ni

p
[p−12p (p2 −1)2(p3 −1)(p4 + p2 −p −1)]
= ζ(2)2ζ(3)
2ni

p
[(1 −p−2)2(1 −p−3)(1 + p−2 −p−3 −p−4)]
= 1
2ni

p
(1 + p−2 −p−3 −p−4).
To obtain a lower bound for N(i)(U; X), we note that

p<Y
Up ⊂(U ∪

p≥Y
Wp).

DISCRIMINANTS OF QUARTIC RINGS AND FIELDS
1059
Hence by Proposition 23,
lim
X→∞
N(i)(U; X)
X
≥ζ(2)2ζ(3)
2ni

p<Y
[p−12p (p2 −1)2(p3 −1)(p4 + p2 −p −1)] −O(

p≥Y
p−2).
Letting Y tend to inﬁnity completes the proof.
Proof of Theorem 2. We ﬁrst prove the analogue of Theorem 2 for the
set S of S4-quartic orders having content 1 (i.e., the primitive quartic orders);
on such quartic rings the correspondence of Theorem 6 is bijective. To this
end, let Sp denote the set of elements (A, B) ∈VZ having content prime to p,
so that S = ∩pSp. Then as noted in [3], an element (A, B) ∈VFp corresponds
to a quartic ring with content prime to p if and only if A and B are linearly
independent over Fp. It follows that
µp(Sp) = (p6 −1)(p6 −p)/p12.
The same argument as in the proof of Theorem 1 then shows that
lim
X→∞
N(i)(S; X)
X
= ζ(2)2ζ(3)
2ni

p
(1 −p−5)(1 −p−6) =
ζ(2)2ζ(3)
2ni ζ(5)ζ(6).
(36)
To obtain Theorem 2 from (36), we observe that every content 1 ring Q1
contains the content n ring Qn = Z + nQ1, and conversely, every content n
ring Qn arises from a unique content 1 ring Q1 in this way. Furthermore, if Q1
has discriminant D then Qn has discriminant n6D. It follows that
lim
X→∞
M(i)
4 (0, X)
X
=
∞

n=1
1
n6
ζ(2)2ζ(3)
2niζ(5)ζ(6) = ζ(2)2ζ(3)
2ni ζ(5) ,
as desired.
Proof of Theorem 3. It is known that the Artin symbol (K24/p) equals
⟨e⟩, ⟨(12)⟩, ⟨(123)⟩, ⟨(1234)⟩, and ⟨(12)(34)⟩precisely when the splitting type
of p in Q is (1111), (112), (13), (4), or (22) respectively, where Q denotes the
ring of integers in K4. As in [3], let Tp(σ) denote the set of all (A, B) ∈VZ that
correspond to quartic rings Q having a speciﬁed splitting type σ at p; then the
set of all such (A, B) ∈VZ corresponding to maximal quartic rings Q is given
by U ∩Tp(σ). Hence by the same argument as in the proof of Theorem 1, we
have
lim
X→∞X−1N(i)(U ∩Tp(σ); X) = µp(Tp(σ))

q̸=p
µq(Uq).
On the other hand, Lemma 21 of [3] gives the p-adic densities of Tp(σ) for all
splitting and ramiﬁcation types σ. In particular, the values of µp(Tp(σ)) for
σ = (1111), (112), (13), (4), or (22) occur in the ratio 1:6:8:6:3 for any value
of p; this is the desired result.

1060
MANJUL BHARGAVA
Proof of Theorem 4. By Theorem 1, the number of S4-quartic ﬁelds having
4 −2i real embeddings and absolute discriminant at most X is asymptotic to
ciX, where
c0 = .0253477143 . . . ,
c1 = .1520862858 . . . ,
c2 = .0760431429 . . . .
Thus the total number of S4-quartic ﬁelds with absolute discriminant at most
X is asymptotic to cX, where c = c0 + c1 + c2 = .2534771431 . . . .
The analogous constants for D4-quartic ﬁelds, as obtained in [7], are given
by
d0 = .0049278439 . . . ,
d1 = .0098556878 . . . ,
d2 = .0375424793 . . . ,
for a total of d = .0523260112 . . . .
It follows that the asymptotic proportion of S4-quartic ﬁelds among all
quartic ﬁelds having 4, 2, or 0 real embeddings, when ordering quartic ﬁelds
by absolute discriminant, is given by
c0
c0+d0 ≈83.723%,
c1
c1+d1 ≈93.914%, and
c2
c2+d2 ≈66.948% respectively, for an overall proportion of
c
c+d ≈82.889%.
This yields Theorem 4.
Proof of Theorem 5. Let V = ∩pVp be the set of all (A, B) ∈VZ corre-
sponding to nowhere overramiﬁed maximal quartic rings. Using [3, Lemma 23],
and the fact that Vp is simply the union of all Up(σ)’s where σ ̸= (14), (22), or
(1212), we obtain
µp(Vp) = p−12 p2 (p2 −1)2 (p3 −1)2.
(37)
By the same argument as in Theorem 1, we therefore get
Lemma 27. Let L(i)
4 (ξ, η) denote the number of nowhere overramiﬁed S4-
quartic ﬁelds K having 4 −2i real embeddings such that ξ < Disc(K) < η.
Then
(a)
lim
X→∞
L(0)
4 (0, X)
X
= ζ(2)2ζ(3)
48

p
µp(Vp)
= ζ(2)2ζ(3)
48
ζ(2)−2ζ(3)−2 = 1/(48ζ(3));
(b)
lim
X→∞
L(1)
4 (−X, 0)
X
= ζ(2)2ζ(3)
8

p
µp(Vp)
= ζ(2)2ζ(3)
8
ζ(2)−2ζ(3)−2 = 1/(8ζ(3)).
On the other hand, given a nowhere overramiﬁed S4-quartic ﬁeld K4 with
Galois closure K24, we have observed earlier that in K24 is contained a unique
(up to conjugacy) cubic ﬁeld K3 and a unique unramiﬁed extension K6 of K3.

DISCRIMINANTS OF QUARTIC RINGS AND FIELDS
1061
In addition, the discriminant of K4 is equal to the discriminant of K3, and the
number of quadruplets of quartic ﬁelds K4 corresponding to a given K3 in this
way equals h∗
2(K3) −1 (see Heilbronn [19] for full details). Therefore,

0<Disc(K3)<X
(h∗
2(K3) −1)
=
L(0)
4 (0, X),

−X<Disc(K3)<0
(h∗
2(K3) −1)
=
L(1)
4 (−X, 0).
(38)
Since Davenport and Heilbronn [15] have shown that
lim
X→∞

0<Disc(K3)<X 1
X
= 1/(12ζ(3)),
lim
X→∞

−X<Disc(K3)<0 1
X
=
1/(4ζ(3)),
(39)
we conclude
lim
X→∞

0<Disc(K3)<X h∗
2(K3)

0<Disc(K3)<X 1
= 1 + lim
X→∞
L(0)
4 (0, X)

0<Disc(K3)<X 1
= 1 + 1/(48ζ(3))
1/(12ζ(3))
=
5
4,
lim
X→∞

−X<Disc(K3)<0 h∗
2(K3)

−X<Disc(K3)<0 1
= 1 + lim
X→∞
L(1)
4 (−X, 0)

−X<Disc(K3)<0 1
= 1 + 1/(8ζ(3))
1/(4ζ(3))
=
3
2.
Acknowledgments.
This article is based on Chapter 5 of the author’s
Ph.D. thesis [2] at Princeton University. I am extremely grateful to my advisor
Andrew Wiles and to Peter Sarnak for all their enthusiasm, encouragement,
and guidance during this work. I am also very thankful to Karim Belabas,
Henri Cohen, Keith Conrad, Kiran Kedlaya, Hendrik Lenstra, Igor Rodni-
anski, Jean-Pierre Serre, and Don Zagier for many helpful conversations and
comments on earlier versions of this manuscript.
I extend my gratitude to the Hertz Foundation for funding this work, and
to the Clay Mathematics Institute for their subsequent support.
Clay Mathematics Institute, Cambridge, MA
Princeton University, Princeton, NJ
E-mail address:
bhargava@math.princeton.edu

1062
MANJUL BHARGAVA
References
[1]
A. M. Baily, On the density of discriminants of quartic ﬁelds, J. Reine Angew. Math.
315 (1980), 190–210.
[2]
M. Bhargava, Higher Composition Laws, Ph.D. Thesis, Princeton University, June 2001.
[3]
———, Higher composition laws III: The parametrization of quartic rings, Ann. of
Math. 159 (2004), 1329–1360.
[4]
———, Higher composition laws IV: The parametrization of quintic rings, Ann. of
Math., to appear.
[5]
———, The density of discriminants of quintic rings and ﬁelds, Ann. of Math., to
appear.
[6]
H. Cohen, F. Diaz y Diaz, and M. Olivier, A survey of discriminant counting, in Al-
gorithmic Number Theory (Sydney, 2002), Lecture Notes in Comput. Sci. 2369, 80–94,
Springer-Verlag, Berlin, 2002.
[7]
H. Cohen, F. Diaz y Diaz, and M. Olivier, Enumerating quartic dihedral extensions of
Q, Compositio Math. 133 (2002), 65–93.
[8]
H. Cohen and J. Martinet, ´Etude heuristique des groupes de classes des corps de nom-
bres, J. Reine Angew. Math. 404 (1990), 39–76.
[9]
———, Heuristics on class groups: some good primes are not too good, Math. Comp.
63 (1994), 329–334.
[10]
H. Cohn, The density of abelian cubic ﬁelds, Proc. Amer. Math. Soc. 5 (1954), 476–477.
[11]
B. Datskovsky and D. J. Wright, The adelic zeta function associated to the space of
binary cubic forms II: Local theory, J. Reine Angew. Math. 367 (1986), 27–75.
[12]
H. Davenport, On a principle of Lipschitz, J. London Math. Soc. 26 (1951), 179–183.
[13] ———, On the class-number of binary cubic forms I and II, J. London Math. Soc. 26
(1951), 183–198.
[14] ———, Corrigendum: “On a principle of Lipschitz”, J. London Math. Soc. 39 (1964),
580.
[15]
H. Davenport and H. Heilbronn, On the density of discriminants of cubic ﬁelds II, Proc.
Roy. Soc. London Ser. A 322 (1971), 405–420.
[16]
B. N. Delone and D. K. Faddeev, The Theory of Irrationalities of the Third Degree,
Translations of Mathematical Monographs 10, 1964, A.M.S., Providence, RI.
[17]
V. Ennola and R. Turunen, On totally real cubic ﬁelds, Math. Comp. 44 (1985), 495–
518.
[18]
G. W. Fung and H. C. Williams, On the computation of a table of complex cubic ﬁelds
with discriminant D > −106, Math. Comp. 55 (1990), 313–325.
[19]
H. Heilbronn, On the 2-classgroup of cubic ﬁelds, Studies in Pure Math. (1971), 117–
119.
[20]
J. Nakagawa, Orders of a Quartic Field, Mem. Amer. Math. Soc. 122 (1996), no. 583,
A.M.S., Providence, RI.
[21] ———, On the relations among the class numbers of binary cubic forms, Invent. Math.
134 (1998), 101–138.
[22]
M. Sato and T. Kimura, A classiﬁcation of irreducible prehomogeneous vector spaces
and their relative invariants, Nagoya Math. J. 65 (1977), 1–155.
[23]
M. Sato and T. Shintani, On zeta functions associated with prehomogeneous vector
spaces, Ann. of Math. 100 (1974), 131–170.

DISCRIMINANTS OF QUARTIC RINGS AND FIELDS
1063
[24]
A. Seidenberg, A new decision method for elementary algebra, Ann. of Math. 60 (1954),
365–374.
[25]
A. Tarski, A Decision Method for Elementary Algebra and Geometry, 2nd ed., revised,
Univ. of California Press, Berkeley and Los Angeles, Calif., 1951.
[26]
S. Wong, Automorphic forms on GL(2) and the rank of class groups, J. reine Angew.
Math. 515 (1999), 125–153.
[27]
D. J. Wright and A. Yukie, Prehomogeneous vector spaces and ﬁeld extensions, Invent.
Math. 110 (1992), 283–314.
[28]
A. Yukie, Shintani Zeta Functions, London Mathematical Society Lecture Note Series
183, Cambridge Univ. Press, Cambridge, 1993.
[29] ———, Density theorems for prehomogeneous vector spaces, preprint.
(Received June 7, 2004)

