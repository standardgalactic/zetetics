Annals of Mathematics, 162 (2005), 1031‚Äì1063
The density of discriminants
of quartic rings and Ô¨Åelds
By Manjul Bhargava
1. Introduction
The primary purpose of this article is to prove the following theorem.
Theorem 1. Let N(i)
4 (Œæ, Œ∑) denote the number of S4-quartic Ô¨Åelds K
having 4 ‚àí2i real embeddings such that Œæ < Disc(K) < Œ∑. Then
(a)
lim
X‚Üí‚àû
N(0)
4 (0, X)
X
=
1
48

p
(1 + p‚àí2 ‚àíp‚àí3 ‚àíp‚àí4);
(b)
lim
X‚Üí‚àû
N(1)
4 (‚àíX, 0)
X
=
1
8

p
(1 + p‚àí2 ‚àíp‚àí3 ‚àíp‚àí4);
(c)
lim
X‚Üí‚àû
N(2)
4 (0, X)
X
=
1
16

p
(1 + p‚àí2 ‚àíp‚àí3 ‚àíp‚àí4).
Several further results are obtained as by-products. First, our methods
enable us to count all orders in S4-quartic Ô¨Åelds.
Theorem 2. Let M(i)
4 (Œæ, Œ∑) denote the number of quartic orders O con-
tained in S4-quartic Ô¨Åelds having 4‚àí2i real embeddings such that Œæ<Disc(O)<Œ∑.
Then
(a)
lim
X‚Üí‚àû
M(0)
4 (0, X)
X
= Œ∂(2)2Œ∂(3)
48 Œ∂(5) ;
(b)
lim
X‚Üí‚àû
M(1)
4 (‚àíX, 0)
X
= Œ∂(2)2Œ∂(3)
8 Œ∂(5)
;
(c)
lim
X‚Üí‚àû
M(2)
4 (0, X)
X
= Œ∂(2)2Œ∂(3)
16 Œ∂(5) .
Second, the proof of Theorem 1 involves a determination of the densities
of various splitting types of primes in S4-quartic Ô¨Åelds. If K is an S4-quartic
Ô¨Åeld unramiÔ¨Åed at a prime p, and K24 denotes the Galois closure of K, then the

1032
MANJUL BHARGAVA
Artin symbol (K24/p) is deÔ¨Åned as a conjugacy class in S4, its values being ‚ü®e‚ü©,
‚ü®(12)‚ü©, ‚ü®(123)‚ü©, ‚ü®(1234)‚ü©, or ‚ü®(12)(34)‚ü©, where ‚ü®x‚ü©denotes the conjugacy class
of x in S4. It follows from the Chebotarev density theorem that for Ô¨Åxed K
and varying p (unramiÔ¨Åed in K), the values ‚ü®e‚ü©, ‚ü®(12)‚ü©, ‚ü®(123)‚ü©, ‚ü®(1234)‚ü©, and
‚ü®(12)(34)‚ü©occur with relative frequency 1 : 6 : 8 : 6 : 3. We prove the following
complement to Chebotarev density:
Theorem 3. Let p be a Ô¨Åxed prime, and let K run through all S4-quartic
Ô¨Åelds in which p does not ramify, the Ô¨Åelds being ordered by the size of the
discriminants. Then the Artin symbol (K24/p) takes the values ‚ü®e‚ü©, ‚ü®(12)‚ü©,
‚ü®(123)‚ü©, ‚ü®(1234)‚ü©, and ‚ü®(12)(34)‚ü©with relative frequency 1:6:8:6:3.
Actually, we do a little more: we determine for each prime p the density
of quartic Ô¨Åelds K in which p has the various possible ramiÔ¨Åcation types. For
instance, it follows from our methods that a proportion of precisely
(p+1)2
p3+p2+2p+1
of S4-quartic Ô¨Åelds are ramiÔ¨Åed at p.
Third, Theorem 1 implies that relatively many‚Äîin fact, a positive pro-
portion of!‚Äîquartic Ô¨Åelds do not have full Galois group S4. Indeed, it was
shown by Baily [1], using methods of class Ô¨Åeld theory, that the number of
D4-quartic Ô¨Åelds having absolute discriminant less than X is between c1X and
c2X for some constants c1 and c2. This result was recently reÔ¨Åned to an ex-
act asymptotic by Cohen, Diaz y Diaz, and Olivier [7], who showed that the
number of such D4-quartic Ô¨Åelds is ‚àºcX, where c ‚âà.052326 . . . . Moreover,
it has been shown by Baily [1] and Wong [26] that the contributions from the
Galois groups C4, K4, and A4 are negligible in comparison; i.e., the number
of quartic extensions having one of these Galois groups and absolute discrimi-
nant at most X is o(X) (in fact, O(X
7
8+œµ)). In conjunction with these results,
Theorem 1 implies:
Theorem 4. When ordered by absolute discriminant, a positive propor-
tion (approximately 17.111%) of quartic Ô¨Åelds have associated Galois group D4.
The remaining 82.889% of quartic Ô¨Åelds have Galois group S4.
As noted in [6], this is in stark contrast to the situation for polynomials,
since Hilbert showed that 100% of degree n polynomials (in an appropriate
sense) have Galois group Sn. Theorem 4 may be broken down by signature.
Among the quartic Ô¨Åelds having 0, 2, or 4 complex embeddings respectively,
the proportions having associated Galois group S4 are given by: 83.723%,
93.914%, and 66.948% respectively.
Finally, using a duality between quartic Ô¨Åelds and 2-class groups of cubic
Ô¨Åelds, we are able to determine the mean value of the size of the 2-class group
of both real and complex cubic Ô¨Åelds. More precisely, we prove

DISCRIMINANTS OF QUARTIC RINGS AND FIELDS
1033
Theorem 5. For a cubic Ô¨Åeld F, let h‚àó
2(F) denote the size of the exponent-
2 part of the class group of F. Then
(a)
lim
X‚Üí‚àû

F h‚àó
2(F)

F 1
= 5/4 ;
(1)
(b)
lim
X‚Üí‚àû

F h‚àó
2(F)

F 1
= 3/2 ,
(2)
where the sums range over cubic Ô¨Åelds F having discriminants in the ranges
(0, X) and (‚àíX, 0) respectively.
The theorem implies, in particular, that at least 75% of totally real cubic
Ô¨Åelds, and at least 50% of complex cubic Ô¨Åelds, have odd class number.
It is natural to compare the values 5/4 and 3/2 obtained in our theorem
with the corresponding values predicted by the Cohen-Martinet heuristics (the
analogues of the Cohen-Lenstra heuristics for noncyclic, higher degree Ô¨Åelds).
There has been much recent skepticism surrounding these heuristics (even by
Cohen-Martinet themselves; see [9]), since at the prime p = 2 they do not
seem to agree with existing computational data.‚àóIn light of this situation,
it is interesting to note that our Theorem 5 agrees exactly with the (original)
prediction of the Cohen-Martinet heuristics [8]. In particular, Theorem 5 is a
strong indication that, in the language of [8], the prime p = 2 is indeed ‚Äúgood‚Äù,
and the fact that Theorem 5 does not agree well with current computations is
due only to the extremely slow convergence of the limits (1) and (2).
The cubic analogues of Theorems 1, 3, and 5 for cubic Ô¨Åelds were obtained
in the well-known work of Davenport-Heilbronn [15]. Their methods relied
heavily on the remarkable discriminant-preserving correspondence between cu-
bic orders and equivalence classes of integral binary cubic forms, established by
Delone-Faddeev [16]. It seems, however, that Davenport-Heilbronn were not
aware of the work in [16], and derived the same correspondence for maximal
orders independently; had they known the general form of the Delone-Faddeev
parametrization, it would have been possible for them (using again the results
of Davenport [13]) simply to read oÔ¨Äthe cubic analogue of Theorem 2.‚Ä† Mean-
‚àóA computation of all real cubic Ô¨Åelds of discriminant less than 500000 ([17]) shows that
(
0<Disc(F )<500000 h‚àó
2(F))/(
0<Disc(F )<500000 1) equals about 1.09, a good deal less than
5/4; the analogous computation for complex cubic Ô¨Åelds of absolute discriminant less than
1000000 ([18]) yields approximately 1.30, a good deal less than 3/2!
‚Ä†We note the result here, since it seems not to have been stated previously in the literature.
Let M3(Œæ, Œ∑) denote the number of cubic orders O such that Œæ < Disc(O) < Œ∑. Then
lim
X‚Üí‚àû
M3(0, X)
X
= œÄ2/72,
lim
X‚Üí‚àû
M3(‚àíX, 0)
X
= œÄ2/24.

1034
MANJUL BHARGAVA
while, the cubic analogue of Theorem 4 may be obtained by combining the
work of Davenport-Heilbronn [15] with that of Cohn [10].‚Ä°
An important ingredient that allows us to extend the above cubic results
to the quartic case is a parametrization of quartic orders by means of two in-
tegral ternary quadratic forms up to the action of GL2(Z) √ó SL3(Z), which we
established in [3]. The proofs of Theorems 1‚Äì5 thus reduce to counting integer
points in certain 12-dimensional fundamental regions. We carry out this count-
ing in a hands-on manner similar to that of Davenport [13], although another
crucial ingredient in our work is a new averaging method which allows us to
deal more eÔ¨Éciently with points in the cusps of these fundamental regions. The
necessary point-counting is accomplished in Section 2. This counting result,
together with the results of [3], immediately yields the asymptotic density of
discriminants of pairs (Q, R), where Q is an order in an S4-quartic Ô¨Åeld and R
is a cubic resolvent of Q. Obtaining Theorems 1‚Äì5 from this general density
result then requires a sieving process which we carry out in Section 3.
The space of pairs of ternary quadratic forms that we use in this arti-
cle, as well as the space of binary cubic forms that was used in the work of
Davenport-Heilbronn, are both examples of what are known as prehomoge-
neous vector spaces. A prehomogeneous vector space is a pair (G, V ), where
G is a reductive group and V is a linear representation of G such that GC
has a Zariski open orbit on VC. The concept was introduced by Sato in the
1960‚Äôs, and a classiÔ¨Åcation of all prehomogeneous vector spaces was given in
the work of Sato-Kimura [22], while Sato-Shintani [23] developed a theory of
zeta functions associated to these spaces.
The connection between prehomogeneous vector spaces and Ô¨Åeld exten-
sions was Ô¨Årst studied systematically in the beautiful 1992 paper of Wright-
Yukie [27]. In that paper, they laid out a program to determine the density of
discriminants of number Ô¨Åelds of degree up to Ô¨Åve by considering adelic versions
of Sato-Shintani‚Äôs zeta functions as developed by Datskovsky and Wright [11]
in their work on cubic extensions. Despite looking very promising, the program
has not succeeded to date beyond the cubic case, although the global theory
of the adelic zeta function in the quartic case was developed in the impressive
1993 treatise of Yukie [28], which led to a conjectural determination of the
Euler products appearing in Theorem 1 (see [29]).
The reason that the zeta function method has required such a large amount
of work, and has thus presented some related diÔ¨Éculties, is that intrinsic to
the zeta function approach is a certain overcounting of quartic extensions.
SpeciÔ¨Åcally, even when one wishes to count only quartic Ô¨Åeld extensions of Q
having, say, Galois group S4, inherent in the zeta function is a sum over all
‚Ä°Their work implies that, when ordered by absolute discriminant, 100% of cubic Ô¨Åelds
have associated Galois group S3.

DISCRIMINANTS OF QUARTIC RINGS AND FIELDS
1035
‚Äú¬¥etale extensions‚Äù of Q, including the ‚Äúreducible‚Äù extensions that correspond
to direct sums of quadratic extensions.
These reducible quartic extensions
far outnumber the irreducible ones; indeed, the number of reducible quartic
extensions of absolute discriminant at most X is asymptotic to X log X, while
we show that the number of quartic Ô¨Åeld extensions of absolute discriminant
at most X is only O(X). This overcount results in the Shintani zeta function
having a double pole at s = 1 rather than a single pole. Removing this double
pole, in order to obtain the desired main term, has been the primary diÔ¨Éculty
with the zeta function method.
One way our viewpoint diÔ¨Äers from the adelic zeta function approach is
that we consider integer orbits as opposed to rational orbits. This turns out to
have a number of signiÔ¨Åcant advantages. First, the use of integer orbits enables
us to apply a convenient reduction theory in terms of Siegel sets. Within these
Siegel sets, we then determine which regions contain many irreducible points
and which do not. We prove that the cusps of the Siegel sets contain most
of the reducible points, while the main bodies of the Siegel sets contain most
of the irreducible points.
These geometric results allow us to separate the
irreducible orbits from the reducible ones from the very beginning, so that we
may proceed directly to the ‚Äúirreducible‚Äù integer orbits, where geometry-of-
numbers methods are applicable. The aforementioned diÔ¨Éculties arising from
overcounting are thus bypassed.
A second important advantage of using integer orbits in conjunction with
geometry-of-numbers arguments is that the resulting methods are very ele-
mentary and the treatment is relatively short. Finally, the use of integer orbits
enables us to count not only S4-quartic Ô¨Åelds but also all orders in S4-quartic
Ô¨Åelds.
Nevertheless, the adelic zeta function method, if completed in the future,
could lead to some interesting results to supplement Theorems 1‚Äì5. For ex-
ample, it may yield functional equations for the zeta function as well as a
precise determination of its poles, thus possibly leading to lower bounds on
Ô¨Årst order error terms in Theorem 1‚Äì5. It is also likely that the zeta function
methods together with the methods introduced here would lead to even further
applications in these and other directions.
We fully expect that the geometric methods introduced in this paper will
also prove useful in other contexts. For example, with only slight modiÔ¨Åcations,
the methods of this paper can also be used to derive the density of discriminants
of quintic orders and Ô¨Åelds. These and related results will appear in [4], [5].
We note that, in this paper, we always count quartic (and cubic) number
Ô¨Åelds up to isomorphism. Another natural way to count number Ô¨Åelds is as
subÔ¨Åelds of a Ô¨Åxed algebraic closure ¬ØQ of Q. It is easy to see that any iso-
morphism class of S4-quartic Ô¨Åeld corresponds to four conjugate subÔ¨Åelds of
¬ØQ, while an isomorphism class of D4-quartic Ô¨Åeld corresponds to two conju-

1036
MANJUL BHARGAVA
gate subÔ¨Åelds of ¬ØQ. Adopting the latter counting convention would therefore
multiply all constants in Theorems 1 and 2 by a factor of four. Moreover, the
proportion of S4-quartic Ô¨Åelds in Theorem 4 would then increase to 90.644%
(by signature: 91.141%, 96.862%, and 80.202%). Theorems 3 and 5, of course,
would remain unchanged.
2. On the class numbers of pairs of ternary quadratic forms
Let VR denote the space of pairs (A, B) of ternary quadratic forms over
the real numbers. We write an element (A, B) ‚ààVR as a pair of 3√ó3 symmetric
real matrices as follows:
2 ¬∑ (A, B) =
Ô£´
Ô£≠
Ô£Æ
Ô£∞
2a11
a12
a13
a12
2a22
a23
a13
a23
2a33
Ô£π
Ô£ª,
Ô£Æ
Ô£∞
2b11
b12
b13
b12
2b22
b23
b13
b23
2b33
Ô£π
Ô£ª
Ô£∂
Ô£∏.
(3)
Such a pair (A, B) is said to be integral if A and B are ‚Äúintegral‚Äù quadratic
forms, i.e., if aij, bij ‚ààZ.
The group GZ = GL2(Z)√óSL3(Z) acts naturally on the space VR. Namely,
an element g2 ‚ààGL2(Z) acts by changing the basis of the lattice of forms
spanned by (A, B); i.e., if g2 =
 r s
t u

, then g2 ¬∑ (A, B) = (rA + sB, tA + uB).
Similarly, an element g3 ‚ààSL3(Z) changes the basis of the three-dimensional
space on which the forms A and B take values; i.e., g3¬∑(A, B) = (g3Agt
3, g3Bgt
3).
It is clear that the actions of g2 and g3 commute, and that this action of GZ
preserves the lattice VZ consisting of the integral elements of VR.
The action of GZ on VR (or VZ) has a unique polynomial invariant. To
see this, notice Ô¨Årst that the action of GL3(Z) on V has four independent
polynomial invariants, namely the coeÔ¨Écients a, b, c, d of the binary cubic form
f(x, y) = f(A,B)(x, y) = 4 ¬∑ Det(Ax ‚àíBy),
where (A, B) ‚ààV .
We call f(x, y) the binary cubic form invariant of the
element (A, B) ‚ààV .
Next, GL2(Z) acts on the binary cubic form f(x, y), and it is well-known
that this action has exactly one polynomial invariant, namely the discriminant
Disc(f). Thus the unique polynomial invariant for the action of GZ on VZ is
Disc(4 ¬∑ Det(Ax ‚àíBy)). We call this fundamental invariant the discriminant
Disc(A, B) of the pair (A, B). (The factor 4 is included to insure that any pair
of integral ternary quadratic forms has integral discriminant.)
The orbits of GZ on VZ have an important arithmetic signiÔ¨Åcance. Recall
that a quartic ring is any ring that is isomorphic to Z4 as a Z-module; for
example, an order in a quartic number Ô¨Åeld is a quartic ring. In [3], we showed
how quartic rings may be parametrized in terms of the GZ-orbits on VZ:

DISCRIMINANTS OF QUARTIC RINGS AND FIELDS
1037
Theorem 6. There is a canonical bijection between the set of GZ-equiv-
alence classes of elements (A, B) ‚ààVZ and the set of isomorphism classes of
pairs (Q, R), where Q is a quartic ring and R is a cubic resolvent ring of Q.
Under this bijection, we have Disc(A, B) = Disc(Q) = Disc(R).
A cubic resolvent of a quartic ring Q is a cubic ring R equipped with a
certain quadratic resolvent mapping Q ‚ÜíR, whose precise deÔ¨Ånition will not
be needed here (see [3] for details). In view of Theorem 6, it is natural to try
to understand the number of GZ-orbits on VZ having absolute discriminant
at most X, as X ‚Üí‚àû. The number of integral orbits on VZ having a Ô¨Åxed
discriminant D is called a ‚Äúclass number‚Äù, and we wish to understand the
behavior of this class number on average.
From the point of view of Theorem 6, we would like to restrict the elements
of VZ under consideration to those which are ‚Äúirreducible‚Äù in an appropriate
sense. More precisely, we call a pair (A, B) of integral ternary quadratic forms
in VZ absolutely irreducible if
‚Ä¢ A and B do not possess a common zero as conics in P2(Q); and
‚Ä¢ the binary cubic form f(x, y) = Det(Ax ‚àíBy) is irreducible over Q.
Equivalently, (A, B) is absolutely irreducible if A and B possess a common zero
in P2 having Ô¨Åeld of deÔ¨Ånition K, where K is a quartic number Ô¨Åeld whose
Galois closure has Galois group either A4 or S4 over Q. In terms of Theorem 6,
absolutely irreducible elements in VZ correspond to pairs (Q, R) where Q is an
order in either an A4 or S4-quartic Ô¨Åeld. The main result of this section is the
following theorem:
Theorem 7. Let N(V (i)
Z ; X) denote the number of GZ-equivalence classes
of absolutely irreducible elements (A, B) ‚ààVZ having 4‚àí2i zeros in P2(R) and
satisfying |Disc(A, B)| < X. Then
(a)
lim
X‚Üí‚àû
N(V (0)
Z ; X)
X
= Œ∂(2)2Œ∂(3)
48
;
(b)
lim
X‚Üí‚àû
N(V (1)
Z ; X)
X
= Œ∂(2)2Œ∂(3)
8
;
(c)
lim
X‚Üí‚àû
N(V (2)
Z ; X)
X
= Œ∂(2)2Œ∂(3)
16
.
Theorem 7 is proved in several steps. In Subsection 2.1, we outline the
necessary reduction theory needed to establish some particularly useful funda-
mental domains for the action of GZ on VR. In Subsection 2.2, we describe a
new ‚Äúaveraging‚Äù method that allows one to eÔ¨Éciently count points in various
components of these fundamental domains in terms of their volumes. In Sub-
sections 2.3‚Äì2.5, we investigate the distribution of reducible and irreducible

1038
MANJUL BHARGAVA
integral points within these fundamental domains. The volumes of the result-
ing ‚Äúirreducible‚Äù components of these fundamental domains are then computed
in the Ô¨Ånal Subsection 2.6, proving Theorem 7.
In Section 3, we will show how similar counting methods‚Äîtogether with
a sieving process‚Äîcan be used to prove Theorems 1‚Äì5.
2.1.
Reduction theory.
The action of GR = GL2(R) √ó SL3(R) on VR
has three nondegenerate orbits V (0)
R , V (1)
R , V (2)
R , where V (i)
R
consists of those
elements (A, B) in VR having 4 ‚àí2i common zeros in P2(R).
We wish to
understand the number N(V (i)
Z ; X) of absolutely irreducible GZ-orbits on V (i)
Z
having absolute discriminant less than X (i = 0, 1, 2). We accomplish this by
counting the number of integer points of absolute discriminant less than X in
suitable fundamental domains for the action of GZ on VR.
These fundamental regions are constructed as follows. First, let F denote
a fundamental domain for the action of GZ on GR by left multiplication. We
may assume that F ‚äÇGR is semi-algebraic and connected, and that it is
contained in a standard Siegel set, i.e., F ‚äÇN‚Ä≤A‚Ä≤KŒõ, where
K = {orthogonal transformations in GR};
A‚Ä≤ = {a(t1, t2, t3) : 0 < t‚àí1
1
‚â§c1 t1, 0 < (t2t3)‚àí1 ‚â§c1 t2 ‚â§c2
1 t3},
where a(t1, t2, t3) =

t‚àí1
1
t1

,
 (t2t3)‚àí1
t2
t3

;
or
A‚Ä≤ = {a(s1, s2, s3) : s1 ‚â•1/‚àöc1, s2, s3 ‚â•1/ 3‚àöc1},
where a(s1, s2, s3) =

s‚àí1
1
s1

,
 s‚àí2
2 s‚àí1
3
s2s‚àí1
3
s2s2
3

;
N‚Ä≤ = {n(u1, u2, u3, u4) : |u1|, |u2|, |u3|, |u4| ‚â§c2},
where
n(u1, u2, u3, u4) =

1
u1
1

,

1
u2
1
u3
u4
1

;
Œõ = {Œª : Œª > 0},
where Œª acts by

Œª
Œª

,
 1
1
1

,
and c1, c2 are absolute constants. For example, the well-known fundamental
domains in GL2(R) and GL3(R) as constructed by Minkowski satisfy these
conditions for c1 = 2/
‚àö
3 and c2 = 1/2.
Next, for i = 0, 1, 2, let ni denote the cardinality of the stabilizer in GR
of any element v ‚ààV (i)
R . (One easily checks that ni = 24, 4, 8 for i = 0, 1, 2
respectively.) Then for any v ‚ààV (i)
R , Fv will be the union of ni fundamental

DISCRIMINANTS OF QUARTIC RINGS AND FIELDS
1039
domains for the action of GZ on V (i)
R .
Since this union is not necessarily
disjoint, Fv is best viewed as a multiset, where the multiplicity of a point x
in Fv is given by the cardinality of the set {g ‚ààF | gv = x}. Evidently, this
multiplicity is a number between 1 and ni.
Furthermore, since Fv is a polynomial image of a semi-algebraic set F,
the theorem of Tarski and Seidenberg on quantiÔ¨Åer elimination ([25], [24])
implies that Fv is a semi-algebraic multiset in VR; here by a semi-algebraic
multiset R we mean a multiset whose underlying subsets Rk of elements in
R having multiplicity k are semi-algebraic for all 1 ‚â§k < ‚àû.
The semi-
algebraicity of Fv will play an important role in what follows (cf. Lemmas 9
and 15).
For any v ‚ààV (i)
R , we have noted that the multiset Fv is the union of ni
fundamental domains for the action of GZ on V (i)
R . However, not all elements
in GZ\VZ will be represented in Fv exactly ni times. In general, the number of
times the GZ-equivalence class of an element x ‚ààVZ will occur in Fv is given
by ni/m(x), where m(x) denotes the size of the stabilizer of x in GZ. Since we
have shown in [3] that the stabilizer in GZ of an absolutely irreducible element
(A, B) ‚ààVZ is always trivial, we conclude that, for any v ‚ààV (i)
R , the product
ni ¬∑ N(V (i)
Z ; X) is exactly equal to the number of absolutely irreducible integer
points in Fv having absolute discriminant less than X.
Thus to estimate N(V (i)
Z ; X), it suÔ¨Éces to count the number of integer
points in Fv for some v ‚ààV (i)
R . The number of such integer points can be
diÔ¨Écult to count in a single such Fv (see e.g., [13], [2]), so instead we average
over many Fv by averaging over certain v lying in a box H.
2.2.
Averaging over fundamental domains.
Let H = {(A, B) ‚ààVR :
|aij|, |bij| ‚â§10 for all i, j; |Disc(A, B)| ‚â•1}, and let Œ¶ = Œ¶H denote the
characteristic function of H. Then since Fv is the union of ni fundamental
domains for the action of GZ on V (i) = V (i)
R , we have
(4)
N(V (i)
Z ; X)
=

v‚ààV (i) Œ¶(v) ¬∑ #{x ‚ààFv ‚à©V (i)
Z
abs. irr. : 0 < |Disc(x)| < X} |Disc(v)|‚àí1dv
ni ¬∑

v‚ààV (i) Œ¶(v) |Disc(v)|‚àí1dv
,
where points in Fv ‚à©V (i)
Z
are as usual counted according to their multiplicities
in Fv.
The denominator on the right-hand side of (4) is, by construction,
a Ô¨Ånite absolute constant Mi greater than zero. We have chosen to use the
measure |Disc(v)|‚àí1dv because it is a GR-invariant measure.
More generally, for any GZ-invariant set S ‚äÇVZ, we may speak of the
number N(S; X) of irreducible GZ-orbits on S having absolute discriminant
less than X. Then N(S; X) can be expressed similarly as

1040
MANJUL BHARGAVA
(5)
N(S; X)
=
2

i=0

v‚ààV (i) Œ¶(v) ¬∑ #{x ‚ààFv ‚à©S abs. irr. : 0 < |Disc(x)| < X} |Disc(v)|‚àí1dv
ni ¬∑

v‚ààV (i) Œ¶(v) |Disc(v)|‚àí1dv
.
We shall use this deÔ¨Ånition of N(S; X) for any S ‚äÇVZ, even if S is not
GZ-invariant.
Note that for disjoint S1, S2 ‚äÇVZ, we have N(S1 ‚à™S2) =
N(S1) + N(S2).
Using the fact that |Disc(v)|‚àí1dv is the unique GR-invariant measure on
V (i) (up to scaling), we may also express formula (5) for N(S; X) as an integral
over F‚àí1 ‚äÇGR. Let dg be a left-invariant Haar measure on GR, which is
uniquely deÔ¨Åned up to scaling. Then we may write
N(S; X)
=
2

i=0
1
Mi

v‚ààV (i)

x‚ààFv‚à©S abs. irr.
|Disc(x)|<X
Œ¶(v) |Disc(v)|‚àí1dv
=
2

i=0
c‚Ä≤
Mi

g‚ààF ‚àí1

x‚ààV (i)‚à©S abs. irr.
|Disc(x)|<X
Œ¶(gx) dg,
(6)
where c‚Ä≤ is an absolute constant depending only on the scaling of the Haar
measure dg. In particular, since F‚àí1 ‚äÇKA‚Ä≤‚àí1N‚Ä≤Œõ ‚äÇKN ‚Ä≤A‚Ä≤‚àí1Œõ, we have the
upper bound
N(S; X) ‚â™

g‚ààKN ‚Ä≤A‚Ä≤‚àí1Œõ

x‚ààS abs. irr.
|Disc(x)|<X
Œ¶(kna‚àí1Œªx) s‚àí2
1 s‚àí6
2 s‚àí6
3
d√óŒª d√ós dn dk.
(7)
Note that, in the latter integral, it suÔ¨Éces to restrict Œª ‚ààŒõ to within the range
[X‚àí1/12, c], where c = (max{|Disc(x)| : x ‚ààH})1/12 is an absolute constant.
Indeed, if x ‚ààS with 1 ‚â§|Disc(x)| < X and Œª is outside the range [X‚àí1/12, c],
then |Disc(kna‚àí1Œªx)| = Œª12|Disc(x)| will lie outside the range [1, c12]; in that
case, kna‚àí1Œªx /‚ààH and the integrand will be zero.
Now since K and N ‚Ä≤ are compact, there exists a compact set H‚Ä≤ such that
H‚Ä≤ ‚äÉN‚Ä≤KH. In fact, we may set
H‚Ä≤ = {(A, B) ‚ààVR : |aij|, |bij| ‚â§60 for all i, j; |Disc(A, B)| ‚â•1}
as it is easy to check that the latter set contains N‚Ä≤KH. Let Œ® denote the
characteristic function of H‚Ä≤. Then (7) implies
N(S; X) ‚â™
 c
Œª=X‚àí1
12
 ‚àû
s1,s2,s3= 1
2
œÉ(S) s‚àí2
1 s‚àí6
2 s‚àí6
3 d√ós d√óŒª,
(8)
where œÉ(S) = œÉ(S; Œª, s1, s2, s3) is given by
œÉ(S) =

(A,B)‚ààS abs. irr.
|Disc(A,B)|<X
Œ®

Œª ¬∑ a(s1, s2, s3)‚àí1(A, B)

.

DISCRIMINANTS OF QUARTIC RINGS AND FIELDS
1041
Noting that 2 Œª ¬∑ a(s1, s2, s3)‚àí1(A, B) is
(9)
 2 Œªs1s4
2s2
3a11
Œªs1s2s2
3a12
Œªs1s2s‚àí1
3 a13
Œªs1s2s2
3a12 2 Œªs1s‚àí2
2 s2
3a22 Œªs1s‚àí2
2 s‚àí1
3 a23
Œªs1s2s‚àí1
3 a13 Œªs1s‚àí2
2 s‚àí1
3 a23 2 Œªs1s‚àí2
2 s‚àí4
3 a33

,
 2 Œªs‚àí1
1 s4
2s2
3a11
Œªs‚àí1
1 s2s2
3a12
Œªs‚àí1
1 s2s‚àí1
3 a13
Œªs‚àí1
1 s2s2
3a12 2 Œªs‚àí1
1 s‚àí2
2 s2
3a22 Œªs‚àí1
1 s‚àí2
2 s‚àí1
3 a23
Œªs‚àí1
1 s2s‚àí1
3 a13 Œªs‚àí1
1 s‚àí2
2 s‚àí1
3 a23 2 Œªs‚àí1
1 s‚àí2
2 s‚àí4
3 a33

,
we see that Œª ¬∑ a(s1, s2, s3)‚àí1(A, B) will lie in H‚Ä≤ only if (A, B) lies in the box
deÔ¨Åned by the inequalities
(10)
|a11|‚â§
60
Œªs1s4
2s2
3 ; |a12|‚â§
60
Œªs1s2s2
3 ; |a13|‚â§60s3
Œªs1s2 ; |a22|‚â§60s2
2
Œªs1s2
3 ; |a23|‚â§60s2
2s3
Œªs1 ;
|a33|‚â§60s2
2s4
3
Œªs1 ;
|b11|‚â§60s1
Œªs4
2s2
3 ;
|b12|‚â§60s1
Œªs2s2
3 ;
|b13|‚â§60s1s3
Œªs2 ; |b22|‚â§60s1s2
2
Œªs2
3 ; |b23|‚â§60s1s2
2s3
Œª
; |b33|‚â§60s1s2
2s4
3
Œª
.
Hence œÉ(S) is at most the number of absolutely irreducible points in S lying
in the box (10). In practice, we will choose our sets S ‚äÇVZ for which it is easy
to estimate the number of points in S lying in the box (10). This will allow
for accurate estimates of N(S; X).
We note that the same counting method may be used even if we are
interested in counting both reducible and irreducible orbits in VZ. For any
set S ‚äÇVZ, let N‚àó(S; X) be deÔ¨Åned by (5), but where the phrase ‚Äúabs. irr.‚Äù
is removed. Thus for a GZ-invariant set S ‚äÇVZ, N‚àó(S; X) counts the total
number of GZ-orbits in S having absolute discriminant nonzero and less than
X (not just the irreducible ones). By the same reasoning, we have
N‚àó(S; X) ‚â™
 c
Œª=X‚àí1
12
 ‚àû
s1,s2,s3= 1
2
œÉ‚àó(S) s‚àí2
1 s‚àí6
2 s‚àí6
3 d√ós d√óŒª,
(11)
where œÉ‚àó(S) = œÉ(S; Œª, s1, s2, s3) denotes the number of integer points in S
satisfying (10).
The expression (5) for N(S; X), its analogue for N‚àó(S, X), the upper
bounds (8) and (11), and the inequalities (10) will be useful in the sections
that follow.
2.3. Preliminary estimates. We begin with some estimates that must be
satisÔ¨Åed by the coeÔ¨Écients of any element (A, B) ‚ààFv, where v ‚ààH.
Lemma 8. Let v ‚ààH. Suppose (A, B) ‚ààFv has entries given by (3) and
satisÔ¨Åes |Disc(A, B)| < X. Let S be any multiset consisting of elements of the
form aij or bij. Let m denote the number of a‚Äôs which occur in S, and let
n = |S| ‚àím denote the number of b‚Äôs; let i, j, and k = 2 |S| ‚àíi ‚àíj denote the
number of indices in S equal to 1, 2, and 3 respectively. If m ‚â•n, 2i ‚â•j + k,
and i + j ‚â•2k, then

s‚ààS
s = O(X|S|/12).

1042
MANJUL BHARGAVA
Proof. Note that Fv ‚äÇŒõ‚Ä≤N‚Ä≤A‚Ä≤Kv, where N‚Ä≤, A‚Ä≤, and K are as in Sec-
tion 2.1 and Œõ‚Ä≤ = {Œª ‚ààR : 0 < Œª < X1/12}. For a multiset S as in the lemma,
it is clear that the value of f = 
s‚ààS s is bounded on Kv, since K and H are
compact. Next, the values of f on A‚Ä≤Kv are simply sn‚àím
1
sj+k‚àí2i
2
s2k‚àíi‚àíj
3
times
the values of f on Kv. If m ‚â•n, 2i ‚â•j+k, and i+j ‚â•2k, then it is clear that
sn‚àím
1
sj+k‚àí2i
2
s2k‚àíi‚àíj
3
is absolutely bounded, and hence the values of f on A‚Ä≤Kv
are also bounded. Finally, N‚Ä≤ is compact, and it acts only by lower triangular
transformations; thus f also takes bounded values on N‚Ä≤A‚Ä≤Kv. Therefore, the
values of f on Œõ‚Ä≤N‚Ä≤A‚Ä≤Kv are at most O(X|S|/12) in size. This is the desired
conclusion.
Lemma 8 gives those estimates on the entries of (A, B) that follow imme-
diately from the fact that F is contained in a Siegel set.
The following two lemmas will also be useful. The Ô¨Årst is essentially due
to Davenport [12], [14]. To state the lemma, we require the following simple
deÔ¨Ånitions. A multiset R ‚äÇRn is said to be measurable if Rk is measurable
for all k, where Rk denotes the set of those points in R having a Ô¨Åxed multi-
plicity k. Given a measurable multiset R ‚äÇRn, we deÔ¨Åne its volume in the
natural way; that is, Vol(R) = 
k k ¬∑ Vol(Rk), where Vol(Rk) denotes the
usual Euclidean volume of Rk.
Lemma 9. Let R be a bounded, semi-algebraic multiset in Rn having max-
imum multiplicity m, where R is deÔ¨Åned by at most k polynomial inequalities
each having degree at most ‚Ñì. Then the number of integer lattice points (counted
with multiplicity) contained in the region R is
Vol(R) + O(max{Vol( ¬ØR), 1}),
where Vol( ¬ØR) denotes the greatest d-dimensional volume of any projection of
R onto a coordinate subspace obtained by equating n ‚àíd coordinates to zero,
where d takes all values from 1 to n ‚àí1. The implied constant in the second
summand depends only on n, m, k, and ‚Ñì.
Although Davenport states Lemma 9 only for compact semi-algebraic sets,
his proof adapts without essential change to the more general case of bounded
semi-algebraic multisets.
The following eÔ¨Äective special case of Lemma 9 will be particularly useful.
Lemma 10. Let c > 0, and let B be a closed box in Rn each of whose
faces is parallel to a coordinate hyperplane and each of whose edges has length
at least c. Then the number of integer points in B is at most C ¬∑ Vol(B), where
C is an absolute constant depending only on c.

DISCRIMINANTS OF QUARTIC RINGS AND FIELDS
1043
The proof of Lemma 10 is trivial. Furthermore, it is easy to see that we
may take C = max{‚åàc‚åâ/c, 1+1/‚åàc‚åâ}n, with equality if and only if B is an
appropriately placed n-dimensional hypercube in Rn whose edges each have
length either c or ‚åàc‚åâ(whichever gives the bigger value of C).
Notation.
In what follows, we use œµ to denote any positive real number.
Thus we say ‚Äúf(X) = O(X1+œµ)‚Äù if f(X) = O(X1+œµ) for any œµ > 0.
2.4. Estimates on reducible pairs (A, B). In this section we describe the
relative frequencies with which absolutely irreducible elements sit inside various
parts of the multiset Fv, as v varies over the box H.
Lemma 11. Let v take a random value in H uniformly with respect to the
measure |Disc(v)|‚àí1 dv. Then the expected number of absolutely irreducible ele-
ments (A, B) ‚ààFv ‚à©VZ such that a11 = 0 and |Disc(A, B)| < X is O(X11/12).
Proof. Let V (0) denote the set of (A, B) ‚ààVR such that a11 = 0. Note
that if an element (A, B) ‚ààV (0) is absolutely irreducible, then we must have
b11 Ã∏= 0, for otherwise (1, 0, 0) ‚ààP2(Q) would be a common zero of A and B.
We wish to show that N(V (0); X), as deÔ¨Åned by (5), is O(X11/12). To
estimate N(V (0); X), we partition V (0) into two sets: V (0‚àó), consisting of
those elements (A, B) ‚ààV (0) for which a12 Ã∏= 0; and V (00), consisting of those
(A, B) where both a11 = a12 = 0. Then we have N(V (0); X) = N(V (0‚àó); X)+
N(V (00); X). We estimate the latter two terms in two cases.
Case I. N(V (0‚àó); X). In this case, estimate (8) becomes
N(V (0‚àó); X) ‚â™
 c
Œª=X‚àí1
12
 ‚àû
s1,s2,s3= 1
2
œÉ(V (0‚àó)) s‚àí2
1 s‚àí6
2 s‚àí6
3 d√ós d√óŒª,
(12)
where œÉ(V (0‚àó)) is at most the number of integer points in the box deÔ¨Åned by
the inequalities (10) together with the conditions
a11 = 0, |a12| ‚â•1, |b11| ‚â•1.
(13)
The number of integer points (a12, ¬∑ ¬∑ ¬∑ , b33) ‚ààR11 satisfying the latter re-
quirements can be positive only if the quantities
60
Œªs1s2s2
3 and
60s1
Œªs4
2s2
3 are each
at least 1, since |a12|, |b11| ‚â•1. In that case, the conditions (10) and (13)
deÔ¨Åne a union of four boxes in R11, each of whose sidelengths is seen to be
bounded below by 2‚àí11. By Lemma 10, it follows that the number of integer
points in B is bounded above by an absolute constant times Vol(B). Since
Vol(B) ‚â™Œª‚àí11s1s4
2s2
3, we have
œÉ(V (0‚àó)) ‚â™Œª‚àí11s1s4
2s2
3.
(14)

1044
MANJUL BHARGAVA
Equation (12) then implies
N(V (0‚àó); X) ‚â™
 c
Œª=X‚àí1
12
 ‚àû
s1,s2,s3= 1
2
Œª‚àí11s‚àí1
1 s‚àí2
2 s‚àí4
3 d√ós d√óŒª = O(X11/12)
(15)
as desired.
Case II. N(V (00); X). If we have (A, B) with a11 = a12 = 0 then a13 Ã∏= 0
and a22 Ã∏= 0, or else the cubic form invariant f(x, y) = Det(Ax ‚àíBy) would
be reducible. Therefore, by estimate (8), the expected number of absolutely
irreducible elements (A, B) ‚ààV (00) with |Disc(A, B)| < X is
N(V (00); X) ‚â™
 c
Œª=X‚àí1
12
 ‚àû
s1,s2,s3= 1
2
œÉ(V (00)) s‚àí2
1 s‚àí6
2 s‚àí6
3 d√ós d√óŒª,
(16)
where œÉ(V (0‚àó)) is bounded above by the number of integer points in the box
deÔ¨Åned by the inequalities (10) and the conditions
a11 = 0, a12 = 0, |a13| ‚â•1, |a22| ‚â•1, |b11| ‚â•1.
(17)
The conditions (10) and (17) deÔ¨Åne a region B ‚äÇR10. This region can have
an integer point only if the quantities
60s3
Œªs1s2 ,
60s2
2
Œªs1s2
3 , and
60s1
Œªs4
2s2
3 are each at least
1. In that case, we observe that B is the union of eight boxes each of whose
sidelengths is at least 2‚àí8. By Lemma 10, the number of integer points in B
is at most C(2‚àí8) ¬∑ Vol(B) ‚â™Œª‚àí10s2
1s5
2s4
3. Hence from (16) we have
N(V (00); X) ‚â™
 c
Œª=X‚àí1
12

s1,s2,s3
Œª‚àí10s‚àí1
2 s‚àí2
3 d√ós d√óŒª = O(X10/12 log X),
(18)
since equations (10) and (17) together imply that s1 ‚â§60
Œª ‚â§60X1/12. This
yields the lemma.
Thus, for the purposes of proving Theorem 7, we may assume that a11 Ã∏= 0.
Lemma 12. Let v ‚ààH. The number of (A, B) ‚ààFv such that a11 Ã∏= 0,
|Disc(A, B)| < X, and f(x, y) = Det(Ax ‚àíBy) is reducible is O(X11/12).
Proof. Any cubic ring R = R(f) of discriminant n such that f(x, y) is a
reducible cubic form sits in a unique cubic Q-algebra K = R ‚äóQ ‚àº= Q ‚äïF,
where F is a certain quadratic Q-algebra (indeed, F depends only on the
squarefree part of n). Let us write Disc(R) = k2Disc(K). Then the number of
quartic Q-algebras L having discriminant dividing Disc(R) = k2Disc(K), and
such that the cubic resolvent of L is K, is O(h‚àó
2(K)Disc(R)œµ) by the work of
Baily [1].¬ß Since K is of the form Q ‚äïF, where F is a quadratic Q-algebra,
¬ßAlthough Baily states all results for ‚Äúcubic Ô¨Åelds‚Äù, it is clear that his arguments hold
also when every occurrence of ‚ÄúÔ¨Åeld‚Äù is replaced by ‚Äú¬¥etale Q-algebra‚Äù.

DISCRIMINANTS OF QUARTIC RINGS AND FIELDS
1045
we have h‚àó
2(K) = O(Disc(K)œµ) by genus theory. Hence the total number of
possibilities for the quartic Q-algebra L, given R = R(f), is O(Disc(R)œµ).
Now any quartic ring Q such that the cubic resolvent ring of Q is R must
be an order in such an L, and the index of this order in OL (the ring of integers
of L) must divide k. In particular, for a Ô¨Åxed choice of L the number of Q ‚äÜL
with Rres(Q) = R(f) is at most the number of orders of index k in OL. For
any integer k > 0, let EP(n) denote the product of all factors pe occurring in
the prime power decomposition of n such that e ‚â•8. Then it follows from a
result of Nakagawa [20, Theorem 1] that the number of orders of index k in
the ring of integers in an ¬¥etale quartic Q-algebra L is at most O(EP(k2)1/4+œµ),
independent of L.
Let s = 16/27. We divide the set S of reducible cubic forms f(x, y) into
two sets: S1, the set of all reducible cubic forms f with EP(Disc(f)) ‚â•Disc(f)s,
and S2, the set of all reducible cubic forms f with EP(Disc(f)) < Disc(f)s.
We treat Ô¨Årst the (A, B) ‚ààFv with f(x, y) ‚ààS1 and |Disc(f)| < X. It is a
standard fact that the number of positive integers n < X such that EP(n) ‚â•ns
is O(X1‚àí7
8s+œµ). Furthermore, it is easy to see (see e.g., Datskovsky-Wright [11],
Nakagawa [21]) that the number of orders of a given index k in the maximal
order of a cubic Q-algebra K is at most O(k1/3+œµ), independent of K; it follows
that the number of reducible f(x, y) with a given discriminant n is at most
O(n1/6+œµ). Hence the total number of classes of reducible cubic forms f ‚ààS1
satisfying 0 < |Disc(f)| < X is at most O(X1‚àí7
8s+œµ ¬∑ X
1
6+œµ).
Finally, given an f ‚ààS1 with 0 < |Disc(f)| < X, the number of quartic
Q-algebras L of discriminant at most Disc(R(f)), such that the cubic resolvent
of L is K =R(f)‚äóQ, is O(Disc(f)œµ) = O(Xœµ); and the maximal number of or-
ders Q of index k in OL is at most O(EP(k2)1/4+œµ) = O(X1/4+œµ). We conclude
that the total number of (A, B) ‚ààFv with f(x, y) ‚ààS1 and |Disc(f)| < X is
O(X1‚àí7
8s+œµ ¬∑ X
1
6+œµ ¬∑ Xœµ ¬∑ X
1
4+œµ).
(19)
To similarly treat the (A, B) ‚ààFv with f(x, y) ‚ààS2 and |Disc(f)| < X,
we may invoke a result of Davenport [13, Lemma 3], the proof of which implies
that the total number of reducible forms f(x, y) = ax3 + bx2y + cxy2 + dy3
arising from an (A, B) ‚ààFv such that a Ã∏= 0 and |Disc(f)| < X is at most
O(X3/4+œµ). In particular, the total number of such cubic forms f ‚ààS2 is at
most O(X3/4+œµ). Now given an f ‚ààS2, the number of quartic Q-algebras L
having discriminant at most Disc(R(f)), such that the cubic resolvent of L is
K = R(f) ‚äóQ, is O(Disc(f)œµ) = O(Xœµ); and the number of orders Q of index
k in OL is at most O(EP(k2)1/4+œµ) = O(k
1
2s+œµ) = O(X
1
4s+œµ). Therefore, the
total number of (A, B) ‚ààFv with f(x, y) ‚ààS2, a Ã∏= 0, and |Disc(f)| < X is
O(X
3
4+œµ ¬∑ Xœµ ¬∑ X
1
4s+œµ).
(20)
Choosing s = 16/27 yields O(X97/108+œµ) in both (19) and (20), and thus both
are O(X11/12).

1046
MANJUL BHARGAVA
It remains only to show that the number of (A, B) satisfying the conditions
of the lemma, for which a = Det(A) = 0, is also at most O(X11/12). To this
end, note that Det(A) = 0 is a quadratic equation in a23, with nonzero leading
coeÔ¨Écient a11. It follows that once all entries of A except for a23 are Ô¨Åxed,
then a23 too is determined up to at most two possibilities by the equation
Det(A) = 0.
Let S denote the set of all (A, B) ‚ààVZ such that Det(A) = 0, so that
the entry a23 of A is determined up to two possibilities by the other entries
of A. Then estimate (11) applies to N‚àó(S; X), where œÉ‚àó(S) is the number of
points in S in the region deÔ¨Åned by (10) but where we assume a23 takes values
in a set of cardinality at most two. Thus we may consider the 11-dimensional
region B deÔ¨Åned by (10) in the 11 variable entries of (A, B) excluding a23. This
region B can have an integer point only if
60
Œªs1s4
2s2
3 ‚â•1 (since |a11| must be at
least 1). In that case, B is seen to be a union of two boxes in R11 each of whose
sidelengths is at least 2‚àí14; by Lemma 10, we have
œÉ‚àó(S) ‚â™2 ¬∑ Vol(B) ‚â™2 ¬∑ Œª‚àí11s1s‚àí2
2 s‚àí1
3
so that
N‚àó(S; X) ‚â™2
 c
Œª=X‚àí1
12
 ‚àû
s1,s2,s3= 1
2
Œª‚àí11s‚àí1
1 s‚àí8
2 s‚àí7
3
d√ós d√óŒª = O(X11/12),
as was desired.
Let T denote the set of twelve variables {aij, bij}.
Note that a11 Ã∏= 0
together with the estimate a2
11t = O(X1/3) for t ‚ààT (Lemma 8) shows that
t = O(X1/3)
for all t ‚ààT.
Lemma 13. Let v take a random value in H uniformly with respect to the
measure |Disc(v)|‚àí1 dv. Then the expected number of integer points (A, B) ‚àà
Fv such that a11 Ã∏= 0, |Disc(A, B)| < X, and A and B have a common zero in
P2(Q) is O(X11/12+œµ).
Proof. We introduce some simple notation that will be needed during the
course of the proof. First, let R1(y, z), R2(x, z), R3(x, y) denote the resultants
of the two quadratic forms A(x, y, z) and B(x, y, z) with respect to the variables
x, y, z respectively. The Ri‚Äôs are thus binary quartic forms.
Next, denote by A12(x, y), A13(x, z), A23(y, z) the binary quadratic forms
obtained from A(x, y, z) by setting z, y, x equal to zero respectively. DeÔ¨Åne
B12(x, y), B13(x, z), and B23(y, z) analogously.
Associate with these pairs
(A12, B12), (A13, B13), (A23, B23) of binary quadratic forms their discriminant
invariants D12, D13, D23 given by
Dij = Disc(Det(Aijx ‚àíBijy)).

DISCRIMINANTS OF QUARTIC RINGS AND FIELDS
1047
Equivalently, Dij is the resultant of the binary quadratic forms Aij(x, y) and
Bij(x, y) with respect to y, divided by x4. The discriminants Dij are forms of
degree four in the entries of (A, B). We note also that D12 is the coeÔ¨Écient
of x4 in R2(x, z) and of y4 in R1(y, z), with the analogous interpretations for
D13 and D23.
Now Ô¨Åx v ‚ààH, and let (A, B) be an element in Fv with |Disc(A, B)| < X
for which A and B have a common rational zero (r, s, t) ‚ààP2(Q). We choose
r, s, t to be integers having no common factor. If there is more than one rational
zero, we choose (r, s, t) so that as many of the r, s, t are zero as possible.
We write r = (r, s)(r, t)r0, s = (r, s)(s, t)s0, t = (r, t)(s, t)t0, where (m, n)
denotes the greatest common divisor of m and n (set (m, 0) = (0, n) = 1 for
convenience).
Let us consider Ô¨Årst the case where rst Ã∏= 0 (so that A and B have no
common rational point in P2 with a coordinate equal to zero). To bound the
number of possibilities for (A, B) in this case, we examine the discriminants
D12, D13, D23.
If any of these discriminants, say D12, is equal to zero, then the corre-
sponding pair of quadratic forms (A12, B12) must have a common zero (r‚Ä≤, s‚Ä≤)
in P1. By assumption, this zero cannot be rational, for otherwise (r‚Ä≤, s‚Ä≤, 0)
would be a common rational zero of (A, B) having a zero coordinate. There-
fore, if D12 = 0, then A12, B12 possess the same pair of conjugate zeros (deÔ¨Åned
over some quadratic extension of Q), and thus A12 and B12 are scalar multi-
ples of each other. Pick u, v ‚ààZ such that uA12 ‚àívB12 = 0. Then clearly
f(u, v) = Det(uA‚àívB) = 0, so that f(x, y) is reducible over Q. Such elements
(A, B) with f(x, y) reducible have already been handled, by Lemma 12.
We may therefore assume that D12 Ã∏= 0, D13 Ã∏= 0, and D23 Ã∏= 0. If all
aij, bij aside from possibly b23 are nonzero, then the estimate (Lemma 8)

t‚ààT\{b23}
t = O(X11/12)
(21)
implies that the number of nonzero choices for the variables in T \ {b23} is
O(X11/12+œµ). If some elements of T \ {b23} are equal to 0, we may replace
those variables in (21) by a11, and the estimate still remains true by Lemma 8.
Thus the number of choices for the remaining nonzero variables in T is still
O(X11/12+œµ).
Once the variables in T \ {b23} have been chosen, they also determine
the quantities D12 and D13, which by assumption are nonzero. Since the co-
eÔ¨Écients of x4 in R3(x, y) and R2(x, z) are D12 and D13 respectively, and
R3(r, s) = R2(r, t) = 0, it follows that t0 and s0 divide D12 and D13 respec-
tively.
Thus the number of possibilities for s0 and t0 are bounded by the
number of factors of D12 and D13 respectively. Since D12D13 = O(X2/3) by
Lemma 8, the number of possibilities for s0, t0 is at most O(Xœµ). Now r divides

1048
MANJUL BHARGAVA
(the nonzero quantity) A23(s, t), and as A23(s, t) is clearly at most O(X2) in
absolute value, the number of choices for r is also at most O(Xœµ). The factors
(r, s), (r, t), and (s, t) are also determined up to O(Xœµ) choices, as they are
factors of r, r, and a11 respectively. Finally, since B(r, s, t) = 0, the value
of b23 is uniquely determined by T \ {b23}, r, s, and t. Hence the number of
choices for b23, given T \ {b23}, is at most O(Xœµ), and so the total number of
choices for T is O(X11/12+œµ).
We consider next the cases where exactly one of r, s, t is equal to zero (so
that A and B do not have a common rational point in P2 with two coordinates
equal to zero).
If r = 0 and st Ã∏= 0, then
A23(s, t) = B23(s, t) = 0.
(22)
We can assume that at least one of a22, b22 (say b22) and at least one of a33,
b33 (say b33) is nonzero, for otherwise (0, 1, 0) or (0, 0, 1) would be a rational
zero of (A, B) with two zero coordinates. Since

t‚ààT\{a23,b23}
t = O(X10/12)
(23)
(where as before zero variables are replaced by a11), we see that the number
of choices for T \ {a23, b23} is bounded by O(X10/12+œµ). Once these choices
are made, (22) implies that s divides b33 and t divides b22; hence the number
of possibilities for s and t is bounded by the number of factors of b33 and b22
respectively; so s and t can take at most O(Xœµ) values (since b22 and b33 are
both O(X1/3)). The values of a23 and b23 are then determined by T \{a23, b23},
r, s, and t. Thus the total number of possibilities for (A, B) in this case is
O(X10/12+œµ).
The case s = 0, rt Ã∏= 0 is handled similarly; the equation (23) is simply
changed to
a11

t‚ààT\{a13,b13}
t = O(X11/12),
(24)
and we Ô¨Ånd in conclusion that there are at most O(X11/12+œµ) choices for (A, B)
in this case.
The case t = 0, rs Ã∏= 0 is a bit more diÔ¨Écult. Proceeding in the same
manner, we Ô¨Ånd a12 and b12 are determined up to O(Xœµ) possibilities once a11,
a22, b11, and b22 are Ô¨Åxed. However, equation (24) now becomes
a2
11

t‚ààT\{a12,b12}
t = O(X12/12),
(25)
and this does not yield a satisfactory estimate. Nevertheless, we can still show
that the expected number of possibilities in this case, as v ranges over H, is at
most O(X10/12+œµ).

DISCRIMINANTS OF QUARTIC RINGS AND FIELDS
1049
Indeed, let S denote the set of (A, B) ‚ààVZ such that A and B have a com-
mon zero of the form (r, s, 0) with rs Ã∏= 0, so that a12 and b12 are determined up
to O(Xœµ) possibilities by the remaining variables. Then estimate (11) applies
to N‚àó(S; X), where œÉ‚àó(S) is the number of points in S in the region deÔ¨Åned
by (10) but where we assume a12, b12 take values in sets of cardinality at most
O(Xœµ). Thus we may consider the 10-dimensional region B deÔ¨Åned by (10) in
the ten variables of T \{a12, b12}. This region B can have an integer point only
if
60
Œªs1s4
2s2
3 ‚â•1 (since |a11| must be at least 1). In that case, B is a union of two
boxes in R10 each of whose sidelengths is bounded from below; by Lemma 10,
we have
œÉ‚àó(S) ‚â™Vol(B)O(Xœµ)2 ‚â™Œª‚àí10s2
2s4
3O(Xœµ)
so that
N‚àó(S; X) ‚â™O(Xœµ)
 c
Œª=X‚àí1
12
 ‚àû
s1,s2,s3= 1
2
Œª‚àí10s‚àí2
1 s‚àí4
2 s‚àí2
3
d√ós d√óŒª = O(X10/12+œµ).
We now consider the cases where exactly two of r, s, t are equal to zero.
This condition implies that either a11 = b11 = 0 (which does not occur by
hypothesis), a22 = b22 = 0, or a33 = b33 = 0.
If a33 = b33 = 0, then the estimate

t‚ààT\{a33,b33}
t = O(X10/12)
(26)
(again with variables equal to zero replaced by a11) shows that there are at
most O(X10/12+œµ) possibilities for the variables in T.
Finally, suppose a22 = b22 = 0. We show that as v ranges over H, on
average one expects O(X10/12) values for (A, B) in this case. Let S denote
the set of (A, B) ‚ààVZ for which a22 = b22 = 0. Then we have as before the
estimate (11) for N‚àó(S; X). The value of œÉ‚àó(S) is the number of integer points
in the region deÔ¨Åned by (10) together with the condition a22 = b22 = 0. As
before, this deÔ¨Ånes a region B in R10 which‚Äîwhenever it has an integer point‚Äî
becomes the union of two boxes whose edges are parallel to the coordinate axes
and whose lengths are bounded from below. Now Vol(B) ‚â™Œª‚àí10s‚àí4
2 s4
3, so by
Lemma 10, we obtain
N‚àó(S; X) ‚â™
 c
Œª=X‚àí1
12
 ‚àû
s1,s2,s3= 1
2
Œª‚àí10s‚àí2
1 s‚àí10
2
s‚àí2
3
d√ós d√óŒª = O(X10/12).
This completes the proof of Lemma 13.
2.5. Cutting the cusps. Let 0 < Œ¥ < 1
12.
Lemma 14. Let v take a random value in H uniformly with respect to
the measure |Disc(v)|‚àí1 dv. Then the expected number of (A, B) ‚ààFv with
|Disc(A, B)| < X such that 0 < |a11| < XŒ¥ is O(X11/12+Œ¥).

1050
MANJUL BHARGAVA
Proof. We partition VR into ‚à™V (m), where V (m) denotes the subset of
VR such that |a11| = m. To handle N‚àó(V (m); X) for m ‚â•1, we use again
the estimate (11). In this case, the quantity œÉ‚àó(V (m)) is equal to the number
of integer points (A, B) satisfying the inequalities (10) and the condition that
|a11| = m. This set of integer points can be nonempty only if
60
s1s4
2s2
3 is at least
m. In that case, the region B deÔ¨Åned by (10) and |a11| = m is the union
of two 11-dimensional boxes (contained in the hyperplanes of VR deÔ¨Åned by
a11 = ¬±m) whose sidelengths are all bounded below by an absolute constant.
By Lemma 10,
œÉ‚àó(V (m)) ‚â™Vol(B) ‚â™Œª‚àí11s1s4
2s2
3.
Estimate (11) thus gives
N(V (m); X) ‚â™
 c
Œª=X‚àí1
12
 ‚àû
s1,s2,s3= 1
2
Œª‚àí11s‚àí1
1 s‚àí2
2 s‚àí4
3 d√ós d√óŒª = O(X11/12)
where the implied constant is independent of m. Hence
N‚àó(‚à™1‚â§m‚â§XŒ¥V (m); X) =
‚åäXŒ¥‚åã

m=1
N(V (m); X) = XŒ¥O(X11/12) = O(X11/12+Œ¥),
as desired.
Lemma 15. Let v take any value in H ‚à©V (i). Let RX = RX(v) denote
the submultiset of points in Fv having absolute discriminant less than X, and
let R(Œ¥)
X = {(A, B) ‚ààRX : |a11| ‚â•XŒ¥}. Then the number of integral elements
in R(Œ¥)
X is
Vol(R(Œ¥)
X ) + O(X1‚àíŒ¥+œµ),
where Vol(R(Œ¥)
X ) denotes the volume of the multiset R(Œ¥)
X .
Proof. Let R(Œ¥)
X
be as in the statement of the lemma. Then it is easy
to see that the region R(Œ¥)
X
is bounded; indeed, the conditions |a11| ‚â•XŒ¥
and a3
11t = O(X1/3) imply that t = O(X1/3‚àí3Œ¥) for all t ‚ààT. Furthermore,
the various boundaries of R(Œ¥)
X are deÔ¨Åned by a bounded number of algebraic
surfaces of bounded degree. By Lemma 9, it follows that the number of integer
points in the multiset R(Œ¥)
X is
Vol(R(Œ¥)
X ) + O(Vol( ¬ØR(Œ¥)
X ))
(27)
where Vol( ¬ØR(Œ¥)
X ) denotes the greatest r-dimensional volume of a projection of
R(Œ¥)
X onto any of the r-dimensional coordinate subspaces (1 ‚â§r ‚â§11) in VR.
Let T again denote the set of twelve variables {aij, bij}, let T ‚Ä≤ be any
proper subset of T, and consider the projection of R(Œ¥)
X onto the coordinate

DISCRIMINANTS OF QUARTIC RINGS AND FIELDS
1051
hyperplane ZT ‚Ä≤ given by
ZT ‚Ä≤ = {t = 0 : t ‚ààT \ T ‚Ä≤}.
We know by Lemma 8 that for (A, B) ‚ààR(Œ¥)
X ,
|a11|12‚àí|T ‚Ä≤| ¬∑


t‚ààT ‚Ä≤
t
 < C1X
for some constant C1. Since |a11| ‚â•XŒ¥, and 12 ‚àí|T ‚Ä≤| ‚â•1, it follows that


t‚ààT ‚Ä≤
t
 < C1X1‚àíŒ¥.
(28)
Furthermore, we have seen that |a11| ‚â•XŒ¥ implies that for any t ‚ààT ‚Ä≤,
|t| < C2X1/3
(29)
for some constant C2. Thus the projection of R(Œ¥)
X onto ZT ‚Ä≤ is contained in the
|T ‚Ä≤|-dimensional region deÔ¨Åned by (28) and (29). This region is seen to have
volume at most
O(X1‚àíŒ¥+œµ),
for any proper subset T ‚Ä≤ ‚äÇT.
Therefore, (27) implies that the number of integer points in R(Œ¥)
X is given
by
Vol(R(Œ¥)
X ) + O(X1‚àíŒ¥+œµ),
(30)
where the implied constant may be chosen independently of v ‚ààH ‚à©V (i). This
is the desired conclusion.
Lemma 16. Let v take a random value in H ‚à©V (i) uniformly with respect
to the measure |Disc(v)|‚àí1 dv, and let RX = RX(v) and R(Œ¥)
X = R(Œ¥)
X (v) be as
in Lemma 15. Then the expected size of Vol(RX) ‚àíVol(R(Œ¥)
X ) is O(X11/12+Œ¥).
Proof. Let Ei(X) denote the expected value of Vol(RX(v))‚àíVol(R(Œ¥)
X (v)),
as v varies over H ‚à©V (i). We may write
Ei(X) = 1
Mi

v‚ààV (i)

x=(A,B)‚ààRX (v)
|a11|<XŒ¥
Œ¶(v) dx |Disc(v)|‚àí1dv,
(31)
where both dv and dx denote Euclidean measure on R12. Let us denote by
V (i)(Œ¥, X) ‚äÇV (i) the set {(A, B) ‚ààV (i) : |a11| < XŒ¥, |Disc(A, B)| < X}.

1052
MANJUL BHARGAVA
Following (6)‚Äì(8) and the proof of Lemma 14, we then have
Ei(X) = c‚Ä≤
Mi

g‚ààF ‚àí1

x‚ààV (i)(Œ¥,X)
Œ¶(gx) dx dg
‚â™

g‚ààKN ‚Ä≤A‚Ä≤‚àí1Œõ

x‚ààV (i)(Œ¥,X)
Œ¶(kna‚àí1Œªx) s‚àí2
1 s‚àí6
2 s‚àí6
3
dx d√óŒª d√ós dn dk
‚â™

Œª, s1,s2,s3

x‚ààV (i)(Œ¥,X)
Œ®

Œª ¬∑ a(s1, s2, s3)‚àí1(A, B)

s‚àí2
1 s‚àí6
2 s‚àí6
3
dx d√ós d√óŒª
‚â™
 c
Œª=X‚àí1
12
 ‚àû
s1,s2,s3= 1
2
 XŒ¥
a11=‚àíXŒ¥Œª‚àí11s‚àí1
1 s‚àí2
2 s‚àí4
3
da11 d√ós d√óŒª
= O(X11/12+Œ¥).
Choose Œ¥ = 1/24. Then Lemmas 11‚Äì16 yield
Proposition 17. Let v take a random value in H ‚à©V (i) uniformly with
respect to the measure |Disc(v)|‚àí1 dv, and let RX = RX(v) denote the sub-
multiset of points in Fv having absolute discriminant less than X. Then the
expected number of absolutely irreducible integral elements in RX is
Vol(RX) + O(X23/24+œµ).
Therefore, even though the total number of lattice points in RX far ex-
ceeds the volume of RX in general, the above proposition states that the
number of absolutely irreducible lattice points in RX will essentially be equal
to the volume as X ‚Üí‚àû.
2.6. Computation of the fundamental volume. To prove Theorem 7, it
remains only to compute Vol(RX(v)), where RX(v) is deÔ¨Åned as in Lemma 15.
We will see that this volume depends only on whether v lies in V (0), V (1), or
V (2); here V (i) again denotes the GR-orbit in VR consisting of those elements
(A, B) for which A and B possess 4 ‚àí2i common zeros in P2(R).
Before performing this computation, we state Ô¨Årst some propositions re-
garding the group G = GL2 √ó SL3 and its 12-dimensional representation V .
Proposition 18. The group GR acts transitively on V (i), and the isotropy
groups for v ‚ààV (i) are given as follows:
(i)
S4, if v ‚ààV (0);
(ii) C2 √ó C2, if v ‚ààV (1); and
(iii) D4, if v ‚ààV (2).

DISCRIMINANTS OF QUARTIC RINGS AND FIELDS
1053
In view of Proposition 18, it is convenient to use the notation ni to denote
the order of the stabilizer of any vector v ‚ààV (i). Proposition 18 implies that
we have n0 = 24, n1 = 4, and n2 = 8.
Now deÔ¨Åne the usual subgroups K, A+, N, and ¬ØN of GR as follows:
K = {orthogonal transformations in GR};
A+ = {a(t) : t ‚ààR√ó4
+ }, where a(t) =

t1
t2

,
 t3
t4
(t3t4)‚àí1

;
N = {n(u) : u ‚ààR4}, where n(u) =

1
u1
1

,

1
u2
1
u3
u4
1

;
¬ØN = {¬Øn(x) : x ‚ààR4}, where ¬Øn(x) =

1
x1
1

,
 1
x2
x3
1
x4
1

.
It is well-known that the natural product map K √ó A+ √ó N ‚ÜíGR is an
analytic diÔ¨Äeomorphism. In fact, for any g ‚ààGR, there exist unique k ‚ààK,
a = a(t1, . . . , t4) ‚ààA+, and n = n(u1, . . . , u4) ‚ààN such that g = k a n. In
particular, the element ¬Øn(x) ‚àà¬ØN can also be factored uniquely in this way;
the corresponding value of a is provided in the following proposition.
Proposition 19. Let ¬Øn(x1, . . . , x4) ‚àà¬ØN. Set
q = 1 + x2
1, r = 1 + x2
2 + (x2x4 ‚àíx3)2, s = 1 + x2
3 + x2
4.
Then ¬Øn = k a(t1, t2, t3, t4) n, where
t1 = 1/‚àöq, t2 = ‚àöq, t3 = 1/‚àör, t4 = ‚àör/‚àös.
DeÔ¨Åne an invariant measure dg on GR as follows. Choose an invariant
measure dk on K so that

K 1 dk = 1, and deÔ¨Åne

GR
f(g)dg =

K

R4

R√ó4
+
f(kna)d√ót du dk
=

K

R4

R√ó4
+
t‚àí1
1 t2t‚àí4
3 t‚àí2
4 f(kan)d√ót du dk.
Let dy = dy1 dy2 ¬∑ ¬∑ ¬∑ dy12 be the standard Euclidean measure on VR.
Proposition 20. For any f ‚ààL1(GR),

GR
f(g)dg =
1
32œÄ3

R√ó4

R4

R4 f(¬Øn(x)n(u)a(t))dx du d√ót.

1054
MANJUL BHARGAVA
Proof. We apply Proposition 19 to change variables, using the value of
the deÔ¨Ånite integral
 ‚àû
‚àí‚àû
 ‚àû
‚àí‚àû
 ‚àû
‚àí‚àû
 ‚àû
‚àí‚àû
1
qrs dx1 dx2 dx3 dx4 = 2œÄ3.
Proposition 21. For i = 0, 1, or 2, let f ‚ààC0(V (i)), and let y denote
any element of V (i). Then

g‚ààGR
f(g ¬∑ y)dg = ni
6œÄ3

v‚ààV (i) |Disc(v)|‚àí1f(v) dv.
Proof. It suÔ¨Éces to prove the equality for
y =
Ô£´
Ô£≠
Ô£Æ
Ô£∞
1
‚àí1
Ô£π
Ô£ª,
Ô£Æ
Ô£∞
‚àí1
1
Ô£π
Ô£ª
Ô£∂
Ô£∏‚ààV (0),
y =
Ô£´
Ô£≠
Ô£Æ
Ô£∞
1
1
‚àí1
Ô£π
Ô£ª,
Ô£Æ
Ô£∞
1
1
Ô£π
Ô£ª
Ô£∂
Ô£∏‚ààV (1), or
y =
Ô£´
Ô£≠
Ô£Æ
Ô£∞
1
1
Ô£π
Ô£ª,
Ô£Æ
Ô£∞
1
1
Ô£π
Ô£ª
Ô£∂
Ô£∏‚ààV (2).
Put
(z1, . . . , z12) = ¬Øn(x)n(u)a(t) ¬∑ y.
Then the form Disc(z)‚àí1dz1 ‚àß¬∑ ¬∑ ¬∑ ‚àßdz12 is a GR-invariant measure, and so we
must have
Disc(z)‚àí1dz1 ‚àß¬∑ ¬∑ ¬∑ ‚àßdz12 = c dx ‚àßdu ‚àßd√ót
for some constant factor c. An explicit calculation shows that c = ‚àí3/16 in all
three cases. By Proposition 18, GR is an ni-fold covering of V (i) via the map
g ‚Üíg ¬∑ y, where ni = 24, 4, or 8 for i = 0, 1, or 2 respectively. Hence

GR
f(g ¬∑ y)dg = ni ¬∑
1
32œÄ3 ¬∑ 16
3

V (i) |Disc(v)|‚àí1f(v)dv
= ni
6œÄ3

V (i) |Disc(v)|‚àí1f(v)dv,
as desired.

DISCRIMINANTS OF QUARTIC RINGS AND FIELDS
1055
Finally, for a vector vi ‚ààV (i), we obtain using Proposition 21 that
Vol(RX(vi)) = 6œÄ3
ni
 X1/6
0
t6d√ót ¬∑

GZ\G1
R
dg
= 6œÄ3
ni
¬∑ X
6 ¬∑ Œ∂(2)
œÄ
¬∑ Œ∂(2)Œ∂(3)
2œÄ2
= Œ∂(2)2Œ∂(3)
2ni
X,
proving Theorem 7.
3. Pairs of ternary quadratic forms and Theorems 1‚Äì5
Theorem 6 and Theorem 7 together now immediately imply the following
Theorem 22. Let M‚àó(i)
4
(Œæ, Œ∑) denote the number of isomorphism classes
of pairs (Q, R) such that Q is an order in an S4-quartic Ô¨Åeld with 4 ‚àí2i real
embeddings, R is a cubic resolvent ring of Q, and Œæ < Disc(Q) < Œ∑. Then
(a)
lim
X‚Üí‚àû
M‚àó(0)
4
(0, X)
X
= Œ∂(2)2Œ∂(3)
48
;
(b)
lim
X‚Üí‚àû
M‚àó(1)
4
(‚àíX, 0)
X
= Œ∂(2)2Œ∂(3)
8
;
(c)
lim
X‚Üí‚àû
M‚àó(2)
4
(0, X)
X
= Œ∂(2)2Œ∂(3)
16
.
To obtain Ô¨Åner asymptotic information on the distribution of quartic rings
(in particular, without the weighting by the number of cubic resolvents), we
need to be able to count absolutely irreducible GZ-equivalence classes in VZ
lying in certain subsets S ‚äÇVZ. If S is deÔ¨Åned, say, by Ô¨Ånitely many congruence
conditions, then this can easily be done; we have
lim
X‚Üí‚àû
N(S ‚à©V (i); X)
X
= Œ∂(2)2Œ∂(3)
2ni

p
¬µp(S),
(32)
where ¬µp(S) denotes the p-adic density of S in VZ, and ni = 24, 4, or 8 for
i = 0, 1, or 2 respectively. This reÔ¨Ånement of Theorem 7 is proved in exactly
the same way as the original theorem.
We recall from [3, ¬ß4.10], however, that the set S of elements (A, B) in
VZ corresponding to maximal orders is deÔ¨Åned by inÔ¨Ånitely many congruence
conditions. To prove that (32) still holds for such a set, we require a uniform
estimate on the error term when only Ô¨Ånitely many factors are taken in (32).
This estimate is provided in Section 3.2.
In Section 3.3, we then use the
estimate to complete the proofs of Theorems 1‚Äì5.
3.1.
Nowhere overramiÔ¨Åed quartic Ô¨Åelds.
Let Q be an order in an
S4-quartic Ô¨Åeld, and let p ‚ààZ be a prime such that Q is maximal at p. We

1056
MANJUL BHARGAVA
say p is overramiÔ¨Åed in Q if (p) factors into primes in Q as P 4, P 2, or P 2
1 P 2
2 ;
similarly, the archimedean prime of Z (the ‚Äúprime at inÔ¨Ånity‚Äù) is overramiÔ¨Åed
in Q if it factors into the product of two ramiÔ¨Åed places (i.e., if Q is totally
complex). A maximal quartic order Q (or the quartic Ô¨Åeld K4 in which it lies)
is nowhere overramiÔ¨Åed if no prime of Z (Ô¨Ånite or inÔ¨Ånite) is overramiÔ¨Åed in Q.
The signiÔ¨Åcance of being ‚Äúnowhere overramiÔ¨Åed‚Äù is as follows. Given an
S4-quartic Ô¨Åeld K4, let K24 denote its Galois closure. Let K3 denote a cubic
Ô¨Åeld contained in K24 (the ‚Äúcubic resolvent Ô¨Åeld‚Äù), and let K6 be the unique
quadratic extension of K3 such that the Galois closure of K6 over Q is K24.
Then one checks that the quadratic extension K6/K3 is unramiÔ¨Åed precisely
when the quartic Ô¨Åeld K4 is nowhere overramiÔ¨Åed.
Conversely, if K3 is a
noncyclic cubic Ô¨Åeld, and K6 is an unramiÔ¨Åed quadratic extension of K3, then
the Galois closure of K6 is an S4-extension K24 which contains up to conjugacy
a unique, nowhere overramiÔ¨Åed quartic extension K4.
3.2. A uniformity estimate. Let us denote by Vp the set of all (A, B) ‚ààVZ
corresponding to quartic orders Q that are maximal at p and in which p is not
overramiÔ¨Åed. Let Wp = VZ ‚àíVp. In order to apply a simple sieve to obtain
Theorems 1‚Äì5, we require the following proposition, analogous to Proposition 1
in [15] (though our proof is signiÔ¨Åcantly simpler).
Proposition 23. N(Wp ; X) = O(X/p2), where the implied constant is
independent of p.
Proof. The set Wp may be naturally partitioned into two subsets: W(1)
p ,
the set of points (A, B) ‚ààVZ corresponding to quartic rings not maximal at p;
and W(2)
p , the set of points (A, B) ‚ààVZ corresponding to quartic rings that are
maximal at p but also overramiÔ¨Åed at p.
We Ô¨Årst treat W(1)
p . We will need the following lemma.
Lemma 24. The number of maximal S4-quartic orders (equivalently, the
number of S4-quartic Ô¨Åelds) having absolute discriminant less than X is O(X).
Lemma 24 follows immediately from Theorem 22, since we have shown
previously that every quartic ring has at least one cubic resolvent ring ([3,
Corollary 4]).
To estimate N(W (1)
p ; X) using Lemma 24, we wish to know for any mul-
tiple k of p that (a) the number of subrings of index k in a maximal quartic
ring Q is not too large relative to k; and (b) the number of cubic resolvents
that such a subring can possess is also not too large relative to k. For (a), a
much stronger result than we need has been proved by Nakagawa [20], whose
methods imply that the number of orders having index k =  pei
i in a maxi-
mal quartic ring Q is at most O( p(2+œµ)‚åäei/4‚åã
i
), where  pei
i denotes the prime

DISCRIMINANTS OF QUARTIC RINGS AND FIELDS
1057
power decomposition of k. Any such order will of course have discriminant
k2Disc(Q).
As for (b), we have shown in [3, Corollary 4] that the number of cubic
resolvents of a quartic ring having content n is œÉ(n), where œÉ denotes the
usual sum-of-divisors function. (Recall that the content of a quartic ring Q
is the largest integer n such that Q = Z + nQ‚Ä≤ for some quartic ring Q‚Ä≤.) In
particular, rings having content 1 possess a single cubic resolvent.
Since every content n quartic ring Q arises as Z+nQ‚Ä≤ for a unique content 1
quartic ring Q‚Ä≤, and Disc(Q) = n6 Disc(Q‚Ä≤), we conclude
N(W(1)
p ; X) <
‚àû

n=1
œÉ(n)
n6
 ‚àû

e=1
p(2+œµ)‚åäe/4‚åã
p2e

qÃ∏=p
 ‚àû

e=0
q(2+œµ)‚åäe/4‚åã
q2e

O(X) = O(X/p2),
as desired.
We turn next to W(2)
p . Let us say a quadratic extension K6 of a noncyclic
cubic Ô¨Åeld K3 is acceptable if the Galois closure of K6 over Q has Galois group
a transitive subgroup of S4. For a Ô¨Åxed K3, let g(n) denote the number of
acceptable quadratic extensions whose conductor has absolute norm n.
To
estimate g(n), we require two lemmas. The Ô¨Årst lemma is due to Baily [1]:
Lemma 25 (Baily).
K6 is an acceptable quadratic extension of K3 if and
only if NK3/QDisc(K6/K3) is the square of an ideal in Z.
The next lemma gives an upper bound on the sum of h‚àó
2(K3) over all cubic
Ô¨Åelds K3 having absolute discriminant less than X.
Lemma 26. We have

K3
h‚àó
2(K3) = O(X),
(33)
where the sum ranges over all cubic Ô¨Åelds K3 having absolute discriminant less
than X.
Lemma 26 follows from Lemma 24 as Theorem 5 will follow from Theo-
rem 1.
Now it is a consequence of Lemma 25 that g(n) = 0 for nonsquare n. On
the other hand, for a square integer n = m2, class Ô¨Åeld theory implies that
g(m2) < Œ∫ h‚àó
2(K3) 3œâ(m),
(34)
where œâ(m) denotes the number of prime factors of m, and Œ∫ is a constant
bounded independently of K3 (it corresponds to the even and inÔ¨Ånite places;
see [1] for details).

1058
MANJUL BHARGAVA
Lemma 26 and (34) now imply that, for some constant c‚Ä≤‚Ä≤,
N(W(2)
p ; X) ‚â§Œ∫

K3

p|m
m2|Disc(K3)|<X
3œâ(m)h‚àó
2(K3)
‚â§3Œ∫

p2m2<X
3œâ(m)

|Disc(K3)|<X/(p2m2)
h‚àó
2(K3)
‚â§3Œ∫c‚Ä≤‚Ä≤ X
p2

p2m2<X
3œâ(m)
m2
< 3Œ∫c‚Ä≤‚Ä≤ X
p2

m
3œâ(m)
m2 .
As the last sum converges absolutely, this concludes the proof of the proposi-
tion.
3.3. Proofs of Theorems 1‚Äì5.
Proof of Theorem 1.
As in [3], let Up denote the set of all (A, B) ‚ààVZ
that correspond to pairs (Q, R) for which Q is maximal at p, and let U = ‚à©pUp.
Then U is the set of (A, B) ‚ààVZ corresponding to maximal quartic rings Q.
In [3, Lemma 23], we determined the p-adic density ¬µp(Up) of Up:
¬µp(Up) = (p ‚àí1)4 p (p + 1)2 (p2 + p + 1)(p3 + p2 + 2p + 1)/ p12.
(35)
Suppose Y is any positive integer. It follows from (32) and (35) that
lim
X‚Üí‚àû
N(i)(‚à©p<Y Up; X)
X
= Œ∂(2)2Œ∂(3)
2ni

p<Y
[p‚àí12p (p2 ‚àí1)2(p3 ‚àí1)(p4 + p2 ‚àíp ‚àí1)],
where we use the notation N(i)(S; X) for N(S ‚à©V (i); X). Letting Y tend to
inÔ¨Ånity, we obtain immediately that
lim sup
X‚Üí‚àû
N(i)(U; X)
X
‚â§Œ∂(2)2Œ∂(3)
2ni

p
[p‚àí12p (p2 ‚àí1)2(p3 ‚àí1)(p4 + p2 ‚àíp ‚àí1)]
= Œ∂(2)2Œ∂(3)
2ni

p
[(1 ‚àíp‚àí2)2(1 ‚àíp‚àí3)(1 + p‚àí2 ‚àíp‚àí3 ‚àíp‚àí4)]
= 1
2ni

p
(1 + p‚àí2 ‚àíp‚àí3 ‚àíp‚àí4).
To obtain a lower bound for N(i)(U; X), we note that

p<Y
Up ‚äÇ(U ‚à™

p‚â•Y
Wp).

DISCRIMINANTS OF QUARTIC RINGS AND FIELDS
1059
Hence by Proposition 23,
lim
X‚Üí‚àû
N(i)(U; X)
X
‚â•Œ∂(2)2Œ∂(3)
2ni

p<Y
[p‚àí12p (p2 ‚àí1)2(p3 ‚àí1)(p4 + p2 ‚àíp ‚àí1)] ‚àíO(

p‚â•Y
p‚àí2).
Letting Y tend to inÔ¨Ånity completes the proof.
Proof of Theorem 2. We Ô¨Årst prove the analogue of Theorem 2 for the
set S of S4-quartic orders having content 1 (i.e., the primitive quartic orders);
on such quartic rings the correspondence of Theorem 6 is bijective. To this
end, let Sp denote the set of elements (A, B) ‚ààVZ having content prime to p,
so that S = ‚à©pSp. Then as noted in [3], an element (A, B) ‚ààVFp corresponds
to a quartic ring with content prime to p if and only if A and B are linearly
independent over Fp. It follows that
¬µp(Sp) = (p6 ‚àí1)(p6 ‚àíp)/p12.
The same argument as in the proof of Theorem 1 then shows that
lim
X‚Üí‚àû
N(i)(S; X)
X
= Œ∂(2)2Œ∂(3)
2ni

p
(1 ‚àíp‚àí5)(1 ‚àíp‚àí6) =
Œ∂(2)2Œ∂(3)
2ni Œ∂(5)Œ∂(6).
(36)
To obtain Theorem 2 from (36), we observe that every content 1 ring Q1
contains the content n ring Qn = Z + nQ1, and conversely, every content n
ring Qn arises from a unique content 1 ring Q1 in this way. Furthermore, if Q1
has discriminant D then Qn has discriminant n6D. It follows that
lim
X‚Üí‚àû
M(i)
4 (0, X)
X
=
‚àû

n=1
1
n6
Œ∂(2)2Œ∂(3)
2niŒ∂(5)Œ∂(6) = Œ∂(2)2Œ∂(3)
2ni Œ∂(5) ,
as desired.
Proof of Theorem 3. It is known that the Artin symbol (K24/p) equals
‚ü®e‚ü©, ‚ü®(12)‚ü©, ‚ü®(123)‚ü©, ‚ü®(1234)‚ü©, and ‚ü®(12)(34)‚ü©precisely when the splitting type
of p in Q is (1111), (112), (13), (4), or (22) respectively, where Q denotes the
ring of integers in K4. As in [3], let Tp(œÉ) denote the set of all (A, B) ‚ààVZ that
correspond to quartic rings Q having a speciÔ¨Åed splitting type œÉ at p; then the
set of all such (A, B) ‚ààVZ corresponding to maximal quartic rings Q is given
by U ‚à©Tp(œÉ). Hence by the same argument as in the proof of Theorem 1, we
have
lim
X‚Üí‚àûX‚àí1N(i)(U ‚à©Tp(œÉ); X) = ¬µp(Tp(œÉ))

qÃ∏=p
¬µq(Uq).
On the other hand, Lemma 21 of [3] gives the p-adic densities of Tp(œÉ) for all
splitting and ramiÔ¨Åcation types œÉ. In particular, the values of ¬µp(Tp(œÉ)) for
œÉ = (1111), (112), (13), (4), or (22) occur in the ratio 1:6:8:6:3 for any value
of p; this is the desired result.

1060
MANJUL BHARGAVA
Proof of Theorem 4. By Theorem 1, the number of S4-quartic Ô¨Åelds having
4 ‚àí2i real embeddings and absolute discriminant at most X is asymptotic to
ciX, where
c0 = .0253477143 . . . ,
c1 = .1520862858 . . . ,
c2 = .0760431429 . . . .
Thus the total number of S4-quartic Ô¨Åelds with absolute discriminant at most
X is asymptotic to cX, where c = c0 + c1 + c2 = .2534771431 . . . .
The analogous constants for D4-quartic Ô¨Åelds, as obtained in [7], are given
by
d0 = .0049278439 . . . ,
d1 = .0098556878 . . . ,
d2 = .0375424793 . . . ,
for a total of d = .0523260112 . . . .
It follows that the asymptotic proportion of S4-quartic Ô¨Åelds among all
quartic Ô¨Åelds having 4, 2, or 0 real embeddings, when ordering quartic Ô¨Åelds
by absolute discriminant, is given by
c0
c0+d0 ‚âà83.723%,
c1
c1+d1 ‚âà93.914%, and
c2
c2+d2 ‚âà66.948% respectively, for an overall proportion of
c
c+d ‚âà82.889%.
This yields Theorem 4.
Proof of Theorem 5. Let V = ‚à©pVp be the set of all (A, B) ‚ààVZ corre-
sponding to nowhere overramiÔ¨Åed maximal quartic rings. Using [3, Lemma 23],
and the fact that Vp is simply the union of all Up(œÉ)‚Äôs where œÉ Ã∏= (14), (22), or
(1212), we obtain
¬µp(Vp) = p‚àí12 p2 (p2 ‚àí1)2 (p3 ‚àí1)2.
(37)
By the same argument as in Theorem 1, we therefore get
Lemma 27. Let L(i)
4 (Œæ, Œ∑) denote the number of nowhere overramiÔ¨Åed S4-
quartic Ô¨Åelds K having 4 ‚àí2i real embeddings such that Œæ < Disc(K) < Œ∑.
Then
(a)
lim
X‚Üí‚àû
L(0)
4 (0, X)
X
= Œ∂(2)2Œ∂(3)
48

p
¬µp(Vp)
= Œ∂(2)2Œ∂(3)
48
Œ∂(2)‚àí2Œ∂(3)‚àí2 = 1/(48Œ∂(3));
(b)
lim
X‚Üí‚àû
L(1)
4 (‚àíX, 0)
X
= Œ∂(2)2Œ∂(3)
8

p
¬µp(Vp)
= Œ∂(2)2Œ∂(3)
8
Œ∂(2)‚àí2Œ∂(3)‚àí2 = 1/(8Œ∂(3)).
On the other hand, given a nowhere overramiÔ¨Åed S4-quartic Ô¨Åeld K4 with
Galois closure K24, we have observed earlier that in K24 is contained a unique
(up to conjugacy) cubic Ô¨Åeld K3 and a unique unramiÔ¨Åed extension K6 of K3.

DISCRIMINANTS OF QUARTIC RINGS AND FIELDS
1061
In addition, the discriminant of K4 is equal to the discriminant of K3, and the
number of quadruplets of quartic Ô¨Åelds K4 corresponding to a given K3 in this
way equals h‚àó
2(K3) ‚àí1 (see Heilbronn [19] for full details). Therefore,

0<Disc(K3)<X
(h‚àó
2(K3) ‚àí1)
=
L(0)
4 (0, X),

‚àíX<Disc(K3)<0
(h‚àó
2(K3) ‚àí1)
=
L(1)
4 (‚àíX, 0).
(38)
Since Davenport and Heilbronn [15] have shown that
lim
X‚Üí‚àû

0<Disc(K3)<X 1
X
= 1/(12Œ∂(3)),
lim
X‚Üí‚àû

‚àíX<Disc(K3)<0 1
X
=
1/(4Œ∂(3)),
(39)
we conclude
lim
X‚Üí‚àû

0<Disc(K3)<X h‚àó
2(K3)

0<Disc(K3)<X 1
= 1 + lim
X‚Üí‚àû
L(0)
4 (0, X)

0<Disc(K3)<X 1
= 1 + 1/(48Œ∂(3))
1/(12Œ∂(3))
=
5
4,
lim
X‚Üí‚àû

‚àíX<Disc(K3)<0 h‚àó
2(K3)

‚àíX<Disc(K3)<0 1
= 1 + lim
X‚Üí‚àû
L(1)
4 (‚àíX, 0)

‚àíX<Disc(K3)<0 1
= 1 + 1/(8Œ∂(3))
1/(4Œ∂(3))
=
3
2.
Acknowledgments.
This article is based on Chapter 5 of the author‚Äôs
Ph.D. thesis [2] at Princeton University. I am extremely grateful to my advisor
Andrew Wiles and to Peter Sarnak for all their enthusiasm, encouragement,
and guidance during this work. I am also very thankful to Karim Belabas,
Henri Cohen, Keith Conrad, Kiran Kedlaya, Hendrik Lenstra, Igor Rodni-
anski, Jean-Pierre Serre, and Don Zagier for many helpful conversations and
comments on earlier versions of this manuscript.
I extend my gratitude to the Hertz Foundation for funding this work, and
to the Clay Mathematics Institute for their subsequent support.
Clay Mathematics Institute, Cambridge, MA
Princeton University, Princeton, NJ
E-mail address:
bhargava@math.princeton.edu

1062
MANJUL BHARGAVA
References
[1]
A. M. Baily, On the density of discriminants of quartic Ô¨Åelds, J. Reine Angew. Math.
315 (1980), 190‚Äì210.
[2]
M. Bhargava, Higher Composition Laws, Ph.D. Thesis, Princeton University, June 2001.
[3]
‚Äî‚Äî‚Äî, Higher composition laws III: The parametrization of quartic rings, Ann. of
Math. 159 (2004), 1329‚Äì1360.
[4]
‚Äî‚Äî‚Äî, Higher composition laws IV: The parametrization of quintic rings, Ann. of
Math., to appear.
[5]
‚Äî‚Äî‚Äî, The density of discriminants of quintic rings and Ô¨Åelds, Ann. of Math., to
appear.
[6]
H. Cohen, F. Diaz y Diaz, and M. Olivier, A survey of discriminant counting, in Al-
gorithmic Number Theory (Sydney, 2002), Lecture Notes in Comput. Sci. 2369, 80‚Äì94,
Springer-Verlag, Berlin, 2002.
[7]
H. Cohen, F. Diaz y Diaz, and M. Olivier, Enumerating quartic dihedral extensions of
Q, Compositio Math. 133 (2002), 65‚Äì93.
[8]
H. Cohen and J. Martinet, ¬¥Etude heuristique des groupes de classes des corps de nom-
bres, J. Reine Angew. Math. 404 (1990), 39‚Äì76.
[9]
‚Äî‚Äî‚Äî, Heuristics on class groups: some good primes are not too good, Math. Comp.
63 (1994), 329‚Äì334.
[10]
H. Cohn, The density of abelian cubic Ô¨Åelds, Proc. Amer. Math. Soc. 5 (1954), 476‚Äì477.
[11]
B. Datskovsky and D. J. Wright, The adelic zeta function associated to the space of
binary cubic forms II: Local theory, J. Reine Angew. Math. 367 (1986), 27‚Äì75.
[12]
H. Davenport, On a principle of Lipschitz, J. London Math. Soc. 26 (1951), 179‚Äì183.
[13] ‚Äî‚Äî‚Äî, On the class-number of binary cubic forms I and II, J. London Math. Soc. 26
(1951), 183‚Äì198.
[14] ‚Äî‚Äî‚Äî, Corrigendum: ‚ÄúOn a principle of Lipschitz‚Äù, J. London Math. Soc. 39 (1964),
580.
[15]
H. Davenport and H. Heilbronn, On the density of discriminants of cubic Ô¨Åelds II, Proc.
Roy. Soc. London Ser. A 322 (1971), 405‚Äì420.
[16]
B. N. Delone and D. K. Faddeev, The Theory of Irrationalities of the Third Degree,
Translations of Mathematical Monographs 10, 1964, A.M.S., Providence, RI.
[17]
V. Ennola and R. Turunen, On totally real cubic Ô¨Åelds, Math. Comp. 44 (1985), 495‚Äì
518.
[18]
G. W. Fung and H. C. Williams, On the computation of a table of complex cubic Ô¨Åelds
with discriminant D > ‚àí106, Math. Comp. 55 (1990), 313‚Äì325.
[19]
H. Heilbronn, On the 2-classgroup of cubic Ô¨Åelds, Studies in Pure Math. (1971), 117‚Äì
119.
[20]
J. Nakagawa, Orders of a Quartic Field, Mem. Amer. Math. Soc. 122 (1996), no. 583,
A.M.S., Providence, RI.
[21] ‚Äî‚Äî‚Äî, On the relations among the class numbers of binary cubic forms, Invent. Math.
134 (1998), 101‚Äì138.
[22]
M. Sato and T. Kimura, A classiÔ¨Åcation of irreducible prehomogeneous vector spaces
and their relative invariants, Nagoya Math. J. 65 (1977), 1‚Äì155.
[23]
M. Sato and T. Shintani, On zeta functions associated with prehomogeneous vector
spaces, Ann. of Math. 100 (1974), 131‚Äì170.

DISCRIMINANTS OF QUARTIC RINGS AND FIELDS
1063
[24]
A. Seidenberg, A new decision method for elementary algebra, Ann. of Math. 60 (1954),
365‚Äì374.
[25]
A. Tarski, A Decision Method for Elementary Algebra and Geometry, 2nd ed., revised,
Univ. of California Press, Berkeley and Los Angeles, Calif., 1951.
[26]
S. Wong, Automorphic forms on GL(2) and the rank of class groups, J. reine Angew.
Math. 515 (1999), 125‚Äì153.
[27]
D. J. Wright and A. Yukie, Prehomogeneous vector spaces and Ô¨Åeld extensions, Invent.
Math. 110 (1992), 283‚Äì314.
[28]
A. Yukie, Shintani Zeta Functions, London Mathematical Society Lecture Note Series
183, Cambridge Univ. Press, Cambridge, 1993.
[29] ‚Äî‚Äî‚Äî, Density theorems for prehomogeneous vector spaces, preprint.
(Received June 7, 2004)

