Prepared for submission to JCAP
The Cosmological Evolution of
Self-interacting Dark Matter
Daniel Egana-Ugrinovic1, Rouven Essig2, Daniel Gift2, and
Marilena LoVerde2
1Perimeter Institute for Theoretical Physics, Waterloo, ON, N2L 2Y5
2C. N. Yang Institute for Theoretical Physics, Stony Brook University, Stony Brook, NY
11794
Abstract.
We study the evolution of cosmological perturbations in dark-matter models
with elastic and velocity-independent self interactions. Such interactions are imprinted in
the matter-power spectrum as dark acoustic oscillations, which can be experimentally ex-
plored to determine the strength of the self scatterings. Models with self interactions have
similarities to warm dark matter, as they lead to suppression of power on small scales when
the dark-matter velocity dispersion is sizable. Nonetheless, both the physical origin and the
extent of the suppression diﬀer for self-interacting dark matter from conventional warm dark
matter, with a dark sound horizon controlling the reduction of power in the former case, and
a free-streaming length in the latter. We thoroughly analyze these diﬀerences by performing
computations of the linear power spectrum using a newly developed Boltzmann code. We
ﬁnd that while current Lyman-α data disfavor conventional warm dark matter with a mass
less than 5.3 keV, when self interactions are included at their maximal value consistent with
bounds from the Bullet Cluster, the limits are relaxed to 4.4 keV. Finally, we make use of
our analysis to set novel bounds on light scalar singlet dark matter.
Preprint: YITP-SB-2020-39
Keywords: Self-interacting dark matter, Lyman-α , Small scale structure, Core versus cusp.
arXiv:2102.06215v2  [astro-ph.CO]  20 May 2021

Contents
1
Introduction
2
2
Background thermodynamics of self-interacting dark matter
4
2.1
Phase space distributions and equilibrium thermodynamics
5
2.2
Matching the relativistic and non-relativistic regimes in the presence of self
interactions
9
2.3
Phase-space distributions in the sudden transition approximation
11
2.4
Kinetic decoupling
13
3
Cosmological dark-matter perturbations
14
3.1
Free-streaming and sound waves
15
3.2
Evolution of dark-matter perturbations: kinetically coupled regime
17
3.3
Evolution of dark-matter perturbations: decoupled regime
19
3.4
Numerical procedure
20
4
Results
21
4.1
SIDM power spectrum
21
4.2
Bounds from Lyman-α
23
5
A benchmark example: singlet-scalar dark matter
26
6
Conclusions
30
7
Acknowledgments
31
A Treatment of baryons, photons and neutrinos
31
B Validation of Boltzmann Solver
32
C Relaxation time approximation
34
D Matching density and velocity perturbations to moments of the phase space
distribution
36
E The Area Criterion
38
– 1 –

1
Introduction
The search for dark matter in laboratories and astronomical observatories via its interac-
tions with the Standard Model (SM) is ongoing, but all evidence for its existence remains
purely gravitational in nature. While theoretical motivations exist for the dark matter to
have non-gravitational interactions with the SM, it is also entirely possible that the dark
sector remains secluded and interacts with the visible sector purely gravitationally, or via
experimentally inaccessible non-gravitational interactions. A secluded dark sector can be
successfully populated in the early universe via a variety of mechanisms that do not require
interactions with the SM, including gravitational production [1–3], interactions with the in-
ﬂaton [4, 5], or the misalignment mechanism [6–8]. It is possible, however, that the dark
sector has non-gravitational dynamics of its own, both due to theoretical motivations and
experimental hints, which suggest that dark interactions are responsible for the anomalous
behavior of cosmic structure on small scales [9].
If this is the case, progress in our understanding of the dark sector can still be made
by looking for the signatures that these interactions leave on gravitationally bound visible
matter. Depending on the complexity of the dark interactions, a variety of phenomenologi-
cal signatures arise, including modiﬁcations of halo shapes [10], large-scale acoustic oscilla-
tions [11, 12], and even the formation of complete dark galaxies [13, 14]. Even the simplest
of the dynamical dark sector theories, namely a dark matter particle with elastic, isotropic,
and velocity-independent self interactions [15], leaves visible signs on gravitationally bound
matter. In what follows, we refer to this model as self-interacting dark matter (SIDM). Ob-
servable signatures left by SIDM on cosmic structure are, e.g., reducing the oﬀsets between
the dark and visible gas distributions when clusters of galaxies encounter [16] and giving
a spherical shape to otherwise triaxial halos [10]. SIDM has also been proposed to solve a
variety of small-scale problems, such as the explanation of cores in dwarf galaxies [9, 17–24].
In this work we explore an additional signature left by SIDM on cosmic structure, which
is the imprint of acoustic oscillations on the matter-power spectrum. The eﬀect of SIDM on
the matter-power spectrum is similar to the one of conventional non-interacting warm-dark
matter (WDM), as in both models power is reduced on scales below a characteristic cutoﬀ,
controlled mostly by the particle’s velocity dispersion [11]. In SIDM, the cutoﬀscale is the
dark sound horizon due to pressure support, while in WDM, it corresponds to the free-
streaming length. To understand the subtle diﬀerences between the two cases, we investigate
in detail the whole range of self-scattering cross sections starting from σ/m = 0, as in models
of WDM, and going up to the maximal values allowed by the Bullet Cluster and other probes,
σ/m ∼1 cm2/g [25]. In order to do so, we develop a new Boltzmann code to compute the
linear power spectrum, taking into account the cosmic evolution of acoustic oscillations,
– 2 –

decoupling of the self interactions, and the later periods of free-streaming. We thoroughly
check and validate our code by comparing its results with the Boltzmann solver CLASS [26]
for the special cases of cold and warm dark matter with no self interactions (where CLASS
can be used), ﬁnding sub-percent level precision in our computations.
The imprints left by SIDM or WDM on the linear matter-power spectrum can be obser-
vationally investigated and distinguished from each other via precise measurements of cosmic
structure on small scales, such as the ones provided by current and/or future measurements
of the Lyman-α forest [27, 28], Milky-Way satellite counts [29–31], strong lensing [32–34]
stellar streams [35–37], and high-resolution lensing measurements of the cosmic microwave
background (CMB) [38, 39]. In particular, using such probes and calculations of the matter-
power spectrum for a given dark sector model, bounds can be set on the corresponding dark
matter mass or velocity dispersion. Here we will focus on calculating Lyman-α bounds on
SIDM, but a large part of our analysis (especially our linear power-spectrum computations)
can also be used for studying other probes. From our analysis, we ﬁnd that bounds from
Lyman-α on the dark matter mass slightly decrease as the self-interaction cross section is in-
creased. More speciﬁcally, we show that while current Lyman-α bounds disfavor typical warm
dark matter1 for masses m ≤5.3 keV [27] (m ≤3.5 keV under more conservative assumptions
for current Lyman-α bounds), when large self interactions are allowed, σ/m = 1 cm2/g, the
bound decreases to m ≤4.4 keV (m ≤2.95 keV for conservative bounds).
In terms of concrete particle physics models, our results set stringent and previously
unexplored constraints on one of the simplest dark-matter models: scalar singlet dark matter.
In particular, we show that for singlet-self couplings in the range 5 × 10−8 ≲λ ≲10−5
(where the upper range is imposed for consistency with Bullet Cluster bounds [25]) and for a
present dark-matter velocity dispersion
p
⟨u2⟩/3 ≳10−8, observable acoustic oscillations are
imprinted in the linear matter-power spectrum in this model. For couplings λ ≲5 × 10−8,
free-streaming aﬀects modes relevant for Lyman-α instead.
Both the eﬀects of pressure
support and free-streaming are constrained by our analysis. Concretely, our results improve
previous constraints on scalar singlet dark matter (which come from the eﬀective number of
relativistic species Neff [41]) by orders of magnitude in mass or velocity dispersion.
Given the large amount of literature written on SIDM, it is convenient to brieﬂy com-
ment about previous analyses related to our work. To the best of our knowledge, the earliest
reference studying the eﬀect of self interactions in the linear matter-power spectrum is [11],
and further analysis was carried out in [42, 43]. In these references some of the main eﬀects
that we study in this work were laid out. Here we improve on these analyses by performing a
1As a convention, the benchmark WDM model corresponds to a single non-interacting Weyl fermionic
species with a vanishing primordial chemical potential [40].
– 3 –

comprehensive and detailed study of the cosmological evolution of SIDM for all the allowed
range of self-interaction cross sections, and also obtain updated bounds from Lyman-α. More
recently, self interactions have been studied in the context of ETHOS [44–46], which however
concentrates mostly on speciﬁc benchmarks for velocity-dependent cross sections. Lyman-
α bounds on self interactions are also analyzed in [47], but that reference does not study
late-time suppression on small scales due to acoustic oscillations. Reference [48] presents a
detailed study of the Boltzmann hierarchies in SIDM at the theoretical level, while [49–51]
studied models with self-interactions and brieﬂy comment on bounds from Lyman-α and
others. In [52], the authors present approximate constraints on strongly self-interacting dark
matter from Lyman-α assuming the constraints are equal to the ones on WDM. Finally, we
do not study quantum eﬀects that arise in self-interacting theories when the dark-matter
particle is ultra-light, but we refer the reader to [53, 54] for the corresponding discussion.
We organize this paper as follows. In section 2, we discuss the background evolution
of the homogeneous component of self-interacting dark matter. In section 3, we discuss the
dark-matter perturbations, the free-streaming and sound-horizon scales, and the evolution
of the power spectrum. We present our results in section 4, including bounds from Lyman-
α. We then move to discuss the singlet-scalar model and bounds its parameter space from
Lyman-α probes in section 5. We conclude in section 6. We provide several technical details
in appendices.
2
Background thermodynamics of self-interacting dark matter
The cosmological evolution of self-interacting dark matter can be divided into the evolution
of the homogeneous background component and the evolution of the small dark-matter per-
turbations on top of this background. In this section, we study the basic thermodynamics
and evolution of the homogeneous dark-matter background, which is a non-relativistic com-
ponent at present times. Throughout sections 2.1-2.3, we discuss the background evolution
and phase-space distributions of dark matter while it is in kinetic equilibrium. As the uni-
verse expands, interactions become ineﬃcient, the dark matter falls out of equilibrium and
the phase-space distributions are frozen out. We provide an approximate prescription for
the decoupled phase-space distributions in section 2.4. In this work, we limit ourselves to
discussing models containing a single elastically self-interacting dark-matter component. We
also consider only models with velocity-independent self-interaction cross sections. We do
not include any interactions with baryons. Finally, it is worth pointing out that in the litera-
ture kinetic equilibrium/decoupling usually refer to the elastic interactions between the dark
sector and some external thermal bath. For instance, in WIMP models, kinetic decoupling
indicates when the elastic interactions between the dark sector and the SM decouple. In this
– 4 –

work, however, we study a dark sector that is secluded from the SM or other thermal baths
and only interacts with itself. Thus, in what follows kinetic decoupling is used to describe
when the elastic self-interactions within the dark sector decouple.
2.1
Phase space distributions and equilibrium thermodynamics
The dark matter is described by its phase-space distribution f(x, q), which determines the
number of particles within a phase-space diﬀerential.
We closely follow the conventions
of [55], where ⃗x and ⃗q = qˆn are comoving coordinates and momenta, and q and ˆn are the
momentum magnitude and direction. Assuming that the gas is approximately homogeneous,
the phase-space distribution can be divided into a homogeneous and isotropic background
part f0(q), plus a small inhomogeneous perturbation Ψ(⃗x, ⃗q),
f(⃗x, ⃗q) = f0(q)

1 + Ψ(⃗x, ⃗q)

.
(2.1)
By deﬁnition, the zero-th order phase space distribution in Eq. (2.1) is required to be a
solution of the Boltzmann equation in the homogeneous expanding background,
∂f0
∂τ = C[f0]
,
(2.2)
where τ is the conformal time, the collision terms on the right hand side can be read oﬀ
from [56], and in the partial derivative the comoving momentum ⃗q and position ⃗x are held
ﬁxed.
In order to study the cosmological evolution and structure formation within SIDM, we
need to analyze the evolution of both the homogeneous background distribution f0(q) and
the small inhomogeneous perturbations Ψ(⃗x, ⃗q) deﬁned in Eq. (2.1). We start by studying
the background thermodynamics, and postpone the treatment of the perturbations to later
sections.
The main background quantities of the dark-matter ﬂuid are the homogeneous num-
ber density, energy density, and pressure.
They are obtained by taking moments of the
distribution function f0, and are given by
n = 1
a3
Z
d3qf0(q)
,
ρ = 1
a4
Z
d3qf0(q)ϵ(q)
,
p =
1
3a4
Z
d3q q2
ϵ(q)f0(q)
,
(2.3)
where we deﬁned the energy
ϵ ≡
p
q2 + a2m2
.
(2.4)
– 5 –

From the background quantities the equation of state parameter w is deﬁned as the
ratio of the pressure and energy density,
w ≡p
ρ
.
(2.5)
The speed of sound, on the other hand, may be deﬁned as the adiabatic propagation speed of
small harmonic wave perturbations over the homogeneous background. This speed is given
by
cs = ˙p
˙ρ
,
(2.6)
where dots represent derivatives with respect to conformal time. If dark matter is in kinetic
equilibrium due to elastic self interactions, the common ansatz for the background phase
space distribution is either the redshifted Fermi or Bose distributions [57]
f0 =
gs
(2π)3

exp
hϵ −aµ
aT(a)
i
± 1
−1
,
(2.7)
where the plus and minus signs correspond to fermions and bosons, respectively, T is the
gas temperature, and gs the parameter setting the degrees of freedom of the dark-matter
particle. At early times, when dark matter is relativistic, Eq. (2.7) reduces to
frel
0
=
gs
(2π)3

exp
q −µR
0
T R
0

± 1
−1
,
(2.8)
where we replaced the physical (time-dependent) temperature and chemical potentials T(a)
and µ(a) by their comoving values T R
0 and µR
0 , using the usual temperature and chemical
potential redshift expressions in the relativistic regime (which are obtained from particle
number and entropy conservation, see e.g. [58]),
T(a) = T R
0 /a
,
µ(a) = µR
0 /a
.
(2.9)
Since T R
0 and µR
0 are quantities that are set at chemical decoupling, i.e., they are ﬁxed by
the dark-matter production mechanism, we refer to them as “primordial.”
As the universe expands and dark matter cools down, the phase-space distribution may
evolve in diﬀerent ways. First, if dark matter kinetically decouples deep in the relativistic
regime (at temperatures T ≫m), as in models of warm dark matter, the phase-space distri-
bution remains frozen in the fully relativistic form Eq. (2.8). In this case, the present-time
(a = 1) number and energy densities of dark matter are obtained by using Eq. (2.8) in
– 6 –

Eq. (2.3), and are given by
n = ∓gs
(T R
0 )3
π2
Li3(∓eµR
0 /T R
0 )
ρ = mn
 
1 + 6
T R
0
m
2 Li5(∓eµR
0 /T R
0 )
Li3(∓eµR
0 /T R
0 )
!
,
(2.10)
where Lin is the polylogarithm function of order n, and the minus and plus signs in their
arguments correspond to fermions and bosons, respectively. The second term on the right
hand-side in the last line corresponds to the present-time kinetic energy, which was obtained
by using the fact that dark matter must be non-relativistic today, so we may approximate
ϵ(a = 1) =
p
q2 + m2 ∼m + q2/2m in the integrand of Eq. (2.3).
A second possibility is that dark matter remains kinetically coupled until it is non-
relativistic, which is possible in models of SIDM. In this case, at T ≪m the distribution
function Eq. (2.7) reduces to the Maxwell-Boltzmann function,
fn.r.
0
=
gs
(2π)3 exp
hµ0 −m
T0
i
exp
h
−
q2
2mT0
i
,
(2.11)
where we replaced the physical temperatures and chemical potentials by their comoving
values at present times T0, µ0 using
T(a) = T0a−2
,
µ(a) = m + (µ0 −m) T(a)/T0
.
(2.12)
In this case, the present time (a = 1) number and energy densities of dark matter are obtained
by using Eq. (2.11) in Eq. (2.3), and are given by
n = gs
T0m
2π
3/2
exp
hµ0 −m
T0
i
ρ = mn

1 + 3T0
2m

,
(2.13)
where as before, we expanded the energy density using ϵ(a = 1) =
p
q2 + m2 ∼m + q2/2m.
Expression Eq. (2.13) is valid both for fermions and bosons.
A ﬁnal possibility is that dark-matter decouples while semi-relativistic, at temperatures
T ∼m. In the sudden decoupling approximation, the distribution function is in this case
obtained by ﬁxing the scale factor and temperatures at decoupling in Eq. (2.7) 2. An even
simpler alternative is to use the sudden transition approximation, where we approximate the
frozen-out distribution functions by Eq. (2.8) if the particle decouples while relativistic, and
2A discussion on corrections to the sudden decoupling approximation can be found in [59, 60].
– 7 –

to Eq. (2.11) if it decouples while non-relativistic. For our purposes, i.e. studying the ob-
servable eﬀects of self interactions in the matter-power spectrum, using the sudden transition
approximation will suﬃce, for two reasons. First, these eﬀects are phenomenologically most
relevant if the dark sector is kinetically coupled when modes that matter for the Lyman-α
forest or other small-scale observables enter the horizon. We will show that this requires large
cross section values that also ensure that the dark sector is coupled until deep into the non-
relativistic regime, in which case its distribution function is to an excellent approximation
Boltzmann-like. Second, even when studying the phenomenological signatures left by models
with smaller cross sections, we will show in concrete examples that the precise form of the
dark-matter phase-space distribution has a numerically small eﬀect on observables associated
with the small-scale matter-power spectrum. Thus, in what follows we will commit to the
sudden transition approximation. We discuss further details of this approximation and the
process of kinetic decoupling in sections 2.3 and 2.4.
Now, it is important to note that the present-time temperature and chemical potential
T0, µ0 in the distribution Eq. (2.11), which corresponds to a particle that decouples while non-
relativistic, are diﬀerent from their primordial comoving values T R
0 , µR
0 . In other words, a dark
sector that when relativistic had a temperature and chemical potential given by Eq. (2.9) and
that decouples while relativistic, has a present-time temperature T R
0 and chemical potential
µR
0 . On the other hand, a dark sector that starts with the same temperature and chemical
potential as in Eq. (2.9), but stays kinetically coupled as it becomes non-relativistic, evolves
in such a way that it has a present temperature and chemical potential T0, µ0 ̸= T R
0 , µR
0 .
With that being said, T0, µ0 are not independent parameters, as they can be related to the
primordial temperatures T R
0 , µR
0 by computing the dark-matter evolution. These relations
are important for our purposes, as in order to fairly compare bounds on WDM versus bounds
on SIDM, we must compare models that diﬀer only by their self-interaction strengths, but
that otherwise have the same primordial temperatures and chemical potentials.3
The relations between T0, µ0 and T R
0 , µR
0 can be found in two ways. The ﬁrst one is
to calculate the evolution of kinetically coupled dark matter as it goes through the semi-
relativistic regime around T ∼m. Around these temperatures, the phase-space distribu-
tion evolves semi-adiabatically from its relativistic Fermi/Bose form into the non-relativistic
Boltzmann function, and the temperature and chemical potential have a non-trivial evolu-
tion, which diﬀers from the simple expressions Eqs. (2.9) or (2.12), but which matches onto
Eqs. (2.9) and (2.12) at high and low temperatures correspondingly [59]. An alternative and
much simpler way to obtain T0, µ0 in terms of T R
0 , µR
0 is by relating them using the fact that
3More precisely and as we will see later, for a given particle statistics, this is equivalent to comparing
models that have the same comoving or present-time velocity dispersion.
– 8 –

dark-matter number and energy densities are not modiﬁed by elastic collisions, as we now
discuss.
2.2
Matching the relativistic and non-relativistic regimes in the presence of self
interactions
As noted above, the presence of collisions leads to a non-trivial evolution of the dark-matter
temperature and chemical potential in the relativistic to non-relativistic transition period.
However, if the collisions are elastic they cannot change the number and kinetic energy
densities that dark matter ends up having at present times. As a consequence, these two
quantities can be calculated at present times either in the presence or absence of collisions,
resulting in Eq. (2.10) or Eq. (2.13), and both results must coincide.
This leads to two
relations between T R
0 , µR
0 and T0, µ0, given by
∓gs
(T R
0 )3
π2
Li3(∓eµR
0 /T R
0 ) = gs
T0m
2π
3/2
exp
hµ0 −m
T0
i
(number density matching)
(2.14)
∓6gs
(T R
0 )5
mπ2 Li5(∓eµR
0 /T R
0 ) =
3gs
4
√
2π3/2 T 5/2
0
m3/2 exp
hµ0 −m
T0
i
(energy density matching)
(2.15)
where the minus and plus signs in their arguments corresponds to fermions and bosons,
respectively.
The matching conditions can be simpliﬁed by equating the ﬁrst line of Eq. (2.13) to
the present dark-matter number density ρDM/m, ρDM = 1.26 × 10−6 GeV/cm3 [61]. In this
way, we may express the present-time chemical potential µ0 as function of the dark-matter
density,
exp
hµ0 −m
T0
i
=
 2π
T0m
3/2 ρDM
gsm
,
(2.16)
so that using Eq. (2.16) in the matching conditions (2.14) and (2.15), we can rewrite these
conditions in the simpliﬁed form
∓gs(T R
0 )3
π2
Li3(∓eµR
0 /T R
0 ) = ρDM
m
(number density matching)
(2.17)
∓6 gs(T R
0 )5
mπ2
Li5(∓eµR
0 /T R
0 ) = 3
2
T0ρDM
m
(energy density matching).
(2.18)
Expressions (2.17) and (2.18) allow us to obtain the primordial temperature and chemical
potentials in terms of the present-time dark-matter density and temperature, or vice-versa,
as long as dark matter remains kinetically coupled through the transition from the relativistic
to non-relativistic regimes.
– 9 –

All functions of conserved quantities are also unaﬀected by the elastic collisions. One
particularly important such function is the dark-matter velocity dispersion, which by energy
conservation stays constant as it is simply proportional to the kinetic energy. We ﬁrst deﬁne
the comoving velocity u by
u ≡q/m
,
(2.19)
and note that the comoving velocity u coincides with the present-time particle velocity in the
non-relativistic regime. Thus, the present-time velocity dispersion squared

u2
/3 is given
by
1
3

u2
=
1
3ρDM/m
Z
d3q q2
m2 f0(q)
.
(2.20)
For fermions and bosons presently described by the relativistic distribution function Eq. (2.8),
the comoving velocity dispersion is
1
3

u2
= ∓4gs(T R
0 )5
mπ2ρDM
Li5(∓eµR
0 /T R
0 ) = 4 Li5(∓eµR
0 /T R
0 )
Li3(∓eµR
0 /T R
0 )
T R
0
m
2
(2.21)
where the minus and plus signs correspond to fermions and bosons respectively, and in the
second equality we made use of Eq.
(2.17) to illustrate that

u2
∝(T R
0 /m)2.
On the
other hand, if the dark matter remains kinetically coupled and is currently described by the
non-relativistic distribution Eq. (2.11), its comoving velocity dispersion squared is
1
3

u2
= T0
m
.
(2.22)
Since the comoving velocity dispersion is not aﬀected by collisions, given a primordial tem-
perature T R
0 ,

u2
is the same either if the dark matter decouples relativistically (leading to
(2.21)) or non-relativistically (leading to (2.22)). In fact, as a consistency check it is easy
to see that equating (2.22) and (2.21) leads to the same matching condition Eq. (2.18) that
ﬁxes T0 as a function of T R
0 .
A particular example that we will discuss later extensively, is the special case of a
vanishing primordial chemical potential, µR
0 = 0. This case is interesting as it is the closest to
models of WDM, which chemically decouple while relativistic (and without large asymmetries
in global quantum numbers) so their phase-space distribution is expected to have µR
0 = 0.
In this case, the matching conditions (2.17) and (2.18) reduce to
gsξnζ(3)
π2
(T R
0 )3 = ρDM
m
(2.23)
gsξρζ(5)
mπ2
(T R
0 )5 = 3
2
T0ρDM
m
,
(2.24)
where ζ is the Riemann zeta function, and ξn, ξρ are numerical coeﬃcients. For fermions
they are ξn = 3/4, ξρ = 45/8, while for bosons ξn = 1, ξρ = 6. Combining Eqns. (2.23) and
– 10 –

(2.24), we obtain the relation
T0 = 2ξρζ(5)
3ξnζ(3)
(T R
0 )2
m
.
(2.25)
In the special case µR
0 = 0, the velocity dispersion of the dark matter if its current
phase-space distribution is non-relativistic is simply Eq. (2.22), while if it is relativistic it is
given by
1
3

u2
= 4gsξρζ(5)(T R
0 )5
6mπ2ρDM
= 4ξρζ(5)
6ξnζ(3)
T R
0
m
2
(2.26)
where in the second equality we made use of (2.23). Note that in order for relativistic bosonic
or fermionic relics to have the same velocity dispersion today, their primordial temperatures
T R
0 must be slightly diﬀerent, given the diﬀerences in ξv. Also, note that using Eq. (2.23),
one obtains that the velocity dispersion is
p
⟨u2⟩/3 ∝T R
0 /m, as expected.
Using Eq. (2.23), we can also calculate the dark-matter mass required to obtain the
correct relic abundance as a function of its primordial temperature. We obtain
m =
π2
ξnζ(3)
ρDM
gs(T R
0 )3 =









4.1

0.1 TSM
T R
0
3
2
gs

keV
fermions
3.1

0.1 TSM
T R
0
3
2
gs

keV
bosons
,
(2.27)
where TSM is the current CMB temperature. Alternatively, using Eqns. (2.21) and (2.22),
the masses can be obtained in terms of the current velocity dispersion. For dark matter that
decouples while either relativistic or non-relativistic, we obtain
m = √π
ρDM
gs
1/42ζ(5)ξρ
⟨u2⟩
3/8
1
ξnζ(3)
5/8
=









4.7

10−8
√
⟨u2⟩/3
3/4
2
gs
1/4
keV
fermions
4.0

10−8
√
⟨u2⟩/3
3/4
2
gs
1/4
keV
bosons
.
(2.28)
2.3
Phase-space distributions in the sudden transition approximation
Throughout this work, the exact relations between the primordial and present temperatures
and chemical potentials derived above will be used. However, the precise shape of the phase-
space distribution during the transition from the relativistic to the non-relativistic regimes,
which as commented before is less important, will be approximated by committing to a sharp
transition between the distributions Eq. (2.8) and (2.11) at a transition scale factor aNR. In
order to avoid discontinuities in the speed of sound, which will play an important role in the
study of structure formation, we choose the transition scale factor to be the one for which
the speed of sound of a relativistic ﬂuid cR
s = 1/
√
3 matches the speed of sound of a non-
relativistic ﬂuid cn.r.
s
=
q
γT
m (where γ = 5/3 is the monoatomic polytropic index). At this
– 11 –

scale factor, the physical temperature of the dark matter is
TNR ≡m
3γ = 1
5 m
.
(2.29)
The scale factor at the transition temperature can now be found using Eq. (2.12), giving
aNR =
r
3γT0
m
=
p
γ ⟨u2⟩
,
(2.30)
where γ = 5/3 and in the second equality we made use of Eq. (2.22), to show that the
transition scale factor aNR is, up to an order one number, equal to the present dark-matter
velocity dispersion
p
⟨u2⟩/3. In terms of aNR, the speed of sound in our approximation is
simply given by
cs =







1/
√
3
a < aNR
aNR/(
√
3a)
a > aNR
,
(2.31)
which is a manifestly continuous function across the transition scale factor aNR. We stress
that our expression for the speed of sound is exact deep in the relativistic and non-relativistic
regimes, and is only approximate around a ∼aNR.
Summarizing, within our sudden transition approximation, the self-interacting dark-
matter distribution function is
f0(u) =
gs
(2π)3

exp
mu −µR
0
T R
0

± 1
−1
a ≤aNR
(2.32)
f0(u) =
gs
(2π)3 exp
hµ0 −m
T0
i
exp
h
−mu2
2T0
i
a > aNR
(2.33)
where aNR is given by Eq. (2.30), the primordial temperature and chemical potential T R
0
and µR
0 are exactly related to their present values T0, µ0 by Eq. (2.15), and in going from
Eqns. (2.8) and (2.11) to Eqns. (2.32) and (2.33) we made use of Eq. (2.19).
We conclude this section by commenting on a few important points regarding the back-
ground distribution functions Eqns. (2.32) and (2.33). First, up to the order one dark-matter
parameter gs, the distribution functions are completely described by three parameters: the
dark-matter mass m, and its temperature and chemical potential. These three parameters
are not independent, as a relation between them is set by ﬁxing the dark-matter abundance
via Eq. (2.17). In practice, we choose the primordial chemical potential µR
0 and the comov-
ing velocity dispersion
p
⟨u2⟩/3 (or equivalently aNR, c.f. Eq. (2.30)) given in Eqn. (2.21),
as the two independent parameters describing the distribution functions. We choose these
parameters, since the primordial chemical potential can be directly related with the way in
which dark matter was produced, and the velocity dispersion determines if dark matter is
– 12 –

hot, warm, or cold. In addition, and as discussed previously, the velocity dispersion has the
convenient property that it is unaﬀected by collisions, i.e., dark matter particles with some
given current velocity dispersion and a given spin, have the same primordial temperature
T R
0 /a at early times, regardless if the dark matter kinetically decoupled while relativistic or
non-relativistic. Second, the distribution functions Eqns. (2.32) and (2.33) are independent
of the scale factor a. This is as a result of the adiabatic evolution of the temperature and
chemical potentials. As a consequence, from Eq. (2.3) we see that in the relativistic regime,
where we set the energy to ϵ = q, the dark-matter energy density redshifts as 1/a4, while in
the non-relativistic regime, with ϵ = am, the energy density redshifts as 1/a3, as expected.
2.4
Kinetic decoupling
As discussed above, if dark matter remains in kinetic equilibrium up to late times its back-
ground distribution function adiabatically evolves from the Fermi/Bose relativistic form into
the Boltzman form, thanks to redistribution of momenta due collisions. However, for small
enough cross sections, dark matter may fall out of kinetic equilibrium while still relativistic,
as in models of warm dark matter, or while semi-relativistic. Kinetic equilibrium is lost once
the self-interaction time τ(a) becomes larger than the Hubble time.
τ(a) ≡
ρDM(a)
m
⟨σv(a, aNR)⟩
−1
≥H−1(ad)
,
(2.34)
where ad is the scale factor at decoupling and v is the relative velocity between dark-matter
particles. As an example, for the special case of decoupling during radiation domination,
using Eq. (2.34) and approximating the relative dark-matter velocity by v = 1 for a < aNR
and v = aNR/a for a > aNR, we obtain the decoupling scale factor,4
ad = 5.67 · 10−3 √aNR

σ/m
10−5 cm2/g
1/2
.
(2.35)
After decoupling, the distribution function remains frozen in the relativistic form Eq. (2.32)
if ad ≤aNR (as in warm dark-matter models), in the non-relativistic form Eq. (2.33) if
ad > aNR (as in typical WIMP models), or in a semi-relativistic form if ad ∼aNR. The
subsequent evolution of the dark matter, in particular of the dark-matter perturbations to
be studied in the following section, depends on the frozen-out distribution function. Since
we make use of the sudden transition approximation, we simply freeze out the dark-matter
4Here we have taken the scattering cross section to be constant in order to obtain the decoupling redshift.
This is a rather unrealistic assumption as in concrete particle physics models the cross section usually has
some momentum dependence, especially in the relativistic regime. We will come back to this issue in section 5,
where we study a concrete model realization of SIDM.
– 13 –

phase-space distribution in its fully relativistic form (2.32) if ad ≤aNR, or in the fully non-
relativistic form (2.33) if ad > aNR.
We comment now brieﬂy on when errors may arise by committing to the sudden tran-
sition approximation. If the dark-matter distribution freezes out at a scale factor ad ∼aNR,
it does so in a semi-relativistic shape, which as discussed before diﬀers from the fully rel-
ativistic or non-relativistic forms. This happens only for a speciﬁc combination of the two
model parameters of self-interaction cross section and transition scale factor aNR (or dark-
matter velocity dispersion). This coincidental combination is obtained by setting ad = aNR
in Eq. (2.34), and is given by the special value ad,NR. As an example, for the special case of
decoupling during radiation domination this gives
ad,NR = 3.22 · 10−5

σ/m
10−5 cm2/g

.
(2.36)
As a consequence, we expect our sudden transition approximation to have somewhat larger
errors in the regions of parameter space where (2.36) is approximately fulﬁlled. In our analysis
of the dark-matter perturbations we will clearly identify the regions of parameter space where
the dark matter decouples semi-relativistically, in order to know where there might be small
errors that arise from our approximation.
3
Cosmological dark-matter perturbations
We now move on to the calculation of the evolution of self-interacting dark-matter pertur-
bations on top of the homogeneous background.
Dark-matter perturbations behave diﬀerently in the kinetically coupled and decoupled
regimes. In the former case, perturbations are described by oscillating sound waves, which
imprint a dark sound horizon on the matter-power spectrum. After decoupling, on the other
hand, perturbations free-stream and are smoothed out due to transport from over-dense into
under-dense regions.
The sound horizon and free-streaming scales are the most relevant
dynamical quantities for understanding dark-matter perturbations, so we dedicate section
3.1 to study the parametrics of these two simple thermodynamic scales.
A precise calculation of the matter-power spectrum requires solving numerically the
Boltzmann equations for the evolution of the dark matter and Standard Model perturbations.
With this purpose, we implement a new Boltzmann code that computes the evolution of
the dark matter and Standard Model perturbations.5 We divide the evolution of the dark
matter into two regimes—kinetically coupled and decoupled—and describe the corresponding
5We found that implementing all the required changes in existing Boltzmann solvers such as CLASS [62]
would require signiﬁcant modiﬁcations over the public versions, which was more cumbersome to us than
implementing our own code.
– 14 –

evolution equations in sections 3.2 and 3.3. Diﬀerently from the case of cold non-interacting
dark matter, the evolution must account for the possibility of dark-matter diﬀusion, free
streaming and sound waves, and for the change of a relativistic into a non-relativistic phase-
space distribution.
3.1
Free-streaming and sound waves
In the absence of self interactions, a dark-matter particle free streams at its physical velocity
dx/dη = v(η), where x are comoving coordinates and η is the conformal time. Free-streaming
suppresses dark-matter perturbations on scales below the distance travelled by dark matter,
which is given by
ℓfs(η) ≡
Z η
0
dη′ v(η′)
.
(3.1)
Since growth of matter perturbations happens mostly during matter domination, a useful
quantity to evaluate the suppression of perturbations is the free-streaming length up to
matter-radiation equality ℓfs(ηeq) [58]. This scale can be easily estimated by splitting the
integral over the early period in which the dark matter travels relativistically, and over the
later period in which its velocity redshifts with the scale factor as 1/a. The transition between
the two periods happens at a scale factor aNR deﬁned in Eq. (2.30), which is (up to an order
one factor) equal to the present dark-matter velocity dispersion. Approximating v = 1 for
a < aNR and v = aNR/a for a > aNR we obtain
ℓfs(aNR, a)|a=aeq =
Z aNR
0
da
Ha2 +
Z aeq
aNR
da
Ha2
aNR
a
=
1
H0√aeq
 Z aNR
0
da +
Z aeq
aNR
daaNR
a

=
aNR
H0√aeq

1 + ln
 aeq
aNR

(3.2)
where in going to the second line we approximated Hubble at radiation domination by
H(a) = H0√aeq/a2, and in each line the ﬁrst and second terms correspond to free stream-
ing during the relativistic and non-relativistic regimes. Note that both the relativistic and
non-relativistic period end up contributing in a similar order to the free-streaming length,
∼aNR/(H0√aeq), with the non-relativistic piece having in addition an order one logarithmic
enhancement on top. Numerically, we obtain
ℓfs(aNR, a)|a=aeq = 233 kpc
 aNR
10−7
 1 + ln
 aeq/aNR

1 + ln
 aeq/10−7

,
(3.3)
where we normalized to scales of order O(100kpc), since they are the smallest scales that can
be probed using the Lyman-α forest, and the logarithmic enhancement factor is ln
 aeq/10−7
≃
8. From Eq. (3.3) we see that free-streaming dark matter with velocity dispersion ∼aNR ≳
– 15 –

10−7 would be in tension with Lyman-α measurements (a much more precise analysis pre-
sented later will indicate that the Lyman-α bounds are closer to aNR ≳few × 10−8).
If dark matter has self interactions, on the other hand, it does not free stream but there
is still suppression of power at small scales, now due to pressure support. The relevant length
scale to describe self-interacting dark matter is the sound horizon, deﬁned as
rs(η) ≡
Z η
0
dη′cs(η′)
,
(3.4)
where cs is the dark-matter speed of sound Eq. (2.31). In particular, the sound horizon at
the time of dark kinetic decoupling gives an estimate of the characteristic scales below which
the growth of perturbations is aﬀected by pressure support. To simplify the estimation of the
sound horizon, in this section we assume that dark matter decouples before matter-radiation
equality (but otherwise in the rest of this work we allow for decoupling at all times). With
this assumption, the sound horizon at decoupling is given by
rs(aNR, a)|a=ad =
aNR
H0
p3aeq

1 + ln
 ad
aNR

≃233
√
3
 aNR
10−7
 1 + ln
 ad/aNR

1 + ln
 ad/10−7

kpc
(3.5)
where ad is the scale factor at decoupling, given as a function of the dark-matter cross section
in Eq. (2.35). There are two important characteristics to point out regarding this result. First,
note that the sound horizon Eq. (3.5) is parametrically equal to the free-streaming scale (3.2),
as they are both of order aNR/(H0√aeq). This means that the presence or absence of self
interactions does not lead to a signiﬁcant modiﬁcation of the scale below which dark-matter
perturbations are damped, as pointed out in [11]. Qualitatively, however, free streaming and
pressure support lead to diﬀerent suppression mechanisms: while free-streaming amounts to
a monotonic decrease of power at small scales, pressure support leads to acoustic oscillations.
Second, note that the sound horizon depends only logarithmically on the self-interaction cross
section, which enters in the decoupling scale factor ad. As a consequence, power suppression
due to pressure support is mostly controlled by the velocity dispersion
p
⟨u2⟩/3 ∼aNR, and
has a mild (but non-negligible) dependence on the particle physics parameters controlling
the elastic self interactions.
We compare the sound horizon and free-streaming lengths in Fig. 1, for decoupling and
transition scale factors ad = 10−4, aNR = 10−7. At large redshift, both the free-streaming and
sound horizon lengths grow linearly with the scale factor, and follow closely the comoving
horizon size 1/aH(a), but at a ∼aNR they moderate their growth to logarithmic due to the
redshift of the particle velocity or speed of sound. From the ﬁgure, we also clearly see that
both the free-streaming scale and the sound horizon asymptote to values of the same order
at present times.
– 16 –

-
-
-
-
-
-
-
-
	






Figure 1. Comoving sound-horizon rs and free-streaming ℓfs scales as a function of the scale fac-
tor, for a particle that self interacts or free streams. In black we also show the comoving horizon,
1/(aH(a)). We assume that the self-interacting species kinetically decouples at ad = 10−4, and be-
comes non-relativistic at aNR = 10−7. Up to decoupling, the diﬀerence between the sound horizon
and free-streaming lengths is only a factor of 1/
√
3.
3.2
Evolution of dark-matter perturbations: kinetically coupled regime
The dark-matter perturbations over the homogeneous background are contained in the func-
tion Ψ deﬁned in Eq. (2.1). Following the treatment and notation of [55], we expand the
perturbation in a Legendre series,
Ψ(⃗k, q, ˆn, a) =
∞
X
l=0
(−i)l(2l + 1)Ψl(⃗k, q, a)Pl(ˆk · ˆn)
,
(3.6)
where ⃗k is the comoving spatial Fourier mode and ⃗q = qˆn is the comoving particle momentum.
The ﬁrst two moments of the Legendre hierarchy are related to the ﬂuid’s density δDM
and velocity perturbations θDM by
δDM =
4π
ρDMa4
Z
q2dqϵf0(q)Ψ0
,
θDM =
4πk
ρDM(1 + w)a4
Z
q3dqf0(q)Ψ1
,
(3.7)
where ϵ is the energy Eq. (2.4) and w is the equation of state parameter Eq. (2.5). The
second moment is related to the ﬂuid’s anisotropic stress σDM
σDM =
8π
3ρDM(1 + w)a4
Z
q2dqq2
ϵ f0(q)Ψ2
.
(3.8)
– 17 –

(The ﬂuid’s anisotropic stress should not be confused with the dark-matter self-interaction
cross section, for which the same letter σ is conventionally used.) Working in the conformal
Newtonian gauge, the evolution equations for the dark-matter density and velocity pertur-
bations are [55]
˙δDM = −(1 + w)(θDM −3 ˙φ) −3Hη

c2
s −w

δDM
,
˙θDM = −Hη(1 −3w)θDM −
˙w
1 + wθDM +
c2
s
1 + wk2δDM −k2σDM + k2ψ
,
(3.9)
where all derivates are with respect to conformal time, and the conformal Hubble parameter
is deﬁned as
Hη ≡˙a
a
.
(3.10)
In Eq. (3.9) cs is the adiabatic dark-matter speed of sound. The variables φ and ψ are the
conformal Newtonian potential perturbations. Their evolution is given by
˙φ =
1
3Hη
h
−4πGa2
ργ(a)δγ + ρν(a)δν + ρDM(a)δDM + ρb(a)δb

−3H2
ηψ −k2φ
i
,
ψ = −1
k2

12πGa2(¯ρ + ¯P)σ

+ φ
,
(3.11)
where the indices γ, ν, b refer to the Standard Model photon, neutrino, and baryons, and
(¯ρ + ¯P)σ is the anisotropic stress weighted and averaged over all the matter and radiation
components according to
(¯ρ + ¯P)σ ≡
X
i
(ρi + Pi)σi
,
(3.12)
with i = DM, γ, ν, b, and ρi and Pi are the background energy density and pressure of each
component. We describe the treatment of the Standard Model perturbations in appendix A.
For a scale factor a < ad (c.f. Eq. (2.35)) dark matter is kinetically coupled and can be
treated as a close to perfect ﬂuid. Collisions ensure that higher moments of the Boltzmann
distribution, Ψl≥2 remain small, so that deviations from the perfect ﬂuid situation can be
characterized by small anisotropic stress terms, which are due to dark-matter diﬀusion. In
this case, we make a series of approximations that signiﬁcantly simplify the computation of
the evolution of dark-matter perturbations.
First, the speed of sound cs can be approximated by expression Eq. (2.31), which cor-
rectly describes the speed of sound of kinetically coupled dark matter in the non-relativistic
or relativistic regimes. In the semi-relativistic regime such an expression leads to small errors
in the evolution of perturbations. However, it is easy to see that such errors are not important
for the phenomenological study of this model. As pointed out in section 3.1, dark-matter
models that are semi-relativistic at a scale factor equal or greater than aNR ∼few × 10−8
will be in tension with Lyman-α observations. From Fig. 1 we see that at such transition
– 18 –

scale factor, the modes that are entering the horizon are of order ∼10 kpc. These scales
are below what is observable with current power-spectrum probes, so the small errors of our
approximation during the semi-relativistic regime are phenomenologically irrelevant.
Second, the equation of state parameter can be computed from its evolution equation
given by [63]
˙w = 3Hη(1 + w)(w −c2
s)
.
(3.13)
Using Eq. (2.31), we approximate the solution of (3.13) to w = c2
s = 1/3 in the relativistic
regime, and w ≃T/m = 3/5 c2
s in the non-relativistic regime.
Finally, when the ﬂuid is close to perfect the anisotropic stress can be computed as a
function of the dark-matter velocity perturbation θDM, without the need to compute higher
moments in the Boltzmann hierarchy Ψl≥2, using the relaxation time approximation. We lay
out the assumptions of this approximation and compute the resulting anisotropic stress in
appendix C. The relaxation time approximation gives
σDM =







4
15aθDMτ(a)
a < aNR
4a
15a2
NR θDMτ(aNR)
a > aNR
,
(3.14)
where τ is the self-interaction time, given in Eq. (2.34). As expected, in the inﬁnite-cross
section limit, τ = 0, and the anisotropic stress vanishes so that dark matter reduces to a
perfect ﬂuid. Note also that within our quasi-perfect ﬂuid approximation, the dark-matter
perturbations can be evolved without any reference to the speciﬁc shape of the background
dark-matter distribution f0. Only averaged thermodynamic properties such as the speed of
sound and equation of state parameter are relevant for calculating dark-matter perturbations
while it remains kinetically coupled.
3.3
Evolution of dark-matter perturbations: decoupled regime
At the scale factor a = ad (c.f. Eq. (2.35)) dark matter kinetically decouples and starts
free streaming. The subsequent evolution cannot be computed within the close to perfect
ﬂuid approximation of the previous section, as higher moments of the Boltzmann distribution
become relevant and the relaxation time approximation breaks down. Therefore, for a ≥ad
we directly compute the evolution of the higher moments as follows. First, for evolving modes
(modes inside the horizon) at a = ad we must match the dark-matter density and velocity
perturbations δDM and θDM, computed in the kinetically coupled regime, to the Boltzmann
– 19 –

moments Ψl. We calculate the matching conditions in appendix D. They are given by
Ψ0 = −ξδ
δDM
4
d ln f0
d ln q
Ψ1 = −θDM
3
ϵ
kq
d ln f0
d ln q
Ψ2 = −2θDMH−1
η
15
d ln f0
d ln q
Ψl≥3 = 0
(3.15)
where ξδ = 1, ϵ = q or ξδ = 4/3, ϵ = adm if the dark matter is relativistic or non-relativistic
at matching. For non-evolving modes that are outside the horizon at a = ad, the density and
velocity perturbations are frozen before horizon entry. In this case, we perform the matching
at a > ad but much before horizon crossing, using ξδ = 1, ϵ = q or ξδ = 4/3, ϵ = adm if the
dark matter is relativistic or non-relativistic at crossing.
The subsequent evolution of the Boltzmann moments is then computed using [55],
˙Ψ0 = −qk
ϵ
−˙φd ln f0
d ln q
˙Ψ1 = qk
3ϵ (Ψ0 −2Ψ2) −ϵk
3qψd ln f0
d ln q
˙Ψl≥2 =
qk
(2l + 1)ϵ

lΨl−1 −(l + 1)Ψl+1

,
(3.16)
where φ and ψ are the conformal Newtonian potentials, which are evolved according to
Eq. (3.11).
The dark-matter density, velocity, and anisotropic stress perturbations, re-
quired to solve for the potentials, are obtained by integrating the Boltzmann moments using
Eqns. (3.7) and (3.8). Note that both the matching conditions Eq. (3.15) and the evolution
equations Eq. (3.16) for the moments depend on the background phase space distribution f0,
which is frozen out in a relativistic or non-relativistic form depending when kinetic decou-
pling happens, as discussed in section 2.4. The distribution is thus given by Eq. (2.32) for
ad ≤aNR or by Eq. (2.33) for ad > aNR.
Since the hierarchy of moments is inﬁnite, it must be truncated. We use the truncation
prescription of [55],
Ψlmax+1 = (2lmax + 1)ϵ
qkη
Ψlmax −Ψlmax−1
(3.17)
The truncation must be done at a suﬃciently high value of lmax to avoid large errors. In our
computations we take lmax = 30, which we ﬁnd to be suﬃcient.
3.4
Numerical procedure
To solve for the dark matter and Standard Model perturbations, we write a C program con-
taining the code for the evolution equations. The numerical procedure starts at a redshift
– 20 –

z = 1010, where modes of comoving size ∼0.05 kpc enter the horizon, with horizon-crossing
initial conditions as in [55, 64] and cosmological parameters from [61]. We solve the diﬀeren-
tial equations implementing the adaptive step size Runge-Kutta-Fehlberg RF45 algorithm.
We decrease the algorithm’s error tolerance until we ﬁnd stable solutions. When solving for
the dark-matter Boltzmann moments, we discretize the velocity space q = mu (c.f. Eq. (2.19))
in 30 steps from u = 0 to u = 6aNR. We checked that increasing q beyond the chosen upper
limit or decreasing the discretization size of q space does not lead to signiﬁcant changes in
our results. We perform the q integrals in Eqns. (3.7) and (3.8) using Riemann’s method.
4
Results
We now present the results of our analysis of the power spectrum of self-interacting dark
matter.
In section 4.1, we present the power spectrum for diﬀerent choices of the self-
interaction cross section and dark-matter velocity dispersion. In section 4.2, we set limits
using Lyman-α observations.
4.1
SIDM power spectrum
The self-interacting dark matter-power spectrum is controlled mostly by two parameters:
the current dark-matter velocity dispersion
p
⟨u2⟩/3 and the cross section over the dark-
matter mass σ/m. In addition, in order to specify the dark-matter phase-space distribution,
the primordial dark-matter chemical potential µR
0 needs to be ﬁxed.
In this section for
simplicity, and to be able to directly compare with warm dark-matter models, we set µR
0 = 0
(we comment on the µR
0 ̸= 0 case in the next section). Note that for µR
0 = 0, the dark-matter
mass is ﬁxed by its velocity dispersion using Eqns. (2.27) and (2.24) when dark matter
kinetically decouples while non-relativistic.
With this choice, we present the dark-matter-power spectrum for
p
⟨u2⟩/3 = 2 × 10−7
(left panel),
p
⟨u2⟩/3 = 1 × 10−7 (middle panel), and
p
⟨u2⟩/3 = 2 × 10−8 (right panel), for
three values of cross section in Fig. 2. Let us ﬁrst discuss the case
p
⟨u2⟩/3 = 2×10−7. Here
we clearly see that for all three choices of cross section the power spectrum is suppressed
at scales k ≳5 h/Mpc.
This is consistent with our discussion in section 3.1, where we
found that for both self-interacting and collisionless dark matter, the suppression of power
on small scales is determined mostly by the dark-matter velocity dispersion and has only a
weak dependence on the cross section. However, and as expected, the nature of the power
suppression is diﬀerent for the diﬀerent values of cross section: for σ/m = 0 we see a sharp and
smooth power cutoﬀ, which is due to free-streaming, while for σ/m = 1 cm2/g we see instead
suppression of power due to acoustic oscillations, with the period of the momentum-space
acoustic oscillations being determined by the inverse of the dark-matter sound horizon. The
– 21 –

Figure 2. Linear matter-power spectrum for SIDM with velocity dispersion
p
⟨u2⟩/3 = 2×10−7 (left
panel),
p
⟨u2⟩/3 = 10−7 (middle panel), and
p
⟨u2⟩/3 = 10−8 (right panel), for elastic self-interaction
cross sections σ/m = 0, σ/m = 10−3cm2/g and σ/m = 1cm2/g. For these velocity dispersions and
for a fermion with a vanishing primordial chemical potential, µR
0 = 0, the corresponding dark-matter
masses are 0.49 keV, 0.83 keV, and 4.67 keV, respectively (see Eq. (2.28)).
situation for σ/m = 10−3 cm2/g is somewhat in-between the σ/m = 0 and σ/m = 1 cm2/g
cases. For σ/m = 10−3 cm2/g we see that the period of the momentum-space oscillations is a
factor of few larger than for σ/m = 1 cm2/g, a feature that is indicative of the smaller sound-
horizon obtained for smaller cross-sections, c.f. Eq. (3.5). From the ﬁgure it is clear that by
measuring the period, or more generally, the full shape of the acoustic oscillations, information
regarding the dark-matter self-scattering cross section can in principle be obtained.6
In
addition, from the ﬁgures we observe that models with self-interactions contain more power
than WDM models at wave numbers below the characteristic sound-horizon or free-streaming
scales. For instance, for
p
⟨u2⟩/3 = 2 × 10−7, for which πr−1
s /2 ∼10 Mpc/h, with rs being
the sound horizon at matter-radiation equality, models with σ/m = 1 cm2/g have more
power at k ∼3h/Mpc than σ/m = 0 models with the same velocity dispersion. This is a
manifestation of the strength of the power suppression of WDM, which scales as a high power
of wave number (as can be seen from analytic approximations to the WDM transfer function,
see e.g.
[65]), while the envelope of pressure-induced power suppression characteristic of
SIDM is relatively milder [58]. This feature is also partially associated to the fact that the
free-streaming scale of WDM models is a factor of
√
3 larger than the sound-horizon scale of
6It is important to note however that current bounds on the SIDM velocity dispersion (to be discussed in
section 4.2) are at the level of
p
⟨u2⟩/3 ≲1 × 10−8. Thus, the power spectrum of models that have acoustic
oscillations and are not yet ruled out looks like the one presented in Fig. 2, right panel. From that ﬁgure, it
is clear that in allowed models the acoustic oscillations are fully visible only at very small scales, which are
experimentally inaccessible at present.
– 22 –

SIDM models, for the same velocity dispersion.
To illustrate the dependence of the power spectrum suppression on the velocity disper-
sion, take now the case
p
⟨u2⟩/3 = 1 × 10−7 presented in the right panel of Fig. 2. In this
case, we see that the cutoﬀin the power spectrum moves towards higher values of wavenum-
ber when compared with our previous larger choice of
p
⟨u2⟩/3. This result conﬁrms the
linear dependence of both the free-streaming length and sound-horizon scales on the velocity
dispersion, discussed in section 3.1. For
p
⟨u2⟩/3 = 2×10−8 we still see suppression of power
on small scales for all the three values of cross sections (we zoom on the the smallest scales
in the inset for clarity). In this case, however, a whole acoustic oscillation is not completed
up to scales k = 20 h/Mpc for the cases of non-vanishing σ/m. Thus, up to these scales,
the diﬀerence in self-interaction strengths can only be distinguished by the amount of power
suppression, which still depends on σ/m, as clearly seen in the ﬁgure inset.
4.2
Bounds from Lyman-α
The suppression of power on small scales due to acoustic oscillations or free-streaming leads
to eﬀects that can be measured in the ﬂux power spectrum of Quasi Stellar Objects (QSO).
The ﬂux power spectrum of such objects presents a series of hydrogen absorption peaks due
to baryonic clouds along the line of sight to the QSO, which absorb light at the Lyman-α
frequency, at diﬀerent redshifts. A decrease of the matter-power spectrum on small scales
leads to fewer baryonic gas clouds, which in turn leads to less Lyman-α absorption.
In order to set bounds on dark-matter models using such probes, hydrodynamical simu-
lations are required in order to obtain the ﬂux-power spectrum for a given model and compare
the results to data (see e.g. [27]). In order to circumvent these complications, here we make
use of a simpliﬁed prescription developed in [66, 67] referred to as the “area criterion.” This
prescription allows us to set bounds on models by comparing their small-scale power spec-
trum suppression, quantiﬁed by an “area estimator,” with the corresponding suppression
in a reference model known to be excluded from full hydrodynamical simulations and data
analyses. The area estimator is calculated using the linear power spectrum so a non-linear
analysis is not required in order to set bounds with this prescription. All the information
regarding the dark-matter model being analyzed, SIDM in our case, is contained in the area
estimator, while the information regarding Lyman-α data is encoded in the reference model
that sets the exclusion boundary. In what follows we take the reference model to be fermionic
gs = 2 warm dark matter with a mass m = 5.3 keV (or m = 3.5 keV for conservative Lyman-
α bounds), which sets the 2σ exclusion boundary according to an analysis of the MIKE,
HIRES, and XQ-100 spectrometers in [27]. We discuss further details and the validity of the
area criterion in appendix E, and we now move on to the analysis of the resulting bounds.
– 23 –

Figure 3. Bounds from the Lyman-α forest at 95% CL (green) and the Bullet Cluster at 68% CL
[25] (blue) on fermionic (left panel) and bosonic (right panel) SIDM, as a function of the present-time
velocity dispersion
p
⟨u2⟩/3 and self-scattering cross section over mass, σ/m. In both cases we have
set the primordial chemical potential to zero. For fermionic dark matter, we take a number of degrees
of freedom gs = 2, corresponding to a single Weyl fermion, while for bosonic dark matter we take
gs = 1, corresponding to single real scalar particle. To account for uncertainties in Lyman-α bounds,
we follow [27] and present a conservative limit in the shaded green region (that excludes standard
fermionic WDM with m ≥3.5 keV) and a standard limit with the solid green line (that excludes
standard fermionic WDM with m ≥5.3keV). The dashed purple line shows the cross section values
below which dark matter has kinetically decoupled before Lyman-α modes have entered the horizon,
which occurs at k ∼20h/Mpc and a× at 20h/Mpc ≃10−6. The dotted red line ad = aNR shows the
cross sections below which dark matter kinetically decouples while relativistic. Below this line the
model corresponds to warm-dark matter.
The Lyman-α bounds on SIDM are presented in Fig. 3 as a function of the dark-matter
velocity dispersion
p
⟨u2⟩/3 (or its mass, via Eq. (2.27)) and the self-scattering cross section,
for the case of a fermion (left panel) or boson (right panel). In both cases, the primordial
chemical potential has been set to zero, and we assumed that the dark matter can only be in
kinetic equilibrium, but is out of chemical equilibrium. We show two bounds to account for
Lyman-α uncertainties. These uncertainties are due to the fact that diﬀerent assumptions
can be done regarding the temperature evolution of baryons (see e.g. [68, 69]), which aﬀect
Lyman-α absorption. Under two assumptions for such evolution, [27] ﬁnds two bounds on the
mass WDM, a standard and a conservative one, which then translate into our two diﬀerent
– 24 –

bounds for SIDM using the area criterion. We show standard bounds with a solid green line,
and in the ﬁlled green region we show conservative limits. From the ﬁgures, we immediately
see that Lyman-α bounds have a mild but clear dependence on the particle’s cross section,
and they are weakest when the cross section is large. For the largest cross sections consistent
with Bullet Cluster bounds, Lyman-α excludes fermionic gs = 2 (bosonic gs = 1) SIDM with
a mass m ≤4.4 keV (m ≤4.45 keV). For a vanishing cross section, on the other hand, the
bound reduces to that of warm dark matter (as it must, given our procedure for calculating
the bound), which is m ≤5.3 keV for gs = 2 fermions.
From the ﬁgures we also see that for all cross sections smaller than σ/m ≤10−5 cm2/g,
the bounds are essentially equal to the ones obtained for the σ/m = 0 case. This can be
easily understood by comparing the scale factor at which the smallest mode relevant for
the Lyman-α forest k ∼20h/Mpc enters the horizon at a× at 20h/Mpc ≃10−6, with the
scale factor of kinetic decoupling ad, given in Eq. (2.35). These two scale factors are equal
precisely around σ/m ∼10−5cm2/g, as shown by the dashed line in the ﬁgure. For cross
sections smaller than this threshold value, Lyman-α modes enter the horizon when dark
matter has already kinetically decoupled and is free-streaming, so the bounds essentially
reduce to those of WDM. For larger cross sections, Lyman-α modes enter the horizon while
dark matter is acoustically oscillating. In this case the power suppression is, on average, less
than for a free-streaming species for the scales that can be currently probed (although there
are clearly some ranges of scales on which acoustic oscillations lead to more suppression), so
bounds get comparatively weaker.
In Fig. 3 we also show with a dotted line the threshold cross section above which dark
matter decouples when it already became non-relativistic, ad ≥aNR (c.f. Eq. (2.36)). From
the line we see that for all cross sections that lead to observable acoustic oscillations in the
Lyman-α forest (the parameter space above the line ad = a× at 20 h/Mpc), the cross section
is large enough that the dark matter decouples while already non-relativistic.7 This means
that for the purposes of studying elastic particle interactions in acoustic oscillations, dark
matter can be treated as non-relativistic, and in particular, the errors discussed in section 2.1
from approximating the background distribution, speed of sound, and equation of state as
fully non-relativistic can be safely neglected. This comment also applies to other small-scale
observables such as Milky Way satellite counts and strong lensing, as they currently test
similar scales and velocity dispersions to the observed with the Lyman-α forest [70].
More generally, the exact shape of the background distribution function is not par-
7As a matter of fact, since Lyman-α modes enter the horizon at a×at20h/Mpc ≃10−6, and the bounds
presented in the ﬁgures impose that dark matter becomes non-relativistic at aNR ∼
p
⟨u2⟩/3 ≲10−8, when
Lyman-α modes enter the horizon dark matter must always be deep in the non-relativistic regime.
– 25 –

ticularly relevant for calculating small-scale bounds, at least for the typical non-degenerate
thermal distributions considered here. The reason is that the free-streaming scale and sound-
horizon that set the cutoﬀin power, Eqns. (3.2) and (3.5), are mostly set by the particle’s
velocity dispersion, and do not depend much on the precise shape of the phase-space distri-
bution. This has two consequences for Lyman-α bounds. First, it means that the bounds on
the velocity dispersion on fermions and bosons are very similar, as can be seen by comparing
the left and right panels in Fig. 3. The only signiﬁcant diﬀerence between the fermionic and
bosonic cases is that for a given velocity dispersion and primordial chemical potential (set here
to zero), the particle’s mass required for the species to be 100% of dark matter is diﬀerent,
as seen from Eq. (2.27). As a consequence, the map between the lower
p
⟨u2⟩/3 and upper
m axes in the ﬁgures slightly diﬀer for fermions and bosons, and also when considering other
values of the degree-of-freedom parameter gs. And second, the approximate independence
from the background distribution of the bounds implies that it is not particularly impor-
tant if the dark matter decouples while relativistic with a Fermi or Bose distribution, while
non-relativistic with a Boltzmann distribution, or while semi-relativistic with a transitional
distribution. This can be seen explicitly by comparing the bounds below the ad = aNR line in
Fig. 3 and those between the ad = aNR and ad = a×at20h/Mpc. In these two regions observable
Lyman-α modes enter the horizon when dark matter free streams with a relativistic and non-
relativistic distribution, correspondingly. We see that in both cases bounds are almost equal,
conﬁrming their approximate independence on the underlying background distribution.
5
A benchmark example: singlet-scalar dark matter
We now present a speciﬁc dark-matter model that satisﬁes the requirements of our general
discussion so far. We take dark matter to be a real scalar ﬁeld S, whose Lagrangian is
LS = 1
2∂µS∂µS −m2
S
2 S2 −λ
4!S4 .
(5.1)
In Eq. (5.1) we have imposed a Z2 symmetry under which S is odd, that forbids cubic terms
and super-renormalizable SH†H couplings to the Higgs, so that the ﬁeld remains stable. For
vacuum stability, we also require λ > 0. We refer the reader to [71, 72] for further details on
this model.
In this work we have studied only velocity-independent self interactions, and have calcu-
lated the kinetic decoupling redshift and anisotropic stress Eq. (3.14) under this assumption.
In the scalar model, the self-interaction cross section in the non-relativistic limit T ≪mS is
indeed approximately constant and given by
σ(SS →SS) =
λ2
128πm2
S
.
(5.2)
– 26 –

In the relativistic limit, the cross section becomes momentum-dependent and a semi-relativistic
analysis of decoupling must be carried out. For simplicity, here we limit ourselves to the pa-
rameter space where the particle decouples non-relativistically, and use the constant cross
section Eq. (5.2) throughout. Note that since Lyman-α modes enter the horizon when dark
matter is deep in the non-relativistic regime, the anisotropic stress can always be calculated
using the non-relativisic cross section Eq. (5.2).
The singlet sector can be populated in the early universe by a variety of mechanisms, the
most popular one being including a renormalizable quartic coupling to the Higgs, S2H†H [71,
73, 74]. However, no signiﬁcant couplings to the Standard Model sector are required for the
singlet to be the dark matter, as it can be produced for instance through its couplings to the
inﬂaton. For details on singlet production from the inﬂaton we refer the reader to [5, 41], and
in what follows we simply parametrize the dark sector by its primordial chemical potential
µ0
R and current velocity dispersion
p
⟨u2⟩/3, which set the number density of the dark sector.
Again, we do not consider any interactions with the SM.
As in previous sections we limit ourselves to a dark sector that is out of chemical
equilibrium (but can be in kinetic equilibrium), so that number-changing interactions (singlet
cannibalization [15, 75]) alter neither the relic abundance that we have assumed to be set
primordially, potentially depleting the dark sector, nor the standard temperature redshift
described in section 2.1. We take the minimal values of the quartic coupling λ required for
a real scalar to achieve chemical equilibrium with itself at any point of its thermal history
from [41], assuming a vanishing primordial chemical potential µR
0 = 0 for concreteness.
With these assumptions, we show our bounds as applied to the scalar-singlet model in
Fig. 4. In the ﬁgure we have included in dashed-black the values of the quartic coupling
corresponding to the given cross section according to Eq. (5.2). We also show in shaded
red the regions where the scalar achieves chemical equilibrium and our analysis may become
invalid, assuming µR
0 = 0.
The only important dependence on the primordial chemical
potential µR
0 in Fig. 4 is in the calculation of the regions where the scalar reaches chemical
equilibrium and in the map between the velocity dispersion in the lower axis to the particle’s
mass in the upper axis. Otherwise, our bounds on the velocity dispersion apply to all values of
µR
0 to a good approximation, since the free-streaming lengths and sound-horizon are mostly
set by
p
⟨u2⟩/3.
In the ﬁgure we also show in shaded gray the values of cross sections
below which a semi-relativistic analysis of kinetic decoupling must be carried out. For self
couplings in the range 5×10−8 ≲λ ≲10−5, where bounds on the scalar’s velocity dispersion
or mass weaken, Lyman-α modes enter the horizon when the scalar is kinetically coupled and
acoustically oscillates, so bounds are weaker than for a free-streaming species. For couplings
below λ ≲5×10−8 the scalar mostly free streams and behaves as warm dark matter instead.
– 27 –

Figure 4. Our exclusion (in green) for the scalar model, as a function of the present velocity dispersion
p
⟨u2⟩/3 and self-scattering cross section over mass. In dashed lines we show values of the quartic
self-coupling λ. We also show existing bounds on the self-interaction cross section from the Bullet
Cluster [25] (blue), as well as regions in which our conclusions do not apply either because the singlet
may decouple relativistically (gray) or because it achieves chemical self equilibrium (red); see text for
details. This plot was made for a spin-0 (gf = 1) boson with no initial (primordial) chemical potential
(µR
0 = 0). However, changing the gf factor of the particle or the primordial chemical potential changes
mostly the conversion from
p
⟨u2⟩/3 in the lower axis to the dark-matter mass m in the upper axis
required to obtain the correct relic abundance, otherwise bounds on
p
⟨u2⟩/3 remain similar.
When the scalar’s quartic is set to zero we do not have to worry about the dark sector
entering chemical equilibrium. For this case, in Fig. 5 we present bounds on the scalar singlet
from free-streaming as a function of the particle’s chemical potential and mass. In the ﬁgure
we also show bounds from the eﬀective number of relativistic species Neff from big-bang nu-
cleosynthesis as in [41, 76], and in dashed lines we show contours of the ratio TSM/T R
0 required
to obtain the correct relic abundance, c.f. Eq. (2.18). We immediately see that bounds form
Lyman-α provide orders-of magnitude improvements over Neff bounds. When the quartic
is non-zero the bounds in Fig. 4 change little, since as discussed previously self interactions
only moderately relax Lyman-α bounds. In this case, however, one must carefully determine
the regions of parameter space where the ﬁeld remains out of chemical equilibrium to ensure
that our bounds remain valid and study the possibility of semi-relativistic decoupling. This
is beyond the scope of this work.
– 28 –

Figure 5. Bounds from the eﬀective number of relativistic species Neff at big-bang nucleosynthesis,
∆Neff ≤0.354 [41, 76] (gray) and Lyman-α under conservative assumptions (green) on scalar singlet
dark matter, as a function of the particle’s primordial chemical potential and mass, where the primor-
dial chemical potential is normalized to the comoving temperature. The dotted lines show contours of
the value of TSM/T R
0 required for the dark matter to have the correct relic abundance (see Eq. (2.17))
with TSM being the current CMB temperature. This plot assumes that the singlet has a vanishing
quartic, so that it does not enter into chemical equilibrium. For a non-vanishing quartic, bounds from
Lyman-α in the parameter space shown in this ﬁgure are only slightly weaker (as seen in Fig. 4), but
a careful analysis of chemical decoupling must be done in order to check that the primordial singlet
abundance has not been depleted. Note that the Neff bounds shown here are from only big-bang
nucleosynthesis, as our dark matter particle is nonrelativistic at recombination and therefore are not
constrained by CMB measurements of Neff.
We conclude by brieﬂy commenting on the possibility of a fermionic SIDM model with
purely elastic interactions. In this case, an elastic and velocity-independent cross section can
be obtained in the non-relativistic regime via a four-fermi interaction from a heavy mediator,
as long as the mass of the mediator remains above the temperature of the dark sector. The
simplest UV complete models leading to such interactions, are fermionic Majorana SIDM
with a Yukawa coupling to a scalar heavy mediator, or fermionic Dirac SIDM with a heavy
vector mediator. Note that for such models the cosmology of the mediator must also be taken
into account (see e.g. [77]), as it easily reaches chemical equilibrium with the fermion dark
matter at high temperatures.
– 29 –

6
Conclusions
In this work we studied the cosmological evolution of the dark-matter perturbations in the
presence of elastic self interactions. We included in our analysis the eﬀect of pressure support
in the growth of perturbations, kinetic decoupling and the period of free-streaming after
decoupling. As a result, we obtained the matter power-spectrum for SIDM for the whole range
of cross sections allowed by current bounds from the Bullet Cluster, 0 ≤σ/m ≲1 cm2/g.
By analyzing the amount of power suppression at small scales, we derived bounds from the
Lyman-α forest using the area criterion presented in [67]. We found that bounds from Lyman-
α have a slight but clear dependence on the self-interaction cross section. For dark matter
with a vanishing primordial chemical potential, we found that if dark matter is kinetically
decoupled by the time Lyman-α modes enter the horizon around z ∼106, which happens for
σ/m ≲10−5cm2/g, dark matter is excluded if it is lighter than m ∼5.3 keV (3.5 keV for
conservative assumptions on Lyman-α bounds). On the other hand, if self interactions are
large, σ/m ∼1 cm2/g, the bounds relax to m ≳4.4 keV (2.95 keV for conservative bounds).
We applied our results to one concrete dark-matter model with elastic self interactions,
namely scalar-singlet dark matter, and found that bounds from Lyman-α in this model are
the most stringent for a wide range of masses or dark-matter velocity dispersions.
We conclude by commenting on possible future directions. One important task that
remains to be done is to improve the precision of the Lyman-α bounds on the SIDM mass (or
velocity dispersion) obtained here, by performing hydrodynamical simulations of the baryonic
gas on small scales when dark matter has elastic self interactions, and comparing to ﬂux-
power spectrum data. Lyman-α bounds will improve in the future, as uncertainties from the
thermal evolution of the interstellar medium are reduced and more high-resolution quasar
spectra are added to the data analysis [78]. Also, to our knowledge bounds on the SIDM
velocity dispersion from Milky-Way satellite counts [29–31], strong lensing [32–34], stellar
streams [35–37], and high-resolution CMB lensing measurements [38, 39] have not yet been
explored.
Probes of the small-scale distribution of dark matter provide a unique window into the
dynamics of the dark sector, and test the particle nature of dark matter even if it only has
gravitational interactions with the Standard Model.
In addition, a variety of small-scale
issues, such as the existence of cores in the central regions of dwarf galaxies inferred from
observations of rotation curves, point towards the existence of interactions in the dark sector.
The exploration of such interactions is ongoing, and may lead to fantastic discoveries in the
dark sector.
– 30 –

7
Acknowledgments
We thank Riccardo Murgia and Manoj Kaplinghat for comments on the draft, and Riccardo
Murgia for clariﬁcations regarding the area criterion.
We would also like to thank Neel-
ima Sehgal, Neal Dalal and Manoj Kaplinghat for useful discussions. DEU is supported by
Perimeter Institute for Theoretical Physics. Research at Perimeter Institute is supported
in part by the Government of Canada through the Department of Innovation, Science and
Economic Development Canada and by the Province of Ontario through the Ministry of Eco-
nomic Development, Job Creation and Trade. RE acknowledges support from DoE Grant
DE-SC0009854, Simons Investigator in Physics Award 623940, the Heising-Simons Founda-
tion Grant No. 79921, and the US-Israel Binational Science Foundation Grant No. 2016153.
DG acknowledges support from DoE Grant DE-SC0009854 and Simons Award 623940. ML
is supported by DOE Grant DE-SC0017848. We acknowledge the use of Perimeter Institute’s
Symmetry cluster.
A
Treatment of baryons, photons and neutrinos
In this appendix we discuss the implementation of baryon, photon, and neutrino perturba-
tions in our code. We follow the conventions of [55] and work in conformal Newtonian gauge.
Initial super-horizon conditions are taken from the same reference.
Prior to recombination, baryons and photons are treated within the tight-coupling ap-
proximation [57], taking θγ = θb. In this period, we evolve the photon and baryon perturba-
tions as
˙δγ = 4 ˙φ −4
3θbγ
,
˙δb = 3 ˙φ −θbγ
,
˙θbγ = k2ψ −
 HηRB
1 + RB
θbγ −3
4k2c2
bγδγ

−
k2σγ
1 + RB
,
where the dots are derivatives with respect to conformal time η, Hη ≡˙a/a and
RB = 3ρb
4ργ
,
c2
bγ =
1
3(1 + RB)
.
(A.1)
Photon diﬀusion due to the ﬁniteness of the Thomson cross section is included approximating
the anisotropic stress by [79]
σγ =
8θbγ
27neσT a
,
(A.2)
where ne is the redshift-dependent electron number density, which we take from REC-
FAST [80], and σT is the Thomson cross section. We treat photon-baryon decoupling as
– 31 –

sudden at a recombination redshift of zrec = 1100. After decoupling, we evolve baryons and
photons using
˙δγ = 4 ˙φ −4
3θγ
,
˙θγ = k2ψ + k2
1
4δγ −σγ

+ aneσT (θb −θγ)
˙δb = 3 ˙φ −θb
,
˙θb = k2ψ −Hηθb + k2c2
bδb + aneσT
RB
(θγ −θb)
,
where the baryonic speed of sound is given by
c2
b = Tb
µ

1 −1
3
d ln Tb
d ln a

.
(A.3)
In Eq. (A.3), µ is the mean molecular weight, which we approximate to µ = 1.22 GeV [79] and
Tb the baryonic temperature taken from RECFAST. To include post-recombination photon
free-streaming, we set an exponential cutoﬀfor the photon perturbations, at a photon free-
streaming length, kfs = 2.3 h Mpc−1.
Regarding neutrinos, we treat them as massless, and evolve the neutrino moments ac-
cording to
˙Fν0 = −kFν1 + 4 ˙φ
˙Fν1 = 4k
3
1
4Fν0 −1
2Fν2 + ψ

˙Fν(l≥2) =
k
2l + 1

lFν(l−1) −(l + 1)Fν(l+1)

.
(A.4)
The neutrino density, velocity, and anisotropic stress perturbations are related to the mo-
ments by δν = Fν0 , θν = 3
4kFν1, and σν = 1
2Fν2. We cut the neutrino moment hierarchy at
lmax = 30 with the truncation procedure of [55].
To compute the total weighted anisotropic stress Eq. (3.12) needed to obtain the confor-
mal potential ψ via Eq. (3.11), in addition to the dark-matter contribution, we include both
the neutrino and photon viscosities σγ and σν. We validate the results of our code against
CLASS in appendix B.
B
Validation of Boltzmann Solver
In this section, we present reference validations of our Boltzmann solver. We compare the
matter-power spectrum from our solver to that from the Cosmic Linear Anisotropy Solving
System (CLASS) [26] both for CDM and 3.5 keV WDM. We use throughout the best ﬁt
cosmological parameters from [61]. In all cases we take neutrinos to be massless.
– 32 –

We compute the linear matter-power spectrum produced by our Boltzmann solver when
using a massive particle with negligible velocity dispersion and vanishing self-interaction
strength to simulate CDM. We compare this to a CDM run of CLASS. The results are given
in Fig. 6, where we plot the relative diﬀerence between the two spectra. We conclude that
our code agrees with CLASS within the range of interest in k to a precision better than 1%.
Figure 6. The relative matter-power spectrum diﬀerence between the output of our Boltzmann code
and a reference model from CLASS. We see that our code produces excellent agreement (within < 1%)
for 0.5 < k < 20 h/Mpc, which is our range of interest in this paper.
We also compare the output of our Boltzmann solver to that of CLASS for 3.5 keV
WDM. When we run CLASS simulations for a 3.5 keV WDM candidate we do not use a
ﬂuid approximation; namely, we ask CLASS to solve the full Boltzmann hierarchy.
The
relative diﬀerence between the CLASS linear matter-power spectrum and that produced by
our Boltzmann solver is shown in Fig. 7. As with the CDM validation, we see our code agrees
with CLASS in the k-range of interest with high precision.
We take the small discrepancies in the warm-dark matter power-spectrum calculated
with our code and CLASS, to be a measure of the error of our code. We have checked that
these uncertainties translate into a sub-percent uncertainty in the calculation of the area
estimator of reference [67] (also discussed in appendix E), which is used here to set bounds
from the Lyman-α forest. Given that uncertainties from Lyman-α are expected to greatly
exceed these sub-percent uncertainties (e.g., the area criterion has an uncertainty of about
5%, based on an analysis of Fig. 9 from [81] and a comparison of the δA values from Table 3
– 33 –

Figure 7. We present the relative diﬀerence between the matter-power spectrum of our code and
that of CLASS for a 3.5 keV fermionic dark-matter particle. We see that we agree with CLASS to
high precision throughout the entire range of interest.
from [67]), we conclude that our code is adequate for setting Lyman-α bounds on the models
studied throughout this work.
C
Relaxation time approximation
The Boltzmann equation for the perturbation Ψ in conformal Newtonian gauge is given
by [55]
˙Ψ + iq
ϵ(⃗kˆn)Ψ + d ln f0
d ln q

˙φ −iϵ
q(⃗kˆn)ψ

= 1
f0
C[f0, Ψ]
.
(C.1)
In general, collision terms must be calculated numerically. A crude estimate of such terms
can be obtained in the relaxation time approximation, where collision terms are simply
approximated by their comoving collision time τcomov, related to the physical collision time
τ of Eq. (2.34) by τcomov(a) = τ(a)/a. In this approximation we simply take
1
f0
C[f, Ψ] ∼
1
τcomov
f0 −f
f0
= −
Ψ
τcomov(a)
.
(C.2)
While collision terms do not aﬀect the evolution of the ﬁrst and second moment of the
Boltzmann hierarchy due to conservation of particle number and kinetic energy in elastic
collisions, they do aﬀect the evolution of the second and higher moments. In particular,
using the approximation Eq. (C.2), the evolution equation for the second moment in the
– 34 –

presence of collision terms can be approximated to [43]
˙Ψ2 = kq
5ϵ (2Ψ1 −3Ψ3) −
Ψ2
τcomov(a)
.
(C.3)
In the limit of large self interactions, τ ≪H(a)−1, so the fastest timescale in the problem is
due to collisions. In this case, we can neglect the term on the left, leading to
Ψ2 = τcomov(a)
5
kq
ϵ (2Ψ1 −3Ψ3)
.
(C.4)
In addition, from the evolution equations (3.16), it is clear that on scales larger than the
diﬀusion scale, kτcomov ≪1, higher moments in the hierarchy are suppressed by factors of
kτcomov ≪1. In this case, we can drop moments Ψl≥3, and we get 8
Ψ2 = 2τcomov(a)
5
kq
ϵ Ψ1
.
(C.5)
With this approximation, we can now obtain the dark-matter anisotropic stress σDM as a
function of the velocity perturbation θDM using Eqns. (3.7), (3.8) and approximating Ψ1 by
its adiabatic form Eq. (3.15). For a relativistic species in kinetic equilibrium with ϵ = q we
get
σDM = 4
15θτcomov(a)
(C.6)
in accordance with [43]. On the other hand, deep in the non-relativistic regime, we obtain
σDM =
8
9a2
ρDM −mnDM
ρDM

a=1
θτcomov(a)
,
(C.7)
where the numerator of the term in square brackets is just the dark matter kinetic energy. Up
to order-one numerical factors, the anisotropic stress in the relativistic and non-relativistic
regimes match at the transition scale factor a = aNR, since the ratio between the kinetic and
total energy is proportional to the present velocity dispersion squared, (ρDM −mnDM)/ρDM ∼
T 2
0 /m2 ∼a2
NR (c.f. Eq. (2.30)). Since the comoving collision time in the non-relativistic
regime grows as a3, the right hand side of Eq. (C.7) redshifts as ∼a. Then, in order to
impose continuity of the anisotropic stress at a = aNR we may simply approximate
σDM =







4
15θDMτcomov(a)
a < aNR
4a
15aNR θDMτcomov(aNR)
a > aNR
,
(C.8)
which is equivalent to Eq. (3.14) upon replacing τcomov = τ/a.
8On scales below the diﬀusion scale dark-matter perturbations are suppressed by the presence of a non-zero
second moment already, so it is less important to estimate higher moments of the Boltzmann hierarchy. For
a similar approximation in the context of photon diﬀusion damping, see [79].
– 35 –

D
Matching density and velocity perturbations to moments of the phase
space distribution
For evolving modes that are within the horizon, at kinetic decoupling we must match the
density and velocity perturbations to moments of the Boltzmann equation in order to continue
the simulation into the kinetically decoupled regime. Here we derive the matching conditions
if decoupling happens in the non-relativistic regime, and also quote the matching conditions
in the relativistic regime, which can be calculated in a similar way and have been also derived
in [55].
In the non-relativistic and kinetically coupled regime, the phase-space distribution func-
tion Eq. (2.1) is locally Boltzmann-like, and given by
f(⃗xp, t) =
n(⃗xp)

2πmT(⃗xp)
3/2 exp

−(⃗p −m⃗v(⃗xp, t))2
2mT(⃗xp)

,
(D.1)
where ⃗xp, ⃗p are physical spatial and momenta, ⃗v is a gas bulk velocity perturbation ﬁeld, m
the dark-matter mass, and n(⃗xp, t), T(⃗xp, t) are the local number density and temperature
of the dark-matter gas. They are given by constant homogeneous background values plus
perturbations,
n(⃗xp, t) = ¯n(t) + δn(⃗xp, t)
T(⃗xp, t) = ¯T(t) + δT(⃗xp, t) .
(D.2)
Expanding the distribution function f to lowest order in terms of the density, temperature,
and bulk velocity perturbation ﬁelds, we obtain the inhomogeneous piece of the distribution,
Ψ(⃗xp, t) (c.f. Eqn. (2.1)),
Ψ(⃗xp, t) = δn(⃗xp, t)
¯n(t)
+

p2
2m ¯T(t)2 −
3
2 ¯T(t)

δT(⃗xp, t) + ⃗v(⃗xp, t) · ⃗p
¯T(t)
.
(D.3)
Assuming adiabaticity, the number density and temperature perturbations for an ideal monoatomic
gas are related by
δT = 2
3
δn
¯n
¯T
.
(D.4)
In addition, only longitudinal velocity perturbations propagate in the gas [56], so moving
into comoving Fourier space we may take
⃗v(⃗k) = ˆkvl(⃗k) ,
(D.5)
with ˆk being the comoving spatial Fourier mode vector of unit norm and vl(⃗k) a longitudinal
scalar velocity perturbation ﬁeld. Using Eqns. (D.4) and (D.5) in (D.3), and d ln f0/d ln p =
−p2/m ¯T, we obtain
Ψ(⃗k, ⃗p, t) = −1
3
δn(⃗k, t)
¯n(t)
d ln f0
d ln p −(ˆk · ˆp)mvl(⃗k, t)
p
d ln f0
d ln p .
(D.6)
– 36 –

To provide contact with the notation in [55] used in the main body of the text, we note that
the physical velocity and number density perturbations are related with δDM and θDM by9
δn(⃗k, t)
¯n(t)
= δDM(⃗k, t)
,
vl(⃗k, t) = −iθ(⃗k, t)
k
.
(D.7)
Using (D.7) and expressing physical momenta in terms of comoving momenta, p = q/a, we
get
Ψ(⃗k, ⃗q, t) = −δDM(⃗k, t)
3
d ln f0
d ln q + i(ˆk · ˆq)θ(⃗k, t)am
qk
d ln f0
d ln q .
(D.8)
Now, the Boltzmann Legendre mode decomposition is given by
Ψl(⃗k, q, t) =
Z 1
−1
dµΨ(⃗k, µ, q, t) Pl(µ)
2(−i)l ,
(D.9)
where µ = ˆk · ˆq and Pl are Legendre polynomials. Using Eqns. (D.8) and (D.9) we get
Ψ0 = −δDM
3
d ln f0
d ln q
Ψ1 = −θam
3qk
d ln f0
d ln q
,
(D.10)
with higher moments vanishing, which is consistent with the assumptions of treating the
ﬂuid as ideal and with an adiabatic evolution. Deviations from the ideal ﬂuid are obtained
from anisotropic stress due to dark-matter diﬀusion, as discussed in appendix C. In order to
include these eﬀects, we also match the second moment according to Eq. (C.5). Combining
Eq. (C.5) and (D.10), we get
Ψ2 = −2θτcomov(a)
15
d ln f0
d ln q
.
(D.11)
In the relativistic regime, on the other hand, the derivation of the matching conditions
is similar. The matching conditions are
Ψ0 = −δDM
4
d ln f0
d ln q
Ψ1 = −θ
3k
d ln f0
d ln q
Ψ2 = −2θτcomov(a)
15
d ln f0
d ln q
.
(D.12)
The matching conditions Eqns. (D.10)-(D.12) are equivalent to Eq. (3.15) upon replacing
τcomov = H−1
η
at decoupling. We also note that the matching depends only on adiabaticity.
Thus, the same matching conditions can be used for frozen modes that are outside the
horizon, prior to horizon entry, as in [55].
9The relation between θDM and the physical velocity perturbation vl is found by matching the energy
momentum tensor in [55] to the one of an ideal ﬂuid with bulk velocity.
– 37 –

E
The Area Criterion
In the area criterion, an “area” estimator of the power suppression A is deﬁned as [67]
A ≡
Z kmax
kmin
dk
P1D(k)
P CDM
1D
(k) ,
(E.1)
where kmin = 0.5 h/Mpc and kmax = 20 h/Mpc set the range of comoving momenta probed
by Lyman-α, and P1D(k) is the one-dimensional matter-power spectrum deﬁned as
P1D(k) ≡1
2π
Z ∞
k
dk′k′P(k′)
.
(E.2)
In Eq. (E.2), P(k) is the present matter-power spectrum calculated using linear theory.
In order to set bounds on dark-matter models, in the area criterion one ﬁrst calculates
the relative diﬀerence between the area estimator ACDM of the ΛCDM model, and the esti-
mator of a reference model Ar, which is known from detailed simulations to be at the 95%
exclusion boundary,
δAr = ACDM −Ar
ACDM
.
(E.3)
Following [27], here we take the reference model to be warm dark matter with a mass of
5.3 keV. Using our Boltzmann code, we obtain the power-spectrum of warm dark matter and
get
δAr = 0.049
.
(E.4)
Finally, in order to set bounds on a given dark-matter model, the area estimator Eq. (E.1)
for that model is obtained, and from there the relative estimator (E.3) is calculated. If such
relative estimator is larger than the reference relative estimator in Eq. (E.4), the model is
excluded at the 95% conﬁdence level. For conservative bounds, taking the excluded WDM
mass to be 3.5 keV, δAr = 0.135.
The accuracy of the area criterion has been validated against a variety of dark-matter
models in [28], where the authors found excellent agreement between exclusion of models
obtained by performing complete numerical simulations of ﬂux power spectra and statistical
analyses of Lyman-α data and exclusion of models using the much simpler area criterion.
Further tests on the robustness of the criterion have been performed in [82].
References
[1] L. Parker, Quantized ﬁelds and particle creation in expanding universes. 1., Phys. Rev. 183
(1969) 1057–1068.
[2] N. D. Birrell and P. C. W. Davies, Conformal-symmetry breaking and cosmological particle
creation in λϕ4 theory, Phys. Rev. D 22 (Jul, 1980) 322–329.
– 38 –

[3] L. Ford, Gravitational Particle Creation and Inﬂation, Phys. Rev. D 35 (1987) 2955.
[4] L. Kofman, A. D. Linde and A. A. Starobinsky, Reheating after inﬂation, Phys. Rev. Lett. 73
(1994) 3195–3198, [hep-th/9405187].
[5] P. Adshead, Y. Cui and J. Shelton, Chilly Dark Sectors and Asymmetric Reheating, JHEP 06
(2016) 016, [1604.02458].
[6] M. Dine and W. Fischler, The Not So Harmless Axion, Phys. Lett. B 120 (1983) 137–141.
[7] L. Abbott and P. Sikivie, A Cosmological Bound on the Invisible Axion, Phys. Lett. B 120
(1983) 133–136.
[8] J. Preskill, M. B. Wise and F. Wilczek, Cosmology of the invisible axion, Physics Letters B
120 (1983) 127–132.
[9] D. N. Spergel and P. J. Steinhardt, Observational evidence for selﬁnteracting cold dark matter,
Phys. Rev. Lett. 84 (2000) 3760–3763, [astro-ph/9909386].
[10] A. H. Peter, M. Rocha, J. S. Bullock and M. Kaplinghat, Cosmological Simulations with
Self-Interacting Dark Matter II: Halo Shapes vs. Observations, Mon. Not. Roy. Astron. Soc.
430 (2013) 105, [1208.3026].
[11] A. A. de Laix, R. J. Scherrer and R. K. Schaefer, Constraints of selﬁnteracting dark matter,
Astrophys. J. 452 (1995) 495, [astro-ph/9502087].
[12] F.-Y. Cyr-Racine and K. Sigurdson, Cosmology of atomic dark matter, Phys. Rev. D 87 (2013)
103515, [1209.5752].
[13] J. H. Chang, D. Egana-Ugrinovic, R. Essig and C. Kouvaris, Structure Formation and Exotic
Compact Objects in a Dissipative Dark Sector, JCAP 03 (2019) 036, [1812.07000].
[14] J. Fan, A. Katz, L. Randall and M. Reece, Double-Disk Dark Matter, Phys. Dark Univ. 2
(2013) 139–156, [1303.1521].
[15] E. D. Carlson, M. E. Machacek and L. J. Hall, Self-interacting dark matter, Astrophys. J. 398
(1992) 43–52.
[16] M. Markevitch, A. Gonzalez, D. Clowe, A. Vikhlinin, L. David, W. Forman et al., Direct
constraints on the dark matter self-interaction cross-section from the merging galaxy cluster
1E0657-56, Astrophys. J. 606 (2004) 819–824, [astro-ph/0309303].
[17] W. de Blok, The Core-Cusp Problem, Adv. Astron. 2010 (2010) 789293, [0910.3538].
[18] M. Rocha, A. H. Peter, J. S. Bullock, M. Kaplinghat, S. Garrison-Kimmel, J. Onorbe et al.,
Cosmological Simulations with Self-Interacting Dark Matter I: Constant Density Cores and
Substructure, Mon. Not. Roy. Astron. Soc. 430 (2013) 81–104, [1208.3025].
[19] J. Zavala, M. Vogelsberger and M. G. Walker, Constraining self-interacting dark matter with
the milky way’s dwarf spheroidals, Monthly Notices of the Royal Astronomical Society: Letters
431 (2013) L20–L24.
– 39 –

[20] O. D. Elbert, J. S. Bullock, S. Garrison-Kimmel, M. Rocha, J. O˜norbe and A. H. Peter, Core
formation in dwarf haloes with self-interacting dark matter: no ﬁne-tuning necessary, Mon.
Not. Roy. Astron. Soc. 453 (2015) 29–37, [1412.1477].
[21] M. Kaplinghat, S. Tulin and H.-B. Yu, Dark Matter Halos as Particle Colliders: Uniﬁed
Solution to Small-Scale Structure Puzzles from Dwarfs to Clusters, Phys. Rev. Lett. 116 (2016)
041302, [1508.03339].
[22] J. S. Bullock and M. Boylan-Kolchin, Small-Scale Challenges to the ΛCDM Paradigm, Ann.
Rev. Astron. Astrophys. 55 (2017) 343–387, [1707.04256].
[23] S. Tulin and H.-B. Yu, Dark Matter Self-interactions and Small Scale Structure, Phys. Rept.
730 (2018) 1–57, [1705.02358].
[24] M. Kaplinghat, Why I Think That Dark Matter Has Large Self-interactions, Astrophys. Space
Sci. Proc. 56 (2019) 85–89.
[25] S. W. Randall, M. Markevitch, D. Clowe, A. H. Gonzalez and M. Bradac, Constraints on the
Self-Interaction Cross-Section of Dark Matter from Numerical Simulations of the Merging
Galaxy Cluster 1E 0657-56, Astrophys. J. 679 (2008) 1173–1180, [0704.0261].
[26] D. Blas, J. Lesgourgues and T. Tram, The cosmic linear anisotropy solving system (class). part
ii: Approximation schemes, Journal of Cosmology and Astroparticle Physics 2011 (Jul, 2011)
034–034.
[27] V. Irˇsiˇc et al., New Constraints on the free-streaming of warm dark matter from intermediate
and small scale Lyman-α forest data, Phys. Rev. D 96 (2017) 023522, [1702.01764].
[28] R. Murgia, V. Irˇsiˇc and M. Viel, Novel constraints on noncold, nonthermal dark matter from
lyman-α forest data, Phys. Rev. D 98 (Oct, 2018) 083540.
[29] E. Polisensky and M. Ricotti, Constraints on the dark matter particle mass from the number of
milky way satellites, Phys. Rev. D 83 (Feb, 2011) 043506.
[30] P. Jethwa, D. Erkal and V. Belokurov, The upper bound on the lowest mass halo, Monthly
Notices of the Royal Astronomical Society 473 (2018) 2060–2083.
[31] R. Kennedy, C. Frenk, S. Cole and A. Benson, Constraining the warm dark matter particle
mass with milky way satellites, Monthly Notices of the Royal Astronomical Society 442 (2014)
2487–2495.
[32] S. Birrer, A. Amara and A. Refregier, Lensing substructure quantiﬁcation in rxj1131-1231: a 2
kev lower bound on dark matter thermal relic mass, Journal of Cosmology and Astroparticle
Physics 2017 (May, 2017) 037–037.
[33] D. Gilman, S. Birrer, T. Treu, A. Nierenberg and A. Benson, Probing dark matter structure
down to 107 solar masses: ﬂux ratio statistics in gravitational lenses with line-of-sight haloes,
Monthly Notices of the Royal Astronomical Society 487 (Jun, 2019) 5721–5738.
[34] D. Gilman, S. Birrer, A. Nierenberg, T. Treu, X. Du and A. Benson, Warm dark matter chills
out: constraints on the halo mass function and the free-streaming length of dark matter with
– 40 –

eight quadruple-image strong gravitational lenses, Monthly Notices of the Royal Astronomical
Society 491 (Dec, 2019) 6077–6101.
[35] N. Banik, J. Bovy, G. Bertone, D. Erkal and T. J. L. de Boer, Novel constraints on the particle
nature of dark matter from stellar streams, 2019.
[36] N. Banik, G. Bertone, J. Bovy and N. Bozorgnia, Probing the nature of dark matter particles
with stellar streams, Journal of Cosmology and Astroparticle Physics 2018 (Jul, 2018) 061–061.
[37] N. Dalal, J. Bovy, L. Hui and X. Li, Don’t cross the streams: caustics from Fuzzy Dark Matter,
2011.13141.
[38] H. N. Nguyen, N. Sehgal and M. Madhavacheril, Measuring the Small-Scale Matter Power
Spectrum with High-Resolution CMB Lensing, Phys. Rev. D 99 (2019) 023502, [1710.03747].
[39] N. Sehgal et al., CMB-HD: An Ultra-Deep, High-Resolution Millimeter-Wave Survey Over Half
the Sky, 1906.10134.
[40] J. M. Bardeen, J. R. Bond, N. Kaiser and A. S. Szalay, The Statistics of Peaks of Gaussian
Random Fields, ApJ 304 (May, 1986) 15.
[41] G. Arcadi, O. Lebedev, S. Pokorski and T. Toma, Real Scalar Dark Matter: Relativistic
Treatment, JHEP 08 (2019) 050, [1906.07659].
[42] F. Atrio-Barandela and S. Davidson, Interacting hot dark matter, Phys. Rev. D 55 (1997)
5886–5894, [astro-ph/9702236].
[43] S. Hannestad and R. J. Scherrer, Selﬁnteracting warm dark matter, Phys. Rev. D 62 (2000)
043522, [astro-ph/0003046].
[44] F.-Y. Cyr-Racine, K. Sigurdson, J. Zavala, T. Bringmann, M. Vogelsberger and C. Pfrommer,
ETHOS—an eﬀective theory of structure formation: From dark particle physics to the matter
distribution of the Universe, Phys. Rev. D 93 (2016) 123527, [1512.05344].
[45] S. Bose, M. Vogelsberger, J. Zavala, C. Pfrommer, F.-Y. Cyr-Racine, S. Bohr et al., ETHOS –
an Eﬀective Theory of Structure Formation: detecting dark matter interactions through the
Lyman-α forest, Mon. Not. Roy. Astron. Soc. 487 (2019) 522–536, [1811.10630].
[46] M. Archidiacono, D. C. Hooper, R. Murgia, S. Bohr, J. Lesgourgues and M. Viel, Constraining
Dark Matter-Dark Radiation interactions with CMB, BAO, and Lyman-α, JCAP 10 (2019)
055, [1907.01496].
[47] R. Huo, Matter Power Spectrum of Light Freeze-in Dark Matter: With or without
Self-Interaction, Phys. Lett. B 802 (2020) 135251, [1907.02454].
[48] R. Yunis, C. R. Arg¨uelles and D. L´opez Nacir, Boltzmann hierarchies for self-interacting warm
dark matter scenarios, JCAP 09 (2020) 041, [2002.05778].
[49] J. March-Russell, H. Tillim and S. M. West, Reproductive freeze-in of self-interacting dark
matter, Phys. Rev. D 102 (2020) 083018, [2007.14688].
– 41 –

[50] S. Heimersheim, N. Sch¨oneberg, D. C. Hooper and J. Lesgourgues, Cannibalism hinders
growth: Cannibal Dark Matter and the S8 tension, 2008.08486.
[51] A. Das, B. Dasgupta and R. Khatri, Ballistic Dark Matter oscillates above ΛCDM, JCAP 04
(2019) 018, [1811.00028].
[52] M. Garny, T. Konstandin, L. Sagunski and S. Tulin, Lyman-α forest constraints on interacting
dark sectors, JCAP 09 (2018) 011, [1805.12203].
[53] W. Hu, R. Barkana and A. Gruzinov, Cold and fuzzy dark matter, Phys. Rev. Lett. 85 (2000)
1158–1161, [astro-ph/0003365].
[54] A. Arvanitaki, J. Huang and K. Van Tilburg, Searching for dilaton dark matter with atomic
clocks, Phys. Rev. D 91 (2015) 015015, [1405.2925].
[55] C.-P. Ma and E. Bertschinger, Cosmological perturbation theory in the synchronous and
conformal Newtonian gauges, Astrophys. J. 455 (1995) 7–25, [astro-ph/9506072].
[56] D. S. Gorbunov and V. A. Rubakov, Introduction to the theory of the early universe:
Cosmological perturbations and inﬂationary theory. 11, 2011, 10.1142/7874.
[57] V. A. Rubakov and D. S. Gorbunov, Introduction to the Theory of the Early Universe: Hot big
bang theory. World Scientiﬁc, Singapore, 2017, 10.1142/10447.
[58] E. W. Kolb and M. S. Turner, The Early Universe, vol. 69. 1990.
[59] J. Bernstein, KINETIC THEORY IN THE EXPANDING UNIVERSE. Cambridge
Monographs on Mathematical Physics. Cambridge University Press, Cambridge, U.K., 1988,
10.1017/CBO9780511564185.
[60] A. Trautner, Massive Fermi Gas in the Expanding Universe, JCAP 03 (2017) 019,
[1612.07249].
[61] Planck collaboration, N. Aghanim et al., Planck 2018 results. VI. Cosmological parameters,
Astron. Astrophys. 641 (2020) A6, [1807.06209].
[62] J. Lesgourgues and T. Tram, The Cosmic Linear Anisotropy Solving System (CLASS) IV:
eﬃcient implementation of non-cold relics, JCAP 09 (2011) 032, [1104.2935].
[63] W. Hu, Structure formation with generalized dark matter, Astrophys. J. 506 (1998) 485–494,
[astro-ph/9801234].
[64] CAMB collaboration, Camb notes, .
[65] M. Viel, J. Lesgourgues, M. G. Haehnelt, S. Matarrese and A. Riotto, Constraining warm dark
matter candidates including sterile neutrinos and light gravitinos with WMAP and the
Lyman-alpha forest, Phys. Rev. D 71 (2005) 063534, [astro-ph/0501562].
[66] A. Schneider, Astrophysical constraints on resonantly produced sterile neutrino dark matter,
JCAP 04 (2016) 059, [1601.07553].
[67] R. Murgia, A. Merle, M. Viel, M. Totzauer and A. Schneider, ”Non-cold” dark matter at small
scales: a general approach, JCAP 11 (2017) 046, [1704.07838].
– 42 –

[68] A. Garzilli, A. Boyarsky and O. Ruchayskiy, Cutoﬀin the Lyman-α forest power spectrum:
warm IGM or warm dark matter?, Phys. Lett. B 773 (2017) 258–264, [1510.07006].
[69] L. Hui, J. P. Ostriker, S. Tremaine and E. Witten, Ultralight scalars as cosmological dark
matter, Phys. Rev. D 95 (2017) 043541, [1610.08297].
[70] W. Enzi et al., Joint constraints on thermal relic dark matter from a selection of astrophysical
probes, 2010.13802.
[71] C. Burgess, M. Pospelov and T. ter Veldhuis, The Minimal model of nonbaryonic dark matter:
A Singlet scalar, Nucl. Phys. B 619 (2001) 709–728, [hep-ph/0011335].
[72] D. Egana-Ugrinovic and S. Thomas, Eﬀective Theory of Higgs Sector Vacuum States,
1512.00144.
[73] V. Silveira and A. Zee, SCALAR PHANTOMS, Phys. Lett. B 161 (1985) 136–140.
[74] J. McDonald, Gauge singlet scalars as cold dark matter, Physical Review D 50 (1994) 3637.
[75] D. Pappadopulo, J. T. Ruderman and G. Trevisan, Dark matter freeze-out in a nonrelativistic
sector, Phys. Rev. D 94 (2016) 035005, [1602.04219].
[76] Particle Data Group collaboration, M. Tanabashi, K. Hagiwara, K. Hikasa, K. Nakamura,
Y. Sumino, F. Takahashi et al., Review of particle physics, Phys. Rev. D 98 (Aug, 2018)
030001.
[77] R. Huo, M. Kaplinghat, Z. Pan and H.-B. Yu, Signatures of Self-Interacting Dark Matter in the
Matter Power Spectrum and the CMB, Phys. Lett. B 783 (2018) 76–81, [1709.09717].
[78] F. Pepe et al., ESPRESSO — An Echelle SPectrograph for Rocky Exoplanets Search and Stable
Spectroscopic Observations, ESO Messenger 153 (8, 2019) 6–16.
[79] S. Dodelson, Modern Cosmology. Academic Press, Amsterdam, 2003.
[80] S. Seager, D. D. Sasselov and D. Scott, How Exactly Did the Universe Become Neutral?, ApJS
128 (June, 2000) 407–430, [astro-ph/9912182].
[81] R. Murgia, V. Irˇsiˇc and M. Viel, Novel constraints on noncold, nonthermal dark matter from
Lyman- α forest data, Phys. Rev. D 98 (2018) 083540, [1806.08371].
[82] F. D’Eramo and A. Lenoci, Lower Mass Bounds on FIMPs, 2012.01446.
– 43 –

