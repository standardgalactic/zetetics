Simple ZX and ZH calculi for arbitrary ï¬nite dimensions, via
discrete integrals
Niel de Beaudrapâˆ—
Department of Informatics, University of Sussex, Brighton UK
Richard D. P. Eastâ€ 
4 April 2023
Abstract
The ZX calculus and the ZH calculus use diagrams to denote and to compute properties of quan-
tum operations, and other multi-linear operators described by tensor networks. These calculi involve
â€˜rewrite rulesâ€™, which are algebraic manipulations of the tensor networks through transformations of
diagrams. The way in which diagrams denote tensor networks is through a semantic map, which as-
signs a meaning to each diagram in a compositional way. Slightly diï¬€erent semantic maps, which may
prove more convenient for one purpose or another (e.g., analysing unitary circuits versus analysing
counting complexity), give rise to slightly diï¬€erent rewrite systems. Through a simple application
of measure theory on discrete sets, we describe a semantic map for ZX and ZH diagrams for qudits
of any dimension D>1, well-suited to represent unitary circuits, and admitting simple rewrite rules.
In doing so, we reproduce the â€˜well-temperedâ€™ semantics of Ref. [19] for ZX and ZH diagrams in
the case D=2. We demonstrate rewrite rules for the â€˜stabiliser fragmentâ€™ of the ZX calculus and a
â€˜multicharacter fragmentâ€™ of the ZH calculus; and demonstrate relationships which would allow the
two calculi to be used interoperably as a single â€˜ZXH calculusâ€™.
1
Introduction
The ZX calculus [1â€“29] and the ZH calculus [30â€“35, 19] are notational systems for quantum computation,
and other problems which can be mapped onto tensor networks [33, 36â€“40]. They use annotated graphs â€”
â€˜ZX diagramsâ€™ and â€˜ZH diagramsâ€™ â€” to denote tensor networks, in a way which may be used to represent
quantum circuits. They are also equipped with with rules to perform computations without recourse to
exponentially large matrices, through transformations of diagrams. While complicated procedures may
require diagrams of mounting complexity to analyse, in many cases the ZX- and ZH-calculi simplify the
analysis of many-qubit procedures. In recent years, it has also become more common to consider versions
of the ZX- and ZH-calculi which denote operations on qudits [8, 12, 23, 27â€“29, 35, 41]. These promise
the same beneï¬ts for analysis of procedures on qudits, as the corresponding rewrite systems on qubits.
Most treatments of the ZX-calculus [3â€“7, 9â€“11, 14â€“20, 22â€“27] and the ZH-calculus [30â€“32, 19, 34, 35]
are â€˜scalar exactâ€™, in that diagram transformations preserve the exact meaning as an operator over C,
without glossing over normalisation factors. Such scalar factors are irrelevant for certain applications
(e.g., the analysis of quantum circuits without measurement); but they are important when describing
procedures which have probabilistic elements (e.g., postselection), or problems in which the numerical
value of some coeï¬ƒcient is the subject of interest [40]. To keep track of scalar factors, one might have
to account for changes to the normalising factors with each rewrite, either explicitly or through scalar
gadgets: disconnected subdiagrams which obliquely denote normalising factors.
It is of practical interest to consider what presentations of the ZX- or ZH-calculus avoid frequent
changes to the scalar gadgets or normalising factors associated with the diagrams. An appropriate choice
of presentation may also allow the two calculi to be combined into a single rewrite system (a â€˜ZXH cal-
culusâ€™) to transform diagrams using the rules of each [19, 36, 38], allowing the user to make use of the
intuitions oï¬€ered by both calculi. In previous work [19], one of us addressed this issue of bookkeeping of
scalars for ZX- and ZH-diagrams on qubits, by considering a carefully modiï¬ed notational convention for
these diagrams. The result, described as â€˜well-temperedâ€™ versions of these calculi, are scalar exact but do
âˆ—niel.debeaudrap@sussex.ac.uk
â€ rdp.east@gmail.com
1
arXiv:2304.03310v1  [quant-ph]  6 Apr 2023

not introduce modiï¬cations to the scalar factors for the most often-used rewrites. These well-tempered
versions of the ZX- and ZH-calculi are also well-suited to work together, representing a convenient pre-
sentation of a ZXH calculus. However, while the â€˜well-temperedâ€™ notation was determined systematically
and led to simpler rewrite rules, the notational convention itself (i.e., the meanings which are assigned
to the simplest diagrams) is slightly unweildly. Furthermore, this analysis did not address the same issue
of scalars which arises for versions of these calculi for qudits of dimension D > 2.
In this work, we consider how diï¬€erent normalisations of the ZX- and ZH-calculus may be expressed
in a more uniform way, by representing operators on qudits (of any ï¬xed dimension D > 1) through the
use of integrals with respect to a discrete measure. We may summarise these results, as follows.
Versatile generators for ZX and ZH diagrams.
Let D > 1 be an integer, and let H âˆ¼= CD. We
present a version of the ZX calculus on qudits with state-space H, with generator nodes
Î˜
...
m

...

n ,
Î˜
...
m

...

n ,
+
,
-
,
(1)
where m, n âˆˆN and Î˜ : Z â†’C is a function which assigns amplitudes to elements of [D]. We call these
generators â€˜green dotsâ€™, â€˜red dotsâ€™, and â€˜Hadamard plus boxesâ€™, and â€˜Hadamard minus boxesâ€™. (In using
functions Î˜ : Z â†’C to parameterise green and red dots, we loosely follow Wang [23]. When Î˜ is absent,
we assume the constant function Î˜(x) = 1; if instead a parameter Î¸ âˆˆR is provided, we assume the
function Î˜(x) = eiÎ¸x.) We also present a version of the ZH calculus for qudits with Hilbert space H, with
generator nodes
...
m

...

n ,
A
...
m

...

n ,
...
m

...

n ,
c
,
(2)
where m, n âˆˆN, c âˆˆZ, and A : Z â†’C. We call these generators â€˜white dotsâ€™, â€˜H-boxesâ€™, â€˜gray dotsâ€™,
and â€˜generalised-not dotsâ€™.1 (We adopt the convention of using functions A : Z â†’C for the sake of
uniformity with our presentation of ZX diagrams, but allow a complex unit Î± âˆˆCÃ— to stand for the
function A(t) = Î±t. We deï¬ne some short-hand notations below for functions A(t) = e2Ï€ict/D for c âˆˆZ.)
Simple semantics for qudit ZX and ZH generators, via integrals.
We label the standard basis
states of H by |xâŸ©for x âˆˆ[D], where we take the somewhat unconventional choice2
[D] = (âˆ’1
2D, 1
2D] âˆ©Z = {LD, LD+1, . . . , UDâˆ’1, UD}
(3)
for LD = âˆ’âŒŠDâˆ’1
2 âŒ‹and UD = âŒŠD
2 âŒ‹. (Note that [D] = {0, 1} for D = 2, but that LD is negative for
D>2.) We deï¬ne simple semantics for both sets of generators above, using a notion of integration over
[D]. Speciï¬cally: we consider a measure Âµ on subsets of [D], deï¬ned by Âµ(S) = #S Â· Î½2, where #S is
the cardinality of S âŠ†[D] and Î½ > 0 is some real number which we later characterise. For functions
f : Z â†’C, this allows us to deï¬ne integrals over [D],
Z
xâˆˆ[D]
f(x) :=
Z
xâˆˆ[D]
f(x) dÂµ(x) :=
X
xâˆˆ[D]
f(x) Î½2 ,
(4)
where for the sake of brevity, we leave the measure Âµ implicit in the left-hand expression. Such integrals
allow us to express sums with certain normalising factors more uniformly, by absorbing the factors into
the measure Âµ by an appropriate choice of Î½ > 0. We also deï¬ne non-normalised point-mass distributions
|xâŸ©âŸ©= 1
Î½ |xâŸ©âˆˆH, expressly to obtain
Z
xâˆˆ[D]
âŸ¨âŸ¨z|xâŸ©âŸ©f(x) = f(z),
(5)
similarly to the way that Dirac measures may be used with integration over R. (We elaborate on this
notion in Section 3.) We then deï¬ne a semantic map [[ Â· ]] on the ZX and ZH generators as follows:
1We follow Ref. [19] in considering the gray and not dots to be (primitive) generators, rather than gadgets or â€˜derived
generatorsâ€™, e.g., as in Refs. [30, 35].
2We suggest this convention to support rewrites which become possible for arbitrary D > 1. This choice is independent
of the main idea of our work, which is the use discrete integrals such as the one shown in Eqn. (4); this article promotes a
few other such independently motivated conventions (such as the amplitude functions Î˜, A : Z â†’C) which seem fruitful.
2

""
Î˜
...
m

...

n
##
=
Z
xâˆˆ[D]
Î˜(x) |xâŸ©âŸ©âŠ—nâŸ¨âŸ¨x|âŠ—m
hh
+
ii
=
ZZ
x,kâˆˆ[D]
e2Ï€ikx/D|kâŸ©âŸ©âŸ¨âŸ¨x|
""
Î˜
...
m

...

n
##
=
Z
kâˆˆ[D]
Î˜(k) |Ï‰âˆ’kâŸ©âŸ©âŠ—nâŸ¨âŸ¨Ï‰k |âŠ—m
hh
-
ii
=
ZZ
x,kâˆˆ[D]
eâˆ’2Ï€ikx/D|kâŸ©âŸ©âŸ¨âŸ¨x|
""
A
...
m

...

n
##
=
ZZ
xâˆˆ[D]m
yâˆˆ[D]n
A(x1Â·Â·Â· xmy1Â·Â·Â· yn) |yâŸ©âŸ©âŸ¨âŸ¨x| ,
""
...
m

...

n
##
=
Z
xâˆˆ[D]
|xâŸ©âŸ©âŠ—nâŸ¨âŸ¨x|âŠ—m ,
""
...
m

...

n
##
=
ZZ
xâˆˆ[D]m
yâˆˆ[D]n


 P
h
xh + P
k
yk
|0

|yâŸ©âŸ©âŸ¨âŸ¨x| ,
hh
c
ii
=
Z
xâˆˆ[D]
|âˆ’câˆ’xâŸ©âŸ©âŸ¨âŸ¨x| ,
(6)
where |Ï‰kâŸ©âŸ©=
1
âˆš
D
P
x Ï‰âˆ’kx |xâŸ©âŸ©is an Ï‰k-eigenstate of the operator X, for Ï‰ = e2Ï€i/D a primitive Dth
root of unity and X the cyclic shift operator given by X |aâŸ©= |a+1âŸ©. Here and elsewhere in our work,
any expression E which indexes a standard basis vector |EâŸ©or point-mass distribution |EâŸ©âŸ©should be
understood as being reduced mod D in that context, to an element of [D] âŠ†(âˆ’1
2D, 1
2D]. The precise
semantics deï¬ned above depends on the parameter Î½, which governs the normalisation of the measure Âµ
on subsets of [D].
Simple rewrites for qudit ZX and ZH diagrams.
We show that imposing the constraint that

+

is a unitary operator, suï¬ƒces to ï¬x the value Î½ = Dâˆ’1/4, so that Âµ([D]) =
âˆš
D. This allows
us to deï¬ne a system of scalar-exact rewrites for ZX and ZH diagrams for arbitrary D > 1 which involve
very few scalar gadgets. A selection of such rewrites is presented in Figures 1 & 3, which we prove sound
in Appendix F. (Figure 2 presents some equivalences between ZX and ZH diagrams; Figure 4 presents
how some well-known operators would be represented by diagrams involving ZX and ZH generators.) â€”
Note that these rewrites have not been chosen either to be either minimal or complete. Rather, we hope
to demonstrate representative rewrites to persuade the reader that ï¬xing the semantics as we do above,
is likely to be beneï¬cial to the exploration of versions of these calculi for qudits of various dimensions.
The special case D = 2.
In addition to being a promising approach to deï¬ning ZX and ZH calculi
with simple rewrite systems on qudits, this approach to interpreting ZX and ZH diagrams reproduces3
the â€˜well-temperedâ€™ semantic map [[ Â· ]]Î½ described in Ref. [19] for D = 2. In this way, Eqns. (6) provide a
more intuitive deï¬nition of those semantics, and extends them to arbitrary D > 1.
Related work.
As we note above, there is recent and ongoing work [8, 12, 23, 27â€“29, 35, 41] on ZX, ZH,
and related calculi on qudits of dimension D > 2, though often considering the special case where D is an
odd prime. Our work is strongly inï¬‚uenced in particular by certain ideas of Booth and Carette [27] and
Roy [35], and we are aware of parallel work by collaborations involving these authors [42, 43]. However,
we have reason to believe that our work is distinguished in presenting convenient semantics for both
ZX and ZH diagrams for arbitrary D>1. In particular, our work is intended only to present results
which hold for arbitrary D (albeit allowing for minor variations between the cases of D even and D odd).
Structure of the paper.
Section 2 provides what background we rely upon in number theory and
measure theory, and also for the ZX and ZH calculi, to present our results. Section 3 introduces discrete
measures on [D] and integrals on [D], and considers constraints on normalisation which may be motivated
by particular presentations of the discrete Fourier transform Ë†f of a function f : Z â†’C. In Section 4,
we demonstrate how this yields convenient representations of generalised Cliï¬€ord gates on H, as well as
general diagonal operations. In Section 5, we outline a normal form for qudit ZH diagrams for all D > 1,
building on a similar construction for D=2. [30]. In Section 6, we remark on the relationship between this
construction and the development of the â€˜well-temperedâ€™ semantics for ZX and ZH diagrams for D = 2.
(Throughout, we refer the reader to the various Appendices for particularly technical details which may
be of interest.) We conclude in Section 7 with a summary and general commentary on these results.
3Strictly speaking, the calculi of Ref. [19] involve red and green dots with parameters Î¸ âˆˆR, H-boxes with parameters
Î± âˆˆC, only one type of Hadamard box instead of two, and a â€˜nu boxâ€™ which is entirely missing in the calculus presented
here. We may bridge these diï¬€erences in the case D = 2 by considering the special case of red and green dots parameterised
by functions Î˜(x) = exp(iÎ¸x) for Î¸ âˆˆR, H-boxes parameterised by A(x) = Î±x for Î± âˆˆC, identifying both the Hadamard
plus and minus boxes with the single Hadamard box of Ref. [19], and replacing the nu-boxes with some suitable scalar
gadgets (such as H-boxes parameterised by powers of Î½ = Dâˆ’1/4).
3

(ZX-GI)
â†âˆ’âˆ’âˆ’â†’
[c] [c]
(ZX-RI)
â†âˆ’âˆ’âˆ’â†’
+
-
(ZX-HI)
â†âˆ’âˆ’âˆ’â†’
Î¸
Î˜
...
...
Î¦
...
...
(ZX-GF)
â†âˆ’âˆ’âˆ’âˆ’â†’
Î˜Â·Î¦
...
...
Î¸
...
...
Ï†
...
...
(ZX-GFP)
â†âˆ’âˆ’âˆ’âˆ’â†’
Î¸+Ï†
...
...
[a1; b1]
...
...
[a2; b2]
...
...
(ZX-GFS)
â†âˆ’âˆ’âˆ’âˆ’â†’
[a1+a2 ;
b1+b2]
...
...
Î˜
...
...
(ZX-RGC)
â†âˆ’âˆ’âˆ’âˆ’âˆ’â†’
Î˜
+
+
...
+
+
...
...
...
...
...
(ZX-RGB)
â†âˆ’âˆ’âˆ’âˆ’âˆ’â†’
...
...
[a]
...
(ZX-CPY)
â†âˆ’âˆ’âˆ’âˆ’â†’
[a]
[a]
...
Î¸
Â¬
Â¬
...
Â¬
Â¬
...
(ZX-NS)
â†âˆ’âˆ’âˆ’âˆ’â†’
âˆ’Î¸
...
...
ÏƒÎ¸
[1]
[c] [a ; b] [c]
(ZX-RS)
â†âˆ’âˆ’âˆ’â†’
[aâˆ’bc ; b]
[c]
[a ; b]
Z
(ZX-Z)
â†âˆ’âˆ’âˆ’â†’
Z
[ Ëœa ]
(ZX-ZCP)
â†âˆ’âˆ’âˆ’âˆ’â†’
[ utâ€² ; t ]
(ZX-ZSP)
â†âˆ’âˆ’âˆ’âˆ’â†’Z
...
ï£¼
ï£½
ï£¾u
(ZX-MH)
â†âˆ’âˆ’âˆ’âˆ’â†’
[0 ; u]
[0 ; uâˆ’1]
[0 ; u]
+
[0 ; âˆ’u]
[a, b]
...
ï£¼
ï£½
ï£¾u
(ZX-ME)
â†âˆ’âˆ’âˆ’âˆ’â†’
[âˆ’auâˆ’1; buâˆ’2]
...
ï£¼
ï£½
ï£¾D
(ZX-MEH)
â†âˆ’âˆ’âˆ’âˆ’âˆ’â†’
(ZX-A)
â†âˆ’âˆ’âˆ’â†’
Î¸
(ZX-PU)
â†âˆ’âˆ’âˆ’âˆ’â†’
[a ; b]
(ZX-SU)
â†âˆ’âˆ’âˆ’âˆ’â†’
[a ; u]
[âˆ’a ; âˆ’u]
(ZX-GU)
â†âˆ’âˆ’âˆ’âˆ’â†’
Figure 1:
Various scalar-exact rewrites (including axioms and corollaries) on ZX diagrams, which are sound for
the semantics described in Eqn. (6) subject to Î½ = Dâˆ’1/4. Chains of rewrites Dj
(x)
â†â†’Â· Â· Â· â†”Df are intended to
indicate that Dj
(x)
â†â†’Df is either an axiom or notable corollary. Throughout, we have Î¸, Ï† âˆˆR, and Î˜, Î¦ : Z â†’C,
and a, a1, a2, b, b1, b2, c âˆˆZ. We deï¬ne the constant 0 function, Z : Z â†’{0}. We let 1 < t < D be a divisor of D,
1 < tâ€² < t be a divisor of t (and thus also of D), u âˆˆN an integer which has no common factors t > 1 with D
(sometimes interpreted as an element u âˆˆZÃ—
D), and Ëœa âˆˆZ an integer which is not a multiple of D. Many of the
rules involve green dots or red dots parameterised by a label [a] or [a ; b] for a, b âˆˆZ: these stand respectively
for the amplitude functions x 7â†’Ï„ âˆ’2ax and x 7â†’Ï„ âˆ’2axâˆ’bx2, where Ï„ = exp(Ï€i(D2+1)/D). An annotation Â¬ on a
red or green dot indicates a dimension-dependent parameter [âˆ’Ïƒ], where Ïƒ = 0 for D odd and Ïƒ = 1 for D even.
Soundness proofs for these rewrites may be found in Appendix F.4.
...
...
(ZXH-GW)
â†âˆ’âˆ’âˆ’âˆ’âˆ’â†’
...
...
...
...
(ZXH-RG)
â†âˆ’âˆ’âˆ’âˆ’âˆ’â†’
...
...
Î˜
...
...
(ZXH-GP)
â†âˆ’âˆ’âˆ’âˆ’âˆ’â†’
...
...
Î˜
Î˜
(ZXH-WH)
â†âˆ’âˆ’âˆ’âˆ’âˆ’â†’
Î˜
[c]
(ZXH-RN)
â†âˆ’âˆ’âˆ’âˆ’âˆ’â†’
c
(ZXH-RA)
â†âˆ’âˆ’âˆ’âˆ’âˆ’â†’
+
(ZXH-HP)
â†âˆ’âˆ’âˆ’âˆ’âˆ’â†’
+1
-
(ZXH-HM)
â†âˆ’âˆ’âˆ’âˆ’âˆ’â†’
âˆ’1
(ZXH-GH0)
â†âˆ’âˆ’âˆ’âˆ’âˆ’â†’
âˆš
D
Î˜
(ZXH-GH)
â†âˆ’âˆ’âˆ’âˆ’âˆ’â†’
Z
xâˆˆ[D]
Î˜(x)
Î˜
(ZXH-S0)
â†âˆ’âˆ’âˆ’âˆ’â†’
Î˜(0)
Î˜
[c]
(ZXH-S)
â†âˆ’âˆ’âˆ’âˆ’â†’
Î˜(c)
Figure 2: Sound rewrites between the ZX generators and the ZH generators, subject to the semantics of Eqn. (6).
Some of these rewrites are special cases or (together with ZX- or ZH-rewrites) easy corollaries of the others. For
instance, (ZXH-GP) follows from (ZXH-WH), (ZXH-GW), and fusion of green dots; while (ZXH-S0) is an immediate
consequence of (ZXH-S). Soundness proofs for these rewrites may be found in Appendix F.3.
4

(ZH-WI)
â†âˆ’âˆ’âˆ’âˆ’â†’
1
âˆš
D
(ZH-WQS)
â†âˆ’âˆ’âˆ’âˆ’âˆ’â†’
(ZH-AI)
â†âˆ’âˆ’âˆ’â†’
u
âˆ’u
(ZH-HI)
â†âˆ’âˆ’âˆ’â†’
Î¸
...
...
...
...
(ZH-WF)
â†âˆ’âˆ’âˆ’âˆ’â†’
u
u
...
u
u
...
(ZH-GWC)
â†âˆ’âˆ’âˆ’âˆ’âˆ’â†’
c
c
...
c
c
...
(ZH-WNS)
â†âˆ’âˆ’âˆ’âˆ’âˆ’â†’
...
...
...
...
...
...
(ZH-GF)
â†âˆ’âˆ’âˆ’âˆ’â†’
...
...
(ZH-GL)
â†âˆ’âˆ’âˆ’âˆ’â†’
u
u
...
u
u
...
(ZH-WGC)
â†âˆ’âˆ’âˆ’âˆ’âˆ’â†’
...
...
...
)
D
(ZH-MEH)
â†âˆ’âˆ’âˆ’âˆ’âˆ’â†’
(ZH-A)
â†âˆ’âˆ’âˆ’â†’

...
...
...
...
(ZH-WGB)
â†âˆ’âˆ’âˆ’âˆ’âˆ’â†’
...
...
B
A
(ZH-HM)
â†âˆ’âˆ’âˆ’âˆ’â†’AÂ·B

0
(ZH-HU)
â†âˆ’âˆ’âˆ’âˆ’â†’

Î±
...
Â¬
(ZH-EC)
â†âˆ’âˆ’âˆ’âˆ’â†’
Î±âˆ’1
Î±Ïƒ
...
c1
...
...
c2 ...
...
âˆ’u
(ZH-MF)
â†âˆ’âˆ’âˆ’âˆ’â†’
uâ€“1c1c2
...
...

b
a
(ZH-MCA)
â†âˆ’âˆ’âˆ’âˆ’âˆ’â†’
a+b

+
-
+
-
(ZH-UM)
â†âˆ’âˆ’âˆ’âˆ’â†’
+
-
...
...
+
0
+
1
+
2
+
Dâˆ’1
âˆš
D
(ZH-O)
â†âˆ’âˆ’âˆ’â†’
...
...
+
0
+
1
+
2
+
Dâˆ’1

âˆ’u
âˆ’u
u
u
...
...
...
...
(ZH-HWB)
â†âˆ’âˆ’âˆ’âˆ’âˆ’â†’
v
âˆ’v
...
...
u
u
...
...
...
...
(ZH-HMB)
â†âˆ’âˆ’âˆ’âˆ’âˆ’â†’
âˆ’u
...
...
uk
âˆ’u
(ZH-ME)
â†âˆ’âˆ’âˆ’âˆ’â†’
...
)
k
c1
c2
(ZH-ND)
â†âˆ’âˆ’âˆ’âˆ’â†’
c2âˆ’c1
0

u
u
c
(ZH-NH)
â†âˆ’âˆ’âˆ’âˆ’â†’
uâ€“1c

0
(ZH-NA)
â†âˆ’âˆ’âˆ’âˆ’â†’
Figure 3:
Various scalar-exact rewrites (including axioms and corollaries) on ZH diagrams, which are sound for
the semantics described in Eqn. (6) subject to Î½ = Dâˆ’1/4. Chains of rewrites Dj
(x)
â†â†’Â· Â· Â· â†”Df are intended to
indicate that Dj
(x)
â†â†’Df is either an axiom or notable corollary. Throughout, we have k âˆˆN, a, b, c, c1, c2 âˆˆZ
(which may be evaluated modulo D); u, v âˆˆZÃ—
D ; A, B : Z â†’C; and Î± âˆˆCÃ—. H-boxes which are labeled inside
with an integer parameter such as c âˆˆZ, indicates an amplitude of Ï‰c = e2Ï€ic/D; H-boxes labelled with + or -
indicate c = Â±1 (see Figure 2). A not dot labeled with Â¬ indicates a dimension-dependent parameter âˆ’Ïƒ âˆˆZ,
where Ïƒ = 0 for D odd and Ïƒ = 1 for D even; more generally, not-dots may be parameterised by c âˆˆZ for the
sake of convenience and reduced modulo D to an element of [D]. Soundness proofs for these rewrites may be
found in Appendix F.2.
hh
[a]
ii
= |aâŸ©âŸ©
hh
[a]
ii
= |Ï‰aâŸ©âŸ©
hh
[1]
ii
= X
hh
[1]
ii
= Z
ï£®
ï£°
ï£®
ï£°
ï£¹
ï£»
ï£¹
ï£»= CX
ï£®
ï£°
ï£®
ï£°
+
ï£¹
ï£»
ï£¹
ï£»= CZ
hh Î± ii
= Î±
ï£®
ï£¯ï£°
ï£®
ï£¯ï£°
c
ï£¹
ï£ºï£»
ï£¹
ï£ºï£»= CCZc

+

=
1
âˆš
D
X
k,xâˆˆ[D]
Ï‰kx |kâŸ©âŸ¨x|
ï£®
ï£°
ï£®
ï£°
A
ï£¹
ï£»
ï£¹
ï£»=
X
x,yâˆˆ[D]
A(xy) |x, yâŸ©âŸ¨x, y|
hh
Î˜
ii
=
X
xâˆˆ[D]
Î˜(x) |xâŸ©âŸ¨x|
Figure 4: A selection of simple diagrams to represent vectors and unitary operators, subject to the semantics
of Eqn. (6) and Î½ = Dâˆ’1/4. We let Î± âˆˆCÃ—, a, c âˆˆ[D], and A, Î˜ : Z â†’C. In this case, |aâŸ©âŸ©= D1/4|aâŸ©and
|Ï‰aâŸ©âŸ©= D1/4|Ï‰aâŸ©. We deï¬ne X|tâŸ©= |t+1âŸ©and Z|tâŸ©= Ï‰t|tâŸ©to be the usual generalised Pauli operators on H,
and CX|x, yâŸ©= |x, y+xâŸ©and CZ|x, yâŸ©= Ï‰xy|x, yâŸ©to be the (integer-)controlled versions of those same operators.
These constructions are discussed in Section 4.
5

2
Preliminaries
2.1
Mathematical preliminaries
Number theory.
Let D > 1 be a ï¬xed integer, and Ï‰ = e2Ï€i/D. We assume some basic familiarity
with number theory, in particular with ZD, the integers modulo D. While it is common to associate ZD
with the set {0, 1, . . . , Dâˆ’1} of non-negative â€˜residuesâ€™ of integers modulo D, one might also associate
them ZD with a set of â€˜signed residuesâ€™ [D] = (âˆ’1
2D, 1
2D] âˆ©Z = {LD, LD+1, . . . , UDâˆ’1, UD}, where
LD = âˆ’âŒŠDâˆ’1
2 âŒ‹and UD = âŒŠD
2 âŒ‹. We may then occasionally substitute ZD for [D] when this is unlikely to
cause confusion: this will most often occur in the context of expressions such as Ï‰xy, which is well-deï¬ned
modulo D in each of the variables x and y (i.e., adding any multiple of D to either x or y does not change
the value of the expression). In such an expression, while we may intend for one of x or y or both may be
an element of ZD in principle, they would in practise be interpreted as a representative integer x, y âˆˆ[D].
Measure theory.
We rely only on a modest amount of measure theory, as follows. For a set X, let
â„˜(X) be the power-set of X. We may deï¬ne a Ïƒ-algebra on X to be a set Î£ âŠ†â„˜(X) which contains
X, which is closed under set complements (S âˆˆÎ£ â‡”X \ S âˆˆÎ£), and which is closed under countable
unions (if S1, S2, . . . âˆˆÎ£, then S1 âˆªS2 âˆªÂ· Â· Â· âˆˆÎ£). â€” The purpose of deï¬ning Î£ is to allow the notion of
a measure Âµ : Î£ â†’R âˆª{+âˆ} to be deï¬ned, where the sets S âˆˆÎ£ are the ones which have a well-deï¬ned
measure. Such a function Âµ is a measure, if and only if Âµ(âˆ…) = 0, Âµ(S) â©¾0 for all S âˆˆÎ£, and if
Âµ
 S1 âˆªS2 âˆªÂ· Â· Â·

= Âµ(S1) + Âµ(S2) + Â· Â· Â·
(7)
for any sequence of disjoint sets Sj âˆˆÎ£. An example is the Ïƒ-algebra Î£ consisting of all countable unions
of intervals over R, with Âµ deï¬ned by assigning Âµ(J) = bâˆ’a to any interval J = (a, b), J = (a, b],
J = [a, b), or J = [a, b] for a â©½b. A somewhat more exotic measure is the Dirac distribution ÂµÎ´ on R, for
which ÂµÎ´(S) = 1 if 0 âˆˆS, and ÂµÎ´(S) = 0 otherwise.4 However, we will be mainly interested in measures
Âµ which can be deï¬ned on the subsets of [D], in which Âµ({x}) is the same for every singleton set.
2.2
ZX and ZH diagrams
ZX and ZH diagrams are both systems of â€˜string diagramsâ€™. ZX diagrams are eï¬€ective for representing
operations generated by single-qubit rotations and controlled-NOT gates. In most cases (excepting, e.g.,
Refs. [20, 27]), it rests on the unitary equivalence of two sets of conjugate bases. ZH diagrams were
developed as an alternative notation to ZX diagrams, to facilitate reasoning about quantum circuits over
the Hadamard-Toï¬€oli gate set [44, 45]. In each case, the diagrams are composed of dots or boxes, and
wires. These diagrams can be described as being a composition of â€˜generatorsâ€™, which typically consist
of one (or zero) dots/boxes with some amount of meta-data, and any number (zero or more) directed
wires, where the direction is usually represented by an orientation in the diagram. (In this article, wires
are oriented left-to-right, though they are also allowed to bend upwards or downwards.)
Composition of diagrams.
For two generators (or two more complicated diagrams) D1 and D2, we
may deï¬ne composite diagrams D1 âŠ—D2 and D1 ; D2, which we represent schematically by
D1 âŠ—D2
=
D1
D2
;
D1 ; D2
=
D1
D2
,
(8)
which we call the â€˜parallelâ€™ and â€˜serialâ€™ composition of D1 and D2. In the latter case we require that the
number of output wires of D1 (on the right of D1) equal the number of input wires of D2 (on the left of
D2), for the composition to be well-deï¬ned.
Semantic maps.
ZX and ZH diagrams are assigned a meaning, e.g., as operators over C, through a
semantic map [[ Â· ]] which maps each generator to some scalar, functional, or operator. To each generator
D with m input wires and n output wires, one assigns an operator [[D]] : HâŠ—m â†’HâŠ—n for some ï¬xed
vector space H over C. (For ZX and ZH diagrams over qubits, one takes H âˆ¼= C2; more generally one
may consider H âˆ¼= CD to consider a qudit of dimension D > 1, as we do in this article.) This semantic
map is deï¬ned to be consistent with respect to composition, in the sense that
hh
D1 âŠ—D2
ii
=

D1

âŠ—

D2

,
hh
D1 ; D2
ii
=

D2

â—¦

D1

,
(9)
4For more remarks on the Dirac distribution and related concepts, see Appendix A.
6

where the reversal of the order for sequential composition comes from the convention of considering
matrices as acting on a column vector on their right (so that function application is consistent between
diagrams and operators).
This allows diagrams to denote multi-linear operators on H in a straight-
forward way. The semantics of the ZX and ZH generators are usually deï¬ned to facilitate certain ways
of reasoning about multilinear maps on H, through how the diagrams represent those operators.
Wire generators / compact structure.
To represent string diagrams to represent operations in
which some qudits are being permuted or left unaï¬€ected, we also consider generators consisting only of
wires. Furthermore, we are interested in allowing deformations of diagrams in which the generators are
ï¬‚ex-symmetric [46]. We consider four such generators, to which we assign semantics as follows:

Î¸

= 1 =
X
xâˆˆ[D]
|xâŸ©âŸ¨x| ,


=
X
x,yâˆˆ[D]
|y,xâŸ©âŸ¨x,y| ,


=
X
xâˆˆ[D]
|x,xâŸ©,


=
X
xâˆˆ[D]
âŸ¨x,x| .
(10)
Semantics for ZX generators.
The usual approach to assigning semantics to ZX generators is by
considering the green and red dots to represent similar operations, subject to diï¬€erent (conjugate) choices
of orthonormal basis, and a unitary â€˜Hadamardâ€™ (or Fourier transform) gate relating the two bases.
Conventionally, one indexes the standard basis of H by |0âŸ©, |1âŸ©, . . . , |Dâˆ’1âŸ©, in short by |xâŸ©for x âˆˆ[D]
deï¬ned by [D] = {0, 1, . . . , Dâˆ’1}.
We instead take [D] = (âˆ’1
2D, 1
2D] âˆ©Z as above, and index the
standard basis by |LDâŸ©, |LDâˆ’1âŸ©, . . . , |âˆ’1âŸ©, |0âŸ©, |+1âŸ©, . . . , |UDâŸ©. We then deï¬ne â€˜greenâ€™ (lighter-coloured)
dots in terms of an action on the basis |xâŸ©, and the â€˜redâ€™ (darker-coloured) dots in terms of an action
on the basis |Ï‰xâŸ©, where |Ï‰kâŸ©=
1
âˆš
D
P
x Ï‰âˆ’kx |xâŸ©for k âˆˆ[D].5
Speciï¬cally: for a green dot with
angular parameters Î¸ âˆˆR[D], one conventionally assigns the interpretion P
xâˆˆ[D] eiÎ¸x |xâŸ©âŠ—nâŸ¨x|âŠ—m; and
one assigns the interpretation P
xâˆˆ[D] eiÎ¸x |Ï‰xâŸ©âŠ—nâŸ¨Ï‰x|âŠ—m to a red dot with parameter Î¸. For D > 2,
taking such a conventional interpretation does not yield a â€˜ï¬‚exsymmetricâ€™ [46] calculus, in eï¬€ect because
âŸ¨Ï‰a|T = |Ï‰aâŸ©âˆ—= |Ï‰âˆ’aâŸ©. In particular, this would mean that

Î¸

=

Î¸

=

Î¸

(11)
would not hold: the ï¬rst would denote P
x eiÎ¸x |Ï‰âˆ’x, Ï‰xâŸ©, the second would denote P
x eiÎ¸x |Ï‰x, Ï‰xâŸ©, and
the third would denote P
x eiÎ¸x |Ï‰x, Ï‰âˆ’xâŸ©. Speciï¬cally, this represents a way in which such a calculus
would fail to have the useful syntactic property that â€œonly the connectivity mattersâ€ [1, 13]; and other
inconveniences would also arise, which would make these diagrams more diï¬ƒcult to work with. In order
to avoid this problem, we endorse the convention adopted Refs. [27, 28] of involving a generator which
is related to the green dot by diï¬€erent unitary transformations on the inputs and outputs. We then
interpret the generators of Eqn (1) as operators using a model [[ Â· ]] which typically satisï¬es the following:
""
Î˜
...
m

...

n
##
âˆ
X
xâˆˆ[D]
Î˜(x) |xâŸ©âŠ—nâŸ¨x|âŠ—m
hh
+
ii
âˆ
X
kâˆˆ[D]
|kâŸ©âŸ¨Ï‰k| =
1
âˆš
D
X X
x,kâˆˆ[D]
e2Ï€ikx/D |xâŸ©âŸ¨k|
""
Î˜
...
m

...

n
##
âˆ
X
kâˆˆ[D]
Î˜(k) |Ï‰âˆ’kâŸ©âŠ—nâŸ¨Ï‰k |âŠ—m
hh
-
ii
âˆ
X
kâˆˆ[D]
|Ï‰kâŸ©âŸ¨k| =
1
âˆš
D
X X
x,kâˆˆ[D]
eâˆ’2Ï€ikx/D |xâŸ©âŸ¨k|
(12)
where we allow a general function Î˜(x) for Î˜ : Z â†’C in place of a phase parameter eiÎ¸x given by a
vector Î¸ âˆˆR[D].6 We can recover the usual convention of parameterising nodes by a simple phase angle
when desired, by adopting a short-hand in which an angle Î¸ stands for the function Î˜(x) = eiÎ¸x and a
vector Î¸ âˆˆR[D] stands for the function Î˜(x) = eiÎ¸x. Note that the semantics for the
+
box, makes
it proportional to the quantum Fourier transform over ZD.
Semantics for ZH generators.
The main feature of ZH diagrams is the use of the H boxes to
represent scalar coeï¬ƒcients in a symmetric way depending on products of indices. We typically interpret
the generators of Eqn (2) as operators using a model [[ Â· ]] which satisï¬es the following:
""
...
m

...

n
##
âˆ
X
xâˆˆ[D]
|xâŸ©âŠ—nâŸ¨x|âŠ—m
hh
c
ii
âˆ
X
xâˆˆZD
|âˆ’câˆ’xâŸ©âŸ¨x|
""
A
...
m

...

n
##
âˆ
X X
xâˆˆ[D]m, yâˆˆ[D]n
A(x1Â·Â·Â· xmy1Â·Â·Â· yn) |yâŸ©âŸ¨x|
""
...
m

...

n
##
âˆ
X X
xâˆˆZm
D, yâˆˆZn
D
P
h
xh+P
k
yk = 0
|yâŸ©âŸ¨x| .
(13)
5In the notation of Booth and Carette [27], we have |Ï‰kâŸ©= |k:XâŸ©, up to a relabeling of the basis elements of H.
6For the case D = 2, Ref. [19] shows advantages to including scalar factors diï¬€erent from +1 for a semantic map following
Eqn. (12). Our work is to describe one fruitful way to choose such scalar factors.
7

where we allow a general function A : Z â†’C in place of an amplitude Î± âˆˆC which one would con-
ventionally use to parameterise H-boxes. Again, we can recover the usual convention by adopting the
short-hand, that an amplitude Î± âˆˆCÃ— stands for the function A(t) = Î±t for t âˆˆZ.7 In particular, we ï¬x
the semantics so that
hh Î± ii
=
X
(singleton)
Î±(empty product) Â· 1 = Î±1 = Î±.
(14)
Note that for the H-boxes, we consider the products of the input and output labels x1, . . . , xm, y1, . . . , ym
as integers in the context of the expression A(x1 Â· Â· Â· ym). By contrast, for the gray dots and the not-dots,
we adopt an interpretation of the elements of [D] as integers modulo D, and consider ZD arithmetic in
the labels of the point-mass functions. (For instance, for the gray dots, we constrain the summation
indices x âˆˆZm
D and y âˆˆZn
D, so that the sum of their entries is 0 âˆˆZD .)
Rewrite systems.
In addition to merely denoting operators over C, we may perform calculations using
ZX and ZH diagrams, by considering transformations of diagrams D1 7â†’D2 that satisfy [[D1]] = [[D2]].
This is occasionally relaxed, to consider rewrite systems for which [[D1]] âˆ[[D2]]; systems in which equality
holds may be called scalar exact to emphasise this fact. A rewrite which preserves semantics in this way,
are said to be sound for that semantic map [[ Â· ]]; which rewrites have this property depends on the choice
of [[ Â· ]]. A separate, more diï¬ƒcult to analyse property is how easy a rewrite system is to use. We suggest
that rewrite systems, in which the most commonly used rewrite rules can be expressed simply, are to
be preferred over others; but this depends on obtaining a semantic map [[ Â· ]] for which such a rewrite
system is sound. In Ref. [19], in the case D = 2, one of us formulated just such a semantic map [[ Â· ]]Î½
for both ZX and ZH diagrams. However, the semantics assigned to the ZX and ZH generators by [[ Â· ]]Î½
is non-obvious, presenting a diï¬€erent obstacle to working with those semantics. This raises the question
of how one might obtain semantics for the ZX and ZH generators, which are themselves easily to express
and reason about, and also leads to a system of rewrites which is simple and easy to reason about.
3
Qudit operators as multi-linear maps on a measure space
In this section, we consider how we may express sums and multilinear operators on H âˆ¼= CD, in terms
of integrals over [D] with a discrete measure. We then consider the constraints imposed on Ockhamic
semantic map of ZX- and ZH-generators, by requiring that they be simply expressed by such integrals.
We then describe some of the consequences of these semantics for rewrite systems on these diagrams.
3.1
Measures and integration over ZD
We may consider the Ïƒ-algebra B = â„˜([D]), consisting of all subsets of [D], and deï¬ne the measure
Âµ : B â†’R on this Ïƒ-algebra given by
Âµ(S) = #S Â· Î½2,
(15)
for some Î½ > 0 which in principle may be chosen freely. (Here, #S simply denotes the number of elements
of S.) Let N = DÎ½2 represent the measure that we assign to the entire set [D] in that Âµ([D]) = N; we
also have Âµ({a}) = Î½2 = N/D for an arbitrary singleton a âˆˆ[D].
This presents [D] as a measure space, the purpose of which is to allow us to deï¬ne (multi-)linear
operators on H as arising from integrals with respect to that measure. For a function f : Z â†’C, we may
deï¬ne a notion of integration of f over a subset S âŠ†[D]:
Z
xâˆˆS
f(x) dÂµ(x) =
X
xâˆˆS
f(x) Âµ({x}) =
X
xâˆˆS
f(x) Î½2,
and in particular N =
Z
xâˆˆ[D]
1 Â· dÂµ(x) ,
(16)
consistent with the notion of normalisation of N for the entire measure space [D].
Our use of integrals and discrete measures in this way is standard, if somewhat uncommon in quantum
information theory: see Ref. [47] for a comparable example (though in our work, we sometimes emphasise
the measure more). Nor are we the ï¬rst to use integration in relation to describing diagrammatic calculi:
see for instance the work of Majid [29], which however is much more concerned with deï¬ning a form of
7Note that our convention of indexing the basis vectors of H by |xâŸ©for x âˆˆ[D] = {LD, LD+1, . . . , UDâˆ’1, UD}, means
that for D > 2 we the exponential function t 7â†’Î±t for Î± = 0 is not well-deï¬ned. We may instead consider a more function
X{0} : Z â†’C given by X{0}(t) = 1 for t = 0, with X{0}(t) = 0 otherwise; this substitution is adequate to play the same
role that A(t) = Î±t plays for Î± = 0 where t âˆˆ{0, 1, . . . , Dâˆ’1}, e.g., in certain applications to counting complexity [33, 40].
8

the ZX calculus to non-(co-)commutative algebras and co-algebras. By contrast, our intent is explicitly
to draw attention to integrals as an means of deï¬ning multi-linear operators on H, as an approach to
deï¬ning semantic maps for ZX and ZH diagrams.
We may apply this notion of integration to operator-valued functions, as is typical for wave-functions
in quantum mechanics. For instance, one may deï¬ne
Z
xâˆˆS
f(x) |xâŸ©dÂµ(x) = Î½2 X
xâˆˆS
f(x) |xâŸ©.
(17)
Note that in the usual approach to describing wave-functions over R, one takes |xâŸ©to represent a point-
mass distribution (i.e., it isnâ€™t a vector v âˆˆCR for which vx = 1), so that the following equality holds:
âŸ¨z|
" Z
xâˆˆR
f(x) |xâŸ©dx
#
=
Z
xâˆˆR
f(x)Î´z(x) dx = f(z),
(18)
where here Î´z(x) is a shifted Dirac distribution (see Appendix A.1 for more details). In the vector space
H, to avoid notational confusion, we prefer to reserve the symbol â€˜|xâŸ©â€™ to represent a unit-norm standard
basis vector (i.e., a vector v âˆˆH such that vx = 1); but we may introduce a symbol â€˜|xâŸ©âŸ©â€™ which denotes
the vector |xâŸ©âŸ©=
1
Î½ |xâŸ©, speciï¬cally so that we may write
âŸ¨âŸ¨z|
"
Z
xâˆˆ[D]
f(x) |xâŸ©âŸ©dÂµ(x)
#
=
Z
xâˆˆ[D]
f(x) âŸ¨âŸ¨z|xâŸ©âŸ©dÂµ(x) = Î½2 X
xâˆˆ[D]
f(x)âŸ¨z|xâŸ©
Î½2
= f(z) ,
(19)
and also
Z
xâˆˆ[D]
|xâŸ©âŸ©âŸ¨âŸ¨x| dÂµ(x) = Î½2 X
xâˆˆ[D]
|xâŸ©âŸ¨x|
Î½2
=
X
xâˆˆ[D]
|xâŸ©âŸ¨x| = 1 .
(20)
This notation â€˜|xâŸ©âŸ©â€™ for a possibly-non-normalised basis vector provides us the ï¬‚exibility to consider which
measures Âµ : B â†’R are best suited for deï¬ning convenient semantics for ZX and ZH generators, while
retaining the features provided by Dirac distributions over R.
The above is in principle all the background that is necessary to interpret these integrals over [D], as
we use them in this article. However, it is also possible to interpret this notion of integration over [D] in
terms of integration over ZD, which in turn may be interpreted in terms of integration over a continuous
group. Readers who are interested in such an interpretation may ï¬nd it in Appendix C.3.
3.2
Constraints on normalisation motivated by the Fourier transform
A precise value for Î½ > 0 or for N > 0 is something that can only be ï¬xed by imposing constraints on the
way that we represent certain integrals, operators, or functionals. We are particularly interested in the
constraints imposed by how one would represent the discrete Fourier transform over ZD, as an analogue
of the Fourier transform over R.
For a function f : ZD â†’C, in analogy to a common representation of the Fourier transform of a
real-valued function,8 suppose that we wished to describe the (discrete) Fourier transform of f by a
function Ë†f : ZD â†’C given by
Ë†f(k) =
Z
xâˆˆZD
eâˆ’2Ï€ikx/D f(x) dÂµ(x),
(21)
where here we adopt a notion of integration over ZD induced by the one described above for [D]. Diï¬€ering
conventions exist for how one might normalise the Fourier transform, over R or indeed over ZD : in
particular, opinions could diï¬€er about whether Eqn. (21) should be modiï¬ed by including a non-trivial
scalar factor on the right-hand side. Whether this should be done is connected to the question of whether
we consider the Fourier transform to preserve the measure Âµ of ZD, the separate question of whether we
consider it to preserve the â„“2 norm of the functions it acts on in an appropriate sense, and the further
question of what the measure N = Âµ(ZD) should be.
8We emulate the presentation of the Fourier transform in terms of an oscillation frequency k (as the more common
convention of angular frequency 2Ï€k used by physicists does not admit an obvious deï¬nition over the integers mod D). The
factor of 1/D in the exponent, which is the main notational diï¬€erence between Eqn. (21) and the usual Fourier transform
over R, can be shown to arise from formal connections between the Fourier transform over R and representations of functions
f : ZD â†’C in terms of discrete distributions on R (see Appendix C.4). Note also the presence of a minus sign in the
exponent, which for historical reasons is absent in the usual deï¬nition of the quantum Fourier transform.
9

We adopt the convention of deï¬ning the Fourier transform of f : ZD â†’C as in Eqn. (21). It will be
useful (again in analogy to standard practise in physics) to use f to describe a â€˜wave-functionâ€™,9
|fâŸ©âŸ©:=
Z
xâˆˆZD
f(x) |xâŸ©âŸ©dÂµ(x) .
(22)
Whether the Fourier transform â€œpreserves the measure of ZDâ€, is the question of how we should interpret
the domain of Ë†f as a measure space (ZD, Âµâ€²), where Âµâ€² in principle may diï¬€er from Âµ.10 We would write
| Ë†f âŸ©âŸ©=
Z
kâˆˆZD
Ë†f(k) |kâŸ©âŸ©dÂµâ€²(k) ,
(23)
integrating with respect to that diï¬€erent measure, for which Âµâ€²(ZD) = N â€² might diï¬€er from N. Taking
Âµâ€² Ì¸= Âµ would imply that the domain of the Fourier transform, consisting of functions f : (ZD, Âµ) â†’C,
is strictly speaking not the same as the codomain Ë†f : (ZD, Âµâ€²) â†’C. The string diagrams that would
result, would involve wires of more than one type. While not impossible in principle, this is a departure
from the usual approach of deï¬ning the ZX and ZH calculus, in which the wires all have the same type.
For the sake of simplicity â€” both in analysis of integrals, and in the design of ZX and ZH calculi â€” we
prefer to conceive of f and Ë†f as having the same measure space (ZD, Âµ) for their domains. Identifying
Âµâ€² = Âµ, we may simplify Eqn. (23) to
| Ë†f âŸ©âŸ©=
Z
kâˆˆZD
Ë†f(k) |kâŸ©âŸ©dÂµ(k) =
ZZ
k,xâˆˆZD
eâˆ’2Ï€ikx/Df(x) |kâŸ©âŸ©dÂµ(x) dÂµ(k) .
(24)
This would then motivate the deï¬nition for the discrete Fourier transform operator F over ZD, as
F =
ZZ
k,xâˆˆZD
eâˆ’2Ï€ikx/D |kâŸ©âŸ©âŸ¨âŸ¨x| dÂµ(x) dÂµ(k) ,
(25)
so that F|fâŸ©âŸ©= | Ë†f âŸ©âŸ©.
The question of whether the Fourier transform preserves the norm, is precisely the question of whether
F is unitary. We adopt the convention that F is indeed unitary, to allow it to directly represent a possible
transformation of state-vectors over H. This has the further beneï¬t that the inverse Fourier transform
can be expressed simularly to the Fourier transform, i.e., without scalar factors:
F âˆ’1 = F â€  =
ZZ
x,kâˆˆZD
e2Ï€ikx/D |xâŸ©âŸ©âŸ¨âŸ¨k| dÂµ(k) dÂµ(x) ,
(26)
so that in particular we may write
f(x) = âŸ¨âŸ¨x|F â€ | Ë†f âŸ©âŸ©=
Z
kâˆˆZD
e2Ï€ikx/D Ë†f(k) dÂµ(k) ,
(27)
again in close analogy to the standard deï¬nition of the Fourier transform over R.
The deï¬nition of F in Eqn. (25) and the constraint that it should be unitary, imposes a constraint on
the measure Âµ on ZD. We ï¬rst prove a routine Lemma (which will be of some use in the Appendices in
simplifying iterated integrals):
Lemma 1. Let Ï‰ = e2Ï€i/D and E âˆˆ[D]. Then
R
kâˆˆZD
Ï‰Ek dÂµ(k) = âŸ¨âŸ¨E|0âŸ©âŸ©DÎ½4.
Proof. This holds by reduction to the usual exponential sum:
Z
kâˆˆ[D]
e2Ï€iEk/D dÂµ(k) = Î½2 X
kâˆˆ[D]
 Ï‰Ek =
ï£±
ï£´
ï£²
ï£´
ï£³
Î½2 Â· Ï‰ELD Â· (Ï‰E)D âˆ’1
Ï‰ âˆ’1
, if Ï‰E Ì¸= 1
Î½2 Â· D, if Ï‰E = 1
ï£¼
ï£´
ï£½
ï£´
ï£¾
= Î´E,0 DÎ½2
= âŸ¨E|0âŸ©DÎ½2
= âŸ¨âŸ¨E|0âŸ©âŸ©DÎ½4 .
9Note that |fâŸ©âŸ©is not necessarily a unit vector; whether |fâŸ©âŸ©âˆˆH is normalised depends on the values taken by f.
10This may seem like quite a technical consideration, but it is in principle unavoidable in physics when performing Fourier
analysis over R, as it is connected to the choice of units for the domain of the function f and for its Fourier transform Ë†f.
10

We may apply this in the case of the Fourier transform as follows. If F as expressed in Eqn. (25) is
unitary, we have
1 = F â€ F =
"
ZZ
y,hâˆˆ[D]
e2Ï€ihy/D |yâŸ©âŸ©âŸ¨âŸ¨h| dÂµ(y) dÂµ(h)
#"
ZZ
k,xâˆˆ[D]
eâˆ’2Ï€ikx/D |kâŸ©âŸ©âŸ¨âŸ¨x| dÂµ(k) dÂµ(x)
#
=
ZZZZ
y,h,k,xâˆˆ[D]
e2Ï€i(hyâˆ’kx)/D |yâŸ©âŸ©âŸ¨âŸ¨h|kâŸ©âŸ©âŸ¨âŸ¨x| dÂµ(y) dÂµ(h) dÂµ(k) dÂµ(x)
=
ZZZ
y,k,xâˆˆ[D]
e2Ï€ik(yâˆ’x)/D |yâŸ©âŸ©âŸ¨âŸ¨x| dÂµ(y) dÂµ(k) dÂµ(x)
=
ZZ
y,xâˆˆ[D]
"
Z
kâˆˆ[D]
e2Ï€ik(yâˆ’x)/D dÂµ(k)
#
|yâŸ©âŸ©âŸ¨âŸ¨x| dÂµ(y) dÂµ(x)
=
ZZ
y,xâˆˆ[D]
h
DÎ½4 Â· âŸ¨âŸ¨y|xâŸ©âŸ©
i
|yâŸ©âŸ©âŸ¨âŸ¨x| dÂµ(y) dÂµ(x) = DÎ½4
Z
xâˆˆ[D]
|xâŸ©âŸ©âŸ¨âŸ¨x| dÂµ(x) = DÎ½4 Â· 1 .
(28)
This implies that Î½ = Dâˆ’1/4 (or equivalently, N = Âµ(ZD) = DÎ½2 =
âˆš
D).
It may be of interest to consider, how imposing a value for N diï¬€erent from
âˆš
D would aï¬€ect the
presentation of the Fourier transform, or the relationships between the measures of the domain of a
function f : (ZD, Âµ) â†’C and that of Ë†f. We discuss this in Appendix B.
4
Application to ZX- and ZH-calculi
There are a number of convenient consequences to deï¬ning a discrete integral on [D] as we do in the
preceding Section, ï¬rstly for analysis of the Fourier transform and certain discrete integrals of roots
of unity, and for sound rewrite systems on ZX and ZH diagrams when we assign semantics for the
ZX and ZH generators as we do in Eqn. (6). In this section, we demonstrate these features â€” in part to
demonstrate how simple operators would be denoted using our semantics for the ZX and ZH generators,
but also in part to demonstrate how those same operators can be denoted using discrete integrals.
Fourier basis distributions.
We deï¬ned the vectors |Ï‰kâŸ©âŸ©on page 3 essentially as a formal (super-
normalised) analogue of the orthonormal Fourier basis states |Ï‰kâŸ©. As a simple consequence of choosing
the normalisation for integrals over [D], so that the Fourier transform is a unitary transformation on
wave-functions, we may express the vectors |Ï‰kâŸ©âŸ©quite simply (dropping the dÂµ(x) for brevity):
|Ï‰kâŸ©âŸ©= F|kâŸ©âŸ©=
Z
xâˆˆ[D]
Ï‰âˆ’kx |xâŸ©âŸ©.
(29)
Quadratic Gaussian integrals.
Following Ref. [50], deï¬ne the complex unit Ï„ = eÏ€i(D2+1)/D, which
is relevant to the analysis of stabiliser circuits on qudits of dimension D. To analyse such circuits using
ZX diagrams, the following integral will be relevant:
Î“(a, b, D) :=
Z
xâˆˆ[D]
Ï„ 2ax+bx2 .
(30)
Evaluating this discrete integral is connected with the subject of quadratic Gaussian sums, which we
address in some detail Appendix D. As a result of the normalisation convention for our discrete integrals,
it is possible to show (see Eqn. (100) on page 29) that
Î“(a, b, D)
 = 1 when b is a multiplicative unit
modulo D (e.g., b = Â±1); if a = 0 as well, Î“(a, b, D) is a power of eÏ€i/4. More generally, Î“(a, b, D)
will either be 0, or have magnitude
âˆš
t, where t = gcd(b, D). Speciï¬cally, we have Î“(a, b, D) = 0 if
a is not divisible by t, or if (D + Db/t2) âˆˆZ is odd; and |Î“(a, b, D)| =
âˆš
t otherwise. In particular,
Î“(0, 0, D) =
R
x 1 dÂµ(x) =
âˆš
D.
The stabiliser fragment of ZX for qudits of dimension D.
The scalar Ï„ is deï¬ned in such a way
that Ï„ 2 = Ï‰, but also so that Ï„Xâ€ Zâ€  is an operator of order D, where X and Z given by
X |tâŸ©= |t + 1âŸ©,
Z |tâŸ©= Ï‰t |tâŸ©,
(31)
11

are the D-dimensional generalised Pauli operators. (As always, arithmetic performed in the kets are
evaluated modulo D.) Choosing Ï„ in this way makes it possible [50] to deï¬ne a simple and uniform
theory of unitary stabiliser circuits on qudits of dimension D, generated by the single-qudit operators11
S =
Z
xâˆˆ[D]
Ï„ x2 |xâŸ©âŸ©âŸ¨âŸ¨x| ;
F =
ZZ
k,xâˆˆ[D]
Ï„ âˆ’2kx |kâŸ©âŸ©âŸ¨âŸ¨x| ;
Mu =
Z
xâˆˆ[D]
|uxâŸ©âŸ©âŸ¨âŸ¨x|
for various u âˆˆZÃ—
D,
(32)
and either one of the two-qudit operators
CX =
ZZ
x,yâˆˆ[D]
|xâŸ©âŸ©âŸ¨âŸ¨x| âŠ—|x+yâŸ©âŸ©âŸ¨âŸ¨y| ;
CZ =
ZZ
x,yâˆˆ[D]
Ï„ 2xy |x, yâŸ©âŸ©âŸ¨âŸ¨x, y| .
(33)
Using a slightly diï¬€erent notational convention to Booth and Carette [27], we may easily denote these
with ZX diagrams using the semantics of Eqn. (6). For a, b âˆˆZ, when parameterising a green or red dot,
let [a ; b] stand for the amplitude function Î˜(x) = Ï„ 2ax+bx2, so that

[a ; b]

=
Z
xâˆˆ[D]
Ï„ 2ax + bx2 |xâŸ©âŸ©;

[a ; b]

=
Z
kâˆˆ[D]
Ï„ 2ak + bk2 |Ï‰âˆ’kâŸ©âŸ©;
(34)
generalising these to dots with multiple edges (or with none) similarly to Ref. [27]. When b = 0, we may
abbreviate this function simply by [a], so that we may then easily represent the operators S, Z, and X
as 1 â†’1 dots:

[1]

=
Z
xâˆˆ[D]
Ï„ 2x |xâŸ©âŸ©âŸ¨âŸ¨x| = Z ;

[0 ; 1]

=
Z
xâˆˆ[D]
Ï„ x2 |xâŸ©âŸ©âŸ¨âŸ¨x| = S ;
(35a)

[1]

=
Z
hâˆˆ[D]
Ï„ 2h |Ï‰hâŸ©âŸ©âŸ¨âŸ¨Ï‰h| = X .
(35b)
We may also represent the states |aâŸ©âŸ©and |Ï‰aâŸ©âŸ©straightforwardly (albeit with the use of auxiliary red dots
to represent an antipode operator, mapping |Ï‰aâŸ©âŸ©7â†’|Ï‰âˆ’aâŸ©âŸ©and |aâŸ©âŸ©7â†’|âˆ’aâŸ©âŸ©for a âˆˆZD):

[a]

=
ZZ
k,xâˆˆ[D]
Ï„ 2ax |Ï‰âˆ’kâŸ©âŸ©âŸ¨âŸ¨Ï‰k|xâŸ©âŸ©= |Ï‰aâŸ©âŸ©;
(36a)

[a]

=
ZZ
h,kâˆˆ[D]
Ï„ 2ah |Ï‰âˆ’kâŸ©âŸ©âŸ¨âŸ¨Ï‰k|Ï‰âˆ’hâŸ©âŸ©= |aâŸ©âŸ©.
(36b)
The remaining operators may be expressed without any phases, using multi-edges between green and red
dots, or using Hadamard boxes:
""
##
= CX ,
""
+
##
= CZ ,
""
...
)
u
##
= Mu .
(37)
(The diagram shown for Mu also generalises to operators Mu =
R
x |uxâŸ©âŸ©âŸ¨âŸ¨x| for u not a multiplicative unit
modulo D, though in that case the operator will not be invertible.) Finally, dots of degree 0 frequently
have a simple interpretation:
hh
[a ; b]
ii
=
Z
xâˆˆ[D]
Ï„ 2ax+bx2 =: Î“(a, b, D) =
(âˆš
t Â· eiÎ³,
if t = gcd(b, D) and a is divisible by t;
0,
otherwise,
(38)
where Î³ is a phase parameter described in more detail in Eqn. (100); where in particular for b a multi-
plicative unit modulo D, this represents a global phase factor. This provides a diagrammatic language
which is capable of expressing the rewrites similar to those described by Ref. [27], while involving fewer
11Note that the deï¬nitions below are equivalent to those of Ref. [50], despite the diï¬€erent convention we adopt for the
labeling of the standard basis. For each x âˆˆ[D], we either have x â©¾0 or x < 0: in the latter case the relative phases Ï„ 2ax+bx2
remain well-deï¬ned on substitution of values x < 0 with D + x, as Ï„ 2a(D+x)+b(D+x)2 = Ï„ 2aD+2ax+bD2+2bD+bx2 = Ï„ 2ax+bx2
(using the fact that Ï„ D2 = Ï„ 2D = 1 for both even and odd D).
12

scalar factors; and the semantics can be easily described through the use of discrete integrals over [D].
To make our presentation of the ZX-calculus complete for the stabilizer fragment (i.e., for the subtheory
in which all amplitudes are given by [a ; b] for various a, b âˆˆZ),12 it would suï¬ƒce to describe rewrites for
particular values of D which force an interpretation of [a ; b]
as being either Î“(a, b, D) or Î“(a, b, D)âˆ—.
Multipliers and multicharacters in qudit ZH.
In practise, it would be cumbersome to reason
about multiplication operators Mu or iterated CX or CZ gates using parallel edges between dots. Booth
and Carette describe [27] how these may be denoted using recursively deï¬ned gadgets called â€˜multipliersâ€™,
denoted
c
for c âˆˆN, which represent a limited form of scalable ZX notation [51, 52]. Using discrete
integrals and the semantics described in Eqn. (6), we would simply write
""
c
##
=
""
...
)
c
##
=
Z
xâˆˆ[D]
|cxâŸ©âŸ©âŸ¨âŸ¨x| .
(39)
Using these multipliers, Booth and Carette [27, p. 24] then deï¬ne â€˜Fourier boxesâ€™
c
:=
c
+
(using our notation for Hadamard boxes), with semantics given by
hh
c
ii
=
ZZ
x,yâˆˆ[D]
Ï‰cxy |yâŸ©âŸ©âŸ¨âŸ¨x| .
(40)
As a ZH generator, this is an H-box with an amplitude parameter Ï‰c. Using this as a primitive, and
composing this with the inverse
-
of the positive Hadamard box
+
, we may directly describe
multipliers instead as a ZH gadget, also loosely following Roy [35]:
c
-
=:
c
.
(41)
The amplitude parameter Ï‰c corresponds to a character function Ï‡c : Z â†’C given by Ï‡c(x) = Ï‰cx, which
is well-deï¬ned modulo D, and which we may then regard as a character on ZD. The function Z Ã— Z â†’C
given by (x, y) 7â†’Ï‡c(xy) is a bicharacter, which is also well-deï¬ned modulo D on each of its arguments;
and more generally we may consider multicharacters, which are functions ZD Ã— Â· Â· Â· Ã— ZD â†’C given by
(x1, . . . , xn) 7â†’Ï‰cx1Â·Â·Â·xn. We may call H-boxes with any number of edges, and with amplitude parameter
Ï‰c for some c âˆˆZD, a (ZD-)multicharacter box. We may use multiplier gadgets and multicharacter boxes
themselves to usefully describe unitary transformations:
ï£®
ï£¯ï£¯ï£°
ï£®
ï£¯ï£¯ï£°
-
c
ï£¹
ï£ºï£ºï£»
ï£¹
ï£ºï£ºï£»= CXc =
ZZ
x,yâˆˆ[D]
|x, y+cxâŸ©âŸ©âŸ¨âŸ¨x, y| ,
ï£®
ï£¯ï£°
ï£®
ï£¯ï£°
c
ï£¹
ï£ºï£»
ï£¹
ï£ºï£»= CZc =
ZZ
x,yâˆˆ[D]
Ï‰cxy |x, yâŸ©âŸ©âŸ¨âŸ¨x, y| .
(42)
Note that for c âˆˆZD, we may also easily describe unitary transformations operations which are in general
not stabiliser operators over ZD, such as highly-controlled-X and -Z operators. For example:
ï£®
ï£¯ï£¯ï£°
ï£®
ï£¯ï£¯ï£°
c
-
ï£¹
ï£ºï£ºï£»
ï£¹
ï£ºï£ºï£»= CCXc =
ZZZ
x,y,zâˆˆ[D]
|x, y, z+cxyâŸ©âŸ©âŸ¨âŸ¨x, y, z| ,
ï£®
ï£¯ï£¯ï£°
ï£®
ï£¯ï£¯ï£°
c
ï£¹
ï£ºï£ºï£»
ï£¹
ï£ºï£ºï£»= CCZc =
ZZZ
x,y,zâˆˆ[D]
Ï‰cxyz |x, y, zâŸ©âŸ©âŸ¨âŸ¨x, y, z| . (43)
General controlled gates in qudit ZH.
The above construction is not special to multicharacters
over ZD, and can also be used in conjunction with an arbitrary amplitude Î± âˆˆCÃ— (yielding a unitary
operator if and only if |Î±| = 1), or indeed a more general function A : Z â†’C:
ï£®
ï£¯ï£¯ï£¯ï£¯ï£°
ï£®
ï£¯ï£¯ï£¯ï£¯ï£°
Î±
ï£¹
ï£ºï£ºï£ºï£ºï£»
ï£¹
ï£ºï£ºï£ºï£ºï£»
=
ZZZZ
w,x,y,zâˆˆ[D]
Î±wxyz |w,x,y,zâŸ©âŸ©âŸ¨âŸ¨w,x,y,z|
=
X
w,x,y,zâˆˆ[D]
Î±wxyz |w,x,y,zâŸ©âŸ¨w,x,y,z| ,
ï£®
ï£¯ï£¯ï£¯ï£¯ï£°
ï£®
ï£¯ï£¯ï£¯ï£¯ï£°
A
ï£¹
ï£ºï£ºï£ºï£ºï£»
ï£¹
ï£ºï£ºï£ºï£ºï£»
=
ZZZZ
w,x,y,zâˆˆ[D]
A(wxyz) |w,x,y,zâŸ©âŸ©âŸ¨âŸ¨w,x,y,z|
=
X
w,x,y,zâˆˆ[D]
A(wxyz) |w,x,y,zâŸ©âŸ¨w,x,y,z| .
(44)
Note that here one must recall that the variables of integration are integers, and in particular that the
12Note in particular that we do not present any rules which are clear analogues to the rules (Gauss), (M-One), (Neg), or
(Pos) of Ref. [27]. We expect that such rules would be necessary to demonstrate completeness for the stabiliser fragment
of ZX for D > 2 prime. Still more work still may be necessary to demonstrate completeness for composite D, thoigh possibly
in the case where D is square-free may prove to be simpler than the general case.
13

product of the variables of integration are evaluated in Z. It is for the application of multiply-controlled Î±
gates for Î± âˆˆCÃ—, that we have chosen to index the standard basis by [D] = {LD, LD+1, . . . , UDâˆ’1, UD},
where LD is negative for D > 2. The set [D] admits a simple involution,
Â¬ : [D] â†’[D] ;
Â¬x := Ïƒ âˆ’x ,
where Ïƒ = UD + LD =
(
1,
if D is even;
0,
if D is odd,
(45)
so that Â¬x = 1âˆ’x for D even, and Â¬x = âˆ’x for D odd.13 If we deï¬ne the syntactic sugar
Â¬
:=
âˆ’Ïƒ
,
we may show that
ï£®
ï£¯ï£¯ï£¯ï£¯ï£¯ï£¯ï£°
ï£®
ï£¯ï£¯ï£¯ï£¯ï£¯ï£¯ï£°
Â¬
Î±
ï£¹
ï£ºï£ºï£ºï£ºï£ºï£ºï£»
ï£¹
ï£ºï£ºï£ºï£ºï£ºï£ºï£»
=
ï£®
ï£¯ï£¯ï£¯ï£¯ï£¯ï£¯ï£°
ï£®
ï£¯ï£¯ï£¯ï£¯ï£¯ï£¯ï£°
Â¬
Î±
Â¬
ï£¹
ï£ºï£ºï£ºï£ºï£ºï£ºï£»
ï£¹
ï£ºï£ºï£ºï£ºï£ºï£ºï£»
=
ZZZZ
w,x,y,zâˆˆ[D]
Î±(Ïƒâˆ’w)xyz |Â¬w, x, y, zâŸ©âŸ©âŸ¨âŸ¨w, x, y, z|
=
ZZZZ
w,x,y,zâˆˆ[D]
Î±ÏƒxyzÎ±âˆ’wxyz |Â¬w, x, y, zâŸ©âŸ©âŸ¨âŸ¨w, x, y, z| =
ï£®
ï£¯ï£¯ï£¯ï£¯ï£¯ï£¯ï£°
ï£®
ï£¯ï£¯ï£¯ï£¯ï£¯ï£¯ï£°
Î±âˆ’1
Î±Ïƒ
Â¬
ï£¹
ï£ºï£ºï£ºï£ºï£ºï£ºï£»
ï£¹
ï£ºï£ºï£ºï£ºï£ºï£ºï£»
.
(46)
As a consequence, for a green node with arbitrary phase parameter Î¸ âˆˆR (representing an amplitude
function Î˜(x) = eiÎ¸x), it is possible to show that
ï£®
ï£¯ï£¯ï£°
ï£®
ï£¯ï£¯ï£°
Î¸
Â¬
Â¬
...
Â¬
Â¬
...
ï£¹
ï£ºï£ºï£»
ï£¹
ï£ºï£ºï£»=
ï£®
ï£¯ï£¯ï£¯ï£°
ï£®
ï£¯ï£¯ï£¯ï£°
âˆ’Î¸
...
...
eiÎ¸Ïƒ
ï£¹
ï£ºï£ºï£ºï£»
ï£¹
ï£ºï£ºï£ºï£»,
(47)
generalising the situation in conventional presentations of the ZX calculus for D = 2, in which red Ï€-phase
dots play the role of the Â¬-dots.
Remark on the above constructions.
Throughout the above, the operators, vectors, and scalars
may be deï¬ned simply using integrals and the super-normalised point-mass distributions |xâŸ©âŸ©.
These
lead to straightforward representations of a variety of unitary operators. We have also, incidentally, set
out a convention for representing stabiliser phases for ZX diagrams and for indexing basis states of H,
which we feel are helpful to present the vectors |aâŸ©âŸ©and |Ï‰aâŸ©âŸ©themselves, and the Pauli and Cliï¬€ord
operators on H for arbitrary D > 1. These conventions allow us to analyse ZD-multicharacters in the
case of ZH diagrams, and are nearly suï¬ƒcient to analyse the stabiliser fragment over ZD in the case of
ZX diagrams at least for D prime (apart from an absence of rules to reason about scalars).
Remark on rewrites.
The discussion above only begins to touch on the way in which these semantics
for ZX and ZH diagrams, supports simple and useful rewrites.
A greater variety of rewrites which
are sound for these semantics are demonstrated in Figures 1â€“3 (on pages 4 & 5), with proofs given in
Appendix F. While there is clearly work still to be done to demonstrate complete versions of these calculi
(suï¬ƒcient to prove equality of diagrams through rewrites alone), we hope that this section provides
a convincing demonstration that developing useful and complete qudit ZX-, ZH-, and ZXH-calculi is
possible, through the use of semantics expressed as discrete integrals in this way.
5
Sketch of a qudit normal form for ZH
In this Section, we outline a normal form for ZH diagrams, which together with standard techniques for
ZH normal forms [30] suï¬ƒce for any D > 1 to denote an arbitrary operator on H.
We may use the more general amplitude functions A : Z â†’C to deï¬ne more ï¬ne-grained operators
than with amplitude parameters alone. For instance, let XS be the characteristic function of a set S âŠ†Z
(so that XS(t) = 0 if t /âˆˆS, and XS(t) = 1 otherwise), and let VS(t) = (âˆ’1)XS(t). Then for D > 2, the
operation
13A similar involution Â¬x = ËœÏƒ âˆ’x exists for alternative deï¬nitions of [D], consisting of a sequence of D consecutive
integers. For instance: for the more conventional choice [D] = {0, 1, . . . , Dâˆ’1}, one would take ËœÏƒ = Dâˆ’1 for all D > 1.
This leads to rewrites which motivated us, on aesthetic grounds, to consider what deï¬nition of [D] would yield the smallest
possible value of Ïƒ for various D > 1. This is what leads us to advocate the convention [D] = {LD, LD+1, . . . , UDâˆ’1, UD}
for LD = âˆ’âŒŠDâˆ’1
2 âŒ‹and UD = âŒŠD
2 âŒ‹, most notably given that Ïƒ = 0 for all odd D.
14

ï£®
ï£¯ï£°
ï£®
ï£¯ï£°
V{1}
ï£¹
ï£ºï£»
ï£¹
ï£ºï£»=
ZZ
x,yâˆˆ[D]
V{1}(xy) |x, yâŸ©âŸ©âŸ¨âŸ¨x, y| = 1 âˆ’2

|-1, -1âŸ©âŸ¨-1, -1| + |+1, +1âŸ©âŸ¨+1, +1|

(48)
induces a sign of âˆ’1 on the |-1, -1âŸ©and |+1, +1âŸ©components of the two qudits it acts on (as these are
precisely the basis states |x, yâŸ©for which xy = +1 âˆˆZ).14
We may use similar gadgets as the basis of a normal form for qudit ZH diagrams. For an arbitrary
number m â©¾0 of input wires, we may consider a gadget of the form15
m
ï£±
ï£´
ï£´
ï£´
ï£²
ï£´
ï£´
ï£´
ï£³
...
1âˆ’Ïƒ
1âˆ’Ïƒ
M(2m)
Î±
,
where M(k)
Î± (t) =
(
Î±,
if t = U k
D ;
1,
otherwise.
(49)
We may describe the behaviour of this gadget as it acts on standard basis states. Each input wire of
this gadget admits a state |xjâŸ©âŸ©, and copies it to produce a pair |xj, xjâŸ©âŸ©. One copy is then acted on with
a (1âˆ’Ïƒ)-not-dot, yielding a state |xj, ÏD(Ïƒâˆ’1âˆ’xj)âŸ©âŸ©= |xj, ÏD(Â¬xâˆ’1)âŸ©âŸ©, where ÏD : Z â†’[D] is a map
which reduces each integer modulo D to a representative in [D]. (The map ÏD is implicit in many of the
transformations in which one might prefer to evaluate arithmetic modulo D: it arises here because we
must map the associate the expression Ïƒâˆ’1âˆ’xj , which we might prefer to implicitly evaluate modulo D
in the basis labels, to an explicit element of Z.) The M(2m)
Î±
box then maps |xâŸ©âŸ©7â†’Î± if and only if
n
Y
j=1

xj Â· ÏD(Â¬x âˆ’1)

= U 2m
D
,
(50)
and maps |xâŸ©âŸ©7â†’+1 otherwise. For x âˆˆZm, Eqn. (50) is satisï¬ed only if xj Â· ÏD(Â¬x âˆ’1) = Â±U 2
D for each
xj individually, as UD âˆˆ[D] is the element with the largest absolute value.
â€¢ Note that ÏD(Â¬x âˆ’1) Ì¸= Â¬x âˆ’1 if and only if Â¬x = LD, which is to say precisely when x = UD: in
this case, we have x Â· ÏD(Â¬x âˆ’1) = U 2
D.
â€¢ Otherwise, for x < UD, we have x Â· ÏD(Â¬x âˆ’1) = x Â· (Â¬x âˆ’1) = Ïƒx âˆ’x âˆ’x2. For D even, we have
Ïƒx âˆ’x âˆ’x2 = âˆ’x2; for D odd, we instead have Ïƒx âˆ’x âˆ’x2 = âˆ’x2 = âˆ’x(x + 1). The absolute
values of these expressions are bounded strictly below U 2
D in either case.
Then Eqn. (50) is satisï¬ed if and only if xj = UD for each 1 â©½j â©½m. The action of the gadget in
Eqn. (49) is then to map |UDâŸ©âŸ©âŠ—m 7â†’Î± and |xâŸ©âŸ©7â†’+1 for all other x âˆˆ[D]m.
Using gadgets of this form, we may express any operator â„¦: HâŠ—m â†’HâŠ—n in terms of its coeï¬ƒcients,
in a similar manner to the normal form for ZH diagrams in D = 2 presented by Backens and Kissinger [30].
That is, we may take any operator, transform it into a vector using cup operators, use white dots to
make copies of each qudit in the standard basis (one copy for every coeï¬ƒcient of the operator), and then
apply not-dots and gadgets of the form in Eqn. (49) to ï¬x the value of each coeï¬ƒcient Î±x,y = âŸ¨âŸ¨x| â„¦|yâŸ©âŸ©=
Î½âˆ’mâˆ’n â„¦x,y for x âˆˆ[D]m and y âˆˆ[D]n.
Remark on the above construction.
We do not expect that the rewrite rules that we have set out,
for ZX or ZH diagrams, suï¬ƒce to transform arbitrary diagrams to such a normal form. We leave open
the problem of demonstrating rewrites to transform arbitrary qudit ZH diagrams into a form such as the
one we have sketched here, or a similar one. We do think that it is likely that simple rewrite rules can be
found, which might allow the gadget of Eqn. (49) to be expressed using only phase-amplitude gadgets.
However, setting out such rules is beyond the scope of our current work, which is simply to present an
advantageous semantic map for ZX and ZH diagrams through discrete integrals.
14This is one drawback to the choice to index the standard basis by elements of {LD, LD+1, . . . , UDâˆ’1, UD} where LD
may be negative. A more conventional choice of [D] = {0, 1, . . . , Dâˆ’1} would see a similar operation induce a sign only on
the |+1, +1âŸ©component, which would make possible a signiï¬cant simpliï¬cation of the normal form described just below.
15Similar constructions are in many cases possible using a gadget of the form illustrated on the
right â€” where ÎµÎ±(t) = Î± for t = 1 and ÎµÎ±(t) = 1 otherwise â€” relying on the fact that 1 âˆ’x2 = Â±1
has no solutions over the integers except for x = 0, in which case 1âˆ’x2 = +1. However, to be more
precise, we must consider the conditions under which ÏD(âˆ’ÏD(âˆ’1âˆ’x)) Â· ÏD(1âˆ’x) = Â±1 admits
solutions for x âˆˆ[D]; and speciï¬cally when D = 4 and x = 2, we have Ï4(âˆ’Ï4(âˆ’1âˆ’x))Â·Ï4(1âˆ’x) =
(âˆ’1)Â·(âˆ’1) = +1. Constructions which single out |xâŸ©âŸ©= |tâŸ©âŸ©âŠ—n for a ï¬xed t âˆˆZ will likely fail for
some single value of D, for similar reasons.
...
...
âˆ’1
+1
âˆ’1
+1
ÎµÎ±
15

6
The case D = 2, and â€˜Ockhamicâ€™ semantic maps
Notice that the normalisation Î½ = Dâˆ’1/4, and the corresponding semantics, essentially reproduces the
â€˜well-temperedâ€™ semantics of ZX and ZH diagrams [19] in the case that D = 2.
The process by which we obtain this semantic map in this article, may appear very diï¬€erent from
how the well-tempered interpretation was devised in Ref. [19]. In the latter case, a family of â€˜Ockhamicâ€™
semantic maps were considered which diï¬€ered from each other in the values of normalising scalar factors
for each of the generators, subject to some constraints. (We discuss and generalise the notion of â€˜Ock-
hamic semantic mapsâ€™ of ZX diagrams and of ZH diagrams in Appendix E.) A speciï¬c semantic map
was then isolated by imposing successive constraints in the form of equations on the semantics of speciï¬c
diagrams. This eï¬€ectively solved for a semantic map, for which certain rewrite rules were sound. How-
ever, it must be admitted that the analysis of Ref. [19] does not provide any particular intuition for why
Î½ = Dâˆ’1/4 should be a natural parameter to govern the relationships between the ZX and ZH generators.
In this article, we instead set out a semantic map, making use of discrete integrals and an accompany-
ing system of point-mass distributions, with the intent that he ZX and ZH generators should be as simple
as possible within that framework. The precise semantics were determined by the single parameter Î½,
which we then ï¬xed by constraining the representation of the (quantum) Fourier transform. However:
it is worth noting that the framework of discrete integrals and (what we have here called) â€˜accompany-
ingâ€™ point-mass distributions, implicitly impose some of the constraints that were explicitly imposed in
Ref. [19]. Speciï¬cally: by choosing our notation so that
Z
xâˆˆ[D]
|xâŸ©âŸ©âŠ—nâŸ¨âŸ¨x|aâŸ©âŸ©
=
|aâŸ©âŸ©âŠ—n,
(51)
it is not diï¬ƒcult to show that we automatically ensure the correctness of a number of rewrites including
(ZX-GF), (ZX-CPY), (ZX-PU), (ZH-AI), (ZH-NS), (ZH-WGB), and (ZH-HM) for the semantics of Eqn. (6).
In this way, we may regard the framework of discrete integrals and accompanying point-mass distributions
as simplifying both the results and the methodology of Ref. [19]. This provides a clariï¬cation and a
theoretical justiï¬cation of the â€˜well-temperedâ€™ semantics, and indeed an extension of them to all D > 1.
Note that choosing the interpretations of Eqn. (6) just for the ZH generators, does not in fact impose
any constraints on either the measure Âµ on [D]. In the analysis of Section E.2, we show that (taken
on their own), the semantics of Eqn. (6) for the ZH generators only imposes the constraint on the
interpretation that the generators must be related to each other by simple geometric progressions related
to the parameter Î½, but does not ï¬x what Î½ should be.
(If we take Î½ =1, Eqn. (6) reproduces the
original semantics provided by Backens and Kissinger [30] for the ZH generators for D=2.) In eï¬€ect,
the ZH calculus prioritises the standard basis to such an extent that it does not impose any strong
relationships between that basis and any other, and in so doing leaves Î½ unconstrained. It is the single
constraint on the ZX generators, that |Ï‰kâŸ©âŸ©=
R
x Ï‰âˆ’kx |xâŸ©âŸ©should be unitarily equivalent to |xâŸ©âŸ©, which
suï¬ƒces to ï¬x the measure Âµ and thus to ï¬x speciï¬c semantics for all of the generators through Eqn. (6).
7
Summary and Discussion
We have presented an version of the ZX-and ZH-calculi over qudits of dimension D > 1, with an inter-
pretation of the generators given through simple discrete integrals over a set [D] of representatives of ZD,
using an accompanying set of point-mass distributions |xâŸ©âŸ©as the basis for the deï¬nition of operators.
This integral is determined by a measure Âµ on [D], which we constrain through a choice of representa-
tion for the Fourier transform. This latter constraint ï¬xes a measure such that Âµ({âˆ—}) = Dâˆ’1/2 and
Âµ([D]) =
âˆš
D. With respect to this measure, we have demonstrated simple rewrite rules which are sound
for this interpretation. Continued work on these calculi (either as separate calculi or a uniï¬ed calculus) is
necessary to demonstrate completeness, ideally while retaining the features which promise to make these
interpretations of the calculi easy to use.
In addition to the use of discrete integrals, we have made one other signiï¬cant and unusual choice of
representation: to index the standard basis by [D] = (âˆ’1
2D, 1
2D] rather than {0, 1, . . . , Dâˆ’1}. Many of the
results in our work (in particular: all those to do with the stabiliser fragment of ZX, and multicharacter
boxes in ZH) will hold equally well with either set of labels for the standard basis. In particular, both
are equally adequate for representing what results might rest on interpreting arithmetic on the labels as
taking place in the ring ZD, for those expressions which are well-deï¬ned modulo D. Our choice of labels
is motivated by certain elegant features of the special case D = 2, concerning an involution Â¬ : [D] â†’[D]
given by Â¬x = Ïƒâˆ’x. Our notational choice is then motivated by imposing the constraint that [D] = {0, 1}
for D = 2, and then requiring Ïƒ to be as small and simply expressed as possible for all D > 1 subject to
16

that constraint. For [D] = (âˆ’1
2D, 1
2D], this yields the involutions Â¬x = 1 âˆ’x for D even and Â¬x = âˆ’x
for D odd. We look forward to feedback on this choice of convention, and are interested in whether there
would be any comparable notational conveniences to selecting the labels {0, 1, . . . , Dâˆ’1} instead.16
We note that both in our choice of involution Â¬ : [D] â†’[D] and in the stabiliser fragment of ZX,
there is a signiï¬cant distinction between the cases of D even and D odd. In particular: in the stabiliser
fragment of ZX, we are concerned with phases which are powers of Ï„ = eÏ€i(D2+1)/D, but for D even
this is a 2Dth root of unity, while for D odd it is a Dth root of unity. It is remarkable that, despite
this distinction, the semantics which one obtains for nodes such as [a ; b]
should be consistent for all
dimensions D > 1, in that (a) it denotes a complex phase whenever b is a multiplicative unit modulo D,
(b) it denotes the scalar
âˆš
D = Âµ([D]) for a = b = 0, and (c) more generally, the magnitude of the scalar
that it denotes is either 0 or
âˆš
t for t = gcd(b, D). It should be noted that there will be other respects
in which the case of D even will be signiï¬cantly more complicated than D odd: see Ref. [50] for more
details. However, as our work manages to present a simple and unifying presentation for the stabiliser
fragment of ZX over all dimensions D > 1, perhaps these can be managed so long as one remains mindful
of the other major distinction, of whether D is prime or composite.
We conclude with a highly speculative thought regarding discrete measures. A signiï¬cant constraint
which we imposed on the measure Âµ on [D] â€” interpreted as a measure on ZD â€” was that the Fourier
transform should be interpretable as an involution C(ZD,Âµ) â†’C(ZD,Âµ) on functions on the measure space
(ZD, Âµ), rather than a bijection C(ZD,Âµ) â†’C(ZD,Âµâ€²) between functions on distinct measure spaces (ZD, Âµ)
and (ZD, Âµâ€²). This may seem like a necessary but technical step; from the perspective of conventional
presentations of ZX diagrams, it is necessary, if all of the wires are to have the same type. However,
it is noteworthy that many quantum algorithms have a structure similar to Fourier sampling, in which
some classical operation (with a distinguished control register) is made to act on some state which is in
not in the standard basis, but rather in a superposition (often through the involvement of the Fourier
transform), after which the amplitudes of the diï¬€erent components are made to interfere (often through
the involvement of the inverse Fourier transform). In this respect, many quantum algorithms have a
structure which suggest the possibility of changes in the datatype associated with a physical qubit at
diï¬€erent stages of the algorithm. Could it be that it would be more appropriate on the logical level, to
have multiple types of qubit â€” a â€˜standardâ€™ type and a â€˜Fourierâ€™ type, possibly among others â€” than
to have just a single type of logical qubit? It would be interesting to consider what insights into the
structure of quantum algorithms might arise, by considering multiple types of qubit or quantum register
apart from distinctions of dimension and resister size, and contrasting the roles in which they play in
existing quantum algorithms. Should such a program prove to be non-trivial, it is conceivable that this
could give rise to new insights into structured quantum programming.
Acknowledgements
NdB would like to thank Patrick Roy, Titouan Carette, John van de Wetering, and Robert Booth for
helpful technical discussions.
References
[1] B. Coecke and R. Duncan.
Interacting quantum observables:
categorical algebra and diagrammatics.
New. J. Phys 13 (043016), 2011. DOI: 10.1088/1367-2630/13/4/043016; See also [arXiv:0906.4725].
[2] R. Duncan and S. Perdrix. Graph States and the Necessity of Euler Decomposition. Mathematical The-
ory and Computational Practice (pp. 167â€“177), 2009.
DOI: 10.1007/978-3-642-03073-4__18;
See also
[arXiv:0902.0500].
[3] M. Backens. Making the stabilizer ZX-calculus complete for scalars. Electronic Proceedings in Theoretical
Computer Science 195 (pp. 17â€“32), 2015. [arXiv:1507.03854]
[4] S. Perdrix and Q. Wang.
Supplementarity is Necessary for Quantum Diagram Reasoning.
Proceedings
of 41st International Symposium on Mathematical Foundations of Computer Science (76:1â€“76:14), 2016.
DOI: 0.4230/LIPIcs.MFCS.2016.76; see also [arXiv:1506.03055].
[5] M. Backens, S. Perdrix, and Q. Wang.
A Simpliï¬ed Stabilizer ZX-calculus.
Electronic Proceedings in
Theoretical Computer Science 236 (pp. 1â€“20), 2017. DOI: 10.4204/EPTCS.236.1; See also [arXiv:1602.04744],
16The simpliï¬cation of the normal form that would be made possible is worth noting, but we would suggest that this
beneï¬t should be assigned an importance based on how often a practitioner might expect to compute a normal form.
17

[6] E. Jeandel, S. Perdrix, R. Vilmart, and Q. Wang. ZX-Calculus: Cyclotomic Supplementarity and Incom-
pleteness for Cliï¬€ord+T Quantum Mechanics. Proceedings of 42nd International Symposium on Mathemat-
ical Foundations of Computer Science (11:1â€“11:13), 2017. DOI: 10.4230/LIPIcs.MFCS.2017.11; See also
[arXiv:1702.01945].
[7] B. Coecke and A. Kissinger. Picturing Quantum Processes: A First Course in Quantum Theory and Dia-
grammatic Reasoning. Cambridge University Press, 2017. DOI: 10.1017/9781316219317.
[8] X. Gong and Q. Wang. Equivalence of Local Complementation and Euler Decomposition in the Qutrit ZX-
calculus. [arXiv:1704.05955], 2017.
[9] K. F. Ng and Q. Wang. A universal completion of the ZX-calculus. [arXiv:1706.09877], 2017.
[10] E. Jeandel, S. Perdrix, and R. Vilmart.
A Complete Axiomatisation of the ZX-Calculus for Cliï¬€ord+T
Quantum Mechanics. 33rd Annual ACM/IEEE Symposium on Logic in Computer Science (pp. 559â€“568),
2018. DOI: 10.1145/3209108.3209131; See also [arXiv:1705.11151], 2017.
[11] K. F. Ng and Q. Wang. Completeness of the ZX-calculus for Pure Qubit Cliï¬€ord+T Quantum Mechanics.
[arXiv:1801.07993], 2018.
[12] Q. Wang. Qutrit ZX-calculus is Complete for Stabilizer Quantum Mechanics. Electronic Proceedings in The-
oretical Computer Science 266 (pp. 58â€“70), 2018. DOI: 10.4204/EPTCS.266.3; See also [arXiv:1803.00696].
[13] B. Coecke and Q. Wang. ZX-rules for 2-qubit Cliï¬€ord+T quantum circuits. Lecture Notes in Computer
Science 11106 (pp. 144â€“161), 2018. DOI: 10.1007/978-3-319-99498-7_10; See also [arXiv:1804.05356].
[14] R. Vilmart.
A Near-Minimal Axiomatisation of ZX-Calculus for Pure Qubit Quantum Mechan-
ics.
34th
Annual
ACM/IEEE
Symposium
on
Logic
in
Computer
Science
(pp.
1â€“10),
2019.
DOI: 10.1109/LICS.2019.8785765; See also [arXiv:1812.09114],
[15] R. Vilmart. A ZX-Calculus with Triangles for Toï¬€oli-Hadamard, Cliï¬€ord+T, and Beyond. Electronic Pro-
ceedings in Theoretical Computer Science 287 (pp. 313â€“344), 2019. DOI: 10.4204/EPTCS.287.18; See also
[arXiv:1804.03084],
[16] E. Jeandel, S. Perdrix, and R. Vilmart. Completeness of the ZX-Calculus. [arXiv:1903.06035], 2019.
[17] Q. Wang. An algebraic axiomatisation of ZX-calculus. [arXiv:1911.06752], 2019.
[18] Q.
Wang.
ZX-calculus
over
arbitrary
commutative
rings
and
semirings
(extended
abstract).
[arXiv:1912.01003], 2019.
[19] N. de Beaudrap. Well-tempered ZX and ZH calculi. Electronic Proceedings in Theoretical Computer Sci-
ence 340 (pp. 13â€“45), 2021. DOI: 10.4204/EPTCS.340.2; See also [arXiv:2006.02557].
[20] Q. Wang.
Algebraic complete axiomatisation of ZX-calculus with a normal form via elementary matrix
operations. [arXiv:2007.13739], 2020.
[21] J. van de Wetering. ZX-calculus for the working quantum computer scientist. [2012.13966], 2020.
[22] A. Toumi, R. Yeung, and G. de Felice. Diagrammatic Diï¬€erentiation for Quantum Machine Learning. Elec-
tronic Proceedings in Theoretical Computer Science 343 (pp. 132â€“144), 2021. DOI: 10.4204/EPTCS.343.7;
See also [arXiv:2103.07960].
[23] Q. Wang. Quï¬nite ZX-calculus: a uniï¬ed framework of qudit ZX-calculi. [arXiv:2104.06429], 2021.
[24] Q. Wang, R. Yeung, and M. Koch. Diï¬€erentiating and Integrating ZX Diagrams. [arXiv:2201.13250], 2022.
[25] E.
Jeandel,
S.
Perdrix,
and
M.
Veshchezerova.
Addition
and
Diï¬€erentiation
of
ZX-diagrams.
[arXiv:2202.11386], 2022.
[26] T.
Stollenwerk
and
S.
Hadï¬eld.
Diagrammatic
Analysis
for
Parameterized
Quantum
Circuits.
[arXiv:2204.01307], 2022.
[27] R. I. Booth and T. Carette. Complete ZX-Calculi for the Stabiliser Fragment in Odd Prime Dimensions.
47th International Symposium on Mathematical Foundations of Computer Science (pp. 24:1â€“24:15), 2022.
DOI: 10.4230/LIPIcs.MFCS.2022.24; See also [arXiv:2204.12531].
[28] J. van de Wetering and L. Yeh. Phase gadget compilation for diagonal qutrit gates. [arXiv:2204.13681], 2022.
[29] S. Majid.
Quantum and braided ZX calculus.
J. Phys. A: Math. Theor. 55 (254007),
2022.
DOI: 10.1088/1751-8121/ac631f; See also [arXiv:2103.07264].
[30] M. Backens and A. Kissinger. ZH: A Complete Graphical Calculus for Quantum Computations Involving
Classical Non-linearity.
Electronic Proceedings in Theoretical Computer Science 287 (pp. 23â€“42), 2019.
DOI: 10.4204/EPTCS.287.2; See also [arXiv:1805.02175].
[31] J. van de Wetering and S. Wolï¬€s. Completeness of the Phase-free ZH-calculus. [arXiv:1904.07545], 2019.
[32] S. Kuijpers, J. van de Wetering, and A. Kissinger.
Graphical Fourier Theory and the Cost of Quantum
Addition. [arXiv:1904.07551], 2019.
18

[33] N. de Beaudrap, A. Kissinger, and K. Meichanetzidis.
Tensor Network Rewriting Strategies for Satis-
ï¬ability and Counting.
Electronic Proceedings in Theoretical Computer Science 340 (pp. 46â€“59), 2021.
DOI: 10.4204/EPTCS.340.3; See also [arXiv:2004.06455].
[34] M. Backens, A. Kissinger, H. Miller-Bakewell, J. van de Wetering, and S. Wolï¬€s.
Completeness of the
ZH-calculus. [arXiv:2103.06610], 2021.
[35] P. Roy. Qudit ZH-calculus. MSc. Thesis, University of Oxford.
Available at https://www.cs.ox.ac.uk/people/aleks.kissinger/theses/roy-thesis.pdf
(accessed 27 February 2023).
[36] R. D. P. East, J. van de Wetering, N. Chancellor, and A. G. Grushin. AKLT-states as ZX-diagrams: diagram-
matic reasoning for quantum states. PRX Quantum 3 (010302), 2022. DOI: 10.1103/PRXQuantum.3.010302;
See also [arXiv:2012.01219].
[37] A. Townsend-Teague and K. Meichanetzidis. Classifying Complexity with the ZX-Calculus: Jones Polyno-
mials and Potts Partition Functions. Accepted submission to QPL 2022. [arXiv:2103.06914], 2021.
[38] R. D. P. East,
P. Martin-Dussaud,
and J. van de Wetering.
Spin-networks in the ZX-calculus.
[arXiv:2111.03114], 2021.
[39] G. de Felice and B. Coecke. Quantum Linear Optics via String Diagrams. Accepted submission to QPL 2022.
[arXiv:2204.12985]
[40] T. Laakkonen, K. Meichanetzidis, and J. van de Wetering. A Graphical #SAT Algorithm for Formulae with
Small Clause Density. [arXiv:2212.08048], 2022.
[41] B. PoÃ³r, Q. Wang, R. A. Shaikh, L. Yeh, R. Yeung, and B. Coecke.
Completeness for arbitrary ï¬nite
dimensions of ZXW-calculus, a unifying calculus, [arXiv:2302.12135], 2023.
[42] P. Roy, J. van de Wetering, L. Yeh. Title to be determined. Submission to QPL 2023, to appear.
[43] B. PoÃ³r, R. I. Booth, T. Carette, J. van de Wetering, L. Yeh. The Qupit Stabiliser ZX-travaganza: Simpliï¬ed
Axioms, Normal Forms and Graph-Theoretic Simpliï¬cation. Submission to QPL 2023, to appear.
[44] Y. Shi. Both Toï¬€oli and Controlled-NOT Need Little Help to Do Universal Quantum Computing. Quantum
Information & Compututation 3 (pp. 84â€“92), 2003. [arXiv:quant-ph/0205115].
[45] D. Aharonov. A Simple Proof that Toï¬€oli and Hadamard are Quantum Universal. [arXiv:quant-ph/0301040],
2003.
[46] T. Carette. Wielding the ZX-calculus, Flexsymmetry, Mixed States, and Scalable Notations. Ph.D. Thesis,
Loria, UniversitÃ© de Lorraine, 2021. https://hal.archives-ouvertes.fr/tel-03468027/document
[47] D. Schlingemann. Cluster States, Algorithms and Graphs. Quantum Info. & Comput. 4 (pp. 287â€“324), 2004.
DOI: 10.5555/2011827.2011831; See also [arXiv:quant-ph/0305170].
[48] A. CÃ³rdoba. Dirac combs. Lett. Math. Phys. 17 (pp. 191â€“196), 1989. DOI: 10.1007/BF00401584
[49] T. Carette and E. Jeandel. A recipe for quantum graphical languages. 47th International Colloquium on
Automata, Languages, and Programming (pp. 118:1â€“118:17), 2020. DOI: 10.4230/LIPIcs.ICALP.2020.118;
See also [arXiv:2008.04193].
[50] N. de Beaudrap. A linearized stabilizer formalism for systems of ï¬nite dimension. Quant. Info. & Comp. 13
(pp. 73â€“115), 2013. DOI: 10.26421/QIC13.1-2-6; See also [arXiv:1102.3354].
[51] T. Carette, D. Horsman, and S. Perdrix. SZX-Calculus: Scalable Graphical Quantum Reasoning. Proceedings
of 44th International Symposium on Mathematical Foundations of Computer Science (55:1â€“55:15), 2019.
DOI: 10.4230/LIPIcs.MFCS.2019.55; See also [arXiv:1905.00041].
[52] T. Carette, Y. Dâ€™Anello, and S. Perdrix. Quantum Algorithms and Oracles with the Scalable ZX-calculus. Elec-
tronic Proceedings in Theoretical Computer Science 343 (pp. 193â€“209), 2021. DOI: 10.4204/EPTCS.343.10;
See also [arXiv:2104.01043].
19

A
Discrete measures on R
A.1
Dirac deltas
When analysing functions on R, it is not uncommon to consider a Dirac distribution Î´ (also known as
the â€˜Dirac deltaâ€™), which is deï¬ned in such a way that for an interval J âŠ†R,
Z
xâˆˆJ
f(x) Î´(x âˆ’a) dx =
(
f(a),
if a âˆˆJ;
0,
otherwise.
(52)
One may conceive of Î´(x) as the limit of a family of formally deï¬nable functions, such as the Gaussians
N1/n(x) =
n
âˆš
2Ï€ eâˆ’(nx)2/2 as n â†’âˆ. In principle, one may consider it as syntactic sugar for a measure
ÂµÎ´ on R, which for any interval J âŠ†R satisï¬es Âµ(J) = 1 if 0 âˆˆJ, and Âµ(J) = 0 otherwise: we call this a
â€˜point-mass distributionâ€™. We may write Î´a(x) = Î´(xâˆ’a) for any a âˆˆR, so that Î´a describes a point-mass
distribution at a âˆˆR: that is, a measure Âµa such that Âµa(S) = 1 if a âˆˆS, and Âµa(S) = 0 otherwise.
(More generally, a point-mass distribution is any distribution of the form paÎ´a for pa Ì¸= 0: the â€˜massâ€™
of such a distribution is then pa.) The purpose of the Dirac distributions would then be to allow us to
write
R
J f(x) Î´a(x) dx =
R
J f(x) Î´(xâˆ’a) dx in place of
R
J f(x+a) dÂµa . This provides a notational bridge
between the discrete measures Âµa and the more common (Lebesgue) measure, so that we may perform
analysis as though consistently working with a single variety of integration.
A.2
Impulses and Dirac combs
A discrete measure Ï on R is a measure which is a linear combination of a countable (and possibly ï¬nite)
number of such point-mass distributions. While such measures are not real-valued functions on R, we
may say that Ï(a) Ì¸= 0 if for any function f : R â†’C, we have
R
(aâˆ’Îµ,a+Îµ) f(x) Ï(x) dx âˆ’â†’paf(a) for some
pa Ì¸= 0, as Îµ â†’0. We may refer to the contributions of the point-mass distributions as â€˜impulsesâ€™: for a
discrete measure Ï, we say that Ï has an impluse at a if Ï(a) Ì¸= 0 in this sense.
We deï¬ne the Dirac comb X (see, e.g., Ref. [48]) as a discrete distribution, consisting of a sequence
of a sum of unit point-mass distributions on Z:
X(x) =
X
tâˆˆZ
Î´t(x) .
(53)
The Dirac comb is its own Fourier transform, which allows us to also express it as:
X(x) =
X
kâˆˆZ
e2Ï€ikx =
X
kâˆˆZ
eâˆ’2Ï€ikx.
(54)
We may use the Dirac comb to express any function Ï† : Z â†’C as a complex linear combination of
impulses at the integers: if we let Ï†â€² : R â†’C be any extension of Ï† to the real numbers, we may deï¬ne
the complex-valued discrete â€˜distributionâ€™ IÏ† on R, by
IÏ†(x) = X(x) Ï†â€²(x) =
X
tâˆˆZ
Î´t(x) Ï†(t),
(55)
This will allow us to express sums on integers, in terms of integrals over R: for instance, for any integers
a < b, we then have
Z
(a,b]
IÏ†(x) dx =
X
a<tâ©½b
Ï†(t);
(56)
in particular, we have
R
(a,b] X(x) dx = bâˆ’a, which is the number of integers in the interval (a, b]. Finally,
we may consider normalised versions of the Dirac comb with impulses at integer multiples of any interval
length â„“> 0:
Xâ„“(x) = â„“
X
tâˆˆZ
Î´â„“t(x) = â„“
X
tâˆˆZ
Î´(x âˆ’â„“t) = â„“
X
kâˆˆZ
e2Ï€ikx/â„“.
(57)
The leading scalar factor of â„“in these sums, ensures that for a < b which are integer multiples of â„“,
we again have
R
(a,b] X(x) dx = b âˆ’a. We may then use this to deï¬ne a generalisation of I, to embed
functions Ï† : Z â†’C as complex-valued measures in R, but with impulses at intervals of â„“> 0: for Ï†â€²
again any extension of Ï† to R, we deï¬ne
Iâ„“Ï†(x) = Xâ„“(x) Ï†â€²( 1
â„“x) =
X
tâˆˆZ
Î´â„“t(x) Ï†(t).
(58)
20

B
Relationship between Âµ and the Fourier transform
In Section 3.2, we described the way in which the measure Âµ on ZD (induced from the measure on [D]
deï¬ned in Section 3.1) is constrained by various constraints on the discrete Fourier transform, construed
as a map f 7â†’Ë†f on functions f : ZD â†’C. In particular, if we consider ZD as a measure space and take
f : (ZD, Âµ) â†’C and Ë†f : (ZD, Âµ) â†’C to have the same domain considered as measure spaces, and if
we also take F : |fâŸ©âŸ©7â†’| Ë†fâŸ©âŸ©as deï¬ned in Eqn. (25) to be unitary, we ï¬nd that N = Âµ(ZD) =
âˆš
D (or
equivalently, Î½ = âŸ¨âŸ¨x|xâŸ©âŸ©âˆ’1/2 = Dâˆ’1/4).
If one wished instead to have a more general relation N = Î»D for some scalar Î» Ì¸= Dâˆ’1/2, one could
instead consider
â€¢ setting F â€ F = Î±1 for a scalar Î± > 0, which is equal to 1 if and only if F is unitary;
â€¢ Deï¬ning Ë†f to range over the space (ZD, Âµâ€²) for a measure Âµâ€² = Î²Âµ for some scalar Î² > 0;
â€¢ Deï¬ning the Fourier transform Ë†f of f by modifying Eqn. (21) to incorporate an additional scalar
factor Î³ > 0 which may diï¬€er from 1.
We consider the consequences of all three such modiï¬cations. Let X{0} : ZD â†’C be the function such
that X{0}(t) = 1 if and only if t = 0, and X{0}(t) = 0 otherwise; then
X{0}

=
Z
xâˆˆ(ZD,Âµ)
X{0}(x) |xâŸ©âŸ©= Î½2|0âŸ©âŸ©= Î½ |0âŸ©,
(59)
from which it follows that
bX{0}(k) = Î³
Z
xâˆˆ(ZD,Âµ)
X{0}(x) eâˆ’2Ï€ikx/D = Î³Î½2.
(60)
Let J : ZD â†’C be the constant function J(x) = 1: then J =
1
Î³Î½2 bX{0}. For the sake of uniformity, deï¬ne
point-mass functions |kâŸ©âŸ©to accompany the integrals over k âˆˆ(ZD, Âµâ€²) for Âµâ€² = Î²Âµ, so that
Z
kâˆˆ(ZD,Âµâ€²)
âŸ¨âŸ¨k|kâŸ©âŸ©dÂµâ€²(k) = 1.
(61)
Using the fact that Î½2 = Âµ({âˆ—}) = N/D, we then have
N = Âµ(ZD) =
Z
xâˆˆ(ZD,Âµ)
1 dÂµ(x) = Î²
Z
kâˆˆ(ZD,Âµâ€²)
1 dÂµâ€²(k) = Î²
ZZ
h,kâˆˆ(ZD,Âµâ€²)
J(h)âˆ—J(k) âŸ¨âŸ¨h|kâŸ©âŸ©dÂµâ€²(h) dÂµâ€²(k)
= Î² âŸ¨âŸ¨J|JâŸ©âŸ©=
Î²
Î³2Î½4


 bX{0}
 bX{0}

=
Î²
Î³2Î½4


X{0}
F â€ F
X{0}

=
Î±Î²
Î³2Î½4


X{0}
X{0}

=
Î±Î²
Î³2Î½2 = Î±Î²D
Î³2N ,
(62)
so that
N =
âˆšÎ±Î²D
Î³
.
(63)
Thus, we may vary any three of Î±, Î², Î³, and N to determine the remaining parameter.
If one wished to ï¬x a diï¬€erent value for N (e.g., N = 1 or N = D), and separately ï¬x the extent to
which F increases or decreases the â„“2 norm of its operands (if one wished to adopt a convention where F
might not be a unitary matrix), this would determine the extent to which the diï¬€erence in the norm of Ë†f
corresponds to a change of units Âµ to Âµâ€² as we transform f 7â†’Ë†f, or to which Eqn. (21) must be rescaled,
or both. Instead, we elect to ï¬x Î±, Î², Î³ = 1, which allows us to take Eqn. (21) unmodiï¬ed, to consider
only one measure Âµ on ZD in the context of the Fourier transform, and to take F to be unitary. This
imposes the constraint N =
âˆš
D, or equivalently Î½ = Dâˆ’1/4.
While these remarks stand apart from any analysis over R, it is possible to show how relating the
measure Âµ on ZD to a discrete measure on the compact continuous group RN further motivates distinct
measures Âµ, Âµâ€² for the domains of f : (ZD, Âµ) â†’C and that of Ë†f : (ZD, Âµâ€²) â†’C, if one ï¬xes N to be
diï¬€erent from
âˆš
D. See Appendix C.4 for more details.
21

C
Motivating measures for ZD via continuous groups
The analysis of Section 3, on measures on ZD and constraints on them motivated by the Fourier transform,
stands on its own in principle. However, the reader may be interested in certain observations of how
consistent this is with Fourier analysis on R, or whether our observations of measure could be motivated
with reference to continuous cyclic groups.
We discuss how this may be done below, by considering how we may model functions f : ZD â†’C in
terms of complex-valued discrete distributions with period N. This will require some further preliminaries,
in particular on the subject of discrete distributions on R.
C.1
Elementary number theory and periodic functions on Z
We begin with some supplemental background, providing a ring-theoretic framework in which to describe
arithmetic modulo D, using this as a framework to consider periodic functions f : Z â†’C.
In this article, ZD denotes the ring of the integers modulo D. These are often be represented by
integers drawn from the set of integers 0 â©½x < D, though we will often prefer to represent them by
the set of integers [D] := (âˆ’1
2D, 1
2D] âˆ©Z. More properly speaking, ZD is a set of equivalence classes of
integers which diï¬€er by multiples of D,
x + DZ =

x + nD
 n âˆˆZ
	
,
(64)
equipped with addition (x+DZ) + (y+DZ) = (x+y) + DZ and multiplication (x+DZ)Â·(y+DZ) =
(xy) + DZ. The representatives 0 â©½x < D or âˆ’1
2D < x â©½1
2D described above then serve as short-hand
for the corresponding equivalence class x + DZ. We may occasionally conï¬‚ate ZD with such sets of
representatives.
There is a ring homomorphism Ï€D : Z â†’ZD (the â€˜canonical projectionâ€™) which may be deï¬ned
by Ï€D(x) = x + DZ. We may use this to deï¬ne a transformation L on functions, which carries maps
f : ZD â†’C to periodic functions Lf : Z â†’C, given by Lf = f â—¦Ï€D. Then L â€˜liftsâ€™ functions f : ZD â†’C
to functions Lf, which are â€˜well-deï¬nedâ€™ modulo D in the sense that Lf(x) = Lf(x + nD) for any n âˆˆZ.
By an abuse of notation, for any integer x âˆˆ[D], we may write Lf(x) = f(x).
C.2
Constructing continuous cyclic groups from R
In order to consider Fourier analysis over ZD in terms of discrete integrals, in which the measure N =
Âµ(ZD) may be a parameter which we do not assign a value in advance, it will be helpful to relate functions
f : Z â†’C with period D, to functions g : R â†’C with period N. We use this to consider a measure on
ZD in terms of a measure on a compact continuous group.
We deï¬ne an additive group of real numbers modulo N, for any N > 1, consisting of equivalence
classes of real numbers which diï¬€er by multiples of N:
z + NZ =

z + tN
 t âˆˆZ
	
,
(65)
equipped with addition (y+NZ) + (z +NZ) = (y+z) + NZ. Just as we may represent ZD by represen-
tative integers x âˆˆ[D] = (âˆ’1
2D, 1
2D] âˆ©Z, we adopt the convention of representing RN by an interval
JN = (âˆ’1
2N, 1
2N] of representatives. We may then think of RN in terms of the interval JN, with â€˜wrap-
aroundâ€™ boundary conditions for addition and subtraction when the result of normal addition over R
yields a result which lies outside of JN. Note that we may regard RN as a topological group, and one
with a measure ÂµN inherited from the real numbers, consisting of the restriction of the Lebesgue measure
to the interval JN: in particular, we have ÂµN(RN) = N.
Finally, for a ï¬xed integer D > 1, note that we may deï¬ne an injection jN : ZD â†’RN from the
additive group ZD to the group RN, by simply taking
jN
 x + DZ

=
N
D
 x + DZ

=
N
D x + NZ
(66)
for x âˆˆZ; we may abuse notation to describe this more concisely by writing jN(x) = N
D x for x âˆˆZD.
C.3
Interpretation of measures on ZD in terms of measures on R
To consider a notion of measure for ZD in terms of a continuous group, we may consider the injection
jN : ZD â†’RN for some N > 0. This motivates considering how we may represent functions f : ZD â†’C
in terms of â€˜complex valued discrete measuresâ€™ Ï† : RN â†’C, which we may integrate over RN to assign a
meaning to an integral of f over ZD.
22

We do this by considering the related concept of periodic functions on Z, and their representation
by periodic discrete measures on R. Following Section C.1, we may â€˜liftâ€™ any f : ZD â†’C to a periodic
function Lf : Z â†’C with period D. We may then represent Lf as a complex-valued discrete distribution,
with impulses at invervals of length â„“= N/D, by acting on it with the transform Iâ„“= IN/D as deï¬ned in
Eqn. (58). Deï¬ne the composite operator EN = IN/D L, so that
ENf(z) = â„“
X
tâˆˆZ
Î´tâ„“(z) Lf(t) = N
D
X
tâˆˆZ
Î´tN/D(z) Lf(t).
(67)
In particular, representing elements of ZD by x âˆˆ[D], the values of f : ZD â†’C at each x is represented
by an impulse at N
D x âˆˆ(âˆ’1
2N, 1
2N] = JN, and also at N
D (x + tD) = N
D x + tN for each integer t âˆˆZ.
Then ENf is a discrete distribution with period N, which can be characterised in terms of its behaviour
on the interval JN. In particular,
Z
JN
dz ENf(z) = N
D
Z
RN
dz
X
tâˆˆZ
Î´tâ„“(z) Lf(t) = N
D
X
tâˆˆ[D]
Lf(t) = N
D
X
tâˆˆZD
f(t) =
Z
xâˆˆZD
f(x) dÂµ(x) .
(68)
The fact that Âµ(ZD) = N then reï¬‚ects the choice of the period N (or equivalently: the modulus N) for
the injection jN : ZD â†’RN, and that as a discretisation of the measure ÂµN on RN (derived from the
Lebesgue measure), we have Âµ(ZD) = ÂµN(RN) = N. In some sense, one may regard the injection jN
as describing a way that ZD represents a discretisation of the continuous group RN, by condensing the
usual measure of RN at a discrete set of points at intervals of N
D .
C.4
The connection between the Fourier transform and measures on ZD
The discussion of normalisation in Appendix B can be interpreted, as arising from how the Fourier
transform on R aï¬€ects the discrete measures ENf arising from functions f : ZD â†’C. In particular:
the Fourier transform will generally transform such distributions, to other distributions which may be
regarded as being deï¬ned with respect to a diï¬€erent measure. Consider the Fourier transform [
ENf:
[
ENf(y) =
Z
R
dz ENf(z) eâˆ’2Ï€iyz :
(69)
substituting in the expression for bfN in Eqn. (67), we obtain
[
ENf(y) = N
D
Z
R
dz
X
tâˆˆZ
Î´tN/D(z) Lf(t) eâˆ’2Ï€iyz = N
D
X
tâˆˆZ
Lf(t) eâˆ’2Ï€iy(tN/D) .
(70)
Separating the summation index t âˆˆZ into representatives of ZD and shifts by an entire period, we may
then write
[
ENf(y) = N
D
X X
xâˆˆ[D],Ï„âˆˆZ
Lf(x) eâˆ’2Ï€iyN(x+Ï„D)/D = N
D
X
xâˆˆZD
f(x) eâˆ’2Ï€iyNx/D
 X
Ï„âˆˆZ
eâˆ’2Ï€iÏ„yN

,
(71)
factorising away the dependence on Ï„ in square brackets. By Eqn. (57), that bracketed expression is in
fact
1
N XN(y): rewriting this as a sum of impulses, we then have
[
ENf(y) = N
D
X
xâˆˆZD
f(x) eâˆ’2Ï€iyNx/D
 1
N
X
kâˆˆZ
Î´k/N(y)

=
1
D
X X
xâˆˆZD,kâˆˆZ
Î´k/N(y) f(x) eâˆ’2Ï€ikx/D .
(72)
That is, [
ENf is itself a complex discrete measure, which is zero for any y which is not an integer multiple of
1
N . By construction, it repeats after every D impulses, and so has a period of D/N. Then [
ENf = ED/Ng
for a function g : ZD â†’C,
ED/Ng(y) =
1
N
X
kâˆˆZ
Î´k/N(y) Lg(k),
(73)
which we can see holds for
g(k) = N
D
X
xâˆˆZD
f(x) eâˆ’2Ï€ikx/D = Ë†f(k),
(74)
23

for Ë†f as deï¬ned by Eqn. (21), with the integral over ZD explicitly expanded as a sum using Eqn. (16)
and using the measure Âµ such that Âµ(ZD) = N.
This demonstrates that [
ENf = ED/N Ë†f , subject to this representation of the Fourier transform over R.
However, ED/N Ë†f is a complex-valued discrete measure which has period D/N, and where in particular
a representative interval would be JD/N. This suggests that Ë†f should be interpreted in terms of the
group injection jD/N : ZD â†’RD/N , which would motivate a measure Âµâ€² on ZD such that Âµâ€²(ZD) =
ÂµD/N(RD/N) = D/N.
In summary: if we take f : (ZD, Âµ) â†’C as a function on the measure space (ZD, Âµ) with Âµ(ZD) = N,
we eï¬€ectively interpret f in terms of a measure on the topological space RN, which has a total measure
of N. The Fourier transform Ë†f is then most appropriately regarded as a measure on the topological space
RD/N, which has a total measure of D/N, so that Ë†f : (ZD, Âµâ€²) â†’C, where Âµâ€²(ZD) = D/N. If we wish
for Âµ = Âµâ€², so that f and Ë†f have the same domain when we consider ZD as a measure space, we must
take N =
âˆš
D, in agreement with the results of Section 3.2.
24

D
Quadratic Gaussian integrals
In this Section, we consider how to evaluate the quadratic Gauss integrals described in Eqn. (30).
D.1
Preliminaries on quadratic Gaussian sums
The scalars in Eqn. (30) may be expressed in terms of quadratic Gaussian sums, which are sums of the
form
G(r, s, N) =
Nâˆ’1
X
x=0
e2Ï€i(rx2+sx)/N =
Nâˆ’1
X
x=0
Ï‰rx2+sx
N
(75)
where Ï‰N = exp(2Ï€i/N) is a primitive N th root of unity. Motivated by the analysis of Ref. [50], we
consider two separate cases: the case where N is odd, and the case where N is a multiple of 4. (The case
where N is even but not a multiple of 4 does not arise in our work, as we consider N = D for D odd,
and N = 2D for D even, where D > 1 is the dimension of a qudit.)
We deï¬ne the Jacobi symbol
  k
m

for m and odd integer and k âˆˆZ, as follows. Let Ï‡p be the quadratic
character on Zp :
Ï‡p(k) =
ï£±
ï£´
ï£²
ï£´
ï£³
0,
if p divides k;
+1,
if k â‰¡u2
(mod p) for some u âˆˆ[p];
âˆ’1,
otherwise.
(76)
For m = pt1
1 pt2
2 Â· Â· Â· ptn
n an odd integer with pj distinct primes and t1 âˆˆN, we deï¬ne the Jacobi symbol as
 h
m

= Ï‡p1(k)t1 Ï‡p2(k)t2 Â· Â· Â· Ï‡pn(k)tn ,
(77)
which is 0 is k and m have any common prime factors pj, and is Â±1 otherwise. For odd integers r, we
also deï¬ne
Îµm =
(
1,
if m â‰¡1
(mod 4)
i,
if m â‰¡3
(mod 4)
)
= i(mâˆ’1)2/4,
(78)
which satisï¬es Îµ2
m = Ï‡m(âˆ’1). Suppose that r and N have a common divisor other than 1. Let t =
gcd(r, N). It is possible to show that
G(r, s, N) =
ï£±
ï£²
ï£³
t Â· G
r
t , s
t , N
t

,
if t is a divisor of s;
0,
otherwise.
(79)
We can then reduce the general case, to the special case where r and N have no common divisor t > 1,
and where r â©¾0. Suppose, then, that r and N have no common divisor t > 1, so that r has an inverse
u âˆˆ[N] modulo N (i.e., ur â‰¡1 mod N), and N has an inverse q âˆˆ[r] modulo r (i.e., qN â‰¡q mod r).
â€¢ If N is odd, let h âˆˆ[D] be such that 2h â‰¡1 (mod N), and let Ëœs = uhs so that 2rËœs â‰¡s (mod N).
We then have
G(r, s, N) =
Nâˆ’1
X
x=0
Ï‰r(xâˆ’Ëœs)2+s(xâˆ’Ëœs)
N
=
Nâˆ’1
X
x=0
Ï‰r(x2âˆ’2Ëœsx+Ëœs2)+sxâˆ’sËœs
N
=
Nâˆ’1
X
x=0
Ï‰rx2+ru2h2s2 âˆ’uhs2
N
= Ï‰ru2(hâˆ’h2)s2
N
Â· G(r, 0, N).
(80)
For N odd and r having no factors in common with N greater than 1,
G(r, 0, N) = ÎµN
 r
N
âˆš
N
(81)
where
  r
N

is the Jacobi symbol. Then we have
G(r, s, N)
=
Ï‰ru2(hâˆ’h2)s2
N
ÎµN
 r
N
âˆš
N
=
e2Ï€iru2(hâˆ’h2)s2/N i(Nâˆ’1)2/4  r
N
âˆš
N
(82)
In particular, we have
G(r, s, N)
 =
âˆš
N, and for s = 0 we have G(r, s, N) = ikâˆš
N for some k âˆˆZ.
25

â€¢ Suppose that N is even (in which case r must be odd as it would not be divisible by 2) Let N = 2M
for some integer M. We may consider the alternative sum
ËœG(r, s, M) =
Mâˆ’1
X
x=0
eÏ€i(rx2+sx)/M,
(83)
which we may relate to G(r, s, N) as follows:
G(r, s, 2M) =
Mâˆ’1
X
x=0
e2Ï€i(rx2+sx)/2M +
2Mâˆ’1
X
x=M
e2Ï€i(rx2+sx)/2M
=
Mâˆ’1
X
x=0
h
eÏ€i(rx2+sx)/M + eÏ€i
 r(M 2+2Mx+x2)+s(M+x)

/Mi
=
Mâˆ’1
X
x=0
h
eÏ€i(rx2+sx)/M + eÏ€i(Mr+s) eÏ€i(rx2+sx)/Mi
=

1 + (âˆ’1)Mr+s
ËœG(r, s, M) .
(84)
If M is odd and s is even, then we have (âˆ’1)Mr+s = âˆ’1, in which case G(r, s, N) = 0; similarly if
M is even and s is odd. Thus it suï¬ƒces to consider the cases where M and s are either both even,
or both odd, so that Mr + s is even.
(a) If M, s are both odd, let g âˆˆZ be such that 2g = u(M âˆ’s), where recall u â‰¡râˆ’1 (mod 2M).
G(r, s, 2M) =
2Mâˆ’1
X
x=0
e2Ï€i(rx2+sx)/2M =
2Mâˆ’1
X
x=0
e2Ï€i(r(x+g)2+s(x+g)/2M
=
2Mâˆ’1
X
x=0
e2Ï€i(rx2+2grx+rg2+sx+sg)/2M = eÏ€i(rg2+sg)/M
2Mâˆ’1
X
x=0
(âˆ’1)x eÏ€irx2/M
= eÏ€i(rg2+sg)/M
Mâˆ’1
X
x=0

(âˆ’1)xeÏ€irx2/M + (âˆ’1)x eÏ€ir(M+x)2/M
= eÏ€i(rg2+sg)/M
Mâˆ’1
X
x=0

(âˆ’1)xeÏ€irx2/M âˆ’(âˆ’1)xeÏ€irx2/M
= 0 .
(85)
Together with the fact that G(r, s, N) = 0 for M odd and s even, we have in fact G(r, s, N) = 0
if N = 2M for M âˆˆZ odd.
(b) If M, s are both even, let M â€², sâ€² âˆˆZ be such that M = 2M â€² and s = 2sâ€². Let Ï‚ = +1 if r > 0
and Ï‚ = âˆ’1 if r < 0. We may show that
ËœG(r, s, M) =
Mâˆ’1
X
x=0
eÏ€i(rx2+sx)/M
=
p
|Mrâˆ’1| eÏ€i
 |Mr|âˆ’s2
4Mr
|r|âˆ’1
X
k=0
eâˆ’Ï€i(Mk2+sk)/r
=
p
|Mrâˆ’1| eÏ‚iÏ€/4 eâˆ’iÏ€s2/4Mr
|r|âˆ’1
X
k=0
eâˆ’Ï‚ iÏ€(Mk2+sk)

|r|
=
p
|Mrâˆ’1| eÏ‚iÏ€/4 eâˆ’iÏ€s2/4Mr ËœG(âˆ’Ï‚M, âˆ’Ï‚s, |r|),
(86)
by quadratic reciprocity. By Eqn. (84), we have
G
 âˆ’Ï‚M, âˆ’Ï‚s, |r|

=

1 + (âˆ’1)Mr+s
ËœG
 âˆ’Ï‚M, âˆ’Ï‚s, |r|

= 2 ËœG
 âˆ’Ï‚M, âˆ’Ï‚s, |r|

= 2 ËœG
 Ï‚M, Ï‚s, |r|
âˆ—.
(87)
Recall that r is odd, and has no common divisors t > 1 with N; it then follows that r has no
such common divisors with M either, and in particular, we have (4q)M â€² = qN â‰¡1 (mod r).
26

Let Î· âˆˆZ be such that Î· â‰¡2âˆ’1 (mod r): we then have
G(r, s, N) = 2 ËœG(r, s, M)
= 2
p
|Mrâˆ’1| eÏ‚iÏ€/4 eâˆ’iÏ€s2/4Mr ËœG
 Ï‚M, Ï‚s, |r|
âˆ—
=
q
1
2|Nrâˆ’1| eÏ‚iÏ€/4 eâˆ’Ï€is2/2Nr G
 Ï‚2M â€², Ï‚2sâ€², 2|r|
âˆ—
=
q
1
2|Nrâˆ’1| eÏ‚iÏ€/4 eâˆ’Ï€is2/2Nr Â· 2 Â· G
 Ï‚M â€², Ï‚sâ€², |r|
âˆ—
=
p
2|Nrâˆ’1| eÏ‚iÏ€/4 eâˆ’Ï‚Ï€is2
2N|r|

e2Ï€iÏ‚M â€²(4q)2(Î·2âˆ’Î·)s2/|r| iâˆ’(|r|âˆ’1)2/4 M â€²
|r|
p
|r|

= eÏ‚iÏ€/4 eâˆ’Ï‚Ï€is2
2N|r| eâˆ’2Ï€iÏ‚qs2/|r| iâˆ’(|r|âˆ’1)2/4  N
|r|

Â·
âˆš
2N
= eiÏ€Ï‚/4 eâˆ’Ï€iÏ‚s2(1+4Nq)

N|r| iâˆ’(|r|âˆ’1)2/4  N
|r|

Â·
âˆš
2N .
(88)
In particular, we have
G(r, s, N)
 =
âˆš
2N, and for s = 0 we have G(r, s, N) =
âˆš
i
kÂ·
âˆš
2N for
some odd integer k âˆˆZ.
In summary, if r and N have no common divisor t > 1, we have:
G(r, s, N) =
ï£±
ï£´
ï£²
ï£´
ï£³
eiÏ•(r,s,N)âˆš
N,
if N is odd;
eiÏ•(r,s,N)âˆš
2N,
if N is a multiple of 4 and s is even,
0,
otherwise,
(89a)
where Ï•(r, s, N) âˆˆR is some phase angle satisfying
eiÏ•(r,s,N) =
ï£±
ï£´
ï£´
ï£´
ï£´
ï£´
ï£²
ï£´
ï£´
ï£´
ï£´
ï£´
ï£³
e2Ï€iru2(hâˆ’h2)s2/N i(Nâˆ’1)2/4  r
N

,
if N is odd
(for u â‰¡râˆ’1 mod N
and h â‰¡2âˆ’1 mod N),
eiÏ€Ï‚/4 eâˆ’Ï€iÏ‚s2(1+4Nq)

N|r| iâˆ’(|r|âˆ’1)2/4  N
|r|

,
if N is even
(for q â‰¡N âˆ’1 mod r),
(89b)
where
  r
N

and
  N
r

are Jacobi symbols as described by Eqn. (77). In particular, note that if s = 0 then
eiÏ•(r,s,N) is a power of eiÏ€/4, and in particular is equal to eiÏ€(N+1)k/4 for some integer k. Using Eqn. (79)
to generalise this to include the case where t = gcd(r, N) may be greater than 1, we then have
G(r, s, N) =
ï£±
ï£´
ï£´
ï£´
ï£²
ï£´
ï£´
ï£´
ï£³
eiÏ•
  r
t , s
t , N
t

Â·
âˆš
tN,
if N/t is odd, and s is a multiple of t;
eiÏ•
  r
t , s
t , N
t

Â·
âˆš
2tN,
if N/t is a multiple of 4, and s is a multiple of 2t;
0,
otherwise,
(90)
using the fact that when G(r, s, N) is non-zero, we have
G(r, s, N)
 = t Â·
G( r
t , s
t , N
t )
, which is equal to
t Â·
p
N/t =
âˆš
tN for N odd and equal to t Â·
p
2N/t =
âˆš
2tN for N even.
D.2
Application to quadratic Gaussian integrals
In our analysis, we consider two sorts of integrals, depending on the parity of the qudit dimension D. In
each case, we are interested in the integral
Î“(a, b, D) =
Z
xâˆˆ[D]
Ï„ 2ax+bx2 = Î½2 X
xâˆˆ[D]
Ï„ 2ax+bx2 ,
where Ï„ = eÏ€i(D2+1)/D and Î½ = Dâˆ’1/4.
(91)
For all integers D > 1, we have Ï„ 2 = eÏ€i(2D2+2)/D = e2Ï€i+2Ï€i/D = e2Ï€i/D. However, for D odd, Ï„ is itself
also a Dth root of unity (speciï¬cally: Ï„ = Ï‰h for h â‰¡2âˆ’1 mod D), whereas for D even we have Ï„ = eÏ€i/D,
which is a primitive 2Dth root of unity.
27

For D an odd integer.
In the case of D odd, we are interested in the quantity
Î“(a, b, D) =
Z
xâˆˆ[D]
Ï„ 2ax+bx2 =
Z
xâˆˆ[D]
e2Ï€ih(2ax+bx2)/D.
(92)
Using the deï¬nition of the integral and the normalisation Î½ = Dâˆ’1/4, we have
Î“(a, b, D) = Î½2
Dâˆ’1
X
x=0
e2Ï€i(2ahx+bhx2)/D =
1
âˆš
DG(bh, a, D).
(93)
If t = gcd(b, D), we may apply Eqn. (90) to obtain
Î“(a, b, D) =
ï£±
ï£´
ï£²
ï£´
ï£³
âˆš
Dt
âˆš
D Â· eiÏ•
  bh
t , a
t , D
t

=
âˆš
t Â· eiÏ•
  bh
t , a
t , D
t

,
if a is also a multiple of t;
0,
otherwise;
(94)
in particular, if t = 1, we have |Î“(a, b, D)| = 1.
For D an even integer.
In the case of D even, we are interested in the quantity
Î“(a, b, D) =
Z
xâˆˆ[D]
Ï„ 2ax+bx2 =
Z
xâˆˆ[D]
eÏ€i(2ax+bx2)/D.
(95)
Again using the deï¬nition of the integral and the normalisation Î½ = Dâˆ’1/4, we have
Î“(a, b, D) = Î½2
Dâˆ’1
X
x=0
eÏ€i(2ax+bx2)/D =
1
âˆš
D ËœG(b, 2a, D) =
1
2
âˆš
DG(b, 2a, 2D),
(96)
where ËœG(b, 2a, D) is as deï¬ned in Eqn. (83). Note that as D is even, 2D is then a multiple of 4. Let
v = gcd(b, 2D): we may again apply Eqn. (90) to obtain
Î“(a, b, D) =
ï£±
ï£´
ï£´
ï£´
ï£´
ï£´
ï£´
ï£´
ï£´
ï£´
ï£²
ï£´
ï£´
ï£´
ï£´
ï£´
ï£´
ï£´
ï£´
ï£´
ï£³
âˆš
4Dv
2
âˆš
D Â· eiÏ•
  b
v , 2a
v , 2D
v

= âˆšv Â· eiÏ•
  b
v , 2a
v , 2D
v

,
if 2D/v is a multiple of 4
and 2a is a multiple of 2v;
âˆš
2Dv
2
âˆš
D Â· eiÏ•
  b
v , 2a
v , 2D
v

=
p
v/2 Â· eiÏ•
  b
v , 2a
v , 2D
v

,
if 2D/v is odd and
2a is a multiple of v;
0 ,
otherwise.
(97)
Again, let t = gcd(b, D). Furthermore, let g, gâ€² be the largest integers such that 2g divides D,and 2gâ€²
divides b. For q = min {g, gâ€²}, this means that 2q is the largest power of 2 which divides t. Let tâ€² = t/2q,
and Dâ€² = D/2gtâ€² and bâ€² = b/2gâ€²tâ€²: then all of tâ€², Dâ€², and bâ€² are odd integers with no common divisors
greater than 1, and D = 2gtâ€²Dâ€² = 2gâˆ’qtDâ€² and b = 2gâ€²tâ€²bâ€² = 2gâ€²âˆ’qtbâ€². Then
v = gcd(b, 2D) = gcd
 2gâ€²tâ€²bâ€², 2g+1tâ€²Dâ€²
= 2 min {g+1,gâ€²} Â· tâ€²
(98)
We may then present the cases in Eqn. (97) as follows.
â€¢ If 2D/v = 2g+1âˆ’min{g+1,gâ€²}Dâ€² is a multiple of 4, then g + 1 âˆ’min{g+1, gâ€²} > 1, from which we may
infer that g+1 âˆ’gâ€² > 1 and that g âˆ’gâ€² > 0. Then q = gâ€² and v = t; and we have D/t even and b/t
odd. Conversely, if D/t is even, this also implies that g âˆ’gâ€² > 0, and that 2D/v is a multiple of 4.
(Notice also that in this case, 2a is a multiple of 2v if and only if a is a multiple of t).
â€¢ If 2D/v = 2g+1âˆ’min{g+1,gâ€²}Dâ€² is odd, then g+1 â©½gâ€². In this case we would have q = g < gâ€² and
v = 2q+1tâ€² = 2t; and we have D/t odd and b/t even. Conversely, if D/t is odd and b/t is even,
this implies that q = g < gâ€², which in turn implies that 2D/v is odd. (In this case as well, 2a is a
multiple of v if and only if a is a multiple of t.)
28

From these observations, in the case of D even, we obtain
Î“(a, b, D) =
ï£±
ï£´
ï£´
ï£´
ï£´
ï£´
ï£´
ï£´
ï£²
ï£´
ï£´
ï£´
ï£´
ï£´
ï£´
ï£´
ï£³
âˆš
t Â· eiÏ•
  b
t , 2a
t , 2D
t

,
if D is even, D/t is even, b/t is odd,
and a is a multiple of t;
âˆš
t Â· eiÏ•
  b
2t , a
t , D
t

,
if D is even, D/t is odd, b/t is even,
and a is a multiple of t;
0 ,
otherwise.
(99)
Summary.
From the equations above, if t = gcd(b, D), we have
Î“(a, b, D) =
ï£±
ï£´
ï£´
ï£´
ï£´
ï£´
ï£´
ï£´
ï£´
ï£²
ï£´
ï£´
ï£´
ï£´
ï£´
ï£´
ï£´
ï£´
ï£³
âˆš
t Â· eiÏ•
  b
t , 2a
t , 2D
t

, if D and D/t are even but b/t is odd, and a is a multiple of t;
âˆš
t Â· eiÏ•
  b
2t , a
t , D
t

, if D and b/t are even but D/t is odd and a is a multiple of t;
âˆš
t Â· eiÏ•
  bh
t , a
t , D
t

, if D is odd, h â‰¡2âˆ’1 (mod D), and a is a multiple of t;
0 , otherwise.
(100)
In each case, if we let t = gcd(b, D), we have
Î“(a, b, D)
 =
âˆš
t if a is a multiple of t and the value of
(D + Db/t2) is even, and Î“(a, b, D) = 0 otherwise. In particular: for b a multiplicative unit modulo D
(so that t = 1), we have
Î“(a, b, D)
 = 1. If furthermore we have a = 0, we have Î“(a, b, D) = eÏ€i(D+1)k/4
for some k âˆˆZ, from the formula for Ï•(b, a, D) given in Eqn. (89b).
29

E
Semantics for ZX and ZH diagrams, motivated by measures
In this appendix, we consider some of the constraints imposed on the measure Âµ and Ockhamic semantic
maps [[ Â· ]], which arise from introducing relationships between them and/or the Fourier transform.
E.1
Ockhamic semantics for ZX and ZH diagrams
We propose to investigate a way to more clearly express diï¬€erent semantic maps, through the investigation
of diï¬€erent measures on [D]. To do so, we follow Ref. [19], by setting out a family of semantic maps
[[ Â· ]] for ZX- and ZH-diagrams, which is ï¬‚exible enough to represent a range of possible semantics for the
generators without a proliferation of parameters for the dots and boxes. However, those deï¬nitions were
proposed to guide investigation into semantics for ZX- and ZH-diagrams on qubits, which is a special case
which enjoys several special properties which do not readily extend to the general case D > 1 in general,
and which therefore may have been overspecialised in some ways. Therefore, we propose the following
revision of the deï¬nitions of [19, pp. 31 & 34] for D > 1 in general.17
â€¢ A semantic map [[ Â· ]] of ZX diagrams in terms of operators HâŠ—m â†’HâŠ—n for arbitrary m, n âˆˆN, is
Ockhamic if it satisï¬es Eqn. (10), and if there exists a sequence (uk)kâˆˆN of positive scalars such that
u2 = 1,18 and so that the following equations are satisï¬ed for functions Î˜ : Z â†’C:
""
Î˜
...
m

...

n
##
= um+n
X
xâˆˆ[D]
Î˜(x) |xâŸ©âŠ—nâŸ¨x|âŠ—m,
hh
+
ii
=
1
âˆš
D
X X
x,kâˆˆ[D]
e2Ï€ikx/D |kâŸ©âŸ¨x| ,
""
Î˜
...
m

...

n
##
= um+n
X
kâˆˆ[D]
Î˜(k) |Ï‰âˆ’kâŸ©âŠ—nâŸ¨Ï‰k |âŠ—m,
hh
-
ii
=
1
âˆš
D
X X
x,kâˆˆ[D]
eâˆ’2Ï€ikx/D |kâŸ©âŸ¨x| .
(101)
We propose this deï¬nition in the interest of having a calculus in which the green dots and the red dots
being are related by the two kinds of Hadamard boxes, which in turn relate to the quantum Fourier
transform; but also retaining the â€˜Only the Connectivity Mattersâ€™ [1, 13] property.19
â€¢ A semantic map [[ Â· ]] of ZH diagrams in terms of operators HâŠ—m â†’HâŠ—n for arbitrary m, n âˆˆN,
is Ockhamic if it satisï¬es Eqn. (10), and if there exist sequences (uk)kâˆˆN, (hk)kâˆˆN, and (gk)kâˆˆN of
positive scalars such that u2 = 1,18 h0 = 1, and so that the following equations are satisï¬ed for c âˆˆZD
and for functions A : Z â†’C:
""
A
...
m

...

n
##
= hm+n
X X
xâˆˆ[D]m, yâˆˆ[D]n
A(x1Â·Â·Â· xmy1Â·Â·Â· yn)|yâŸ©âŸ¨x|
hh
c
ii
=
X
xâˆˆZD
|âˆ’câˆ’xâŸ©âŸ¨x|
""
...
m

...

n
##
= gm+n
X X
xâˆˆZm
D, yâˆˆZn
D
P
h
xh+P
k
yk = 0
|yâŸ©âŸ¨x|
""
...
m

...

n
##
= um+n
X
xâˆˆ[D]
|xâŸ©âŠ—nâŸ¨x|âŠ—m .
(102)
We propose this deï¬nition in the interest of emphasising the theme of simple constraints on classical
indices (in the form of the white, gray, and generalised-not dots), having the generalised-not dots
represent simple permutations of the standard basis,20 having degree-0 H-boxes with parameter Î± âˆˆC
(taken as short-hand for a function t 7â†’Î±t) stand directly for scalar factors of Î±, and retaining
ï¬‚exsymmetry of the interpretation of the generators.
17One way in which these deï¬nitions revise those of Ref. [19, pp. 31 & 34] is in allowing an amplitude diï¬€erent from 1,
for the |0âŸ©âŠ—nâŸ¨0|âŠ—m component of green dots, for the |Ï‰0âŸ©âŠ—nâŸ¨Ï‰0|âŠ—m component of red dots, and the components |yâŸ©âŸ¨x|
of H-boxes for which none of the entries x1, . . . , xm, y1, . . . , yn are zero. Given the introduction of functions Z â†’C to
represent amplitudes, this seems to us a mild extension.
18The constraint u2 = 1 was not present in the original proposed deï¬nitions of â€˜Ockhamicâ€™ semantic maps for ZX or
ZH diagrams in Ref. [19, pp. 31 & 34]. We propose this revised deï¬nition so that red and green phase-free 1 â†’1 dots, and
the white and gray 1 â†’1 dots, would all represent unitary transformations. This constraint is satisï¬ed in practise for all
existing Ockhamic semantic maps for ZX and ZH diagrams.
19It may prove to be preferable, after all, to retain the notational convention seen in most existing presentations of ZX-
based calculi [8, 12, 23, 41] of having red dots be related to green dots via conjugation by the Fourier transform. One might
describe such an interpretation as a â€˜conjugate-Ockhamicâ€™ interpretation (or, elect to redeï¬ne â€˜Ockhamicityâ€™ to favour the
interpretation in which this conjugation relation holds).
20Our attitude is ï¬‚exible as to whether c-not-dots should denote the transformation |xâŸ©7â†’|âˆ’câˆ’xâŸ©as we deï¬ne it here,
or instead |xâŸ©7â†’|câˆ’xâŸ©. These two conventions lead to slightly diï¬€erent rewrite systems, either of which may be considered
favourable depending on other conventions one might adopt to simplify notation.
We would in fact prefer the latter
convention of representing |xâŸ©7â†’|câˆ’xâŸ©, were it not for the impact on the relationship with ZX red dots, the ZX stabiliser
phase notation, and the notation for the Pauli operators. A clever notational convention might possibly resolve these issues.
30

As in Ref. [19], these two conditions of â€˜Ockhamicityâ€™ (for ZX- and for ZH-diagrams) are proposed as
an interpretation of the design principles and features of the ZX- and ZH-calculi [1, 30], but does not
necessarily represent some unifying property of these two diï¬€erent families of diagrams.21
Below, we consider how the constraint of using an Ockhamic semantic map for ZX and ZH diagrams,
interacts with the constraint of imposing a simple semantics for these diagrams via discrete integrals.
Speciï¬cally, we determine what constraints are imposed on the parameter Î½ governing the measure Âµ,
and on the scalar factors in Eqns. (101) and (102), by considering Ockhamic semantic maps on the ZX and
ZH generators for which Eqn. (6) holds.
E.2
Ockhamic semantics for ZH diagrams
We ï¬rst consider the constraints imposed on an Ockhamic semantic map of ZH diagrams, by requiring
Eqns. (6) to hold. (These will in fact be less restrictive in a sense than the comparable constraints for
semantics of ZX diagrams, owing to the explicit role in Eqn. (101) for the quantum Fourier transform.)
We proceed directly by considering how the expressions in Eqn. (102) may be expressed as integrals
with respect to the measure Âµ, and then considering the consequences of requiring Eqns. (6) to hold.
Note in particular how, for a multi-coeï¬ƒcient vector x âˆˆ[D]m, we have |xâŸ©= |x1âŸ©âŠ—|x2âŸ©âŠ—Â· Â· Â· âŠ—|xmâŸ©=
Î½m|x1âŸ©âŸ©âŠ—|x2âŸ©âŸ©âŠ—Â· Â· Â· âŠ—|xmâŸ©âŸ©= Î½m|xâŸ©âŸ©. Similarly, for every sum over x âˆˆ[D]m that we turn into an integral,
we introduce a factor of Î½âˆ’2m (one factor of Î½âˆ’2 for each coeï¬ƒcient xj âˆˆ[D]). We then have:
hh
c
ii
=
X
xâˆˆZD
|âˆ’câˆ’xâŸ©âŸ¨x| = Î½2 X
xâˆˆZD
|âˆ’câˆ’xâŸ©âŸ©âŸ¨âŸ¨x| =
Z
xâˆˆZD
|âˆ’câˆ’xâŸ©âŸ©âŸ¨âŸ¨x| ,
(103a)
""
...
m

...

n
##
= um+n
X
xâˆˆ[D]
|xâŸ©âŠ—nâŸ¨x|âŠ—m
= um+n Â· Î½m+n X
xâˆˆ[D]
|xâŸ©âŸ©âŠ—nâŸ¨âŸ¨x|âŠ—m = um+n Â· Î½m+nâˆ’2
Z
xâˆˆ[D]
|xâŸ©âŸ©âŠ—nâŸ¨âŸ¨x|âŠ—m ,
(103b)
""
A
...
m

...

n
##
= hm+n Â· Î½m+n X X
xâˆˆ[D]m,yâˆˆ[D]n
A(x1Â·Â·Â· xmy1Â·Â·Â· yn) |yâŸ©âŸ©âŸ¨âŸ¨x|
= hm+nÂ· Î½âˆ’(m+n)
ZZ
xâˆˆ[D]m,yâˆˆ[D]n
A(x1Â·Â·Â· xmy1Â·Â·Â· yn) |yâŸ©âŸ©âŸ¨âŸ¨x| ,
(103c)
""
...
m

...

n
##
= gm+n
X X
xâˆˆZm
D, yâˆˆZn
D
P
h
xh+P
k
yk = 0
|yâŸ©âŸ¨x| = gm+n
X X
xâˆˆZm
D, yâˆˆZn
D

 P
h
xh + P
k
yk |0âŸ©|yâŸ©âŸ¨x|
= gm+n Â· Î½m+n+2 X X
xâˆˆZm
D, yâˆˆZn
D


 P
h
xh + P
k
yk
|0

|yâŸ©âŸ©âŸ¨âŸ¨x|
= gm+n Â· Î½âˆ’mâˆ’n+2
ZZ
xâˆˆZm
D, yâˆˆZn
D
|yâŸ©âŸ©âŸ¨âŸ¨x|


 P
h
xh + P
k
yk
|0

.
(103d)
In particular, the imposed semantics for the generalised-not dot are automatically satisï¬ed by the deï¬ni-
tion of the point-mass vectors |xâŸ©âŸ©; requiring the leading scalar on the last line of Eqn. (103b) to be equal
to 1, imposes the constraint uk = Î½âˆ’k+2 (which in particular is consistent with u2 = 1); requiring the
leasing scalar on the last line of Eqn. (103c) to be 1, imposes the constraint hk = Î½k (which in particular
is consistent with h0 = 1); and requiring the leading scalar of Eqn. (103d) to be equal to 1, imposes the
constraint gk = Î½kâˆ’2.
Note that none of the above imposes constraints on Î½ itself, essentially because the only unitarity
constraints happen to involve a single integral over [D] (as with the generalised-not dot or the 1 â†’1
21Indeed, if one identiï¬es an H-box with degree 2 and amplitude parameter Ï‰ = e2Ï€i/D âˆˆC in the ZH calculus, with the
Hadamard plus box of ZX diagrams, this imposes signiï¬cant constraints on the parameters h2, gk, and uk.
31

white dot), so that all factors of Î½ cancel in those cases. Thus, the approach of deï¬ning semantics for
ZH generators in terms of integrals as in Eqn. (6) is in itself suï¬ƒcient to ensure the Ockhamicity of the
interpretation, regardless of the normalising factor Î½ is used to deï¬ne the measure Âµ.
We note in particular that in the case D = 2, the original semantics for ZH diagrams presented by
Backens and Kissinger [30] satisï¬es these constraints for Î½ = 1. For arbitrary D > 1, such a choice yields
a measure for which Âµ({âˆ—}) = 1 and Âµ([D]) = D. While the rewrite systems that one obtains for this
measure are likely to involve more frequent changes to the scalar factors through scalar gadgets, this does
seem (both intuitively and in practise [33, 40]) an appropriate choice to denote and analyse problems in
counting complexity.
E.3
Ockhamic semantics for ZX diagrams
By considering Ockhamic semantics for ZX generators, we necessarily consider an interpretation of the
(inverse) discrete Fourier transform which is unitary.
If we impose the constraint that the inverse Fourier transform as expressed in Eqn. (26) should be
equal to the quantum Fourier transform, this is equivalent to imposing unitarity on a Fourier transform as
expressed in Eqn. (25) that preserves the measure. From this, we would obtain the constraint Î½ = Dâˆ’1/4,
as described in Section 3.2. We can also see this by directly considering the consequences of imposing
this constraint on the meaning of integration over [D]:
1
âˆš
D
X X
x,kâˆˆ[D]
e2Ï€ikx/D |kâŸ©âŸ¨x| =
hh
+
ii
:=
ZZ
k,xâˆˆ[D]
e2Ï€ikx/D |kâŸ©âŸ©âŸ¨âŸ¨x| = Î½2 X X
k,xâˆˆ[D]
e2Ï€ikx/D |kâŸ©âŸ¨x| ,
(104)
so that Î½ = Dâˆ’1/4, and in particular Âµ([D]) = N = DÎ½2 =
âˆš
D. In this way, unlike the case with
Ockhamic semantic map of ZH generators as we considered in Section E.2, relating Ockhamic semantics
of ZX generators to simple integrals necessarily constrains Âµ.
Following Section E.2, to obtain a simple representation of the semantics for green and red dots in an
Ockhamic semantic map, we might impose the following constraints:
""
...
m

...

n
##
=
Z
xâˆˆ[D]
|xâŸ©âŸ©âŠ—nâŸ¨âŸ¨x|âŠ—m ,
""
...
m

...

n
##
=
Z
kâˆˆ[D]
|Ï‰âˆ’kâŸ©âŸ©âŠ—nâŸ¨âŸ¨Ï‰k|âŠ—m .
(105)
As with the white dots in Ockhamic semantic maps of the ZH calculus (which is identical to the analysis
of green dots with phase function ËœÎ¸(x) = 1), we would then obtain the constraint uk = Î½âˆ’k+2.
32

F
Sound diagrammatic rewrites
Having considered semantic maps for ZX- and ZH-diagrams as above, we now brieï¬‚y survey what rewrites
we may show to be sound for these semantics.
We make no attempt to achieve complete calculi for these semantics: we expect that doing so will
be somewhat involved, though perhaps they can be informed by recent work [41] on a complete ZXW-
calculus in arbitrary dimensions D > 1. We also do not aim to achieve a minimal set of rewrite rules,
though we will in some instances point out when some rules may be derived from some others. Our
objective is to demonstrate the soundness of scalar-exact versions of familiar rewrite rules, motivated by
rules from complete versions of the ZX- and ZH-calculi [19, 34] in the special case D = 2, by ZX rewrite
rules presented for odd D > 1 presented by Booth and Carette [27], and by ZH-rewrite rules for D > 1
presented by Roy [35]. We aim also to describe versions of these rules, which are both simple and versatile
enough that their usefulness may be plausible despite the absence of a completeness proof.
F.1
A note on conventions in analysis of discrete integrals over [D]
Our approach is concrete, consisting of the direct manipulation of discrete integrals. We hope to demon-
strate that, in the large majority of cases, this is not diï¬ƒcult to do. In the following, we will model what
we consider to be a reasonable approach to using discrete integrals in practise.
We have at times emphasised the role of the measure in our integrals. This has been partly because the
measure itself, and the possible use of more than one measure, have been subjects of interest. However,
in this section we consider only one form of integration (over [D]m for various m > 0) with respect to
only one measure (the measure Âµ(S) = #S Â· Î½2, and induced measures on [D]m). Therefore, we do not
need to explicitly write dÂµ(x) or dÂµ(y) when integrating over x, y âˆˆ[D], nor dÂµm(x) when integrating
over x âˆˆ[D]m, and so forth. This is consistent with occasional practise in the mathematics literature
(see, e.g., Ref. [29]). One may regard the integral symbol itself as an operator on a given expression, with
the measure understood from context (e.g., the variable of integration).
Note also that, in order to shorten our calculations, we occasionally omit expressions
R
yâˆˆ[D] âŸ¨âŸ¨x|yâŸ©âŸ©Î¦(y)
that might arise due to x and y being indices for two diï¬€erent nodes, corresponding to an edge incident
to both: we may implicitly simplify such integrals to Î¦(x) .
Similarly, we may simplify expressions
RR
xâˆˆ[D]m,yâˆˆ[D]âŸ¨âŸ¨f(x1, . . . , xm)|yâŸ©âŸ©Î¦(y) âˆ’â†’
R
xâˆˆ[D]m Î¦(f(x1, . . . , xm)). On occasion, when we wish to em-
phasise the role of x1, x2, . . . âˆˆ[D] as representatives of the integers modulo D, we may write these same
integrals as
R
xâˆˆZm
D Î¦(f(x1, . . . , xm)) rather than
R
xâˆˆ[D]m Î¦(f(x1, . . . , xm)); however, we do so only when
Î¦ is well-deï¬ned modulo D in each of its arguments. (We routinely interpret arithmetic expressions E
modulo D, when they are used to indicate point-mass functions |EâŸ©âŸ©; though E âˆˆZ may not represent
an element of [D] outside of that context.) We also make liberal use of Lemma 1, which (except where
we assume Î½ = Dâˆ’1/4) will give rise to frequent occurrences of the scalar expression DÎ½4.
F.2
Sound ZH rewrites
We ï¬rst consider rewrites for the ZH generators, which are sound for a semantic map as consdered in
Section E.2, without yet committing to a value of Î½. This provides us with multiple versions of the
ZH calculus, parameterised by Î½ as well as by D, which may be suitable for diï¬€erent purposes. For
instance, following our observation at the end of Section E.2, it is likely that a measure in which Î½ = 1
(corresponding to the original presentation of Backens and Kissinger [30] in the special case D = 2) may
be most appropriate to analyse counting problems; whereas for the analysis of unitary transformations
and interoperation with the ZX calculus, our analysis suggests that Î½ = Dâˆ’1/4 would be more suitable
(as well as giving rise to simpler rewrites overall).
In the following, we make frequent use of the â€˜multicharacterâ€™ notation for H-boxes, in which an H-
box inscribed with c âˆˆZ denotes that the amplitude Ï‰c is intended. Note that this is diï¬€erent from the
original annotation convention set out for the ZH calculus in Ref. [30] and related works such as Ref. [33],
in which amplitudes Î± âˆˆC are written in the box. (In particular, in our work, an H-box with 0 âˆˆZ
inscribed indicates the constant amplitude function A(t) = Ï‰0Â·t = 1t = 1, rather than A(t) = 0t, which
is not a function on [D] for D > 2.) As A(t) = Ï‰t is well-deï¬ned modulo D, we may abuse notation
slightly and parameterise such â€˜multicharacterâ€™ boxes by c âˆˆZD, or conversely interpret c âˆˆZ as though
it were an element of ZD. In particular, for u âˆˆZÃ—
D, we will make frequent use of the generator
u
which denotes the operator
R
x,y Ï‰uxy |yâŸ©âŸ©âŸ¨âŸ¨x|. We also occasionally make use of the short-hand
+
and
-
for u = Â±1 in particular.
33

(ZH-WF):
White dot fusion.
ï£®
ï£¯ï£°
ï£®
ï£¯ï£°
...
k
n
...
o
m
...
o
n
...
â„“
n
ï£¹
ï£ºï£»
ï£¹
ï£ºï£»
=
""
...
k+â„“

...

m+n
##
Proof.
ZZ
x,yâˆˆ[D]

1âŠ—n âŠ—|yâŸ©âŸ©âŠ—nâŸ¨âŸ¨y|âŠ—â„“+1
|xâŸ©âŸ©âŠ—m+1âŸ¨âŸ¨x|âŠ—k âŠ—1âŠ—m
=
ZZ
x,yâˆˆ[D]
|xâŸ©âŸ©âŠ—mâŸ¨âŸ¨x|âŠ—k âŠ—âŸ¨âŸ¨y|xâŸ©âŸ©âŠ—|yâŸ©âŸ©âŠ—nâŸ¨âŸ¨y|âŠ—â„“
=
Z
xâˆˆ[D]
|xâŸ©âŸ©âŠ—mâŸ¨âŸ¨x|âŠ—k âŠ—|xâŸ©âŸ©âŠ—nâŸ¨âŸ¨x|âŠ—â„“
=
Z
xâˆˆ[D]
|xâŸ©âŸ©âŠ—m+nâŸ¨âŸ¨x|âŠ—k+â„“.
(ZH-WQS):
White quasi-special fusion.
""
Î½2
##
=
hh
Î¸
ii
Proof.
Î½2
ZZ
x,yâˆˆ[D]
|yâŸ©âŸ©âŸ¨âŸ¨y, y|x, xâŸ©âŸ©âŸ¨âŸ¨x| = Î½2
ZZ
x,yâˆˆ[D]
|yâŸ©âŸ©

âŸ¨âŸ¨y|xâŸ©âŸ©âŠ—âŸ¨âŸ¨y|xâŸ©âŸ©

âŸ¨âŸ¨x|
=
Z
xâˆˆ[D]
Î½2 âŸ¨âŸ¨x|xâŸ©âŸ©|xâŸ©âŸ©âŸ¨âŸ¨x| =
Z
xâˆˆ[D]
|xâŸ©âŸ©âŸ¨âŸ¨x| .
This result essentially follows from the presence of a redundant factor of âŸ¨âŸ¨y|xâŸ©âŸ©in the integral, which
does not further constrain the variables of integration but does contribute a factor of âŸ¨âŸ¨x|xâŸ©âŸ©= Î½âˆ’2.
(ZH-WGB):
White-gray bialgebra.
""
...
...
...
...
##
=

...
...

Proof.
ZZ
xâˆˆ[D]m
zâˆˆ[D]n
 n
O
j=1


zj +
m
P
h=1
xh |
0

!
|zâŸ©âŸ©âŸ¨âŸ¨x|
=
ZZ
xâˆˆ[D]m
zâˆˆ[D]n
 n
Y
j=2
âŸ¨zj|z1âŸ©
!


z1 +
m
P
h=1
xh |
0

 n
O
j=1
|zjâŸ©âŸ©
!
âŸ¨âŸ¨x|
=
ZZ
xâˆˆ[D]m
z1âˆˆ[D]


z1 +
m
P
h=1
xh |
0

 n
O
j=1
|z1âŸ©âŸ©
!
âŸ¨âŸ¨x|
=
ZZZ
xâˆˆ[D]m
y,zâˆˆ[D]
âŸ¨âŸ¨z|yâŸ©âŸ©


y +
m
P
h=1
xh |
0

|zâŸ©âŸ©âŠ—nâŸ¨âŸ¨x|
=
"
Z
yâˆˆ[D]
|zâŸ©âŸ©âŠ—nâŸ¨âŸ¨z|
#"
Z
xâˆˆ[D]m
yâˆˆ[D]


y +
m
P
h=1
xh |
0

|yâŸ©âŸ©âŸ¨âŸ¨x|
#
.
(ZH-WNS):
Not-dot symmetry.
ï£®
ï£¯ï£°
ï£®
ï£¯ï£°
c
c
...
c
c
...
ï£¹
ï£ºï£»
ï£¹
ï£ºï£»
=

...
...

Proof.
ZZZ
xâˆˆZm
D
yâˆˆZn
D
zâˆˆZD
" n
O
j=1
|âˆ’câˆ’yjâŸ©âŸ©âŸ¨âŸ¨yj|
#"
|zâŸ©âŸ©âŠ—nâŸ¨âŸ¨z|âŠ—m
#" m
O
h=1
|xhâŸ©âŸ©âŸ¨âŸ¨âˆ’câˆ’xh|
#
=
Z
zâˆˆZD
" n
O
j=1
|âˆ’câˆ’zâŸ©âŸ©
#" m
O
h=1
âŸ¨âŸ¨âˆ’câˆ’z|
#
=
Z
zâˆˆZD
|zâŸ©âŸ©âŸ¨âŸ¨z| .
N.B. We expect this rewrite can be derived from the others: the special
case of c = 0 is not diï¬ƒcult to show using (ZH-WGB) and (ZH-NA).
34

(ZH-WGC):
White-gray colour change.
""
u
u
...
u
u
...
##
=
ï£®
ï£°
ï£®
ï£°...
...
DÎ½4
ï£¹
ï£»
ï£¹
ï£»
Proof.
ZZZ
xâˆˆ[D]m
yâˆˆ[D]
zâˆˆ[D]n
 m
O
j=1
Ï‰uxj y
! n
O
k=1
Ï‰uyzk
!
|zâŸ©âŸ©âŸ¨âŸ¨x|
=
ZZ
xâˆˆ[D]m
zâˆˆ[D]n
 
Z
yjâˆˆ[D]
Ï‰uy
 P
j
xj+P
k
zk
!
|zâŸ©âŸ©âŸ¨âŸ¨x|
=
ZZ
xâˆˆ[D]m
zâˆˆ[D]n
DÎ½4 

 P
j
xj + P
k
zk
|0

|zâŸ©âŸ©âŸ¨âŸ¨x| .
Corollary (â€œDouble-Hâ€):
u
u
â†â†’
u
u
â†â†’
DÎ½4
Corollary (ZH-GWC): Gray-white colour change â€” Using the white-gray colour change rules, the
double-H rule, and the â€˜antipode symmetryâ€™ rule, we may show:
u
u
...
m

u
u
...

n
â†”
u
u
u
u
...
m

u
u
u
u
...

n
(DÎ½4)âˆ’1
â†”
...
m

...

n
(DÎ½4)m+nâˆ’1
â†”
...
m

...

n
(DÎ½4)m+nâˆ’1
Corollary (ZH-GL): Gray lollipop.
...
...
â†â†’
+
+
...
+
+
...
+
(DÎ½4)âˆ’1
â†â†’
+
+
...
+
+
...
(DÎ½4)âˆ’1
â†â†’
+
+
...
+
+
...
(DÎ½4)âˆ’1
â†â†’
...
...
Corollary (ZH-GF): Gray dot fusion.
...
k
n
...
o
m
...
o
n
...
â„“
n
â†â†’
+
+...
k

+
+
...

m
+
+...

n
+
+
...
â„“

+
+
(DÎ½4)âˆ’2
â†â†’
+
+...
k

+
+
...

m
+
+...

n
+
+
...
â„“

(DÎ½4)âˆ’1
â†â†’
+
+
...
k+â„“

+
+
...

m+n
(DÎ½4)âˆ’1
â†â†’
...
k+â„“

...

m+n
Corollary (ZH-A): Antipode rule.
â†”
â†”
â†”
â†”
â†”
35

(ZH-MF):
Multicharacter fusion.
ï£®
ï£¯ï£¯ï£¯ï£°
ï£®
ï£¯ï£¯ï£¯ï£°
c1
...
...
c2 ...
...
âˆ’u
ï£¹
ï£ºï£ºï£ºï£»
ï£¹
ï£ºï£ºï£ºï£»
=
ï£®
ï£°
ï£®
ï£°
uâ€“1c1c2
...
...
DÎ½4
ï£¹
ï£»
ï£¹
ï£»
We use the notation Î (x), in
eï¬€ect representing a function
Î  : Zm
D â†’ZD which we deï¬ne
by Î (x) = x1x2 Â· Â· Â· xm. As a
mild abuse of notation, we al-
low Î  to act on arguments of
various sizes, e.g., x âˆˆZm
D and
y âˆˆZn
D.
Proof.
ZZZZZZ
râˆˆZk
D, sâˆˆZâ„“
D
xâˆˆZm
D, yâˆˆZn
D
t,zâˆˆZD
Ï‰c1Î (r)t Î (x) Ï‰âˆ’utz Ï‰c2Î (s)z Î (y) |x, yâŸ©âŸ©âŸ¨âŸ¨r, s|
=
ZZZZZ
râˆˆZk
D, sâˆˆZâ„“
D
xâˆˆZm
D, yâˆˆZn
D
tâˆˆZD
Ï‰c1Î (r)t Î (x)
 
Z
zâˆˆZD
Ï‰z
 âˆ’ut+v2Î (s) Î (y)
!
|x, yâŸ©âŸ©âŸ¨âŸ¨r, s|
=
ZZZZZ
râˆˆZk
D, sâˆˆZâ„“
D
xâˆˆZm
D, yâˆˆZn
D
tâˆˆZD
DÎ½4 Â·


âˆ’ut + c2Î (s) Î (y)
|0

Â· Ï‰c1Î (r)t Î (x) |x, yâŸ©âŸ©âŸ¨âŸ¨r, s|
= DÎ½4
ZZZZ
râˆˆZk
D, sâˆˆZâ„“
D
xâˆˆZm
D, yâˆˆZn
D
Ï‰uâˆ’1c1c2Â·Î (r) Î (s) Î (x) Î (y) |x, yâŸ©âŸ©âŸ¨âŸ¨r, s| .
Corollary (â€œMulticharacter negationâ€):
c
...
â†â†’
c
...
+
+
(DÎ½4)âˆ’1
â†â†’
âˆ’c
...
This corollary is also in principle a special case of the â€œmixed bialgebra ruleâ€ (ZH-HMB). We note it here
as a frequently-used special case involving the relationship between multicharacters and the degree-2 gray
dot, which may be construed as actions on single qudits.
(ZH-EC):
Exponent complement.
""
Î±
...
Â¬
##
=
ï£®
ï£¯ï£°
ï£®
ï£¯ï£°
Î±âˆ’1
Î±Ïƒ
...
ï£¹
ï£ºï£»
ï£¹
ï£ºï£»
Proof.
ZZZ
xâˆˆ[D]m
y,zâˆˆ[D]
Î±Î (x)y |Â¬zâŸ©âŸ©âŸ¨âŸ¨z|yâŸ©âŸ©âŸ¨âŸ¨x| =
ZZZ
xâˆˆ[D]m
y,zâˆˆ[D]
Î±Î (x)y |zâŸ©âŸ©âŸ¨âŸ¨Â¬z|yâŸ©âŸ©âŸ¨âŸ¨x|
=
ZZZ
xâˆˆ[D]m
y,zâˆˆ[D]
Î±Î (x)y |zâŸ©âŸ©âŸ¨âŸ¨Ïƒâˆ’z|yâŸ©âŸ©âŸ¨âŸ¨x|
=
ZZ
xâˆˆ[D]m
zâˆˆ[D]
Î±Î (x)(Ïƒâˆ’z) |zâŸ©âŸ©âŸ¨âŸ¨x|
=
ZZ
xâˆˆ[D]m
zâˆˆ[D]
 Î±Ïƒ Î (x) Â·
 Î±âˆ’1 Î (x)z |zâŸ©âŸ©âŸ¨âŸ¨x| .
(ZH-HU): H-box unit.
hh
0
ii
=
hh
ii
Proof.
Z
xâˆˆ[D]
Ï‰0Â·x |xâŸ©âŸ©=
Z
xâˆˆ[D]
|xâŸ©âŸ©.
(ZH-HM):
H-box multiplication.

B
A

=
hh
AÂ·B
ii
Proof.
ZZZ
x,y,zâˆˆ[D]
A(x) B(y) |zâŸ©âŸ©âŸ¨âŸ¨z, z|x, yâŸ©âŸ©
=
Z
zâˆˆ[D]
A(z)B(z) |zâŸ©âŸ©=
Z
zâˆˆ[D]

A Â· B

(z) |zâŸ©âŸ©.
36

Corollary (ZH-MCA): Multicharacter addition.
b
a
â†â†’
a+b
(ZH-NH):
Generalised-not dots:

u
u
c

=
""
uâ€“1c
DÎ½4
##
Proof.
ZZZ
x,y,zâˆˆ[D]
Ï‰uxyÏ‰cyÏ‰uyz|zâŸ©âŸ©âŸ¨âŸ¨x|
=
ZZ
x,zâˆˆ[D]
 
Z
yâˆˆ[D]
Ï‰uy(z + x + uâˆ’1c)
!
|zâŸ©âŸ©âŸ¨âŸ¨x|
=
ZZ
x,zâˆˆ[D]
DÎ½4 

z|
âˆ’uâˆ’1c âˆ’x

|zâŸ©âŸ©âŸ¨âŸ¨x|
= DÎ½4
Z
xâˆˆ[D]
âˆ’uâˆ’1c âˆ’x

âŸ¨âŸ¨x|.
Corollary (ZH-NA): Not-antipode.
0
â†â†’
+
+
0
(DÎ½4)âˆ’1
â†â†’
+
+
(DÎ½4)âˆ’1
â†â†’
+
+
(DÎ½4)âˆ’1
â†â†’
Corollary (ZH-ND): Not-displacement.
c1
c2
â†â†’
+
+
+
+
c1
c2
(DÎ½4)âˆ’2
â†â†’
+
+
c1
c2
(DÎ½4)âˆ’1
â†â†’
+
+
c1
c2
(DÎ½4)âˆ’1
â†â†’
+
+
âˆ’c1
c2
(DÎ½4)âˆ’1
â†â†’
+
+
+
+
c2 âˆ’c1
(DÎ½4)âˆ’2
â†â†’
c2âˆ’c1
â†â†’
c2âˆ’c1
0
(ZH-WI), (ZH-AI),
(ZH-HI), etc. â€”
Identity rules:


=


=
hh
c
c
ii
=
ï£®
ï£¯ï£¯ï£¯ï£°
ï£®
ï£¯ï£¯ï£¯ï£°
u
âˆ’u
(DÎ½4)âˆ’1
ï£¹
ï£ºï£ºï£ºï£»
ï£¹
ï£ºï£ºï£ºï£»=
ï£®
ï£¯ï£¯ï£¯ï£°
ï£®
ï£¯ï£¯ï£¯ï£°
u
u
u
u
(DÎ½4)âˆ’2
ï£¹
ï£ºï£ºï£ºï£»
ï£¹
ï£ºï£ºï£ºï£»=

Î¸

Proof.
The white-dot identity is trivial: its semantics is the resolution of the identity, Eqn. (20). The
generalised not-dot identity rule can be proven from (ZH-NS):
c
c
â†â†’
c
c
â†â†’
â†â†’
(106)
The gray-dot identity may be derived using this and (ZH-NA):
â†â†’
0
0
â†â†’
(107)
Finally, the two H-box identity rules can be proven using (ZH-MF) for c1 = c2 = 1, the â€˜double-H-boxâ€™
rule, and the newly demonstrated gray-dot identity rule (simplifying scalar boxes immediately):
u
âˆ’u
(DÎ½4)âˆ’1
â†â†’
u
u
u
u
(DÎ½4)âˆ’2
â†â†’
â†â†’
(108)
37

(ZH-HWB):
H-box & white-dot bialgebra.
ï£®
ï£¯ï£¯ï£°
ï£®
ï£¯ï£¯ï£°
âˆ’u
âˆ’u
u
u
...
m
ï£±
ï£²
ï£³
...
...
...
ï£¼
ï£½
ï£¾n
ï£¹
ï£ºï£ºï£»
ï£¹
ï£ºï£ºï£»
=
ï£®
ï£¯ï£°
ï£®
ï£¯ï£°
v
âˆ’v
...
m
(
...
)
n
(DÎ½4)nâˆ’1
ï£¹
ï£ºï£»
ï£¹
ï£ºï£»
We use the notation Î (x), in
eï¬€ect representing a function
Î  : Zm
D â†’ZD which we deï¬ne
by Î (x) = x1x2 Â· Â· Â· xm. As a
mild abuse of notation, we al-
low Î  to act on arguments of
various sizes, e.g., x âˆˆZm
D and
y âˆˆZn
D.
Proof.
ZZZ
xâˆˆ[D]m
y,zâˆˆ[D]n
 n
O
j=1
Ï‰âˆ’uyjzjÏ‰uÎ (x) yj
!
|zâŸ©âŸ©âŸ¨âŸ¨x|
=
ZZ
xâˆˆ[D]m
zâˆˆ[D]n
 n
Y
j=1
Z
yjâˆˆ[D]
Ï‰uyj
 Î (x)âˆ’zj
!  n
O
j=1
|zjâŸ©âŸ©
!
âŸ¨âŸ¨x|
=
ZZ
xâˆˆ[D]m
zâˆˆ[D]n
 n
Y
j=1
DÎ½4

zj|
Î (x)

!  n
O
j=1
|zjâŸ©âŸ©
!
âŸ¨âŸ¨x|
= (DÎ½4)nâˆ’1
ZZ
xâˆˆ[D]m
z1âˆˆ[D]
DÎ½4

z1|
Î (x)

 n
O
j=1
|z1âŸ©âŸ©
!
âŸ¨âŸ¨x|
= (DÎ½4)nâˆ’1
ZZ
xâˆˆ[D]m
zâˆˆ[D]
 
Z
yâˆˆ[D]
Ï‰vy
 Î (x)âˆ’z
!
|zâŸ©âŸ©âŠ—nâŸ¨âŸ¨x|
= (DÎ½4)nâˆ’1
"
Z
zâˆˆ[D]
|zâŸ©âŸ©âŠ—nâŸ¨âŸ¨z|
#"
ZZ
xâˆˆ[D]m
w,yâˆˆ[D]
Ï‰âˆ’vyw Ï‰vy Î (x) |wâŸ©âŸ©âŸ¨âŸ¨x|
#
.
Corollary (ZH-HMB): H-box mixed bialgebra â€” the rule described as â€˜BA2â€™ in Refs. [30, 34] can be
generalised to D > 1 (in a way equivalent to but diï¬€erent from that presented by Roy [35]), using the
above bialgebra rule in combination with (ZH-HI), (ZH-MF), and (ZH-WGC):
u
u
...
m
(
...
...
...
)
n
â†’
u
u
âˆ’u
u
âˆ’u
u
...
m
(
...
...
...
)
n
(DÎ½4)âˆ’n
â†’
u
âˆ’u
...
m
(
u
u
...
)
n
(DÎ½4)âˆ’1
â†’
u
u
u
u
...
m
(
u
u
...
)
n
(DÎ½4)âˆ’2
â†’
âˆ’u
...
m
(
...
)
n
(ZH-ME):
White-gray multiplication.
ï£®
ï£¯ï£¯ï£°
ï£®
ï£¯ï£¯ï£°
...
ï£¼
ï£½
ï£¾k
DÎ½4
ï£¹
ï£ºï£ºï£»
ï£¹
ï£ºï£ºï£»
=
ï£®
ï£¯ï£°
ï£®
ï£¯ï£°
uk
âˆ’u
ï£¹
ï£ºï£»
ï£¹
ï£ºï£»
Proof. DÎ½4
ZZZ
x,zâˆˆ[D]
yâˆˆ[D]k+1
|zâŸ©âŸ©âŸ¨âŸ¨z + yk+1|0âŸ©âŸ©


 P
h
yh
|0

 k
O
j=1
âŸ¨âŸ¨yj|xâŸ©âŸ©
!
âŸ¨âŸ¨x|
=
ZZ
x,zâˆˆ[D]
|zâŸ©âŸ©

DÎ½4 âŸ¨âŸ¨kx âˆ’z|0âŸ©âŸ©

âŸ¨âŸ¨x|
=
ZZ
x,zâˆˆ[D]
|zâŸ©âŸ©
 
Z
tâˆˆ[D]
Ï‰ut(kxâˆ’z)
!
âŸ¨âŸ¨x|
=
ZZZZ
x,s,t,zâˆˆ[D]

Ï‰âˆ’usz |zâŸ©âŸ©âŸ¨âŸ¨s|

Ï‰uktx |tâŸ©âŸ©âŸ¨âŸ¨x|

.
38

Corollary (ZH-MEH): Multiedge Hopf Law â€” We may prove the following using the rules (ZH-AI),
(ZH-ME), (ZH-MF), (ZH-HU), (ZH-WGC), (ZH-GL), and (ZH-HMB):
...
ï£¼
ï£½
ï£¾D
DÎ½4
â†”
...
ï£¼
ï£½
ï£¾D
DÎ½4
â†”
D
-
â†â†’
0
-
+
+
(DÎ½4)âˆ’1
â†”
+
+
0
+
(DÎ½4)âˆ’1
â†”
-
+
+
(DÎ½4)âˆ’1
â†”
-
+
(DÎ½4)âˆ’1
â†”
+
(DÎ½4)âˆ’1
â†”
â€œZero product Lemmaâ€.
ï£®
ï£¯ï£¯ï£¯ï£¯ï£¯ï£¯ï£¯ï£¯ï£¯ï£¯ï£¯ï£°
ï£®
ï£¯ï£¯ï£¯ï£¯ï£¯ï£¯ï£¯ï£¯ï£¯ï£¯ï£¯ï£°
...
...
+
0
-
+
1
-
+
2
-
+
Dâˆ’1
-
ï£¹
ï£ºï£ºï£ºï£ºï£ºï£ºï£ºï£ºï£ºï£ºï£ºï£»
ï£¹
ï£ºï£ºï£ºï£ºï£ºï£ºï£ºï£ºï£ºï£ºï£ºï£»
=
ï£®
ï£¯ï£¯ï£¯ï£¯ï£¯ï£¯ï£¯ï£¯ï£¯ï£¯ï£¯ï£°
ï£®
ï£¯ï£¯ï£¯ï£¯ï£¯ï£¯ï£¯ï£¯ï£¯ï£¯ï£¯ï£°
...
...
+
0
-
+
1
-
+
2
-
+
Dâˆ’1
-
Î½2
ï£¹
ï£ºï£ºï£ºï£ºï£ºï£ºï£ºï£ºï£ºï£ºï£ºï£»
ï£¹
ï£ºï£ºï£ºï£ºï£ºï£ºï£ºï£ºï£ºï£ºï£ºï£»
Following Roy [35, p. 36], this
Lemma represents the fact that
for x, a0, a1, a2, . . . âˆˆZD such
that a0(0 âˆ’x) = a1(1 âˆ’x) =
a2(2 âˆ’x) = Â· Â· Â· , then in par-
ticular aj(jâˆ’x) = 0 for j =x,
so that in fact ak(kâˆ’x) = 0
for all k âˆˆZD.
In the seventh line of the proof,
we introduce a redundant fac-
tor of âŸ¨âŸ¨0|zxâŸ©âŸ©. This allows us
to re-incorporate the terms in
the ï¬rst set of parentheses into
the product over j âˆˆZD. As
âŸ¨âŸ¨0|zxâŸ©âŸ©introduces a factor of
1
Î½2 , we must multiply by Î½2
to avoid changing the overall
normalisation.
This is what
introduces the factor of Î½2 in
this rewrite.
Proof.
ZZZZZ
a,y,zâˆˆZD
D
u,xâˆˆZD
 D
O
j=1
Ï‰ajyj(jâˆ’x) Ï‰âˆ’yjzjâŸ¨âŸ¨u|zjâŸ©âŸ©
!
|xâŸ©âŸ©âŸ¨âŸ¨a|
=
ZZZZ
a,zâˆˆZD
D
u,xâˆˆZD
Y
jâˆˆZD
 
Z
yjâˆˆZD
Ï‰yj
 aj(jâˆ’x) âˆ’zj

âŸ¨âŸ¨u|zjâŸ©âŸ©
!
|xâŸ©âŸ©âŸ¨âŸ¨a|
=
ZZZZ
a,zâˆˆZD
D
u,xâˆˆZD
 Y
jâˆˆZD
DÎ½4 âŸ¨âŸ¨zj|aj(j âˆ’x)âŸ©âŸ©âŸ¨âŸ¨u|zjâŸ©âŸ©
!
|xâŸ©âŸ©âŸ¨âŸ¨a|
=
ZZZZ
a,zâˆˆZD
D
u,xâˆˆZD
 
DÎ½4 âŸ¨âŸ¨zx|aj Â· 0âŸ©âŸ©âŸ¨âŸ¨u|zxâŸ©âŸ©
!
Ã—
 Y
jâˆˆZD
jÌ¸=x
DÎ½4 âŸ¨âŸ¨zj|aj(j âˆ’x)âŸ©âŸ©âŸ¨âŸ¨u|zjâŸ©âŸ©
!
|xâŸ©âŸ©âŸ¨âŸ¨a|
=
ZZZZ
a,zâˆˆZD
D
u,xâˆˆZD
 
DÎ½4 âŸ¨âŸ¨zx|aj Â· 0âŸ©âŸ©âŸ¨âŸ¨u|0âŸ©âŸ©
!
Ã—
 Y
jâˆˆZD
jÌ¸=x
DÎ½4 âŸ¨âŸ¨zj|aj(j âˆ’x)âŸ©âŸ©âŸ¨âŸ¨u|zjâŸ©âŸ©
!
|xâŸ©âŸ©âŸ¨âŸ¨a|
=
ZZZ
a,zâˆˆZD
D
xâˆˆZD
 
DÎ½4 âŸ¨âŸ¨zx|aj Â· 0âŸ©âŸ©
!
Ã—
 Y
jâˆˆZD
jÌ¸=âˆ’x
DÎ½4 âŸ¨âŸ¨zj|aj(j âˆ’x)âŸ©âŸ©âŸ¨âŸ¨0|zjâŸ©âŸ©
!
|xâŸ©âŸ©âŸ¨âŸ¨a|
=
ZZZ
a,zâˆˆZD
D
xâˆˆZD
Î½2
 
DÎ½4 âŸ¨âŸ¨zx|aj Â· 0âŸ©âŸ©Â· âŸ¨âŸ¨0|zxâŸ©âŸ©
!
Ã—
 Y
jâˆˆZD
jÌ¸=x
DÎ½4 âŸ¨âŸ¨zj|aj(j âˆ’x)âŸ©âŸ©âŸ¨âŸ¨0|zjâŸ©âŸ©
!
|xâŸ©âŸ©âŸ¨âŸ¨a|
= Î½2
ZZZ
a,zâˆˆZD
D
xâˆˆZD
 Y
jâˆˆZD
DÎ½4 âŸ¨âŸ¨zj|aj(j âˆ’x)âŸ©âŸ©âŸ¨âŸ¨0|zjâŸ©âŸ©
!
|xâŸ©âŸ©âŸ¨âŸ¨a|
39

Â· Â· Â· = Î½2
ZZZZ
a,zâˆˆZD
D
u,xâˆˆZD
Y
jâˆˆZD
 
Z
yjâˆˆZD
Ï‰yj
 aj(jâˆ’x) âˆ’zj

âŸ¨âŸ¨0|zjâŸ©âŸ©
!
|xâŸ©âŸ©âŸ¨âŸ¨a|
= Î½2
ZZZZZ
a,y,zâˆˆZD
D
u,xâˆˆZD
 D
O
j=1
Ï‰ajyj(jâˆ’x) Ï‰âˆ’yjzjâŸ¨âŸ¨0|zjâŸ©âŸ©
!
|xâŸ©âŸ©âŸ¨âŸ¨a| .
Corollary (ZH-O): â€˜Orthoâ€™ â€” Using the above equality, together with (ZH-WGC) and the the colour
change rule and the â€œmulticharacter negationâ€ rule, we may obtain:
...
...
+
0
+
1
+
2
+
Dâˆ’1
DÎ½2
â†”
...
...
+
0
-
+
1
-
+
2
-
+
Dâˆ’1
-
Î½âˆ’2
â†”
...
...
+
0
-
+
1
-
+
2
-
+
Dâˆ’1
-
â†”
...
...
+
0
+
1
+
2
+
Dâˆ’1
(ZH-UM):
Unit multiplication.
ï£®
ï£¯ï£¯ï£°
ï£®
ï£¯ï£¯ï£°
+
-
+
-
ï£¹
ï£ºï£ºï£»
ï£¹
ï£ºï£ºï£»
=
""
+
-
DÎ½4
##
On the third-to-last line of the
proof, we use the fact that the
expression is non-zero only for
components in which r âˆˆZD,
two times. First, we use the
fact that only the term where
s = râˆ’1 contributes to the in-
tegral in that case. Then, we
perform the substitution u =
ry, so that sy = u. The par-
ticular value of s then does not
play a role in the integrated
expression, so that we may sim-
ply eliminate s as a variable of
integration.
Proof.
ZZZZZZ
r,s,t,x,y,zâˆˆZD
Ï‰rst Ï‰âˆ’t Ï‰xyz Ï‰âˆ’z âŸ¨âŸ¨r, x|
=
ZZZZ
r,s,x,yâˆˆZD
 
Z
zâˆˆZD
Ï‰t(rsâˆ’1)
! 
Z
zâˆˆZD
Ï‰z(xyâˆ’1)
!
âŸ¨âŸ¨r, x|
=
ZZZZ
r,s,x,yâˆˆZD

DÎ½4 âŸ¨âŸ¨rs|1âŸ©âŸ©

DÎ½4 âŸ¨âŸ¨xy|1âŸ©âŸ©

âŸ¨âŸ¨r, x|
= (DÎ½4)2
ZZZZ
r,s,x,yâˆˆZD
âŸ¨âŸ¨rs|1âŸ©âŸ©âŸ¨âŸ¨rs Â· xy|1âŸ©âŸ©âŸ¨âŸ¨r, x|
= (DÎ½4)2
ZZZZ
r,s,x,yâˆˆZD
âŸ¨âŸ¨rs|1âŸ©âŸ©âŸ¨âŸ¨rx Â· sy|1âŸ©âŸ©âŸ¨âŸ¨r, x|
= DÎ½4
ZZZ
r,x,uâˆˆZD

DÎ½4âŸ¨âŸ¨rx Â· u|1âŸ©âŸ©

âŸ¨âŸ¨r, x|
= DÎ½4
ZZZ
r,x,uâˆˆZD
 
Z
zâˆˆZD
Ï‰z(rxuâˆ’1)
!
âŸ¨âŸ¨r, x|
= DÎ½4
ZZZZ
r,x,u,zâˆˆZD
Ï‰rxu Ï‰âˆ’z âŸ¨âŸ¨r, x| .
This rule corresponds to Ref. [34, Lemma 2.28], which in eï¬€ect relies on the fact that for x, y âˆˆ{0, 1} ,
xy = 1 if and only if x = y = 1. While this observation does not hold in ZD for any D > 2, we may
suitably generalise it by noting that for x, y âˆˆZD, xy is a multiplicative unit if and only if both x and y
are; and that x, y are multiplicative units if and only if there are scalars a, b âˆˆZD such that ax = 1 and
by = 1. Thus, for an input x âˆˆZD, we use a small gadget which tests whether there is any a âˆˆZD for
40

which ax = 1, in place of a small gadget which tests for x = 1.
(End of ZH rewrites.)
*
*
*
In the above, many rewrites involve scalars which are simply integer powers of DÎ½4. In the case that
Î½ = Dâˆ’1/4, these all may be simpliï¬ed by eliminating any scalar boxes which amount to multiplications
by +1. The rules presented in Figure 3 demonstrate rewrites which are sound subject to this value of Î½.
F.3
ZXâ€“ZH relations
Before we proceed with the ZX rewrites, we describe certain relationships which hold between the ZX
and ZH generators in the common semantic map that we have constructed. The reason for doing this
is to take advantage of these relationships to streamline the proving of certain ZX rewrites, which from
their deï¬nitions would be somewhat more laborious to carry out than similar ZH rewrites, owing to the
emphasis placed by the ZH calculus on the standard basis.
(ZXH-GW): Green and white dots.
""
...
...
##
=
""
...
...
##
(Proof: trivial.)
(ZXH-WH): Degree-1 green phase dots and H-boxes.
hh
Î˜
ii
=
hh
Î˜
ii
(Proof: trivial.)
Corollary (ZXH-GP): Green phase dots in ZH â€”
we may show this using (ZX-GF) to be shown below,
Î˜
...
... â†”
...
...
Î˜
(ZXH-GW), and (ZXH-GP).
(ZXH-HP), (ZXH-HM): Hadamard boxes and multicharacters â€” these equalities serve to motivate our
choice, to denote 1 â†’1 multicharacter H-boxes with parameters c = Â±1, by the same symbol as the
quantum Fourier transform (which is to say, the inverse Fourier transform, F â€ ):
Z
x,yâˆˆ[D]
Ï‰xy |yâŸ©âŸ©âŸ¨âŸ¨x| =
Z
x,yâˆˆ[D]
e2Ï€ixy/D |yâŸ©âŸ©âŸ¨âŸ¨x| = F â€ ;
Z
x,yâˆˆ[D]
Ï‰âˆ’xy |yâŸ©âŸ©âŸ¨âŸ¨x| =
Z
x,yâˆˆ[D]
eâˆ’2Ï€ixy/D |yâŸ©âŸ©âŸ¨âŸ¨x| = F.
(109)
(ZXH-RG): Red and gray dots.
""
...
...
##
=
""
...
...
##
Proof:
We proceed by demonstrating the red-green colour change rule for ZX, which suï¬ƒces to relate
the gray and phase-free red nodes. through the equivalence of white and phase-free green nodes. We take
advantage of the fact that |Ï‰xâŸ©= F â€  |xâŸ©.
(F â€ )âŠ—n
"
Z
xâˆˆ[D]
Î˜(x) |xâŸ©âŸ©âŠ—nâŸ¨âŸ¨x|âŠ—m
#
(F â€ )âŠ—m =
Z
xâˆˆ[D]
Î˜(x)

F â€ |xâŸ©âŸ©
âŠ—n
âŸ¨âŸ¨x|F â€ âŠ—m
=
Z
xâˆˆ[D]
Î˜(x)
Ï‰âˆ’xâŠ—nâŸ¨âŸ¨Ï‰x|âŠ—m .
(110)
From this it follows that
""
Î˜
...
...
##
=
ï£®
ï£°
ï£®
ï£°
Î˜
+
+
...
+
+
...
ï£¹
ï£»
ï£¹
ï£»
(111)
so that in particular, when Î˜(x) = 1, we have
""
...
...
##
=
ï£®
ï£°
ï£®
ï£°
+
+
...
+
+
...
ï£¹
ï£»
ï£¹
ï£»=
ï£®
ï£°
ï£®
ï£°
+
+
...
+
+
...
ï£¹
ï£»
ï£¹
ï£»=
ï£®
ï£°
ï£®
ï£°...
...
ï£¹
ï£»
ï£¹
ï£»
(112)
41

(ZXH-RN): Red and generalised not-dots.
""
[c]
##
=
""
c
##
Proof.
Using the amplitude function Ac(t) = Ï„ 2ct = Ï‰ct, which is denoted by [c] in our stabiliser
shorthand for ZX green and red dots, we have:
""
[c]
##
=
""
+
[c]
+
##
=
ï£®
ï£¯ï£¯ï£°
ï£®
ï£¯ï£¯ï£°
+
+
Ac
ï£¹
ï£ºï£ºï£»
ï£¹
ï£ºï£ºï£»=
ï£®
ï£°
ï£®
ï£°
+
+
c
ï£¹
ï£»
ï£¹
ï£»=
""
c
##
(113)
(ZXH-S0), ZXH-S), (ZXH-GH0), (ZXH-GH): Phase scalar ZX gadgets and degree-0 H-boxes.
hh
Î˜
ii
=
hh
Î˜(0)
ii


=
hh
âˆš
D
ii

Î˜
[c]

=

Î˜
[âˆ’c]

=
hh
Î˜(c)
ii
hh
Î˜
ii
=
""
Z
xâˆˆ[D]
Î˜(x)
##
(114)
(Proof: trivial, with the ï¬rst line being a special case of the second in each set.)
(End of ZX-ZH relations.)
*
*
*
F.4
Sound ZX rewrites
We next consider rewrites for the ZX generators, which are sound for a semantic map as considered in
Section E.2, in which we ï¬x Î½ = Dâˆ’1/4. (We will occasionally simplify our proofs using the fact that
F â€ |xâŸ©âŸ©= |Ï‰xâŸ©.)
We are guided in no small part by the rule-set that Booth and Carette [27] set out for odd dimen-
sions D > 1, with some diï¬€erences due to our deï¬nition of red dots, and the fact that we will prefer a
diï¬€erent convention for describing stabiliser phases, broadly following Ref. [50] in taking [a ; b] to denote
a phase-function x 7â†’Ï„ 2ax+bx2 for Ï„ = eÏ€i(D2+1)/D, rather than x 7â†’Ï‰[(D+1)/2][ax+bx2] = Ï„ ax+bx2 as
in Ref. [27],22 (using [a] as shorthand when b = 0). The motivation for the choice of 2ax + bx2 in the
exponent in place of ax+bx2, is to obtain a theory which describes stabiliser phases also when D is even,
and also for which

[1]

= Z ,

[1]

= X ,

[a]

= |aâŸ©âŸ©,

[a]

= |Ï‰aâŸ©âŸ©.
(115)
We note also that the proof techniques of Booth and Carette [27] may be preferable to the ones demon-
strated below in many cases, at least in the case of D an odd prime. This constraint not only is the special
case considered in Ref. [27], but in particular implies that ZD is a ï¬eld, in which every u âˆˆZD \ {0} is
a multiplicative unit. This simpliï¬es the situation with arithmetic substantially, and in particular allows
Ref. [27] to obtain simple normal forms. It is unclear to us how much of those techniques extend to the
more general case of D > 1 arbitrary. Our proof techniques are rather more direct and concrete: the
aim of which is to demonstrate the eï¬€ectiveness (in principle) of analysing operators through discrete
integrals, and also to reduce the amount of technical machinery on which our results depend.
(ZX-GI), (ZX-RI),
(ZX-HI), etc. â€”
Identity rules:


=
""
[c] [c] ##
=

+
-

=

+
+
+
+

=

Î¸

Proof.
These all follow from the relations between the generators described here, and corresponding
ZH generators as described in Section F.3.
22While Ref. [27] does not appear to make explicit use of the conventions of Ref. [50], we may show that Ï„ = Ï‰(D+1)/2,
by observing that Ï„ Â· Ï‰âˆ’(D+1)/2 = exp
 Ï€i(D2 âˆ’D)/D

= (âˆ’1)Dâˆ’1 = +1.
42

(ZX-GF): Green dot fusion.
ï£®
ï£¯ï£¯ï£°
ï£®
ï£¯ï£¯ï£°
Î˜
...
...
Î¦
...
...
ï£¹
ï£ºï£ºï£»
ï£¹
ï£ºï£ºï£»
=
ï£®
ï£°
ï£®
ï£°
Î˜Â·Î¦
...
...
ï£¹
ï£»
ï£¹
ï£»
Proof.
ZZ
x,yâˆˆZD

1âŠ—n âŠ—Î¦(y) |yâŸ©âŸ©âŠ—nâŸ¨âŸ¨y|âŠ—â„“+1
Î˜(x) |xâŸ©âŸ©âŠ—m+1âŸ¨âŸ¨x|âŠ—k âŠ—1âŠ—m
=
ZZ
x,yâˆˆZD
Î˜(x) Î¦(y) |xâŸ©âŸ©âŠ—mâŸ¨âŸ¨x|âŠ—k âŠ—âŸ¨âŸ¨y|xâŸ©âŸ©âŠ—|yâŸ©âŸ©âŠ—nâŸ¨âŸ¨y|âŠ—â„“
=
Z
xâˆˆZD
Î˜(x) Î¦(x) |xâŸ©âŸ©âŠ—mâŸ¨âŸ¨x|âŠ—k âŠ—|xâŸ©âŸ©âŠ—nâŸ¨âŸ¨x|âŠ—â„“
=
Z
xâˆˆZD

Î˜Â·Î¦

(x) |xâŸ©âŸ©âŠ—m+nâŸ¨âŸ¨x|âŠ—k+â„“.
In addition to the proof provided here, this could easily be demonstrated using white dot fusion and
H-box multiplication, using the correspondence to ZH generators as described in Section F.3.
Corollary (ZX-GFP), (ZX-GFS): Green phase fusion rules â€” these are two special cases, presenting
familiar versions of the green dot fusion rule, with additive phases.
Î¸
...
...
Ï†
...
...
â†â†’
Î¸+Ï†
...
...
,
[a1; b1]
...
...
[a2; b2]
...
...
â†â†’
[a1+a2 ;
b1+b2]
...
...
(ZX-RGC):
Red-green colour change.
ï£®
ï£°
ï£®
ï£°
Î˜
+
+
...
+
+
...
ï£¹
ï£»
ï£¹
ï£»
=
""
Î˜
...
...
##
Proof.
(F â€ )âŠ—n
"
Z
xâˆˆZD
Î˜(x) |xâŸ©âŸ©âŠ—nâŸ¨âŸ¨x|âŠ—m
#
(F â€ )âŠ—m
=
Z
xâˆˆZD
Î˜(x)

F â€ |xâŸ©âŸ©
âŠ—n
âŸ¨âŸ¨x|F â€ âŠ—m
=
Z
xâˆˆZD
Î˜(x)
Ï‰âˆ’xâŠ—nâŸ¨âŸ¨Ï‰x|âŠ—m .
(ZX-CPY): Copy rule.
ï£®
ï£°
ï£®
ï£°[a]
...
ï£¹
ï£»
ï£¹
ï£»
=
ï£®
ï£°
ï£®
ï£°
[a]
[a]
...
ï£¹
ï£»
ï£¹
ï£»
Proof.
ZZ
k,yâˆˆZD

|yâŸ©âŸ©âŠ—nâŸ¨âŸ¨y|

Ï„ 2ak |Ï‰âˆ’kâŸ©âŸ©

=
ZZ
x,y,kâˆˆZD

|yâŸ©âŸ©âŠ—nâŸ¨âŸ¨y|

Ï‰ak Ï‰kx |xâŸ©âŸ©

=
Z
xâˆˆZD
|xâŸ©âŸ©âŠ—n Z
kâˆˆZD
Ï‰k(x+a)
=
Z
xâˆˆZD
|xâŸ©âŸ©âŠ—n âŸ¨âŸ¨x|âˆ’aâŸ©âŸ©= |âˆ’aâŸ©âŸ©âŠ—n.
(ZX-PU): Unit phase angle.
hh
Î¸
ii
=
""
##
Proof.
Z
xâˆˆ[D]
eiÎ¸x âŸ¨âŸ¨0|xâŸ©âŸ©= e0 = 1 .
(ZX-SU): Unit stabiliser scalar.

[a ; b]

=
""
##
Proof.
Z
xâˆˆ[D]
Ï„ 2ax+bx2 âŸ¨âŸ¨0|xâŸ©âŸ©= Ï„ 0 = 1 .
43

(ZX-GU):
Gaussian integral unit.
""
[a ; u]
[âˆ’a ; âˆ’u]
##
=
""
##
Proof.
"
Z
xâˆˆ[D]
Ï„ âˆ’2axâˆ’ux2
#"
Z
yâˆˆ[D]
Ï„ 2ay+uy2
#
= Î“(a, u, D)âˆ—Î“(a, u, D) =
Î“(a, u, D)
2 = 1 .
(ZX-Z): Zero scalar rule.
""
Z
##
=
""
Z
##
Proof.
Z
xâˆˆ[D]
Z(x) âŸ¨âŸ¨x| =
Z
xâˆˆ[D]
0 Â· âŸ¨âŸ¨x| = 0â€  =
Z
kâˆˆ[D]
0 Â· âŸ¨âŸ¨Ï‰k| =
Z
kâˆˆ[D]
Z(k) âŸ¨âŸ¨Ï‰k| .
(ZX-ZSP):
Zero stabiliser phase.
hh
[ utâ€² ; t ]
ii
=
hh
Z
ii
Proof.
Z
xâˆˆ[D]
Ï„ 2utâ€²x+tx2 = Î“(utâ€², t, D)
= t Â· Î“(u, t/tâ€², D/tâ€²) = 0 =
Z
xâˆˆ[D]
Z(x) .
(ZX-ZCP):
Zero clock phase.
hh
[ Ëœa ]
ii
=
hh
Z
ii
Proof.
Z
xâˆˆ[D]
Ï„ 2Ëœax = âŸ¨âŸ¨Ëœa|0âŸ©âŸ©= 0 =
Z
xâˆˆ[D]
Z(x) .
This result could likely be subsumed as a special case of (ZX-ZSP), if it were suitably modiï¬ed to
accommodate the case of a stabiliser phase [a, b] in which b is a multiple of D (for D odd) or of 2D (for
D even), and in which a is not a multiple of D.
(ZX-RGB): Red-green bialgebra.
""
...
...
...
...
##
...
...

Proof.
This follows from the correspondence between green and white dots, and between red and gray
dots, shown in Section F.3.
(ZX-NS): Not-dot symmetry.
ï£®
ï£¯ï£°
ï£®
ï£¯ï£°
Î¸
Â¬
Â¬
...
Â¬
Â¬
...
ï£¹
ï£ºï£»
ï£¹
ï£ºï£»=
ï£®
ï£¯ï£¯ï£°
ï£®
ï£¯ï£¯ï£°
âˆ’Î¸
...
...
ÏƒÎ¸
[1]
ï£¹
ï£ºï£ºï£»
ï£¹
ï£ºï£ºï£»
Proof.
We may show this using (ZXH-GP), (ZXH-RN), and (ZH-NS):
Î¸
Â¬
Â¬
...
Â¬
Â¬
...
â†”
Â¬
Â¬
...
Â¬
Â¬
...
eiÎ¸
â†”
...
...
eiÎ¸
Â¬
â†”
...
...
eâˆ’iÎ¸
eiÎ¸Ïƒ
(116)
Applying (ZXH-S) for Î˜(x) = eiÏƒx for the scalar gadget, and (ZXH-GP) again for the H-box with ampli-
tude eâˆ’iÎ¸, we then have
Î¸
Â¬
Â¬
...
Â¬
Â¬
...
â†”
...
...
eâˆ’iÎ¸
eiÎ¸Ïƒ
â†”
âˆ’Î¸
...
...
ÏƒÎ¸
[1]
(117)
44

(ZX-RS): Red shear rule.

[c] [a ; b] [c]

=
ï£®
ï£¯ï£°
ï£®
ï£¯ï£°
[aâˆ’bc ; b]
[c]
[a ; b]
ï£¹
ï£ºï£»
ï£¹
ï£ºï£»
Proof.
ZZZ
x,y,zâˆˆ[D]

Ï„ 2cz |zâŸ©âŸ©âŸ¨âŸ¨z|

Ï„ 2ax+bx2 |Ï‰âˆ’xâŸ©âŸ©âŸ¨âŸ¨Ï‰x|

Ï„ 2cy |yâŸ©âŸ©âŸ¨âŸ¨y|

=
Z
xâˆˆ[D]
Ï„ 2ax+bx2
"
Z
zâˆˆ[D]
Ï„ 2cz Ï‰xz |zâŸ©âŸ©
#"
Z
yâˆˆ[D]
Ï„ 2cy Ï‰xy âŸ¨âŸ¨y|
#
=
Z
xâˆˆ[D]
Ï„ 2ax+bx2
"
Z
zâˆˆ[D]
Ï‰z(x+c) |zâŸ©âŸ©
#"
Z
yâˆˆ[D]
Ï‰y(x+c) âŸ¨âŸ¨y|
#
=
Z
xâˆˆ[D]
Ï„ 2ax+bx2 |Ï‰âˆ’(x+c)âŸ©âŸ©âŸ¨âŸ¨Ï‰x+c|
=
Z
xâˆˆ[D]
Ï„ 2axâˆ’2ac+bx2âˆ’2bcx+bc2 |Ï‰âˆ’xâŸ©âŸ©âŸ¨âŸ¨Ï‰x|
= Ï„ 2a(âˆ’c)+b(âˆ’c)2Z
xâˆˆ[D]
Ï„ 2(aâˆ’bc)x+bx2 |Ï‰âˆ’xâŸ©âŸ©âŸ¨âŸ¨Ï‰x| .
(ZH-MH):
Multiplier-Hadamard rule.
ï£®
ï£¯ï£°
ï£®
ï£¯ï£°
...
ï£¼
ï£½
ï£¾u
ï£¹
ï£ºï£»
ï£¹
ï£ºï£»
=
ï£®
ï£¯ï£°
ï£®
ï£¯ï£°
[0 ; u]
[0 ; uâˆ’1]
[0 ; u]
+
[0 ; âˆ’u]
ï£¹
ï£ºï£»
ï£¹
ï£ºï£»
In this instance, we prove the
equality in reverse (by demon-
strating that the semantics of
the second diagram, is equal
to the semantics of the ï¬rst).
In the proof on the right, we
introduce the scalar constant
Î³u = Î“(0,âˆ’u,D) =
R
x Ï„ âˆ’ux2 =

[0 ; âˆ’u] 
. By Eqn. (100),
we have |Î³u| = 1, and in par-
ticular Î³âˆ’1
u
= Î³âˆ—
u =
R
x Ï„ ux2.
Proof.
Î³u
ZZZZ
w,x,y,zâˆˆ[D]
Ï„ uw2 Ï„ uâˆ’1x2 Ï„ uy2 Ï‰yz |zâŸ©âŸ©âŸ¨âŸ¨y|Ï‰âˆ’xâŸ©âŸ©âŸ¨âŸ¨Ï‰x |wâŸ©âŸ©âŸ¨âŸ¨w|
= Î³u
ZZZZ
w,x,y,zâˆˆ[D]
Ï„ uw2 Ï„ uâˆ’1x2 Ï„ uy2 Ï‰yz Ï‰xy Ï‰wx |zâŸ©âŸ©âŸ¨âŸ¨w|
= Î³u
ZZZZ
w,x,y,zâˆˆ[D]
Ï„ uw2 Ï„ ux2 Ï„ uy2 Ï‰yz Ï‰uxyÏ‰uwx |zâŸ©âŸ©âŸ¨âŸ¨w|
= Î³u
ZZZZ
w,x,y,zâˆˆ[D]
Ï„ uw2 Ï„ u(x+y)2 Ï‰uwx+yz |zâŸ©âŸ©âŸ¨âŸ¨w|
= Î³u
ZZZZ
w,x,y,zâˆˆ[D]
Ï„ uw2 Ï„ ux2 Ï‰uwxâˆ’uwy+yz |zâŸ©âŸ©âŸ¨âŸ¨w|
= Î³u
ZZZ
w,x,zâˆˆ[D]
 
Z
yâˆˆ[D]
Ï‰y(zâˆ’uw)
!
Ï„ u(x+w)2 |zâŸ©âŸ©âŸ¨âŸ¨w|
= Î³u
ZZZ
w,x,zâˆˆ[D]
âŸ¨âŸ¨z âˆ’uw|0âŸ©âŸ©Ï„ ux2 |zâŸ©âŸ©âŸ¨âŸ¨w|
=
"
Î³u
Z
xâˆˆ[D]
Ï„ ux2
#"
ZZ
w,zâˆˆ[D]
âŸ¨âŸ¨z âˆ’uw|0âŸ©âŸ©|zâŸ©âŸ©âŸ¨âŸ¨w|
#
=
ZZZ
w,y,zâˆˆ[D]
|zâŸ©âŸ©

âŸ¨âŸ¨z + y|0âŸ©âŸ©


y +
uP
j=1
w
|0

âŸ¨âŸ¨w|
=
ZZZZ
tâˆˆ[D]u
w,y,zâˆˆ[D]
|zâŸ©âŸ©

âŸ¨âŸ¨z + y|0âŸ©âŸ©


y +
uP
j=1
tj
|0

âŸ¨âŸ¨t|

|wâŸ©âŸ©âŠ—uâŸ¨âŸ¨w|

.
45

(ZX-ME):
Multiplier elimination.
ï£®
ï£¯ï£°
ï£®
ï£¯ï£°
[a, b]
...
ï£¼
ï£½
ï£¾u
ï£¹
ï£ºï£»
ï£¹
ï£ºï£»
=
hh
[âˆ’auâˆ’1; buâˆ’2]
ii
Proof.
ZZZZ
tâˆˆ[D]u
w,y,zâˆˆ[D]

Ï„ 2az+bz2âŸ¨âŸ¨Ï‰z|yâŸ©âŸ©


y +
uP
j=1
tj
|0

âŸ¨âŸ¨t|

|wâŸ©âŸ©âŠ—uâŸ¨âŸ¨w|

=
ZZZ
w,y,zâˆˆ[D]

Ï„ 2az+bz2Ï‰zy

âŸ¨âŸ¨y + uw|0âŸ©âŸ©âŸ¨âŸ¨w|
=
ZZ
w,zâˆˆ[D]

Ï„ 2az+bz2Ï‰âˆ’zuw

âŸ¨âŸ¨w|
=
Z
zâˆˆ[D]
Ï„ âˆ’2auâ€“1z + buâ€“2z2
"
Z
wâˆˆ[D]
Ï‰wzâŸ¨âŸ¨w|
#
=
Z
zâˆˆ[D]
Ï„ âˆ’2auâ€“1z + buâ€“2z2âŸ¨âŸ¨Ï‰z| .
(ZX-MEH): Multi-edge Hopf Law.
ï£®
ï£¯ï£°
ï£®
ï£¯ï£°
...
ï£¼
ï£½
ï£¾D
ï£¹
ï£ºï£»
ï£¹
ï£ºï£»=
hh
ii
Proof.
This follows from (ZH-MH), (ZXH-GW), and (ZXH-RG).
(ZX-A): Antipode Law.


=
hh
ii
Proof.
This follows from (ZXH-GW), (ZXH-RG), and (ZH-A).
(End of ZX rewrites.)
*
*
*
46

