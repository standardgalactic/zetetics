more information  - www.cambridge.org/9781107005525


Computational Photonics
A comprehensive manual on the efﬁcient modelling and analysis of photonic devices
through building numerical codes, this book provides graduate students and researchers
with the theoretical background and MATLAB programs necessary for them to start their
own numerical experiments.
Beginning by summarizing topics in optics and electromagnetism, the book discusses
optical planar waveguides, linear optical ﬁbres, the propagation of linear pulses, laser
diodes, optical ampliﬁers, optical receivers, the ﬁnite-difference time-domain method, the
beam propagation method and some wavelength division devices, solitons, solar cells and
metamaterials.
Assuming only a basic knowledge of physics and numerical methods, the book is ideal for
engineers, physicists and practicing scientists. It concentrates on the operating principles
of optical devices, as well as the models and numerical methods used to describe them.
Marek S. Wartak is a Professor in the Department of Physics and Computer Science, Wilfrid
Laurier University, Waterloo, Ontario. He has over 25 years of experience in semiconductor
physics, photonics and optoelectronics, analytical methods, modelling and computer-aided
design tools.


Computational Photonics
An Introduction with MATLAB
MAREK S. WARTAK
Wilfrid Laurier University

C A M B R I D G E U N I V E R S I T Y P R E S S
Cambridge, New York, Melbourne, Madrid, Cape Town,
Singapore, S˜ao Paulo, Delhi, Mexico City
Cambridge University Press
The Edinburgh Building, Cambridge CB2 8RU, UK
Published in the United States of America by Cambridge University Press, New York
www.cambridge.org
Information on this title: www.cambridge.org/9781107005525
C⃝M. S. Wartak 2013
This publication is in copyright. Subject to statutory exception
and to the provisions of relevant collective licensing agreements,
no reproduction of any part may take place without the written
permission of Cambridge University Press.
First published 2013
Printed and bound in the United Kingdom by the MPG Books Group
A catalogue record for this publication is available from the British Library
Library of Congress Cataloguing in Publication data
Wartak, Marek S., author.
Computational photonics : an introduction with MATLAB / Marek S. Wartak,
Department of Physics and Computer Science, Wilfrid Laurier University,
Waterloo, Ontario, Canada.
pages
cm
Includes bibliographical references and index.
ISBN 978-1-107-00552-5 (hardback)
1. Optoelectronic devices – Mathematical models.
2. Photonics – Mathematics.
3. MATLAB.
I. Title.
TK8304.W37
2012
621.3815′2 – dc23
2012037576
ISBN 978-1-107-00552-5 Hardback
Cambridge University Press has no responsibility for the persistence or
accuracy of URLs for external or third-party internet websites referred to
in this publication, and does not guarantee that any content on such
websites is, or will remain, accurate or appropriate.

Contents
Preface
page xi
1 Introduction
1
1.1
What is photonics?
1
1.2
What is computational photonics?
2
1.3
Optical ﬁbre communication
5
1.4
Biological and medical photonics
12
1.5
Photonic sensors
12
1.6
Silicon photonics
13
1.7
Photonic quantum information science
14
References
14
2 Basic facts about optics
17
2.1
Geometrical optics
17
2.2
Wave optics
21
2.3
Problems
30
Appendix 2A: MATLAB listings
31
References
34
3 Basic facts from electromagnetism
35
3.1
Maxwell’s equations
35
3.2
Boundary conditions
36
3.3
Wave equation
38
3.4
Time-harmonic ﬁelds
39
3.5
Polarized waves
42
3.6
Fresnel coefﬁcients and phases
44
3.7
Polarization by reﬂection from dielectric surfaces
48
3.8
Antireﬂection coating
50
3.9
Bragg mirrors
53
3.10
Goos-H¨anchen shift
58
3.11
Poynting theorem
59
3.12
Problems
60
3.13
Project
60
Appendix 3A: MATLAB listings
61
References
63
v

vi
Contents
4 Slab waveguides
64
4.1
Ray optics of the slab waveguide
64
4.2
Fundamentals of EM theory of dielectric waveguides
69
4.3
Wave equation for a planar wide waveguide
71
4.4
Three-layer symmetrical guiding structure (TE modes)
72
4.5
Modes of the arbitrary three-layer asymmetric planar waveguide in 1D
75
4.6
Multilayer slab waveguides: 1D approach
79
4.7
Examples: 1D approach
85
4.8
Two-dimensional (2D) structures
88
4.9
Problems
92
4.10
Projects
92
Appendix 4A: MATLAB listings
93
References
104
5 Linear optical fibre and signal degradation
106
5.1
Geometrical-optics description
106
5.2
Fibre modes in cylindrical coordinates
110
5.3
Dispersion
123
5.4
Pulse dispersion during propagation
127
5.5
Problems
128
5.6
Projects
129
Appendix 5A: Some properties of Bessel functions
129
Appendix 5B: Characteristic determinant
130
Appendix 5C: MATLAB listings
131
References
137
6 Propagation of linear pulses
138
6.1
Basic pulses
138
6.2
Modulation of a semiconductor laser
143
6.3
Simple derivation of the pulse propagation equation in the presence of
dispersion
146
6.4
Mathematical theory of linear pulses
148
6.5
Propagation of pulses
152
6.6
Problems
155
Appendix 6A: MATLAB listings
156
References
165
7 Optical sources
167
7.1
Overview of lasers
167
7.2
Semiconductor lasers
172
7.3
Rate equations
181
7.4
Analysis based on rate equations
187
7.5
Problems
196
7.6
Project
196

vii
Contents
Appendix 7A: MATLAB listings
196
References
202
8 Optical amplifiers and EDFA
204
8.1
General properties
205
8.2
Erbium-doped ﬁbre ampliﬁers (EDFA)
209
8.3
Gain characteristics of erbium-doped ﬁbre ampliﬁers
213
8.4
Problems
215
8.5
Projects
215
Appendix 8A: MATLAB listings
215
References
222
9 Semiconductor optical amplifiers (SOA)
223
9.1
General discussion
223
9.2
SOA rate equations for pulse propagation
228
9.3
Design of SOA
231
9.4
Some applications of SOA
233
9.5
Problem
236
9.6
Project
236
Appendix 9A: MATLAB listings
236
References
238
10 Optical receivers
240
10.1
Main characteristics
241
10.2
Photodetectors
242
10.3
Receiver analysis
251
10.4
Modelling of a photoelectric receiver
257
10.5
Problems
258
10.6
Projects
258
Appendix 10A: MATLAB listings
258
References
260
11 Finite difference time domain (FDTD) formulation
262
11.1
General formulation
262
11.2
One-dimensional Yee implementation without dispersion
266
11.3
Boundary conditions in 1D
272
11.4
Two-dimensional Yee implementation without dispersion
275
11.5
Absorbing boundary conditions (ABC) in 2D
277
11.6
Dispersion
280
11.7
Problems
280
11.8
Projects
281
Appendix 11A: MATLAB listings
281
References
286

viii
Contents
12 Beam propagation method (BPM)
288
12.1
Paraxial formulation
288
12.2
General theory
292
12.3
The 1 + 1 dimensional FD-BPM formulation
299
12.4
Concluding remarks
306
12.5
Problems
307
12.6
Project
308
Appendix 12A: Details of derivation of the FD-BPM equation
308
Appendix 12B: MATLAB listings
310
References
314
13 Some wavelength division multiplexing (WDM) devices
316
13.1
Basics of WDM systems
316
13.2
Basic WDM technologies
317
13.3
Applications of BPM to photonic devices
323
13.4
Projects
325
Appendix 13A: MATLAB listings
325
References
329
14 Optical link
331
14.1
Optical communication system
331
14.2
Design of optical link
333
14.3
Measures of link performance
336
14.4
Optical ﬁbre as a linear system
338
14.5
Model of optical link based on ﬁlter functions
340
14.6
Problems
344
14.7
Projects
344
Appendix 14A: MATLAB listings
345
References
348
15 Optical solitons
351
15.1
Nonlinear optical susceptibility
351
15.2
Main nonlinear effects
352
15.3
Derivation of the nonlinear Schr¨odinger equation
353
15.4
Split-step Fourier method
357
15.5
Numerical results
361
15.6
A few comments about soliton-based communications
364
15.7
Problems
364
Appendix 15A: MATLAB listings
365
References
366
16 Solar cells
368
16.1
Introduction
368
16.2
Principles of photovoltaics
370

ix
Contents
16.3
Equivalent circuit of solar cells
373
16.4
Multijunctions
376
Appendix 16A: MATLAB listings
379
References
381
17 Metamaterials
384
17.1
Introduction
384
17.2
Veselago approach
388
17.3
How to create metamaterial?
389
17.4
Some applications of metamaterials
395
17.5
Metamaterials with an active element
400
17.6
Annotated bibliography
401
Appendix 17A: MATLAB listings
401
References
403
Appendix A Basic MATLAB
406
A.1
Working session with m-ﬁles
407
A.2
Basic rules
409
A.3
Some rules about good programming in MATLAB
410
A.4
Basic graphics
412
A.5
Basic input-output
416
A.6
Numerical differentiation
417
A.7
Review questions
418
References
418
Appendix B Summary of basic numerical methods
420
B.1
One-variable Newton’s method
420
B.2
Muller’s method
422
B.3
Numerical differentiation
425
B.4
Runge-Kutta (RK) methods
432
B.5
Solving differential equations
433
B.6
Numerical integration
435
B.7
Symbolic integration in MATLAB
438
B.8
Fourier series
438
B.9
Fourier transform
441
B.10
FFT in MATLAB
443
B.11
Problems
446
References
446
Index
448


Preface
Photonics (also known as optoelectronics) is the technology of creation, transmission,
detection, control and applications of light. It has many applications in various areas of
science and engineering ﬁelds. Fibre optic communication is an important part of photonics.
It uses light particles (photons) to carry information over optical ﬁbre.
In the last 20 years we have witnessed the signiﬁcant (and increasing) presence of photon-
ics in our everyday life. The creation of the Internet and World Wide Web was possible due
to tremendous technical progress created by photonics, development of photonic devices,
improvement of optical ﬁbre, wavelength division multiplexing (WDM) techniques, etc.
The phenomenal growth of the Internet owes a lot to the ﬁeld of photonics and photonic
devices in particular.
This book serves as an attempt to introduce graduate students and senior undergraduates
to the issues of computational photonics. The main motivation for developing an approach
described in the present book was to establish the foundations needed to understand prin-
ciples and devices behind photonics.
In this book we advocate a simulation-type approach to teach fundamentals of photonics.
We provide a self-contained development which includes theoretical foundations and also
the MATLAB code aimed at detailed simulations of real-life devices.
We emphasize the following characteristics of our very practical book:
• learning through computer simulations
• writing and analysing computer code always gives good sense of the values of all param-
eters
• our aim was to provide complete theoretical background with only basic knowledge
assumed
• the book is self-contained in a sense that it starts from a very basic knowledge and ends
with the discussion of several hot topics.
The author believes that one can learn a lot by studying not only a theory but also by
performing numerical simulations (numerical experiments) using commercial software or
developed in-house. Here, we adopt a view that the best way will be to develop a software
ourselves (as opposed to commercial). Also there is one more component in the learning
process, namely real-life experimentation. That part is outside the scope of the present
book.
The goal was to equip students with solid foundations and underlying principles by
providing a theoretical background and also by applying that theory to create simple
programs in MATLAB which illustrate theoretical concepts and which allow students to
conduct their own numerical experiments in order to get better understanding.
xi

xii
Preface
Alternatively, students can also use octave (www.octave.org) to run and to conduct
numerical experiments using programs developed and distributed with this book. At the
end, they can try to develop large computer programs by combining learned ideas. At this
stage, I would like to remind the reader that according to Donald Knuth (cited in Computer
Algebra Handbook, J. Grabmeier, E. Kaltofen and V. Weispfenning, eds., Springer, 2003)
the tasks of increasing difﬁculty are:
i) publishing a paper
ii) publishing a book
iii) writing a large computer program.
The book has evolved from the lecture notes delivered in the Department of Electrical
Engineering, University of Oulu, Finland, Institute of Physics, Wroclaw University of
Technology and Department of Physics and Computer Science, Wilfrid Laurier University,
Waterloo, Canada.
The book has been designed to serve a 12-week-long term with several extra chapters
which allow the instructor more ﬂexibility in choosing the material. An important part of
the book is the MATLAB code provided to solve problems. Students can modify it and
experiment with different parameters to see for themselves the role played by different
factors. This is a very valuable element of the learning process.
The book also contains a small number of solved problems (labelled as Examples) which
are intended to serve as a practical illustration of discussed topics. At the end of each
chapter there is a number of problems intended to test the student’s understanding of the
material.
The book may serve as a reference for engineers, physicists, practising scientists and
other professionals. It concentrates on operating principles of optical devices, as well as their
models and numerical methods used for description. The covered material includes ﬁbre,
planar waveguides, laser diodes, detectors, optical ampliﬁers and semiconductor optical
ampliﬁers, receivers, beam propagation method, some wavelength division devices, ﬁnite-
difference time-domain method, linear and nonlinear pulses, solar cells and metamaterials.
The book can also be used as a textbook as it contains questions, problems (both solved
and unsolved), working examples and projects. It can be used as a teaching aid at both under-
graduate and graduate levels as a one-semester course in physics and electrical engineering
departments.
The book contains 17 chapters plus two appendices. The ﬁrst two chapters summarize
basic topics in optics and electromagnetism. The book also contains a signiﬁcant number
of software exercises written in MATLAB, designed to enhance and help understanding the
discussed topics. Many proposed projects have been designed with a view to implement
them in MATLAB.
Some numerical methods as well as important practical devices were not considered.
Those developments will be included in the second edition. The author would like to wish
a potential reader the similar joy of reading the book and experimenting with programs as
he had with writing it.
Finally, I welcome all type of comments from readers, especially concerning errors,
inaccuracies and omissions. Please send your comments to mwartak@wlu.ca.

xiii
Preface
Requirements I do not assume any particular knowledge since I tried to cover all basic
topics. Some previous exposure to optics and electromagnetic theory will be helpful.
Acknowledgements Thanks are due to Professors Harri Kopola and Risto Myllyla
(University of Oulu) and Professor Jan Misiewicz (Wroclaw University of Technology) for
arranging delivery of lectures. I wish also to thank my former students in Finland, Poland
and Canada for comments on various parts of lecture notes. I am grateful to my wife for
reading the whole manuscript and Dr Jacek Miloszewski for preparing the index and ﬁgure
for the cover.
My special thank you goes to people at Cambridge, especially Dr Simon Capelin and
Mrs Antoaneta Ouzounova for their patience and good advice, and Lynette James for her
excellent work.
The book support grant from the Research Ofﬁce of Wilfrid Laurier University is ac-
knowledged. Support for my research from various Canadian organizations including fed-
eral NSERC as well as from province of Ontario is gratefully acknowledged.
I dedicate this book to my family.


1
Introduction
In this introductory chapter we will try to deﬁne computational photonics and to position it
within a broad ﬁeld of photonics. We will brieﬂy summarize several subﬁelds of photonics
(with the main emphasis on optical ﬁbre communication) to indicate potential possibilities
where computational photonics can signiﬁcantly contribute by reducing cost of designing
new devices and speeding up their development.
1.1 What is photonics?
We start our discussion from a broader perspective by articulating what photonics is, what
the current activities are and where one can get the most recent information.
Photonics is the ﬁeld which involves electromagnetic energy, such as light, where the
fundamental object is a photon. In some sense, photonics is parallel to electronics which
involves electrons. Photonics is often referred to as optoelectronics, or as electro-optics to
indicate that both ﬁelds have a lot in common. In fact, there is a lot of interplay of photonics
and electronics. For example, a laser is driven by electricity to produce light or to modulate
that light to transmit data.
Photonics applications use the photon in a similar way to that which electronic applica-
tions use the electron. However, there are several advantages of optical transmission of data
over electrical. Furthermore, photons do not interact between themselves (which is both
good and bad), so electromagnetic beams can pass through each other without interacting
and/or causing interference.
Even with the telecommunication ‘bubble’ which happened some ten years ago, the
subﬁeld of photonics, namely optical ﬁbre communication, is still a very important segment
of photonics activities. As an example, a single optical ﬁbre has the capacity to carry about
3 million telephone calls simultaneously. But, due to a crisis around 2000, many new
applications of photonics have emerged or got noticed. Bio-photonics or medical photonics
are amongst the most important ones.
Before we try to deﬁne computational photonics, let us concentrate for a moment on
what photonics is at the time of writing (Winter, 2011). In the following paragraphs, we
cite some information from the relevant conferences.
Some of the well-established conferences which summarize research and applications
in a more traditional approach to photonics, and also dictate new directions are: Photonics
West, held every January in California (here is the 2011 information [1]); Photonics East,
1

2
Introduction
taking place in the eastern part of the USA in the Fall; Optical Fibre Conference (OFC)
taking place in March every year [2].
A new conference, the Photonics Global Conference (PGC), is a biennial event held
since 2008 [3]. The aim of this conference is to foster interactions among broad disciplines
in photonics with concentration on emerging directions. Symposia and Special Sessions
for 2011 are summarized below:
• Symposia: 1. Optoﬂuidics and Biophotonics. 2. Fibre-Based Devices and Applications.
3. Green Photonics. 4. High-Power Lasers and Their Industrial Applications. 5. Metama-
terials and Plasmonics. 6. Nanophotonics. 7. Optical Communications and Networks.
• Special Sessions: 1. Quantum Communications. 2. Photonics Crystal Fibres and Their
Applications. 3. Photonics Applications of Carbon Nanotube and Graphene. 4. Terahertz
Technology. 5. Diffuse Optical Imaging.
By looking at the discussed topics, one can get some sense about current activities in
photonics.
1.2 What is computational photonics?
Computational photonics is a branch of physics which uses numerical methods to study
properties and propagation of light in waveguiding structures. (Here, light is used in a broad
sense as a replacement for electromagnetic waves.) Within this ﬁeld, an important part is
played by studies of the behaviour of light and light-matter interactions using analytical
and computational models. This emerging ﬁeld of computational science is playing a
critically important role in designing new generations of integrated optics modules, long
haul transmission and telecommunication systems.
Generally, computational photonics is understood as the ‘replacement’ of the experimen-
tal method, where one is performing all the relevant ‘experiments’ on computer. Obviously,
such an approach reduces development cost and speeds-up development of new products.
We will attempt to cover some of those developments. The ﬁeld is, however, so broad
that it is impossible to review all of its activities. Naturally, selection of the topics reﬂects
author’s expertise.
As a separate topic in photonics, one selects integrated photonics where the concentration
is on waveguides, simulations of waveguide modes and photonic structures [4]. The central
role is played there by a beam-propagation method which will be discussed later in the
book.
1.2.1 Methods of computational photonics. Computational electromagnetics
According to Joannopoulos et al. [5], in a broad sense there are three categories of problems
in computational photonics: frequency-domain eigensolvers, frequency-domain solvers
and time-domain simulations. Those problems are extensively discussed in many sources
including [5], also [6] and [7].

3
What is computational photonics?
A recent general article by Gallagher [8] gives an introduction to the main algorithms
used in photonic computer aided design (CAD) modelling along with discussion of their
strengths and weaknesses. The main algorithms are:
• BPM – Beam Propagation Method
• EME – Eigenmode Expansion Methods
• FDTD – Finite Difference Time Domain.
The above methods are compared against speed, memory usage, numerical aperture, the
refractive index contrasts in the device, polarization, losses, reﬂections and nonlinearity.
The author’s conclusion is that none of the discussed algorithms are universally perfect for
all applications.
We ﬁnish this section by indicating that application of computational electromagnetics
goes well beyond photonics, see the discussion by Jin [6]. In fact it has an extremely wide
range of applications which goes from the analysis of electromagnetic wave scattering
by various objects, antenna analysis and design, modelling and simulation of microwave
devices, to numerical analysis of electromagnetic interference and electromagnetic com-
patibility.
1.2.2 Computational nano-photonics
This subﬁeld has emerged only in recent years. As the dimensions of photonics devices
shrink, it plays an increasingly important role. Nanostructures are generally considered
as having sizes in the order of the wavelength of light. At those wavelengths, multiple
scattering and near-ﬁeld effects have a profound inﬂuence on the propagation of light and
light-matter interaction. In turn, this leads to novel regimes for basic research as well as
novel applications in various disciplines.
For instance, the modiﬁed dispersion relation of photonic crystals and photonic crystal
ﬁbres leads to novel nonlinear wave propagation effects such as giant soliton shifts and su-
percontinuum generation with applications in telecommunication, metrology and medical
diagnostics. Owing to the complex nature of wave interference and interaction processes,
experimental studies rely heavily on theoretical guidance both for the design of such sys-
tems as well as for the interpretation of measurements. In almost all cases, a quantitative
theoretical description of such systems has to be based on advanced computational tech-
niques that solve the corresponding numerically very large linear, nonlinear or coupled
partial differential equations.
University research on photonic crystal structures applied to novel components in optical
communication, boomed since it has become possible to create structures on the nanometre
scale. Nanotechnology offers a potential for more efﬁcient integrated optical circuitry at
lower cost – from passive elements like ﬁlters and equalizers to active functions such as
optical switching, interconnects and even novel lasers. In addition, the technology can
provide new functionality and reduce overall optical communication cost thanks to smaller
devices, higher bandwidth and low loss device characteristics that eliminate the need for
ampliﬁcation. The ultimate goal is to create three-dimensional photonic structures that may
lead to progressively optical and one day all-optical computing.

4
Introduction
A very recent overview on modelling in photonics, including discussion of important
computational methods, was written by Obayya [9].
1.2.3 Overview of commercial software for photonics
An outstanding progress in photonics has been to a great extent possible due to the avail-
ability of reliable software. Some of the main commercial players are listed below:
1. At the time of writing, Optiwave (www.optiwave.com) provides comprehensive engi-
neering design tools which beneﬁt photonic, bio-photonic and system design engineers
with a comprehensive design environment. Current Optiwave products include two
groups: system and ampliﬁer design, and component design.
For system and ampliﬁer design they offer two packages:
• OptiSystem – suite for design of ampliﬁer and optical communication systems.
• OptiSPICE – the ﬁrst optoelectronic circuit design software.
For component design, they have the following products:
• OptiBPM, based on the beam propagation method (BPM), offers design of complex
optical waveguides which perform guiding, coupling, switching, splitting, multiplex-
ing and demultiplexing of optical signals in photonic devices.
• OptiFDTD, which is based on the ﬁnite-difference time-domain (FDTD) algorithm
with second-order numerical accuracy and the most advanced boundary condition,
namely uniaxial perfectly matched layer. Solutions for both electric and magnetic
ﬁelds in temporal and spatial domain are obtained using the full-vector differential
form of Maxwell’s equations.
• OptiFiber, which uses numerical mode solvers and other models specialized to ﬁbres
for calculating dispersion, losses, birefringence and polarization mode dispersion
(PMD).
• OptiGrating, which uses the coupled mode theory to model the light and enable
analysis and synthesis of gratings.
2. RSoft (www.rsoftdesign.com) product family includes:
• Component Design Suite to analyse complex photonic devices and components
through industry-leading computer-aided design,
• System Simulation to determine the performance of optical telecom and datacom
links through comprehensive simulation techniques and component models, and
• Network Modeling for cost-effective deployment of DWDM and SONET technologies
while designing and optimizing an optical network.
3. Photon Design (www.photond.com)
They offer several products for both passive and active component design, such as
FIMMWAVE and CrystalWave.
FIMMWAVE is a generic full-vectorial mode ﬁnder for waveguide structures. It com-
bines methods based on semi-analytical techniques with other more numerical methods
such as ﬁnite difference or ﬁnite element.
FIMMWAVE comes with a range of user-friendly visual tools for designing
waveguides, each optimized for a different geometry: rectangular geometries often

5
Optical fibre communication
encountered in epitaxially grown integrated optics, circular geometries for the design
of ﬁbre waveguides, and more general geometries to cover, e.g. diffused waveguides or
other unusual structures.
CrystalWave is a design environment for the layout and design of integrated optics
components optimized for the design of photonic crystal structures. It is based on both
FDTD and ﬁnite-element frequency-domain (FEFD) simulators and includes a mask ﬁle
generator optimized for planar photonic crystal structures.
4. CST MICROWAVE STUDIO (www.cst.com/Content/Products/MWS/Overview.aspx)
is a specialist tool for the 3D electromagnetic simulation of high frequency components.
It enables the fast and accurate analysis of high frequency devices such as antennas,
ﬁlters, couplers, planar and multi-layer structures.
There are several web resources devoted to photonics software and numerical modelling
in photonics. We mention the following: Optical Waveguides: Numerical Modeling Website
[10], Photonics resources page [11] and Photonics software [12].
1.3 Optical fibre communication
In this section we will outline the important role played by photonics in the communication
over an optical ﬁbre. Other sub-ﬁelds will be summarized in due course.
1.3.1 Short story of optical fibre communication
Light was used as a mean for communication probably since the origin of our civilization.
Its modern applications in telecommunication, as developed in the twentieth century, can
be traced to two main facts:
• availability of good optical ﬁbre, and
• compact and reliable light sources.
Later in this section, we will discuss main developments in some detail. We start with
a short history of communication with the emphasis on light communication. A recent
popular history of ﬁbre optics written for a broad audience was published by Hecht [13].
As an introductory work we recommend simple introduction to fundamentals of digital
communications by Bateman [14].
1.3.2 Short history of communication
After discovery of electromagnetic waves due to work by Marconi, Tesla and many others,
the radio was created operating in the 0.5–2 MHz frequency range with a bandwidth of
15 kHz. With the appearance of television which required bandwidth of about 6 MHz,
the carrier frequencies moved to around 100 MHz. During the Second World War the

6
Introduction
Laser drive
circuitry
Amplifier and
signal processing
Transmitter
Channel
Receiver
Optical fibre
Laser
Photodetector
Fig. 1.1
Block diagram of a fibre system.
invention of radar pushed the frequencies to the microwave region (around GHz). Those
frequencies (range of 2.4–5 GHz) are now actively used by cell phones as well as wireless
links.
The big step toward higher frequencies was made possible in the 1960s with the invention
of laser. The ﬁrst one operated at the 694 nm wavelength. This corresponds to carrier
frequency of approximately 5 × 1014 Hz (5 × 105 GHz = 500 THz). Utilization of only
1% of that frequency represents a signal channel of about 5 THz which can accommodate
approximately 106 analogue video channels, each with 6 MHz bandwidth or 109 telephone
calls at 5 kHz per call.
A typical communication channel which links two points, point-to-point link (as an
example, see Fig. 1.1 for a generic ﬁbre optics link), consists of an optical transmitter
which is usually a semiconductor laser diode, an optical ﬁbre intended to carry light beam
and a receiver. A semiconductor laser diode can be directly modulated or an external
modulator is used which produces modulated light beam which propagates in the optical
ﬁbre. Information is imposed into optical pulses. Then the light is input into the optical
ﬁbre where it propagates over some distance, and then it is converted into a signal which a
human can understand.
All of those elements should operate efﬁciently at the corresponding carrier’s frequencies
(or wavelengths). In the 1960s only one element was in place: a transmitter (laser). The
other two elements were nonexistent.
The next main step was proposed in 1966 by Charles Kao and George Hockham [15] who
demonstrated the ﬁrst silica-based optical ﬁbre with sufﬁciently low enough propagation
loss to enable its use as a communication medium. Soon, silica-based optical ﬁbre became
the preferred means of transmission in both long- and short-haul telecommunication net-
works. An all-optical network has the potential for a much higher data rate than combined
electrical and optical networks and allows simultaneous transmission of multiple signals
along one optical ﬁbre link.
Below, we summarize selected developments of the early history of long-distance com-
munication systems (after Hecht [13] and Einarsson [16]):
• TAT-1 (1956) First transatlantic telephone system contained two separate coaxial cables,
one for each direction of transmission. The repeaters (based on vacuum tubes) were
spliced into the cables at spacing of 70 km. Capacity of the transmission was 36 two-way
voices.

7
Optical fibre communication
• TAT-6 (1976) Capacity of 4200 two-way telephone channels. Repeaters (based on tran-
sistors) were separated at a distance of 9.4 km.
• TAT-7 (1983) System similar to TAT-6.
• TAT-8 (1988) First intercontinental optical ﬁbre system between USA and Europe.
• HAW-4 (1988) System installed between USA and Hawaii; similar to TAT-8.
• TCP-3 Extension of HAW-4 to Japan and Guam.
• TAT-12 (1996) First transatlantic system in service with optical ampliﬁers.
A typical optical ﬁbre used in TAT-8 system supported single-mode transmission [16].
It had outer diameter of 125 µm and core diameter of 8.3 µm. It operated at 1.3 µm
wavelength. Digital information was transmitted at 295.6 Mbits. The repeaters which
regenerated optical signals were spaced 46 km apart.
Some of the main developments that took place in relation to development of ﬁbre
communication are summarized below (compiled using information from Ref. [13]):
• October 1956: L. E. Curtiss and C. W. Peters described plastic-clad ﬁbre at Optical
Society of America meeting in Lake Placid, New York.
• Autumn 1965: C. K. Kao concludes that the fundamental limit on glass transparency is
below 20 dB km−1 which would be practical for communication.
• Summer 1970: R. D. Maurer, D. Keck and P. Schultz from Corning Glass Works, USA
make a single-mode ﬁbre with loss of 16 dB km−1 at 633 nm by doping titanium into
ﬁbre core.
• April 22, 1977: General Telephone and Electronics. First live telephone trafﬁc through
ﬁbre optics, at 6 Mbits−1 in Long Beach, CA.
• 1981: British Telecom transmits 140 Mbits s−1 through 49 km of single-mode ﬁbre at
1.3 µm wavelength.
• Late 1981: Canada begins trial of ﬁbre optics to homes in Elie, Manitoba.
• 1988: L. Mollenauer of Bell Labs demonstrates soliton transmission through 4000 km of
single-mode ﬁbre.
• February 1991: M. Nakazawa, NTT Japan sends soliton signals through a million km of
ﬁbre.
• 1994: World Wide Web grows from 500 to 10 000 servers.
• 1996: Introduction of a commercial wavelength-division multiplexing (WDM) system.
• July 2000: Peak of telecom bubble. JDS Uniphase announces plans to merge with SDL
Inc. in stock deal valued at $41 billion.
• 2001: NEC Corporation and Alcatel transmitted 10 terabits per second through a single
ﬁbre [17].
• December 2001: Failure of TAT-8 submarine cable.
The capacity of optical ﬁbre communication systems grew very fast. Comparison with
Moore’s law for computers which states that computer power doubles every 18 months,
indicates that ﬁbre capacity grows faster [18]. In 1980, a typical ﬁbre could carry about
45 Mb s−1; in 2002 a single ﬁbre was able to transmit more than 3.5 Tb s−1 of data. Over
those 22 years the computational power of computers has increased 26 000 times whereas
the ﬁbre capacity increased 110 000 times over the same period of time.

8
Introduction
Egyptian
Venetian
Optical loss (dB/km)
Optical
fibre
1000
1900
1966
1979
1983
102
103
104
105
10
0.1
1.0
106
107
B.C.
A.D.
3000
Fig. 1.2
Historical reduction of loss as a function of time from ancient times to the present. Copyright 1989 IEEE. Reprinted,
with permission from S. R. Nagel, IEEECommunicationsMagazine, 25, 33 (1987).
1.3.3 Development of optical fibre
Glass is the principal material used to fabricate optical ﬁbre. To be useful as a transmission
medium it has to be extremely clean and uniform. In Fig. 1.2 we illustrated the history of
reduction losses in glass as a function of time (after [19]). To make practical use of glass as
a medium used to send light, an important element, and in fact the very ﬁrst challenge was
to develop glass so pure that 1% of light entering at one end would be retained at the other
end of a 1 km-thick block of glass. In terms of attenuation this 1% corresponds to about 20
decibels per kilometre (20 dB km−1).
In 1966 Kao and Hockhman [15] suggested that the high loss in glass was due to
impurities and was not the intrinsic property of glass. In fact, Kao suggested to use optical
ﬁbre as a transmission medium.
Kao’s ideas were made possible in 1970 with the fabrication of low-loss glass ﬁbre by
the research group from Corning Glass Works [20]. That work established a potential of
optical communications for providing a high bandwidth and long distance data transmission
network. Corning Glass Works were the ﬁrst to produce an optical glass with a transmission
loss of 20 dB km−1, which was thought to be the threshold value to permit efﬁcient optical
communication.

9
Optical fibre communication
wavelength (µm)
loss (dB/km)
1.6
1.4
1.2
1.0
0.1
0.5
5
10
50
100
1
0.8
First
window
Third
window
Second
window
Fig. 1.3
Spectral loss of a typical low-loss optical fibre. Adapted from [22] with permission from the Institution of Engineering
and Technology.
Before the Corning work, around 1966, the power loss for the best available glass was
about 1000 dB km−1 which implies a 50% power loss in a distance of about 3 m [21]. Today,
most optical ﬁbres in use are so-called single-mode ﬁbre able to maintain single mode of
operation (see Chapter 5 for the relevant deﬁnitions). Commercially available ﬁbres have
losses of about 0.2 dB km−1 at the wavelength of 1550 nm and are capable of transmitting
data at 2–10 Gbit s−1.
The measured spectral loss of a typical low-loss optical ﬁbre is shown in Fig. 1.3 [22].
The measured ﬁbre had 9.4 µm core diameter and a 0.0028 refractive index difference
between the core and cladding. Peaks were found at about 0.94, 1.24 and 1.39 µm. They
were caused by OH vibrational absorption. The rise of the loss from 1.7 µm is mainly
attributed to the intrinsic infrared absorption of the glass.
The locations of the ﬁrst, second and third communications windows are also shown. The
most common wavelengths used for optical communication span between 0.83–1.55 µm.
Early technologies used the 0.8–0.9 µm wavelength band (referred to as the ﬁrst window)
mostly because optical sources and photodetectors were available at these wavelengths.
Second telecommunication window, centered at around 1.3 µm, corresponds to zero dis-
persion of ﬁbre. Dispersion is a consequence of the velocity propagation being different for
different wavelengths of light. As a result, when pulse travels through a dispersive media it
tends to spread out in time, the effect which ultimately limits speed of digital transmission.
The third window, centered at around 1.55 µm, corresponds to the lowest loss. At that
wavelength, the glass losses approach minimum of about 0.15 dB km−1.
For the sake of comparison, the loss of about 0.2 dB km−1 corresponds to 50% power
loss after propagation distance of about 15 km.
1.3.4 Comparison with electrical transmission
Historically, copper was a traditional medium used to transmit information by electri-
cal means. Its data handling capacity is, however, limited. Only around 1970, after the

10
Introduction
fabrication of relatively low-loss optical ﬁbre, it started to be used in an increasing scale.
From practical perspective, the choice between copper or glass is based on several factors.
In general, optical ﬁbre is chosen for systems which are used for longer distances and
higher bandwidths, whereas electrical transmission is preferred in short distances and
relatively low bandwidth applications. The main advantages of electrical transmission are
associated with:
• relatively low cost of transmitters and receivers
• ability to carry electrical signals and also electrical power
• for not too large quantities, relatively low cost of materials
• simplicity of connecting electrical wires.
However, it has to be realized that optical ﬁbre is much lighter than copper. For example,
700 km of telecommunication copper cable weighs 20 tonnes, whereas optical ﬁbre cable
of the same length weighs only around 7 kg [23].
The main advantages of optical ﬁbre are:
• ﬁbre cables experience effectively no crosstalk
• they are immune to electromagnetic interference
• lighter weight
• no electromagnetical radiation
• small cable size.
1.3.5 Governing standards
In order for various manufacturers to be able to develop components that function com-
patibly in ﬁbre optic communication systems, a number of standards have been developed
and published by the International Telecommunications Union (ITU) [24]. Other standards,
produced by a variety of standards organizations, specify performance criteria for ﬁbre,
transmitters and receivers to be used together in conforming systems.
These and related standards are covered in a recent publication [25]. It is the work
of over 25 world-renowned contributors and editors. It provides a reference to over a
hundred standards and industry technical speciﬁcations for optical networks at all levels:
from components to networking systems through global networks, as well as coverage of
networks management and services.
The ITU has speciﬁed six transmission bands for ﬁbre optic transmission [18]:
1. the O-band (original band) – 1260–1310 nm,
2. the E-band (extended band) – 1360–1460 nm,
3. the S-band (short band) – 1460–1530 nm,
4. the C-band (conventional band) – 1530–1565 nm,
5. the L-band (long band) – 1565–1625 nm,
6. the U-band (ultra band) – 1625–1675 nm.
A seventh band, not deﬁned by the ITU, runs around 850 nm and is used in private networks.

11
Optical fibre communication
Time-division multiplexing (TDM)
Wavelength-division multiplexing (WDM)
Channels
Channels
I
I
t
1
1
1
2
2
2
6
6
6
8
8
λ
8
7
7
7
5
5
5
4
4
4
3
3
3
Fig. 1.4
Illustration of TDM and WDM formats.
MUX
DMUX
1
1
1
λ
λ
λ λ
λ
λ
λ
λ
λ
2
2
2
3
3
3
Fig. 1.5
WDM transmission system.
1.3.6 Wavelength division multiplexing (WDM)
Wavelength division multiplexing (WDM) is a technique which allows optical signals with
different wavelengths to propagate in a single optical ﬁbre without affecting one another.
The technique was invented to increase the information-carrying capacity of a ﬁbre. WDM
is not the only possible way to increase ﬁbre capacity. In Fig. 1.4 we illustrate two basic
formats, each allowing an increase of ﬁbre capacity, time-division multiplexing (TDM) and
wavelength-division multiplexing (WDM). In both formats messages from various channels
are combined (multiplexed) onto a single information channel. This can be done in time or
at various frequencies (wavelengths).
There is extensive literature on the principles, concepts and components for WDM,
see [26], [27], [28], [29], [30] to just name a few. The WDM transmission system is
shown in Fig. 1.5. Here, MUX denotes a multiplexer. Its role is to combine light from
several sources, each operating at a particular wavelength carrying one channel, to the
transmission ﬁbre. At the receiving end, the demultiplexer (DMUX) separates different
wavelengths.

12
Introduction
1.3.7 Solitons
In the mid 1980s researchers started experimenting with solitons. The soliton phenomenon
was ﬁrst described by John Scott Russell, who in 1834 observed a solitary wave in a narrow
water channel (the Union Canal in Scotland).
Solitons are pulses of special shape which travel without changing it. Pulse broadening is
due to the fact that some wavelengths travel faster than other wavelengths, the effect known
as dispersion. In ﬁbre, there also exists nonlinearity. When taken together, dispersion and
nonlinearity, they compensate for each other, thus producing conditions where pulse shape
remains unchanged. To form a soliton, the initial pulse must have a particular peak energy
and pulse shape.
In 1973, Akira Hasegawa of AT&T Bell Labs was the ﬁrst to suggest that solitons could
exist in optical ﬁbre. In 1988, Linn Mollenauer and his team transmitted soliton pulses over
4000 km [31]. A recent overview of soliton-based optical communications was provided
by Hasegawa [32] and by Mollenauer and Gordon [33].
1.4 Biological and medical photonics
A special issue of the IEEE Journal of Selected Topics in Quantum Electronics [34]
summarizes hot topics in bio-photonics until circa 2005. Some of them are directly
related to computational bio-photonics, such as elastic light scattering properties of
tissues [35].
Two special issues of IEEE Journal of Selected Topics in Quantum Electronics on bio-
photonics [36], [37] summarize recent progress and trends. Biological applications of
stimulated parametric emission microscopy and stimulated Raman scattering microscopy
are reviewed by Kajiyama et al. [38]. As an introduction to the subject we recommend the
book by Prasad [39].
1.5 Photonic sensors
Photonic sensors have been the subject of intensive research over the last two decades. They
are emerging as an important branch of photonics. Their development is based on analysing
different components of the optical signal, like intensity, polarization, pulse shape or arrival
time and also other phenomena like interference. Utilizing those various possibilities leads
to different types of sensors. There are almost endless possibilities for their use. The best
known applications are in civil and military environments for detection of a wide variety
of biological, chemical and nuclear agents.
An important medium for sensing is the optical ﬁbre and its recent variations which
found their own ways of applications in sensing. These include: photonic band gap
ﬁbres (PBG), microstructure optical ﬁbres (MOF), random hole optical ﬁbres (RHOF)

13
Silicon photonics
and hybrid ordered random hole optical ﬁbres (HORHOF). They offer higher resolu-
tion, lower cost and/or expanded detection range capability for sources and detection
schemes.
In this book we will not explicitly concentrate on analysis and/or simulations of photonic
sensors, although some of the discussed properties of photonic devices can be directly
applied in sensors.
As an example, the use of light emitting diodes (LED) in sensing has been summarized re-
cently by O’Toole and Diamond [40]. The authors described development and advancement
of LED-based chemical sensors and sensing devices.
Another example is device based on a high-ﬁnesse, whispering-gallery-mode disk res-
onator that can be used for the detection of biological pathogens [41]. The device operates
by means of monitoring the change in transfer characteristics of the disk resonator when
biological materials fall onto its active area.
The open access journal Sensors (ISSN 1424-8220; CODEN: SENSC9) [42] on science
and technology of sensors and biosensors is published monthly online. A special issue:
Photonic Sensors for Chemical, Biological, and Nuclear Agent Detection was published
recently. It can be considered a good source of current developments and applications of
new physical phenomena in sensing.
1.6 Silicon photonics
The application of silicon in photonics certainly needs a separate discussion. Silicon is a
material of choice in electronics and it is also economical to build photonic devices on
this material [43], see also the contribution by Soref [44] for an overview of optoelectronic
integrated circuits. However, silicon is not a direct-gap material and therefore cannot
efﬁciently generate light. Intensive work on those issues is taking place in many institutions,
see the recent summary of the Intel-UC Santa Barbara collaboration on the hybrid silicon
laser [45].
On another front, associated with computer technology, the continuation of Moore’s Law
and progress which it reﬂects is becoming increasingly dependent on ultra-fast data transfer
between and within microprocessor. The existing electrical interconnects are expected to
be replaced by high speed optical interconnects. They are seen as a promising way forward,
and silicon photonics is seen as particularly useful, due to the ability to integrate electronic
and optical components on the same silicon chip.
Particularly signiﬁcant progress has been seen in the advances of optical modulators
based on silicon, see the recent report by a leading collaboration [46].
In designing and optimizing those devices simulations play a very important role. Re-
cent advances in modelling and simulation of silicon photonic devices are summarized
by Passaro and De Leonardis [47]. They review recently developed simulation methods
for submicrometre innovative Silicon-on-Insulator (SOI) guiding structures and photonic
devices.

14
Introduction
1.7 Photonic quantum information science
A new emerging direction within photonics is related to quantum communications and
quantum information processing. Recent progress in this subﬁeld is summarized by Politi
et al. [48]. Here, we brieﬂy outline recent main developments.
Photons potentially can play the crucial role in the quantum information processing due
to their low-noise properties and ease of manipulation at the single qubit level. In recent
years several quantum gates have been implemented using integrated photonics circuits.
1. A theoretical proposal for the implementation of the quantum Hadamard gate using
photonic crystal structures [49]. An integrated optics Y-junction beam splitter has been
proposed for realization of this gate. Reported numerical simulations support theoretical
concepts.
2. A group from Bristol demonstrated the capability to build photonic quantum circuits
in miniature waveguide devices [50] and optical ﬁbres [51]. They reported recently on high-
ﬁdelity silica-on-silicon integrated optical realizations of key quantum photonic circuits,
including two-photon quantum interference and a controlled-NOT logic gate [52]. They
have also demonstrated controlled manipulation of up to four photons on-chip, including
high-ﬁdelity single qubit operations, using a lithographically patterned resistive phase
shifter [53].
References
[1] Photonics West, http://spie.org/x2584.xml 3 July 2012.
[2] OFC Conference, www.ofcnfoec.org/home.aspx, 3 July 2012.
[3] Photonics Global Conference, www.photonicsglobal.org/index.php, 3 July 2012.
[4] C. R. Pollock and M. Lipson. Integrated Photonics. Kluwer Academic Publishers,
Boston, 2003.
[5] J. D. Joannopoulos, S. G. Johnson, J. N. Winn, and R. D. Meade. Photonic Crystals:
Molding the Flow of Light. Princeton University Press, Princeton and Oxford, 2008.
[6] J.-M. Jin. Theory and Computation of Electromagnetic Fields. Wiley-IEEE Press,
Hoboken, NJ, 2010.
[7] A. Taﬂove and S. C. Hagness. Computational Electrodynamics. The Finite-Difference
Time-Domain Method. Artech House, Boston, 2005.
[8] D. Gallagher. Photonic CAD matures. IEEE LEOS Newsletter, 2:8–14, 2008.
[9] S. Obayya. Computational Photonics. Wiley, Chichester, 2011.
[10] Optical Waveguide Modeling, http://optical-waveguides-modeling.net/, 3 July 2012.
[11] Photonics resources page, www.ashokpm.org/photonics.htm, 3 July 2012.
[12] Photonics software, www.skywise711.com/lasers/software.html, 3 July 2012.
[13] J. Hecht. City of Light: The Story of Fiber Optics. Oxford University Press, Oxford,
1999.

15
References
[14] A. Bateman. Digital Communications: Design for the Real World. Addison-Wesley,
Harlow, 1999.
[15] K. C. Kao and G. A. Hockman. Dielectric-ﬁbre surface waveguides for optical fre-
quencies. Proc. IEE, 133:1151–8, 1966.
[16] G. Einarsson. Principles of Lightwave Communications. Wiley, Chichester, 1996.
[17] J. Hecht. Computers full of light: a short history of optical data communications. In
C. DeCusatis, ed., Handbook of Fiber Optic Data Communication, pp. 3–17. Elsevier,
Amsterdam, 2008.
[18] D. R. Goff, K. S. Hansen, and M. K. Stull. Fiber Optic Video Transmission: The
Complete Guide. Focal Press, Oxford, 2002.
[19] S. R. Nagel. Optical ﬁber – the expanding medium. IEEE Communications Magazine,
25:33–43, 1987.
[20] F. P. Kapron, D. B. Keck, and R. D. Maurer. Radiation losses in glass optical waveg-
uides. Appl. Phys. Lett., 17:423–5, 1970.
[21] G. Ghatak and K. Thyagarajan. Introduction to Fiber Optics. Cambridge University
Press, Cambridge, 1998.
[22] T. Miya, Y. Terunuma, T. Hosaka, and T. Miyashita. Ultimate low-loss single-mode
ﬁbre at 1.55 µm. Electronics Letters, 15:106–8, 1979.
[23] Optical ﬁber, http://en.wikipedia.org/wiki/Optical ﬁber, 3 July 2012.
[24] International Telecommunication Union, www.itu.int/en/pages/default.aspx, 3 July
2012.
[25] K. Kazi. Optical Networking Standards: A Comprehensive Guide. Springer, New
York, 2006.
[26] R. T. Chen and L. S. Lome, eds., Wavelength Division Multiplexing. SPIE Optical
Engineering Press, Bellington, WA, 1999.
[27] G. Keiser. Optical Fiber Communications. Third Edition. McGraw-Hill, Boston, 2000.
[28] S. V. Kartalopoulos. DWDM. Networks, Devices and Technology. IEEE Press, Wiley,
Hoboken, NJ, 2003.
[29] J. Zheng and H. T. Mouftah. Optical WDM Networks. Concepts and Design Principles.
IEEE Press, Wiley, Hoboken, NJ, 2004.
[30] J. C. Palais. Fiber Optic Communications. Fifth Edition. Prentice Hall, Upper Saddle
River, NJ, 2005.
[31] L. F. Mollenauer and K. Smith. Demonstration of soliton transmission over more
than 4000 km in ﬁber with loss periodically compensated by Raman gain. Opt. Lett.,
13:675–7, 1988.
[32] A. Hasegawa. Soliton-based optical communications: An overview. IEEE J. Select.
Topics Quantum Electron., 6:1161–72, 2000.
[33] L. F. Mollenauer and J. P. Gordon. Solitons in Optical Fibers. Fundamentals and
Applications. Elsevier, Amsterdam, 2006.
[34] R. R. Jacobs. Introduction to the issue on biophotonics. IEEE J. Select. Topics Quan-
tum Electron., 11:729–32, 2005.
[35] X. Li, A. Taﬂove, and V. Backman. Recent progress in exact and reduced-order
modeling of light-scattering properties of complex structures. IEEE J. Select. Topics
Quantum Electron., 11:759–65, 2005.

16
Introduction
[36] I. K. Ilev, L. V. Wang, S. A. Boppart, S. Andersson-Engels, and B.-M. Kim. Intro-
duction to the special issue on biophotonics. Part 1. IEEE J. Select. Topics Quantum
Electron., 16:475–7, 2010.
[37] I. K. Ilev, L. V. Wang, S. A. Boppart, S. Andersson-Engels, and B.-M. Kim. Intro-
duction to the special issue on biophotonics. Part 2. IEEE J. Select. Topics Quantum
Electron., 16:703–5, 2010.
[38] S. Kajiyama, Y. Ozeki, K. Fukui, and K. Itoh. Biological applications of stimulated
parametric emission microscopy and stimulated Raman scattering microscopy. In
B. Javidi and T. Fournel, eds., Information Optics and Photonics. Algorithms, Systems,
and Applications, pp. 89–100. Springer, New York, 2010.
[39] P. N. Prasad. Introduction to Biophotonics. Wiley, Hoboken, NJ, 2003.
[40] M. O’Toole and D. Diamond. Absorbance based light emitting diode optical sensors
and sensing devices. Sensors, 8:2453–79, 2008.
[41] R. W. Boyd and J. E. Heebner. Sensitive disk resonator photonic biosensor. Applied
Optics, 40:5742–7, 2001.
[42] Sensors – Open Access Journal, www.mdpi.com/journal/sensors, 3 July 2012.
[43] G. T. Reed and A. P. Knights. Silicon Photonics: An Introduction. Wiley, Chichester,
2004.
[44] R. Soref. Introduction: the opto-electronics integrated circuit. In G. T. Reed, ed.,
Silicon Photonics: The State of the Art, pp. 1–13. Wiley, Hoboken, NJ, 2008.
[45] J. E. Bowers, D. Liang, A. W. Fang, H. Park, R. Jones, and M. J. Paniccia. Hybrid
silicon lasers: The ﬁnal frontier to integrated computing. Optics & Photonics News,
21:28–33, 2010.
[46] D. J. Thomson, F. Y. Gardes, G. T. Reed, F. Milesi, and J.-M. Fedeli. High speed silicon
optical modulator with self aligned fabrication process. Optics Express, 18:19064–9,
2011.
[47] V. M. N. Passaro and F. De Leonardis. Recent advances in modelling and simulation
of silicon photonic devices. In G. Petrone and G. Cammarata, eds., Modelling and
Simulation, pp. 367–90. I-Tech Education and Publishing, Vienna, 2008.
[48] A. Politi, J. Matthews, M. G. Thompson, and J. L. O’Brien. Integrated quantum
photonics. IEEE J. Select. Topics Quantum Electron., 15:1673–84, 2009.
[49] S. Salemian and S. Mohammadnejad. Quantum Hadamard gate implementation using
planar lightwave circuit and photonic crystal structures. American Journal of Applied
Sciences, 5:1144–8, 2008.
[50] A. Politi, M. J. Cryan, J. G. Rarity, S. Yu, and J. L. O’Brien. Silica-on-silicon waveguide
quantum circuits. Science, 320:646–9, 2008.
[51] A. S. Clark, J. Fulconis, J. G. Rarity, W. J. Wadsworth, and J. L. O’Brien. All-optical-
ﬁber polarization-based quantum logic gate. Phys. Rev. A, 79:030303, 2009.
[52] A. Laing, A. Peruzzo, A. Politi, M. Rodas Verde, M. Halder, T. C. Ralph, M. G.
Thompson, and J. L. O’Brien. High-ﬁdelity operation of quantum photonic circuits.
Appl. Phys. Lett., 97:211109, 2010.
[53] J. C. F. Matthews, A. Politi, A. Stefanov, and J. L. O’Brien. Manipulation of mul-
tiphoton entanglement in waveguide quantum circuits. Nature Photonics, 3:346–50,
2009.

2
Basic facts about optics
In this chapter, we review basic facts about geometrical optics. Geometrical optics is
based on the concept of rays which represent optical effects geometrically. For an excellent
introduction to this topic consult work by Pedrotti and Pedrotti [1].
2.1 Geometrical optics
2.1.1 Ray theory and applications
We visualize propagation of light by introducing the concept of rays. These rays obey
several rules:
• In a medium they travel with velocity v given by
v = c
n
(2.1)
where c = 3 × 108 m/s is the velocity of light in a vacuum and the quantity n is known
as refractive index. (We introduced here the notation n for refractive index instead of
widely accepted n in the optics literature to avoid confusion with electron density, n
which will be used in later chapters.) Some typical values of refractive indices are shown
in Table 2.1.
• In a uniform medium rays travel in a straight path.
• At the plane of interface between two media, a ray is reﬂected at the angle equal to the
angle of incidence, see Fig. 2.1. At the plane interface, the direction of transmitted ray is
determined by Snell’s law
n1 sin θ1 = n2 sin θ2
(2.2)
where n1 and n2 are the values of refractive indices in both media and θ1 and θ2 are the
angles of incidence and refraction, respectively.
The general relation between incoming ray A and the reﬂected ray B is
B = R · A
(2.3)
with R reﬂection coefﬁcient (complex). Reﬂection coefﬁcients for two main types of waves
which can propagate in planar waveguides are given by Fresnel formulas and will be
determined in the next chapter.
17

18
Basic facts about optics
Table 2.1 Refractive index for some materials.
Material
Refractive index
air
1.0
water
1.33
silica glass
1.5
GaAs
3.35
silicon
3.5
germanium
4.0
θ2
A
B
C
interface
n2
n1
θ1 θ1
Fig. 2.1
Snell’s law.
n2
n1
Θc
Fig. 2.2
Illustration of critical angle.
2.1.2 Critical angle
From Snell’s law one can deduce the conditions under which light ray will stay in the
same medium (e.g. dense) after reﬂection, see Fig. 2.2. The situation shown corresponds
to θ2 = π/2. Angle θ1 then becomes known as the critical angle, θc and its value is:
sin θc = n2
n1
(2.4)

19
Geometrical optics
Fibre
f
Fig. 2.3
Focusing light beam onto a fibre.
f
lens
axis
focal point
Fig. 2.4
Focusing an off-axis beam.
2.1.3 Lenses
We discuss here only thin lenses, deﬁned when the vertical translation of a ray passing
through lens is negligible. The ray enters and leaves the lens at approximately the same
distance from the lens axis.
An important use of lenses in ﬁbre optics is to focus light onto a ﬁbre, see Fig. 2.3. Here,
a collimated beam of light (parallel to the lens axis) is focused to a point. The point is
known as the focal point and is located at a distance f , known as focal length from the lens.
All the collimated rays converge to the focal point.
Focal distance f is related to the curvatures R1 and R2 of the spheres forming lens as
1
f = (n −1)
 1
R1
+ 1
R2

(2.5)
If beam of light travels at some angle relative to the lens axis, Fig. 2.4, the rays will be
focused in the focal plane.

20
Basic facts about optics
n(r)
r
n max
A
B
C
E
D
F
f
d
Fig. 2.5
A cylindrical disk with graded refractive index.
2.1.4 GRIN systems
GRIN systems whose name originates from GRadient in the INdex of refraction play the
role similar to lenses. Here, the refractive index of the material is inhomogeneous. Spatial
dependence of refractive index serves as yet another parameter in the design of an ideal
lens.
The simple analysis of GRIN structure now follows [2], see Fig. 2.5. We have a ﬂat
cylindrical disk where the refractive index n(r) depends on radius r (distance from the
axis), keeps its maximum at the optical axis and decreases outwards. In order to focus
optical rays at the focal point F, the optical paths of all rays must be the same. (Optical path
is deﬁned as a product of geometrical distance in a given region and the value of refractive
index in that region.) Optical path difference of the central ray and the one going through
region with n(r) between planar wave front on the left and spherical wavefront on the right
should be zero
nmax · d ≈n(r) · d + DE
(2.6)
Distance DE is determined as follows: EF = f , where f is the focal length, DF = DE + f
and DF ≈

r2 + f 2. Combining those relations, we have
DE =

r2 + f 2 −f
(2.7)
Use the expansion

r2 + f 2 = f

1 + r2
f 2 ≈f

1 + r2
2 f 2

(2.8)
Apply the above expansion in (2.7) and obtain
DE ≈f + r2
2 f 2 −f = r2
2 f 2
(2.9)
Finally, the dependence of refractive index is
n(r) = nmax −
r2
2df 2
(2.10)

21
Wave optics
The above equation tells us that in order to focus parallel light by the GRIN plate, the index
of refraction should depend parabolically on radius.
2.2 Wave optics
Light is an electromagnetic wave and consists of an electric ﬁeld vector and a perpendicular
magnetic ﬁeld vector oscillating at a very high rate (of the order of 1014 Hz) and travelling
in space along direction which is perpendicular to both electric and magnetic ﬁeld vectors.
(These topics are discussed in more detail in the next chapter.) Here we state that the electric
ﬁeld vector E(r,t) obeys the following wave equation:
∇2E(r,t) −1
c2
∂2E(r,t)
∂t2
= 0
(2.11)
The above wave equation is time invariant; that is it does not change under the replacement
t →−t. We will soon utilize that fact in establishing the so-called Stokes relations.
The one-dimensional wave equation in a medium is
1
v2
∂2
∂t2 E(z,t) = ∂2
∂z2 E(z,t)
where v is the velocity of light in the medium. An exact solution can be expressed in terms
of two waves E+ and E−travelling in the positive and negative z-directions
E(z,t) = E+(z −vt) + E−(z + vt)
Dispersion relation for the above wave equation is obtained by substituting E(z,t) =
E0 sin (ωt −kz) into the wave equation, performing differentiation and dividing both sides
by E(z,t). The obtained dispersion relation which relates k and ω is
ω = ±v · k
It shows a linear dependence between angular frequency ω of the propagating wave and
its wavenumber k. Angular frequency ω is related to frequency as ω = 2π f whereas
wavenumber k is determined as
k = ω
v = 2π
λ
Here λ is the wavelength of the light wave and v is the phase velocity of the wave. The
factor ωt −kz is known as the phase of the wave.
Example When electromagnetic wave propagates in a medium where losses are signiﬁcant,
the attenuation must be incorporated into an expression for electric ﬁeld of the wave. The
relevant expression is
E(z,t) = E0e−αz sin(ωt −kz)

22
Basic facts about optics
where α is the attenuation coefﬁcient. The intensity of light is proportional to the square
of its electric ﬁeld. Therefore, the power of the light beam decreases as exp(-2αL) during
the propagation distance L. If we measure the distance in km, the unit of α is km−1. Power
reduction in decibels (dB) is determined as
dB = 10 log10 e−2αL
(2.12)
Find the relation between the attenuation coefﬁcient and the power change in dB/km.
Solution
One has
Loss(dB) = 10 log10 e−2αL
= −20 · α · L · log e
= −8.685 · α · L
Therefore
Loss(dB)/L(km) = −8.685 · α
or
dB/km = −8.685 · α
(2.13)
where α is in km−1.
2.2.1 Phase velocity
Consider a plane monochromatic wave propagating along the z-axis in an inﬁnite medium,
see Fig. 2.6
E(z,t) = E0cos (kz −ωt)
(2.14)
Select one point, say at the amplitude crest, and analyse its movement. If we assume that
this point maintains constant phase as
kz −ωt = const
we can determine velocity of that point. From the above relation
k dz
dt −ω = 0
or
vp = dz
dt = ω
k
(2.15)
The quantity vp is known as phase velocity and it represents the velocity at which a surface
of constant phase moves in the medium. Velocity in Eq. (2.1) should be interpreted as phase
velocity and Eq. (2.1) be replaced by
vp = c
n
(2.16)

23
Wave optics
0
0.5
1
1.5
2
2.5
3
× 10−14 
−1.5
−1
−0.5
0
0.5
1
1.5
2
Time
Amplitude
z(t)
Fig. 2.6
Illustration of phase velocity.
2.2.2 Group velocity
The group velocity describes the speed of propagation of a pulse in a medium. To see
this fact, consider propagation of two plane waves with different parameters but equal
amplitudes
E1(z,t) = E0 cos (k1z −ω1t) ,
E2(z,t) = E0 cos (k2z −ω2t)
(2.17)
Assume that their frequencies and wavenumbers differ by 2ω and 2k and write
ω1 = ω + ω, ω2 = ω −ω
k1 = k + k, k2 = k −k
Superposition of those waves results in a wave E(z,t) which is
E(z,t) = E1(z,t) + E2(z,t)
= E0 {cos [(k + k) z −(ω + ω)t] + cos [(k −k) z −(ω −ω)t]}
Using trigonometric identity
2 cos α cos β = cos (α + β) + cos (α −β)
allows us to write expression for E(z,t) as
E(z,t) = 2E0 cos (kz −ωt) cos (kz −ωt)
(2.18)
Eq. (2.18) represents a wave at carrier frequency ω that is modulated by a sinusoidal
envelope at the beat frequency ω, see Fig. 2.7. Phase velocity of the carrier wave is

24
Basic facts about optics
0
1
2
3
4
× 10−13 
−2
−1.5
−1
−0.5
0
0.5
1
1.5
2
Time
Amplitude
Fig. 2.7
Illustration of group velocity.
vp = ω/k. The envelope moves with velocity vg which is
vg = ω
k →dω
dk
(2.19)
In a free space ω = kc which is known as dispersion relation, the group velocity is
vg = dω
dk = c. In a free space (vacuum), the phase and group velocities are identical. In
media, the dispersion relation, i.e. ω = ω(k) dependence is usually a complicated function.
Example
Write a MATLAB program to visualize phase and group velocities based on
Eqs. 2.15 and 2.19.
Solution
The MATLAB code for phase velocity is provided in the Listing 2A.1 and in the
Listing 2A.2 for group velocity. The results are shown in Fig. 2.6 and Fig. 2.7.
2.2.3 Stokes relations
Stokes relations relate reﬂectivities and transmittivities of light at the plane of interface
between two media. Assume that electric ﬁeld E which is represented by the corresponding
ray interacts with the interface and is partially reﬂected and partially transmitted, see Fig. 2.8.
Here r,t are reﬂection and transmission coefﬁcients for ﬁelds (not intensities) propagating
from medium 2 to medium 1 (here, from top to bottom). Similarly, r′,t′ denote the reﬂection
and transmission coefﬁcients for ﬁelds propagating from medium 1 to medium 2.

25
Wave optics
2
1
tE
rE
E
Fig. 2.8
Transmission and reflection at the interface used in deriving Stokes relations.
2
1
tE
rE
E
Fig. 2.9
Transmission and reflection at the interface used in deriving Stokes relations. Time-reversed process.
2
1
tE
rtE+r'tE
rrE+t'tE
rE
Fig. 2.10
Transmission and reflection at the interface used in deriving Stokes relations. Full processes.
At the beginning of this section we have established the property of time invariance of
the wave equation. Time reversal invariance tells us that the above picture (reﬂection and
transmission) should also work in reverse time, see Fig. 2.9 where we combined rays tE
and rE to form ray E.
However, when one inputs two rays (tE and rE) at the interface between two media 1 and
2, one from above and one from below, there should exist partial reﬂection and transmission
for both rays, as is illustrated in Fig. 2.10.
A comparison of Fig. 2.9 and Fig. 2.10 reveals physically identical situations, and
therefore the following relations hold:
r2E + t′tE = E
rtE + r′tE = 0
From the above we obtain Stokes relations
t′t = 1 −r2
r′ = −r

26
Basic facts about optics
h
A
B
C
D
E
1
2
3
nf
n
Θi
0
Θi
Θt
Fig. 2.11
Interference in a single film with light incident at arbitrary angle θi.
2.2.4 Interference in dielectric film
Interference in dielectric ﬁlm is an important phenomenon behind operation of optical
devices, like ﬁlters. It is also a fundamental effect for the operation of the Fabry-Perot
interferometer.
To analyse this interference, consider a single layer dielectric ﬁlm having refractive
index n f which is in contact with the medium having refractive index n0 from above,
see Fig. 2.11. For such a conﬁguration, we will derive conditions for constructive and
destructive interference. We will do this by calculating the optical path difference.
The incident beam 1 creates on reﬂection and transmission two emerging beams 2 and
3. The phase difference between beams 2 and 3 as measured at points C and D is due to
optical path difference  (optical path is deﬁned as a product of geometrical path times
refractive index) and is
 = n f (AB + BC) −n0AD
(2.20)
From Fig. 2.11 one can determine the following trigonometric relations:
AD
AC = cos(90o −θi) = sin θi
(2.21)
h
AB = cos θt
(2.22)
AE
h = tan θt
(2.23)
and also
AC = 2 · AE
(2.24)
Combining Eqs. (2.23) and (2.24), one obtains
AC = 2 · t · tan θt
(2.25)
Substituting (2.25) into (2.21) we obtain geometrical path for AD part
AD = 2 · h · tan θt · sin θi
(2.26)
Geometrical path AB + AC is obtained using Eq. (2.22) as
AB + AC = 2 · AB = 2 ·
t
cos θt
(2.27)

27
Wave optics
h
1
2
3
4
E0
nf
n0
Fig. 2.12
Multiple interference in a parallel plate.
Combining Eqs. (2.26) and (2.27) with (2.20) one ﬁnds the optical path difference as
 = n f · 2 ·
t
cos θt
−n0 · 2 · t · sin θt
cos θt
· sin θi
(2.28)
= 2hn f
cos θt

1 −n0
n f
sin θt sin θi

(2.29)
Using Snell’s law
n0 sin θi = n f sin θt
and the following trigonometric identity
cos2 θt + sin2 θt = 1
the curly bracket in Eq. (2.29) gives
1 −n0
n f
sin θt sin θi = 1 −1
n f
sin θtn f sin θt
= 1 −sin2 θt = cos2 θt
Employing the last result in (2.29), we ﬁnally obtain for the optical path difference
 = 2 · h · n f · cos θt
(2.30)
Thus, the optical path difference is expressed in terms of the angle of refraction. For normal
incidence θi = θt = 0 and  = 2n f h. The phase difference δ acquired by light ray due to
travel in the ﬁlm corresponding to optical path difference  is
δ = k ·  = 2π
λ0
· 
(2.31)
2.2.5 Multiple interference in a parallel plate
Based on discussion from the previous section, we will now consider interference of multiple
beams in a parallel plate, see Fig. 2.12. Here, E0 is the amplitude of the incoming light, r,t
are the coefﬁcients of external reﬂections and transmissions, and r′,t′ are coefﬁcients of
internal reﬂections and transmissions.

28
Basic facts about optics
Phase difference between two successive reﬂected beams which exists due to travel in
the ﬁlm having refractive index n f is, Eq. (2.31)
δ = k · 
where  is given by Eq. (2.30). Analysing Fig. 2.12, one can write the following relations
for outgoing beams
E0eiωt
incident beam
E1 = rE0eiωt
ﬁrst reﬂected beam
E2 = tt′r′E0eiωt−iδ
second reﬂected beam
E3 = tt′r′3E0eiωt−i2δ
third reﬂected beam
E4 = tt′r′5E0eiωt−i3δ
fourth reﬂected beam
kth reﬂected beam is
Ek = tt′r′(2k−1)E0eiωt−i(k−1)δ
Sum of all reﬂected beams, ER is
ER =
∞

k=1
Ek = rE0eiωt +
∞

k=2
tt′r′(2k−3)E0eiωte−i(k−2)δ
= E0eiωt
	
r + tt′r′e−iδ
∞

k=2
r′(2k−4)e−i(k−2)δ

To perform the above inﬁnite sum, use an elementary result for the sum of the geometric
series
S =
∞

k=2
xk−2 = 1 + x + x2 + · · ·
For |x| < 1, the sum is S = 1/(1 −x). In our case here, x = r′2e−iδ, and total reﬂection is
thus
ER = E0eiωt

r +
tt′r′e−iδ
1 −r′2e−iδ

Using Stokes relations, we obtain
ER = E0eiωt

r −(1 −r2)re−iδ
1 −r2e−iδ

= E0eiωt r(1 −e−iδ)
1 −r2e−iδ
Light intensity of the reﬂected beam is proportional to the irradiance IR which is
IR ∼|ER|2 = E2
0r2
eiωt(1 −e−iδ)
1 −r2e−iδ
 e−iωt(1 −eiδ)
1 −r2eiδ

= E2
0r2
2(1 −cos δ)
1 + r4 −2r2 cos δ

29
Wave optics
Introduce Ii as the irradiance of the incident beam and IT as the irradiance of the transmitted
beam. We have
IR
Ii
= |ER|2
|Ei|2
and
IR + IT = Ii
which originates from energy conservation in nonabsorbing ﬁlms. Using the above relations,
one obtains
IR =
2r2(1 −cos δ)
1 + r4 −2r2 cos δ Ii
(2.32)
and
IT =
(1 −r2)2
1 + r4 −2r2 cos δ Ii
(2.33)
2.2.6 Fabry-Perot (FP) interferometer
The FP interferometer is formed by two parallel plates with some medium (often air)
between them. Expressions for transmission and reﬂection in such a system have been
derived in the previous section.
The expression for transmission can be used to determine the transmittance T (or Airy
function) as follows:
T ≡IT
Ii
=
(1 −r2)2
1 + r4 −2r2 cos δ
=
1 −2r2 + r4
1 + r4 −2r2 + 4r2 sin2 δ
2
=
1
1 +
4r2
(1−r2)2 sin2 δ
2
using trigonometric relation cos δ = 1 −2 sin2 δ
2.
Deﬁne coefﬁcient of ﬁnesse
F ≡
4r2
(1 −r2)2
(2.34)
Transmittance is thus expressed as
T =
1
1 + F sin2 δ
2
(2.35)

30
Basic facts about optics
0
5
10
15
20
0
0.2
0.4
0.6
0.8
1
Transmittance
Phase difference (rad)
2 π
4 π
r = 0.8
r = 0.4
r = 0.2
Fig. 2.13
Fabry-Perot fringe profile.
Example
Write a MATLAB program to analyse the transmittance of an FP etalon given by
Eq. (2.35).
Solution
The MATLAB code is shown in Appendix, Listing A 2.3 and the FP fringe proﬁle is shown
in Fig. 2.13. The ﬁgure shows plots of transmission as a function of phase difference δ for
various values of external reﬂection r.
2.3 Problems
1.
Use Snell’s law to derive an expression for critical angle θc. Compute the value of θc
for a water-air interface (nwater = 1.33).
2.
Isotropic light source located at distance d under water illuminates circular area of a
radius 5 m. Determine d.
3.
A tank of water is covered with a 1 cm thick layer of linseed oil (noil = 1.48) above
which is air. What angle must a beam of light, originating in the tank, make at the
water-oil interface if no light is to escape?
4.
Analyse the travel of a light ray through a parallel glass plate assuming refractive
index of glass n. Determine displacement of the outgoing ray.
5.
A point source S is located on the axis of, and 30 cm from a plane-convex thin lens
which has a radius of 5 cm. The glass lens is immersed in air. Determine the location
of the image (a) when the ﬂat surface is toward S and (b) when the curved surface is
toward S.

31
Appendix 2A
R
d
A
B
Fig. 2.14
Propagation of light in U-tube.
6.
Analyse multiple interference in a parallel plate FP etalon formed by two parallel
plates with an active medium inside with gain g [3]. Derive an expression for a signal
gain.
7.
A glass rod of rectangular cross section is bent into U-shape as shown in Fig. 2.14
[4]. A parallel beam of light falls perpendicularly on the ﬂat surface A. Determine
the minimum value of the ratio R/d for which all light entering the glass through
surface A will emerge from the glass through surface B. Assume that the refractive
index of glass is 1.5.
8.
The Sellmeier dispersion equation is an empirical expression for the refractive index
of a dielectric (like glass) in terms of the wavelength λ. One of the most popular
models is [5], [6]
n2 = 1 + G1
λ2
λ2 −λ2
1
+ G2
λ2
λ2 −λ2
2
+ G3
λ2
λ2 −λ2
3
(2.36)
Here G1, G2, G3 and λ1, λ2, λ3 are constants (called Sellmeier coefﬁcients) which
are determined by ﬁtting the above expression to the experimental data. Some of the
Sellmeier parameters are given in Table 2.2 (data combined from [5], [7] and [6]).
Table 2.2 Sellmeier parameters for SiO2.
Parameter
G1
G2
G3
λ1 (µm)
λ2 (µm)
λ3 (µm)
SiO2
0.696749
0.408218
0.890815
0.0690660
0.115662
9.900559
Write a MATLAB program to plot refractive index as a function of λ from 0.5 µm
to 1.8 µm for pure silica.
9.
Using the Sellmeier relation, plot reciprocal group velocity and group velocity for
SiO2. Assume 1.36 < λ[µm] < 1.65.
Appendix 2A: MATLAB listings
In Table 2.3 we provided a list of MATLAB ﬁles created for Chapter 2 and a short description
of each function.

32
Basic facts about optics
Table 2.3 List of MATLAB functions for Chapter 2.
Listing
Function name
Description
2A.1
phase velocity.m
Plots phase velocity
2A.2
group velocity.m
Plots group velocity
2A.3
FP transmit.m
Plots transmittance of Fabry-Perot etalon
Listing 2A.1
Program phase velocity.m. MATLAB program which plots phase velocity.
% File name: phase_velocity.m
% Illustrative plot of phase velocity
clear all
N_max = 101;
% number of points for plot
t = linspace(0,30d-15,N_max);
% creation of theta arguments
%
c = 3d14;
% velocity of light in microns/s
n = 3.4;
% refractive index
v_p = c/n;
% phase velocity
lambda = 1.0;
% microns
k = 2*pi/lambda;
frequency = v_p/lambda;
z = 0.6;
% distance in microns
omega = 2*pi*frequency;
A = sin(k*z - omega*t);
plot(t,A,’LineWidth’,1.5)
xlabel(’Time’,’FontSize’,14);
ylabel(’Amplitude’,’FontSize’,14);
set(gca,’FontSize’,14);
% size of tick marks on both axes
axis([0 30d-15 -1.5 2])
text(17d-15, 1.3, ’z(t)’,’Fontsize’,16)
line([1.53d-14,2d-14],[1,1],’LineWidth’,3.0)
% drawing arrow
line([1.9d-14,2d-14],[1.1,1],’LineWidth’,3.0)
line([1.9d-14,2d-14],[0.9,1],’LineWidth’,3.0)
pause
close all
Listing 2A.2
Function group velocity.m. MATLAB program which plots group velocity.
% File name: group_velocity.m
% Illustrative plot of group velocity by superposition
% of two plane waves
clear all
N_max = 300;
% number of points for plot

33
Appendix 2A
t = linspace(0,300d-15,N_max);
% creation of theta arguments
%
c = 3d14;
% velocity of light in microns/s
n = 3.4;
% refractive index
v_p = c/n;
% phase velocity
lambda = 1.0;
% microns
frequency = v_p/lambda;
z = 0.6;
% distance in microns
omega = 2*pi*frequency;
k = 2*pi/lambda;
Delta_omega = omega/15.0;
Delta_k = k/15.0;
%
omega_1 = omega + Delta_omega;
omega_2 = omega - Delta_omega;
k_1 = k + Delta_k;
k_2 = k - Delta_k;
A = 2*cos(k*z - omega*t).*cos(Delta_k*z - Delta_omega*t);
plot(t,A,’LineWidth’,1.3)
xlabel(’Time’,’FontSize’,14)
ylabel(’Amplitude’,’FontSize’,14)
set(gca,’FontSize’,14);
% size of tick marks on both axes
pause
close all
Listing 2A.3
Function FP transmit.m. Program plots transmittance of Fabry-Perot etalon.
% FP_transmit.m
% Plot of transmittance of FP etalon
clear all
N_max = 401;
% number of points for plot
t = linspace(0,1,N_max);
% creation of theta arguments
delta = (5*pi)*t;
% angles in radians
%
hold on
for r = [0.2 0.4 0.8]
% reflection coefficient
F = 4*r^2/(1-r^2).^2;
% coefficient of finesse
T = 1./(1 + F*(sin(delta/2)).^2);
plot(delta,T,’LineWidth’,1.5)
end
%
% Redefine figure properties
ylabel(’Transmittance’,’FontSize’,14)
xlabel(’Phase difference (rad)’,’FontSize’,14)

34
Basic facts about optics
set(gca,’FontSize’,14);
% size of tick marks on both axes
text(6.1, 0.05, ’2 \pi’,’Fontsize’,14)
text(12.2, 0.05, ’4 \pi’,’Fontsize’,14)
text(8.5, 0.1, ’r = 0.8’,’Fontsize’,14)
text(8.5, 0.5, ’r = 0.4’,’Fontsize’,14)
text(8.5, 0.8, ’r = 0.2’,’Fontsize’,14)
%
pause
close all
References
[1] F. L. Pedrotti and L. S. Pedrotti. Introduction to Optics. Third Edition. Prentice Hall,
Upper Saddle River, NJ, 2007.
[2] E. Hecht. Optics. Fourth Edition. Addison-Wesley, San Francisco, 2002.
[3] Y. Yamamoto. Characteristics of AlGaAs Fabry-Perot cavity type laser ampliﬁers. IEEE
J. Quantum Electron., 16:1047–52, 1980.
[4] L. Yung-Kuo, ed. Problems and Solutions on Optics. World Scientiﬁc, Singapore, 1991.
[5] J. W. Fleming. Dispersion in GeO2 −SiO2 glasses. Applied Optics, 23:4486–93, 1984.
[6] S. O. Kasap. Optoelectronics and Photonics: Principles and Practices. Prentice Hall,
Upper Saddle River, NJ, 2001.
[7] G. Ghosh, M. Endo, and T. Iwasaki. Temperature-dependent Sellmeier coefﬁcients and
chromatic dispersions for some optical ﬁber glasses. J. Lightwave Technol., 12:1338–
42, 1994.

3
Basic facts from electromagnetism
In this chapter we review foundations of electromagnetic theory and basic properties of
light.
3.1 Maxwell’s equations
Our discussion is based on Maxwell’s equations which in differential form are [1], [2]
∇× E = −∂B
∂t
(3.1)
∇× H = J + ∂D
∂t
(3.2)
∇· D = ρv
(3.3)
∇· B = 0
(3.4)
where
E is electric ﬁeld intensity [V/m]
B is magnetic ﬂux density [T]
H is magnetic ﬁeld intensity [A/m]
D is electric ﬂux density [C/m2]
J is electric current density [A/m2]
ρv is volume charge density [C/m3].
The operator ∇in Cartesian coordinates is
∇=
 ∂
∂x, ∂
∂y, ∂
∂z

(3.5)
The above relations are supplemented with constitutive relations
D = εE
(3.6)
B = μH
(3.7)
J = σE
(3.8)
where ε = ε0εr is the dielectric permittivity [F/m], μ = μ0μr is permeability [H/m], σ is
electric conductivity, εr is the relative dielectric constant. For optical problems considered
here, μr = 1.
35

36
Basic facts from electromagnetism
First, we recall two mathematical theorems, Gauss’s theorem

S
F · ds =

V
∇· Fdv
(3.9)
where S is the closed surface area deﬁning volume V , and Stokes’s theorem

L
F · dl =

A
∇× F · ds
(3.10)
where contour L deﬁnes surface area A. With the help of the above theorems, Maxwell’s
equations in differential form can be transformed into an integral form. Integral forms of
Maxwell’s equations are

S
D · ds =

V
ρvdv
(3.11)

S
B · ds = 0
(3.12)

L
E · dl = −

A
∂B
∂t
(3.13)

L
H · dl =

A
∂D
∂t + I
(3.14)
Properties of the medium are mostly determined by ε, μ and σ. Further, for the dielectric
medium the main role is played by ε. The medium is known as linear if ε is independent
of E; otherwise it is nonlinear. If it does not depend on position in space, the medium is
said to be homogeneous; otherwise it is inhomogeneous. If properties are independent of
direction, the medium is isotropic; otherwise it is anisotropic.
3.2 Boundary conditions
Boundary conditions are derived from an integral form of Maxwell’s equations. For that
purpose we separate all vectors into two components, one parallel to the interface and one
normal to the interface. The derivation of boundary conditions is facilitated by using the
contour and cylindrical shapes as shown in Fig. 3.1. It will be done independently for the
electric and magnetic ﬁelds.
3.2.1 Electric boundary conditions
First, analyse transversal components. Integrate Eq. (3.13) over closed loop C, see Fig. 3.1
and then set h →0

ABCDA
E · dl = −E1 · dl + E2 · dl = −E1tw + E2tw = 0

37
Boundary conditions
A
B
C
D
Medium 2
Medium 1
n1
n2
E2
D2
D1
E1
εr1
εr2
C
w
h
h
ρs
Fig. 3.1
An interface between two media. Contour and volume used to derive boundary conditions for fields between two
different dielectrics are shown.
Therefore
E1t = E2t
(3.15)
The tangential component of the electric ﬁeld is therefore continuous across the boundary
between any two dielectric media. Using general relation (3.6) one obtains the boundary
condition for tangential component of vector D
D1t
εr1
= D2t
εr2
(3.16)
In order to obtain conditions for normal components, consider the cylinder shown in Fig. 3.1.
Here, n1 and n2 are normal vectors pointing outwards of the top and bottom surfaces into
corresponding dielectrics. Apply Gauss’s law with integration over surface S of the cylinder

S
D · ds =

top
D1 · n1ds +

bottom
D2 · n2ds = ρss
The contribution from the outer surface of the cylinder vanishes in the limit h →0. Use
the fact that n2 = −n1 and have
n1 · (D1 −D2) = ρs
(3.17)
or
εr1E2n −εr2E1n = ρs
(3.18)
when using general relation (3.6). Normal component of vector D is not continuous across
boundary (unless ρs = 0).
3.2.2 Magnetic boundary conditions
When deriving boundary conditions for magnetic ﬁelds, we use approach similar as for
electric ﬁelds. We use Eq. (3.12) where integration is over the cylinder

S
B · ds = 0

38
Basic facts from electromagnetism
Table 3.1 Summary of boundary conditions for electric and magnetic fields.
Field components
General form
Speciﬁc form
Tangential E
n2 × (E1 −E2) = 0
E1t = E2t
Normal D
n2 · (D1 −D2) = ρs
D1t −D2t = ρs
Tangential H
n2 × (H1 −H2) = Js
H2t = H1t
Normal B
n2 · (B1 −B2) = 0
B1n = B2n
or
B1n = B2n
(3.19)
Using general relation (3.7), one obtains condition for magnetic ﬁeld H
μr1H1n = μr2H2n
(3.20)
The above relations tell us that normal component of B is continuous across the boundary.
To obtain how transversal magnetic components behave across interface, apply Ampere’s
law for contour C and then let h →0. One obtains

C
H · dl =
 B
A
H2 · dl −
 D
C
H1 · dl = I
Here I is the net current crossing the surface of the loop. As we let h approach zero, the
surface of the loop approaches a thin line of length w. Hence, the total current ﬂowing
through this thin line is I = Js · w, where Js is the magnitude of the normal component of
the surface current density traversing the loop. We can therefore express the above equation
as
H2t −H1t = Js
(3.21)
Utilizing unit vector n2, the above relation can be written as
n2 × (H1 −H2) = Js
(3.22)
where n2 is the normal vector pointing away from medium 2, see Fig. 3.1. Js is the surface
current.
In Table 3.1 we summarize boundary conditions between two dielectrics for the electric
and magnetic ﬁelds. The behaviour of various ﬁeld components is shown schematically in
Fig. 3.2.
3.3 Wave equation
Here, we will derive the wave equation for a source-free medium where ϱv = 0 and J = 0.
The wave equation is obtained by applying ∇× operation to both sides of Eq. (3.1). One

39
Time-harmonic fields
medium 1 
medium 2 
medium 1 
medium 2 
2n
B
1n
B
1t
E
1t
H
2t
E
2t
H
2n
D
1n
D
Fig. 3.2
Boundary conditions for fields.
obtains
∇× ∇× E = −∂
∂t (∇× B) = −μ ∂
∂t (∇× H) = −μ ∂
∂t
∂D
∂t = −με ∂2D
∂t2
where we have used Maxwell Eq. (3.2) and relation (3.6). Next apply the following mathe-
matical formula
∇× ∇× E = ∇(∇· E) −∇2E
(3.23)
With the help of Maxwell Eq. (3.3), one ﬁnds ﬁnally
∇2E −με ∂2
∂t2 E
(3.24)
which is the desired wave equation. The quantity με is related to velocity of light in a
vacuum as (assuming μr = 1)
με = μ0ε0εr = n2
c2
(3.25)
where n is the refractive index of the medium.
3.4 Time-harmonic fields
In many practical situations ﬁelds have sinusoidal time dependence and are known as
time-harmonic. This fact is expressed as
E(r,t) = Re

E (r) e jωt
(3.26)
where E (r) is the phasor form of E (r,t) and is in general complex. Re {...} indicates
‘taking the real part in’ quantity in brackets. Finally, ω is the angular frequency in [rad/s].
In what follows, all ﬁelds will be represented in phasor notation.

40
Basic facts from electromagnetism
Applying the time-harmonic assumption (3.26) to source-free Maxwell’s equations re-
sults in
∇× E = −jωμH
(3.27)
∇× H = jωεE
(3.28)
Applying the time-harmonic assumption again to wave equation (3.24) gives
∇2E + k2E = 0
(3.29)
where k = ω√με. Explicitly, the above wave equation is
 ∂2
∂x2 + ∂2
∂y2 + ∂2
∂z2 + k2

Ei = 0
(3.30)
with i = x, y, z.
Example
As an example, consider propagation of a uniform plane wave characterized by a
uniform electric ﬁeld with nonzero component Ex. Assume also
∂2Ex
∂x2 = 0,
∂2Ex
∂y2 = 0
(3.31)
The wave equation reduces to
∂2Ex
∂z2 + k2Ex = 0
(3.32)
and has the following forward propagating solution:
Ex(z) = E0ejkz
(3.33)
Magnetic ﬁeld is determined from the Maxwell’s Equation (3.27)
∇× E =

ax
ay
az
0
0
∂
∂z
Ex(z)
0
0

= −jωμ

axHx + ayHy + azHz

(3.34)
Here ax, ay, az are unit vectors along x, y, z axes, respectively. From the above equation, one
ﬁnds
Hx = 0
(3.35)
Hy =
1
jωμ
∂Ex(z)
∂z
Hz = 0

41
Time-harmonic fields
y
x
H
E
H
H
k
k
k
E
E
z
Fig. 3.3
Visualization of the electric and magnetic fields.
Using the solution for Ex(z), one ﬁnally obtains the expression for magnetic ﬁeld
H = ayHy(z)
(3.36)
=
1
−jωμ(−jkEx)ay
(3.37)
= ay
k
ωμEx(z)
= ay
1
Z Ex(z)
where the impedance Z of the medium is deﬁned as Z =

μ
ε . The propagating wave is
shown in Fig. 3.3.
We ﬁnish this section by providing a useful relation between electric and magnetic ﬁelds.
Assuming time-harmonic and plane-wave dependence of both ﬁelds as
E ∼exp(iωt −ik · r)
and using constitutive relation (3.7), Maxwell Eq. (3.1) takes the form
k × E = ωμ0H
Introducing unit vector k along wave vector k and the expression for wave number k =
ωn √μ0ε0, one ﬁnds
nk × E = Z0H
where Z0 is the impedance of the free-space.

42
Basic facts from electromagnetism
3.5 Polarized waves
Here we will discuss the concept of polarization of electromagnetic waves. Polarization
characterizes the curve which E vector makes (in the plane orthogonal to the direction
of propagation) at a given point in space as a function of time. In the most general case,
the curve produced is an ellipse and, accordingly, the wave is called elliptically polarized.
Under certain conditions, the ellipse may be reduced to a circle or a segment of a straight
line. In those cases it is said that the wave’s polarization is circular or linear, respectively.
Since the magnetic ﬁeld vector is related to the electric ﬁeld vector, it does not need separate
discussion. First, consider a single electromagnetic wave.
3.5.1 Linearly polarized waves
Consider an electromagnetic wave characterized by electric ﬁeld vector E directed along
the x-axis
E = axE0 cos (ωt −kz + φ)
(3.38)
It is known as a linearly polarized plane wave with the electric ﬁeld vector oscillating in
the x direction. Wave propagates in the +z direction. In Eq. (3.38) ω = 2πν is the angular
frequency and k is the propagation constant deﬁned as
k = ω
v
where v = c/n is the velocity of the electromagnetic wave in the medium having refractive
index n. φ is known as a phase of electromagnetic wave.
The electromagnetic wave can also be written in the complex representation as
E = axE0ei(ωt−kz+φ)
(3.39)
The actual ﬁeld as described by Eq. (3.38) is obtained from (3.39) by taking real part. A
more general expression for the electromagnetic wave is
E =eE0ei(ωt−k·r+φ)
which is known as the plane polarized wave. Here unit vectore lies in the plane known as
plane of polarization. It is perpendicular to vector k which describes direction of propagation
k ·e = 0
3.5.2 Circularly and elliptically polarized waves
In general, when we have an arbitrary number of plane waves propagating in the same
direction they add up to a complicated wave. In the simplest case, one has only two such
plane waves. To be more speciﬁc, consider two plane waves oscillating along orthogonal

43
Polarized waves
directions. They are linearly polarized having the same frequencies and propagating in the
same direction
E1 = Exax = axE0x cos (ωt −kz)
(3.40)
E2 = Eyay = ayE0y cos (ωt −kz + φ)
(3.41)
We want to know the type of the resulting wave and the curve traced by the tip of the total
electric vector E = E1 + E2
E = E1 + E2 = E0 {cos (ωt −kz) + cos (ωt −kz + φ)}
First, eliminate cos (ωt −kz) term. From Eq. (3.40)
cos (ωt −kz) = Ex
Eox
(3.42)
Use trigonometric identity
cos (α −β) = cos α cos β + sin α sin β
to express Eq. (3.41) as follows:
Ey = E0y

cos (ωt −kz) cos δ +

1 −cos2 (ωt −kz)
1/2 sin δ

Substitute Eq. (3.42) in the above and have
Ey
E0y
= Ex
E0x
cos φ +

1 −E2
x
E2
0x
1/2
sin φ
Squaring both sides gives
 Ey
E0y
−Ex
E0x
cos φ
2
=

1 −E2
x
E2
0x

sin2 φ
or
E2
y
E2
0y
−2 cos φ Ey
E0y
Ex
E0x
+ E2
x
E2
0x
cos2 φ + E2
x
E2
0x
sin2 φ = sin2 φ
Finally, the above equation gives
 Ey
E0y
2
+
 Ex
E0x
2
−2
 Ey
E0y
  Ex
E0x

cos φ = sin2 φ
(3.43)
This is general equation of an ellipse. Thus the endpoint of E(z,t) will trace an ellipse at a
given point in space. It is said that the wave is elliptically polarized.
When phase φ = π
2 , the resultant total electric ﬁeld is
 Ey
E0y
2
+
 Ex
E0x
2
= 1
which describes right elliptically polarized wave since as time increases the end of elec-
tric vector E rotates clockwise on the circumference of an ellipse. Typical situations are
illustrated in Fig. 3.4 where we show elliptic, circular and linear polarizations.

44
Basic facts from electromagnetism
z
x
y
z
x
y
z
x
y
E
E
E
(a)
(b)
(c)
Fig. 3.4
Typical states of polarization: (a) elliptic, (b) circular and (c) linear.
z
y
x
medium 1 
medium 2 
n
incident wave
reflected wave
Fig. 3.5
Picture used in defining plane of incidence.
3.6 Fresnel coefficients and phases
In this section we discuss electromagnetic wave undergoing reﬂection at the boundary
between two dielectrics, see Fig. 3.5. The plane of incidence is deﬁned as the plane formed
by unit vector n normal to the interface between two media and the directions of propagation
of the incident and reﬂected waves.
We will derive so-called Fresnel coefﬁcients [3] which are reﬂection and transmission
coefﬁcients expressed in terms of the angle of incidence and material properties (ε dielectric
constants) of the two dielectrics. Further, Fresnel phases are determined from Fresnel
coefﬁcients using the following deﬁnition [1]:
r = e−2jφ
(3.44)
Both reﬂection coefﬁcients r and phases φ will be calculated for both types of modes, TE
and TM.
3.6.1 TE polarization
Referring to Fig. 3.6 the E1i, E1r, E2t are complex values of incident, reﬂected and transmit-
ted electric ﬁelds in medium 1 and 2. The incident electric ﬁeld in medium 1 (E1i) is parallel
to the interface between both media. Such orientation is known as TE polarization. It is

45
Fresnel coefficients and phases
z
y
x
E1i
θ1
θ1
θ2
H1i
ki
kr
E1r
H1r
kt
E2t
H2t
medium 1
medium 2
Fig. 3.6
Fresnel reflection for TE polarization. Directions of vectors for TE polarized wave.
often said that electric ﬁeld vector E is normal to the plane of incidence. Such conﬁguration
is also known as s-polarization.
Boundary conditions require that the tangential components of the total ﬁeld E and the
total ﬁeld H on both sides of the interface be equal. Those conditions result in the following
equations:
E1i + E1r = E2t
(3.45)
−H1i cos θ1 + H1r cos θ1 = −H2t cos θ2
We also have the following relations involving impedances in both media:
E1i
H1i
= Z1,
E1r
H1r
= Z1,
E2t
H2t
= Z2
(3.46)
For a non-magnetic medium (μr = 1) the impedance can be written as Z = Z0
n , with n
being the refractive index of the medium and
Z0 =
μ0
ε0
is the impedance of a free space. Replacing magnetic ﬁelds in the second equation of
Eq. (3.45) by the electric ﬁelds using Eq. (3.46) gives
E1i + E1r = E2t
(3.47)
−E1i
Z1
cos θ1 + E1r
Z1
cos θ1 = −E2t
Z2
cos θ2
Reﬂection coefﬁcient is deﬁned as
rTE = E1r
E1i
(3.48)
From Eqs. (3.47) by eliminating E2t and using deﬁnition (3.48) one obtains 5
rTE = Z2 cos θ1 −Z1 cos θ2
Z2 cos θ1 + Z1 cos θ2

46
Basic facts from electromagnetism
Replacing impedances Z by refractive indices n, we ﬁnally have
rTE = n1 cos θ1 −n2 cos θ2
n1 cos θ1 + n2 cos θ2
=
n1 cos θ1 −

n2
2 −n2
1 cos θ1
n1 cos θ1 +

n2
2 −n2
1 cos θ1
(3.49)
using Snell’s law. For angles θ1 such that n2
2 −n2
1 cos θ1 < 0 the reﬂection coefﬁcient
becomes complex. For such cases, we write it as
rTE =
n1 cos θ1 −j

n2
1 cos θ1 −n2
2
n1 cos θ1 + j

n2
1 cos θ1 −n2
2
≡a −jb
a + jb
Such complex number can be expressed as
rTE = e−jφTE
ejφTE
= e−2jφTE
where we have deﬁned a + jb = e jφTE. Finally, using the deﬁnition of Fresnel phase,
Eq. (3.44) one obtains
tan φTE =

n2
1 sin2 θ1 −n2
2
n1 cos θ1
(3.50)
The above equation represents phase shift during reﬂection for TE polarized electromagnetic
wave. For a more detailed discussion about phase change on reﬂection consult books by
Pedrotti [4] and Liu [5].
Example
(a) Consider normal incidence of light on an air-silica interface. Compute the
fraction of reﬂected and transmitted power. Also, express the transmitted loss in decibels.
Assume refractive index of silica to be 1.45. (b) Repeat the calculations for Si which has
n = 3.50. (c) Consider coupling of GaAs optical source with a refractive index of 3.6 to a
silica ﬁbre which has refractive index of 1.48. Assume close physical contact of the ﬁbre
end and the source.
Solution
(a) The corresponding coefﬁcient known as reﬂectance [4] is
R = |r|2 =
n1 −n2
n1 + n2
2
(3.51)
Substituting values for air and silica, one has
R =
1.45 −1.00
1.45 + 1.00
2
= 0.03
so about 3% of the light is reﬂected. The remainder, 97%, is transmitted.

47
Fresnel coefficients and phases
z
y
x
medium 1
medium 2
E1i
H1i
ki
kr
E1r
H1r
kt
E2t
H2t
θ1
θ1
θ2
Fig. 3.7
Fresnel reflection for TM polarization. Directions of vectors for a TM polarized wave.
The transmission loss in dB is
−10 log10 0.97 = 0.13[dB]
This result shows that there is about 0.2dB loss when light enters glass from air.
(b) For Si, using the same procedure we obtain
R =
1.00 −3.50
1.00 + 3.50
2
= 0.309
This means that about 31% of light is reﬂected.
(c) The Fresnel reﬂection at the interface is
R =
3.60 −1.48
3.60 + 1.48
2
= 0.174
Therefore about 17.4% of the created optical power is emitted back into the source. The
power coupled into optical ﬁbre is
Pcoupled = (1 −R) Pemitted
The power loss, α in decibels is
α = −10 log10
Pcoupled
Pemitted
= −10 log10 (1 −R)
= −10 log10 ((1 −0.174)) −10 log10 (0.826) = 0.83[dB]
3.6.2 TM polarization
Field conﬁguration used to analyse reﬂection for TM polarization (magnetic ﬁeld parallel
to the interface) is shown in Fig. 3.7. Here, electric ﬁeld vector E is parallel to the plane of
incidence. Such conﬁguration is also known as p-polarization.

48
Basic facts from electromagnetism
We will derive coefﬁcient of reﬂection rTM for TM mode. As before the E1i, E1r, E2t are
(complex) values of incident, reﬂected and transmitted electric ﬁelds in medium 1 and 2.
Similar notation holds for magnetic vectors. Boundary conditions require that tangential
components are continuous across interface. The relevant conditions are
E1i cos θ1 −E1r cos θ1 = E2t cos θ2
(3.52)
H1i + H1r = H2t
Using Eqs. (3.46) for impedances to eliminate magnetic ﬁelds in the previous equations
results in the following:
E1i cos θ1 −E1r cos θ1 = E2t cos θ2
(3.53)
E1i
Z1
+ E1r
Z1
= E2t
Z2
Reﬂection coefﬁcient is deﬁned as
rTM = E1r
E1i
(3.54)
From Eqs. (3.53)
rTM = Z1 cos θ1 −Z2 cos θ2
Z1 cos θ1 + Z2 cos θ2
It can be also expressed in terms of refractive index
rTM = n2 cos θ1 −n1 cos θ2
n2 cos θ1 + n1 cos θ2
=
n2 cos θ1 −

n2
1 −n2
2 cos θ1
n2 cos θ1 +

n2
1 −n2
2 cos θ1
(3.55)
TM phase is obtained in the same way as for TE polarization. Final result is
tan φTM = n2
1
n2
2
×

n2
1 sin2 θ1 −n2
2
n1 cos θ1
(3.56)
Again, for more information consult [4] and [5].
3.7 Polarization by reflection from dielectric surfaces
In interpreting the formulas for rTE and rTM we distinguish between two situations:
(1) for n1 <n2 or n = n2
n1 > 1, one deﬁnes so-called external reﬂection,
(2) for n1 >n2 or n = n2
n1 < 1, one deﬁnes so-called internal reﬂection.
Example of (1) is air-to-glass reﬂection and example of (2) is the glass-to-air reﬂection.
A plot of coefﬁcients of reﬂection for n = 1.50 is shown in Fig. 3.8. MATLAB code is

49
Polarization by reflection from dielectric surfaces
0
20
40
60
80
100
−1
−0.8
−0.6
−0.4
−0.2
0
0.2
0.4
Angle of incidence
rTE
rTM
θB
Fig. 3.8
Reflections of TE and TM modes for external reflection with n = 1.50. Brewster’s angle is also shown.
medium 1 
medium 2 
polarized
partially
polarized
unpolarized
B
θ
Fig. 3.9
Polarization at Brewster’s angle.
shown in Appendix, Listing 3A.1. The so-called Brewster’s angle for which rTM = 0 is
also shown. For more information, see the book by Pedrotti and Pedrotti [4].
One can obtain polarization by reﬂection at Brewster’s angle, see Fig. 3.9. In the ﬁgure
we illustrate properties of the reﬂected and transmitted light incident at the surface at
Brewster’s angle.
Unpolarized light is incident at the interface at Brewster’s angle θB. Upon reﬂection one
obtains polarized TM light. At the same time, the refracted light is only partially polarized
since rTE is nonzero.
At Brewster’s angle θB of incidence, coefﬁcient of reﬂection rTM (also known as r∥since
E is parallel to the plane of incidence) is zero; i.e. r∥= 0. The above happens when the

50
Basic facts from electromagnetism
sum of the angles of incidence and refraction is equal to π/2
θ1 + θ2 = π
2
No such angle exists for the s polarization (TE). Thus if an unpolarized light is incident at
Brewster’s angle, the reﬂected light will be linearly polarized, in fact s-polarized.
3.7.1 Expression for Brewster’s angle
Expression for rTM is
rTM =
n2 cos θ1 −n1
n2

n2
2 −n2
1 sin2 θ1
n2 cos θ1 + n1
n2

n2
2 −n2
1 sin2 θ1
Vanishing of rTM corresponds to θ1 = θB. We have
n2 cos θB −n1
n2

n2
2 −n2
1 sin2 θB = 0
from which we ﬁnd an expression for Brewster’s angle
tan θB = n2
n1
3.8 Antireflection coating
In Chapter 9 on semiconductor optical ampliﬁers (SOA) we will discuss why there is a
need to reduce (or completely eliminate) the effect of reﬂections. Therefore, the practical
question is how to eliminate reﬂections at the interface between two dielectrics.
As seen before, light passing through a boundary between two dielectrics is lost due to
reﬂection, see Eq. (3.51). The effect depends on the difference of the values of refractive
indices between neighbouring layers. One can observe that for equal refractive indices there
will be no reﬂection but also no refraction, which is not a very interesting possibility.
A practical method of reducing reﬂections is to use several layers with properly selected
values of refractive indices. For a single layer, interference of two reﬂected waves can lead
to elimination of reﬂection, but only at a particular wavelength.
Let us analyse this situation in more detail. Consider reﬂections of two waves R1 and R2,
see Fig. 3.10. One of the conditions for destructive interference is that the amplitudes of
both reﬂected waves should be equal. From Eq. (3.51), reﬂection of ray R1 at interface ‘a’
is described by reﬂection coefﬁcient
R =
n0 −n f
n0 + n f
2

51
Antireflection coating
h
I
T
R1
R 2
nf
ns
n0
a
b
Fig. 3.10
Illustration of reflection from single dielectric film layer. Case of destructive interference is shown.
whereas reﬂection of ray R2 at interface ‘b’ is described by coefﬁcient
R =
ns −n f
ns + n f
2
Both coefﬁcients should be equal which gives
n0 −n f
n0 + n f
2
=
ns −n f
ns + n f
2
Assuming that the upper medium is air, i.e. n0 = 1, from the above one ﬁnds expression
for the value of refractive index for a layer as
n f =

ns
(3.57)
Therefore, at a particular wavelength there will be no reﬂection once the refractive index
of coating layer is given by (3.57). If there is a need to design structures producing no
reﬂection over some frequency band, one must design multilayer structure consisting of
layers with different refractive indices. In order to design such structures a more realistic
description is necessary. Typical calculations are based on transfer matrix approach.
3.8.1 Transfer matrix approach
We now describe the transfer matrix approach, also known as the characteristic matrix
approach [6].
Consider a single dielectric layer with refractive index n deposited on a substrate with
refractive index ns. Above it is a medium with refractive index n0, see Fig. 3.11.
We consider an s-polarized wave where electric ﬁeld vector E is perpendicular to the
plane of incidence. Boundary conditions dictate that tangential components of E and H
ﬁelds are continuous across the interfaces, i.e. at positions z = z1 and z = z2.
We introduce the convention that E+(z) denotes light propagating in the positive z
direction whereas E−(z) denotes light propagating in the negative z direction. Close to
interface described by z = z1, due to continuity of tangential component one writes
E(z1) = E+(z+
1 ) + E−(z+
1 ) = E+(z−
1 ) + E−(z−
1 )
(3.58)

52
Basic facts from electromagnetism
n
z
z1
z2
n0
α0
α
α
αs
ns
E  (    )
- z1-
E  (    )
z2
E  (    )
+
+
+
+
+
z1
E  (    )
z2
-
E  (    )
- z2-
E
Fig. 3.11
Illustration of electromagnetic fields at the boundaries used in the derivation of transfer matrix.
where z+
1 signiﬁes value of coordinate z slightly larger than z1, etc. Similarly, close to z = z2
E(z2) = E+(z+
2 ) + E−(z+
2 ) = E+(z−
2 ) + E−(z−
2 )
(3.59)
For future use we introduce d = z2 −z1. When ﬁeld E(z) propagates in the ﬁlm over
distance d, it acquires phase δ derived previously (see Eq. 2.31)
δ = 2π
λ0
nd cos α
(3.60)
Electric ﬁelds that are close to interfaces are therefore related as
E+(z−
2 ) = E+(z+
1 )e−iδ
(3.61)
and
E−(z−
2 ) = E−(z+
1 )eiδ
(3.62)
To determine the behaviour of a magnetic ﬁeld, we use the fact that ﬁelds E and H are
related as
H = n
Z0
k × E
where k is the unit vector along the wave vector k and Z0 =

μ0
ε0 is the impedance of the
free space. The condition of continuity of tangential component of H vector gives:
at z = z1
Z0H(z1) =

E+(z−
1 ) −E−(z−
1 )

n0 cos α0 =

E+(z+
1 ) −E−(z+
1 )

n cos α
(3.63)
at z = z2
Z0H(z2) =

E+(z−
2 ) −E−(z−
2 )

n cos α = E+(z+
2 )ns cos α
(3.64)
Substitute Eqs. (3.61) and (3.62) involving phase δ into (3.59) and (3.64) to obtain
E(z2) = E+(z+
1 )e−iδ + E−(z+
1 )eiδ
H(z2) = n cos α
Z0

E+(z+
1 )e−iδ −E−(z+
1 )eiδ

53
Bragg mirrors
Solutions of the above equations are
2E−(z+
1 )eiδ = E(z2) −
Z0
n cos α H(z2)
2E+(z+
1 )e−iδ = E(z2) +
Z0
n cos α H(z2)
With the help of the above solutions and using Eqs. (3.58) and (3.63) we can evaluate ﬁelds
at z1 and z2
E(z1) = E(z2) cos δ +
Z0
n cos α H(z2)i sin δ
and
Z0H(z1) = E(z2)i sin δn cos α + Z0H(z2) cos δ
The above equations can be written in matrix form
E(z1)
Z0H(z1)

=

cos δ
i sin δ
n cos α
in sin δ cos α
cos δ
 E(z2)
Z0H(z2)

= ←→
M
E(z2)
Z0H(z2)

(3.65)
For normal incidence, i.e. α = 0, the transfer matrix is
←→
M =
 cos δ
i sin δ
n
in sin δ
cos δ

(3.66)
Special cases of importance are:
1. The quarter-wave layer when nd = λ0/4; δ = π/2 and matrix ←→
M is
←→
M λ/4 =
0
i
n
in
0

(3.67)
2. The half-wave layer when nd = λ0/2; δ = π and matrix ←→
M is
←→
M λ/2 =
−1
0
0
−1

(3.68)
3.9 Bragg mirrors
The Bragg mirror, also known as the Bragg reﬂector, consists of identical layers of dielectrics
with high and low values of refractive indices as shown in Fig. 3.12. The main interest in
fabricating such structures is that they have extremely high reﬂectivities at optical and
infrared frequencies. They are important elements of VCSELs where high reﬂectivity and
bandwidth are required. A typical structure forming Bragg mirror consists of N layers of
dielectrics with refractive indices nL (low refractive index) and nH (high refractive index).
The ratio of those values, the so-called contrast ratio, plays an important role.
The structure is known as a quarter-wave dielectric stack, which means that the optical
thicknesses are quarter-wavelength long; that is nH ·aH = nL·aL = λ0/4 at some wavelength

54
Basic facts from electromagnetism
y
E
z
y
x
aH
aL
H
n
H
n
H
n
H
n
L
n
L
n
L
n
Fig. 3.12
Schematic of a seven-layer dielectric (Bragg) mirror; shown are N = 3 periods.
xn-2
xn-1
xn
(n-1) th cell
nth cell
xp
aH
aH
aL
aL
nL
nL
nH
nH
Cn–1
Dn–1
An–1
Bn–1
Cn
An
Bn
Dn
Fig. 3.13
Notation used in the analysis of Bragg mirrors.
λ0. The structure consists of an odd number of layers with the high index layer being the
ﬁrst and the last layers [7].
Here, we outline a formalism which is used in the design of Bragg mirrors. We also
illustrate its applications with an example. We restrict our discussion to s-polarization (TE
modes). Electric ﬁeld vector is directed along y-axis E = E(x) ·ay, see Fig. 3.12 where we
showed the orientation of electric ﬁelds and analysed structure.
We develop transfer matrix notation which is based on the transfer of ﬁelds from cell n
to cell n −1. The cell is formed by two neighbouring layers which create a basic periodic
structure which is then repeated some number of times. The electric ﬁeld will now be
expressed in the three layers of interest, see Fig. 3.13 for notation.
In cell n one expresses the electric ﬁeld as
Ey(x) =
	
An e−jkH (x−xn) + Bn ejkH (x−xn),
xp < x < xn
Cn e−jkL(x−xp) + Dn e jkL(x−xp),
xn < x < xp
(3.69)
where k2
H =
 nHω
c
2 and k2
L =
 nLω
c
2. One has also the following relations for coordinates
of layers: xn = n · , xn−1 = (n −1) · , xp = n ·  −aH. Here  = aH + aL is the period
of the structure.

55
Bragg mirrors
The magnetic ﬁeld vector is determined from the Maxwell equation, Eq. (3.1). For our
geometry, one has the relation between electric and magnetic ﬁelds
∂Ey(x)
∂x
= −jωμ0Hz
(3.70)
From continuity of electric ﬁeld at xp and xn−1 one obtains
x = xp
Cn + Dn = An ejkH ·aH + Bn e−jkH·aH
x = xn−1
An−1 + Bn−1 = Cn e jkL·aL + Dn e−jkL·aL
(3.71)
Similarly, continuity of magnetic ﬁeld produces equations
x = xp
−kLCn + kLDn = −kHAn e jkH ·aH + kHBn e−jkH ·aH
x = xn−1
−kHAn−1 + kHBn−1 = −kLCn e jkL·aL + kLDn e−jkL·aL
(3.72)
The previous four equations can be written in matrix forms as follows:
 1
1
kL
−kL
 Cn
Dn

=
 e−jkH aH
e jkH aH
kHe−jkHaH
−kHejkHaH
 An
Bn

and
 1
1
kH
−kH
 An−1
Bn−1

=
 ejkLaL
e−jkLaL
kLe jkLaL
−kLe−jkLaL
 An
Bn

The above equations transfer ﬁelds from cell n to cell n −1. In the next step amplitudes
Cn
Dn

will be eliminated and the transfer process will be described in terms of amplitudes
An
Bn

. By doing so, one obtains the practical equation
An−1
Bn−1

= ←→
T
An
Bn

(3.73)
Matrix ←→
T can be expressed as
←→
T = ←→
X H · ←→
T L · ←→
X L · ←→
T H
(3.74)
Matrix ←→
T L describes propagation in a uniform medium having refractive index nL and
thickness aL and has the form
←→
T L =
e jkLaL
0
0
e−jkLaL

(3.75)
Similarly, matrix ←→
T H describes propagation in a uniform medium having refractive index
nH and thickness aH. Matrices ←→
X H and ←→
X L describe behaviour at interfaces and are
←→
X H =
⎡
⎢⎢⎣
kH + kL
2kH
kH −kL
2kH
kH −kL
2kH
kH + kL
2kH
⎤
⎥⎥⎦
(3.76)

56
Basic facts from electromagnetism
H
n
2th cell
Nth cell
1th cell
H
n
H
n
H
n
L
n
L
n
L
n
A0
B0
AN
Fig. 3.14
Notation used in the definition of reflection from Bragg mirror.
and
←→
X L =
⎡
⎢⎣
kL + kH
2kL
kL −kH
2kL
kL −kH
2kL
kL + kH
2kL
⎤
⎥⎦
(3.77)
By referring to the Fig. 3.13 propagation (to the left) from an arbitrary point in the struc-
ture, say point xn involves matrix ←→
T H (propagation over a uniform region with nH, then
propagation over an interface from region having nH to nL (described by matrix ←→
X L), prop-
agation over uniform region with nL (described by matrix ←→
T L) and ﬁnally, propagation
over an interface from nL to nH (described by matrix ←→
X H).
Matrix ←→
T can be expressed as
←→
T =
a
b
c
d

(3.78)
where the elements are
a = eiaH kH

cos aLkL + i
2
kH
kL
+ kL
kH

sin aLkL

(3.79)
b = i
2e−iaH kH
 kL
kH
−kH
kL

sin aLkL
(3.80)
c = i
2eiaH kH
kH
kL
−kL
kH

sin aLkL
(3.81)
d = e−iaHkH

cos aLkL −i
2
kH
kL
+ kL
kH

sin aLkL

(3.82)
Matrix ←→
T is unimodular matrix, i.e. real square matrix with determinant ad −bc = ±1
[8].
Referring to Fig. 3.14, the amplitude reﬂection coefﬁcient is deﬁned as
r = B0
A0
(3.83)
Choosing a column vector of layer one as the zeroth unit cell and remembering that all cells
are identical, one obtains for N cells
A0
B0

=
a
b
c
d
N An
Bn

= ←→
T N
An
Bn


57
Bragg mirrors
1000
1200
1400
1600
1800
2000
2200
0
0.2
0.4
0.6
0.8
1
1.2
Wavelenght (nm)
Reflectivity
Fig. 3.15
Spectrum of reflectivity of a Bragg mirror.
Since matrix ←→
T is a unimodular matrix, one has the following relation [8]
a
b
c
d
N
=
!
a · UN−1(x) −UN−2(x)
b · UN−1(x)
c · UN−1(x)
d · UN−1(x) −UN−2(x)
"
where x = 1
2 (a + d) and UN(x) are Chebyshev polynomials of the second kind
Um(x) = sin

(m + 1) cos−1 x

√
1 −x2
= sin [(m + 1) θ]
sin θ
where x = cos θ. Using the above relations, the amplitude reﬂection coefﬁcient is evaluated
as
A0
B0

=
!
a · UN−1(x) −UN−2(x)
b · UN−1(x)
c · UN−1(x)
d · UN−1(x) −UN−2(x)
" AN
0

for cell N. From above relation, one ﬁnds
r = B0
A0
=
c · UN−1(x)
a · UN−1(x) −UN−2(x)
The deﬁnition of reﬂectance is [9] R = |r|2. After a little algebra one ﬁnds
R =
|c|2
|c|2 +
 sin K
sin NK
2
(3.84)
Spectrum of reﬂectivity as given by Eq. (3.84) for N = 10 periods of Bragg reﬂector is
shown in Fig. 3.15. The MATLAB code is shown in Appendix, Listing 3A.2. The following
parameters were adopted: nH = 2.25, nL = 1.45, aH = 167 nm and aL = 259 nm.

58
Basic facts from electromagnetism
A
B
x
z
sx
n 2
zs
2
θ
virtual reflecting plane
reflecting interface
0
n 1 n 2
>
Fig. 3.16
The lateral displacement of a light beam on total reflection at the interface between two dielectric media
(Goos-H¨anchen shift).
3.10 Goos-H¨anchen shift
Detailed examination of the internal reﬂection of a light beam on a planar dielectric interface
shows that the reﬂected beam is shifted laterally from the trajectory predicted by the simple
ray analysis, as shown in Fig. 3.16. The lateral displacement arises because wave energy
actually penetrates beyond the interface into the lower index media before turning around.
Total lateral shift is d = 2zs whereas xs is penetration depth.
To determine lateral shift d, we follow Kogelnik [10]. Consider incident beam A as
consisting of two plane waves incident at two slightly different angles with wave vec-
tors β ± β. The complex amplitude A(z) of the incident wave packet at the interface
x = 0 is
A(z) = e−j(β+β)z + e−j(β−β)z
= e−jβz 
e−jβz + ejβz
= 2 cos (βz) e−jβz
(3.85)
Reﬂected beam B is
B = R · A
(3.86)
where R = exp (2jφ). Phase shift φ that occurs upon reﬂection is different for both types
of polarization and has been determined before, see Eqs. (3.50) and (3.56). Phase shift φ is
a function of angle θ and propagation constant β. Assume a small value of β and expand
φ (β + β) = φ (β) + dφ
dβ β ≡φ (β) + φ
Using the above expansion and (3.85) allows us to write reﬂected beam B as
B = R · A = e2jφ(β±β) 
e−j(β+β)z + e−j(β−β)z
= e−j(βz−2φ) 
e j(βz−2φ) + e−j(βz−2φ)
= 2e−j(βz−2φ) cos (β −2zs)
(3.87)

59
Poynting theorem
where zs = dφ
dz . The net effect of the phase shift is to displace the beam along the z axis by
a distance 2zs. Distance zs is different for both types of modes. For TE modes [11]
k0zs =
tan θ

β2 −n2c
1/2
whereas for TM modes
k0zs =
tan θ

β2 −n2c
1/2
1
β2/n2
f + β2/n2c −1
3.11 Poynting theorem
Electromagnetic waves carry with them electromagnetic power. We will now deliver a rela-
tion between the rate of such energy transfer and the electric and magnetic ﬁeld intensities.
We start with Maxwell’s equations (3.1) and (3.2)
∇× E = −∂B
∂t
(3.88)
∇× H = ∂D
∂t + J
(3.89)
Use the following mathematical identity:
∇· (E × H) = H · (∇× E) −E(∇× H)
(3.90)
Substituting Maxwell’s equations into (3.90) and using constitutive relations, one obtains
∇· (E × H) = −H · μ∂H
∂t −E · J −E · μ∂E
∂t
= −μ1
2
∂H · H
∂t
−σE2 −ε1
2
∂E · E
∂t
= −∂
∂t
1
2εE2 + 1
2μH 2

−σE2
(3.91)
Integrate (3.91) over volume V and apply Gauss’s theorem, and then one ﬁnds

V
∇· (E × H)dv = −∂
∂t

V
1
2εE2 + 1
2μH 2

dv −

V
σE2dv
(3.92)
The Poynting vector P is deﬁned as
P = E × H
(3.93)
Eq. (3.92) can be written as
−

S
P · ds = ∂
∂t

V
(we + wm) dv +

V
pσdv
(3.94)

60
Basic facts from electromagnetism
where
we = 1
2εE2
is electric energy density
wm = 1
2μH 2
is magnetic energy density
pσ = σE2
is Ohmic power density
From the above equation, one can interpret vector P as representing the power ﬂow per
unit area.
3.12 Problems
1.
Using the expression derived for a transfer matrix, consider an antireﬂection structure
consisting of two-layer quarter-wave-thickness ﬁlms made of CeF3 (low index layer
with refractive index n1 = 1.65) and high-index layer of ZrO2 (refractive index
n = 2.1) deposited on glass substrate with refractive index ns = 1.52. Assume that
on top there is air with n0 = 1. Plot the spectral reﬂectance of such structure.
2.
Show that a linearly polarized plane wave can be decomposed into a right-hand and
a left-hand circularly polarized waves of equal amplitudes.
3.
Derive an expression for a transfer matrix assuming p-polarization. In this case the
vector of electric ﬁeld E is parallel to the plane of incidence.
4.
Determine the reﬂectance for normal incidence and plot it versus path differ-
ence/wavelength for various values of refractive index.
5.
Write a MATLAB program to illustrate propagation of EM wave elliptically po-
larized. The wave will consist of two perpendicular waves of unequal amplitudes.
Visualize propagation in 3D. Analyse the state of polarization (SOP) by changing
phase difference φ between individual waves.
6.
Analyse a Bragg mirror for TM polarization. Derive matrix elements of matrix ←→
T
for this polarization [9].
7.
Assume that for some materials refractive index at a particular wavelength is negative.
Discuss the consequences of such an assumption. Consider modiﬁcation of Snell’s
law.
8.
What percentage of the incoming irradiance is reﬂected at an air-glass (nglass = 1.5)
interface for a beam of natural light incident at 70◦?
9.
Write an expression for a right circularly polarized wave propagation in the positive
z-direction such that its E-ﬁeld points in the negative x-direction at z = 0 and t = 0.
10.
Verify that linear light is a special case of elliptical light.
3.13 Project
1. Write a MATLAB program to determine reﬂectance for a multilayered structure con-
sisting of different dielectric materials of various thicknesses. Analyse the special case
of d = λ/2.

61
Appendix 3A
Table 3.2 List of MATLAB functions for Chapter 3.
Listing
Function name
Description
3A.1
reﬂections TE TM.m
Plots reﬂections based on Fresnel equations for TE and
TM modes
3A.2
Bragg an.m
Plots reﬂectivity spectrum of Bragg mirror for TE mode
using an analytical method
2. Develop MATLAB functions to analyse propagation of TM modes for arbitrary mul-
tilayered waveguiding structure. Use a similar approach as described above for TE
modes.
Appendix 3A: MATLAB listings
In Table 3.2 we provide a list of MATLAB ﬁles created for Chapter 3 and a short description
of each function.
Listing 3A.1
Program reﬂections TE TM.m. Program plots reﬂection coefﬁcients for TE
and TM modes.
% reflections_TE_TM.m
% Plot of reflections based on Fresnel equations
% TE and TM reflections
% cases of external reflection
clear all
n = 1.50;
% relative refractive index
N_max = 11;
% number of points for plot
t = linspace(0,1,N_max);
% creation of theta arguments
theta = (pi/2)*t;
% angles in radians
% Plot reflection coefficients
num_TE = cos(theta) - sqrt(n^2-(sin(theta)).^2 );
den_TE = cos(theta) + sqrt(n^2-(sin(theta)).^2 );
r_TE = num_TE./den_TE;
% Plot for TE mode
num_TM = n^2*cos(theta) - sqrt(n^2-(sin(theta)).^2 );
den_TM = n^2*cos(theta) + sqrt(n^2-(sin(theta)).^2 );
r_TM = num_TM./den_TM;
% Plot for TM mode
%
angle_degrees = (theta./pi)*180;
x_line = [0 max(angle_degrees)];
% needed to draw horizontal line
y_line = [0 0];
% passing through zero
plot(angle_degrees,r_TE,angle_degrees,r_TM, x_line, y_line, ’-’,...
’LineWidth’,1.5)

62
Basic facts from electromagnetism
xlabel(’Angle of incidence’,’FontSize’,14)
set(gca,’FontSize’,14);
% size of tick marks on both axes
text(60, -0.6, ’r_{TE}’,’Fontsize’,14)
text(60, -0.2, ’r_{TM}’,’Fontsize’,14)
text(55, 0.1, ’\theta_{Brewster}’,’Fontsize’,14)
pause
close all
Listing 3A.2
Program Bragg an.m. Determines spectrum of reﬂectivity of a Bragg mirror
for TE mode using an analytical method.
% File name: bragg_an.m
% Determines reflectivity spectrum of Bragg mirror for TE mode
% using analytical method
clear all
N = 10;
% number of periods
n_L = 1.45;
% refractive index
n_H = 2.25;
% refractive index
a_L = 259;
% thickness (nm)
a_H = 167;
% thickness (nm)
Lambda = a_L + a_H;
% period of the structure
lambda = 1000:10:2200;
k_L = 2*pi*n_L./lambda;
k_H = 2*pi*n_H./lambda;
%
a=exp(1i*a_H*k_H).*(cos(k_L*a_L)+(1i/2)*(k_H./k_L+k_L./k_H).*sin(k_L*a_L));
d=exp(-1i*a_H*k_H).*(cos(k_L*a_L)-(1i/2)*(k_H./k_L+k_L./k_H).*sin(k_L*a_L));
b = exp(-1i*a_H*k_H).*((1i/2)*(k_L./k_H - k_H./k_L).*sin(k_L*a_L));
c = exp(1i*a_H*k_H).*((1i/2)*(k_H./k_L - k_L./k_H).*sin(k_L*a_L));
%
K = (1/Lambda)*acos((a+d)/2);
tt = (sin(K*Lambda)./sin(N*K*Lambda)).^2;
denom = abs(c).^2 + tt;
R = abs(c).^2./denom;
plot(lambda,R,’LineWidth’,1.5)
axis([1000 2200 0 1.2])
xlabel(’Wavelenght (nm)’,’FontSize’,14)
ylabel(’Reflectivity’,’FontSize’,14)
set(gca,’FontSize’,14);
% size of tick marks on both axes
pause
close all

63
References
References
[1] J. D. Kraus. Electromagnetics, Fourth Edition. McGraw-Hill, New York, 1992.
[2] D. K. Cheng. Field and Wave Electromagnetics. Second Edition. Addison-Wesley
Publishing Company, Reading, MA, 1989.
[3] Z. Popovic and B. D. Popovic. Introductory Electromagnetics. Prentice-Hall, Upper
Saddle River, NJ, 2000.
[4] F. L. Pedrotti and L. S. Pedrotti. Introduction to Optics. Third Edition. Prentice Hall,
Upper Saddle River, NJ, 2007.
[5] J.-M. Liu. Photonic Devices. Cambridge University Press, Cambridge, 2005.
[6] A. Thelen. Design of Optical Interference Coatings. McGraw-Hill, New York, 1989.
[7] R. S. Geels. Vertical-Cavity Surface-Emitting Lasers: Design, Fabrication and Char-
acterization. PhD thesis, University of California, Santa Barbara, 1991.
[8] E. W. Weisstein, Unimodular Matrix. From MathWorld–A Wolfram Web Resource,
http://mathworld.wolfram.com/UnimodularMatrix.html, 3 July 2012.
[9] P. Yeh, A. Yariv, and C.-S. Hong. Electromagnetic propagation in periodic stratiﬁed
media. I. general theory. J. Opt. Soc. Am., 67:423–38, 1977.
[10] H. Kogelnik. Theory of optical waveguides. In T. Tamir, ed., Springer Series in Elec-
tronics and Photonics. Guided-Wave Optoelectronics, volume 26, pp. 7–88. Springer-
Verlag, Berlin, 1988.
[11] C. R. Pollock and M. Lipson. Integrated Photonics. Kluwer Academic Publishers,
Boston, 2003.

4
Slab waveguides
Slab waveguides are important ingredients of both passive and active devices. Therefore,
discussion and understanding of their properties are critical. The following topics will be
discussed in this chapter:
• ray optics of the slab waveguide
• electromagnetic description
• three-layer problem for symmetric guiding structure
• TE modes in multilayer waveguide.
4.1 Ray optics of the slab waveguide
In this section we discuss applications of ray optics concepts to analyse the propagation
of light in slab waveguides. We start with summarizing the concept of numerical aperture
(NA).
4.1.1 Numerical aperture
Consider light entering a waveguide from air, having the refractive index n0 to waveguiding
structure with refractive indices n1 and n2 (see Fig. 4.1). We represent light within ray optics.
We want to understand the conditions under which light will propagate in the middle layer
with the value of refractive index n1.
Ray 1 (dashed line) which enters waveguide at large incident angle θ1 propagates through
the middle layer and penetrates the upper layer with refractive index n2. Since this ray does
not propagate in the middle layer, it is effectively lost.
As we gradually decrease incident angle θ, we reach the situation where a ray slides across
the interface (case for ray 3). In such a case incident angle θ is known as the acceptance
angle θa. The internal angle of incidence at point D is then φc and it is determined from the
relation
sin φc = n2
n1
(4.1)
For the incident ray (like ray 2) which enters the interface at an angle smaller than the
acceptance angle θ < θa, it will propagate in the middle layer. Let us analyse the existing
situation in more detail.
64

65
Ray optics of the slab waveguide
1
2
a
n
1
n2
n2
A
C
φ
φ
D
1
1
2
2
3
3
B
c
n
0
θ
θ
θ
Fig. 4.1
Light entering slab waveguide.
From triangle ABC, one ﬁnds θ2 = π/2 −φ (angle θ2 not shown in Fig. 4.1). From
Snell’s law for ray 3, we obtain
n0 sin θ1 = n1 sin θ2 = n1 sin (π/2 −φ) = n1 cos φ = n1

1 −sin2 φ
1/2
From the above, we have (using Eq. 4.1) for ray 2 (propagating at the acceptance angle, i.e.
for θ1 = θa)
n0 sin θa = n1

1 −sin2 φc
1/2 =

n2
1 −n2
2
1/2
Numerical aperture (NA) is deﬁned as
NA ≡n0 sin θa =

n2
1 −n2
2
1/2
(4.2)
We introduce relative refractive index difference  as
 ≡n2
1 −n2
2
2n2
1
The approximate expression for  is obtained by observing that n1 ≈n2, which allows us
to write n1 + n2 ≈2n1. The approximate formula for  is therefore
 = (n1 + n2) (n1 −n2)
2n2
1
≈2n1 (n1 −n2)
2n2
1
= n1 −n2
n1
In terms of , NA can be approximately expressed as
NA = n1 (2)1/2
4.1.2 Guided modes
We will ﬁrst discuss the propagation of a light ray in a waveguide formed by the ﬁlm of
dielectric surrounded from below by substrate and by cover layer from above, see Fig. 4.2. In
such a structure light travels in a zig-zag fashion through the ﬁlm. Light is monochromatic
and coherent and is characterized by ω angular frequency and λ free-space wavelength.
The following relation holds k = 2π
λ , where k is known as the wavenumber. Electric ﬁeld
of the propagating wave is
E ∼e−jkn f (±x cos φ+z sin φ)

66
Slab waveguides
film
nf
h
x
φ
cover
nc
substrate
ns
z
Fig. 4.2
Light propagation in a slab waveguide in a ray approximation.
Let β be a propagation constant of the guided mode of the slab. One has
β = ω
vp
= kn f sin φ
(4.3)
where vp is the phase velocity. Please note that not all angles are allowed (sometimes none).
Referring to Fig. 4.2, rays at φ = 90◦travel horizontally along the waveguide. Generally,
rays which undergo total internal reﬂection can travel within the waveguide. That condition
can be fulﬁlled for rays travelling at angles fulﬁlling the condition (all angles are determined
with respect to normal)
φc ≤φ ≤90◦
or
n f sinφc ≤n f sinφ ≤n f sin90◦= n f
where we have also multiplied the inequality by n f . Using Eqs. (4.1) and (4.3), one obtains
ns ≤N ≤n f
(4.4)
Here we introduced ‘effective guide index’ N deﬁned as
N = β
k = n f sinφ
(4.5)
4.1.3 Transverse resonance condition
The condition is expressed as ‘the sum of all phase shifts during propagation must be a
multiple of 2π’. The following are the contributions to the phase change:
kn f h cos φ
phase change during ﬁrst transverse passage through the ﬁlm
−2φc
phase shift on total reﬂection from cover
−2φs
phase shift on total reﬂection from substrate
Combining the above contributions, one obtains transverse resonance condition as
2kn f h cos φ −2φs −2φc = 2πν,
ν= 0, ± 1, ± 2, . . .
(4.6)
which is the dispersion equation of the guide. Variable ν identiﬁes mode number.

67
Ray optics of the slab waveguide
Expression for the Fresnel phase for TE polarization was derived in Chapter 3, Eq. (3.50).
Modifying notation slightly (angle θ1 is replaced by φ), the relation reads
tan φ =

n2
1 sin2 φ −n2
2
n1 cos φ
Adopting the above expression for our present geometry, one writes for phases on reﬂec-
tions:
1. for reﬂection on the ﬁlm-cover interface
tan φc =

n2
f sin2 φ −n2
c
n f cos φ
=

n2
f sin2 φ −n2
c

n2
f −n2
f sin2 φ
(4.7)
2. for reﬂection on the ﬁlm-substrate interface
tan φs =

n2
f sin2 φ −n2
s
n f cos φ
=

n2
f sin2 φ −n2
s

n2
f −n2
f sin2 φ
(4.8)
4.1.4 Transverse condition: normalized form
The above transverse condition will now be cast in a normalized form which is more suitable
for numerical work. For that, let us introduce the following variables: variable V
V ≡k · h

n2
f −n2
s
(4.9)
normalized guide index, b
b ≡N2 −n2
s
n2
f −n2
s
(4.10)
and asymmetry parameter for TE modes, a
a ≡n2
s −n2
c
n2
f −n2
s
(4.11)
For TE modes, use transverse resonance condition and Fresnel phases, and obtain
V
√
1 −b = ν · π + tan−1

b
1 −b + tan−1

b + a
1 −b
(4.12)
Example
Derive transverse resonance condition in a normalized form, Eq. (4.12).
Solution
Using deﬁnitions (4.10) and (4.11), one can prove the following relations:
b
1 −b = N2 −n2
s
n2
f −N2

68
Slab waveguides
and
b + a
1 −b = N2 −n2
c
n2
f −N2
and also
1 −b =
n2
f −N2
n2
f −n2
s
Using the above relations, the expressions for phases, Eqs. (4.7) and (4.8) can be written as
φc = tan−1
#
$
$
% N2 −n2
c
n2
f −N2 = tan−1

b + a
1 −b
and
φs = tan−1
#
$
$
% N2 −n2
s
n2
f −N2 = tan−1

b
1 −b
One also has
n f cos φ =

n2
f −n2
f sin
2φ =

n2
f −N2
Substituting the above formulas into (4.6), we obtain
V
√
1 −b = ν · π + tan−1

b
1 −b + tan−1

b + a
1 −b
A MATLAB program to analyse the transverse resonance condition (4.12) which plots
normalized guide index b versus variable V , is provided in the Appendix, Listing 4A.1. It
allows us to input different values of the asymmetry parameter a.
A plot of normalized guide index b versus variable V for three values of parameter a
(a = 0, 8, 50) is shown in Fig. 4.3.
We ﬁnish this section with a typical simpliﬁed expression for effective index N. From a
deﬁnition of b one obtains
b(n2
f −n2
s ) + n2
s ≡N2
Perform the algebraic steps
N2 =
&
1 + b
n2
f −n2
s
n2
s
'
n2
s
N =
#
$
$
%1 + b
n2
f −n2
s
n2
s
ns
N ≃
&
1 + b1
2
n2
f −n2
s
n2
s
'
ns
N =

1 + b1
2
(n f −ns)(n f + ns)
n2
s

ns

69
Fundamentals of EM theory of dielectric waveguides
0
5
10
15
20
0
0.2
0.4
0.6
0.8
1
V
b
ν=0
ν=1
ν=2
a=0
a=50
a=0
a=50
a=0
a=50
Fig. 4.3
Normalized b −V diagram of a planar waveguide for various degrees of asymmetry.
Finally, one ﬁnds
N ≈ns + 1
2b

n f −ns

(4.13)
4.2 Fundamentals of EM theory of dielectric waveguides
4.2.1 General discussion
Assuming time-harmonic ﬁelds and using constitutive relations, the source-free Maxwell
equations are
∇× E = −jωμH
(4.14)
∇× H = jωεE
(4.15)
Boundary conditions were derived in Chapter 3. Separate ﬁelds into transversal and longi-
tudinal components as
E = Et + Ez,
H = Ht + Hz
(4.16)
where
Et =

Ex, Ey, 0

is the transverse part and
Ez = [0, 0, Ez]

70
Slab waveguides
is the longitudinal part. Also
∇= ∇t + az
∂
∂z, az = [0, 0, 1]
(4.17)
where az is a unit vector along z-direction. Substituting (4.16) and (4.17) into Eqs. (4.14)
and (4.15), one obtains
∇t × Et = −jωμHz
(4.18)
∇t × Ht = jωεEz
(4.19)
∇t × Ez + az × ∂Et
∂z = −jωμHt
(4.20)
∇t × Hz + az × ∂Ht
∂z = jωεEt
(4.21)
Modes in a waveguide are characterized by a dielectric constant
ε(x, y) = ε0n2 (x, y)
(4.22)
where n (x, y) is the refractive index proﬁle in the transversal plane. Write the ﬁelds as
E (x, y, z) = Eν (x, y) e−jβνz
(4.23)
H (x, y, z) = Hν (x, y) e−jβνz
where we have introduced index ν which label modes and βν is the propagation constant
of the mode ν. After substitution of Eqs. (4.23) into (4.18)–(4.21) one obtains
∇t × Etν (x, y) = −jωμHzν (x, y)
(4.24)
∇t × Htν (x, y) = jωεEzν (x, y)
(4.25)
∇t × Ezν (x, y) −jβνaz × Etν (x, y) = −jωμHtν (x, y)
(4.26)
∇t × Hzν (x, y) −jβνaz × Htν (x, y) = jωεEtν (x, y)
(4.27)
From the analysis of the above equations, the existence of several types of modes can be
recognized. Those will be described in more details later on. Generally, the main modes are:
• guided modes (bound states) – discrete spectrum of βν
• radiation modes – belong to continuum
• evanescent modes-βν = −jαν; they decay as exp (−ανz).
4.2.2 Explicit form of general equations
Using the following general formulas
∇t × Et =

ax
ay
az
∂
∂x
∂
∂y
0
Ex
Ey
0

∇t × Ez =

ax
ay
az
∂
∂x
∂
∂y
0
0
0
Ez


71
Wave equation for a planar wide waveguide
(TE mode)
(TM mode)
Hy
Ey
x
y
z
Fig. 4.4
Planar wide waveguide.
az × Et =

ax
ay
az
0
0
1
Ex
Ey
0

where ax, ay, az are unit vectors along the corresponding directions, we write general
Eqs. (4.24)–(4.27) in expanded form (dropping mode index)

0, 0, ∂Ey
∂x −∂Ex
∂y

= −jωμ [0, 0, Hz]
(4.28)

0, 0, ∂Hy
∂x −∂Hx
∂y

= jωε [0, 0, Ez]
(4.29)
∂Ez
∂y , −∂Ez
∂x , 0

−jβ

−Ey, Ex, 0

= −jωμ

Hx, Hy, 0

(4.30)
∂Hz
∂y , −∂Hz
∂x , 0

−jβ

−Hy, Hx, 0

= jωε

Ex, Ey, 0

(4.31)
In the following sections the previous general equations will be used to analyse speciﬁc
situations.
4.3 Wave equation for a planar wide waveguide
For the wide waveguide where its dimension in the y-direction is much larger than thickness,
the ﬁeld conﬁguration along that direction remains approximately constant, see Fig. 4.4.
Therefore, we can consider only conﬁnement in the x-direction and set
∂
∂y = 0
Also, the refractive index assumes only x-dependence
n = n (x)
Such a waveguide supports two modes:
• transverse electric TE, where Ey ̸= 0 and Ex = Ez = 0
• transverse magnetic TM, where Hy ̸= 0 and Hx = Hz = 0.

72
Slab waveguides
From general formulas given by Eqs. (4.28)–(4.31), one obtains a set of three equations
describing TE modes and also three equations describing TM modes. Those are written
below for both types of modes separately.
TE modes
To describe TE modes we use only equations which involve Ey and its derivatives. One
observes that when Ex = Ez = 0, from Eq. (4.30) Hy = 0. Equations describing those
modes are
βEy = −ωμHx
(4.32)
∂Hz
∂x + jβHx = −jωεEy
(4.33)
∂Ey
∂x = −jωμHz
(4.34)
The last step will be to eliminate Hx and Hz. We will differentiate the third equation, then
substitute for ∂Hz
∂x using the second equation and ﬁnally eliminate Hx using ﬁrst equation.
We obtain a wave equation for TE modes
∂2Ey
∂x2 =

β2 −n2k2
Ey
(4.35)
where k = ω
c = ω√ε0μ0.
TM modes
We proceed in a similar way as for the TE modes. From Eq. (4.31) when Hx = Hz = 0,
one obtains that Ey = 0. We keep only equations which involve Hy and its derivatives.
Equations which describe TM modes are
βHy = ωεEx
∂Hy
∂x
= jωεEz
∂Ez
∂x + jβEx = jωμHy
We will use the fact that ε = ε0n2 and eliminate Ex and Ez. Here one must be more
careful because n2 can be x dependent. From the ﬁrst equation we determine Ex and from
the second equation we determine Ez. Substituting the results into the third equation gives
the wave equation for TM mode
n2 ∂
∂x
 1
n2 ∂x∂Hy
∂x

=

β2 −n2k2
Hy
(4.36)
4.4 Three-layer symmetrical guiding structure (TE modes)
We will analyse the three-layer symmetrical structure for TE modes. The structure is as
shown in Fig. 4.4. The details are illustrated in Fig. 4.5. A ﬁlm layer of thickness 2a and

73
Three-layer symmetrical guiding structure (TE modes)
x
z
y
nf
n0
n0
0
a
−a
Fig. 4.5
Planar three-layer symmetric waveguide.
refractive index n f is surrounded by a substrate and cladding layers have refractive indices
equal to n0.
We introduce the following notation:
κ2
f = n2
f k2 −β2
(4.37)
and
γ 2 = β2 −n2
0k2
(4.38)
Here, γ is determined by the value of refractive index around the ﬁlm. In general, γ assumes
values which are dictated by the values of refractive indices in the cladding and substrate.
Therefore, one deals with more than one value of γ .
The wave equation is
d2Ey(x)
dx2
=

β2 −n2k2
Ey(x)
We discuss two separate solutions: odd and even modes.
Odd modes:
We assume the following guiding solution:
Ey(x) = Ace−γ (x−a),
a<x
(cladding)
Ey(x) = B sin κ f x,
−a < x < a
(film)
Ey(x) = Aseγ (x+a),
x<-a
(substrate)
(4.39)
At the interfaces, i.e. for x = ±a, the ﬁeld Ey and its derivative dEy
dx must be continuous.
The continuity at x = a gives the following equations:
Ac = B sin κ f a
−γ Ac = κ f B cos κ f a
From above equations, one obtains
−γ = κ f cot κ f a
(4.40)
The continuity at x = −a gives an identical equation. By introducing variable
y = κ f a
Eq. (4.40) can be written as
−y cot y = γ a

74
Slab waveguides
y
2
3
2
1
R
π
π
g1
g2
g3
h
Fig. 4.6
Graphical solution of the transcendental equation for even modes.
From the deﬁnition for γ we obtain
−γ a = a

n2k2 −β2 =

a2n2k2 −a2β2
(4.41)
Similarly, from the deﬁnition for κ f we obtain
a2κ2
f = a2nn2
f k2 −a2β2
Determining a2β2 from the above and substituting into Eq. (4.41), one ﬁnds
−y cot y =

R2 −y2
(4.42)
where we have deﬁned
R2 = a2k2 (
n2
f −n2)
(4.43)
Transcendental Eq. (4.42) must be solved numerically.
Even modes:
For even modes we assume the following guiding solution:
Ey(x) = Ace−γ (x−a),
a < x
(cladding)
Ey(x) = B cos κ f x,
−a < x < a
(film)
Ey(x) = Aseγ (x+a),
x < −a
(substrate)
(4.44)
The remaining steps are done in the exactly same way as for odd modes. The resulting
transcendental equation for propagation constant is
y tan y =

R2 −y2
(4.45)
The function R is deﬁned by Eq. (4.43). Eq. (4.45) is represented in Fig. 4.6. Intersections
between line h which represents the right hand side of Eq. (4.45) and lines g′s which
represent the left hand side of Eq. (4.45), determine propagation constants. Those must be
found numerically. For numerical searches, the following functions are introduced:
feven(y) = y tan y −

R2 −y2
(4.46)
and
fodd(y) = −y cot y −

R2 −y2
(4.47)

75
Modes of the arbitrary three-layer asymmetric planar waveguide in 1D
The above functions are used in numerical search, since e.g. feven(y1) = 0 corresponds
to the solution y1 from which propagation constant β1 is determined. The algorithm is
described in the next section.
4.4.1 The algorithm
The following main steps constitute the numerical algorithm.
1. Search intervals for even and odd functions are formed as follows:
even functions
yi = nπ, y f = min
(
nπ + π
2 −10−3, R
)
odd functions
yi = π
2 + nπ, y f = min

(n + 1)π −10−3, R

where yi and y f are initial and ﬁnal values of the appropriate search interval. The small
constant (10−3) has been introduced to avoid working close to singularity.
2. Search is done for zeros in each interval.
3. Even and odd solutions are obtained independently in separate searches.
4. The solutions are found using MATLAB function fzero() as
ytemp = f zero

f unc,

yi, y f

where the ﬁrst argument contains search function and the second one contains interval for
search.
4.5 Modes of the arbitrary three-layer asymmetric planar
waveguide in 1D
Consider the modiﬁed version of the structure shown in Fig. 4.5. The structure has different
values of refractive indices of substrate and cladding and it is known as asymmetric planar
waveguide. Here, nc signiﬁes refractive index of cladding, n f of ﬁlm, and ns that of substrate.
For an asymmetric slab, nc ̸= ns. Deﬁne the following quantities:
κ2
c = n2
ck2 −β2 ≡−γ 2
c
κ2
f = n2
f k2 −β2
(4.48)
κ2
s = n2
sk2 −β2 ≡−γ 2
s
where γi describes transverse decay and κi contains propagation constants. i takes the
values c, f , s as appropriate. In the next subsection we discuss TE modes for this three-
layer structure.

76
Slab waveguides
4.5.1 TE modes
For guided TE modes the following solutions exist:
Ey(x) = Ace−γc(x−a)
a < x
(cover)
Ey(x) = A cos κ f x + B sin κ f x
−a < x < a
(ﬁlm)
Ey(x) = Aseγs(x+a)
x < −a
(substrate)
(4.49)
Derivatives are determined as follows:
dEy(x)
dx
= −γcAce−γc(x−a)
a < x
(cover)
dEy(x)
dx
= −κ f A cos κ f x + κ f B sin κ f x
−a < x < a
(ﬁlm)
dEy(x)
dx
= γsAseγs(x+a)
x < −a
(substrate)
(4.50)
Boundary conditions dictate that
Ey and dEy(x)
dx
are continuous for x = a and for x = −a
(4.51)
When applying boundary conditions for Ey and dEy(x)
dx , we get the following equations:
for x = −a
A cos κ f a −B sin κ f a = As
κ f A sin κ f a + κ f B cos κ f a = γsAs
for x = a
Ac = A cos κ f a + B sin κ f a
−γcAc = −κ f A sin κ f a + κ f B cos κ f a
The above equations can be written in a matrix form
⎡
⎢⎢⎣
cos κ f a
−sin κ f a
−1
0
κ f sin κ f a
κ f cos κ f a
−γs
0
cos κ f a
sin κ f a
0
−1
−κ f sin κ f a
κ f cos κ f a
0
γc
⎤
⎥⎥⎦
⎡
⎢⎢⎣
A
B
As
Ac
⎤
⎥⎥⎦= 0
(4.52)
For the above homogeneous system to have nontrivial solution, the main determinant should
vanish.

cos κ f a
−sin κ f a
−1
0
κ f sin κ f a
κ f cos κ f a
−γs
0
cos κ f a
sin κ f a
0
−1
−κ f sin κ f a
κ f cos κ f a
0
γc

= 0
(4.53)
The above determinant is evaluated as follows. Let us expand it over last column and we
get
γc

cos κ f a
−sin κ f a
−1
κ f sin κ f a
κ f cos κ f a
−γs
cos κ f a
sin κ f a
0

+

cos κ f a
−sin κ f a
−1
κ f sin κ f a
κ f cos κ f a
−γc
−κ f sin κ f a
κ f cos κ f a
0

= 0
Evaluating both determinants, we obtain
sin2 κ f a −cos2 κ f a + κ f
γc
sin κ f a cos κ f a −γs
κ f
sin κ f a cos κ f a = 0

77
Modes of the arbitrary three-layer asymmetric planar waveguide in 1D
which can be expressed as
tan2 κ f a −1 + κf
γc
tan κ f a −γs
κ f
tan κ f a = 0
(4.54)
It is the general equation for a three-layer asymmetric waveguide. For a symmetric
waveguide
γs = γc = γ
and one can write Eq. (4.54) as

tan κ f a −γ
κ f
 
tan κf a + κ f
γ

= 0
(4.55)
which describes even and odd modes discussed in the previous section (symmetric modes).
Note: The above modes are not normalized for power. Power P carried by a mode per
unit guide width is determined as follows:
P = −2
+∞

−∞
dxEyHx
= 2β
ωμ
+∞

−∞
dxE2
y
= N
 ε0
μ0
E2
f · he f f
= E f · Hf · he f f
(4.56)
where he f f ≡2a + 1
γs + 1
γc is the effective thickness of the waveguide.
4.5.2 Field profiles for TE modes
Analysis of the general determinant given by Eq. (4.54) for the asymmetric waveguide
is complicated. If one wants to obtain formulas suitable for numerical evaluations and
also suitable for obtaining ﬁeld proﬁles, a better approach is to eliminate all constants
appearing in Eq. (4.49). Thus, one will have a ﬁeld proﬁle expressed in terms of one
constant only, say As. One then needs to determine derivatives which should be continuous
across interfaces. From continuity of derivatives, the relevant transcendental equation used
to obtain propagation constants is obtained.
We consider asymmetric structure where the substrate-ﬁlm discontinuity is at x = 0 and
ﬁlm-cover interface is located at x = h. From continuity of the TE ﬁeld at x = 0 and x = h
one ﬁnds
Ac = A cos κ f h + B sin κ f h
(4.57)
and
As = A
(4.58)

78
Slab waveguides
Table 4.1 Asymmetric three-layer waveguide.
Refractive index
Thickness
nc = 1.40
—
n f = 1.50
5 µm
ns = 1.45
—
From continuity of derivatives at the above points
−γcAc = −κ f A sin κ f h + κ f B cos κ f h
(4.59)
and
γsAs = κ f B
(4.60)
From Eqs. (4.58) and (4.60) the constants A and B can be expressed in terms of As.
Substitution of those expressions into Eq. (4.57) gives constant Ac in terms of As. Using
those results, we can replace constants A, B and Ac in Eq. (4.49). The resulting equations
are
Ey(x) = As
(
cos κ f h + γs
κ f sin κ f h
)
exp [−γc (x −h)]
h < x
Ey(x) = As
(
cos κ f x + γs
κ f sin κ f x
)
0 < x < h
Ey(x) = As exp (γsx)
x < 0
(4.61)
From the above, the derivatives with respect to x are
E′
y(x) = −Asγc
(
cos κ f h + γs
κ f sin κ f h
)
exp [−γc (x −h)]
h < x
E′
y(x) = As

−κ f sin κ f x + γs cos κ f x

0 < x < h
E′
y(x) = Asγs exp (γsx)
x < 0
(4.62)
Applying continuity of derivatives at x = h, one ﬁnds
−γc

cos κ f h + γs
κ f
sin κ f h

= −κ f sin κ f h + γs cos κ f h
From the above, it follows the following transcendental equation:
tan κ f h =
γs + γc
κ f −γcγs/κ f
(4.63)
The above equation is used in numerical search for propagation constants. A typical plot
of Eq. (4.63) is shown in Fig. 4.7. Using those propagation constants, from Eq. (4.61) one
ﬁnds ﬁeld proﬁles.
Example
We consider the three-layer asymmetric planar structure described in Table 4.1
(from [1]) operating with light of wavelength λ = 1 µm.

79
Multilayer slab waveguides: 1D approach
Table 4.2 Propagation constants for a three-layer asymmetric structure defined in Table 4.1.
Mode
Propagation constant β(µm−1)
TE0
9.40873
TE1
9.36079
TE2
9.28184
TE3
9.17521
8.9
9
9.1
9.2
9.3
9.4
9.5
−10
−8
−6
−4
−2
0
2
4
6
8
10
β
Search function
Fig. 4.7
Graphical plot of Eq. (4.63) for the three-layer asymmetric waveguide defined in Table 4.1.
The structure is analysed with MATLAB code from Appendix 4A.2.1. The resulting
propagation constants are summarized in Table 4.2. There is a good agreement with pub-
lished results [1]. Field proﬁles for two modes are plotted in Fig. 4.8.
4.6 Multilayer slab waveguides: 1D approach
In this section we discuss slab waveguides consisting of more than three layers.
Multilayers require the repeated applications of boundary conditions at the layer

80
Slab waveguides
0
10
20
30
0
1
2
3
4
5
x (microns)
TE electric field
0
10
20
30
−4
−2
0
2
4
x (microns)
TE electric field
Fig. 4.8
Field profiles for an asymmetric three-layer structure. Fundamental mode TE0 (left). Mode TE1 (right).
ns
n1
n2
n3
n4
nc
x1
d1
x2
d2
x3
d3
x4
d4
x5
d5
x6
d6
x7
thickness
refractive
index
x
z
x
E y
2
Fig. 4.9
Multilayer guiding structure. Electric field profile is also shown.
interfaces. Schematically, the structure is as shown in Fig. 4.9. We make the following
assumptions:
• 1D problem
• n = n(x) is the refractive index
•
∂
∂y = 0
Discussion of TE and TM modes is done separately. We start with TE modes.

81
Multilayer slab waveguides: 1D approach
4.6.1 TE mode
The initial equations were derived previously, Eqs. (4.32)–(4.34). We write them here for
easy reference:
∂Ey
∂x
= −jωμ0Hz
−βEy = ωμ0Hx
(4.64)
∂Hz
∂x + jβHx = −jωμ0ε0εrEy
The above system can be combined together to obtain a wave equation, as
∂2Ey
∂x2
= −jωμ0
∂Hz
∂x
from ﬁrst Eq.
= −jωμ0

−jβHx −jωε0εrEy

from third Eq.
= −jωμ0

−jβ
(
−βEy
ωμ0
)
−jωε0εrEy

from second Eq.
= β2Ey−ω2μ0ε0εrEy
Finally, one writes wave equation for ‘i’ layer as
∂2
∂x2 Eyi(x) =

β2 −k2
0n2
i

Eyi(x)
(4.65)
where k2
0 = μ0ε0ω2 and εri = n2
i . Introduce
κ2
i = k2
0n2
i −β2
(4.66)
The solution to the wave equation is
Eyi(x) = Aie−jκi(x−xi−1) + Bie jκi(x−xi−1)
(4.67)
At the interfaces of layers, the boundary condition of TE mode are
Ei(x)
x=xi−1 = Ei−1(x)
x=xi−1
(4.68)
∂Ei(x)
∂x
x=xi−1 = ∂Ei−1
∂x
x=xi−1
(4.69)
It is more convenient to work with another set of variables Ui(x) and Vi(x) deﬁned as
Ui(x) = Eyi(x)
(4.70)
Vi(x) = ωμ0Hzi(x)
(4.71)
From Eqs. (4.64) one obtains equations for new variables. Directly from the ﬁrst of
Eqs. (4.64)
dUi(x)
dx
= −jVi(x)
(4.72)
Using the second equation to eliminate Hx in the third of Eqs. (4.64), one has
∂Hz
∂x + jβ (−β)
ωμ0
Ey = −jωμ0ε0εrEy

82
Slab waveguides
or
ωμ0
∂Hz
∂x −jβ2Ey = −jω2μ0ε0εrEy
= −jk2
0n2
i Ey
For layer i −th
dVi(x)
dx
−jβ2Ui(x) = −jk2
0n2
i Ui(x)
or
dVi(x)
dx
= −jκ2
i Ui(x)
(4.73)
Eqs. (4.72) and (4.73) can be written in a matrix form as
d
dx
Ui(x)
Vi(x)

=

0
−j
−jκ2
i
0
 Ui(x)
Vi(x)

(4.74)
From Maxwell’s equations one can verify the following relation:
j dUi(x)
dx
= j ∂Eyi(x)
∂x
= ωμ0Hzi(x) = Vi(x)
Using the above relation, the solutions of Eqs. (4.74) are
Ui(x) = Aie−jκi(x−xi) + Biejκi(x−xi)
Vi(x) = j dUi(x)
dx
= κi

Aie−jκi(x−xi) −Bie jκi(x−xi)
They can be written in a matrix form as
Ui(x)
Vi(x)

=
 e−jκi(x−xi)
ejκi(x−xi)
κie−jκi(x−xi)
−κie jκi(x−xi)
 Ai
Bi

(4.75)
From the above, for xi one ﬁnds
Ui(xi)
Vi(xi)

=
1
1
κi
−κi
 Ai
Bi

Inverting the last equation gives the expression for coefﬁcients in terms of ﬁeld and its
derivative
Ai
Bi

= 1
2
!
1
1
jκi
1
−1
jκi
" Ui(xi)
Vi(xi)

Substituting the last equation into (4.75) gives
Ui(x)
Vi(x)

=
 e−jκi(x−xi)
e jκi(x−xi)
κie−jκi(x−xi)
−κie jκi(x−xi)
 1
2
!
1
1
jκi
1
−1
jκi
" Ui(xi)
Vi(xi)

(4.76)
= ←→
Ti (xi)
Ui(xi)
Vi(xi)


83
Multilayer slab waveguides: 1D approach
Explicitly, propagation matrix ←→
Ti (xi) at point xi is
←→
Ti (xi) =
!
cos κi(x −xi)
−j
κi sin κi(x −xi)
−jκi sin κi(x −xi)
cos κi(x −xi)
"
(4.77)
Equation (4.76) ‘propagates’ values of the ﬁelds from point xi to an arbitrary point x within
layer i.
4.6.2 Propagation constant
A propagation constant is obtained if we propagate ﬁelds across all interfaces. First consider
propagation between two consecutive interfaces, that is propagation from xi location to xi+1.
One ﬁnds from Eq. (4.76)
Ui+1(xi+1)
Vi+1(xi+1)

=
!
cos κi(xi+1 −xi)
−j
κi sin κi(xi+1 −xi)
−jκi sin κi(xi+1 −xi)
cos κi(xi+1 −xi)
" Ui(xi)
Vi(xi)

Let us deﬁne the thickness of layer i as
di = xi+1 −xi
The propagation matrix which propagates ﬁelds from xi to xi+1 is called ←→
Mi and has the
form
←→
Mi =
!
cos κidi
−j
κi sin κidi
−jκi sin κidi
cos κidi
"
(4.78)
Using the above formalism, we can now propagate ﬁelds through the entire structure from
substrate to a cladding region as follows:
Uc
Vc

=
N
*
i=1
←→
Mi
Us
Vs

= ←→
M
Us
Vs

≡
m11
m12
m21
m22
 Us
Vs

(4.79)
In the above we have introduced the 2 × 2 matrix ←→
M with elements m11, m12, m21, m22
which plays central role in the numerical process of determining propagation constants.
From the above equation one obtains
Uc = m11Us + m12Vs
(4.80)
Vc = m21Us + m22Vs
(4.81)
In the substrate and cladding, the ﬁelds decay exponentially (Fig. 4.10). Therefore, the
expressions for ﬁelds in the cladding and substrate regions are

84
Slab waveguides
substrate
waveguide
cladding
x i+1
xi
x1
xN
Fig. 4.10
Schematic of the field distribution. Exponential decay in the substrate and cladding regions is shown.
• for x < x1(substrate)
Us(x) = As exp[γs(x −x1)]
(4.82)
Vs(x) = jγsAs exp[γs(x −x1)]
(4.83)
• for x > xN (cladding)
Uc(x) = Ac exp[−γc(x −xN )]
(4.84)
Vc(x) = −jγcAs exp[−γc(x −xN )]
(4.85)
In the above expressions we deﬁned
γ 2
i
= β2 −k2
0n2
i
(4.86)
γi = jκi
From expressions (4.82) and (4.83) one obtains at point x1
Us(x1) = As
(4.87)
Vs(x1) = jγsAs
(4.88)
In a similar way for point xN one has
Uc(xN ) = Ac
(4.89)
Vc(xN ) = −jγcAc
(4.90)
Substituting the above results into Eqs. (4.80) and (4.81), one obtains the expressions which
are used to ﬁnd propagation constants employing numerical procedure
γcγsm12 −m21 = j(γcm11 + γsm22)
(4.91)
Values of matrix elements m11, m12, m21, m22 are obtained numerically for a particular
guiding structure.
4.6.3 Electric field
Once propagation constants are found, one can obtain proﬁle of electric ﬁeld for each mode.
To do this one uses Eq. (4.76), which after multiplication of matrices is
Ui(x)
Vi(x)

=
!
cos κi(x −xi)
−j
κi sin κi(x −xi)
−jκi sin κi(x −xi)
cos κi(x −xi)
" Ui(xi)
Vi(xi)

(4.92)

85
Examples: 1D approach
where for layer i xi ≤x ≤xi+1. The above determines electric ﬁeld at an arbitrary location
within layer i once the values of ﬁelds are known at point xi. In practice one assumes some
value of electric ﬁeld at point x1 and using expression (4.92) determines ﬁeld within all
layers. The above procedure will be applied to analyse several guiding structures in the next
section. Before this, we will formulate basic equations for TM modes.
4.6.4 TM modes
The analysis for TM modes follows exactly the same path as for TE modes. Here we outline
basic equations only. For TM modes one has the following relations:
Ey = Hz = Hx = 0
(4.93)
For each layer one has
βHy = ωεEx
∂Hy
∂x
= jωεEz
∂Ez
∂x + jβEx = jωμHy
(4.94)
Deﬁne variables
U = Hy
V = ωε0Ez
(4.95)
They fulﬁll the following equations:
dU
dx
= jn2V
dV
dx = j

k2 −β2
n2

U
(4.96)
From this point one follows a similar approach as for TE modes. The remaining analysis is
left as a project.
4.7 Examples: 1D approach
In this section we will consider several waveguiding structures described in literature and
apply our formalism to analyse those structures. The tests were performed in searching for
propagation constant β and then determining the proﬁle of electric ﬁeld. Our tests were
performed for several structures analysed in References [2], [3], [4] and [5].
We attempted to ﬁnd all modes. Excellent agreement was found as compared with the
published results.

86
Slab waveguides
Table 4.3 Geometry of a four-layer lossless dielectric waveguide [3].
Layer
Refractive index
Thickness
Description
D6
n6 = 1.00
1 µm
Cladding
D5
n5 = 1.66
0.50 µm
D4
n4 = 1.53
0.50 µm
D3
n3 = 1.60
0.50 µm
D2
n2 = 1.66
0.50 µm
D1
n1 = 1.50
1 µm
Substrate
Table 4.4 Propagation constants for a four-layer lossless dielectric waveguide defined in Table 4.3.
Mode
Propagation constant
TE0
1.622728682325434 + 0.000000000000441i
TE1
1.605275698094530 + 0.000000000000014i
TE2
1.557136152293222 + 0.000000000000436i
TE3
1.503587112022723
The list of MATLAB ﬁles is provided in Table 4.121. All MATLAB ﬁles are listed in
Appendix 4A.3.
4.7.1 Four-layer lossless waveguide
The ﬁrst tested structure is the one considered by Chilwell and Hodgkinson [3] and also by
Chen et al. [4]. It is a four-layer lossless dielectric structure shown in Table 4.3. Wavelength
is λ = 0.6328 µm. Determined propagation constants for all four modes are summarized
in Table 4.4. They show an excellent agreement with the results published in Ref. [3] and
[4].
Electric ﬁeld for fundamental TE-mode has been calculated using mesh points generated
by function mesh x.m. The resulting proﬁle of TE fundamental mode is shown in Fig. 4.11.
4.7.2 Six-layer lossy waveguide
The second structure tested by our program is deﬁned in Table 4.5, from [4]. It is a six-
layer lossy waveguide structure operating at the wavelength λ = 1.523 µm. Propagation
constants for this structure are summarized in Table 4.6. Obtained results show an excellent
agreement with the published data.
The TE electric ﬁeld distribution of the fundamental mode for this structure is shown in
Fig. 4.12.
1 I acknowledge the help of my former student, Mr L. Glowacki, in developing some of those routines.

87
Examples: 1D approach
Table 4.5 Geometry of a six-layer lossy dielectric waveguide.
Layer
Refractive index
Thickness (µm)
Description
D8
n8 = 1.00
1
Cladding
D7
n7 = 3.38327
0.10
D6
n6 = 3.39614
0.20
D5
n5 = 3.5321–j0.08817
0.60
D4
n4 = 3.39583
0.518
D3
n3 = 3.22534
1.60
D2
n2 = 3.16455
0.60
D1
n1 = 3.172951
1
Substrate
Table 4.6 Results of propagation constants for six-layer lossy dielectric waveguide.
Mode
Propagation constant
TE0
3.460829693510364 + 0.072663342917385i
TE1
3.316707802046375 + 0.023275817588121i
TE2
3.208555428734457 + 0.012782067986633i
TE3
3.195490593396514 + 0.012585955654404i
0
1
2
3
4
0
0.2
0.4
0.6
0.8
1
x (microns)
TE electric field
Fig. 4.11
Field profile of fundamental TE mode for four-layer lossless structure.
4.7.3 Structure by Visser
This structure was described by Visser et al. [5]. It is summarized in Table 4.7.
The results of calculations of propagation constants for TE modes are summarized in
Table 4.8. They are identical to the values published by Visser et al. [5]. The proﬁle of the
electric ﬁeld for mode TE1 is shown in Fig. 4.13.

88
Slab waveguides
Table 4.7 Geometry of a six-layer lossy dielectric waveguide described by Visser et al. [5].
Layer
Thickness (µm)
Refractive index
clad
1.0
3
0.6
3.40 −0.002i
2
0.4
3.60 + 0.010i
1
0.6
3.40 −0.002i
substrate
1.0
Table 4.8 Propagation constants obtained for the structure shown in Table 4.7.
Layer
Propagation constant
TE0
3.503443332950034 −0.007103000978683i
TE1
3.337286858209064 + 0.000229491103731i
TE2
3.251685206983383 + 0.000530514779912i
TE3
3.104251421414573 −0.001337986339752i
TE4
2.878636779881233 + 0.000173729890361i
TE5
2.628139320470185 −0.001548644353782i
TE6
2.243951362601185 −0.000708377958009i
TE7
1.768190960412424 −0.001353217183860i
TE8
1.074262026525778 −0.002457891473570i
0
2
4
6
0
0.2
0.4
0.6
0.8
1
x (microns)
TE electric field
Fig. 4.12
Field profile of fundamental TE mode for a six-layer lossy waveguide.
4.8 Two-dimensional (2D) structures
In the previous sections we have discussed one-dimensional guiding structures, also
known as planar waveguides. However, in practical devices the waveguides are essentially
two-dimensional (2D) In those structures, refractive index n(x, y) depends on transverse
coordinate x and lateral coordinate y. Two examples of popular structures are shown in

89
Two-dimensional (2D) structures
0
1
2
3
0
0.2
0.4
0.6
0.8
1
x (microns)
TE electric field
Fig. 4.13
Field profile of TE1 mode for structure discussed by Visser etal. [5].
n1
n2
d
w
n1
n2
d
w
(a)
(b)
n1
Fig. 4.14
Popular types of 2D waveguides. (a) Buried-channel waveguide. (b) Rib waveguide.
Fig. 4.14. They exhibit distinctive features of their refractive index. The structures shown
are known as the buried channel waveguide and the rib waveguide.
In what follows we will discuss one of the methods of obtaining approximate solution
for propagating mode, known as the effective index method.
4.8.1 Effective index method
To illustrate the effective index method [6], let us start with a scalar wave equation in 2D
which is
∂2φ(x, y)
∂x2
+ ∂2φ(x, y)
∂y2
+ k2
0
+
εr(x, y) −N2
e f f
,
φ(x, y) = 0
(4.97)
Here N2
e f f is the effective index which we want to determine. Assume that there is no
‘interaction’ between variables x and y. This allows us to separate ﬁelds as [7]
φ(x, y) = X (x) · Y (y)
Substitute postulated solution into wave equation, evaluate the relevant derivatives and
divide both sides of the resulting equation by X (x) · Y (y). One obtains
1
X (x)X ′′(x) +
1
Y (y)Y ′′(y) + k2
0
+
εr(x, y) −N2
e f f
,
= 0
(4.98)

90
Slab waveguides
n1
n 2
n 3
2
N
2
N
3
N
3
N
N1
N1
The above is equivalent to
w
x
Step 3
Step 2
Step 1
n1
a1
a 2
w
n 3
n 2
x
y
a1
n1
n 2
a 2
n 3
y
n1
n 2
a 2
n 3
y
y
Fig. 4.15
Illustration of the effective index method.
Introduce separation constant k2
0λ2 as
1
Y (y)Y ′′(y) + k2
0εr(x, y) = k2
0λ2
(4.99)
The remaining terms are
1
X (x)X ′′(x) −k2
0N2
e f f = −k2
0λ2
(4.100)
Based on the above theory it is possible to design a method, known as effective index
method to determine effective index N2
e f f . The method (see Fig. 4.15) consists of several
steps:
1. Replace the 2D waveguide with a combination of 1D waveguides along x-axis.
2. Solve each of the 1D problems separately by calculating the effective index along y axis
and obtain Ne f f in each case (for our structure three cases).
3. Construct a new ‘effective’ 1D waveguide (along x-axis) which will model the original
2D waveguide. The new effective waveguide has the values of refractive indices as
indicated.
4. Determine an effective index by solving the 1D waveguide constructed in Step 3 along
the x-axis.

91
Two-dimensional (2D) structures
Table 4.9 Numerical parameters used in an example of the effective index method.
Wavelength
Refractive indices
Geometry
λ = 0.8 µm
nc = 1
h = 1.8 µm
n f = 2.234
d = 1 µm
ns = 2.214
w = 2 µm
h
d
w
nc
ns
nf
x
y
Fig. 4.16
Structure used as an example of the application of the effective index method.
An example
We illustrate the effective index method with an example can be found in [8]. The
structure is shown in Fig. 4.16 and the numerical parameters in Table 4.9.
The method proceeds with the following four steps:
1. Determine normalized thicknesses using the deﬁnition of V
Vf = k · h

n2
f −n2
s,
Vd = k · d

n2
f −n2
s
Using the values from Table 4.9, one ﬁnds
Vf = 4.2,
Vd = 2.3
2. Obtain values of b using b −V diagram. From the diagram, for TE modes we obtain
(for a = ∞)
b f = 0.65,
bd = 0.2
Effective indices Nf and Nd are determined using
N2
f ,d = n2
s + b f ,d
(
n2
f −n2
s
)
One obtains
Nf = 2.227,
Nd = 2.218
3. The same structure along the y-direction is approximated as the one-dimensional, using
the previous values. The V number is determined using
Veg = k · w

N2
f −N2
d = kw
(
n2
f −n2
s
) 
b f −bd

(4.101)

92
Slab waveguides
One obtains
Veg = 3.14,
beg = 0.64
(4.102)
4. Finally, the approximate effective index N = Neq of the equivalent guide is determined
using
N ≡Neg = N2
d + beq
(
N2
f −N2
d
)
(4.103)
For this example, we obtain N = 2.224.
More examples of the applications of effective index method can be found in books by
Coldren and Corzine [9] and Liu [10].
4.9 Problems
1.
Find the effective refractive indices and the number of TE modes in an asymmetric
waveguide with an asymmetry parameter a = 10 and thickness h = 1.50 µm. Assume
λ0 = 0.82 µm.
2.
Compute the largest thickness that will guarantee single TE mode operation of the
above waveguide.
3.
Analyse the three-layer, asymmetric guiding structure. Derive a transcendental equa-
tion for the propagation constant.
4.
Conduct analysis of a four-layer waveguiding structure [8]. Derive equations for all
elements of matrix M. Obtain an analytical formula for dispersion relation.
4.10 Projects
1. Based on theoretical results developed for the three-layer symmetrical guiding structure,
write a MATLAB program which will solve transcendental equations using functions
given by (4.46) and (4.47). Select from the literature an appropriate waveguiding struc-
ture. Use your program to determine propagation constants and proﬁles of electric ﬁelds.
Compare your results with those from the literature.
2. Analyse TM modes for the three-layer asymmetric waveguide deﬁned in Table 4.1. Ob-
tain analytical solutions in all regions and derive an appropriate transcendental equation.
Write a MATLAB program to determine propagation constants.
3. Plasmonic waveguide contains a metallic layer. The simplest cases are the three-layer
structures: metal-dielectric-metal (MDM) and dielectric-metal-dielectric (DMD). Derive
a transcendental equation describing plasmonic waveguide (similar to Eq. 4.45 for a
symmetrical dielectric guiding structure). Consult the paper by Kekatpure et al. [11].
With the equation at hand, write a MATLAB program to determine propagation constants

93
Appendix 4A
for TM modes for the MDM structure deﬁned in Table 4.10 [11]. Analyse the obtained
results.
Table 4.10 Plasmonic structure.
Material
Thickness (µm)
Relative permittivity
gold
3
−95.92 −i10.97
silica
50
2.1025
silver
3
−143.49 −i9.52
4. Conduct analysis of the multilayered structure for TM modes. Derive all necessary
equations. Write a MATLAB program to determine propagation constants and ﬁeld
proﬁles.
Appendix 4A: MATLAB listings
In Tables 4.11 and 4.12 we provide a list of MATLAB ﬁles created for Chapter 4 and a
short description of each function. In Table 4.12 we summarize a list of ﬁles used to analyse
planar waveguides.
Table 4.11 List of MATLAB functions for Chapter 4.
Listing
Function name
Description
4A.1
b V diagram.m
Plots b-V diagram for planar waveguide
4A.2.1
a3L.m
Analysis for three-layer planar waveguide
4A.2.2
f unc asym.m
Function used by a3L.m
Table 4.12 Functions used to analyse a 1D planar waveguide.
Listing
Function name
Description
4A.3.1
slab.m
driver function (determines prop. constants and ﬁeld proﬁle)
4A.3.2
lossless.m
data for waveguide structure without losses
4A.3.3
lossy.m
data for waveguide structure with losses
4A.3.4
visser.m
data for structure described by Visser
4A.3.5
muller.m
implements Muller’s method
4A.3.6
f TE.m
creates transcendental equation for TE ﬁeld
4A.3.7
mesh x.m
generates 1D mesh
4A.3.8
reﬁndex.m
assigns the value of ref. index to each mesh point
4A.3.9
TE ﬁeld.m
determines TE ﬁeld for all mesh points

94
Slab waveguides
Listing 4A.1
Program b V diagram.m. MATLAB program to analyse the transverse
resonance condition (4.12) and to plot a normalized guide index b versus variable V .
Allows to input different values of the asymmetry parameter a.
% File name: b_V_diagram.m
% function which plots b-V diagram of a planar slab waveguide
clear all
N_max = 400;
% number of points for plot
b = linspace(0,1.0,N_max);
hold on
for nu = [0, 1, 2]
for a = [0.0, 8.0,50.0];
% asymmetry coefficient
% determine V
V1 = atan(sqrt(b./(1-b)) );
V2 = atan(sqrt((b+a)./(1.0-b)));
V3 = 1./sqrt(1.0-b);
V = (nu*pi + V1 + V2).*V3;
%
plot(V,b,’LineWidth’,1.2)
grid on
axis([0.0 20.0 0.0 1.0])
% change axis limit
end
end
box on
% makes frame around plot
xlabel (’V’,’FontSize’,14);
ylabel(’b’,’FontSize’,14);
set(gca,’FontSize’,14);
% size of tick marks on both axes
text(10, 0.96, ’\nu=0’,’Fontsize’,14)
text(10, 0.8, ’\nu=1’,’Fontsize’,14)
text(10, 0.55, ’\nu=2’,’Fontsize’,14)
%
text(0.1, 0.3, ’a=0’,’Fontsize’,14)
text(2.5, 0.3, ’a=50’,’Fontsize’,14)
%
text(3.3, 0.2, ’a=0’,’Fontsize’,14)
text(5.8, 0.2, ’a=50’,’Fontsize’,14)
%
text(6, 0.1, ’a=0’,’Fontsize’,14)
text(8.8, 0.1, ’a=50’,’Fontsize’,14)
pause
close all

95
Appendix 4A
Listing 4A.2.1
Program a3L.m. Determines propagation constants and plots ﬁeld proﬁles
for an asymmetric three-layer planar waveguide. Uses func asym.m.
% File name: a3L.m
% Analysis for TE modes
% First, we conduct test plots to find ranges of beta where possible
% solutions exists. This is done in several steps:
% 1. Plots are done treating kappa_f as an independent variable
% 2. Ranges of kappa_f are determined where there are zeros of functions
% 3. Corresponding ranges of beta are determined
% 4. Searches are performed to find propagation constants
%
clear all
% Definition of structure
n_f
= 1.50;
% ref. index of film layer
n_s
= 1.45;
% ref. index of substrate
n_c
= 1.40;
% ref. index of cladding
lambda = 1.0;
% wavelength in microns
h
= 5.0;
% thickness of film layer in microns
a_c
= 2*h;
% thickness of cladding region
a_s
= 2*h;
% thickness of substrate region
%
k = 2*pi/lambda;
% wave number
kappa_f = 0:0.01:3.0;
% establish range of kappa_f
beta_temp = sqrt((n_f*k)^2 - kappa_f.^2);
beta_min = min(beta_temp);
beta_max = max(beta_temp);
% Before searches, we plot search function versus beta
beta = beta_min:0.001:beta_max; % establish range of beta
N = beta./k;
ff = func_asym(beta,n_c,n_s,n_f,k,h);
plot(beta,ff)
xlabel(’\beta’,’FontSize’,22);
ylabel(’Search function’,’FontSize’,22);
ylim([-10.0 10.0])
grid on
pause
close all
% From the above plot, one must choose proper search range for each mode.
% Search numbers provided below are only for the waveguide defined above.
% For different waveguide, one must choose different ranges
% for searches.
beta0 = fzero(@(beta) func_asym(beta,n_c,n_s,n_f,k,h),[9.40 9.41])
beta1 = fzero(@(beta) func_asym(beta,n_c,n_s,n_f,k,h),[9.35 9.37])
beta2 = fzero(@(beta) func_asym(beta,n_c,n_s,n_f,k,h),[9.27 9.29])
beta3 = fzero(@(beta) func_asym(beta,n_c,n_s,n_f,k,h),[9.17 9.18])
% Plot of field profiles

96
Slab waveguides
A_s = 1.0;
thickness = h + a_c + a_s;
beta_field = beta0; % Select appropriate propagation constant for plotting
gamma_s = sqrt(beta_field^2 - (n_s*k)^2);
gamma_c = sqrt(beta_field^2 - (n_c*k)^2);
kappa_f = sqrt((n_f*k)^2 - beta_field^2);
%
% In the formulas below for electric field E_y we have shifted
% x-coordinate by a_s
% We also ’reversed’ direction of plot in the substrate region
NN = 100;
delta = thickness/NN;
x = 0.0:delta:thickness;
% coordinates of plot points
x_t = 0;
for i=1:NN+1
x_t(i+1)= x_t(i) + delta;
if (x_t(i)<=a_s);
E_y(i) = A_s*exp(gamma_s*(x_t(i)-a_s));
elseif (a_s<=x_t(i)) && (x_t(i)<=a_s+h);
E_y(i) = A_s*(cos(kappa_f*(x_t(i)-a_s))+...
gamma_s*sin(kappa_f*(x_t(i)-a_s))/kappa_f);
else (a_s+h<=x_t(i)) & (x_t(i)<=thickness);
E_y(i) = A_s*(cos(kappa_f*h)+gamma_s*sin(kappa_f*h)/kappa_f)...
*exp(-gamma_c*(x_t(i)-h-a_s));
end
end
%
h=plot(x,E_y);
% add text on x-axix and y-axis and size of x and y labels
xlabel(’x (microns)’,’FontSize’,22);
ylabel(’TE electric field’,’FontSize’,22);
set(h,’LineWidth’,1.5);
% new thickness of plotting lines
set(gca,’FontSize’,22);
% new size of tick marks on both axes
grid on
pause
close all
Listing 4A.2.2
Function func asym.m. Search function for the asymmetric three-layer
waveguide. Used by program a3L.m.
function f = func_asym(beta,n_c,n_s,n_f,k,h)
% Construction of search function for asymmetric 3-layers waveguide
%
gamma_c = sqrt(beta.^2 - (n_c*k)^2);
gamma_s = sqrt(beta.^2 - (n_s*k)^2);
kappa_f = sqrt((n_f*k)^2 - beta.^2);

97
Appendix 4A
%
denom = kappa_f - (gamma_c.*gamma_s)./kappa_f;
f = tan(kappa_f*h) - (gamma_s+gamma_c)./denom;
Listing 4A.3.1
Program slab.m. Driver function which determines propagation constant
for fundamental TE mode and plots electric ﬁeld proﬁles. One-dimensional planar wave-
guide of an arbitrary number of layers is assumed. The list of ﬁles is shown in Table 4.12.
% File name: slab.m
% Driver function which determines propagation constants and
% electric field profiles (TE mode) for multilayered slab structure
clear all;
format long
% Input structure for analysis (select appropriate input)
%lossless;
%lossy;
visser
%
epsilon = 1e-6;
% numerical parameter
TE_mode = [];
n_max = max(n_layer);
z1 = n_max;
% max value of refractive index
n_min = max(n_s,n_c) + 0.001;
% min value of refractive index
dz = 0.005;
% iteration step
mode_control = 0;
%
while(z1 > n_min)
z0 = z1 - dz;
% starting point for Muller method
z2 = 0.5*(z1 + z0);
% starting point for Muller method
z_new = muller(@f_TE , z0, z1, z2);
if (z_new ~= 0)
% verifying for mode existence
for u=1 : length(TE_mode)
if(abs(TE_mode(u) - z_new) < epsilon)
mode_control = 1; break; % mode found
end
end
if (mode_control == 1)
mode_control = 0;
else
TE_mode(length(TE_mode) + 1) = z_new;
end
end
z1 = z0;
end
%

98
Slab waveguides
TE_mode = sort(TE_mode, ’descend’);
%TE_mode’
% outputs all calculated modes
beta = TE_mode(2);
% selects mode for plotting field profile
x = mesh_x(d_s,d_layer,d_c,NumberMesh);
n_total = [n_s,n_layer,n_c];
% ref index for all layers
n_mesh = refindex(x,NumberMesh,n_total);
TE_mode_field = TE_field(beta,n_mesh,x,k_0);
Listing 4A.3.2
Function lossless.m. Contains data for a lossless waveguide.
% File name: lossless.m
% Contains data for lossless waveguide
% Reference:
% J. Chilwell and I. Hodgkinson,
% "Thin-films field-transfer matrix theory of planar multilayer
% waveguides and reflection from prism-loaded waveguide",
% J. Opt. Soc. Amer.A, vol.1, pp. 742-753 (1984).
% Fig.3
% Global variables to be transferred to function f_TE.m
%
global n_c
% ref. index cladding
global n_layer
% ref. index of internal layers
global n_s
% ref. index substrate
global d_c
% thickness of cladding (microns)
global d_layer
% thicknesses of internal layers (microns)
global d_s
% thickness of substrate (microns)
global k_0
% wavenumber
global NumberMesh
% number of mesh points in each layer
% (including substrate and cladding)
n_c
= 1.0;
n_layer
= [1.66 1.60 1.53 1.66];
n_s
= 1.5;
d_c
= 0.5;
d_layer
= [0.5 0.5 0.5 0.5];
d_s
= 1.0;
NumberMesh = [10 10 10 10 10 10];
lambda
= 0.6328;
% wavelength in microns
k_0
= 2*pi/lambda;
Listing 4A.3.3
Function lossy.m. Contains data for a lossy waveguide.
% File name: lossy.m
% Contains data for lossy waveguide.
% Reference:

99
Appendix 4A
% C. Chen et al, Proc. SPIE, v.3795 (1999)
% Global variables to be transferred to function f_TE.m
global n_c
% ref. index cladding
global n_layer
% ref. index of internal layers
global n_s
% ref. index substrate
global d_c
% thickness of cladding (microns)
global d_layer
% thicknesses of internal layers (microns)
global d_s
% thickness of substrate (microns)
global k_0
% wavenumber
global NumberMesh
% number of mesh points in each layer
% (including substrate and cladding)
n_c
= 1.0;
n_layer
= [3.16455 3.22534 3.39583 3.5321-1j*0.08817 3.39614 3.38327];
n_s
= 3.172951;
d_c
= 1.0;
d_layer
= [0.6 1.6 0.518 0.6 0.2 0.1];
d_s
= 1.0;
NumberMesh = [10 10 10 10 10 10 10 10];
lambda
= 1.523;
% wavelength in microns
k_0
= 2*pi/lambda;
Listing 4A.3.4
Function visser.m. Contains data for a ﬁve-layer waveguide described by
Visser et al.
% File name: visser.m
% Contains data for five-layer waveguide with gain and losses
% Reference:
% T.D. Visser et al, JQE v.31, p.1803 (1995)
% Fig.6
% Global variables to be transferred to function f_TE.m
%
global n_c
% ref. index cladding
global n_layer
% ref. index of internal layers
global n_s
% ref. index substrate
global d_c
% thickness of cladding (microns)
global d_layer
% thicknesses of internal layers (microns)
global d_s
% thickness of substrate (microns)
global k_0
% wavenumber
global NumberMesh
% number of mesh points in each layer
% (including substrate and cladding)
n_c
= 1.0;
n_layer
= [3.40-1i*0.002 3.60+1i*0.010 3.40-1i*0.002];
n_s
= 1.0;
d_s
= 0.4;
d_layer
= [0.6 0.4 0.6];

100
Slab waveguides
d_c
= 0.5;
NumberMesh = [10 10 10 10 10];
lambda
= 1.3;
% wavelength in microns
k_0
= 2*pi/lambda;
Listing 4A.3.5
Function muller.m. This function implements Muller’s method. It is good
for ﬁnding complex roots.
function f_val = muller (f, x0, x1, x2)
% Function implements Muller’s method
iter_max = 100;
% max number of steps in Muller method
f_tol
= 1e-6;
% numerical parameters
x_tol = 1e-6;
y0 = f(x0);
y1 = f(x1);
y2 = f(x2);
iter = 0;
while(iter <= iter_max)
iter = iter + 1;
a =( (x1 - x2)*(y0 - y2) - (x0 - x2)*(y1 - y2)) / ...
( (x0 - x2)*(x1 - x2)*(x0 - x1) );
%
b = ( ( x0 - x2 )^2 *( y1 - y2 ) - ( x1 - x2 )^2 *( y0 - y2 )) / ...
( (x0 - x2)*(x1 - x2)*(x0 - x1) );
%
c = y2;
%
if (a~=0)
D = sqrt(b*b - 4*a*c);
q1 = b + D;
q2 = b - D;
if (abs(q1) < abs(q2))
dx = - 2*c/q2;
else
dx = - 2*c/q1;
end
elseif (b~=0)
dx = -c/b;
else
warning(’Muller method failed to find a root’)
break;
end
x3 = x2 + dx;
x0 = x1;
x1 = x2;

101
Appendix 4A
x2 = x3;
y0 = y1;
y1 = y2;
y2 = feval(f, x2);
if (abs(dx) < x_tol && abs (y2) < f_tol)
break;
end
end
% Lines below ensure that only proper values are calculated
if (abs(y2) < f_tol)
f_val = x2;
return;
else
f_val = 0;
end
Listing 4A.3.6
Function f TE.m. Using the transfer matrix approach, a transcendental
equation is created which is then used to determine a propagation constant.
function result = f_TE(z)
% Creates function used to determine propagation constant
% Variable description:
% result - expression used in search for propagation
constant
% z
- actual value of propagation constant
%
% Global variables:
% Global variables are used to transfer values from data functions
global n_s
% ref. index substrate
global n_c
% ref. index cladding
global n_layer
% ref. index of internal layers
global d_layer
% thicknesses of internal layers (microns)
global k_0
% wavenumber
%
zz=z*k_0;
NumLayers = length(d_layer);
%
% Creation for substrate and cladding
gamma_sub=sqrt(zz^2-(k_0*n_s)^2);
gamma_clad=sqrt(zz^2-(k_0*n_c)^2);
%
% Creation of kappa for internal layers
kappa=sqrt(k_0^2*n_layer.^2-zz.^2);
temp = kappa.*d_layer;
%

102
Slab waveguides
% Construction of transfer matrix for first layer
cc =
cos(temp);
ss =
sin(temp);
m(1,1) = cc(1);
m(1,2) = -1j*ss(1)/kappa(1);
m(2,1) = -1j*kappa(1)*ss(1);
m(2,2) = cc(1);
%
% Construction of transfer matrices for remaining layers
% and multiplication of matrices
for i=2:NumLayers
mt(1,1) = cc(i);
mt(1,2) = -1j*ss(i)/kappa(i);
mt(2,1) = -1j*ss(i)*kappa(i);
mt(2,2) = cc(i);
m = mt*m;
end
%
result = 1j*(gamma_clad*m(1,1)+gamma_sub*m(2,2))...
+ m(2,1) - gamma_sub*gamma_clad*m(1,2);
Listing 4A.3.7
Function mesh x.m. Generates a one-dimensional mesh along the
transversal direction (which is taken as the x-axis) of a dielectric waveguide.
function x = mesh_x(d_s,d_layer,d_c,NumberMesh)
% Generates one-dimensional mesh along x-axis
% Variable description:
% Input
% d_layer
- thicknesses of each layer
% NumberMesh
- number of mesh points in each layer
% Output
% x
- mesh point coordinates
%
d_total = [d_s,d_layer,d_c];
% thicknesses of all layers
NumberOfLayers = length(d_total);
% determine number of layers
delta = d_total./NumberMesh;
% separation of points for all layers
%
x(1) = 0.0;
% coordinate of first mesh point
i_mesh = 1;
for k = 1:NumberOfLayers
% loop over all layers
for i = 1:NumberMesh(k)
% loop within layer
x(i_mesh+1) = x(i_mesh) + delta(k);
i_mesh = i_mesh + 1;
end
end

103
Appendix 4A
Listing 4A.3.8
Function reﬁndex.m. Determines the refractive index at all mesh points.
function n_mesh = refindex(x,interface,index_layer)
% Assigns the values of refractive indices to mesh points
% in all layers
% Input
% x()
-- mesh points coordinates
% interface(n)
-- number of mesh points in layers
% index_layer() -- refrective index in layers
% Output
% index_mesh
-- refractive index for each mesh point
%
% Within a given layer, refractive index is assigned the same value.
% Loop scans over all mesh points.
% For all mesh points selected for a given layer, the same
% value of refractive index is assigned.
%
N_mesh = length(x);
NumberOfLayers = length(index_layer);
%
i_mesh = 1;
for k = 1:NumberOfLayers
% loop over all layers
for i = 1:interface(k)
% loop within layer
n_mesh(i_mesh+1) = index_layer(k);
i_mesh = i_mesh + 1;
end
end
Listing 4A.3.9
Function TE ﬁeld.m. Determines TE optical ﬁeld for all layers.
function TE_mode_field = TE_field(beta,index_mesh,x,k_zero)
% Determines TE optical field for all layers
%
% x - grid created in mesh_x.m
TotalMesh = length(x);
% total number of mesh points
%
zz=beta*k_zero;
%
% Creation of constants at each mesh point
kappa = 0;
for n = 1:(TotalMesh)
kappa(n)=sqrt((k_zero*index_mesh(n))^2-zz^2);
end
%
% Establish boundary conditions in first layer (substrate).

104
Slab waveguides
% Values of the fields U and V are numbered by index not by
% location along x-axis.
% For visualization purposes boundary conditions are set at first point.
U(1) = 1.0;
temp = imag(kappa(1));
if(temp<0), kappa(1) = - kappa(1);
end
% The above ensures that we get a field decaying in the substrate
V(1) = kappa(1);
%
for n=2:(TotalMesh)
cc=cos( kappa(n)*(x(n)-x(n-1)) );
ss=sin( kappa(n)*(x(n)-x(n-1)) );
m(1,1)=cc;
m(1,2)=-1i/kappa(n)*ss;
m(2,1)=-1i*kappa(n)*ss;
m(2,2)=cc;
%
U(n)=m(1,1)*U(n-1)+m(1,2)*V(n-1);
V(n)=m(2,1)*U(n-1)+m(2,2)*V(n-1);
end
%
TE_mode_field = abs(U);
% Finds Abs(E)
max_value = max(TE_mode_field);
h = plot(x,TE_mode_field/max_value);
% plot normalized value of TE field
% adds text on x-axix and size of x label
xlabel(’x (microns)’,’FontSize’,22);
% adds text on y-axix and size of y label
ylabel(’TE electric field’,’FontSize’,22);
set(h,’LineWidth’,1.5);
% new thickness of plotting lines
set(gca,’FontSize’,22);
% new size of tick marks on both axes
pause
close all
References
[1] C. R. Pollock and M. Lipson. Integrated Photonics. Kluwer Academic Publishers,
Boston, 2003.
[2] C. Chen, P. Berini, D. Feng, S. Tanev, and V. P. Tzolov. Efﬁcient and accurate numerical
analysis of multilayer planar optical waveguides in lossy anisotropic media. Optics
Express, 7:260–72, 2000.
[3] J. Chilwell and I. Hodgkinson. Thin-ﬁlms ﬁeld-transfer matrix theory of planar mul-
tilayer waveguides and reﬂection from prism-loaded waveguide. J. Opt. Soc. Amer. A,
1:742–53, 1984.

105
References
[4] C. Chen, P. Berini, D. Feng, S. Tanev, and V. P. Tzolov. Efﬁcient and accurate numerical
analysis of multilayer planar optical waveguides. Proc. SPIE, 3795:676, 1999.
[5] T. D. Visser, H. Blok, and D. Lenstra. Modal analysis of a planar waveguide with gain
and losses. IEEE J. Quantum Electron., 31:1803–18, 1995.
[6] R. Maerz. Integrated Optics. Design and Modeling. Artech House, Boston, 1995.
[7] M. N. O. Sadiku. Elements of Electromagnetics. Second Edition. Oxford University
Press, New York, Oxford, 1995.
[8] H. Kogelnik. Theory of optical waveguides. In T. Tamir, ed., Springer Series in Elec-
tronics and Photonics. Guided-Wave Optoelectronics, volume 26, pp. 7–88. Springer-
Verlag, Berlin, 1988.
[9] L. A. Coldren and S. W. Corzine. Diode Lasers and Photonic Integrated Circuits.
Wiley, New York, 1995.
[10] J.-M. Liu. Photonic Devices. Cambridge University Press, Cambridge, 2005.
[11] R. D. Kekatpure, A. C. Hryciw, E. S. Barnard, and M. L. Brongersma. Solving
dielectric and plasmonic waveguide dispersion relations on a pocket calculator. Optics
Express, 17:24112–29, 2009.

5
Linear optical fibre and signal degradation
In this chapter we will discuss properties of the linear ﬁbre, where refractive index does not
depend on ﬁeld intensity. We will concentrate on the following topics:
• geometrical-optics description
• wave propagation
• dispersion in single-mode ﬁbres
• dispersion-induced limitations.
Due to dispersion, the width of propagating pulse will increase. In multimode ﬁbres,
broadening of optical pulses is signiﬁcant, about 10 ns km−1. In the geometrical-optics
description, such broadening is attributed to different paths followed by different rays. In
a single mode ﬁbre, intermodal dispersion is absent; all energy is transported by a single
mode. However, pulse broadening exists. Different spectral components of the pulse travel at
slightly different group velocities. This effect is known as group velocity dispersion (GVD).
5.1 Geometrical-optics description
Consider an optical ﬁbre whose cross-section is shown in Fig. 5.1. The corresponding
change in refractive index proﬁles is shown in Fig. 5.2. We illustrate two proﬁles: step
index and graded index.
In the following discussion we will assume validity of a geometrical optics description
which holds in the limit λ ≪a, where λ is the light wavelength, and a is the core radius
[1], [2].
5.1.1 Numerical aperture (NA)
To start our discussion, consider the propagation of rays entering a cylindrical ﬁbre at
different angles in the plane passing through the core centre, see Fig. 5.3. Ray B will travel
in the cladding region and it is known as an unguided ray, whereas ray A will stay within
core region, and it will form a guided ray.
There exists an angle θa (known as the acceptance angle) such that all rays incident from
a region with refractive index n0 at angles fulﬁlling the relation
θ < θa
will stay within a core region (such as ray A). All rays incident at the acceptance angle θa
will travel at the boundary between core and cladding.
106

107
Geometrical-optics description
jacket
b
a
cladding
core
Fig. 5.1
Cross-section of a typical optical fibre.
n
n1
n2
n0
a
b
n0
n2
n1
a
b
n
Fig. 5.2
Typical profiles of optical fibre. Linear step (left) and graded (right).
1
2
A
A
B
B
Core index n1
n
θ
θ
φ
0
Cladding index n2
Fig. 5.3
Acceptance angle.
The numerical aperture (NA) is deﬁned as
NA ≡n0 sin θa
It is a dimensionless quantity. Typical values of NA are within the 0.14–0.50 range. Eval-
uation of NA follows exactly the same procedure as described in Chapter 4. The ﬁnal
expression is
NA = n1 (2)1/2
(5.1)
In practice n1 ≈n2 and the relative refractive index difference  is
 = (n1 + n2) (n1 −n2)
2n2
1
≃2n1 (n1 −n2)
2n2
1
= n1−n2
n1
(5.2)
A typical value of parameter  for a single-mode ﬁbre is around 0.01.

108
Linear optical fibre and signal degradation
5.1.2 Multipath dispersion
A very important physical effect originates from the fact that different rays travel along
paths of different lengths. The shortest path, for incident angle θ1 = 0 is equal to L, ﬁbre
length; the longest path, for θ1 = θmax (which corresponds to φc) is for rays travelling the
distance
L
sin φc . Time delay between both paths is T. It can be estimated as follows:
T = distance
υ
=
L
sin φc −L
c
n1
= n1
c

L
sin φc
−L

= n1
c
&
L
n2
n1
−L
'
= Ln1
c
n1
n2
−1

= Ln1
cn2
n1 −n2
n1
= Ln2
1
cn2

(5.3)
where we have used υ =
c
n1 for speed of light in ﬁbre. Time T is a measure of broadening
of an impulse.
5.1.3 Information-carrying capacity of the fibre
Next, we will estimate the information-carrying capacity of the ﬁbre. If we introduce B as
a bit rate, and L ﬁbre length, then the measure of the information-capacity of the ﬁbre is
determined by a product B · L.
The estimation of this product is as follows. Let TB where TB = 1
B be the time allocated
for each bit slot. We use the condition
T < TB
(5.4)
which requires that pulse broadening is smaller than time slot allocated for each bit. Let us
substitute the previous expression for T, and we obtain
Ln2
1
cn2
 · B < 1 or
L · B <
n2
n2
1
c

(5.5)
Example
Assume n1 = 1.5, n2 = 1.0. From the above, one ﬁnds L · B < 0.4 Mb
s · km. On
the other hand, for  = 2 × 10−3 ⇒B · L < 100 Mb
s · km. This means that one can carry
data of 10 Mb s−1 over 10 km.
5.1.4 Loss mechanisms in silica fibre
Attenuation(losses) of optical signal is amajor factor inthedesignof optical communication
systems. Losses can occur at the input coupler, splices and connectors but also within the

109
Geometrical-optics description
1.6
1.8
1.4
1.2
1.0
0.1
0.01
0.5
0.05
5
10
50
100
1
0.8
waveguide
imperfections
infrared
absorption
ultraviolet
absorption
Rayleigh
scattering
wavelength (microns)
loss (dB/km)
Fig. 5.4
Spectrum of losses in glass. Adapted from [3] with permission from the Institution of Engineering and Technology.
ﬁbre itself. In this section we will concentrate on losses in the ﬁbre. A typical spectrum of
losses in modern ﬁbre is shown in Fig. 5.4. Losses are usually expressed in decibels per
unit of distance (as was mentioned in Chapter 2) according to formula
αloss = 10
L log10
Pout
Pin
(5.6)
where Pin and Pout are, respectively, the input and output optical powers for a ﬁbre of
length L.
Loss mechanisms are classiﬁed as [4]:
• intrinsic which arise from the fundamental material properties of the glass. These can be
reduced, e.g. by appropriate choice of wavelength
• extrinsic which result due to imperfections in the fabrication process. Sources of extrinsic
loss include impurities or structural imperfections.
5.1.5 Intrinsic loss
In pure silica, the three sources of loss important at visible and near-infrared wavelengths
are:
• ultraviolet absorption
• infrared absorption
• Rayleigh scattering.
All of the three mechanisms are wavelength dependent. The ﬁrst two involve two reso-
nances centred in the ultraviolet and mid-infrared, see Fig. 5.4. They originate due to strong
electronic and molecular transition bands. The ultraviolet resonance is of electronic origin
and is centred near λ = 0.1 µm [4]. The infrared absorption originates from lattice vibra-
tional modes of silica and dopants. The vibrational modes produce absorptive resonances

110
Linear optical fibre and signal degradation
x
y
z
φ
z
r
Fig. 5.5
Cylindrical coordinate system.
centered between 7 µm and 11 µm. The resonances for silica and germania occur at 9 µm
and 11 µm, respectively [4]. Intraband absorption results in a power loss approximately
given by
αir = A exp
(
−air
λ
)
[dB km−1]
(5.7)
where λ is in micrometres. For GeO2 −SiO2 glass, the values of A and air are A =
7.81 × 1011 dB km−1 and air = 48.48 µm [4].
Rayleigh scattering in pure fused silica can be approximated by the expression
αR = 1.7
0.85
λ
4
(5.8)
where λ is in micrometres and loss αR is in dB km−1.
Rayleigh scattering appears when a wave travels through a medium having scattering
objects smaller than a wavelength [5]. In a glass those small objects are created as lo-
cal variations in refractive index in otherwise homogeneous material. Local variations of
refractive index in turn can be due to localized variations in a material’s density.
5.1.6 Extrinsic loss
These losses are not associated with the fundamental properties of material. There are
many sources of extrinsic losses, for example presence of additional impurities and surface
irregularities at the core-cladding boundary. Some other related losses are due to bending
and source-ﬁbre coupling.
5.2 Fibre modes in cylindrical coordinates
Fibre exhibits cylindrical symmetry, see Fig. 5.5. In the cylindrical coordinate system we
use the following variables: r, φ, z. Refractive index is expressed as (see Fig. 5.1)
n =
n1,
r ≤a
n2,
r > a

(5.9)
where a is the radius of the central region known as core.

111
Fibre modes in cylindrical coordinates
5.2.1 Maxwell’s equations in cylindrical coordinates
In cylindrical coordinates, one has the following general relation for arbitrary vector A [6]:
∇×A = 1
r

ar
raφ
az
∂
∂r
∂
∂φ
∂
∂z
Ar
rAφ
Az

= ar
 ∂Az
r∂φ −∂Aφ
∂z

+aφ
∂Ar
∂z −∂Az
∂r

+az
1
r
 ∂
∂r

rAφ

−∂Ar
∂φ

wherear,aφ,az are unit vectors in the corresponding directions. Vector A is expressed as
A = arAr +aφAφ +azAz
Assuming e jωt dependence for ﬁelds, the ﬁrst Maxwell equation in cylindrical coordinates
is
1
r
∂Ez
∂φ −∂Eφ
∂z
= −jωμHr
∂Er
∂z −∂Ez
∂r
= −jωμHφ
1
r
 ∂
∂r

rEφ

−∂Er
∂φ

= −jωμHz
Assuming additionally ejβz dependence, one ﬁnds
1
r
∂Ez
∂φ + jβEφ = −jωμHr
(5.10)
jβEr + ∂Ez
∂r
= jωμHφ
(5.11)
1
r
 ∂
∂r

rEφ

−∂Er
∂φ

= −jωμHz
(5.12)
Similarly, from the second Maxwell equation we obtain
1
r
∂Hz
∂φ + jβHφ = jωεEr
(5.13)
jβHr + ∂Hz
∂r
= −jωεEφ
(5.14)
1
r
 ∂
∂r

rHφ

−∂Hr
∂φ

= jωεEz
(5.15)
Expressing Hr from (5.10) and (5.14) and comparing both expressions, one obtains for Eφ
Eφ = −j
q2
β
r
∂Ez
∂φ −ωμ∂Hz
∂r

(5.16)
where
q2 = ω2εμ −β2
(5.17)
= n2k2
0 −β2

112
Linear optical fibre and signal degradation
Similarly, using the same procedure, from (5.11) and (5.13) one obtains for Er
Er = −j
q2

β ∂Ez
∂r + ωμ
r
∂Hz
∂φ

(5.18)
In an analogous way one ﬁnds expressions for Hφ and Hr:
Hφ = −j
q2
β
r
∂Hz
∂φ + εω ∂Ez
∂r

(5.19)
Hr = −j
q2

β ∂Hz
∂r −εω
r
∂Ez
∂φ

(5.20)
Equations (5.16), (5.18), (5.19) and (5.20) express relevant components of E and H ﬁelds in
terms of Ez and Hz components. In the next step, we derive equations for those components.
5.2.2 Wave equations in cylindrical coordinates
From the analysis above we can observe that the z-component of the electric ﬁeld Ez (and
same applies also to magnetic z-component Hz) can be considered an independent variable
and that the remaining components can be expressed in terms of Ez. (The same is true for
Hz.) Hence, we only need to work with Ez (or Hz). For that purpose we will derive the
appropriate wave equation from which we can obtain a solution for Ez. Once we have a
solution for Ez we will use it to ﬁnd Er and Eφ. In this way, all components of the electric
ﬁeld within a circular waveguide are derived.
To derive the equation for Ez we start with Eq. (5.15). Replacing derivatives on the left
hand side by expressions (5.19) and (5.20) and rearranging terms, one ﬁnds
∂2Ez
∂r2 + 1
r
∂Ez
∂r + 1
r2
∂2Ez
∂φ2 + q2Ez = 0
(5.21)
where q2 is given by Eq. (5.17).
Similarly, we can derive an equation for Hz. For the last step we will use Eq. (5.12). We
replace Eφ and Er and obtain a wave equation for Hz in cylindrical coordinates
∂2Hz
∂r2 + 1
r
∂Hz
∂r + 1
r2
∂2Hz
∂φ2 + n2k2
0Hz = 0
(5.22)
5.2.3 Solution of the wave equation in cylindrical coordinates
Here, we will analyse the equation for Ez. An equation for Hz can be solved in a similar
way. Assume that the following separation of variables is possible:
Ez (r, φ) = R (r)  (φ)
(5.23)
After separation, one obtains two equations
d2(φ)
dφ2
+ m2(φ) = 0
(5.24)

113
Fibre modes in cylindrical coordinates
0
5
10
−0.5
0
0.5
1
z
Jm(z)
m = 1
m = 2
m = 0
0
5
10
−4
−2
0
z
Ym(z)
m = 0 m = 1 m = 2
Fig. 5.6
Ordinary Bessel functions. (left) Functions Jm, (right) functionsYm.
and
r2 d2R
dr2 + rdR
dr +

r2q2 −m2
R = 0
(5.25)
where m2 is a separation constant. Eq. (5.25) is known as the Bessel equation and its
solutions are known as Bessel functions [7]. The solution of Eq. (5.24) is
(φ) = eimφ
(5.26)
Here, m takes integer values because (φ + 2π) = (φ).
The Bessel equation will be written and solved separately for core and cladding regions.
In the core region it reads
r2 d2R
dr2 + rdR
dr +

r2κ2 −m2
R = 0
(5.27)
where
κ2 = n2
1k2
0 −β2 > 0
(5.28)
The solutions of this equation are known as ordinary Bessel functions Jm and Nm of the ﬁrst
order and are shown in Fig. 5.6.
The Bessel equation for the cladding region is
r2 d2R
dr2 + rdR
dr +

r2γ 2 + m2
R = 0
(5.29)
where
γ 2 = β2 −n2
2k2
0 > 0
(5.30)
The solutions of this equation are known as modiﬁed Bessel functions, Km,Im of the second
kind and of order m. Those functions are plotted in Fig. 5.7.
MATLAB codes for obtaining plots of Bessel functions are provided in Appendix 5C.1.
Using the above results for solutions of Bessel equations, one can obtain the solutions for

114
Linear optical fibre and signal degradation
0
1
2
3
0
1
2
3
4
5
z
Km(z)
m = 2
0
1
2
3
0
1
2
3
4
5
z
Im(z)
m = 0
   m = 1      m = 2
m = 0
m = 1
Fig. 5.7
Modified Bessel functions. (left) Functions Km, (right) functions Im.
core and cladding regions as [4]
R (r) =
	
AJm (κr) + A′Ym(κr),
r ≤a
CKm (γ r) + C′Im(γ r),
r > a
(5.31)
where A, A′,C,C′ are constants.
We expect the following properties of guided modes:
1. the solution in the core will be oscillatory and ﬁnite at r = 0
2. the solution in the cladding will decrease monotonically as radius increases, i.e.
ﬁeld →0 for r →∞.
The above properties imply that for core the Jm function should be used and since Ym has
a singularity (see Fig. 5.6), for r = 0 we set A′ = 0. Similarly for cladding the function Im
increases (see Fig. 5.7) and we set C′ = 0. In cladding we use only Km.
In this way one ﬁnds the solutions
Ez =
	
AJm (κr) eimφ,
r ≤a
CKm (γ r) eimφ,
r > a
(5.32)
In exactly the same way
Hz =
	
BJm (κr) eimφ,
r ≤a
DKm (γ r) eimφ,
r > a
(5.33)
Employing Eqs. (5.16), (5.18), (5.19) and (5.20), one can express the other ﬁeld compo-
nents in terms of Ez and Hz. After a little algebra, the full solutions are:
Case: r < a (core)
Eφ = −j
κ2

j β
r mAJm (κr) −ωμκBJ′
m (κr)

e jmφ
(5.34)
Er = −j
κ2
(
βκAJ′
m (κr) +j ωμ
r mBJm (κr)
)
e jmφ
(5.35)
Hφ = −j
κ2

ωε1κAJ′
m (κr) + j β
r mBJm (κr)

ejmφ
(5.36)

115
Fibre modes in cylindrical coordinates
Hr = −j
κ2
(
βκBJ′
m (κr) −j ωε1
r mAJm (κr)
)
e jmφ
(5.37)
Case: r > a (cladding)
Eφ =
j
γ 2

j β
r mCKm (γ r) −ωμγ DK′
m (γ r)

e jmφ
(5.38)
Er =
j
γ 2
(
βγCK′
m (γ r) +j ωμ
r mDKm (γ r)
)
e jmφ
(5.39)
Hφ =
j
γ 2

ωε2γCK′
m (γ r) + j β
r mDKm (γ r)

ejmφ
(5.40)
Hr =
j
γ 2
(
βγ DK′
m (γ r) −j ωε2
r mCKm (γ r)
)
e jmφ
(5.41)
where we have introduced the following deﬁnitions
J ′
m (κr) = dJm (κr)
d(κr)
and
K′
m (γ r) = Km (γ r)
d(γ r)
5.2.4 Boundary conditions and modal equation
We use boundary conditions derived previously which require that all ﬁeld components
tangent to the core-cladding boundary at r = a must be continuous across it. We therefore
have [8]
Ez, Hz, Eφ, Hφ are continuous at r = a
(5.42)
Applying the above requirement, we obtain the following equations:
1. from continuity of Ez
AJm (κa) = CKm (γ a)
(5.43)
2. from continuity of Hz
BJm (κa) = DKm (γ a)
(5.44)
3. from continuity of Eφ
βm
κ2aJm (κa) A + j ωμ
κ J′
m (κa) B + βm
γ 2aKm (γ a)C + j ωμ
γ K′
m (γ a) D = 0
(5.45)
4. from continuity of Hφ
−j ωε1
κ J′
m (κa) A + βm
aκ2 Jm (κa) B −j ωε2
γ K′
m (γ a)C + βm
aγ 2 Km (γ a) D = 0
(5.46)

116
Linear optical fibre and signal degradation
The above form a set of simultaneous equations for unknown coefﬁcients A, B,C, D. The
nontrivial solution is obtained if the determinant vanishes, i.e.

Jm (κa)
0
−Km (γ a)
0
0
Jm (κa)
0
−Km (γ a)
βm
κ2aJm (κa)
j ωμ
κ J′
m (κa)
βm
γ 2aKm (γ a)
j ωμ
γ K′
m (γ a)
−j ωε1
κ J′
m (κa)
βm
aκ2 Jm (κa)
−j ωε2
γ K′
m (γ a)
βm
aγ 2 Km (γ a)

= 0
(5.47)
Expansion and evaluation of this determinant is described in Appendix 5B. The resulting
characteristic equation is
 J ′
m(κa)
κJm (κa) + K′
m (γ a)
γ Km (γ a)
 !
k2
0n2
1J′
m (κa)
κJm (κa)
+ k2
0n2
2K′
m (γ a)
γ Km (γ a)
"
= β2m2
a2
 1
κ2 + 1
γ 2

(5.48)
This equation forms the basis for obtaining propagation constants for guided modes prop-
agating in cylindrical ﬁbre. Before we start a detailed discussion, let us look at the general
classiﬁcation of modes.
5.2.5 Mode classification
Variable m is the main parameter used in mode classiﬁcation. It is known as azimuthal
mode number. Because of the oscillatory behavior of Jm (κa) for a given value of m as
seen in Figs. 5.6, multiple solutions exist for each integer value m. We denote them as βmn,
where n = 1, 2, . . . Index n is called the radial mode number and it represents the number
of radial modes that exist in the ﬁeld distribution [4].
In general, electromagnetic waves in a step index optical cylindrical ﬁbre can be divided
into three distinct categories [9]:
1. Transverse electric (TE); sometimes designated as magnetic (H) waves. They are char-
acterized by Ez = 0 and Hz ̸= 0.
2. Transverse magnetic (TM); sometimes designated as electric (E) waves. They are char-
acterized by Ez ̸= 0 and Hz = 0.
3. Hybrid waves. Characterized by Ez ̸= 0 and Hz ̸= 0.
In more detail, the following cases are treated separately [8]:
1. m = 0. Still, solutions are separated into two groups:
a. TM0n (transverse magnetic) because Eφ = Hr = Hz = 0. In this case coefﬁcients
B = D = 0.
b. TE0n (transverse electric) because Hφ = Er = Ez = 0. In this case coefﬁcients
A = C = 0.
2. m ̸= 0. Hybrid modes.
The modes are called EH or HE modes (terminology has historical roots traced to
microwaves).

117
Fibre modes in cylindrical coordinates
Values of β will correspond to modes which have ﬁnite components of both Ez and Hz.
There are neither TE nor TM modes. General classiﬁcation is [10], [11], [12].
if A = 0 the mode is called TE mode
if B = 0 the mode is called TM mode
if A > B = 0 the mode is called HE mode ( Ez dominates Hz)
if A < B = 0 the mode is called EH mode ( Hz dominates Ez).
Now, we will discuss some of those cases in more detail.
5.2.6 Modes with m = 0
The simplest solutions of characteristic Eq. (5.48) are obtained for m = 0. In this case there
is no angular dependence on φ, and therefore ﬁeld components Ez and Hz are rotationally
invariant. The characteristic equation is reduced into two equations which describe TE and
TM modes:
TE modes
J′
0(κa)
κJ0 (κa) + K′
0 (γ a)
γ K0 (γ a) = 0
(5.49)
TM modes
J′
0 (κa)
κJ0 (κa)+n2
2
n2
1
K′
0 (γ a)
γ K0 (γ a) = 0
(5.50)
Using the following relations for Bessel functions, (see Appendix 5A)
J′
0(u)
J 0 (u) = J−1(u)
J 0 (u)
and
K′
0 (w)
wK0 (w) = −K−1 (w)
wK0 (w)
and J−1 = (−1)1J1, K−1 = K1, one obtains
J1(u)
J0(u) + u
w
K1(w)
K0(w) = 0
(5.51)
and
J1(u)
J0(u) + n2
2
n2
1
u
w
K1(w)
K0(w) = 0
(5.52)
where we used deﬁnitions u = aκ and w = aγ .
The interpretation of relations (5.51) and (5.52) as describing TE and TM modes comes
from the following observations.
From continuity equations for Ez and Hz (established in the previous section), one can
express constants C and D in terms of A and B. Substitute these results into the continuity
equation for Eφ and obtain
Aβm
a
 1
κ2 + 1
γ 2

+ jωμ
 J′
m(κa)
κJm (κa) + K′
m (γ a)
γ Km (γ a)

B = 0
When the term in the square bracket is zero, then A = 0 and because of Eq. (5.32),
Ez = 0 which means that electric ﬁeld is transverse, i.e. TE mode. Similarly, substituting

118
Linear optical fibre and signal degradation
expressions for constants C and D into continuity equation for Hφ one obtains
−j

n2
1
J ′
m(κa)
κJm (κa) + n2
2
K′
m (γ a)
γ Km (γ a)

A + βm
a ωμ
 1
κ2 + 1
γ 2

B = 0
When the term in the square bracket is zero, then B = 0 and because of Eq. (5.33), Hz = 0
which means that magnetic ﬁeld is transverse, i.e. TM mode.
Interpretation
Here, we will provide an interpretation of relations (5.51) and (5.52) which describe TE
and TM modes.
1. TM modes
Assuming B = D = 0 (and also m = 0), from Eqs. (5.34)–(5.37) in the core region one
ﬁnds
Eφ = 0,
Er = −j
κ βAJ′
0 (κr)
Hφ = −j
κ ωε1AJ′
0 (κr) ,
Hr = 0
Also, from (5.32) and (5.33) one has
Ez = AJ0 (κr) ,
Hz = 0
For such modes longitudinal magnetic component Hz is zero and it is therefore called TM
mode (transverse magnetic). Designation of such modes is TM0n.
2. TE modes
In a similar way, taking A = C = 0 (and also m = 0), from Eqs. (5.34)–(5.37) in the
core region one obtains
Eφ = j
κ ωμBJ′
0 (κr) ,
Er = 0
Hφ = 0,
Hr = −j
κ βBJ ′
0 (κr)
and also, from (5.32) and (5.33) one has
Ez = 0,
Hz = BJ0 (κr)
For such modes longitudinal electric component Ez is zero and it is therefore called TE
mode (transverse electric). Designation of such modes is TE0n.
A summary of mode properties for m = 0 is provided in Table 5.1.
5.2.7 Weakly guiding approximation (wga)
General solution of the dispersion Eq. (5.48) is very complicated. Gloge [13] developed an
approximation known as the weakly guiding approximation (wga). It is based on the fact

119
Fibre modes in cylindrical coordinates
Table 5.1 Classification of modes for m = 0.
Mode
Values of
Nonzero ﬁeld
Zero ﬁeld
description
Equation
coefﬁcients
components
components
TE0n
J ′
0(u)
uJ0 (u) + K′
0 (w)
γ K0 (w) = 0
A = C = 0
Hz, Hr, Eφ
Ez = Er = Hφ = 0
TM0n
J ′
0(u)
uJ0 (u) + n2
2
n2
1
K′
0 (w)
γ K0 (w) = 0
B = D = 0
Ez, Er, Hφ
Hz, Hr, Eφ = 0
that n1 −n2 ≪1. Under such approximation n2
1 ≈n2
2 = n2 and also β2 ≈k2
0n2. Introducing
deﬁnitions u = κa and w = γ a, general Eq. (5.48) reduces to
J ′
m(u)
uJm (u) + K′
m (w)
wKm (w) = ±m
 1
u2 + 1
w2

(5.53)
One can observe that two possible cases exist. We will consider them separately.
Case ‘+’:
Applying properties of Bessel functions (see Appendix 5A) given by Eqs. (5.85) and (5.87),
from Eq. (5.53) one obtains
Jm+1(u)
uJm (u) + Km+1 (w)
wKm (w) = 0
(5.54)
Case ‘−’:
Applying properties of Bessel functions (see Appendix 5A) given by Eqs. (5.84) and (5.86),
from Eq. (5.53) one has
Jm−1(u)
uJm (u) + Km−1 (w)
wKm (w) = 0
(5.55)
Eigenvalue Eq. (5.53) is solved numerically to ﬁnd propagation constant β. In general,
it has multiple solutions for each m. They are labelled by n (n = 1, 2, . . .). Thus β = βmn.
Each value of βmn corresponds to one possible mode. Fibre modes are referred to as hybrid
modes and denoted by [4]
HEmn (dominatesHz)
EHmn (dominatesEz)
In special case m = 0
HE0n ≡TE0n
EH0n ≡TM0n

correspond to transverse electric and transverse magnetic
LP modes
LP modes originate in a weakly guiding approximation. Those approximate solutions are
much simpler than the exact solutions. Solving characteristic equation leads to similar
eigenvalues for both the EHm−1,n modes and HEm+1,n [9]. If the ﬁelds of these modes are

120
Linear optical fibre and signal degradation
combined, the resulting transversal ﬁeld will be linearly polarized. The linearly polarized
modes are labelled as LPm,n. They are composed in the following way:
LP0n = HE1n
LP1n = HE2n + E0n + H0n
LPm,n = HEm+1,n + EHm−1,n,
m > 2
For each n there are two LP0n modes, polarized perpendicular to each other, while for each
n and each m > 0 there are four LPm,n. Here
LPmn (LP stands for linearly polarized)
(5.56)
At the end, let us summarize some important deﬁnitions:
N ≡β
k0
which is known as mode index or effective index, and also
V = k0a

nn2
1 −n2
2
1/2 ≈2π
λ an1
√
2
where
 = n1 −n2
n1
and ﬁnally
b =
β
k0 −n2
n1 −n2
≡¯n −n2
n1 −n2
To ﬁnish this section, consider an example.
Example
Typical values (for multimode ﬁbres) are a = 25 µm,  = 5 × 10−3, V ≈18,
at λ = 1.3 µm. Using approximate expression M = V 2/2, where M is the total number of
modes (see Problem 1), one ﬁnds out that this particular ﬁbre supports approximately 162
modes.
5.2.8 The unified expression
Equations derived so far for TE, TM, EH and HE modes in the weakly guiding approxi-
mation can be written in the form of a single equation. One should notice that in the wga,
equations describing TE and TM modes degenerate into a single equation. The Eq. (5.55)
for HE modes requires modiﬁcation. First, write Eq. (5.55) as
uJm (u)
Jm−1(u) + wKm (w)
Km−1 (w) = 0
(5.57)
In order to appropriately modify the above equations, consider general formulas for Bessel
functions provided in the Appendix, Eqs. (5.79) and (5.80). By changing index as m+1 →m

121
Fibre modes in cylindrical coordinates
in those equations, one obtains
uJm(u) = 2(m −1)Jm−1(u) −uJm−2(u)
wKm(w) = 2(m −1)Km−1(w) + wKm−2(u)
The above equations can now be substituted into (5.57) and ﬁnally obtain
−uJm−2 (u)
Jm(u)
= wKm−2 (w)
Km (w)
(5.58)
Equations (5.54) and (5.58) can now be written as a single equation if we deﬁne new index
k as
k =
⎧
⎨
⎩
1
for both TE and TM modes
m + 1
for EH modes
m −1
for HE modes
The universal equation reads
uJk−1 (u)
Jk(u)
= −wKk−1 (w)
Kk (w)
(5.59)
5.2.9 Universal relation for fundamental mode HE11
Fundamental mode HE11 (or LP01) has the following dispersion relation (corresponding to
m = 1):
J1(u)
J0(u) + u
w
K1(w)
K0(w) = 0
(5.60)
where u = a

n2
1k2
0 −β2 and w = a

β2 −n2
2k2
0. Recall previous relations
b = β2/k2
0 −n2
2
n2
1 −n2
2
= β2 −n2
2k2
0
n2
1k2
0 −n2
2k2
0
and
V = k0a

n2
1 −n2
2
1/2
From these deﬁnitions, one ﬁnds
b = w2
V 2
After a little algebra
u2 = a2 
n2
1k2
0 −β2
= a2n2
1k2
0 −a2n2
2k2
0 + a2n2
2k2
0 −a2β2
= V 2 −w2 = V 2 −V 2b
The arguments in Eq. (5.60) can therefore be expressed as
u = V
√
1 −b
and
w = V
√
b

122
Linear optical fibre and signal degradation
0
0.5
1
1.5
2
2.5
0
0.5
1
1.5
b
d(bV)/dV
Vd2(bV)/dV 2
V
Fig. 5.8
Plot of the waveguide parameter band its derivatives d(bV )/dV andV d2(bV )/dV 2 as a function of theV
number for HE11 mode.
Replacing arguments in Eq. (5.60) with the above relations, we ﬁnally obtain
J1(V
√
1 −b)
J0(V
√
1 −b)
+
√
1 −b
√
b
K1(V
√
b)
K0(V
√
b)
= 0
(5.61)
The above formula holds for mode HE11. It contains only two variables V and b. It is
therefore called a universal relation. In Appendix 5C.2 we provided MATLAB program
which plots b = b(V ) relation and also two other functions d(bV )
dV
and V d2(bV )
dV 2
which are
important in determining dispersion relation for propagating mode. Those relations are
shown in Fig. 5.8.
5.2.10 Single-mode fibres
The single-mode ﬁbre supports only HE11 mode (fundamental mode which corresponds to
m = 0). From Eq. (5.48) we have
κJ0 (κa) K′
0 (γ a) + γ J′
0 (γ a) K0 (γ a) = 0
κn2
2J0 (κa) K′
0 (γ a) + γ n2
1J′
0 (γ a) K0 (γ a) = 0
At cutoff, b = 0 which gives that β/κ0 = N and that γ = 0. Also, κ2a2 = a2k2
0(n2
1 −n2
2).
Thus V = κa when γ = 0.
Thus cutoff condition is
J0 (V ) = 0
(5.62)
which gives (for single mode)
V = 2.405
(5.63)

123
Dispersion
1
m = 0
m = 1
0.5
0
Jm(κ a)
–0.5 κca = 0
κca = 2.405
κca = 3.85
κca = 5.52
κca = 7.02
–1
–1.50
2
4
κ a
6
8
10
Fig. 5.9
Plot of Bessel functions for m = 0 and m = 1 used to illustrate cutoff conditions.
Example
Estimates of a.
Assume λ = 1.2µm, n1 = 1.45 and  = 5×10−3. For those values, the above condition
for V gives a < 3.2 µm.
5.2.11 Cutoff conditions
The condition b = 0, which results in β2 = k2
0n2
2, deﬁnes the so-called cutoff of the mode
[14]. A mode is cut off when its ﬁeld in the cladding becomes evanescent and is detached
from the guide. At cutoff β = k0n2 and also b = 0,V = Vc. The situation is illustrated in
Fig. 5.9 for m = 0 and m = 1. Case m = 0 corresponds to modes TE0n and TM0n. The
cutoff conditions for those modes are obtained from roots of the following equation:
J0(κca) = 0
(5.64)
Cutoff conditions are illustrated in Fig. 5.9. For m = 0 the few lowest roots are shown. They
correspond to κca = 2.405 and κca = 5.52. For m = 1 the lowest cutoffs are: κca = 3.83
and κca = 7.02.
5.3 Dispersion
Dispersion is an effect responsible for spreading of a signal in time when it propagates.
Signal is represented by pulse, so effectively we talk about pulse broadening.
Transmitted pulses broaden when they propagate in dispersive media. After long propa-
gation it might be impossible to distinguish individual pulses, see Fig. 5.10.

124
Linear optical fibre and signal degradation
(a)
(b)
Fig. 5.10
The effect of dispersion on short temporal pulses. (a) Before entering dispersive medium. (b) After propagation in a
dispersive medium.
The main types of dispersion are [10]:
1. Material dispersion.
It exists when refractive index n(λ) depends on wavelength. As a result, different wave-
lengths travel with different velocities.
2. Modal dispersion.
Exists in waveguides with more than one propagating mode. Each mode propagates with
different velocity.
3. Waveguide dispersion.
Exists because propagation constant β depends on the wavelength, so even for n(λ) =
const different wavelengths will propagate with different speeds. Usually the smallest,
but important close to the wavelength where dispersion is zero.
5.3.1 Group delay-general discussion
In a ﬁbre, different spectral components of the pulse travel at slightly different group
velocities. They produce an effect known as group-velocity dispersion (GVD), also known
as intermodal dispersion or ﬁbre dispersion. The name used depends on what description
is used (geometrical optics or wave optics).
Detailed discussion is based on the following assumptions:
• optical signal excites all modes equally at the input of the ﬁbre
• each mode contains all spectral components
• each spectral component travels independently (in the ﬁbre)
• each spectral component undergoes a time delay or group delay.
Transit time of a pulse travelling through the ﬁbre of length L is
τg
L = 1
vg
(5.65)
where τg – time delay or group delay, L – distance, vg – group velocity, β – propagation
constant.
Group delay determines the transit time of a pulse travelling through the ﬁbre of length
L. Group velocity is deﬁned as
1
vg
≡dβ
dω
(5.66)

125
Dispersion
Typically, one can expresses τg in terms of derivatives with respect to k or λ or V . For that
purpose we will summarize several relations:
ω = 2πν,
ν = c
λ,
k = 2π
λ ,
ω = kc,
V =

n2
1 −n2
2
1/2 · a · k
From the above relations, one ﬁnds the following useful formulas:
d
dω =
d
cdk ,
dk = dk
dλdλ,
dk
dλ = −2π
λ2 ,
d
dk = −λ2
2π
d
dλ
(5.67)
To evaluate derivative with respect to V , one observes that β = β(k(V )). Therefore
dβ
dk = dβ
dV
dV
dk = V
k
dβ
dV
where we applied the following result obtained using expression for V :
dV
dk = V
k
Using the above relations allows us to express τg in several forms as
τg = Ldβ
dω = L
c
dβ
dk = L
c
V
k
dβ
dV = −Lλ2
2πc
dβ
dλ
(5.68)
Because τg depends on λ, each spectral component of any particular mode travels the same
distance in different time.
At this stage, a typical procedure is to explicitly consider two main physical mechanisms
which contribute to group delay τg. One can therefore write
τg = L
c
dβ
dk

n̸=const
+ L
c
dβ
dk

n=const
≡τmat + τwg
(5.69)
where τmat is known as material dispersion whereas τwg is a waveguide dispersion.
Material dispersion accounts for the fact that refractive index depends on wavelength; i.e.
n = n(λ). If we neglect dependence of refractive index on wavelength, i.e. set n = const,
then due to the fact that group velocity depends on λ one obtains the contribution known
as waveguide dispersion. We now consider both contributions separately.
5.3.2 Material dispersion: Sellmeier equation
Material dispersion originates from the fact that refractive index n(λ) is wavelength depen-
dent. Propagation constant β is
β = 2π
λ n(λ)
Use the above and Eq. (5.68) to obtain
τmat = L
c

n −λdn
dλ

(5.70)

126
Linear optical fibre and signal degradation
0.5
1
1.5
2
1.44
1.445
1.45
1.455
1.46
1.465
wavelength (μm)
refractive index
Fig. 5.11
Wavelength dependence of refractive index based on the Sellmeier equation for SiO2.
Let us concentrate now on material dispersion in silica. In practice, very often an empirical
expression for the refractive index of glass in terms of the wavelength λ is used. It is known
as the Sellmeier equation and it was introduced in Chapter 2. Its form is
n2 = 1 + G1
λ2
λ2 −λ2
1
+ G2
λ2
λ2 −λ2
2
+ G3
λ2
λ2 −λ2
3
(5.71)
Here G1, G2, G3 and λ1, λ2, λ3 are constants (called Sellmeier coefﬁcients) which are
determined by ﬁtting the above expression to the experimental data. Often in literature
more elaborate expressions are used. Using data provided in Table 2.2, we plotted in
Fig. 5.11a refractive index for SiO2 as a function of wavelength. MATLAB code is provided
in Appendix 5C.3.
5.3.3 Waveguide dispersion
Waveguide dispersion exists because group velocity vg depends on the wavelength. The
expression for waveguide dispersion τwg is expressed in terms of quantity b introduced
earlier, so we start with the deﬁnition of parameter b
b = β2/k2 −n2
2
n2
1 −n2
2
≈β/k −n2
n1 −n2
where we used the fact that β/k ≈n1 ≈n2. We use the above equation to determine β as
β = kn2(1 + b)
(5.72)
Here  = n1−n2
n2 . Waveguide dispersion is obtained by evaluatind derivative dβ/dk using
Eq. (5.72) and assuming that n2 is k independent. One ﬁnds
dβ
dk = n2 + n2d(bV )
dk

127
Pulse dispersion during propagation
Substitute the above result into general deﬁnition (5.69) and have
τwg = L
c

n2 + n2d(V b)
dV

(5.73)
5.4 Pulse dispersion during propagation
Because τg depends on λ, each spectral component of any particular mode travels the same
distance in different time. As a result, optical pulse spreads out with time. Let λ be a
spectral width of a source. Each wavelength component within λ will propagate with
different group velocity, resulting in a temporal broadening of a pulse. Pulse broadening
τ is expressed as
τ = dτ
dλλ
(5.74)
Assuming only material dispersion, i.e. τ = τmat and using previous result (5.70) we have
dτmat
dλ
= L
c
dn
dλ −dn
dλ −λd2n
dλ2

= −L
c λd2n
dλ2
Therefore τmat can be written as
τmat = −L
c

λ2 d2n
dλ2
 λ
λ

(5.75)
From the above, one can see that material dispersion can be speciﬁed in units of picoseconds
per kilometre (length of ﬁbre) per nanometre (spectral width of the source). One usually
introduces
Dmat = τmat
Lλ = 1
L
dτmat
dλ
=
= −1
cλd2n
dλ2
(5.76)
which is known as material dispersion coefﬁcient. In practical units [14]
Dmat = −1
λ · c

λ2 d2n
dλ2

× 109
ps
km · nm
(5.77)
whereλisinnmandvelocityoflight c = 3×105 kms−1. TypicalbehaviourforSiO2−13.5%
GeO2 is shown in Fig. 5.12. MATLAB code is provided in Appendix 5C.4.
For waveguide dispersion, we can also determine waveguide dispersion coefﬁcient Dwg
which is deﬁned as
Dwg = 1
L
τwg
λ
Here τwg is the pulse broadening due to waveguide. It can be expressed as
τwg = dτwg
dλ λ

128
Linear optical fibre and signal degradation
1.2
1.3
1.4
1.5
1.6
−20
−15
−10
−5
0
5
10
15
20
wavelength (μm)
Material dispersion (ps/km nm)
Fig. 5.12
Material dispersion as a function of optical wavelength.
Using Eq. (5.73), one can evaluate dτwg
dλ . It is, however, typical to express it in terms of
parameter V , which is V = 2π
λ an2
√
2 ≡A
λ. Taking derivative
dV
dλ = −A
λ2
allows us to express
d
dλ = −A
λ2
d
dV
Using the above, we have
dτwg
dλ = −A
λ2
dτwg
dV
= −V
λ
L
c n2d2(V b)
dV 2
Finally
Dwg = −n2
c · λV d2(V b)
dV 2
(5.78)
Combining the above results for material and waveguide dispersion and using the Sellmeier
equation with parameters for silica, one can determine total dispersion of ﬁbre glass. The
work is left as a project.
5.5 Problems
1.
Based on ray theory, estimate the number of modes M in a multimode ﬁbre when M
is large.
2.
Determine the cutoff wavelength for single-mode operation of an optical ﬁbre. As-
sume the following parameters: a = 5 µm, n2 = 1.450,  = 0.002.
3.
Determine the value of waveguide dispersion for the above parameters.

129
Appendix 5A
4.
A ﬁbre of 10 km length has an attenuation coefﬁcient of 0.6 dB km−1 at 1.3 µm and
0.3 dB km−1 at 1.55 µm. Assuming that 10 mW of optical power is launched into the
ﬁbre at each wavelength, determine the output power at each wavelength.
5.6 Projects
1. Write MATLAB code to analyse the combined effects of material and waveguide dis-
persion.
2. Using our results developed so far, establish methodologies of designing a single-mode
ﬁbre with predeﬁned properties.
3. Based on the literature, analyse polarization-maintaining ﬁbres.
Appendix 5A: Some properties of Bessel functions
Here, we will provide several properties of Bessel functions needed in the main text. For
more information on Bessel functions consult books by Arfken [7] and Okoshi [8]. Some
general formulas are
Jm+1(u) + Jm−1(u) = 2m
u Jm(u)
(5.79)
Km+1(w) + Km−1(w) = 2m
u Km(w)
(5.80)
2J ′
m = Jm−1 −Jm+1
(5.81)
−2K′
m = Km−1 + Km+1
(5.82)
also
J−m = (−1)mJm,
K−m = Km
(5.83)
Start with (5.81) and replace Jm+1 using (5.79). One ﬁnds
J′
m(u)
uJm(u) = Jm−1(u)
uJm(u) −m
u2
(5.84)
Similarly, replacing Jm−1 in Eq. (5.79) one ﬁnds
J′
m(u)
uJm(u) = m
u2 −Jm+1(u)
uJm(u)
(5.85)
Similar expressions can be derived for functions Km. Using (5.82) and eliminating Km+1,
one has
K′
m(u)
wKm(u) = −Km−1(u)
wKm(u) −m
w2
(5.86)
Finally, eliminating Km−1 in (5.82) one has
K′
m(u)
wKm(u) = −Km+1(u)
wKm(u) + m
w2
(5.87)

130
Linear optical fibre and signal degradation
Appendix 5B: Characteristic determinant
In this appendix we provide details of the evaluation of characteristic determinant. The
determinant which describes guided modes has been obtained before and it is given by
Eq. (5.47):

Jm (κa)
0
−Km (γ a)
0
βm
κ2aJm (κa)
iωμ
κ J′
m (κa)
βm
κ2aKm (γ a)
iωμ
γ K′
m (γ a)
0
Jm (κa)
0
−Km (γ a)
−iωε1
κ J′
m (κa)
βm
aκ2 Jm (κa)
−iωε2
γ K′
m (γ a)
βm
aγ 2 Km (γ a)

= 0
We will now evaluate it following the method of Cherin [15]. Introduce notation
A = Jm(κa),
B = βm
κ2a,
C = iω
κ J ′
m (κa)
D = Km(γ a),
E = βm
aγ 2 ,
F = iω
γ K′
m (γ a)
The determinant can be written as

A
0
−D
0
0
A
0
−D
AB
μC
DE
μF
−ε1C
AB
−ε2F
DE

= 0
Expand the determinant. In the ﬁrst step we have
A

A
0
−D
μC
DE
μF
AB
−ε2F
DE

−D

0
A
−D
AB
μC
μF
−ε1C
AB
DE

= 0
and in the second step
A2

DE
μF
−ε2F
DE
 −AD

μC
DE
AB
−ε2F
 + AD

AB
μF
−ε1C
DE
 + D2

AB
μC
−ε1C
AB
 = 0
Evaluating the above, one has
A2 
D2E2 + με2F 2
−AD (−με2CF −ABED) + AD (ABDE + με1CF)
+ D2 
A2B2 + με1C2
= 0
Rearranging terms
με2

A2F2 + ADCF

+ με1CD (AF + CD) + 2A2D2BE + A2D2 
E2 + B2
= 0
and ﬁnally
F
D + C
A
 
με2
F
D + με1
C
A

+ (E + B)2 = 0

131
Appendix 5C
Table 5.2 List of MATLAB functions for Chapter 5.
Listing
Function name
Description
5C.1.1
bessel J.m
Plots Bessel function Jm
5C.1.2
bessel Y.m
Plots Bessel function Ym
5C.1.3
bessel K.m
Plots Bessel function Km
5C.1.4
bessel I.m
Plots Bessel function Im
5C.2.1
HE11.m
Driver function for universal relations
5C.2.2
f unc HE11.m
Function used by driverHE11
5C.3
sellmeier.m
Plots refractive index using Sellmeier equation
5C.4
disp mat.m
Determines and plots material dispersion
Substitute original deﬁnitions and extracting common factors
 J′
m(κa)
κJm (κa) + K′
m (γ a)
γ Km (γ a)
 !
k2
0n2
1J′
m (κa)
κJm (κa)
+ k2
0n2
2K′
m (γ a)
γ Km (γ a)
"
= β2m2
a2
 1
κ2 + 1
γ 2

(5.88)
Appendix 5C: MATLAB listings
In Table 5.2 we provide a list of MATLAB ﬁles created for Chapter 5 and a short description
of each function.
Listing 5C.1.1
Program bessel J.m. Plots Bessel function Jm.
% File name: bessel_J.m
% Plot of Bessel functions of the first kind J_m(z)
clear all
N_max = 101;
% number of points for plot
z = linspace(0,10,N_max);
% creation of z arguments
%
hold on
for m = [0 1 2]
% m - order of Bessel function
J = BESSELJ(m,z);
h = plot(z,J);
% Redefine figure properties
xlabel(’z’,’FontSize’,22);
ylabel(’J_m(z)’,’FontSize’,22);
text(1.1, 0.85, ’m = 0’,’Fontsize’,18);
text(1.8, 0.65, ’m = 1’,’Fontsize’,18);
text(3, 0.55,
’m = 2’,’Fontsize’,18);

132
Linear optical fibre and signal degradation
grid on
box on
%
set(h,’LineWidth’,1.5);
% new thickness of plotting lines
set(gca,’FontSize’,22);
% new size of tick marks on both axes
end
pause
close all
Listing 5C.1.2
Program bessel Y.m. Plots Bessel function Ym.
% File name: bessel_Y.m
% Plot of Bessel functions of the second kind Y_m(z)
clear all
N_max = 101;
% number of points for plot
z = linspace(0.01,10,N_max);
% creation of z arguments
%
hold on
for m = [0 1 2]
% m - order of Bessel function
Y = BESSELY(m,z);
h = plot(z,Y);
% Redefine figure properties
xlabel(’z’,’FontSize’,22);
ylabel(’Y_m(z)’,’FontSize’,22);
text(2.0, 0.7, ’m = 0’,’Fontsize’,18);
text(3.5, 0.7, ’m = 1’,’Fontsize’,18);
text(5.0, 0.7, ’m = 2’,’Fontsize’,18);
axis([0 10 -5 1.5]);
grid on
box on
%
set(h,’LineWidth’,1.5);
% new thickness of plotting lines
set(gca,’FontSize’,22);
% new size of tick marks on both axes
end
pause
close all
Listing 5C.1.3
Program bessel K.m. Plots Bessel function Km.
% File name: bessel_K.m
% Plot of modified Bessel functions of the second kind K_m(z)
clear all
N_max = 101;
% number of points for plot
z = linspace(0.01,3,N_max);
% creation of z arguments

133
Appendix 5C
%
hold on
for m = [0 1 2]
% m - order of Bessel function
K = BESSELK(m,z);
h = plot(z,K);
% Redefine figure properties
xlabel(’z’,’FontSize’,22);
ylabel(’K_m(z)’,’FontSize’,22);
text(0.2, 0.8, ’m = 0’,’Fontsize’,18);
text(1.0, 0.8, ’m = 1’,’Fontsize’,18);
text(1.5, 0.8, ’m = 2’,’Fontsize’,18);
axis([0 3 0 5]);
grid on
box on
%
set(h,’LineWidth’,1.5);
% new thickness of plotting lines
set(gca,’FontSize’,22);
% new size of tick marks on both axes
end
pause
close all
Listing 5C.1.4
Program bessel I.m. Plots Bessel function Im.
% File name: bessel_I.m
% Plot of modified Bessel functions of the first kind I_m(z)
clear all
N_max = 101;
% number of points for plot
z = linspace(0,3,N_max);
% creation of z arguments
%
hold on
for m = [0 1 2]
% m - order of Bessel function
Y = BESSELI(m,z);
h = plot(z,Y);
% Redefine figure properties
xlabel(’z’,’FontSize’,22);
ylabel(’I_m(z)’,’FontSize’,22);
text(1.1, 1.7,
’m = 0’,’Fontsize’,18);
text(1.75, 1.7, ’m = 1’,’Fontsize’,18);
text(2.4, 1.7,
’m = 2’,’Fontsize’,18);
grid on
box on
%
set(h,’LineWidth’,1.5);
% new thickness of plotting lines
set(gca,’FontSize’,22);
% new size of tick marks on both axes

134
Linear optical fibre and signal degradation
end
pause
close all
Listing 5C.2.1
Program HE11.m. MATLAB code for ﬁnding a universal relation. The
program determines and plots the following relations: b = b(V ), d(bV )
dV ,V d2(bV )
dV 2 .
% File name: HE11.m
% Function determines and plots universal relation for mode HE_11
clear all
format long
% It works in the range of V = [0.50 2.4]
N_max = 190;
for n = 1:N_max
VV(n) = 0.50 + n*0.01;
V = VV(n);
b_c(n) = fzero(@(b) func_HE11(b,V),[0.0000001 0.8]);
end
%
hold on
h1 = plot(VV,b_c);
% plots b =b(V)
%
temp1 = VV.*b_c;
dy1 = diff(temp1)./diff(VV);
Vnew1 = VV(1:length(VV)-1);
h2 = plot(Vnew1,dy1);
% plots first derivative
%
temp2 = dy1;
dy2 = diff(temp2)./diff(Vnew1);
Vnew2 = Vnew1(1:length(Vnew1)-1);
h3 = plot(Vnew2,Vnew2.*dy2);
% plots second derivative
%
text(2.3, 0.6, ’b’,’Fontsize’,16);
text(1.8, 1.2, ’{d(bV)}/{dV}’,’Fontsize’,16);
text(0.25, 1.3, ’V{d^{2}(bV)}/{dV^{2}}’,’Fontsize’,16);
axis([0 2.5 0 1.5]);
% Redefine figure properties
xlabel(’V’,’FontSize’,22);
grid on
box on
set(h1,’LineWidth’,1.5);
% new thickness of plotting lines
set(h2,’LineWidth’,1.5);
set(h3,’LineWidth’,1.5);
set(gca,’FontSize’,22);
% new size of tick marks on both axes

135
Appendix 5C
pause
close all
Listing 5C.2.2
Program func HE11.m. MATLAB function for ﬁnding a universal rela-
tion.
function result = func_HE11(b,V)
% Function name: func_HE11.m
% Function which defines basic relation
u= V*sqrt(1-b);
J1 = BESSELJ(1,u);
J0 = BESSELJ(0,u);
%
w = V*sqrt(b);
K1 = BESSELK(1,w);
K0 = BESSELK(0,w);
lhs = J1./J0;
rhs = (w./u).*(K1./K0);
result = lhs - rhs;
Listing 5C.3
Program sellmeier.m. Plots refractive index for SiO2 using the Sellmeier
equation.
% File name: sellmeier.m
% Plot of refractive index based on Sellmeier equation
% for Si O_2
clear all
N_max = 101;
% number of points for plot
lambda = linspace(0.5,1.8,N_max);
% creation of lambda arguments
% between 0.5 and 1.8 microns
%
% Data for SiO_2
G_1 = 0.696749; G_2 = 0.408218; G_3 = 0.890815;
lambda_1=0.0690606; lambda_2=0.115662; lambda_3=9.900559; % in microns
%
term1 = (G_1*lambda.^2)./(lambda.^2 - lambda_1^2);
term2 = (G_2*lambda.^2)./(lambda.^2 - lambda_2^2);
term3 = (G_3*lambda.^2)./(lambda.^2 - lambda_3^2);
ref_index_sq = 1.0 + term1 + term2 + term3;
ref_index = sqrt(ref_index_sq);
%
h = plot(lambda,ref_index,’LineWidth’,1.5);
% Redefine figure properties

136
Linear optical fibre and signal degradation
xlabel(’wavelength (\mum)’,’FontSize’,14);
ylabel(’refractive index’,’FontSize’,14);
set(gca,’FontSize’,14);
% size of tick marks on both axes
pause
close all
Listing 5C.4
Program disp mat.m. Determines coefﬁcient Dmat material dispersion.
Refractive index is determined using the Sellmeier equation.
% File name: disp_mat.m
% Plots D_mat
% Material dispersion is determined using Sellmeier equation
% describing refractive index for pure and doped silica
% Data from Kasap2001, p.45 for SiO_2 - GeO_2
clear all
c_light = 3d5;
% velocity of light, km/s
disp_min = -20; disp_max =20;
N_max = 101;
% number of points for plot
lambda_min = 1.200; lambda_max = 1.600;
% in microns
% creation of lambda arguments between 1.2 and 1.6 microns
lambda = linspace(lambda_min,lambda_max,N_max);
G_1 = 0.711040; G_2 = 0.451885; G_3 = 0.704048;
lambda_1 = 0.0642700; lambda_2 = 0.129408; lambda_3 = 9.425478;
%
term1 = (G_1*lambda.^2)./(lambda.^2 - lambda_1^2);
term2 = (G_2*lambda.^2)./(lambda.^2 - lambda_2^2);
term3 = (G_3*lambda.^2)./(lambda.^2 - lambda_3^2);
%
ref_index_sq = 1.0 + term1 + term2 + term3;
ref_index = sqrt(ref_index_sq);
%
%---------- Determination of material dispersion D_mat -------------
ttt1 = ref_index;
dy1_lam = diff(ttt1)./diff(lambda);
% first derivative
lambda1 = lambda(1:length(lambda)-1);
ttt2 = dy1_lam;
dy2_lam = diff(ttt2)./diff(lambda1);
lambda2 = lambda1(1:length(lambda1)-1);
D_mat = (-lambda2.*dy2_lam/c_light)*1d9;
plot(lambda2,D_mat,’LineWidth’,1.5);
xlabel(’wavelength (\mum)’,’FontSize’,14);
ylabel(’Material dispersion (ps/km nm)’,’FontSize’,14);
set(gca,’FontSize’,14);
% size of tick marks on both axes
axis([lambda_min, lambda_max, disp_min, disp_max])

137
References
grid on
pause
close all
References
[1] G. Keiser. Optical Fiber Communications. Third Edition. McGraw-Hill, Boston, 2000.
[2] F. L. Pedrotti and L. S. Pedrotti. Introduction to Optics. Third Edition. Prentice Hall,
Upper Saddle River, NJ, 2007.
[3] T. Miya, Y. Terunuma, T. Hosaka, and T. Miyashita. Ultimate low-loss single-mode
ﬁbre at 1.55 µm. Electronics Letters, 15:106–8, 1979.
[4] J. A. Buck. Fundamentals of Optical Fibers. Second Edition. Wiley-Interscience,
Hoboken, NJ, 2004.
[5] J. C. Palais. Fiber Optic Communications. Fifth Edition. Prentice Hall, Upper Saddle
River, NJ, 2005.
[6] D. K. Cheng. Fundamentals of EngineeringElectromagnetics. Addison-Wesley, Read-
ing, MA, 1993.
[7] G. Arfken. Mathematical Methods for Physicists. Academic Press, Orlando, FL, 1985.
[8] T. Okoshi. Optical Fibers. Academic Press, New York, 1982.
[9] W. van Etten and J. van der Plaats. Fundamentals of Optical Fiber Communications.
Prentice Hall, New York, 1991.
[10] C. R. Pollock and M. Lipson. Integrated Photonics. Kluwer Academic Publishers,
Boston, 2003.
[11] A. W. Snyder and J. D. Love. Optical Waveguide Theory. Kluwer Academic Publishers,
1983.
[12] D. Marcuse. Theory of Dielectric Optical Waveguides. Second Edition. Academic
Press, New York, 1991.
[13] D. Gloge. Weakly guiding ﬁbers. Appl. Opt., 10:2252–8, 1971.
[14] G. Ghatak and K. Thyagarajan. Introduction to Fiber Optics. Cambridge University
Press, Cambridge, 1998.
[15] A. H. Cherin. An Introduction to Optical Fibers. McGraw-Hill, New York, 1983.

6
Propagation of linear pulses
In this chapter we outline basic issues associated with the description of linear pulses.
Basic principles of two fundamental modulation formats, namely return-to-zero (RZ) and
non-return-to-zero (NRZ) modulations, will also be explained.
Formats of data transmission are one of the critical factors in optical communication
systems. We therefore have implemented several waveforms corresponding to basic mod-
ulation formats and various proﬁles of individual bits. Later on, some of this information
will be used to analyse performance of communication systems. We start with a summary
of the basic pulses.
6.1 Basic pulses
In this section we will review properties of the basic pulses. Basic approximations and
properties will be described. We start with rectangular pulses.
6.1.1 Rectangular pulses
The simplest pulse, namely the rectangular one, is shown in Fig. 6.1. It is described as
srect(t) =
s0,
0 < t < T
0,
otherwise

(6.1)
where T is the pulse duration and s0 its magnitude. It can be represented as a Fourier series
srect(t) =
∞

n=1
sn sin
(nπ
T t
)
(6.2)
where
sn =
0,
n even
4s0
πn ,
n odd
(6.3)
In Fig. 6.1 we plotted three possible approximations to a rectangular pulse for n = 1,
n = 3, n = 5 corresponding to different number of terms in Eq. (6.2). One can observe that
with the increasing number of terms in Fourier expansion more accurate approximation
to a rectangular pulse is possible. MATLAB code used to create Fig. 6.1 is shown in the
Appendix, Listing 6A.1.
138

139
Basic pulses
0
2
4
6
8
10
12
−0.5
0
0.5
1
1.5
time (a.u.)
s (a.u.)
n = 1
n = 3
n = 5
Fig. 6.1
Rectangular pulse of height 1 (a.u.) approximated by varying number of terms in Fourier series expansion.
In practice, one often considers a symmetrical rectangular pulse shown in Fig. 6.3. It is
deﬁned as
srect,symm(t) =
1,
|t| < τ
0,
|t| > τ
(6.4)
Its Fourier transform can be evaluated analytically as follows:
Srect,symm(ω) =
 +∞
−∞
x(t) e−iωt dt =
 +τ
−τ
e−iωt dt =
1
−iωe−iωt

+τ
−τ
=
1
−iω

e−iωτ −eiωτ
= 2 sin ωτ
ω
(6.5)
where we have used Euler identity. A plot of Eq. (6.5) is shown in Fig. 6.2.
To sum up the discussion of rectangular pulses, we have evaluated Fourier transform of
a rectangular pulse using MATLAB built-in functions. A plot of a symmetric rectangular
pulse and its MATLAB generated absolute value of Fourier transform are shown in Fig. 6.3.
Plots were created by MATLAB code shown in Appendix, Listing 6A.2.
6.1.2 Gaussian pulses
A Gaussian pulse is considered an accurate model of the data waveforms generated in
practical optical communication systems. The Gaussian proﬁle is described as
sG(t) =
A
σ
√
2π
e−1
2 ( t
σ )
2
(6.6)
The pulse has an area A = P0τ0, where τ = σ
√
2π and P0 is its maximum value (at t = 0).
Its spectral function SG(ω) is obtained by Fourier transform and it is also a Gaussian

140
Propagation of linear pulses
−2
−1
0
1
2
−4
−2
0
2
4
6
8
10
frequency (a.u.)
Fourier transform (S) (a.u.)
A
B
Fig. 6.2
Fourier transform of rectangular pulse of duration τ and area A. Point A corresponds to the frequency ν = 2/τ and
point B to frequency ν = 3/τ.
−20
−10
0
10
20
0
0.5
1
1.5
2
time (a.u.)
sr (a.u.)
−40
−20
0
20
40
−0.5
0
0.5
1
1.5
2
2.5
3 × 104
Fourier transform of rectangular pulse (a.u.)
Fig. 6.3
Rectangular pulse (left) and the absolute value of its Fourier transform determined using MATLAB functions.
function, see Fig. 6.4:
SG(ω) = Ae−1
2 (ωσ )2
(6.7)
6.1.3 Super-Gaussian pulse
A super-Gaussian pulse is a generalization of the usual Gaussian and is
sSG(t) =
A
σ
√
2π
e−1
2 ( t
σ )
2m
(6.8)

141
Basic pulses
0
t
sG(t)
P
τ
τ
τ
τ
0
0
0
0
P0
SG(ω)
0
1
0
1
2 (=B  )
0
ω
Fig. 6.4
Schematic illustration of Gaussian pulse in time and its Fourier transform.
0
50
100
150
200
250
300
0
0.002
0.004
0.006
0.008
0.01
0.012
0.014
time
amplitude
Fig. 6.5
Super-Gaussian pulses for several values of m = 1, 2, 3, 4.
The parameter m controls the degree of edge sharpness. For m = 1 one recovers the ordinary
Gaussian pulse. For larger values of m the pulse becomes closer to a rectangular pulse, see
Fig. 6.5. (Figure generated by MATLAB code, in Appendix, Listing 6A.3.)
6.1.4 Chirped Gaussian pulse
Chirp refers to a process which changes the frequency of a pulse with time. Chirp pulses are
most commonly created during direct modulation of a semiconductor laser diode (semicon-
ductor lasers are discussed in Chapter 7). Mathematical expression for a chirped Gaussian
pulse at z = 0 is [1], [2]
s(z = 0,t) = Re
	
exp
!
−1 + iC
2
 t
T0
2"
exp (−iω0t)

= e−1
2
(
t
T0
)2
cos
!
ω0t + 1
2C
 t
T0
2"
(6.9)

142
Propagation of linear pulses
0
10
20
30
40
50
0
0.5
1
Gaussian pulse
time
amplitude
0
10
20
30
40
50
−1
0
1
Chirped Gaussian pulse
time
amplitude
Fig. 6.6
Comparison of Gaussian pulse (upper plot) and chirped Gaussian pulse (lower plot).
where T0 determines the width of the pulse, C is the chirp factor which determines the
degree of chirp of the pulse and ω0 is the carrier frequency of the pulse. s(0,t) is the
dimensionless function describing pulse.
Phase of such pulses is
φ(ω) = ω0t + 1
2C
 t
T0
2
(6.10)
Change in frequency δω(t) is therefore
δω(t) = −∂φ(ω)
∂t
= ω0 + C t
T 2
0
(6.11)
Fourier spectrum of a chirped pulse is broader compared to unchirped one. Evaluation of
the Fourier transform of (6.9) gives
s(0, ω) =
 2πT 2
0
1 + iC
1/2
exp

−
ω2T 2
0
2 (1 + iC)

(6.12)
The spectral half-width is deﬁned as
|s(0, ωe)|2
|s(0, 0)|2 = e−1
(6.13)
For a symmetric pulse centered at t = 0, one has ω = ωe. Detailed calculations for
spectral half-width (point where the intensity drops 1/e) give [3] (see Problem 2)
ω =

1 + C2
T −1
0
(6.14)
Chirped Gaussian pulse is plotted in Fig. 6.6 (lower plot). For comparison, regular
Gaussian pulse for the same parameters is also shown (upper plot). The plots were obtained
using MATLAB code provided in Appendix, Listing 6A.4.

143
Modulation of a semiconductor laser
DC current (mA)
Light output (mW/facet)
0
50
100
150
200
0
5
10
10  C
ο
50  C
ο
90  C
ο
Fig. 6.7
Schematic illustration of light-current laser characteristics at various temperatures.
6.2 Modulation of a semiconductor laser
In practical applications optical pulses are created by semiconductor laser. Typical light-
current (L-I) characteristics of the semiconductor laser are shown in Fig. 6.7. We show here
an output of power-current characteristics (L-I) for several temperatures. One can observe
a ﬂat region to the left until the so-called threshold and then sudden increase in power.
Threshold current Ith is the forward injection current at which optical gain in the laser
cavity is equal to losses. Above the threshold, stimulated emission is the dominant process
in converting current to light; below the threshold is the light emission which is caused
by spontaneous processes with characteristics (speed, spectrum and efﬁciency) similar to
those from light emitting diodes (LEDs).
In Fig. 6.8 we illustrate principles of direct modulation of a semiconductor laser. It is a
simple and inexpensive process since no other components are required. The disadvantage
of direct modulation is that the resulting pulses are considerably chirped.
6.2.1 Modulation formats
Various modulation formats are often discussed in literature. For detailed analysis consult
books by Keiser [4], Liu [5], Binh [6], Ramaswami or Sivarajan [7]. Here, we discuss brieﬂy
two important cases only as illustrated in Figs. 6.9 and 6.10.
At a digital format light pulse intensity (say) larger than zero, represents logical ONE and
its absence, logical ZERO. In the return-to-zero (RZ) format, signal drops to zero between
the pulses, see Fig. 6.10. Each bit has allocated time T. In RZ, pulses occupy half of the
time slot reserved for each bit, see Fig. 6.10. Also, power spectrum is shown. Since most of
the signal power is at the lower frequency, the RZ signal is transmitted by a system having
a bandwidth of 2
T Hz.
In the non-return-to-zero (NRZ) format, the pulses occupy entire time slot reserved for
each bit. NRZ pulses are twice as long as the RZ pulses. In NRZ modulation format the

144
Propagation of linear pulses
0
Light output
ON
OFF
Time
Bias
Drive
Fig. 6.8
Illustration of the principle of modulation in a semiconductor laser.
time
time
RZ
NRZ
T
0
1
    0
1
0
Fig. 6.9
Comparison of RZ and NRZ modulation formats. Digital bit stream is: 01010.
intensity of light remains at its high value whenever a number of consecutive ONEs are
transmitted. The bandwidth is 1/T, only half of that required for RZ system.
For encoding, practical current pulse driving the semiconductor laser is assumed to be
of the form [8]
I(t) =
⎧
⎪⎨
⎪⎩
0
t < 0
Im [1 −exp (−t/tr)]
0 ≤t ≤T ′
Im exp (−(t −T )/tr)
T ′ < t
(6.15)
where Im is the peak modulation, tr determines the pulse rise time, and T ′ = T for NRZ
encoding and T ′ = T/2 for RZ coding. The bias current Ibias is typically 1.1 times the laser
threshold current.

145
Modulation of a semiconductor laser
f
T
1/T
2/T
RZ
f
T
1/T
2/T
NRZ
Fig. 6.10
Comparison of modulation formats (RZ and NRZ) (schematically) and their corresponding bandwidths.
0
1
2
3
4
5
6
× 10−9
0
0.5
1
time
Individual pulses
0
1
2
3
4
5
6
× 10−9
0
1
2
time
Total signal
Fig. 6.11
Train of Gaussian pulses for logical combination of bits 010110. Individual pulses are shown (top) and also complete
signal (bottom).
6.2.2 Creation of waveforms
In practice, to evaluate photonic systems for some modulation formats one needs to generate
waveforms consisting of pulses of various shapes.
The generated sequence of Gaussian pulses (waveform) for some particular logical com-
bination is illustrated in Fig. 6.11. MATLAB code is provided in Appendix, Listings 6A.5
and 6A.5.1.

146
Propagation of linear pulses
0
2
4
6
8
× 10−9
2
2.5
3
3.5
4
4.5
5
5.5
time [s]
Current [mA]
Fig. 6.12
Eight-bit pattern generated in NRZ format.
Another wavefront which is used to represent driving current of semiconductor lasers in
NRZ (non-return-to-zero) format can be expressed as [9]
Jmod (t) =
⎧
⎪⎪⎨
⎪⎪⎩
Ibias + Im

1 −e−2.2t/τr
current bit 1, previous 0
Ibias + Ime−2.2t/τr
current bit 0, previous 1
Ibias
current bit 0, previous 0
Ibias + Im
current bit 1, previous 1
(6.16)
Implementation of the above modulation format is shown in Appendix, Listing 6A.6 and a
typical result in Fig. 6.12.
6.3 Simple derivation of the pulse propagation equation in the
presence of dispersion
Assume the existence of a propagating electric ﬁeld E(r,t) at point r and time t. It can be
Fourier decomposed as
E(r,t) = 1
2π
 ∞
−∞
E(r, ω) e−jωt dω
(6.17)
Therefore electric ﬁeld can be interpreted as an inﬁnite sum of monochromatic waves, each
having an angular frequency ω. The inverse Fourier transform is
E(r, ω) =
 ∞
−∞
E(r,t) e jωt dt
(6.18)

147
Simple derivation of the pulse propagation equation in the presence of dispersion
We further assume that Fourier component E(r, ω) can be expressed as
E(r, ω) = x B(0, ω) F(x, y) ejβz
(6.19)
where unit vector x represents the state of polarization of propagating ﬁeld, B(0, ω) is the
initial amplitude of the ﬁeld propagating along z-direction, F(x, y) describes the transverse
distribution of the ﬁeld and β is the propagation constant. We made a similar assumption
earlier when we discussed propagation of the EM ﬁeld in planar waveguides.
For the ﬁeld propagating in an optical ﬁbre, the transverse distribution F(x, y) is often
assumed to be Gaussian, namely
F(x, y) = exp

−π x2 + y2
Ae f f

(6.20)
where Ae f f is the effective area of the ﬁbre.
The effect of dispersion results in the frequency dependence of the propagation constant
β; i.e. β = β(ω). As a result, each frequency component in Eq. (6.17) will propagate with
a different propagation constant.
To derive propagation equation for each frequency component, write Eq. (6.19) as
E(r, ω) = E(x, y, z = 0, ω) ejβz
(6.21)
From above, by direct differentiation with respect to z, one ﬁnds
∂E(r, ω)
∂z
= jβ(ω)E(r, ω)
(6.22)
The above equation describes propagation of EM ﬁeld with the dispersion induced, broad-
ening included. More rigorous derivation of the above equation, starting from Maxwell’s
equations, will be performed in the next section.
Propagation constant β(ω) in terms of the frequency dependent mode index n(ω) is [3]
β(ω) = n(ω)ω
c
(6.23)
It is customary to expand β(ω) around the centre frequency of the pulse ω0 in a Taylor
series
β(ω) = β0 + β1 (ω −ω0) + 1
2β2 (ω −ω0)2 + 1
6β3 (ω −ω0)3
(6.24)
where βi = ∂iβ
∂ωi

ω=ω0. Expansion up to the third order is sufﬁcient to describe typical effects
existing in optical ﬁbre. More practical expressions for expansion coefﬁcients are [3]
β1 = 1
c

n(ω) + ωdn(ω)
dω

= ng
c = 1
vg
(6.25)
where ng is the group index and vg group velocity. For coefﬁcient β2 one ﬁnds
β2 =∂2β(ω)
∂ω2
= ∂β1
∂ω = 1
c

2dn(ω)
dω
+ ωd2n(ω)
dω2

(6.26)

148
Propagation of linear pulses
Coefﬁcient β2 is related to dispersion parameter D as
D = 1
L
dτ
dλ = −2πc
λ2 β2
(6.27)
Here τ is the group delay through a ﬁbre of length L, and λ is the wavelength. Units of
parameter D are [
ps
nm·km].
To account for parameter β3 in practice, the so-called dispersion slope S is introduced:
S = dD
dλ
(6.28)
Parameter S describe the variation of D with the wavelength. Units of it are [
ps
nm2·km].
6.4 Mathematical theory of linear pulses
Here, we will outline a full derivation of the equation describing linear pulses based on
Maxwell equations. This more formal derivation illustrates needed approximations.
Maxwell’s equations were introduced in Chapter 3; for optical ﬁbre where there is no
ﬂow of current and no free charges these are
∇× E = −∂B
∂t ,
∇× H = ∂D
∂t
(6.29)
and
∇· D = 0,
∇· B = 0
(6.30)
Constitutive relations are expressed as
D = ε0E + P,
B = μ0H + M
(6.31)
Here P is polarization which is divided into linear and nonlinear parts:
P(r,t) = PL(r,t) + PNL(r,t)
(6.32)
For a nonmagnetic medium such as ﬁbre, the magnetization M = 0. In this chapter we
discuss only linear effects.
Linear polarization is related to electric ﬁeld as
PL(r,t) = ε0
 ∞
−∞
χ (1)(t −t′) E(r,t′) dt′
(6.33)
Fourier transform and its inverse are introduced as
E(r, ω) =
 ∞
−∞
E(r,t) eiωtdt
(6.34)
E(r,t) = 1
2π
 ∞
−∞
E(r, ω) eiωt dω
(6.35)

149
Mathematical theory of linear pulses
Fourier transformation of linear polarization, Eq. (6.33) gives
PL(r, ω) =
 ∞
−∞
PL(r,t) eiωtdt
= ε0
 ∞
−∞
 ∞
−∞
χ (1)(t −t′) E(r,t′) eiωt dt′dt
= ε0
 ∞
−∞
 ∞
−∞
χ (1)(t′′) E(r,t′) eiωt′′eiωt′dt′dt′′
= ε0
 ∞
−∞
dt′E(r,t′) eiωt′  ∞
−∞
dt′′χ (1)(t′′) eiωt′′
= ε0 χ (1)(ω) E(r, ω)
(6.36)
where we have made change of variables t −t′ = t′′. χ (1)(ω) is the Fourier transform of
the susceptibility χ (1)(t)
χ (1)(ω) =
 ∞
−∞
dtχ (1)(t) eiωt
(6.37)
To derive wave equation take ∇× . . . operation of the ﬁrst Maxwell’s equation and use the
second Maxwell’s equation and constitutive relations. In a few steps, one obtains
∇× ∇× E(r,t) = −∂
∂t ∇× B(r,t)
= −∂
∂t μ0∇× H(r,t)
= −μ0
∂2D(r,t)
∂t2
= −μ0ε0
∂2E(r,t)
∂t2
−μ0
∂2P(r,t)
∂t2
In the linear regime
∇× ∇× E(r,t) = −μ0ε0
∂2E(r,t)
∂t2
−μ0
∂2PL(r,t)
∂t2
Using mathematical identity
∇× ∇× E = ∇(∇· E) −∇2E
and third Maxwell’s equation (∇· D = ε∇· E = 0), one ﬁnally obtains
∇2E(r,t) + 1
c2
∂2E(r,t)
∂t2
+ μ0
∂2PL(r,t)
∂t2
= 0
(6.38)
The above is a linear equation in ﬁeld E(r,t). Taking Fourier transform gives
∇2E(r, ω) + ω2
c2 E(r, ω) + μ0ω2PL(r, ω) = 0
(6.39)
Finally, substituting the result in (6.36) for linear polarization gives the wave equation in
the frequency domain
∇2E(r, ω) + ε(ω)ω2
c2 E(r, ω) = 0
(6.40)
The above three-dimensional wave equation will be developed in one dimension next.

150
Propagation of linear pulses
6.4.1 One-dimensional approach
A one-dimensional wave equation (in time domain) for a linear medium with zero dispersion
is
∂2E(z,t)
∂z2
−μ0ε0n2
0
∂2E(z,t)
∂t2
= 0
(6.41)
where n0 is refractive index which in the absence of dispersion is frequency independent.
It is related to propagation constant β0 as
β0 = n0k0
(6.42)
The wave equation describes pulses with central frequency ω0. The following relation holds:
k0 = ω0
√μ0ε0
(6.43)
Solution of the wave equation which describes linear pulse is
E(z,t) = A(z,t) ei(ω0t−β0z)
(6.44)
where A(z,t) is the pulse envelope. In the following we will work within slowly varying
envelope approximation (SVEA), which is based on the following approximations:

∂2A(z,t)
∂z2
 ≪
β0
∂A(z,t)
∂z

and

∂2A(z,t)
∂t2
 ≪
ω0
∂A(z,t)
∂t

One needs to evaluate derivatives appearing in Eq. (6.41) using solution given by Eq. (6.44)
and then apply SVEA. The resulting linear wave equation describes pulses propagating
without dispersion and it is
∂A(z,t)
∂z
+ β0
ω0
∂A(z,t)
∂t
= 0
(6.45)
In the presence of dispersion it is convenient to represent pulse in terms of Fourier compo-
nents. Each such component travels with different velocity.
Taking Fourier transformation of the original pulse described by Eq. (6.44) gives
E(z,t) = 1
2π
 ∞
−∞
E(z, ω) eiωtdω
(6.46)
E(z, ω) describes propagation of spectral component with angular frequency ω inside the
ﬁbre as follows [1]:
E(z, ω) = E(0, ω) e−iβz
(6.47)
Combining Eqs. (6.44), (6.34) and (6.47) gives
A(z,t) ei(ω0t−β0z) = 1
2π
 ∞
−∞
E(0, ω) e−iβz eiωtdω

151
Mathematical theory of linear pulses
From the above, the expression for pulse envelope A(z,t) is
A(z,t) = 1
2π
 ∞
−∞
E(0, ω) ei(ω−ω0)t e−i(β−β0) zdω
(6.48)
Next, let us introduce ω = ω −ω0 and assume ω ≪ω0.
Pulse broadening results from frequency dependence of the propagation constant β; i.e.
β = β(ω). Because of ω ≪ω0, it is customary to expand β around frequency ω0 as
follows [the same equation as (6.24)]:
β(ω) = β0 + β1ω + 1
2β2(ω)2 + 1
6β3(ω)3 + . . .
(6.49)
where higher order terms are neglected. The following notation has been introduced:
β0 = β(ω0), β1 =
dβ
dω

ω=ω0 , β2 =
d2β
dω2

ω=ω0 , β3 =
d3β
dω3

ω=ω0. Substituting the above
expansion into Eq. (6.48) gives
A(z,t) = 1
2π
 ∞
−∞
1E(0, ω) eiωt e−iωβ1ze−i(ω)2 1
2 β2ze−i(ω)3 1
6 β3zdω
The above expression will be used to evaluate derivatives ∂A(z,t)
∂z
and ∂A(z,t)
∂t
. One ﬁnds
∂A(z,t)
∂t
= 1
2π
 ∞
−∞
1E(0, ω) iω eiωt e−iωβ1ze−i(ω)2 1
2 β2ze−i(ω)3 1
6 β3zdω
(6.50)
and
∂A(z,t)
∂z
=
1
2π
 ∞
−∞
1E(0, ω)(−iωβ1) eiωt e−iωβ1ze−i(ω)2 1
2 β2ze−i(ω)3 1
6 β3zdω
+ 1
2π
 ∞
−∞
1E(0, ω)

−i1
2(ω)2β2

eiωt e−iωβ1ze−i(ω)2 1
2 β2ze−i(ω)3 1
6 β3zdω
+ 1
2π
 ∞
−∞
1E(0, ω)

−i1
6(ω)3β3

× eiωt e−iωβ1ze−i(ω)2 1
2 β2ze−i(ω)3 1
6 β3zdω
(6.51)
Terms on the right hand side of the above equation can be expressed in terms of the time
derivatives as follows:
1
2π
 ∞
−∞
1E(0, ω)(−iωβ1) eiωt e−iωβ1ze−i(ω)2 1
2 β2ze−i(ω)3 1
6 β3zdω = −β1
∂A(z,t)
∂t
1
2π
 ∞
−∞
1E(0, ω)

−i1
2(ω)2β2

eiωt e−iωβ1ze−i(ω)2 1
2 β2ze−i(ω)3 1
6 β3zdω
= i1
2β2
∂2A(z,t)
∂t2
1
2π
 ∞
−∞
1E(0, ω)

−i1
6(ω)3β3

eiωt e−iωβ1ze−i(ω)2 1
2 β2ze−i(ω)3 1
6 β3zdω
+ 1
6β3
∂3A(z,t)
∂t3

152
Propagation of linear pulses
Using the above replacements in Eq. (6.51) ﬁnally gives
∂A(z,t)
∂z
= −β1
∂A(z,t)
∂t
−i1
2β2
∂2A(z,t)
∂t2
+ 1
6β3
∂3A(z,t)
∂t3
(6.52)
This is the basic equation which describes pulse evolution in the linear regime in the
presence of dispersion. Its generalization to include the nonlinear effect (Kerr effect) which
describes optical solitons will be discussed in Chapter 15.
In the absence of dispersion, i.e. when β2 = β3 = 0, the optical pulse propagates without
changing its shape. In such case pulse envelope changes as A(z,t) = A(0,t −β1z).
The general equation describing pulse propagation can be simpliﬁed by going to a
reference frame moving with the pulse. The transformation to the new coordinates is
t′ = t −β1z) and
z′ = z
(6.53)
In the reference frame moving with the pulse, Eq. (6.52) takes the form
∂A(z′,t′)
∂z′
+ i
2β2
∂2A(z′,t′)
∂t′2
−1
6β3
∂3A(z′,t′)
∂t′3
(6.54)
The above equation found many applications which have been discussed extensively, see
[3], [1], [9].
6.5 Propagation of pulses
6.5.1 Analytical description of the propagation of a chirp Gaussian pulse
Pulse behaviour is described by the Eq. (6.54) derived previously. For β3 = 0 the equation
is
∂A
∂z′ + i
2β2
∂2A
∂t′2 = 0
and pulse evolution can be determined analytically. The solution is
A(z,t) = 1
2π
 +∞
−∞
A(0, ω) e
i
2 β2ω2z−iωtdω
(6.55)
In the solution, the initial Gaussian pulse A(0, ω) is given by Eq. (6.12). Substituting
Eq. (6.12) into (6.55) and evaluating the Gaussian integral gives
A(z,t) =
T0

T 2
0 −iβ2z (1 + iC)
1/2 exp

−
(1 + iC)t2
T 2
0 −iβ2z (1 + iC)

(6.56)
The above result deﬁnes new pulse width T1 for a propagating pulse at position z. Its value
is
T1
T0
=
!
1 + Cβ2 z
T 2
0
2
+
β2 z
T 2
0
2"1/2
(6.57)
Evolution of chirped and unchirped pulses is shown in Fig. 6.13. Consult listing 6A.7
for MATLAB code.

153
Propagation of pulses
0
0.5
1
1.5
0
0.5
1
1.5
2
2.5
3
T1/T0
z/LD
C = −1
C = 0
C = 1
C = 2
Fig. 6.13
Evolution of pulse width as a function of normalized distance z/LD for chirped and unchirped pulses. Dispersian
length is defined by Eq. (15.14).
6.5.2 Numerical method using Fourier transform
We ﬁnish this chapter by outlining the numerical method of using Eq. (6.54) to describe
propagation of a Gaussian pulse (and also a super-Gaussian pulse) in the presence of
dispersion. The method consists of the following steps.
1. The single pulse p = exp(−t2/T0) is used with sampling period of T = 0.08s in the
time domain. (If needed it can be plotted using plot(t, p) MATLAB function.)
2. The Fourier transform of this single pulse is found using P = f f tshi f t( f f t(p)) code
where p is in time domain and P is in the frequency domain.
3. The frequency domain pulse is sampled using sampling frequency =1/64. The solution
in frequency domain is found by multiplying Fourier transform of single pulse and transfer
function H(ω) where spectral function is
H(ω) = exp
+(
−α
2 −i
2 · β2 · ω2 −i
6 · β3 · ω3)
· L
,
(6.58)
where α are losses, L is the propagation length and β2 and β3 are previously deﬁned
dispersion parameters.
4. The solution in time domain is obtained by using inverse Fourier transform
i f f t( f f tshi f t(P prop)) and it is plotted. Consult Listings 6A.8 and 6A.8.1 for MAT-
LAB code.
The propagation of Gaussian pulse over a distance of 4000 km is shown in Fig. 6.14 for
the following parameters: α = 0, β2 = 60 ps2/km and β3 = 0.01 ps3/km. MATLAB code
is provided in Appendix, Listings 6A.8.1 and 6A.8.2.

154
Propagation of linear pulses
−4
−2
0
2
4
0
0.2
0.4
0.6
0.8
1
time
Arbitrary units
original pulse
transmited pulse
Fig. 6.14
Dispersion induced broadening of a Gaussian pulse. β2 = 60 ps2/km and β3 = 0.01 ps3/km.
−4
−2
0
2
4
0
0.2
0.4
0.6
0.8
1
1.2
1.4
time
Arbitrary units
original pulse
transmited pulse
Fig. 6.15
Evolution of a super-Gaussian pulse with m = 3. β2 = 0 and β3 = 0.01 ps3/km.
In Fig. 6.15 we show propagation of a super-Gaussian pulse with m = 3 over the same
distance with β2 = 0. The remaining parameters remain unchanged.
6.5.3 Fourier transform split-step method
This method will be extensively discussed in later Chapter 12 describing beam propagation
method (BPM). Here we use it to illustrate propagation of Gaussian pulse. First, we brieﬂy
describe the method.

155
Problems
Table 6.1 Values of parameters.
Name
Symbol
Value
Second-order dispersion
β2
60 ps/nm−1 km−1
Third-order dispersion
β3
0.01 ps/nm−1 km−1
Losses
α
0
Width of Gaussian pulse
w0
20 ps
We use the linear Schroedinger equation derived previously, Eq. (6.54). Taking Fourier
transform results in
∂1A(z, ω)
∂z
= −iβ2
2 (−iω)2 1A(z, ω) + β3
6 (−iω)3 1A(z, ω) −α
2
1A(z, ω)
(6.59)
where α describes losses. Fourier transform is deﬁned in a usual way as
1A(z, ω) =
 +∞
−∞
A(z,t) eiωt dt
Eq. (6.59) can be expressed as
∂1A(z, ω)
∂z
= P · 1A(z, ω)
(6.60)
where the propagator operator P is deﬁned as
P = iβ2
2 ω2 + iβ3
6 ω3 −α
2
(6.61)
Eq. (6.60) can be integrated over small distance h along the z-axis with the result
1A(z + h, ω) = eP·h 1A(z, ω)
(6.62)
The above equation is directly implemented in MATLAB. In Table 6.1 we summarized
values used in simulations.
The results are shown in Figs. 6.16 and 6.17. We show evolution of the Gaussian pulse
and also a three-dimensional view of the evolving pulse. MATLAB code is provided in
Appendix, Listing 6A.9.
6.6 Problems
1.
Evaluate Fourier series for rectangular pulse represented by Eq. (6.1). Determine
coefﬁcients sn.
2.
Evaluate Fourier transform of chirped Gaussian pulse and its spectral half-width ω
as given by Eq. (6.14).

156
Propagation of linear pulses
−50
0
50
0
0.2
0.4
0.6
0.8
1
1.2
1.4
time [ps]
amplitude
Fig. 6.16
Evolution of Gaussian pulse by Fourier transform split-step method.
−50
0
50
0
100
200
0
0.5
1
1.5
time [ps]
distance [km]
Fig. 6.17
Three-dimensional view of the evolution of the Gaussian pulse shown in Fig. 6.16.
Appendix 6A: MATLAB listings
In Table 6.2 we provide a list of MATLAB ﬁles created for Chapter 6 and a short description
of each function.

157
Appendix 6A
Table 6.2 List of MATLAB functions for Chapter 6.
Listing
Function name
Description
6A.1
rp.m
Creates approximations to rectangular pulse
6A.2
FT rp.m
Evaluates FT of rectangular pulse using analytical expression and
also MATLAB functions
6A.3
super gauss.m
Plots super Gaussian pulses
6A.4
gauss chirp.m
Plots chirp Gaussian pulses
6A.5.1
ptrain.m
Generates sequence of Gaussian pulses
6A.5.2
f gauss.m
Function used by ptrain.m
6A.6
bit gen.m
Illustrates NRZ modulation format
6A.7
pulse evol.m
Evolution of pulses (chirped and unchirped)
6A.8.1
pdisp.m
Width of Gaussian pulse with dispersion
6A.8.2
gauss m.m
Function used by pdisp.m. Deﬁnes Gaussian pulses
6A.9
sslg.m
Evolution of Gaussian pulse by Fourier transform split-step method
Listing 6A.1
Function rp.m. Function which draws rectangular pulse and calculates
approximations based on Fourier series for three values of n.
% File name: rp.m (rectangular pulse)
clear all
N_max = 100;
% number of points for plot
% Pulse characteristics
s_0 = 1.0;
% pulse amplitude
t_min = 2;
% start of pulse
t_max = 10.0;
% end of pulse
A = 0.5;
dt = 1/N_max;
t = 0:dt:2*t_max;
x = A*(sign(t-t_min)-sign(t-t_max));
% creates rectangular pulse
hold on
h = plot(t,x);
set(h,’LineWidth’,2);
axis([0 1.2*t_max -0.5 1.7]);
% plots rectangular pulse
%
s = 0.0;
for n = [1 3 5]
s = s + 4*s_0/(pi*n)*sin(n*pi*(t-t_min)./(t_max-t_min));
h = plot(t,s);
set(h,’LineWidth’,2);
end
axis([0 1.2*t_max -0.5 1.7]);
xlabel(’time (a.u.)’,’FontSize’,14);
% size of x label
ylabel(’s (a.u)’,’FontSize’,14);
% size of y label
set(gca,’FontSize’,14);
% size of tick marks on both axes

158
Propagation of linear pulses
% Add description
text(5.5, 1.4, ’n = 1’,’Fontsize’,13)
text(7.0, 1.4, ’n = 3’,’Fontsize’,13)
text(8.5, 1.4, ’n = 5’,’Fontsize’,13)
pause
close all
Listing 6A.2
Function FT rp.m. Function plots rectangular pulse, its Fourier transform
obtained analytically, and also evaluates its Fourier transform using MATLAB built-in
functions.
% File name: FT_rp.m
% Plots symmetric rectangular pulse of duration tau and its
% Fourier transform
clear all
N_max = 1000;
% number of points for plot
% Pulse characteristics
tau = 10.0;
% 1/2 pulse width
A = 0.5;
% pulse height
% Plotting Fourier transform of rectangular pulse using analytical formula
omega = linspace(-20/tau, 20/tau, N_max);
% creation of frequency argument
S = 2*A*sin(tau.*omega)./omega;
h = plot(omega,S);
set(h,’LineWidth’,1.5);
% thickness of plotting lines
grid
xlabel(’frequency (a.u.)’,’FontSize’,14);
ylabel(’Fourier transform (S) (a.u.)’,’FontSize’,14);
set(gca,’FontSize’,14);
% size of tick marks on both axes
text(0.65, 0, ’A’,’Fontsize’,13);
text(1, 0, ’B’,’Fontsize’,13);
pause
close all
%---- Plotting rectangular pulse -----------------------------------------
dt = 1/N_max;
t = -6*tau:dt:6*tau;
% Creation of points for pulse plotting
s = A*(sign(t+tau)-sign(t-tau));
h = plot(t,s);
set(h,’LineWidth’,1.5);
% thickness of plotting lines
axis([-2*tau 2*tau 0 2]);
xlabel(’time (a.u.)’,’FontSize’,14); ylabel(’s_r (a.u.)’,’FontSize’,14);
set(gca,’FontSize’,14);
% size of tick marks on both axes
pause
close all
%----- Plotting its Fourier transform using Matlab functions ----------
y = fft(s);
% discrete Fourier transform
SM = fftshift(y);
% shift zero-frequency component to center of spectrum
N = length(SM);

159
Appendix 6A
k = -(N-1)/2:(N-1)/2;
f = abs(SM);
h = plot(k,f);
set(h,’LineWidth’,1.5);
% thickness of plotting lines
axis([-4*tau 4*tau -5000 30000]);
ylabel(’Abs FT of rectangular pulse (a.u)’,’FontSize’,14);
grid
set(gca,’FontSize’,14);
% size of tick marks on both axes
pause
close all
Listing 6A.3
Function super gauss.m. Plots super-Gaussian pulses for several values of
parameter m.
% File name: super_gauss.m
% Plots super-Gaussian pulses
clear all
A = 1;
sigma = 30;
N = 300.0;
t = linspace(-50,50,N);
hold on
for m = [1 2 3 4]
p = A/(sigma*sqrt(2*pi))*exp(-t.^(2*m)/(sigma^(2*m)));
h = plot(p);
set(h,’LineWidth’,1.5);
% thickness of plotting lines
end
xlabel(’time’,’FontSize’,14); ylabel(’amplitude’,’FontSize’,14);
set(gca,’FontSize’,14);
% size of tick marks on both axes
pause
close all
Listing 6A.4
Function gauss chirp.m. Generates Gaussian and chirp Gaussian pulses.
% File name: gauss_chirp.m
% Creation of Gaussian pulse and also chirped Gaussian pulse
clear all;
%
t_zero = 20.0;
% center of incident pulse
width = 6.0;
% width of the incident pulse
C = 15;
% chirped parameter
%
N
= 300.0;
time = linspace(0,50,N);
pulse = exp(-0.5*((t_zero - time)/width).^2);
% Gaussian pulse

160
Propagation of linear pulses
pulse_ch = exp(-(0.5+1i*C)*((t_zero - time)/width).^2); % chirped pulse
%
subplot (2,1,1), h = plot(time,pulse);
set(h,’LineWidth’,1.5);
% thickness of plotting lines
title(’Gaussian pulse’,’FontSize’,14)
xlabel(’time’,’FontSize’,14); ylabel(’amplitude’,’FontSize’,14);
set(gca,’FontSize’,14);
% size of tick marks on both axes
%
subplot (2,1,2), h = plot(time,pulse_ch);
set(h,’LineWidth’,1.5);
% thickness of plotting lines
title(’Chirped Gaussian pulse’,’FontSize’,14)
xlabel(’time’,’FontSize’,14); ylabel(’amplitude’,’FontSize’,14);
set(gca,’FontSize’,14);
% size of tick marks on both axes
pause
close all
Listing 6A.5.1
Function ptrain.m. Generates a train of pulses.
% File name: ptrain.m
% Generates train of pulses
% Allows for overlap of pulses
clear all
bits = [0 1 0 1 1 0];
% definition of logical pattern
T = 1d-9;
% pulse period [s]
num_pulses = length(bits);
% number of pulses
N = 1000;
% number of time points
width = 0.3*T;
% width of pulse
time=linspace(0,num_pulses*T,N);
signal = zeros(1,N);
pulses = zeros(num_pulses,N);
%
t_0= T/2;
%position of peak of first impulse in signal
for i=1:num_pulses
if (bits(i)==1)
pulses(i,:)= fgauss(time,width,t_0);
signal = signal + fgauss(time,width,t_0);
end
t_0 = t_0 + T;
end
%
subplot (2,1,1); h = plot(time,pulses);
set(h,’LineWidth’,1.5);
% thickness of plotting lines
xlabel(’time’,’FontSize’,14);
% size of x label
title(’Individual pulses’,’FontSize’,14)
set(gca,’FontSize’,14);
% size of tick marks on both axes
subplot (2,1,2); h = plot(time,signal);
set(h,’LineWidth’,1.5);
% thickness of plotting lines

161
Appendix 6A
xlabel(’time’,’FontSize’,14);
% size of x label
set(gca,’FontSize’,14);
% size of tick marks on both axes
title(’Total signal’,’FontSize’,14)
pause
close all
Listing 6A.5.2
Function fgauss.m. Function used by program ptrain.m. Function creates
individual Gaussian pulses.
function pulse = fgauss(time,width,t_0)
% function pulse = wave_gauss(t,T_period)
% Generates individual Gaussian pulse used in the creation of
% train of pulses
pulse = exp(-0.5*((t_0 - time)/width).^2);
Listing 6A.6
Function bits gen.m. Function generates an 8-bits long bit pattern.
% File name: bits_gen.m
%-----------------------------------------------------------------
% Purpose:
% Generates 8-bits long pattern
% generates single bit which is then repeated 8 times
% Source
% R.Sabella and P.Lugli
% "High Speed Optical Communications"
% Kluwer Academic Publishers 1999
% p.32
%*********************************
%
clear all
bits = [0 1 0 0 1 1 0 1];
% Definition of logical pattern
%
T_period = 1d-9;
% pulse period [s]
I_bias = 2;
% mA
I_m = 3;
% mA
tau_r = 0.2*T_period;
% rise time
%
% Generation of current pattern corresponding to bit pattern
I_p = 0;
N_div = 50;
% number of divisions within each bit interval
t = linspace(0, T_period, N_div);
% the same time interval is
% generated for each bit
%******** first bit *************************************
if bits(1)==0,
I_p_1 = I_bias + 0*t;
elseif bits(1)==1, I_p_1 = I_bias + I_m + 0*t;
end
%------------------------------------------

162
Propagation of linear pulses
% Generates single, arbitrary bit
%t = linspace(0, T_period, N_div);
temp_I = I_p_1;
%
number_of_bits = length(bits);
%
for k = 2:number_of_bits
if bits(k)==1 && bits(k-1)==0
I_p = I_bias + I_m*(1 - exp(-2.2*t./tau_r));
elseif bits(k)==0 && bits(k-1)==1
I_p = I_bias + I_m*exp(-2.2*t./tau_r);
elseif bits(k)==0 && bits(k-1)==0
I_p = I_bias + 0*t;
else bits(k)==1 && bits(k-1)==1
I_p = I_bias + I_m + 0*t;
end
I_p = [temp_I,I_p];
temp_I = I_p;
end
temp_t = t;
for k = 2:number_of_bits
t = linspace(0, T_period, N_div);
t = [temp_t,(k-1)*T_period+t];
temp_t = t;
end
%
x_min = 0;
x_max = max(t);
y_min = I_bias;
y_max = I_bias + 1.2*I_m;
%
h = plot(t,I_p);
grid on
set(h,’LineWidth’,1.5);
% thickness of plotting lines
xlabel(’time [s]’,’FontSize’,14);
% size of x label
ylabel(’Current [mA]’,’FontSize’,14);
% size of y label
set(gca,’FontSize’,14);
% size of tick marks on both axes
axis([x_min x_max y_min y_max])
pause
close all
Listing 6A.7
Function pulse evol.m. Function describes evolution width of a chirped
pulse.
% File name: pulse_evol.m
% Describes evolution of pulse width as a function of normalized

163
Appendix 6A
% distance for chirped and unchirped pulses
%
clear all
% Data
beta_2 = -20;
% [-20ps^2/km] at 1.55 microns
T_0 = 200;
% [ps] = 0.2 ns, bit rate 10Gb/s
L_D = (T_0^2)/abs(beta_2);
N_max = 401;
% number of points for plot
x = linspace(0,1.5,N_max);
% normalized distance; x = z/L_D
%
hold on
for C = [-1 0 1 2]
% chirped coefficient
T = sqrt((1+sign(beta_2)*C*x).^2 + (x).^2);
h = plot(x,T);
set(h,’LineWidth’,1.5);
% thickness of plotting lines
end
% Redefine figure properties
ylabel(’T_1/T_0’,’FontSize’,14)
xlabel(’z/L_D’,’FontSize’,14)
text(0.35, 1.65, ’C = -1’,’Fontsize’,14)
text(0.35, 1.2, ’C = 0’,’Fontsize’,14)
text(0.35, 0.8, ’C = 1’,’Fontsize’,14)
text(0.35, 0.55, ’C = 2’,’Fontsize’,14)
set(gca,’FontSize’,14);
% size of tick marks on both axes
pause
close all
Listing 6A.8.1
Function pdisp.m. Function describes the evolution of a Gaussian pulse
with dispersion.
% File name: pdisp.m
% Propagation of Gaussian pulse in the presence of dispersion
% using Fourier transform
clear all;
% Creation of input pulse
T_0 = 1.0;
% pulse width
T_s = 0.08;
% sampling period
t = -4:T_s:4-T_s;
% creation of time interval
p = gauss_m(t,T_0);
P=fftshift(fft(p));
% Fourier transform of the original pulse
Fs=1/64;
% sampling frequency
N=length(t);
% length of time interval
f = -N/2*Fs:Fs:N/2*Fs-Fs;
% frequency range
omega = 2*pi*f;
% Parameters of optical fiber

164
Propagation of linear pulses
alpha = 0.0;
% losses
beta_2 = 60.0;
% coefficient beta_2 [ps^2/km]
%beta_2 = 0.0;
% coefficient beta_2 [ps^2/km]
beta_3 = 0.01;
% coefficient beta_3 [ps^3/km]
% Transfer function of optical fiber
distance = 4000;
H=exp((alpha/2+1i/2*beta_2*omega.^2+1i/6*beta_3*omega.^3)*distance);
%
P_prop = P.*H;
% Fourier transform of final pulse
p_prop = ifft(fftshift(P_prop)); % time dependence of final pulse
p_plot = abs(p_prop).^2;
%
h = plot(t, p, ’.’, t, p_plot);
set(h,’LineWidth’,1.5);
% thickness of plotting lines
xlabel(’time’,’FontSize’,14);
% size of x label
ylabel(’Arbitrary units’,’FontSize’,14);
% size of y label
set(gca,’FontSize’,14);
% size of tick marks on both axes
legend(’original pulse’, ’transmited pulse’)
pause
close all
Listing 6A.8.2
Function gauss m.m. Function used by pdisp.m.
function p = gauss_m(t,T_0)
% Definition of Gaussian and super-Gaussian pulses
m = 1;
% m=1, usual Gauss; m=3, super-Gauss
%m = 3;
p = exp(-t.^(2*m)/(2*T_0^(2*m)));
Listing 6A.9
Function sslg.m. Function creates a Gaussian pulse in the time domain
which is subsequently Fourier transformed to the frequency domain and then propagated
over a linear system with dispersion characterized by β2 and β3.
% File name: sslg.m
% Calculates and plots the evolution of a Gaussian pulse in optical fiber
% using Fast Fourier Transform split-step method with linear terms only
clear all
% Input parameters
N= 32;
% number of points along time axis
T_domain = 100;
% total time domain kept [in ps]
beta_2 = 2;
% dispersion coefficient [in ps/nm-km]
beta_3 = 1.01;
%
Delta_t = T_domain/N;
% node spacing in time
Delta_om = 2*pi/T_domain;
% node spacing in radial frequency
t = Delta_t*(-N/2:1:(N/2)-1);
% array of time points
omega = Delta_om*(-N/2:1:(N/2)-1);
% array of radial frequency points

165
References
t_FWHM_0 = 20;
% initial pulse FWHM [in ps]
P_0 = 1;
% initial peak power [in mW]
A_0 = sqrt(P_0);
% initial amplitude of the Gaussian
T_0 = t_FWHM_0/(2*sqrt(log(2)));
% initial pulse standard deviation
gauss = A_0*exp(-t.^2/(2*T_0^2));
% initial Gauss pulse in time
%
L_D = 200;
z_plot = [0 0.25 0.5 0.75 1.0]*L_D; % z-values to plot [in km]
gauss_F = fftshift(abs(fft(gauss)));% initial Gauss in frequency
z
= 0;
% starting distance
n = 0;
% controls stepping
hold on
for z_val = z_plot
% for selected z-values
n = n + 1;
% creates new step
% P -propagator function
P = exp(((1j/2)*beta_2*(omega.^2)+(1j/6)*beta_3*(omega.^3))*z_val);
u_F_z = gauss_F.*P;
% propagation at point z
u_z = ifft(u_F_z,N);
% takes inverse Fourier transform
u_abs_z = abs(u_z).^2;
u = fftshift(u_abs_z);
% shifts frequency components
u_3D(:,n) = u’;
% create array for 3D plot
plot(t,u,’LineWidth’,1.5)
end
grid on
xlabel(’time [ps]’,’FontSize’,14); ylabel(’amplitude’,’FontSize’,14);
set(gca,’FontSize’,14);
% size of tick marks on both axes
pause
close all
%
% Make 3D plot
for k = 1:1:length(z_plot)
% choosing 3D plots every step
y = z_plot(k)*ones(size(t));
% spread out along y-axis
plot3(t,y,u_3D(:,k),’LineWidth’,1.5)
hold on
end
xlabel(’time [ps]’,’FontSize’,14); ylabel(’distance [km]’,’FontSize’,14);
set(gca,’FontSize’,14);
% size of tick marks on both axes
grid on
pause
close all
References
[1] G. P. Agrawal. Fiber-Optic Communication Systems. Second Edition. Wiley, New York,
1997.

166
Propagation of linear pulses
[2] E. Iannone, F. Matera, A. Mocozzi, and M. Settembre. Nonlinear Optical Communi-
cation Networks. Wiley, New York, 1998.
[3] G. P. Agrawal. Nonlinear Fiber Optics. Academic Press, Boston, 1989.
[4] G. Keiser. Optical Fiber Communications. Fourth Edition. McGraw-Hill, Boston, 2011.
[5] M. M.-K. Liu. Principles and Applications of Optical Communications. Irwin, Chicago,
1996.
[6] L. N. Binh. Optical Fiber Communications Systems. CRC Press, Boca Raton, 2010.
[7] R. Ramaswami and K. N. Sivarajan. Optical Networks: A Practical Perspective. Second
Edition. Morgan Kaufmann Publishers, San Francisco, 1998.
[8] J. C. Cartledge. Improved transmission performance resulting from the reduced chirp of
a semiconductor laser coupled to an external high-Q resonator. J. Lightwave Technol.,
8:716–21, 1990.
[9] R. Sabella and P. Lugli. High Speed Optical Communications. Kluwer Academic
Publishers, Dordrecht, 1999.

7
Optical sources
In this chapter, we will give a basic introduction to optical sources with the main emphasis on
semiconductor lasers. The bulk of our description is based on the rate equations approach.
We start with a general overview of lasers.
7.1 Overview of lasers
Generic laser structure is shown in Fig. 7.1 [1], [2]. It consists of a resonator (cavity),
here formed by two mirrors, and a gain medium where the ampliﬁcation of electromagnetic
radiation (light) takes place. A laser is an oscillator analogous to an oscillator in electronics.
To form an oscillator, an ampliﬁer (where gain is created) and feedback are needed.
Feedback is provided by two mirrors which also conﬁne light. One of the mirrors is
partially transmitting which allows the light to escape from the device. There must be
an external energy provided into the gain medium (a process known as pumping). Most
popular (practical) pumping mechanisms are by optical or electrical means.
Gain medium can be created in several ways. Conceptually, the simplest one is the
collection of gas molecules. Such systems are known as gas lasers. In a gas laser one can
regard the active medium effectively as an ensemble of absorption or ampliﬁcation centers
(e.g. like atoms or molecules) with only some electronic energy levels which couple to the
resonant optical ﬁeld. Other electronic states are used to excite or pump the system. The
pumping process excites these molecules into a higher energy level.
A schematic of a pumping cycle of a typical laser is shown in Fig. 7.2. The system
consists of a ground state level (here labelled as ‘0’), two levels with energies E1 and E2 and
a band labelled as ‘3’. The system is pumped by an external source with the frequency ω30.
Fast decay takes place between band ‘3’ and energy level ‘2’. In this way the population
inversion is achieved (occupancy of level ‘2’ is larger than level ‘1’), and at some point
laser action can take place and light with frequency ω21 can be emitted.
The system consisting of level ‘2’ and ‘1’ can be further isolated. Popular visualization
of such systems is known as a two-level system (TLS), see Fig. 7.3. Only two energies (out
of many in the case of a molecule) are selected and the transitions are considered within
those energies. As illustrated, three basic processes are possible: absorption, stimulated
emission and spontaneous emission.
Such TLS are met often in Nature. Generally, for an atomic system, in the case under
consideration, we can always separate just two energy levels, upper level and ground state,
thereby forming TLS.
167

168
Optical sources
Resonator (two mirrors)
Gain
medium
Pump
Fig. 7.1
Generic laser structure: two mirrors with a gain medium in between. The two mirrors form a cavity, which confines the
light and provides the optical feedback. One of the mirrors is partially transmitted and thus allows light to escape. The
resulting laser light is directional, with a small spectral bandwidth.
3
0
1
2
30
21
Pump
transitions
Fast decay
Fast decay
ω
ω
Laser transitions
Fig. 7.2
Pumping cycle of a typical laser.
Ec
absorption
stimulated
emission
spontaneous
emission
(a)
(c)
hν>Eg
Eg
~~
(b)
hν
hν
hν
hν
Ev
Ec
Ev
Ec
Ev
Fig. 7.3
Illustration of possible transitions in two-level system.
As mentioned above, an electron can be excited into the upper level due to external
interactions (for lasers, process known as pumping). Electrons can lose their energies
radiatively (emitting photons) or non-radiatively, say by collisions with phonons.
For laser action to occur, the pumping process must produce population inversion, mean-
ing that there are more molecules in the excited state (here, upper level with energy E2)
than in the ground state. If the population inversion is present in the cavity, incoming light

169
Overview of lasers
E2
E2
E 2
E1
E
ρ
1
E1
absorption
spontaneous
emission
stimulated
emission
(c)
(b)
(a)
12
1
21
(
)
B N
v
21
2
21
(
)
B N
v
21
2
A N
ρ
Fig. 7.4
Illustration of the notation of electron transitions in a TLS.
can be ampliﬁed by the system, see Fig. 7.3b where one incoming photon generates two
photons at the output.
The way how TLS is practically utilized results in various types of lasers; like gaseous,
solid state, semiconductor. Also, different types of resonators are possible which will be
discussed in subsequent sections.
7.1.1 Transitions in a TLS
Assume the existence of two energy levels E1 and E2 (forming TLS) which are occupied
with probabilities N1 and N2. Also introduce:
A21 the probability of spontaneous emission
B21 the probability of stimulated emission
B12 the probability of absorption.
The notation associated with those processes is illustrated in Fig. 7.4.
We introduce ν21 = (E2 −E1)/h and ρ(ν21) is the density of photons with frequency
ν21. Coefﬁcients A21, B21, B12 are known as Einstein coefﬁcients. The density of photons
ρ(ν21) of frequency ν21 can be determined from the Planck’s distribution of the energy
density in the black body radiation as [2]
ρ(ν21) = 8πhν3
21
c3
1
exp hν21
kT −1
(7.1)
For the laser we require that ampliﬁcation be greater than absorption. Therefore, the
number of stimulated transitions must be greater than the absorption transitions. Thus the
net ampliﬁcation can be created. In the following we will determine the condition for
the net ampliﬁcation in such systems [2].
The change in time of the occupancy of the upper level is
dN2
dt
= −A21N2 −B21N2ρ(ν21) + B12N1ρ(ν21)
(7.2)
First term on the right hand side describes spontaneous emission; second term is responsible
for stimulated emission and the last one for absorption. In thermal equilibrium which
requires that dN2
dt = 0, using Eq. (7.1) one obtains
N2
	
B21
8πhν3
21
c3 
exp hν21
kT −1
 + A21

= N1B12
8πhν3
21
c3 
exp hν21
kT −1

(7.3)

170
Optical sources
z = L
rL
rR
z
z = 0
Fig. 7.5
Schematic illustration of the amplification in a Fabry-Perot (FP) semiconductor laser with homogeneously distributed
gain.
Next, assume that N1 and N2 are given by the Maxwell-Boltzmann statistics; i.e.
N1
N2
= exp

−hν21
kT

(7.4)
Substitute (7.4) into Eq. (7.3) and have
exp

−hν21
kT
 	
B21
8πhν3
21
c3 
exp hν21
kT −1
 + A21

= B12
8πhν3
21
c3 
exp hν21
kT −1

From the above equation, the density of photons ρ(ν21) can be expressed in terms of
Einstein coefﬁcients as
8πhν3
21
c3 
exp hν21
kT −1
 =
A21
B12 exp
 hν21
kT

−B21
(7.5)
In the above formula, both sides are equal if
B21 = B12
(7.6)
In such case, one ﬁnds
A21
B21
= 8πhν3
21
c3
(7.7)
The relations (7.6) and (7.7) are known as Einstein relations [2].
7.1.2 Laser oscillations and resonant modes
Light propagation with ampliﬁcation is illustrated in Fig. 7.5. Mathematically it is described
by assuming that there is no phase change on reﬂection at either end (left and right). Left

171
Overview of lasers
end is deﬁned as z = 0 and right end as z = L. At the right facet, the forward optical wave
has a fraction rR reﬂected (amplitude reﬂection) and after reﬂection that fraction travels
back (from right to left).
In order to form a stable resonance, the amplitude and phase of the wave after a single
round trip must match the amplitude and phase of the starting wave. At arbitrary point z
inside the cavity, see Fig. 7.5, the forward wave is
E0egze−jβz
(7.8)
where we have dropped eiωt term which is common and deﬁned g = gm −αm, where gm
describes gain (ampliﬁcation) of the wave and αm its losses. Also rR and rL are, respectively,
right and left reﬂectivities, L length of the cavity and β propagation constant.
The wave travelling one full round will be

E0egze−jβz 
eg(L−z)e−jβ(L−z) 
rRegLe−jβL 
rLegze−jβz
(7.9)
The above terms are interpreted as follows. In the ﬁrst bracket there is an original forward
propagating wave which started at z, in the second bracket there is a wave travelling from z
to L, the third bracket describes a wave propagating from z = L to z = 0, and the last one
contains a wave travelling from z = 0 to the starting point z. At that point the wave must
match the original wave as given by Eq. (7.8). From the above, one obtains a condition for
stable oscillations
rRrLe2gLe−2jβL = 1
(7.10)
That condition can be split into an amplitude condition
rRrLe2(gm−αm)L = 1
(7.11)
and phase condition
e−2jβL = 1
(7.12)
From the amplitude condition one obtains
gm = αm + 1
2L ln
1
rRrL
(7.13)
From the phase condition, it follows
2βL = 2πn
(7.14)
where n is an integer. The last equation determines wavelengths of oscillations since
β = 2π
λn
= ωn
c
(7.15)
with λn being the wavelength. Typical gain spectrum and location of resonator modes are
shown in Fig. 7.6a. Longitudinal modes with angular frequencies ωn−1, ωn and ωn+1 are
shown. In time, the mode which has the largest gain will survive; the other modes will
diminish, see Fig. 7.6b.

172
Optical sources
(a)
(b)
gain
n
n
n-1
ω
ω
ω
ω
ω
ω
ω
ω
n+1
n+1
n-1
Fig. 7.6
Gain spectrum of semiconductor laser and location of longitudinal modes. ωn are FP resonances determined from
phase condition.
(b)
active
regions
Bragg
mirrors
output
light
(a)
output
light
longitudinal
direction
lateral
direction
transversal
direction
Fig. 7.7
VCSEL (left) and in-plane laser (right).
7.2 Semiconductor lasers
A signiﬁcant percentage of today’s lasers are fabricated using semiconductor technology.
Those devices are known as semiconductor lasers. Over the last 15 years or so, several
excellent books describing different aspects and different types of semiconductor lasers
have been published [3], [4], [5], [6], [7].
The operation of semiconductor lasers as sources of electromagnetic radiation is based
on the interaction between EM radiation and the electrons and holes in semiconductors.
Typical semiconductor laser structures are shown in Fig. 7.7. Those are: vertical cavity
surface emitting laser (VCSEL) [8] where light propagates perpendicularly to the main
plane and in-plane laser where light propagates in the main plane [9]. The largest dimension

173
Semiconductor lasers
light
out
electrons in
holes in
p-type
n-type
active region
Fig. 7.8
The basic p-n junction laser.
of in-plane structures is typically in the range of 250 µm (longitudinal direction) whereas
the typical diameter of VCSEL cylinder is about 10 µm.
The basic semiconductor laser is just a p-n junction, see Fig. 7.8 where cross-section
along lateral-transversal directions is shown. Current ﬂows (holes on p-side and electrons on
n-side) along the transversal direction, whereas light travels along the longitudinal direction
and leaves device at one or both sides.
In VCSEL, the cavity is formed by the so-called Bragg mirrors and an active region
typically consists of several quantum well layers separated by barrier layers, see Fig. 7.7.
(For a detailed discussion of quantum wells see [1] and [3]. This discussion is beyond the
scope of this book.) Bragg mirrors consist of several layers of different semiconductors
which have different values of refractive index. Due to the Bragg reﬂection such structure
shows a very large reﬂectivity (around 99.9%). Such large values are needed because a very
short distance of propagation of light does not allow to build enough ampliﬁcation when
propagating between distributed mirrors.
A three-dimensional perspective view of some generic semiconductor lasers is shown
in Fig. 7.7. The structures consists of many layers of various materials, each engaged in a
different role. Those layers are responsible for the efﬁcient transport of electrons and holes
from electrodes into an active region and for conﬁnement of carriers and photons so they
can strongly interact. Modern structures contain so-called quantum wells which form an
active region and where conduction-valance band transitions are taking place. It is possible
to have different types of mirrors as they also provide mode selectivity. Two basic types are
illustrated in Fig. 7.9 and Fig. 7.10 [9]. They are known as distributed feedback (DFB) and
distributed Bragg (DBR) structures.
In DFB lasers, grating (corrugation) is produced in one of the cladding layers, thus
creating Bragg reﬂections at such periodic structure. The structure causes a wavelength
sensitive feedback. It should be emphasized that the grating extends over the entire laser
structure. When one restricts corrugation to the mirror regions only and leaves a ﬂat active
region in the middle, then the so-called DBR structure is created, see Fig. 7.10, which also
provides wavelength sensitive feedback.

174
Optical sources
Grating
Active
layer and
waveguide
Fig. 7.9
Basic DFB laser structure.
DBR mirror
DBR mirror
Active
layer and
waveguide
Fig. 7.10
Basic DBR laser structure.
Conduction
band
Valence
band
Ec
Ecv
Scv,sp
Scv,st
Svc,abs
EFc
EFv
Ev
Fig. 7.11
Electron transitions between conduction and valence bands.
7.2.1 Electron transitions in semiconductors
Previous discussion of TLS will now be extended to describe transitions between bands in
semiconductors, see Fig. 7.11. For that purpose, we introduce:
• fv the probability of the state of energy Ev in the valence band being ﬁlled.
• fc the probability of the state of energy Ec in the conduction band being ﬁlled.
Rates of transitions can now be determined, similarly to the TLS description. Here we
use index notation appropriate to semiconductors, i.e. c, v instead of 1, 2. The rates are
Sspon = Scv,sp = A21 fc (1 −fv)
(7.16)
Sstim = Scv,st = B21 fc (1 −fv) ρ(Ecv)
(7.17)
Sabs = Scv,abs = B12 fv (1 −fc) ρ(Ecv)
(7.18)

175
Semiconductor lasers
+
+
+
+
+
+
+
+
+
n-type
p-type
p-type
n-type
(a)
(b)
EFv
EFv
Ev
Ev
EFc
EFc
Ec
Ec
Fig. 7.12
Energy-band diagram of a p-n junction. (a) thermal equilibrium, (b) forward bias.
Fermi-Dirac statistics are assumed for the appropriate probabilities as
fv =
1
exp
 Ev−EFv
kT
+ 1

(7.19)
fc =
1
exp
 Ec−EFc
kT
+ 1

(7.20)
Here EFc and EFv are the quasi-Fermi levels for electrons and holes.
The condition for stimulated emission to exceed absorption is
Sstim > Sabs
which gives
B21 fc (1 −fv) > B12 fv (1 −fc)
Since the coefﬁcients B21 and B12 are equal, after substituting expressions (7.19) and (7.20)
one obtains
exp
Ev −EFv
kT

> exp
Ec −EFc
kT

which can be written in the form
EFc −EFv > Ec −Ev = hν
(7.21)
The above inequality is known as Bernard-Duraffourg condition [10].
7.2.2 Homogeneous p-n junction
Energy-band diagrams of a p-n junction in thermal equilibrium and under forward bias
conditions are shown in Fig. 7.12.

176
Optical sources
Electrons at the n-type side do not have enough energy to climb over the potential barrier
to the left. Similar situation exists for holes in the p-type region, see Fig. 7.12a. One needs
to apply forward voltage to lower the potential barriers for both electrons and holes, see
Fig. 7.12b.
An application of the forward voltage also separates Fermi levels. Thus two different
so-called quasi-Fermi levels EFc and EFv are created which are connected with an external
bias voltage as
EFc −EFv = eVbias
(7.22)
With the lowered potential barriers, electrons and holes can penetrate central region where
they can recombine and produce photons. However, the conﬁnement of both electrons and
holes into the central region is very poor (there is no mechanism to conﬁne those carriers).
Also, there is no conﬁnement of photons (light) into the region where electrons and holes
recombine (the region is known as an active region). Therefore, the interaction between
carriers and photons is weak, which makes homojunctions a very poor light source. One
must, therefore, provide some mechanism which will conﬁne both carriers and photons into
the same physical region where they will strongly interact. Such a concept is possible with
the invention of heterostructures, which will be discussed next.
7.2.3 Heterostructures
A heterojunction is formed by joining dissimilar semiconductors. The basic type is formed
by two heterojunctions and it is known as a double-heterojunction (more popular name is
double-heterostructure).
The materials forming double heterostructures have different bandgap energies and
different refractive indices. Therefore, in a natural way potential wells for both electrons
and holes are created. Schematic energy-band diagrams of a double-heterostructure p-n
junction in thermal equilibrium and under forward bias conditions are shown in Fig. 7.13.
The bandgap and refractive index for InGaAsP material will now be summarized.
Bandgap
For the In1−xGaxAsyP1−y system, the relation between compositions x and y which results
in the lattice-match to InP is
y =
0.1894y
0.4184 −0.013y
(7.23)
In such case the bandgap is [11], [12]
Egap[eV ] = 1.35 −0.72y + 0.12y2
(7.24)
with the extra relations y ≈2.20x and 0 ≤x ≤0.47. The material for such compositions
thus covers bandgaps in the range of wavelengths 0.92 µm ⇔1.65 µm. For example, the
material In0.74Ga0.26As0.57P0.43 (i.e. x = 0.26, y = 0.57) has bandgap Eg = 0.97eV, which
corresponds to the wavelength λ = 1.27 µm.

177
Semiconductor lasers
Table 7.1 Typical values of refractive indices for various compositions.
Wavelength
Range of y compositions
Refractive index
λ = 1.3 µm
0 ≤y ≤0.6
n(y) = 3.205 + 0.34y + 0.21y2
λ = 1.55 µm
0 ≤y ≤0.9
n(y) = 3.166 + 0.26y + 0.09y2
+
+
+
+
+
+
+
+
+
n-type
p-type
p-type
Active
Active
n-type
(a)
(b)
EFc
EFc
Ev
Ev
EFv
EFv
Ec
Ec
Fig. 7.13
Energy-band diagram of a double-heterostructure p-n junction. (a) Thermal equilibrium, (b) forward bias.
Refractive index
As was explained before, the dependence of refractive index as a function of wavelength
is described by Sellmeier equation. For important telecommunication wavelengths, namely
1.3 µm and 1.55 µm, the y dependence of refractive index of In1−xGaxAsyP1−y that is lattice
matched to InP is shown in Table 7.1 [13].
In the wells formed by heterostructures, electrons and holes recombine thus generating
light. Also, differences in the values of refractive indices such that central region has
larger value of refractive index create planar optical waveguide where light propagates and
efﬁciently interacts with carriers.
Some illustrative values of bandgaps and refractive indices for InGaAsP/InP heterostruc-
ture are shown in Fig. 7.14.
7.2.4 Optical gain
For efﬁcient and reliable numerical simulations, an exact mathematical expression of the
material gain is critical. Such an expression should also be subject to an experimental
veriﬁcation. This problem has been investigated since the early developments of semicon-
ductor lasers [14], [15], [16]. The ﬁrst step is usually the determination of gain spectra

178
Optical sources
1.35eV
0.95eV
Refractive
index
energy
active
layer
p-InP
n-InP
InGaAsP
3.5
3.2
Fig. 7.14
Band structure and refractive index for InGaAsP/InP heterostructure.
and its comparison with experiment. The simplest approach will be provided in the next
section. Typical curves of gain spectra for a four quantum well system and comparison
with experimental measurements are shown in Fig. 7.15, from [17]. Mathematics involved
in determining optical gain of semiconductor quantum-well structures is complex and has
been discussed extensively, for example [18], [19], [20]. As a result, analytic approxima-
tions of the optical gain which can be used in fast calculations were determined, see [21],
[22], [23]. From an extensive discussion it was determined that the peak material gain for
bulk materials varies linearly with carrier density
g(N, λ) = a(λ) min (N, P) −b(λ)
(7.25)
The parameter a(λ) is commonly called the differential gain.
On the basis of experimental observations, Westbrook [24], [25] extended the linear gain
peak model to allow for wavelength dependence. In its simplest form it can be written as
[24], [26], [27]
g(N, λ) = a(λp)N −b(λp) −ba

λ −λp
2
(7.26)
where λp is the wavelength of the peak gain and ba governs the base width of the gain
spectrum. Wavelength peak λp can be also carrier density dependent.
Gain (absorption) in a semiconductor is a function of carrier density n [cm−3] (see
Fig. 7.16, which shows gain spectrum for several values of carrier concentration) [28].
When n is below transparency density ntr, the medium absorbs optical signal. For n > ntr,
optical gain in the material exceeds loss. The dependence of the so-called gain peak on the
carrier density for quantum well systems is logarithmic, see Fig. 7.17. It is described by the
expression [4]
g = g0 ln N
Ntr
(7.27)
For modelling purposes, a linear approximation is often employed. In the above formulas
g0 is the differential gain, Ntr transparency carrier density and Nth is the carrier density at
threshold.

179
Semiconductor lasers
0.83
0.82
0.81
0.80
0.79
0.78
-40
-30
-20
-10
0
10
20
30
 Theoretical
 Experimental
25 mA
21 mA
Modal Gain (/cm)
Photon Energy (eV)
Fig. 7.15
Fitted theoretical and experimental net modal gain versus photon energy including leakage terms for three values of
injected current, from [17].
Gain
(×104m-1)
3×1018 cm-1
2×1018 cm-1
1×1018 cm-1
1450
-2
0
2
4
6
8
1500
Wavelength [nm]
1550
1600
Fig. 7.16
Schematic optical gain spectra for various carrier densities.

180
Optical sources
N
Nth
Ntr
g
th
g
g
th
g
Ntr
th
N
N
Fig. 7.17
Illustration of threshold and transparency densities for linear (left) and logarithmic (right) gain models.
7.2.5 Determination of optical gain
The simplest approach to determine optical gain is based on Fermi golden rule. Here we
derive it for T = 0. Transition rate between two levels a and b is [1]
Wab = 2π
ℏ
H′
ab
2 δ (Eb −Ea −ℏω)
(7.28)
where H′
ab is the matrix element describing transitions between levels a and b. Assume
parabolic bands for both electrons and holes with the effective mass m∗taking the value of
m∗
c for conduction band and m∗
v for a valence band as follows:
E (k) = ℏ2k2
2m∗
(7.29)
From the above
Eb −Ea = ℏ2k2
2
 1
mc
+ 1
mv

+ Eg
(7.30)
Due to conservation of the crystal momentum in the transition, one has ⃗kin = ⃗k f i [29]. For
a single transition at speciﬁc value of k, one therefore has
W (k) = 2π
ℏ
H ′
vc (k)2 δ
ℏ2k2
2mr
+ Eg −ℏω

(7.31)
where mr =
mvmc
mv+mc is reduced effective mass. If N is a total number of transitions per second
in crystal volume V and g (k) = k2V
π2 is number of states per unit k in volume V , the total
number of transitions per second is
N =
∞

0
W (k) · g (k) dk
= 2V
πℏ
∞

0
H ′
vc (k)
2 δ
ℏ2k2
2mr
+ Eg −ℏω

k2dk
(7.32)

181
Rate equations
To evaluate integral, let us introduce new variable X ≡ℏ2k2
2mr + Eg −ℏω. Integral takes the
form
N = 2v
πℏ
 H ′
vc (k)
2 mr
ℏδ (X )

2mv
ℏ2

X + ℏω −Eg

dX
= V
π
H ′
vc (k)
2 (2mr)3/2
ℏ4

ℏω −Eg
1/2
(7.33)
where ℏ2k2
2mr + Eg = ℏω. We are in a position now to determine absorption coefﬁcient α. It
is deﬁned as
α (ω) ≡power absorbed per unit volume
power crossing a unit area
= (N) · (ℏω) /V
ε0nE2
0c/2
(7.34)
where n is refractive index, c is the velocity of light in a vacuum and E0 is the amplitude of
electric ﬁeld. Use
H ′
vc (k) = eE0χvc
2
,
χvc = ⟨uvk′ |x| uck⟩
(7.35)
Using the above and expression for N, one ﬁnds
α0 (ω) = ωe2χ2
vc (2mr)3/2
2πε0ncℏ3

ℏω −Eg
1/2 = K

ℏω −Eg
1/2
(7.36)
Example
Estimates of K.
Data for GaAs. ℏω = 1.5 eV, mv = 0.46m0, mc = 0.067m0, χvc = 3.2 ˙A,n = 3.64.
Those data give K ≈11 700 cm−1 (eV )−1/2 , and α0 (ω) = 1170 cm−1 [1].
At T = 0 depending on the value of ℏω, one has the following possibilities summarized
next:
ℏω < Eg
α (ω) = 0
Eg < ℏω < EFc −EFv
α (ω) = −α0 (ω) = −K(ℏω −Eg)1/2
amplification
EFc −EFv < ℏω
α (ω) = α0 (ω) = K(ℏω −Eg)1/2
absorption
(7.37)
7.3 Rate equations
With all basic elements in place we are now ready to provide the simplest (phenomenolog-
ical) description of semiconductor lasers. It is based on rate equations [4]. The main role
in those devices is played by two subsystems: carriers (electrons and holes) and photons.
They interact in the so-called active region, deﬁned as part of the structure where recom-
bining carriers contribute to useful gain and photon emission. We describe both subsystems
separately, starting with carriers.
In Fig. 7.18 (adapted from [4]), we schematically showed model of a laser operating
below threshold. It resembles a tank partially ﬁlled with water continuously ﬂowing in and
at the same time water leaves the tank. The water models carriers which are continuously

182
Optical sources
current
Rnr
Rsp
Rloss
leakage
current
Fig. 7.18
Model of a laser operating below threshold. From L. A. Coldren and S. W. Corzine, DiodeLasersandPhotonicIntegrated
Circuits, Wiley (1995). Reprinted with permission of John Wiley & Sons, Inc.
current
Rnr
Rsp
Rst
Nth
leakage
current
Rloss
Fig. 7.19
Model of a laser operating above threshold. From L. A. Coldren and S. W. Corzine, DiodeLasersandPhotonicIntegrated
Circuits, Wiley (1995). Reprinted with permission of John Wiley & Sons, Inc.
provided by current ﬂowing in. Not all the current at electrodes actually reaches the device
(tank). Some of it is lost as so-called leakage current. Below threshold, carriers disappear
through losses in the device (Rloss), non-radiative recombination (Rnr) and spontaneous
emission (Rsp). Above threshold (shown schematically in Fig. 7.19), the tank is completely
ﬁlled with water (in laser the situation corresponds to the so-called threshold with density
Nth). Its operation is mostly dominated by yet another process, namely stimulated emission
(here characterized by coefﬁcient Rst).
Next, based on the above picture we will formulate equations describing dynamics of
carriers and photons.
7.3.1 Carriers
Inside the laser there exist two types of carriers: electrons and holes. Both are described in
a similar way; however, parameters used will be different for both types.
The rate of change of carrier density is governed by
dN
dt = Ggener −Rrecom
(7.38)
where the terms on right are responsible for generation and recombination of carriers and
are given by
Ggener = ηi
I
q · V
with V being the volume of the active region, q is the electron’s charge and I is the electric
current. The internal efﬁciency ηi describes the fraction of terminal current that generates

183
Rate equations
carriers in the active region. The recombination term consists of several contributions
Rrecom = Rsp + Rnr + Rl + Rst
The meaning of terms is as follows:
Rsp −spontaneous recombination rate
Rnr −nonradiative recombination rate
Rl −carrier leakage rate
Rst −net stimulated recombination rate
Recombination processes are described phenomenologically as [4]
Rrecom = N
τ + vgg(N)S
(7.39)
7.3.2 Photons
Let S be the photon density. We postulate the following rate of change of photon density:
dS
dt = Rst −S
τp
+ βspRsp
with the following deﬁnitions:
τp – photon life-time
βsp – spontaneous emission factor (reciprocal of the number of optical modes)
Rst – stimulated recombination.
 – conﬁnement factor which is the ratio of the active layer volume to the volume of the
optical mode.
Consider growth of a photon’s density over the active region, (assume  = 1)
S + S = Seg·z
where g is gain.
if z ≪1 then exp (g · z) ≈1 + gz
Using the relation z = vgt (vg−group velocity), one ﬁnds S = Sg · vg · t.
Thus, the generation term can be written as
dS
dt

gen
= Rst = S
t = vggS
Finally, the rate equations used in this section are
dN
dt = ηi
I
qV −N
τ −vgg(N)S
(7.40)
dS
dt = vgg(N)S −S
τp
+ βspRsp
(7.41)
We have explicitely indicated that gain g depends on a carrier’s concentration.

184
Optical sources
7.3.3 Rate equation parameters
Other important parameters which in the simple model can be taken as constants, in fact
have complicated dependencies. Those parameters are:
1. the carrier’s lifetime τ which strongly depends on carrier’s density. Typical dependence
is shown below:
1
τ = A + BN + CN2
where coefﬁcient A describes non-radiative processes, B is responsible for spontaneous
recombination and C describes non-radiative Auger recombinations.
2. photon lifetime τp which is
1
vgτp
= αi + αm = gth
Here αm describes mirror reﬂectivity
αm = 1
L ln 1
R
and αi account for all losses.
The meaning of all parameters appearing in rate equations and gain models is summarized
in Table 7.2 along with typical values for those symbols. The parameters were collected
from [30], [31] and [32].
In the following, rate equations will provide a starting point for analysis of dynamical
properties of semiconductor lasers. Before we start detailed analysis based on rate equations,
we will establish a rate equation for electric ﬁeld.
7.3.4 Derivation of rate equation for electric field
The relevant equation will be derived starting from the wave equation. We concentrate on
Fabry-Perot lasers. The starting wave equation is
∇2E(r,t) −1
c2
∂2
∂t2 E(r,t) = μ0
∂2
∂t2 P(r,t)
(7.42)
Assume the following decomposition:
E(r,t) = aEt(x, y) sin (βzz) E(t)ejωt
(7.43)
where a is a unit vector describing polarization, βz propagation constant in the z-direction.
The transversal ﬁeld Et(x, y) obeys the following equation:
 ∂2
∂x2 + ∂2
∂y2

Et(x, y) = −κ2
t Et(x, y)
(7.44)
It is further assumed that E(t) is slowly varying compared to ejωt. Substituting solution
(7.43) into (7.42), neglecting fast-varying terms in time and using (7.44), one obtains

κ2
t −β2
z −1
c2

2jω∂E(t)
∂t
−ω2E(t)

aEt(x, y) sin (βzz) e jωt = μ0
∂2
∂t2 P(r,t)

185
Rate equations
Table 7.2 Basic parameters appearing in rate equation approach and their typical values.
Symbol
Description
Value and unit
N
carrier density
cm−3
S
photon density
cm−3
I
current
mA
q
elementary charge
1.602 × 10−19C
L
cavity length
250 µm
w
width of active region
2 µm
d
thickness of active region
80 ˚A
ηi
fraction of the injected current
I into active region
0.8
Vactive
volume of active region
L · w · d
τ
carrier lifetime
2.71ns
vg
group velocity
c/nref
nre f
refractive index
3.4
τp
photon lifetime
2.77 ps

conﬁnement factor
0.01
βsp
spontaneous emission factor
10−4
a
differential gain (linear model)
5.34 × 10−16 cm2
Ntr
carrier density at transparency
3.77 × 1018 cm−3
Ith
current at threshold
1.11 mA
αm
facet loss
45 cm−1
λph
laser wavelength
1.3 µm
To evaluate terms on the right hand side, we need to account for a nonlocal relation between
polarization and susceptibility:
P(r,t) = ε0

χ(r,t′)E(r,t −t′)dt′
(7.45)
In the above E(r,t −t′) is given by (7.43). As E(t) is slowly varying in time, we can expand
it into Taylor series around t. The general formula for Taylor expansion of the function
f (x) around a is f (x) = f (a) + df
dx (x −a). In our case, substituting x = t −t′ and a = t,
we obtain
E(t −t′) ≈E(t) + dE(t)
dt
(−t′)
Full electric ﬁeld is therefore
E(r,t −t′) = Et(x, y) sin (βzz) E(t −t′)e jω(t−t′)
Substituting the last result and Taylor expansion for E(t−t′) into expression for polarization
(7.45), one ﬁnally obtains the wave equation for E(t):

−β2
0 + ω2
c2 εr(ω)

E(t) −2jω
c2

εr(ω) + 1
2ωdεr(ω)
dω
 dE(t)
dt
= 0
(7.46)

186
Optical sources
Here εr(r, ω) = 1 + χ(r, ω) and Fourier transform of susceptibility is (we have dropped r
dependence)
χ(ω) =

dt′χ(t′)e−jωt′
Susceptibility is further separated into terms which account for various physical effects as
follows:
χ(ω) = 1 + χb + χp −jχloss
where χb = χ′
b + jχ′′
b is due to background, χp = χ′
p + jχ′′
p is induced by pump and
χloss accounts for losses. The relative dielectric constant is written as (dropping argument
dependencies) εr = ε′
r + jε′′
r . The real part of εr is approximated in terms of refractive
index ε′
r = (n0 + np)2 ≈n2
0 + 2n0np, where n0 is the background refractive index and
np is the change induced by pump. Using the above results, εr takes the form
εr = ε′
r + jε′′
r ≈n2
0 + 2n0np + jε′′
r
= 1 + χ′
b + χ ′
p + j
(
χ′′
b + χ ′′
p −χloss
)
(7.47)
Explicitly, one has the following identiﬁcations:
1 + χ′
b = n2
0
χ′
p = 2n0np
χ′′
b + χ′′
p −χloss = ε′′
r
Using the above relations, the term in the equation for slowly varying amplitude E(t),
Eq. (7.46) is
ω2
c2 εr(ω) −β2
0 = ω2 −ω2
0
c2
n2
0 + ω2
c2 χ′
p + j ω2
c2
(
χ′′
b + χ ′′
p −χloss
)
(7.48)
where we have used the approximate relation
β0 ≈ω0
c n0
Imaginary parts of background and pump susceptibilities are related to gain via an experi-
mental relation
ω
cn0
(
χ′′
b + χ ′′
p
)
= g(N)
where g(N) is gain. Assume also
χloss = ω
cn0
αloss
With the last two relations, term given by Eq. (7.48) can be expressed as
ω2
c2 εr(ω) −β2
0 = ω2 −ω2
0
c2
n2
0 + ω2
c2 2n0np + j ωn0
c
[g(N) −αloss]

187
Analysis based on rate equations
Using n2(ω) = εr(ω), the dispersion term in (7.46) is evaluated as
εr(ω) + 1
2ωdεr(ω)
dω
= n2(ω) + 1
2ωn(ω)dn(ω)
dω
= n(ω) + ωng(ω)
(7.49)
where we have deﬁned group index ng(ω) as
ng(ω) = n(ω) + ωdn(ω)
dω
(7.50)
Using the results (7.48) and (7.49), Eq. (7.46) is
dE(t)
dt
=

−j (ω −ω0) n0
ng
−j ω
ng
np + 1
2vg [g(N) −αloss]

E(t)
(7.51)
where we approximated ω2 −ω2
0 = (ω −ω0) (ω + ω0) ≃2ω (ω −ω0) and also n0(ω)
n(ω) ≃1
and used the relation c
ng = vg. Our Eq. (7.51) is very similar to Eq. (6.2.9) of Agrawal and
Dutta [9].
7.4 Analysis based on rate equations
Rate equations just introduced will now be used to study some dynamical properties of
semiconductor lasers. We start with steady-state.
7.4.1 Steady-state analysis
In this situation one has no change in time; i.e.
dN
dt = dS
dt = 0
Rate equations take the form
ηi
I0
qV −N0
τ −vgg(N0)S0 = 0
(7.52)
and
vgg(N0)S0 −S0
τp
+ βspRsp = 0
(7.53)
If in the last equation we neglect the small spontaneous emission term, we obtain an
expression for a photon life-time
1
τp
= vgg(N0)
(7.54)

188
Optical sources
7.4.2 Small-signal analysis with the linear gain model
When neglecting spontaneous emission and using linear gain model where gain is given by
g = a (N −Ntr), one obtains
dN
dt = ηi
I
qV −N
τ −vga (N −Ntr) S
(7.55)
and
dS
dt = vga (N −Ntr) S −S
τp
(7.56)
Assume that all time-dependent quantities oscillate as
I = I0 + i(ω)ejωt
N = N0 + n(ω)e jωt
S = S0 + s(ω)ejωt
where ω is the angular frequency of an external (small) perturbation and I0 is the bias value
of current. Here N0 and S0 are the solutions in the steady-state. Substitute into the ﬁrst rate
equation and after multiplication and neglecting second-order term (n(ω)s(ω)) one obtains
jωn(ω)ejωt =
ηi
qV

I0 + i(ω)ejωt
−N0
τ −1
τ n(ω)ejωt
−vga

(N0 −Ntr) S0 + (N0 −Ntr) s(ω)ejωt+S0n(ω)ejωt
+ O(n2)
Using steady-state results, expression (7.54) for photon life-time and dropping e jωt depen-
dence, one ﬁnally obtains
jωn(ω) = ηi
qV i(ω) −n(ω)
τ
−s(ω)
τp
−vgaS0n(ω)
(7.57)
The second equation for photons is obtained in a similar way. Substituting small-signal
expressions, neglecting the second-order term, using the photon life-time expression and
ﬁnally dropping ejωt dependence, one obtains
jωs(ω) = vgaS0n(ω)
(7.58)
From the above equations, we want to determine modulation response which is deﬁned as
[33], [34]
M(ω) = s(ω)
i(ω)
Expressing n(ω) from Eq. (7.58) and substituting into (7.57), one obtains
s(ω)
i(ω) =
ηi
eV vgaS0
D(ω)
where D(ω) is given by
D(ω) = −ω2 + jω
1
τ + vgaS0

+ vgaS0
τp

189
Analysis based on rate equations
Deﬁne response function as
r(ω) =

s(ω)
i(ω)
 =
ηi
eV vgaS0
|D(ω)|
If we write D(ω) = a + jb, we have |D(ω)|2 = a2 + b2. Therefore
|D(ω)|2 =

ω2 −vgaS0
τp
2
+ ω2
1
τ + vgaS0
2
We will see soon that the response function has a peak at frequency fR. To ﬁnd that
frequency, we evaluate ﬁrst derivative ∂|D(ω)|2
∂ω2
and set it to zero. Explicitly
∂|D(ω)|2
∂ω2

ω=ωR
= −2
vgaS0
τp
−ω2
R

−1
2
1
τ + vgaS0

= 0
From the above
ω2
R = vgaS0
τp
−1
2
1
τ + vgaS0

(7.59)
which is known as a relaxation-oscillation frequency and it describes the rate at which energy
is exchanged between photon system and carriers. The second term in (7.59) is usually very
small and can be neglected. Relaxation-oscillation frequency is thus approximated as
ωR =

1
τp
S0vga
1 + εS0
(7.60)
To estimate the typical values of the relaxation-oscillation frequency, let us assume [1]:
L = 300 µm, τph ≈10−12s and τ ∼4 × 10−9s. One ﬁnds AP0 ∼109 s−1. So, the
zeroth-order expression is a very good one.
Using MATLAB code and parameters shown in Listings 7A.1.1 and 7A.1.2, one obtains
the results shown in Fig. 7.20.
7.4.3 Small-signal analysis with gain saturation
Let us remind ourselves of the rate equations which were established in the previous section:
dN
dt = ηi
I
qV −N
τ −vgg(N)S
(7.61)
dS
dt = vgg(N)S −S
τp
+ βspRsp
(7.62)
Use small-signal assumptions
I(t) = I0 + i(t)
N(t) = N0 + n(t)
S(t) = S0 + s(t)
Also, generalize the gain model to include saturation as follows:
g(n) = g0 + g′ (N −N0)
1 + ϵS

190
Optical sources
10
−2
10
−1
10
0
10
1
10
2
−20
−10
0
10
20
30
frequency [GHz]
Response function [dB]
10 μW
1 mW
10 mW
0.1W
1W
Fig. 7.20
Modulation characteristics of semiconductor lasers from small-signal analysis.
where g′ =
∂g
∂N

N=N0 is differential gain evaluated at N = N0 and g0 = g(N0). The factor
1 + ϵS introduces nonlinear gain saturation. The gain compression parameter ϵ has a small
value and the term ϵS is small compared with the one even at very high optical power. The
effect of this term on dc properties is small and can be neglected. However, it signiﬁcantly
affects dynamics of a semiconductor laser. The reason is that the laser’s dynamics depends
on the small difference between gain and cavity loss. This difference is only about a few
percent. Therefore, even small gain compression due to ϵ produces signiﬁcant effect.
Evaluate the gain compression term as follows:
1 + ϵS = 1 + ϵ (S0 + s(t)) = (1 + ϵS0)

1 +
ϵs(t)
1 + ϵS0

With the above result, gain can be approximated as
g(n) =
g0
1 + ϵS0
+ g′n(t)
1 + ϵS0
−
g0
1 + ϵS0
ϵs(t)
1 + ϵS0
(7.63)
Using the above results, stimulated emission term takes the form
g(n)S =
g0S0
1 + ϵS0
+
g′S0
1 + ϵS0
n(t) −
g0S0
(1 + ϵS0)2 ϵs(t) +
g0
1 + ϵS0
s(t) + O(s2)
(7.64)
As usual, the following analysis is separated into two parts: dc and ac analysis.
dc analysis
With the assumption that d
dt = 0 from rate equations, one obtains
ηi
I0
qV −N0
τ −vg
g0S0
1 + ϵS0
= 0

191
Analysis based on rate equations
and
vg
g0S0
1 + ϵS0
−S0
τp
+ βspRsp = 0
Neglecting spontaneous emission (βsp = 0), from the second equation one obtains an
expression for the photon life-time τp:
1
τp
= vg
g0
1 + ϵS0
(7.65)
ac analysis
Substitute small-signal assumptions into rate equations, use an approximation for stim-
ulated emission (7.64) and eliminate dc terms. The results are
dn(t)
dt
= ηi
i(t)
qV −n(t)
τ
−vgg′S0
1 + ϵS0
n(t) +
1
τp
S0
1 + ϵS0
ϵs(t) −
1
τp s(t)
ds(t)
dt
= vgg′S0
1 + ϵS0
n(t) −1
τp
S0
1 + ϵS0
ϵs(t)
In the above equations we used expression (7.65). Those equations can be written in matrix
form:
d
dt
n(t)
s(t)

+
A
B
−C
D
 n(t)
s(t)

=
!
ηi
i(t)
qV
0
"
where
A = 1
τ + vgS0g′
1 + ϵS0
,
B =
1
τp −
1
τp
S0
1 + ϵS0
ϵ,
C = vgS0g′
1 + ϵS0
,
D = 1
τp
S0
1 + ϵS0
ϵ
Assuming harmonic time dependence of the form exp ( jωt), the matrix equation is
jω + A
B
−C
jω + D
 n(t)
s(t)

=
!
ηi
i(t)
qV
0
"
Solving the above system, one obtains modulation response which is expressed as
s(t)
i(t) = ηi
1
qV
C
H(ω)
where
H(ω) = ( jω + A) ( jω + D) + CB
The function H(ω) can be written as
H(ω) = −ω2 + jωγ + ω2
R
Here ωR is the relaxation-oscillation frequency and γ is the damping factor. One deﬁnes
modulation response r(ω) as [30]
r(ω) = H(ω)
H(0)

192
Optical sources
10
−1
10
0
10
1
10
2
−20
−15
−10
−5
0
5
10
15
20
frequency [GHz]
Response function [dB]
   = 0
   = 1.5 × 10−17 
   = 5 × 10−17 
Fig. 7.21
The effect of gain compression on modulation response.
The plot of response r(ω) is shown in Fig. 7.21 for three values of ϵ. The effect of gain
compression parameter ϵ is clearly visible. MATLAB code used to obtain those results is
provided in Listings 7A.2.1 and 7A.2.2.
7.4.4 Large-signal analysis for QW lasers
Large-signal analysis based on rate equations for semiconductor lasers has been reported
extensively [35], [36], [37]. Main equations without spontaneous emission are
dN
dt = ηi
I
eV −N
τ −vgg (N) · S
(7.66)
dS
dt =  · vgg (N) · S −S
τp
(7.67)
All symbols have been explained previously and their values are summarized in Table 7.2.
Typical results for step current are shown in Fig. 7.22. MATLAB code used to obtain
those results is provided in Appendix, Listings 7A.3.1 and 7A.3.2.
One can observe that when we neglect spontaneous emission term in the rate equation
for photons, photon density tends to zero (steady-state value) as t −→∞, the result which
is also evident from the steady-state analysis.
7.4.5 Frequency chirping
Frequency chirping arises during direct modulation of semiconductor laser when carrier
density undergoes abrupt change. As a result, material gain also changes. This change
results in a variation of the refractive index, which in turn affects the phase of the electric
ﬁeld.

193
Analysis based on rate equations
0
0.5
1
1.5
2
0
0.2
0.4
0.6
0.8
1
time [ns]
Arbitrary units
carrier density
photon density
Fig. 7.22
Numerical solutions of large-signal rate equations after applying rectangular current pulse att = 0. Normalized
values of electron density N(t) and photon density S(t) are shown.
The rate of change of the phase is
dφ
dt = 1
2vαH (g −αloss)
An associated change in frequency is created which is described by
ν(t) = 1
2π
dφ
dt = 1
4π vαenh (g −αloss)
This change in frequency is called ‘chirp’. During direct modulation it results in a shift in
frequency of the order of 10–20 GHz.
To eliminate chirp effect, an external modulator should be used. In such cases a laser
produces constant output power and a separate modulator provides modulation.
Another way to reduce chirp is to fabricate devices with small values of line-width
enhancement factors αH.
αH ≡−
dnr
dN
dni
dν
where n = nr + jni (complex refractive index).
7.4.6 Equivalent circuit models
Often in engineering practice there is a need to operate with circuit models, instead of more
complicated physical-based models. Here we outline the method of constructing such a
model for a semiconductor laser.

194
Optical sources
7.4.7 Equivalent circuit model for a bulk laser
Equivalent circuit models of semiconductor lasers provide further understanding of the
laser properties. They are derived from rate equations. Development of those models was
initialized a long time ago [38], [39], [40]. More recent works which also include additional
effects like carrier transport or proper representation of optical gain, are [41], [42], [43]. In
the following, we outline the creation of equivalent circuit model for a bulk semiconductor
laser following Kibar et al. [41].
For bulk lasers, rate equations are [41], [9]
dS
dt
= (G −γ ) S + Rsp
(7.68)
dN
dt
= I
q −γeN −G · S
(7.69)
Here N, S are the total number of electrons inside the cavity and total number of photons in
the lasing mode. Those are dimensionless quantities. We introduce small deviations from
equilibrium as
S(t) = S0 + δS(t)
(7.70)
N(t) = N0 + δN(t)
(7.71)
Optical gain is approximated as
G = G0 + ∂G
∂N δN + ∂G
∂S δS = G0 + GNδN + GSδS
(7.72)
In the steady-state one obtains
0 = (G0 −γ ) S0 + Rsp,0
0 = I0
q −γeN0 −G0 · S0
Observing that spontaneous emission Rsp = Rsp(N) depends on N, and performing an
expansion
Rsp = Rsp,0 + ∂Rsp
∂N δN
(7.73)
one can derive small-signal equations
dδS
dt
= −SδS + σNδN
(7.74)
dδN
dt
= −NδN −σSδS
(7.75)
where
S = Rsp
S0
−S0GS,
N = γe + N0
∂γe
∂N + S0GN
(7.76)
and
σN = S0GN + ∂Rsp
∂N ,
σS = G0 + S0GS
(7.77)

195
Analysis based on rate equations
C
L
RN
RS
iL
iC
iR
Fig. 7.23
Equivalent circuit model for a bulk laser.
Using these equations, one creates equivalent circuit model. It is based on an observation
that the small-signal rate equations are similar to the voltage and current equations of
the RLC circuit. We therefore assume (following Kibar et al., [41]) that electrons in a
laser cavity can be represented by the charge across a capacitor and the photons are
represented by the magnetic ﬂux of an inductor. Formally one introduces the following
equivalence:
δS(t) =
φ(t)
q · unit ,
δN(t) = Q(t)
q
(7.78)
where q is an electron’s charge, unit is a parameter in [ H
s ] to ensure proper units for the
components of the electrical circuit and φ(t) is the magnetic ﬂux in [W b]. We also recall
standard relations from electromagnetism:
Q = C · vC
(7.79)
iC = dQ
dt
(7.80)
φ(t) = L · iL
(7.81)
vL = dφ
dt
(7.82)
Now, we use (7.78) and relations (7.79)–(7.82) to convert small-signal equations (7.74) and
(7.75) into voltage and current relations. After simple algebra, from (7.74) one ﬁnds
vL(t) = −S · L · iL(t) + σN · C · unit · vC
(7.83)
This equation can be identiﬁed with loop equation for the RLC circuit shown in Fig. 7.23.
A loop equation gives
vC = vL + vRp
(7.84)
In order for the above equations to be identical, one makes the following identiﬁcations:
RS = S · L = S · unit
σS
,
C =
1
unit · σN
(7.85)

196
Optical sources
Similarly, from (7.75) one obtains
iC(t) = −N · C · vC(t) −σS
unit · L · iL(t)
(7.86)
That equation can be compared with the node equation from a circuit in Fig. 7.23:
iC = −iR −iL
(7.87)
For those equations to be identical, one sets
RN =
1
N · C ,
and
L = unit
σS
(7.88)
One also has the following equivalence:
δN = C · vC
q
,
and
δS =
L · iL
q · unit
(7.89)
7.5 Problems
1.
Perform large-signal analysis for the log gain model described by Eq. (7.27).
2.
Analyse large-signal response to a Gaussian pulse.
3.
Based on rate equations for multimode operation, create the small-signal equivalent
circuit model of a semiconductor laser. Draw the corresponding electrical circuit and
derive equations which establish links between circuit parameters and rate equations.
Hint: Consult the paper by Kibar et al. [41].
4.
Construct equivalent circuit model for single quantum well laser with carrier transport
(follow Lau’s work in [42]). Introduce carrier density in an SCH region and allow for
its interaction with densities in the quantum well.
7.6 Project
1. Conduct multimode analysis of a semiconductor laser. Formulate multimode rate equa-
tions. Gain spectrum approximate as described by Coldren and Corzine [4].
Appendix 7A: MATLAB listings
In Table 7.3 we provide a list of MATLAB ﬁles created for Chapter 7 and a short description
of each function.

197
Appendix 7A
Table 7.3 List of MATLAB functions for Chapter 7.
Listing
Function name
Description
7A.1.1
small signal.m
Small-signal analysis
7A.1.2
param rate eq bulk.m
Parameters for bulk active region in rate eqs.
7A.2.1
small epsilon.m
Small-signal response with gain compression
7A.2.2
param rate eq QW.m
Parameters for QW active region in rate eq.
7A.3.1
large signal.m
Large-signal analysis
7A.3.2
eqs large.m
Deﬁnes rate equations for large-signal analysis
Listing 7A.1.1
Program small signal.m. MATLAB program to perform small-signal anal-
ysis for a quantum well semiconductor laser.
% File name: small_signal.m
% Purpose:
% Determines response function
clear all
param_rate_eq_bulk
% input data
%
% loop over frequency in GHz
N_max = 5000;
% number of points for plot
f_min = 0.01; f_max = 100;
freq_GHz = linspace(f_min,f_max,N_max); % From 0.1 to 2 GHz
semilogx(freq_GHz,0);
%
freq = freq_GHz*1d9;
% convert frequency to 1/s
omega = 2*pi*freq;
%
hold on
for power_out = [1d-4 1d-3 0.01 0.1 1.0]
% values of output power [W]
% Determine steady-state photon density from a given output power
S_zero = 2*power_out/(v_g*alpha_m*h_Planck*freq_ph*V_p);
%
% Construct denominator
D = - omega.^2 + 1j*omega*(1/tau +v_g*a*S_zero) + v_g*a*S_zero/tau_p;
%
response = (v_g*a*S_zero/tau_p)./abs(D);
response_dB = 10*log(response);
%
h = semilogx(freq_GHz,response_dB);
end
xlabel(’frequency [GHz]’,’FontSize’,14);
% size of x label
ylabel(’Response function [dB]’,’FontSize’,14);
% size of y label

198
Optical sources
set(gca,’FontSize’,14);
% size of tick marks on both axes
axis([f_min f_max -20 35]);
text(0.05, 7, ’10 \muW’,’Fontsize’,14)
text(0.2, 18, ’1 mW’,’Fontsize’,14)
text(0.6, 27, ’10 mW’,’Fontsize’,14)
text(2.5, 33, ’0.1W’,’Fontsize’,14)
text(8, 26, ’1W’,’Fontsize’,14)
pause
close all
Listing 7A.1.2
Function param rate eq bulk.m. Function contains parameters for the rate
equation model for the bulk active region.
% File name: param_rate_eq_bulk.m
% Purpose:
% Contains parameters for rate equation model for bulk
% active region
% Source
% G.P. Agrawal and N.K. Dutta
% Long-wavelength semiconductor lasers
% Van Nostrand 1986
% Table 6.1, p. 227
%
% General constants
c = 3d10;
% velocity of light [cm/s]
q = 1.6021892d-19;
% elementary charge [C]
h_Planck = 6.626176d-34;
% Planck constant [J s]
hbar = h_Planck/(2.0*pi);
% Dirac constant [J s]
% Geometrical dimensions bulk active region
length = 250d-3;
% cavity length [cm]; 250 microns
width = 2d-3;
% active region width [cm]; 2 microns
thickness = 0.2d-3;
% thickness of an active region [cm]; 0.2 microns
volume_active = length*width*thickness;
% volume of active region
%
conf = 0.3;
% confinement factor [dimensionless]
V_p = volume_active/conf;
% cavity volume [cm^3]
ref_index = 3.4;
% effective mode index
%
v_g = c/ref_index;
% group velocity [cm/s]
tau_p = 1.6d-12;
% photon life-time [s]
tau = 2.2d-9;
% carrier life-time [2.71 ns]
%
a = 2.5d-16;
% differential gain (linear model) [cm^2]
% Parameters needed to determine output power
alpha_m = 45;
% mirror reflectivity [cm^-1]
lambda_ph = 1.3d-3;
% laser wavelength [microns]; 1.3 microns
freq_ph = v_g/lambda_ph;
% phonon frequency

199
Appendix 7A
Listing 7A.2.1
Function small epsilon.m. Driver program which determines small-signal
response with gain compression for a single quantum well. For large-signal analysis based
on rate equations.
% File name: small_epsilon.m
% Purpose:
% Determines response function for quantum well with epsilon
clear all
param_rate_eq_QW
% input data
%
% loop over frequency in GHz
N_max = 100;
% number of points for plot
f_min = 0.1; f_max = 100;
freq_GHz = linspace(f_min,f_max,N_max);
% From 0.1 to 2 GHz
semilogx(freq_GHz,0);
% make axis and force log scale
%
freq = freq_GHz*1d9;
% convert frequency to 1/s
omega = 2*pi*freq;
power_out = 0.001;
% output power (10 mW/facet)
%
hold on
for epsilon = [0 1.5d-17 5d-17]
% values of epsilon
% Determine steady-state photon density from a given output power
S_zero = 2*power_out/(v_g*alpha_m*h_Planck*freq_ph*V_p);
%
% Construct denominator
A = 1/tau + v_g*S_zero*a/(1+epsilon*S_zero);
B = 1/(conf*tau_p) - (1/(conf*tau_p))*S_zero*epsilon/(1+epsilon*S_zero);
C = conf*v_g*S_zero*a/(1+epsilon*S_zero);
D = (1/tau_p)*S_zero*epsilon/(1+epsilon*S_zero);
damping = A + D;
omega_R2 = A*D + C*B;
H = - omega.^2 + 1j*omega.*damping + omega_R2;
%
response = (A*D+C*B)./abs(H);
response_dB = 10*log(response);
h = plot(freq_GHz,response_dB);
end
xlabel(’frequency [GHz]’,’FontSize’,14);
% size of x label
ylabel(’Response function [dB]’,’FontSize’,14);
% size of y label
set(gca,’FontSize’,14);
% size of tick marks on both axes
axis([f_min f_max -20 20]);
text(2, 13, ’\epsilon = 0’,’Fontsize’,14)
text(2, 10, ’\epsilon = 1.5 \times 10^{-17}’,’Fontsize’,14)
text(2, 7, ’\epsilon = 5 \times 10^{-17}’,’Fontsize’,14)
pause
close all

200
Optical sources
Listing 7A.2.2
Function param rate eq QW.m. Function which contains rate equation
parameters for a single quantum well.
% File name: param_rate_eq_QW.m
% Purpose:
% Contains parameters for rate equation model for QW active region
% Source
% L.A. Coldren and S.W. Corzine,
% "Diode Lasers and Photonic Integrated Circuits", Wiley 1995.
% General constants
c = 3d10;
% velocity of light [cm/s]
q = 1.6021892d-19;
% elementary charge [C]
h_Planck = 6.626176d-34;
% Planck constant [J s]
hbar = h_Planck/(2.0*pi);
% Dirac constant [J s]
% Geometrical dimensions
% QW active region
L = 250d-4;
% cavity length [cm];
250 microns
w = 2d-4;
% active region width [cm];
2 microns
d = 80d-8;
% thickness of an active region [cm];
80 Angstroms
%
%V = L*w*d;
V = 4d-12;
% volume of active region
%
conf = 0.03;
% confinement factor [dimensionless]
V_p = V/conf;
% cavity volume [cm^3]
ref_index = 4.2;
% effective mode index
%
v_g = c/ref_index;
% group velocity [cm/s]
tau_p = 2.77d-12;
% photon life-time [s]
tau = 2.71d-9;
% carrier life-time [s]
beta_sp = 0.8d-4;
% spontaneous emission factor
%
a = 5.34d-16;
% differential gain (linear model) [cm^2]
N_tr = 1.8d18;
% carrier density at transparency [cm^-3]
eta_i = 0.8;
epsilon = 1d-17;
current_th = 1.11d-3;
% current at threshold [A]; 1.11 mA
%
% Parameters needed to determine output power
alpha_m = 45;
% mirror reflectivity [cm^-1]
lambda_ph = 1.3d-3;
% laser wavelength [microns]; 1.3 microns
freq_ph = v_g/lambda_ph;
% phonon frequency

201
Appendix 7A
Listing 7A.3.1
Function large signal.m. Driver program for large-signal analysis based
on rate equations.
% File name: large_signal.m
% Purpose:
% Driver which controls computations for large signal rate equations
% function z = large_signal
%
clear all
tspan = [0 2d-9];
% time interval, up to 2 ns
y0 = [0, 0];
% initial values of N and S
%
[t,y] = ode45(’eqs_large’,tspan,y0);
%
size(t);
t=t*1d9;
y_max = max(y);
y1 = y_max(1);
y2 = y_max(2);
h = plot(t,y(:,1)/y1,’-.’, t, y(:,2)/y2);
% divided to normalize
set(h,’LineWidth’,1.5);
% thickness of plotting lines
xlabel(’time [ns]’,’FontSize’,14);
% size of x label
ylabel(’Arbitrary units’,’FontSize’,14);
% size of y label
set(gca,’FontSize’,14);
% size of tick marks on both axes
legend(’carrier density’, ’photon density’)
% legend inside the plot
pause
close all
Listing 7A.3.2
Function eqs large.m. Function deﬁnes rate equations equations for large-
signal analysis.
% File name: eqs_large.m
% Purpose:
% Large signal rate equations are established
% N == y(1)
% S == y(2)
% assumed linear gain model
function ydot = eqs_large(t,y)
%
param_rate_eq_QW
% input of needed parameters
%
current =
3d-2;
% bias current (step function) [A]; 3 mA
A = v_g*a*(y(1) - N_tr)/(1+epsilon*y(2));
ydot(1) = eta_i*current/(q*V) - y(1)/tau - A*y(2);
ydot(2) = conf*A*y(2) - y(2)/tau_p + conf*beta_sp*y(1)/tau;
ydot = ydot’;
% must return column vector

202
Optical sources
References
[1] A. Yariv. Quantum Electronics. Third Edition. Wiley, New York, 1989.
[2] C. C. Davis. Lasers and Electro-Optics. Fundamentals and Engineeing. Cambridge
University Press, Cambridge, 2002.
[3] B. Mroziewicz, M. Bugajski, and W. Nakwaski. Physics of Semiconductor Lasers.
Polish Scientiﬁc Publishers/North-Holland, Warszawa, Amsterdam, 1991.
[4] L. A. Coldren and S. W. Corzine. Diode Lasers and Photonic Integrated Circuits.
Wiley, New York, 1995.
[5] J. Carroll, J. Whiteaway, and D. Plumb. Distributed Feedback Semiconductor Lasers.
The Institution of Electrical Engineers, London, 1998.
[6] E. Kapon, ed. Semiconductor Lasers. Academic Press, San Diego, 1999.
[7] D. Sands. Diode Lasers. Institute of Physics Publishing, Bristol and Philadelphia,
2005.
[8] C. W. Wilmsen, H. Temkin, and L. A. Coldren, eds. Vertical-Cavity Surface-Emitting
Lasers. Cambridge University Press, Cambridge, 1999.
[9] G. P. Agrawal and N. K. Dutta. Semiconductor Lasers. Second Edition. Kluwer
Academic Publishers, Boston/Dordrecht/London, 2000.
[10] M. G. A. Bernard and G. Duraffourg. Laser conditions in semiconductors. Physica
Status Solidi, 1:699–703, 1961.
[11] G. Keiser. Optical Fiber Communications. Third Edition. McGraw-Hill, Boston,
2000.
[12] S.-L. Chuang. Physics of Optoelectronic Devices. Wiley, New York, 1995.
[13] J.-M. Liu. Photonic Devices. Cambridge University Press, Cambridge, 2005.
[14] G. Lasher and F. Stern. Spontaneous and stimulated recombination radiation in semi-
conductors. Phys. Rev., 133:A553–63, 1964.
[15] C. J. Hwang. Properties of spontaneous and stimulated emission in GaAs junction
lasers. I. Densities of states in the active regions. Phys. Rev. B, 2:4117–25, 1970.
[16] F. Stern. Calculated spectral dependence of gain in excited GaAs. J. Appl. Phys.,
47:5382–6, 1976.
[17] M. S. Wartak, P. Weetman, T. Alajoki, J. Aikio, V. Heikkinen, N. Pikhin, and P. Rusek.
Optical modal gain in multiple quantum well semiconductor lasers. Canadian Journal
of Physics, 84:53–66, 2006.
[18] S.-L. Chuang. Physics of Photonic Devices. Wiley, New York, 2009.
[19] J. P. Loehr. Physics of Strained Quantum Well Lasers. Kluwer Academic Publishers,
Boston, 1998.
[20] P. S. Zory, Jr., ed. Quantum Well Lasers. Academic Press, Boston, 1993.
[21] T.-A. Ma, Z.-M. Li, T. Makino, and M. S. Wartak. Approximate optical gain formulas
for 1.55 µm strained quaternary quantum well lasers. IEEE J. Quantum Electron.,
31:2934, 1995.
[22] T. Makino. Analytical formulas for the optical gain of quantum wells. IEEE J. Quan-
tum Electron., 32:493–501, 1996.

203
References
[23] S. Balle. Simple analytical approximations for the gain and refractive index spectra
in quantum-well lasers. Phys. Rev. A, 57:1304–12, 1998.
[24] L. D. Westbrook. Measurements of dg/dN and dn/dN and their dependence on photon
energy in λ = 1.5 µm InGaAsP laser diodes. IEE Proceedings J, 133:135–42, 1986.
[25] L. D. Westbrook. Measurements of dg/dN and dn/dN and their dependence on photon
energy in λ = 1.5 µm InGaAsP laser diodes. Addendum. IEE Proceedings J., 134:122,
1987.
[26] H. Ghafouri-Shiraz and B. S. L. Lo. Distributed Feedback Laser Diodes. Wiley,
Chichester, 1996.
[27] M.-C. Amann and J. Buus. Tunable Laser Diodes. Artech House, Boston, 1998.
[28] M. J. Connelly. Semiconductor Optical Ampliﬁers. Kluwer Academic Publishers,
Boston, 2002.
[29] K. J. Ebeling, ed. Integrated Optoelectronics. Springer-Verlag, Berlin, 1989.
[30] R. S. Tucker. High-speed modulation of semiconductor lasers. J. Lightwave Technol.,
3:1180–92, 1985.
[31] M. M.-K. Liu. Principles and Applications of Optical Communications. Irwin,
Chicago, 1996.
[32] M. Ahmed and A. El-Laﬁ. Analysis of small-signal intensity modulation of semicon-
ductor lasers taking account of gain suppression. PRAMANA, 71:99–115, 2008.
[33] R. S. Tucker. High-speed modulation of semiconductor lasers. IEEE Trans. Electron
Devices, 32:2572–84, 1985.
[34] A. Yariv and P. Yeh. Photonics. Optical Electronics in Modern Communications. Sixth
Edition. Oxford University Press, New York, Oxford, 2007.
[35] K. Otsuka and S. Tarucha. Theoretical studies on injection locking and injection-
induced modulation of lase diodes. IEEE J. Quantum Electron., 17:1515, 1981.
[36] D. Marcuse and T.-P. Lee. On approximate analytical solutions of rate equations for
studying transient spectra of injection lasers. IEEE J. Quantum Electron., 19:1397,
1983.
[37] M. S. Demokan and A. Nacaroglu. An analysis of gain-switched semiconductor
lasers generating pulse-code-modulated light with a high bit rate. IEEE J. Quantum
Electron., 20:1016, 1984.
[38] J. Katz, S. Margalit, C. Harder, D. Wilt, and A. Yariv. The intrinsic electrical equivalent
circuit of a laser diode. IEEE J. Quantum Electron., 17:4–7, 1981.
[39] C. Harder, J. Katz, S. Margalit, J. Shacham, and A. Yariv. Noise equivalent circuit of
a semiconductor laser diode. IEEE J. Quantum Electron., 18:333–7, 1982.
[40] R. S. Tucker and D. J. Pope. Circuit modeling of the effect of diffusion on damping in
a narrow-stripe semiconductor laser. IEEE J. Quantum Electron., 19:1179–83, 1983.
[41] O. Kibar, D. Van Blerkom, C. Fan, P. J. Marchand, and S. C. Esener. Small-signal-
equivalent circuits for a semiconductor laser. Applied Optics, 37:6136–9, 1998.
[42] K. Y. Lau. Dynamics of quantum well lasers. In P. S. Zory, Jr, ed., Quantum Well
Lasers, pages 217–75. Academic Press, Boston, 1993.
[43] E. J. Flynn. A note on the semiconductor laser equivalent circuit. J. Appl. Phys.,
85:2041–5, 1999.

8
Optical amplifiers and EDFA
As signals travel in optical communication systems, they are attenuated by optical ﬁbre.
Eventually, after some distance they can become too weak to be detected. One possible way
to avoid this situation is to use optical ampliﬁers to increase the amplitude of the signal.
An optical ampliﬁer is an optical device for amplifying signals propagating over several
channels in optical ﬁbre to compensate for their loss during propagation. Signals also get
distorted, say by presence of noise, and the ampliﬁcation process does not clean them nor
reshape them. The cleaning process is commonly known as regeneration and will not be
discussed here.
In this chapter we will concentrate on optical ampliﬁers. We review their general prop-
erties and will also discuss erbium doped ﬁbre ampliﬁers (EDFA). Semiconductor optical
ampliﬁers (SOA), which are essentially semiconductor lasers without mirrors so they do
not lase, will be discussed in the next chapter.
Possible applications of optical ampliﬁers are illustrated in Fig. 8.1. Some of the basic
applications are listed below:
a) as in-line ampliﬁers for power boosting,
b) as pre-ampliﬁers to increase the received power at the receiver,
c) as power ampliﬁers to increase transmitted power,
d) as a power booster in a local area network.
The main types of optical ampliﬁers are:
• doped ﬁbre ampliﬁers
• Raman and Brillouin ampliﬁers, and
• semiconductor optical ampliﬁers.
Issues which will be discussed in relation to those ampliﬁers are: gain and gain bandwidth,
gain saturation, and noise and noise ﬁgure.
In short, the operation and characteristics of all types of ampliﬁers are:
1. population inversion is created, which means that more systems (atoms, molecules) are
in a high energy state than in a lower one,
2. the incoming pulses of signal induce stimulated emission,
3. ampliﬁers saturate above a certain signal power,
4. ampliﬁers add noise to the signal.
In this book we will only describe two types of optical ampliﬁers: semiconductor optical
ampliﬁers (SOA) and erbium doped ﬁbre ampliﬁers (EDFA). Their general characteris-
tics are compared in Table 8.1 where we summarize essential properties of EDFA and
204

205
General properties
Table 8.1 Some properties of EDFA and SOA.
Properties of ampliﬁers
EDFA
SOA
Active medium
Er3+ ion in silica
Electron-hole
in semiconductors
Typical length
Few metres
500 µm
Pumping
Optical
Electrical
Gain spectrum
1.5–1.6 µm
1.3–1.5 µm
Gain bandwidth
24–35 nm
100 nm
Relaxation time
0.1–1 ms
<10–100 ps
Maximum gain
3–50 dB
25–30 dB
Saturation power
>10 dBm
0–10 dBm
Crosstalk
–
For bit rate 10 GHz
Polarization
Insensitive
Sensitive
Noise ﬁgure
3–4 dB
6–8 dB
Insertion loss
<1 dB
4–6 dB
Optics
Pump laser diode couplers,
Antireﬂection coatings,
ﬁbre splice
ﬁbre-waveguide coupling
Integration
No
Yes
Optical fibre
Optical fibre
In-line
amplifier
TX
RX
Optical fibre
TX
RX
Fig. 8.1
Possible applications of optical amplifiers: as an in-line amplifier (top) or as a preamplifier (bottom). TX stands for
transmitter, RX for receiver.
SOA, after Yariv and Yeh [1] (reproduced with permission). Next, we will discuss general
characteristics of optical ampliﬁers.
Some books on the subject are: Desurvire [2], Becker et al. [3] and Bjarklev [4].
8.1 General properties
Ampliﬁcation in optical ampliﬁers is through stimulated emission (the same as in lasers).
One can therefore consider similar characteristic parameters, like gain and its spectrum,
bandwidth, etc. We will discuss them in some detail.

206
Optical amplifiers and EDFA
8.1.1 Gain spectrum and bandwidth
To model gain, one typically starts with a homogeneously broadened two-level system.
Local gain coefﬁcient for such system is [5]
g (ν, P) =
g0
1+ (ν−ν0)2
ν2
0
+ P
Psat
(8.1)
where g0 is the peak value of the unsaturated gain, ν0 atomic transition frequency, ν0 3-dB
local gain bandwidth, Psat saturation power and P and ν are optical power and frequency of
the ampliﬁed signal.
Local gain can also be written as
g (ω, P) =
g0
1 + (ω −ω0)2 T 2
2 + P/Psat
(8.2)
where ω = 2πν is the angular frequency and T2 is known as dipole relaxation time [6].
For small signal power one can consider a unsaturated regime deﬁned as P ≪Psat. In
this limit local gain is
g (ω) =
g0
1 + (ω −ω0)2 T 2
2
(8.3)
The following conclusions can be derived from the above equation:
1. maximum gain corresponds to transitions with angular frequency ω = ω0,
2. for ω ̸= ω0 gain spectrum is described by Lorentzian proﬁle,
3. local gain bandwidth, which is deﬁned as the full width at half maximum (FWHM), is
ω0 = 2
T2
(8.4)
Local gain bandwidth ω0 is deﬁned by points in frequency where local gain takes half the
value at the maximum. In terms of frequency it can be written as
ν0 = ω0
2π
=
1
πT2
(8.5)
Let P (z) be the optical power at a distance z from the input end. Its change is described
as
dP(z)
dz
= g(ν, P) · P(z)
(8.6)
Assume a linear device (here for power levels P ≪Psat) where local gain is independent of
the signal power. Integration of the above equation gives
P (z) = P(0) eg·z
(8.7)
where P(0) = Pin is the signal input power. Linear ampliﬁer gain is deﬁned as
G = P(L)
P(0)
(8.8)

207
General properties
where P(L) = Pout is the output power. From the above solution one obtains
G = P (L)
P(0) = egL = exp
⎡
⎣
g0 · L
1 + (ν−ν0)2
ν2
0
⎤
⎦
(8.9)
Ampliﬁer bandwidth B0 is evaluated using the above solution. It is deﬁned by two frequency
points where power drops by 50%, i.e. P3dB = 1
2Pmax(L), which translates into G3dB =
1
2Gmax. Here Gmax is the maximum value of gain evaluated at ν = ν0. In detail
exp
⎡
⎣g0 · L
1 +
B2
0
ν2
0
⎤
⎦= 1
2 exp
⎡
⎣g0 · L
1 +
0
ν2
0
⎤
⎦= 1
2 exp (g0 · L)
where we have introduced 3 −dB bandwidth B0 as B0 = ν −ν0. By the straightforward
algebra, from the above relation one ﬁnds
B0 = ν0

ln 2
g0L −ln 2
(8.10)
Macroscopic bandwidth of the ampliﬁer B0 is smaller than the local gain bandwidth ν0.
8.1.2 Gain saturation
We will now analyse the gain when signal power has large value and saturation effects are
becoming important. Assume that ω = ω0. Substituting Eq. (8.2) into (8.6), one obtains
dP
dz =
g0P
1 + P/Psat
(8.11)
We introduce new variable u = P/Psat and use separation of variables method to integrate
the above equation. One obtains
 uout
uin
1 + u
u
du =
 L
0
g0 dz
where uin = Pin/Psat, uout = Pout/Psat and Pin, Pout are input and output powers, respectively.
L is the length of an ampliﬁer. Gain G is deﬁned as
G = Pout
Pin
(8.12)
One obtains
G = G0 exp

−G −1
G
Pout
PS

(8.13)
where G0 = exp (g0 · L).
In Fig. 8.2 we have plotted saturation gain dependence from Eq. (8.13). MATLAB code
and its description are provided in Appendix, Listings 8A.1.1, 8A.1.2 and 8A.1.3.

208
Optical amplifiers and EDFA
10−2
10−1
100
101
0
0.2
0.4
0.6
0.8
1
Normalized output power, Pout/Psat
Normalized amplifier gain, G/G0
G0 = 10
G0 = 100
G0 = 1000
Fig. 8.2
Saturated normalized amplifier gain G/G0 as a function of the normalized output power for three values of the
unsaturated amplifier gain G0.
8.1.3 Amplifier noise
Signal-to-noise ratio (SNR) of optical ampliﬁers is degraded because spontaneous emission
adds to the signal during its ampliﬁcation. Ampliﬁer noise ﬁgure Fn is deﬁned as [7]
Fn = (SNR)in
(SNR)out
(8.14)
SNR refers to the electrical power generated when the signal is converted to electrical
current by using a photodetector. We model Fn by considering an ideal detector limited only
by a shot noise
(SNR)in = ⟨I⟩2
σ 2s
(8.15)
where ⟨I⟩= RPin is the average photocurrent, R =
q
hν is the responsivity of an ideal detector
with unit quantum efﬁciency, σ 2
s = 2q (RPin)  f is the variance from shot noise and  f is
the detector bandwidth. At the output, we should add spontaneous emission to the receiver
noise
Ssp (ν) = (G −1) nsphν
(8.16)
Here Ssp is the spectral density of the noise induced by spontaneous emission, ν is optical
frequency and nsp is the spontaneous-emission factor or population inversion factor. The
value of nsp is nsp = 1 for ampliﬁers with complete population inversion (all atoms in the
upper state) and nsp > 1 for incomplete population inversion.
For a two-level system
nsp =
N2
N2 −N1
(8.17)

209
Erbium-doped fibre amplifiers (EDFA)
Wavelength (nm)
 
Loss or gain (dB/m)
1480
1500
1520
1540
1560
2
Gain
Absorption
4
6
0
8
10
Fig. 8.3
Absorption and gain spectra of Ge silicate amplifier fibre. Copyright (1991) IEEE. Reprinted, with permission from C. R.
Giles and E. Desurvire, J.LightwaveTechnol., 9, 271 (1991).
where N1 and N2 are the atomic populations in the lower and upper states, respectively.
Total variance of the shot noise plus spontaneous emission noise is thus
σ 2 = 2q (RGPin)  f + 4 (GRPin)

RSsp

 f
(8.18)
All other contributions to the receiver noise are neglected. At the output, the SNR of the
ampliﬁed signal is
(SNR)out = ⟨I⟩2
σ 2 = (RGPin)2
σ 2
≈
GPin
4Ssp f
(8.19)
assuming G ≫1 and we neglected ﬁrst term in (8.18).
Using deﬁnition of Fn, one ﬁnds
Fn = 2nsp
G −1
G
≈2nsp
(8.20)
It shows that even for an ideal ampliﬁer (nsp = 1), ampliﬁed signal is degraded by a factor
of 2 (3 dB). In practice, Fn is in the range 6–8 dB.
8.2 Erbium-doped fibre amplifiers (EDFA)
Experimental data on absorption and gain of an EDFA whose core was codoped with Ge
to increase the refractive index are shown in Fig. 8.3, after Giles and Desurvire [8].
An optical ﬁbre ampliﬁer consists of an optical ﬁbre where ampliﬁcation takes place
which is doped with a rare-earth element, and a pumping light supply system for supplying
pumping light to the optical ﬁbre for ampliﬁcation, see Fig. 8.4. The pumping light supply
system usually includes a semiconductor laser and an optical coupler for guiding the
pumping light into the optical ﬁbre for ampliﬁcation.

210
Optical amplifiers and EDFA
Pump
Isolator
Wavelength-selective
couplers
Signal out
Signal in
980 nm
1550 nm
Erbium fibre
Fig. 8.4
Schematic of EDFA.
980 nm
1530 nm
1530 nm
Non-radiative
(a)
(c)
(b)
Fig. 8.5
Illustration of amplification in EDFA using a three-level model.
1
2
3
32
21
p
p
s
s
σ
σ
φ
φ
Γ
Γ
Fig. 8.6
Illustration of notation for a three-level system.
Erbium-doped ampliﬁers are made by doping a segment of the ﬁbre with erbium and then
exciting the erbium atoms to a high energy level through the introduction of pumping light.
The energy is transferred gradually to signal light passing through the ﬁbre segment during
excitation, resulting in an ampliﬁcation of the signal light upon exit from the ampliﬁer.
Fibre optic ampliﬁers can amplify signal light including one or more wavelengths within a
predetermined wavelength band without converting them into an electrical signal.
Illustration of the ampliﬁcation process in EDFA based on the three-level model is
shown in Fig. 8.5 for the case of a 980 nm pump. A pump photon at a 980 nm wavelength
is absorbed by an erbium ion in the ground state and jumps into the highest energy level.
Then, through a non-radiative decay the ion loses its energy and arrives into a metastable
state. Once there, a photon having wavelength of 1530 nm can force a stimulated transition
of the ion into its ground state, creating one additional photon and an ampliﬁcation.
In this section, we will describe EDFA using a three-level model. We follow Becker
[3]. The model is shown in Fig. 8.6. Level 1 is a ground state, level 2 is known as a

211
Erbium-doped fibre amplifiers (EDFA)
metastable one (it has a long lifetime) and level 3 is an intermediate state. The population
of levels are introduced as N1, N2, N3. The spontaneous transition rates of the ion (transition
probabilities) which include radiative and also non-radiative contributions are denoted as
32 and 21 and correspond to transitions between levels 3 →2 and 2 →1, respectively.
σp is the pump absorption cross section and σs is the signal emission cross section. The
incident light intensity ﬂuxes of pump and signal are denoted by φp and φs, respectively.
They are deﬁned as number of photons per unit time per unit area.
This three-level model represents energy level structure of Er+ which is involved in the
ampliﬁcation process. To obtain ampliﬁcation, we need a population inversion between
levels 1 and 2. Here, we only consider a one-dimensional model where we assume that the
pump and signal intensities and also distribution of Er ions are constant in the transverse
direction.
Based on the above observations, the rate equations for the changes of populations for
all levels are postulated as
dN1
dt
= 21N2 −(N1 −N3) σpφp + (N2 −N1) σsφs
(8.21)
dN2
dt
= −21N2 + 32N3 −(N2 −N1) σsφs
(8.22)
dN3
dt
= −32N3 + (N1 −N3) σpφp
(8.23)
8.2.1 Steady-state analysis
In the steady-state conditions
dN1
dt
= dN2
dt
= dN3
dt
= 0
(8.24)
Also, total population N is assumed to be constant:
N = N1 + N2 + N3
(8.25)
From Eq. (8.23) one obtains
N3 = N1
1
1 + 32
σpφp
(8.26)
In what follows we will assume fast decay from level 3 to level 2; i.e. decay from level
3 is dominant compared to pump rate. Mathematically, the assumption corresponds to the
following condition 32 ≫σpφp. Lifetime of level 3, τ32 is related to transition probability
as τ32 = 1/32. In this limit there is almost no population of level 3, and therefore N3 ≈0.
With those assumptions the system can be effectively considered as consisting of two levels
only which are described by the following equations:
σpφp + σsφs
21 + σsφs
N1 −N2 = 0
(8.27)
N1 + N2 = N
(8.28)

212
Optical amplifiers and EDFA
Solutions by standard methods give for population inversion
N2 −N1 = N
σpφp −21
21 + 2σsφs + σpφp
(8.29)
8.2.2 Effective two-level approach
Keeping the above assumption, i.e. 32 ≫σpφp which allows us to neglect level 3, from
Eq. (8.28) one has
dN1
dt
= −dN2
dt
It is therefore enough to consider only one equation, say for N2; the other population N1
can be found from N1 = N −N2. Following Pedersen et al. [9], to describe the system we
postulate the following equations:
dN2
dt
= −21N2 +

σ (a)
s
N1 −σ (e)
s N2

φs −
+
σ (e)
p N2 −σ (a)
p N1
,
φp
(8.30)
dN1
dt
= 21N2 +

σ (e)
s N2 −σ (a)
s
N1

φs −
+
σ (a)
p N1 −σ (e)
p N2
,
φp
(8.31)
where σ (a)
s
, σ (e)
s , σ (a)
p , σ (e)
p
represent signal and pump cross sections for absorption and
emission, respectively. Assume steady-state and from Eq. (8.30) determine N2:
N2 = N
σ (a)
s
φs + σ (a)
p φp
1
τ +
+
σ (a)
s
+ σ (e)
s
,
φs +
+
σ (a)
p
+ σ (e)
p
,
φp
where we have introduced τ = 1/21. Further, introduce signal Is and pump Ip intensities
as
φs = Is
hνs
,
φp = Ip
hνp
where h is the Planck constant and νs, νp are frequencies of the signal and pump, respectively.
This allows us to write
N2 = N
τ σ (a)
s
hνs Is(z) + τ
σ (a)
p
hνp Ip(z)
τ σ (a)
s
+σ (e)
s
hνs
Is(z) + τ σ (a)
p +σ (e)
p
hνp
Ip(z) + 1
We further assume that N is independent of distance along ﬁbre z. The variation of signal
and pump intensities is described as
dIs(z)
dz
=

σ (e)
s N2 −σ (a)
s
N1

Is(z)
dIp(z)
dz
=
+
σ (e)
p N2 −σ (a)
p N1
,
Ip(z)

213
Gain characteristics of erbium-doped fibre amplifiers
Table 8.2 Typical parameters of a low-noise in-line EDFA.
Parameter
Symbol
Value
Unit
Signal mode area
πw2
1.3 × 10−11
m2
Erbium concentration
Ntot
5.4 × 1024
m−3
Signal overlapping integral
s
0.4
Pump overlapping integral
p
0.4
Signal emission cross section
sse
5.3 × 10−25
m2
Signal absorption cross section
ssa
3.5 × 10−25
m2
Pump absorption cross section
sp
3.2 × 10−25
m2
Signal local saturation power
Pss
1.3
mW
Pump local saturation power
Psp
1.6
mW
8.3 Gain characteristics of erbium-doped fibre amplifiers
We outline a basic approach to evaluate the performance of EDFA. Neglecting ampliﬁed
spontaneous emission (ASE) and assuming copropagation conﬁguration, the equations
describing steady-state are
dIs(z)
dz
= 2πs

σseNme(z)Is(z) −σsaNgr(z)Is(z)

(8.32)
dIp(z)
dz
= 2πpσsaNgr(z)Ip(z)
(8.33)
Nme(z) = Ntot
Is(z)/Iss + Ip(z)/Isp
1 + Ip(z)/Isp + 2Is(z)/Iss
(8.34)
Nme(z) + Ngr(z) = Ntot
(8.35)
In the previous equations Ngr(z) is the population of the ground state, Nme(z) is the pop-
ulation of the metastable state, Ip(z) is the intensity of the pump wave propagating at the
wavelength λp and Is(z) is the intensity of the signal wave propagating at the wavelength
λs in the positive z-direction.
Finally, the overall ampliﬁer gain G is obtained using the following relation:
G = Is(L)
Is(0)
(8.36)
where L is the doped ﬁbre length.
8.3.1 Typical EDFA characteristics
The above equations were solved numerically using parameter values from Table 8.2 [8],
[10], [11]. MATLAB codes are provided in Listings 8A.2.1–8A.4.2.
The variation of gain with ﬁbre length was determined ﬁrst and the results are summarized
in Fig. 8.7 for different values of pump power. MATLAB code is shown in the Appendix,
Listings 8A.2.1–8A.2.4. Constant signal input power of 10µW and constant erbium doping

214
Optical amplifiers and EDFA
0
1
2
3
4
0
2
4
6
8
10
Doped fibre length (m)
Gain (a.u.)
3 mW
5 mW
7 mW
9 mW
Fig. 8.7
Variation of gain versus fibre length for four different values of pump power.
2
3
4
5
6
7
8
0
5
10
15
20
Pump power (mW)
Gain (a.u.)
5 m
10 m
15 m
Fig. 8.8
Variation of gain versus pump power for three different values of fibre length.
density have been assumed. Gain was evaluated for four different pump power levels equal
to 3, 5, 7 and 9 mW. As it is shown, gain increases up to a certain ﬁbre’s length and then
begins to decrease after reaching a maximum point. Similar results were reported in the
literature, compare [10] and [11].
The optimum ﬁbre length (the one which corresponds to a maximum gain) is a few metres
and it increases with the pump power. The reason for the decrease in gain is insufﬁcient
population inversion due to excessive pump depletion.
In Fig. 8.8 we show the variation of gain with pump power for three different values of
ﬁbre lengths of 5, 10 and 15 m and a constant signal input power equal to 1 mW. MATLAB

215
Appendix 8A
code is shown in the Appendix, Listings 8A.3.1 and 8A.3.2. Constant Er doping density
was also assumed. As it is seen, gain of the EDFA increases with the increasing pump
power and then saturates after a certain level of pump power. The pump saturation effect
occurs for input powers in the range 3–6 mW. Consult literature for more discussion of the
obtained results [10] and [11].
8.4 Problems
1.
An EDFA has 20 dB of gain. If the power of incident signal is 150 µW, what is the
output power?
2.
An optical ampliﬁer ampliﬁes an incident signal of 1 µW to 1 mW. Assuming the
saturation power of 20 mW, what will be the output power of 100 µW incident signal
on the same ampliﬁer?
3.
An optical ampliﬁer produces power gain of 1000 over 30 m with a 10 mW pump.
(a) What is the gain exponential coefﬁcient α in nepers per metre? (b) What should
be the length of that ampliﬁer to produce gain of 1500?
4.
Using steady-state ampliﬁer equations and appropriate approximations, derive
an analytical expression for an optimum length of ﬁbre which gives maximum
ampliﬁcation.
8.5 Projects
1. Perform a literature survey on EDFA with noise. Write a MATLAB program to simulate
EDFA with realistic noise.
2. Perform a literature survey on Raman ampliﬁers. Write MATLAB code to simulate
Raman ampliﬁer. Compare Raman ampliﬁer and EDFA.
3. Formulate transient model of EDFA with the saturation effect of the forward and back-
ward ampliﬁed spontaneous emission [12]. Integrate numerically the resulting equations.
Analyse gain saturation and recovery times of an EDFA and the effects on the ampliﬁ-
cation of optical pulses.
Appendix 8A: MATLAB listings
In Table 8.3 we provide a list of MATLAB ﬁles created for Chapter 8 and a short description
of each function.

216
Optical amplifiers and EDFA
Table 8.3 List of MATLAB functions for Chapter 8.
Listing
Function name
Description
8A.1.1
sat gain.m
Creates data for saturated gain
8A.1.2
f sat gain.m
Function used by sat gain.m
8A.1.3
sat plot.m
Function plots saturated gain
8A.2.1
gain variable length.m
Generates date for plots gain vs ﬁbre
length for ﬁxed gain
8A.2.2
edf a param.m
Parameters for EDFA
8A.2.3
edf a eqs.m
Equations for EDFA
8A.2.4
variable length plot.m
Plots gain using data generated by
gain variable length.m
8A.3.1
gain variable pump.m
Generates data for plots gain vs power
for ﬁxed ﬁbre length
8A.3.2
variable gain plot.m
Plots gain using data generated by
gain variable pump.m
Listing 8A.1.1
Function sat gain.m. MATLAB program which generates data for satu-
rated normalized ampliﬁer gain G0. To generate the required data, it must be run three times
for three values of G0. Therefore one should appropriately comment inputs for G0. Each
time a different output ﬁle must be speciﬁed; i.e. the output ﬁle name should be changed.
% File name: sat_gain.m
% Generates data for plots of saturated gain G as a function of
% the output power for three values of the unsaturated amplifier gain G_0
% File must be run three times for three values of G_0
clear all
%
G_0 = 10;
%G_0 = 100;
%G_0 = 1000;
u_init = 1d-2;
Delta_u = 0.5d-1;
u_final = 1d1;
uu = u_init;
yy = fzero(@(y) f_sat_gain(y, u_init, G_0), 0.5);
for u = (u_init + Delta_u):Delta_u:u_final
uu = [uu, u];
y = fzero(@(y) f_sat_gain(y, u, G_0), 0.5);
yy = [yy, y];
end
%
d_u = length(uu);
fid = fopen(’gain_data_10.dat’, ’wt’);
% Open the file.
for ii = 1:d_u

217
Appendix 8A
fprintf (fid, ’ %11.4f %11.4f\n’, uu(ii),yy(ii));
% Print the data
end
status = fclose(fid);
% Close the file.
Listing 8A.1.2
Function f sat gain.m. MATLAB function used by a program which plots
saturated gain.
% defines function used in plot of saturated gain of optical amplifier
function fun = f_sat_gain(y, u, G_0)
fun = y - exp(-(G_0*y-1)*u/(G_0*y));
Listing 8A.1.3
Function sat plot.m. MATLAB function used to plot saturated gain from
ﬁles. It was not possible here to create one MATLAB program which will perform all the
calculations and also to plot all the results. Instead, we had to run sat gain.m three times
for three different values of G0, output the results to data ﬁles and then plot ﬁnal results
using a separate program.
% File_name: sat_plot.m
% Plots graph of saturated gain using data generated by sat_gain.m
clear all
fid = fopen(’gain_data_10.dat’);
a_10 = fscanf(fid,’%f %f’,[2 inf]); % It has two rows
fclose(fid);
%
fid = fopen(’gain_data_100.dat’);
a_100 = fscanf(fid,’%f %f’,[2 inf]); % It has two rows
fclose(fid);
%
fid = fopen(’gain_data_1000.dat’);
a_1000 = fscanf(fid,’%f %f’,[2 inf]); % It has two rows
fclose(fid);
%
semilogx(a_10(1,:),a_10(2,:),’k-’, a_100(1,:),a_100(2,:),’k--’,...
a_1000(1,:),a_1000(2,:),’k-.’,’LineWidth’,1.5)
%
xlabel(’Normalized output power, P_{out}/P_{sat}’,’FontSize’,14);
ylabel(’Normalized amplifier gain, G/G_0’,’FontSize’,14);
legend(’G_0 = 10’,’G_0 = 100’,’G_0 = 1000’)
set(gca,’FontSize’,14);
% size of tick marks on both axes
pause
close all

218
Optical amplifiers and EDFA
Listing 8A.2.1
Function gain variable length.m. MATLAB function used to compute
gain versus ﬁbre length for a ﬁxed value of pump power.
% File name: gain_variable_length.m
% Computation of gain vs fibre length for fixed value of pump power
% User selects pump power which is controlled by P_p
% Calculations are repeated for P_p = 3,5,7,9 d-3 Watts
% User should also appropriately rename output file ’gain_P_3.dat’
% based on Iannone-book, p.86
% P_s
== y(1)
signal power
% P_p
== y(2)
pump power
%
clear all
gain = 0.0;
gain_temp = 0.0;
P_s = 100d-7;
% signal power [Watts]
P_p = 9d-3;
% CHANGE
% pump power [Watts]
%
for d_L = 0.01:0.01:10
span = [0 d_L];
y0 = [P_s P_p];
% initial values of [P_s P_p]
[z,y] = ode45(’edfa_eqs’,span,y0);
% z - distance
len = length(z);
gain_temp = y(len)/y(1);
gain = [gain, gain_temp];
end
gain_log = log(gain);
d_L_plot = 0.01:0.01:10;
d_L_plot = [0, d_L_plot];
% plot(d_L_plot, gain_log)
% uncomment if you want to see plot when run
% axis([0 4 0 5])
% pause
% close all
%
d_u = length(d_L_plot);
fid = fopen(’gain_P_9.dat’, ’wt’);
% CHANGE
% Open the file.
for ii = 1:d_u
fprintf (fid, ’ %11.4f %11.4f\n’, d_L_plot(ii),gain_log(ii));
end
status = fclose(fid);
% Close the file

219
Appendix 8A
Listing 8A.2.2
Function edfa param.m. MATLAB function contains parameters for a
model of EDFA.
% File name: edfa_param.m
%-----------------------------------------------------------------
% Purpose:
% Contains parameters for model of EDFA based on Table 3.2
% Iannone-book
N_tot
= 5.4d24;
% Erbium concentration (m^-3)
Gamma_s = 0.4;
% Signal overlapping integral (dimensionless)
Gamma_p = 0.4;
% Pump overlapping integral (dimensionless)
s_se
= 5.3d-25;
% Signal emission cross-section (m^2)
s_sa
= 3.5d-25;
% Signal absorption cross-section (m^2)
s_p
= 3.2d-25;
% Pump absorption cross-section
P_ss
= 1.3d-3;
% Signal local saturation power (W)
P_sp
= 1.6d-3;
% Pump local saturation power (W)
Listing 8A.2.3
Function edfa eqs.m. MATLAB function contains equations for EDFA.
function y_z = edfa_eqs(z,y)
% Purpose:
% To establish equations for EDFA following Iannone-book, p.86
% P_s
== y(1)
signal power
% P_p
== y(2)
pump power
%
edfa_param
% input of needed parameters
num = y(1)/P_ss + y(2)/P_sp;
denom = y(2)/P_sp + 2*y(1)/P_ss + 1.0;
N_me = N_tot*num/denom;
N_gr = N_tot - N_me;
%
y_z(1) = 2*pi*Gamma_s*(s_se*N_me*y(1) - s_sa*N_gr*y(1));
% derivative
y_z(2) = -2*pi*Gamma_p*s_p*N_gr*y(2);
y_z = y_z’;
% must return column vector
end
Listing 8A.2.4
Function variable length plot.m. MATLAB function used to plot graph
of gain using data generated by gain variable length.m.
% File_name: variable_length_plot.m
% Plots graph of gain using data generated by ’gain_variable_length.m’
clear all
% Open files for 4 values of length of device: 5 m,10 m,15 m
fid = fopen(’gain_P_3.dat’);
a_3 = fscanf(fid,’%f %f’,[2 inf]); % It has two rows

220
Optical amplifiers and EDFA
fclose(fid);
%
fid = fopen(’gain_P_5.dat’);
a_5 = fscanf(fid,’%f %f’,[2 inf]); % It has two rows
fclose(fid);
%
fid = fopen(’gain_P_7.dat’);
a_7 = fscanf(fid,’%f %f’,[2 inf]); % It has two rows
fclose(fid);
%
fid = fopen(’gain_P_9.dat’);
a_9 = fscanf(fid,’%f %f’,[2 inf]); % It has two rows
fclose(fid);
%
plot(a_3(1,:),a_3(2,:),’k-’, a_5(1,:),a_5(2,:),’k--’,...
a_7(1,:),a_7(2,:),’k-.’,a_9(1,:),a_9(2,:),’k-’,’LineWidth’,1.5)
axis([0 4 0 10])
xlabel(’Doped fiber length (m)’,’FontSize’,14);
ylabel(’Gain (a.u)’,’FontSize’,14);
legend(’3 mW’,’5 mW’,’7 mW’,’9 mW’)
set(gca,’FontSize’,14);
% size of tick marks on both axes
pause
close all
Listing 8A.3.1
Function gain variable pump.m. MATLAB function used to compute gain
versus pump power for ﬁxed value of ﬁbre length.
% File name: gain_variable_pump.m
% Computation of gain vs power pump for fixed value of fiber length
% User selects fiber length which is controlled by d_L
% Calculations are repeated for d_L = 5,10,15 meters
% User should also appropriately rename output file ’gain_L_5.dat’
% Based on Iannone-book, p.86
% P_s
== y(1)
signal power
% P_p
== y(2)
pump power
%
clear all
gain = 0.0;
gain_temp = 0.0;
P_s = 100d-5;
% signal power [Watts]
d_L = 5;
% CHANGE
% fiber length [meters]
span = [0 d_L];
% region of integration [meters]
for P_p = 0.1d-3:0.1d-3:10d-3
% pump power [Watts]
y0 = [P_s P_p];
% initial values of [P_s P_p]
[z,y] = ode45(’edfa_eqs’,span,y0);
% z - distance
len = length(z);

221
Appendix 8A
gain_temp = y(len)/y(1);
gain = [gain, gain_temp];
end
gain_log = log(gain);
P_p_plot = 0.1:0.1:10;
P_p_plot = [0, P_p_plot];
% plot(P_p_plot, gain_log)
% uncomment if you want to see plot when run
% axis([0 10 0 30])
% pause
% close all
%
d_u = length(P_p_plot);
fid = fopen(’gain_L_5.dat’, ’wt’);
% CHANGE
% Open the file.
for ii = 1:d_u
fprintf (fid, ’ %11.4f %11.4f\n’, P_p_plot(ii),gain_log(ii));
end
status = fclose(fid);
% Close the file
Listing 8A.3.2
Function variable pump plot.m. MATLAB function used to plot graph of
gain using data generated by gain variable pump.m.
% File_name: variable_pump_plot.m
% Plots graph of gain using data generated by ’gain_variable_pump.m’
clear all
% Open files for 4 values of length of device: 5 m,10 m,15 m
fid = fopen(’gain_L_5.dat’);
a_5 = fscanf(fid,’%f %f’,[2 inf]); % It has two rows
fclose(fid);
%
fid = fopen(’gain_L_10.dat’);
a_10 = fscanf(fid,’%f %f’,[2 inf]); % It has two rows
fclose(fid);
%
fid = fopen(’gain_L_15.dat’);
a_15 = fscanf(fid,’%f %f’,[2 inf]); % It has two rows
fclose(fid);
%
plot(a_5(1,:),a_5(2,:),’k-’, a_10(1,:),a_10(2,:),’k--’,...
a_15(1,:),a_15(2,:),’k-.’,’LineWidth’,1.5)
axis([2 8 0 20])
xlabel(’Pump power (mW)’,’FontSize’,14);
ylabel(’Gain (a.u)’,’FontSize’,14);
legend(’5 m’,’10 m’,’15 m’)
set(gca,’FontSize’,14);
% size of tick marks on both axes
pause
close all

222
Optical amplifiers and EDFA
References
[1] A. Yariv and P. Yeh. Photonics. Optical Electronics in Modern Communications. Sixth
Edition. Oxford University Press, New York, Oxford, 2007.
[2] E. Desurvire. Erbium-Doped Fiber Ampliﬁers, Principles and Applications. Wiley,
New York, 2002.
[3] P. C. Becker, N. A. Olsson, and J. R. Simpson. Erbium-Doped Fiber Ampliﬁers.
Fundamentals and Technology. Academic Press, San Diego, 1999.
[4] A. Bjarklev. Optical Fiber Ampliﬁers: Design and System Applications. Artech House,
Boston, 1993.
[5] A. Yariv. Quantum Electronics. Third Edition. Wiley, New York, 1989.
[6] G. P. Agrawal. Fiber-Optic Communication Systems. Second Edition. Wiley, New
York, 1997.
[7] G. P. Agrawal. Semiconductor optical ampliﬁers. In G. P. Agrawal, ed., Semiconductor
Lasers. Past, Present, and Future, pages 243–83. American Institute of Physics Press,
Woodbury, New York, 1995.
[8] C. R. Giles and E. Desurvire. Modeling erbium-doped ﬁber ampliﬁers. J. Lightwave
Technol., 9:271–83, 1991.
[9] B. Pedersen, A. Bjarklev, O. Lumholt, and J. H. Povlsen. Detailed design analysis of
erbium-doped ﬁber ampliﬁers. IEEE Photon. Technol. Lett., 3:548–50, 1991.
[10] E. Iannone, F. Matera, A. Mocozzi, and M. Settembre. Nonlinear Optical Communi-
cation Networks. Wiley, New York, 1998.
[11] R. Sabella and P. Lugli. High Speed Optical Communications. Kluwer Academic
Publishers, Dordrecht, 1999.
[12] K. Y. Ko, M. S. Demokan, and H. Y. Tam. Transient analysis of erbium-doped ﬁber
ampliﬁers. IEEE Photon. Technol. Lett., 6:1436–8, 1994.

9
Semiconductor optical amplifiers (SOA)
The ﬁeld of semiconductor optical ampliﬁers (SOA) is one of the fast growing in recent
years. Many new applications of SOA were proposed. For comprehensive summaries, see
books by Connolly [1] and Dutta and Wang [2].
In this chapter we will discuss the following topics:
• general concepts
• ampliﬁer equations
• inﬂuence of cavity (FP ampliﬁers)
• gain dependence on polarization and temperature
• some applications.
Typical use of SOA in an ampliﬁer conﬁguration is shown in Fig. 9.1. Here, a signal
from transmission ﬁbre is imputed on SOA where it is ampliﬁed. After ampliﬁcation it is
redirected again to the ﬁbre. Coupling between ﬁbre and SOA is provided by an appropriate
optical element.
9.1 General discussion
SOA is very similar to a semiconductor laser. There are two categories of SOA (see Fig. 9.2):
(a) Fabry-Perot (FP) ampliﬁer and (b) travelling-wave ampliﬁer (TWA). The FP ampliﬁer
displays high gain but has a non-uniform gain spectrum, whereas TWA has broadband gain
but requires very low facet reﬂectivities. The FP ampliﬁer has large reﬂectivities at both
ends which results in resonant ampliﬁcation, and also has large gain at the wavelength
corresponding to longitudinal modes of the FP cavity.
TWA has very small reﬂectivities, achieved by AR (anti-reﬂection) coating; its gain
spectrum is broad but small ripples exist in gain spectrum, resulting from residual facet
reﬂectivity. It is more suitable for system applications but the gain must be polarization
independent. The phenomenological expression for gain of SOA is written as
gm = a(n −n0) −a2(λ −λp)2
(9.1)
and the wavelength peak value as
λp = λ0 + a3(n −n0)
(9.2)
Typical values of the parameters which appear in the above formulas are given in
Table 9.1, from [3].
223

224
Semiconductor optical amplifiers (SOA)
Table 9.1 Basic parameters of SOA.
Description
Symbol
Value
Differential gain
a
2.7 × 10−16 cm2
Gain coefﬁcient
a2
0.15 cm−1 nm−2
Gain coefﬁcient
a3
2.7 × 10−17 nm · cm−3
Transparency density
n0
1.1 × 1018 cm−3
Ampliﬁer length
L
350 µm
Density at threshold
nth
1.8 × 1018 cm−3
core
cladding
Transmission fibre
Transmission fibre
Injection current (pump)
Active region
coupling optics
SOA
Optical
input
signal
Amplified
optical
signal
Fig. 9.1
SOA in an amplifier configuration.
Balk
semiconductor
Injection current (pump)
Injection current (pump)
Active region
Active region
Optical
input
signal
Cleaved
facet
(a)
Cleaved
facet
Amplified
optical
signal
Balk
semiconductor
Optical
input
signal
(b)
Amplified
optical
signal
Fig. 9.2
Types of SOA: Fabry-Perot (left) and travelling-wave (right).
From the previous equations, the 3 dB gain bandwidth is determined as
2λ = 2

a(n −n0)
2n2
(9.3)
Substituting typical values from Table 9.1 gives SOA bandwidth equal to 54 nm.

225
General discussion
Ein
Eout
E1
E2
E3
R2
R1
L
Fig. 9.3
Basic model of a Fabry-Perot amplifier.
9.1.1 Gain formula for SOA with facet reflectivities
Consider a typical Fabry-Perot ethalon with a gain medium in-between, see Fig. 9.3. Total
output electric ﬁeld Eout consists of all transmitted contributions:
Eout = E1 + E2 + E3 + · · ·
Here R1 and R2 are coefﬁcients of internal reﬂections for electric ﬁeld, and 1 −R1 and
1 −R2 corresponding coefﬁcients of transmission. The single-pass gain Gs for ﬁeld is
Gs = e(g−α)·L
(9.4)
where  is optical conﬁnement factor, g is gain coefﬁcient and α are internal losses. The
longitudinal propagation constant βz is
βz = k0 · ng
(9.5)
where k0 = 2π
λ and ng effective group index
ng = c
vg
(9.6)
Here vg is the group velocity. Applying the standing wave condition to an electromagnetic
wave of wavelength λ in a resonator of length L gives
L = mλ
2
(9.7)
Expressions for transmitted components are
E1 = E0e−jβzL
Gs

1 −R1

1 −R2
E2 = E0e−jβz·3L (
Gs
)3 
1 −R1
√
R2
√
R1

1 −R2
E3 = E0e−jβz·5L (
Gs
)5 
1 −R1R2R1

1 −R2
Total ﬁeld, which is determined as a sum of all the above components, is therefore
Eout = E0

(1 −R1) (1 −R2) Gse−jβzL{1 + Gs
√
R1R2e−jβz·2L
+ G2
sR1R2e−jβz·4L + · · · }
Summing geometrical series, one ﬁnally obtains
Eout =
√1 −R1
√1 −R2GsE0e−jβzL
1 −Gs
√R1R2e−2jβz·L

226
Semiconductor optical amplifiers (SOA)
frequency
gain
Gmax
0ν
ν
Fig. 9.4
Gain spectra showing frequency corresponding to gain peak.
Finally, gain of SOA with facet reﬂectivities R1 and R2 is
G =
(1 −R1) (1 −R2) GS

1 −√R1R2GS
2 + 4√R1R2GS sin2 φ
(9.8)
Phase shift φ is obtained by assuming that the phase of the incident wave is taken as zero.
The relation for phase change φ at the output is thus
φ = 2π
λ L
(9.9)
Using (9.6), we can write the above relation for frequency as
ν = φ vg
2πL
(9.10)
The above relation can be interpreted on gain spectrum graph as shown in Fig. 9.4 where
frequency ν0 corresponds to gain peak Gmax, which is obtained when sin φ = 0, or φ = kπ.
Using an expression for phase (9.9), one ﬁnds its value corresponding to ν0 (using relation
1/λ0 = ν0/vg)
φ = 2π
λ0
L = 2π
vg
ν0 L
or
ν0 = vg
2L · k
= vg
2L
assuming k = 1. The difference in frequencies ν −ν0 is determined as
ν −ν0 =
vg
2πLφ −vg
2L = vg
2L
 φ
π −1

or
2π (ν −ν0 ) L
vg
= π
 φ
π −1

= φ −π
Finally
φ = 2π (ν −ν0 ) L
vg
(9.11)
where we have neglected π since sin π = 0.

227
General discussion
wavelength
gain
Fig. 9.5
Typical gain spectra of Fabry-Perot amplifier showing gain ripples.
10−4
10−3
10−2
10
0
101
102
103
Gain ripple
Reflectivity (R)
 = 200
Gs
Gs
 = 500
Fig. 9.6
Gain ripple as a function of reflectivity for two values of gain.
9.1.2 The effect of facet reflectivities
An uncoated SOA has facet reﬂectivities (due to FP reﬂections) determined by taking the
values of refractive indices of a typical semiconductor and the air and is approximately
equal to 0.32. Even with the AR coatings, there are some residual reﬂectivities which result
in the appearance of the so-called gain ripples, see Fig. 9.5. Ripples are superimposed on
gain spectrum. The peak-to-valley ratio between the resonant and non-resonant gains is
known as the ampliﬁer gain ripple Gr. From Eq. (9.8) one obtains
Gr = 1 + Gs
√R1R2
1 −Gs
√R1R2
(9.12)
where Gs is the single-pass ampliﬁer gain.
For an ideal TWA both R1 and R2 are zero. In this case Gr = 1; i.e. no ripple occurs at the
cavity mode frequencies. The quantity Gr is plotted in Fig. 9.6 as a function of reﬂectivity

228
Semiconductor optical amplifiers (SOA)
R (assuming that R1 = R2) for two values of gain. One observes that gain ripple increases
with increasing gain and also increasing facet reﬂectivity. The MATLAB code is provided
in Appendix, Listing 9A.1.
9.2 SOA rate equations for pulse propagation
In this section we concentrate on basic rate equations describing pulse propagation in
SOA [2], [4]. Discussion involves electromagnetic ﬁeld and carriers. We start with the
development of electromagnetic equation.
Pulse propagation inside SOA is described by the wave equation
∇2E (r,t) −ε
c2
∂2E (r,t)
∂t2
= 0
(9.13)
where E (r,t) is the electric ﬁeld vector, c is the light velocity and ε is the dielectric constant
of the ampliﬁer medium which is expressed as
ε = n2
b + χ
(9.14)
Here nb is the background refractive index of the semiconductor and susceptibility χ which
represents the effect of charges inside an active region in the phenomenological model is
χ = −cn
ω0
(αH + i) g(n)
(9.15)
where n is the effective mode index, αH is the linewidth enhancement factor (Henry factor)
and g(n) is the optical gain approximated here (for bulk devices) as
g(n) = a (n −n0)
(9.16)
where a is defferential gain, n is the injected carrier density and n0 is the carrier density at
transparency.
In the following we assume a travelling wave semiconductor wave ampliﬁer which
supports single mode propagation with a perpendicular electric proﬁle described by F(x, y).
The electric ﬁeld E (r,t) which obeys wave equation (9.13) is expressed as
E (r,t) = n1
2

F(x, y) A(z,t) ei(k0z−ω0t)
(9.17)
where n is the polarization vector, k0 = nω0/c and A(z,t) is the slowly varying amplitude
of the propagating wave. We introduce the following notation:
∇2 = ∇2
⊥+ ∂2
∂z2 ,
where ∇2
⊥= ∂2
∂x2 + ∂2
∂y2
and evaluate derivatives
∇2E ∼(∇2
⊥F)Aeik0z + F ∂2A
∂z2 eik0z + 2F ∂A
∂z ik0eik0z + FA(ik0)2eik0z
(9.18)

229
SOA rate equations for pulse propagation
In the slowly varying envelope approximation (SVEA) the term with second derivative with
respect to z and t is neglected. Substituting (9.18) into (9.13), applying SVEA with respect
to z and t and integrating over the transverse direction gives
∇2
⊥F + ω2
0
c2

n2
b −n2
F = 0
(9.19)
and
∂A
∂z + 1
vg
∂A
∂t = iω0
2cn χA −1
2αlossA
(9.20)
where we have accounted for losses described by αloss. The group velocity is deﬁned as
vg = c/ng and group index ng is
ng = n + ω0
∂n
∂ω
(9.21)
The conﬁnement factor  is
 =
2 w
0 dx
2 d
0 dy|F(x, y)|2
2 +∞
−∞dx
2 +∞
−∞dy|F(x, y)|2
(9.22)
where w and d are the width and thickness of the ampliﬁer active region. At this stage, one
simpliﬁes Eq. (9.20) by introducing transformation to a reference frame moving with pulse
as
τ = t −z
vg
z′ = z
In the new reference frame Eq. (9.20) takes the form
∂A
∂z = iω0
2cn χA −1
2αlossA
(9.23)
Rate equation for carrier density n is in the following form [2], [4]:
dn
dt =
I
qV −n
τc
−g(n)
ℏω0σm
|A|2
(9.24)
where I is the injection current, V is the active volume, q is the electron charge, τc is the
carrier lifetime and σm is the cross section of the active region. In the new reference frame,
the above equation is
dn
dτ =
I
qV −n
τc
−g(n)
ℏω0σm
|A|2
(9.25)
Slowly varying amplitude A(z,t) of the propagating wave is expressed as
A =
√
Peiφ
(9.26)

230
Semiconductor optical amplifiers (SOA)
where P(z, τ ) and φ(z, τ ) are the instantaneous power and the phase of the propagating
pulse. Using the above equations, one obtains [2]
∂A
∂z = 1
2 (1 + iαH ) g · A
(9.27)
dg
dτ = −g −g0
τc
−gP
Esat
(9.28)
∂P
∂z = (g −αloss) P
(9.29)
∂φ
∂z = −1
2αHg
(9.30)
The quantity Esat is deﬁned as Esat = τcPs, where Ps is the saturation power of the ampliﬁer
Ps = hω0σm
aτc
(9.31)
In the above g0 is the small signal gain
g0 = a
Iτc
eV −n0

(9.32)
Finally, the cross section σm of the active region is σm = wd.
Pulse amplification
Using previously deﬁned equations, we will now analyse pulse propagation assuming zero
losses, i.e. αloss = 0, and also assuming that τp ≪τc, where τp is the width of the input pulse.
Under this approximation pulse is so short that gain has no time to recover. Observing that
τc = 0.2–0.3 ns for typical SOA [4], this approximation works for τp equal to about 50 ps.
Under the above approximations, one can obtain the analytical solution of the ampliﬁer
equations. One ﬁrst integrates Eq. (9.29) to obtain output power as
Pout(τ ) = Pin(τ )eh(τ ) ≡Pin(τ )G(τ )
(9.33)
where Pin(τ ) is the input power, and
h(τ ) =
 L
0
g(z, τ )dz
(9.34)
Quantity h(τ ) is known as the total integrated net gain. Replacing the last term in Eq. (9.28)
using (9.29) gives
dg
dτ = g0 −g
τc
−
1
Esat
dP
dz
Integrating the above over ampliﬁer length and using (9.33) gives
dh(τ )
dτ
= g0L −h(τ )
τc
−
1
Esat
Pin(τ ) [G(τ ) −1]
(9.35)

231
Design of SOA
The solution of the previous equation is [2], [4]
G(τ ) = eh(τ ) =
G0
G0 −(G0 −1) exp [−E0(τ )/Esat]
(9.36)
where G0 is the unsaturated gain of the ampliﬁer and the quantity E0(τ ) is given by
E0(τ ) =
 τ
−∞
Pin(τ ′)τ ′
(9.37)
E0(τ ) represents the fraction of the pulse energy contained in the leading part of the pulse
up to τ ′ ≤τ.
The above solution shows that due to time dependence of the gain, different parts of
input pulse experience different ampliﬁcation which leads to a modiﬁcation of pulse shape
after being ampliﬁed by SOA.
In the following we will restrict our analysis to the Gaussian input pulse
Pin(τ ) = P0 exp

−τ 2
(9.38)
For the Gaussian input pulse, the expression for the quantity E0(τ ) can be found in a closed
form as
E0(τ ) = P0τ0
1
2
√π [1 + er f (τ )]
(9.39)
where er f (τ ) is the error function deﬁned as
er f (τ ) =
2
√π
 τ
0
e−x2dx
(9.40)
We have also used the following property of error function [5]:
1 −er f (τ ) =
2
√π
 ∞
τ
e−x2dx
(9.41)
In Fig. 9.7 we plotted pulse shape for several values of unsaturated gain G0. One can
observe that the ampliﬁed pulse becomes asymmetric; i.e. its leading edge is sharper
compared to its trailing edge.
9.3 Design of SOA
Here, we brieﬂy describe the main effects which must be considered when designing SOA
with proper characteristics. Out of many issues related to the design of SOA, we brieﬂy
concentrate here on two: suppression of cavity resonances and polarization insensitivity.
Consult the literature [1], [2] and [6] for more information.
Suppression of cavity resonance
To fabricate a travelling wave SOA, the Fabry-Perot cavity resonances must be suppressed.
To accomplish this, the reﬂectivities at both facets must be reduced. Three approaches were

232
Semiconductor optical amplifiers (SOA)
−3
−2
−1
0
1
2
3
0
0.2
0.4
0.6
0.8
1
τ
Normalized output power
Fig. 9.7
Output pulse shapes for several values of the unsaturated gain G0 = 10, 100, 1000 (increasing values to the
left).
used to achieve this goal (see Fig. 9.8): (a) to put anti-reﬂection (AR) coating at both facets,
(b) to tilt the active region and (c) to use transparent window regions.
The principles of AR coating were discussed in Chapter 3. AR coating only works for a
particular wavelength and it is not suitable for a wide bandwidth. The analysis [7] shows
that with appropriate combination of the previously discussed methods it is possible to
obtain an effective facet reﬂectivity of less than 10−4. Multilayer coatings can broaden
wavelength range where there is low reﬂectivity.
Polarization insensitive structures
The state of polarization of an electric ﬁeld during propagation in optical ﬁbre changes
randomly. Therefore, after propagation when signal is ready for ampliﬁcation (say, in
SOA), its state of polarization is unknown. For ampliﬁcations of such signals it is therefore
desirable that SOA has polarization independent ampliﬁcation. The main factor responsible
for polarization sensitivity is the difference between conﬁnement factors for TE and TM
modes [1]. Proper design of polarization insensitive SOA involves several techniques which
are summarized in [1].
Additionally, in modern SOAs which are based on quantum well (QW) designs instead of
bulk structures, due to their signiﬁcantly reduced threshold current and increased efﬁciency
there exist additional polarization related effects associated with QW. QW signiﬁcantly
suffers from polarization sensitivity, that is, a signiﬁcant difference in gain between the
transverse-electric (TE) and transverse-magnetic (TM) polarization modes. This is a major
concern as the polarization of a signal cannot be always controlled. Several approaches
were discussed to the design of polarization insensitive SOA [8], [9], [10]. The issue is of
signiﬁcant importance for SOA built using quantum wells.

233
Some applications of SOA
Balk
semiconductor
Optical
input
signal
(a)
Amplified
Active region
AR coating
AR coating
optical
signal
Optical
input
signal
Optical
input
signal
transparent
window
transparent
window
(b)
Amplified
optical
signal
Amplified
optical
signal
(c)
Fig. 9.8
Main ways to make travelling wave SOA.
9.4 Some applications of SOA
9.4.1 Wavelength conversion
One of the important applications of SOA is for wavelength conversion (WC) [11], see
also [1]. Three main methods of WC have been analysed: cross-gain modulation (XGM),
cross-phase modulation (XPM) and four-wave mixing (FWM). XGM will be discussed in
detail in the following section.
Other methods (not discussed here) include those based on the nonlinear optical loop
mirror (NOLM) with the nonlinearity achieved by using ﬁbre or SOA (see recent review
[12]).

234
Semiconductor optical amplifiers (SOA)
SOA
λCW
λCW
λS
signal
laser probe
output
Fig. 9.9
Wavelength conversion using XGM in SOA in copropagation configuration.
SOA
λS
signal
output
λCW
λCW
laser probe
Fig. 9.10
Wavelength conversion using XGM in SOA in a counter-propagation configuration.
Gain (dB)
Input signal power (dBm)
Converted signal, λCW 
Input signal, λS 
Fig. 9.11
Principle of wavelength conversion in SOA using XGM.
Cross-gain modulation
The reduction of gain, known as gain saturation, typically occurs for input powers of
the order of 100 µW or higher. To understand this effect, one must remember that the
ampliﬁcation in SOA is the result of stimulated emission. The rate of stimulated emission
in turn depends on the optical input power. At high optical injection, the carrier concentration
in the active region is depleted through stimulated emission to such an extent that the gain
of SOA is reduced.
WC based on XGM can operate in either copropagation or counter-propagation conﬁg-
urations. Counter-propagation conﬁguration does not require optical ﬁltering of the target
wavelength. However, counter-propagation suffers from speed limitations [13].
The schematic representation of the XGM used as wavelength conversion is shown in
Fig. 9.9 (copropagation conﬁguration) and in Fig. 9.10 (counter-propagation conﬁguration).
The principle of wavelength conversion employing nonlinear characteristics of SOA is
explained in Fig. 9.11. Two optical signals enter a single SOA. One of the signals (known
as the probe beam) at wavelength λCW is injected continuously (CW); the other (known as
the signal beam) injected at wavelength λS is carrying digital information.

235
Some applications of SOA
A
B
Δφ
SOA 2
SOA 1
C
A1
A2
Fig. 9.12
The MZ interferometric configuration and its equivalent symbol.
If the peak optical power in the modulated signal is near the saturation power of the SOA,
the gain will be modulated synchronously with the power. When the data signal is at high
level (a logical ONE), the gain is depleted and vice versa. This gain modulation is imposed
on the unmodulated (CW) input probe beam. Thus, an inverted replica of the input data is
created at the probe beam wavelength. This form of wavelength conversion is one of the
simplest all-optical wavelength conversion mechanisms available today.
Very fast wavelength conversion can be achieved with speeds in the order of 40 Gb s−1
[14] with a small bit error ratio penalty. Previously, it was thought that the speed of WC is
limited by the intrinsic carrier lifetime, which is around 0.5 ns. This is because the effective
carrier lifetime can be decreased by the use of high optical injection to values as low as
10 ps.
Another effect associated with pulse propagation in long SOA (>1 mm) is that pulse
distortion of the input data due to gain saturation effects can tend to sharpen the leading
edge of the data pulse at the probe wavelength.
9.4.2 All-optical logic based on interferometric principles
For the future high-speed optical networks, several all-optical signal processing functional-
ities will be required to avoid cumbersome and power consuming electro-optic conversion.
The central role in this process is played by all-optical high-speed logic gates.
In recent years several schemes of implementation have been investigated. Some of those
schemes exploit gain saturation of SOA, and the other methods employ the interferometric
conﬁgurations.
Optical logic devices are constructed using the Mach-Zehnder (MZI) interferometer, see
Fig. 9.12 for an introduction to the notation and symbols. φ is the phase difference between
signals propagating in the upper and lower arms of MZI. Each arm of the interferometer
contains SOA where the effect of cross-phase modulation (XPM) is utilized to change phase
of the transmitted light. The XPM effect is based on the physical effect of the dependence
of refractive index on the carrier density in the active region. Depending on operating
conditions which are controlled by driving currents within each SOA and direction and
intensity of external light, this conﬁguration can perform like an all-optical gain. In what
follows, for several logic gates we schematically show operating conditions of MZI, the
resulting phase difference and the equivalent logical table [15].

236
Semiconductor optical amplifiers (SOA)
A
B
X
X
B
A
0
0
0
0
0
0
0
1
1
1
1
1
Δφ = 0
Fig. 9.13
A block diagram of A NOT B and a truth table.
A
B
X
X
B
A
0
0
0
0
0
0
0
1
1
1
1
1
Δφ = π
Fig. 9.14
A block diagram of A AND B and a truth table.
A and NOT B
Here, bias conditions are set in such way that, when a second signal B is input in a counter-
propagating scheme, the phase difference is zero. The conﬁguration and logical table are
shown in Fig. 9.13.
A AND B
Here, both SOA are biased such that in the absence of counterpropagating signal B, a phase
difference of π exists at the output X . The relevant conﬁguration and the truth table are
shown in Fig. 9.14.
9.5 Problem
1. Derive an expression for gain ripple Gr.
9.6 Project
1. Use software developed by Connelly [1] to analyse optical logical elements.
Appendix 9A: MATLAB listings
In Table 9.2 we provide a list of MATLAB ﬁles created for Chapter 9 and a short description
of each function.

237
Appendix 9A
Table 9.2 List of MATLAB functions for Chapter 9.
Listing
Function name
Description
9A.1
gain ripple.m
Determines gain ripples as a function of reﬂectivity
9A.1
pulse shape.m
Determines output pulse shape for various values of G0
Listing 9A.1
Program gain ripple.m. MATLAB program which determines gain ripples
for SOA.
% File name: gain_ripple.m
% Calculates gain ripple as a function of reflectivity
clear all
N_max = 401;
% number of points for plot
R = linspace(1d-4,4d-3,N_max);
% creation of theta arguments
%
for G_s = [200 500]
% gain coefficient
G_r = (1 + G_s.*R)./(1 - G_s.*R);
loglog(R,G_r,’LineWidth’,1.5)
hold on
end
% Redefine figure properties
ylabel(’Gain ripple’,’FontSize’,14)
xlabel(’Reflectivity (R)’,’FontSize’,14)
set(gca,’FontSize’,14);
% size of tick marks on both axes
text(3d-3, 12, ’G_s = 200’,’Fontsize’,14)
text(6d-4, 12, ’G_s = 500’,’Fontsize’,14)
text(8.5, 0.1, ’r = 0.8’,’Fontsize’,14)
pause
close all
Listing 9A.2
Program pulse shape.m. MATLAB program which determines output pulse
shape for three values of the unsaturated gain G0.
% File name: pulse_shape.m
% Determines output pulse shapes in soa
% Basic equations after Agrawal and Olsson, JQE25, 2297 (1989)
clear all
P_0 = 1;
w = 0.1;
% defined as P_0*tau_0/E_sat
tau = -3:0.01:3;
hold on
for G_0 = [10 100 1000]
x = (1/2)*sqrt(pi)*w*(1 + erf(tau));

238
Semiconductor optical amplifiers (SOA)
G = G_0./(G_0 -(G_0-1)*exp(-x));
y = exp(-tau.^2).*G;
y_max = max(y);
plot(tau,y/y_max,’LineWidth’,1.5)
end
xlabel(’\tau’,’FontSize’,14);
ylabel(’Normalized output power’,’FontSize’,14);
set(gca,’FontSize’,14);
% size of tick marks on both axes
grid on
pause
close all
References
[1] M. J. Connelly. Semiconductor Optical Ampliﬁers. Kluwer Academic Publishers,
Boston, 2002.
[2] N. K. Dutta and Q. Wang. Semiconductor Optical Ampliﬁer. World Scientiﬁc,
Singapore, 2006.
[3] M. J. O’Mahony. Semiconductor laser optical ampliﬁers for use in future ﬁber systems.
J. Lightwave Technol., 6:531–44, 1988.
[4] G. P. Agrawal and N. A. Olsson. Self-phase modulation and spectral broadening
of optical pulses in semiconductor laser ampliﬁers. IEEE J. Quantum Electron.,
25:2297–306, 1989.
[5] M. R. Spiegel. Mathematical Handbook of Formulas and Tables. McGraw-Hill, New
York, 1968.
[6] G. P. Agrawal and N. K. Dutta. Semiconductor Lasers. Second Edition. Kluwer
Academic Publishers, Boston/Dordrecht/London, 2000.
[7] T. Saitoh, T. Mukai, and O. Mikame. Theoretical analysis and fabrication of antire-
ﬂection coatings on laser-diode facets. J. Lightwave Technol., 3:288–93, 1985.
[8] Y. Zhang and P. P. Ruden. 1.3−µm polarization-insensitive optical ampliﬁer structure
based on coupled quantum wells. IEEE J. Quantum Electron., 35:1509–14, 1999.
[9] W. P. Wong and K. S. Chiang. Design of waveguide structures for polarization-
insensitive optical ampliﬁcation. IEEE J. Quantum Electron., 36:1243–50, 2000.
[10] M. S. Wartak and P. Weetman. The effect of thickness of delta-strained layers in the
design of polarization-insensitive semiconductor optical ampliﬁers. IEEE Photon.
Technol. Lett., 16:996–8, 2004.
[11] T. Durhuus, B. Mikkelsen, C. Joergensen, S. L. Danielsen, and K. E. Stubkjaer.
All-optical wavelength conversion by semiconductor optical ampliers. J. Lightwave
Technol., 14:942–54, 1996.
[12] I. Glesk, B. C. Wang, L. Xu, V. Baby, and P. R. Prucnal. Ultra-fast all-optical switching
in optical networks. In E. Wolf, ed., Progress in Optics, volume 45, pp. 53–117.
Elsevier, Amsterdam, 2003.

239
References
[13] D. Nesset, T. Kelly, and D. Marcenac. All-optical wavelength converion using SOA
nonlinearities. IEEE Communications Magazine, December:56–61, 1998.
[14] D. Wolfson, A. Kloch, T. Fjelde, C. Janz, B. Dagens, and M. Renaud. 40-gb/s
all-optical wavelength conversion, regeneration, and demultiplexing in and SOA-
based all-active Mach-Zehnder interferometer. IEEE Photon. Technol. Lett., 12:332–
4, 2000.
[15] K. Roberts-Byron, J. E. A. Whiteaway, and M. Tait. Optical logic devices and methods.
United States Patent, Number 5,999,283. Dec. 7, 1999.

10
Optical receivers
In this chapter we summarize the operation of an optical receiver, which is an important
part of an optical communication system. An overview of design principles for receivers
used in optical communication systems is provided by Alexander [1]. The aim of a receiver
is the recovery of the transmitted data. The process involves two steps [2]:
1. the recovery of the bit clock,
2. the recovery of the transmitted bit within each bit interval.
A block diagram of an optical receiver is shown in Fig. 10.1 [3], [4].
The receiver consists of a photodetector which converts the optical signal into electrical
current. A good light detector should generate a large photocurrent at a given incident light
power. They should also respond fast to the input changes and add minimal noise to the
output signal. This last requirement is of crucial importance since the received signal is
typically very weak. In digital optical communication systems the detection process is often
conducted with a PIN photodiode.
There are generally two types of detection [4]: direct detection (also called incoherent
detection) and coherent detection.
Direct detection detects only the intensity of the incident light. It is used mainly for
intensity or amplitude modulation schemes. It can only detect an amplitude modulated
(AM) signal.
Coherent detection can detect both the power and phase of the incident light. It is therefore
used when phase modulation (PM) or frequency modulation (FM) is preferred. Coherent
detection is also important in applications such as WDM.
The coherent detection requires a local oscillator to coherently down-convert the modu-
lated signal from optical frequency to intermediate frequency (IF) [4]. Coherent detection
is not discussed here, see [4] for the extensive discussion. The incoherent detection which
dominates in currently deployed systems is based on square-law envelope detection of the
optical signals.
After detection, the electrical current is often ampliﬁed (not shown in Fig. 10.1) and
then passes through an electrical ﬁlter which is normally of the Bessel type. At that point,
electrical eye diagrams are typically observed for the assessment of signal quality. Next,
sampling of electrically ﬁltered received signal is performed. The received electrical signal
is corrupted with noise of various origins. The noise sources will be discussed in the
following sections.
Performance evaluation of an optical transmission system is done by evaluating optical
signal-to-noise ratio, eye opening and bit error rate (BER) which is the ultimate indicator
of the system’s performance.
240

241
Main characteristics
Photodetector
Input
signal
Output
signal
Receiver filter
hR (t)
Sampler/
detector
i(t)
Fig. 10.1
Block diagram of an ideal optical receiver.
10.1 Main characteristics
Before we enter a more specialized discussion of optical receivers, let us summarize their
main characteristics [5], which are: receiver sensitivity, dynamic range, bit-rate transparency
and bit-pattern independency.
10.1.1 Receiver sensitivity
This property is a measure of the minimum level of optical power Psens at the receiver
required for a reliable operation. Speciﬁcally, one expects that the BER is smaller than a
speciﬁed level. Typically, that level is established to be equal to 10−9.
The receiver sensitivity is a function of both the signal and also the noise parameters
of photodetector and a preampliﬁer. It is a measure of the operating limit of the optical
receiver, which, however, rarely operates close to that limit. There always exists a possibility
of degradation of the system (temperature, ageing, etc.), so a typical margin (normally 3–
6 dB) is established.
Receiver sensitivity is a fundamental parameter of an optical receiver. It is directly
responsible for the spacing between two points in any optical link, e.g. between transmitter
and receiver or between repeaters.
10.1.2 Dynamic range
Dynamic range (expressed in dB) is the difference between the maximum allowable power
and minimum power determined by receiver sensitivity. The maximum allowable power on
the receiver is determined by nonlinearity and saturation.
Large dynamic range is important because it allows for more ﬂexibility in the design of
an optical network. The design of every network should take into account the wide range
of possible changes of received optical powers due to changes in temperature, ageing or
various types of losses (in the ﬁbre, connectors, etc.).
10.1.3 Bit-rate transparency
It refers to the ability of the optical receiver to operate over a range of bit rates. It describes
the ability of the same receiver to be used for several networks operating at different bit
rates.

242
Optical receivers
10.1.4 Bit-pattern independency
This is the property of an optical receiver determining its operation for various data formats.
The main constraint is imposed by non-return-to-zero (NRZ) code.
10.2 Photodetectors
At the end of travel through a optical ﬁbre, the optical signal reaches a photodetector (PD)
where it is converted into an electrical signal. In PD photon of energy hν is absorbed and
produces photocurrent iP:
iP = η P
hν e
(10.1)
where P is the power of the incoming light, η is the quantum efﬁciency, h is Planck’s constant
and ν = c/λ is the frequency of the absorbed light. PD is similar to a semiconductor diode
polarized in the reverse direction. Therefore, PD can be modelled as a current source.
Another very popular detector is a human eye. It is the most popular natural detector of
light but it has several disadvantages: it is slow, has bad sensitivity for low-level signals,
has no natural connection to electronic ampliﬁers and its spectral response is limited to the
0.4–0.7 µm range.
Artiﬁcial (human made) optical detectors are based on two physical mechanisms: external
photoelectric effect and internal photoelectric effect. In the external photoelectric effect,
electrons are removed from the metal surface of electrode known as a cathode by absorbing
energy from incident light. Then, under an electric ﬁeld due to the potential difference
between both electrodes, they travel to another electrode known as an anode, thus producing
electrical current. Vacuum photodiodes and photomultiplier tubes operate on that principle.
Main choices for photodetectors are the PIN (P-type Intrinsic N-type) photodiode and
avalanche photodiode (APD). APD provides gain which increases system sensitivity but
introduces more noise.
In this section we will discuss only the internal photoelectric effect and its applications in
light detection. In this effect, physical processes take place inside semiconductor junction
devices. There, free carriers (electrons and holes) are generated by absorption of incoming
photons, and as a result an electrical current is produced. These devices can be viewed as
the inverse of a light emitting diode (LED).
10.2.1 Principles of photo detection
Photodetection using semiconductors is possible because of optical absorption. When light
is incident on the semiconductor surface, it may or may not be absorbed depending on a
wavelength. Absorbed optical power is described as
dP
dx = α(λ)P
(10.2)

243
Photodetectors
Absorption coefficient (cm-1)
Wavelength λ (μm)
0.4
0.6
0.8
1.0
1.2
1.4
1.6
1.8
101
102
103
104
105
Si
Ge
GaAs
Fig. 10.2
Optical absorption coefficient as a function of wavelength for typical semiconductors. Reprinted from H. Melchior,
JournalofLuminescence, 7, 390 (1973). Copyright (1973), with permission from Elsevier.
where α(λ) is the absorption coefﬁcient which is wavelength dependent. The spectra of
optical absorption for several semiconductors (including compounds) are schematically
shown in Fig. 10.2. As can be seen, the absorption coefﬁcient α(λ) strongly depends on
wavelength.
Integration of Eq. (10.2) gives the absorbed power at the distance x from the surface in
terms of the incident optical power P0:
P(x) = P0

1 −e−α(λ)·x
(10.3)
A schematic of a photodetector is illustrated in Fig. 10.3. Incident light penetrates the
semiconductor surface and generates electrical current I. The device structure consists of
p and n regions separated by wide intrinsic (very lightly doped) region of width w under
large reverse bias voltage, see Fig. 10.4.
When a photon is absorbed by the solid (and if it has enough energy, i.e. large enough
frequency), its energy causes an electron to move from valence band (leaving one hole
behind) to the conduction band and to create one extra electron there. The change of energy
of an electron should be (at least) Eg, which is known as the energy gap. Photons with
smaller energies are usually not able to create electron-hole pairs, see Fig. 10.5. Therefore,
photon energy Ep = hν must be
Ep ≥Eg
or
hν ≥Eg
or
λc = ch
Eg

244
Optical receivers
Incident light
I
Electrode
Semiconductor
Fig. 10.3
Schematic of a photodetector.
photon   hν
electron
hole
p
n
R
i
V
Fig. 10.4
PIN photodetector in external electrical circuit.
+
p-type
n-type
Ev
Ec
Depletion
region
Eg
Photon
hν ≥ Eg
Intrinsic
region
Fig. 10.5
Energy band diagram of a PIN photodiode. Generation of electron-hole pair is shown.

245
Photodetectors
Table 10.1 Bandgaps and cutoff wavelengths for different semiconductors and their compounds.
Semiconductor
E(eV )
λc(µm)
C
7
0.18
Si
1.1
1.13
Ge
0.72
1.72
Sn
0.08
15.5
GaxIn1−xAs
1.43–0.36
0.87–3.44
GaxIn1−xAsyP1−y
1.36–0.36
0.92–3.44
Rj
ip
Rs
VL
RL
Cj
Fig. 10.6
Equivalent circuit model of a PIN photodetector.
where λc is known as cutoff and it deﬁnes a usable spectrum. The practical formula is
λc = 1.24
Eg
,
λc is in µm
and
Eg in eV
The applied high electric ﬁeld causes electrons and holes to separate. They subsequently
ﬂow to n (electrons) and p (holes) regions and produce ﬂow of current in the external circuit
known as photocurrent.
Different semiconductor materials have different bandgaps and therefore different cutoff
wavelengths. They are used as detectors in different parts of the electromagnetic spectrum.
Bandgaps and cutoff wavelengths for some semiconductors and compounds are summarized
in Table 10.1.
An equivalent circuit of PD is shown in Fig. 10.6 [1]. It consists of a current source,
parallel junction resistance R j, which is equivalent to the differential resistance of the diode.
Rj is typically large, around 106 , and usually it is ignored in the analysis.Cj is the junction
capacitance; Rs is the series resistance due to bulk and contact resistance and typically is a
few ohms. RL is the load resistance. In a typical analysis Rj and Rs are neglected.
The spectral function VL(ν) of the output voltage is related to the spectral function of the
photocurrent iP(ν) as
VL(ν) = iP(ν)
RL
1 + j2πνRLCj
(10.4)

246
Optical receivers
(a)
(b)
Si-InP substrate
InP buffer
Electric
field
Schottky
junction
Incident light
Graded layer
InGaAs
(Photon absorption)
Ti/Au metal contacts
InAlAs
+
–
Fig. 10.7
Schematic of a metal-semiconductor-metal (MSM) photodetector. Top view of the structure (a) and its cross-section
view (b).
The previous equation is obtained by solving Kirchoff’s loop equation. Equivalent
impedance is
1
Ze
= 1
RL
+
1
1
jωCj
= 1
RL
+ jωCj = 1 + jωCjRL
RL
Using VL(ν) = iP(ν)·Ze, Eq. (10.4) follows. Frequency bandwidth is therefore determined
by the time constant CjRL. One wants to keep this time constant small in order to achieve
a large bandwidth.
We ﬁnish this section with a brief discussion of an integrated optical receiver using
a metal-semiconductor-metal (MSM) photodetector, which is shown in Fig. 10.7. The
MSM detector structure consists of an interdigital pattern of metal ﬁngers deposited on a
semiconductor substrate and a typical vertical PIN detector [6]. Electric potential is applied
between alternate ﬁngers creating an electric ﬁeld which sweeps photogenerated electrons
and holes to the positive and negative electrodes, respectively.
This structure shows several improvements compared to traditional designs, like a signif-
icant improvement in sensitivity. Most of the improvements result from the lateral design.
10.2.2 Performance parameters of photodetectors
Main parameters which determine characteristics of PD are [7]: dark current, spectral
response, quantum efﬁciency, noise, detectivity, linearity and dynamic range and speed and
frequency response. We will now discuss them in more detail.
Dark current
Dark current is the current ﬂowing in the PD without incoming light. Typical values for
popular semiconductors are shown in Table 10.2.

247
Photodetectors
Table 10.2 Dark currents for different semiconductors and their compounds.
Semiconductor
Dark current (nA)
Si
0.1–1
Ge
100
InGaAsP
1–10
Quantum efficiency
Quantum efﬁciency is a measure of the efﬁciency of the generation of the electron-hole
pairs (EHP). It is deﬁned as [8]
η = number of free EHP generated
number of incident photons
= Iph/e
P0/hν
(10.5)
Here Iph is the photocurrent ﬂowing in the external circuit, e is the electron’s charge, P0 is
the incident optical power and hν is the energy of a single photon.
Responsivity
It is also known as spectral responsivity. It is deﬁned as [8]
R = Iph
P0
(10.6)
Responsivity speciﬁes the photocurrent generated per unit optical power. It can be expressed
as
R = η e
hν = ηeλ
hc
(10.7)
Ideal responsivity is therefore a linear function of wavelength λ, see Fig. 10.8.
Speed of response
It determines how PD responds to an optical signal. A typical response to a pulse is shown
in Fig. 10.9.
Speed of response is determined by the RC time constant. In terms of parameters of
previously introduced equivalent circuit, the rise time τr is given by
τr = 2.19 · RL · Cj
The evaluation of τr is left as an exercise. Time response is directly related to the frequency
response. The 3-dB bandwidth is [9]
fs−dB =
1
2πRLCj

248
Optical receivers
Wavelength (μm)
Responsivity (A/W)
Ideal photodetector
= 0.9
1.1
0.7
0.9
0.2
0
0.4
0.8
1.0
0.6
Si
η
Fig. 10.8
Typical current responsivity versus wavelength for Si. Also shown is the responsivity of an ideal photodiode with
quantum efficiency η = 0.9.
t
1
90%
t
τ
is
Ps
r
Fig. 10.9
Typical response of a photodetector to a square-pulse signal.
10.2.3 Photodetector noise
Typical optical signals arriving at the receiver front end are very weak. They are, therefore,
signiﬁcantly affected by various noise sources.
There are several physical processes which contribute to noise. For example, the APD
generates noise in the avalanche process and optical ampliﬁers produce noise due to am-
pliﬁed spontaneous emission (ASE). In addition, there is always a quantum noise which
exists in all devices and sets a fundamental lower limit on noise power.
The working parameter characterizing the photodetector is the signal-to-noise ratio
(SNR), which is deﬁned as [10]
S
N =
signal power from photocurrent
photodetector noise power + ampliﬁer noise power
(10.8)

249
Photodetectors
Noise appears as random ﬂuctuations in a signal. A typical measure of noise is associated
with the variance or the mean square deviation of the signal s, which is deﬁned as [7]
σ 2
s = (s −s)2 = s2 −s2
The mean value (average) s is deﬁned as
s =

s
p(s) s
where p(s) is the probability of the measured signal having a value s and the sum is
evaluated over all possible values obtained from measuring the signal.
Noise in a signal s can be represented by random variable sn:
sn = s −s
If in the device (or system) there are two or more simultaneously present noise sources
sn1, sn2, . . . which are independent, their combined effect is found by adding their mean
square values (or their powers):
s2n = s2
n1 + s2
n2 + · · ·
In terms of the above quantities, the SNR is expressed as
SNR = s2
s2n
= s2
σ 2s
or
SNR = 10 log s2
σ 2s
[dB]
Main types of noise arising in a photodetector will now be summarized.
Shot noise
Shot noise is due to random distribution of electrons generated in the photodetector. It is
associated with the quantum nature of photons arriving at the photodetector which gener-
ates carriers. Photons arrive at the photodetector randomly in time due to their quantum-
mechanical nature. Their randomness is described by Poisson statistics. The resulting
expression for shot noise of current in the photodetector is [4], [7]
i2s = 2eBis
(10.9)
where e is the electron’s charge, B is the bandwidth and is is the average value of signal
current.
Thermal noise
Thermal noise or Johnson noise is due to the random motion of electrons in the resistor R.
It is modelled as a Gaussian random process with zero mean and autocorrelation function
given by [4]
4kBT
R
δ(τ )

250
Optical receivers
L
R
is
Cj
Fig. 10.10
Equivalent circuit model of a PIN photodetector with an amplifier.
where δ(τ ) is the Dirac delta function. Thermal noise power in a bandwidth B is [7]
ps,th = 4kBT B
(10.10)
where kB = 1.38×10−23 J/K is the Boltzmann’s constant and T is the absolute temperature.
Thermal noise can be expressed as a current source [4], [7]
i2
s,th = 4kBT
R
B ≡I2
T B
(10.11)
Here IT is the parameter used to specify standard deviation in units of pA/
√
Hz. Its typical
value is 1pA/
√
Hz [2].
10.2.4 Detector design
In this section we perform a simple analysis of a PIN photodetector in the presence of noise
[11]. Using results 10.6 and 10.7, the signal current of the detector is
is = ηeλ
hcP
(10.12)
where P is the optical power coming to the detector at wavelength λ. Equivalent circuit of
a PIN photodetector with an ampliﬁer is shown in Fig. 10.10. It is a simple modiﬁcation of
the circuit shown in Fig. 10.6.
Noise generated in the ampliﬁer is essential for the operation. Ampliﬁer noise is rep-
resented [11] as Johnson noise originating in the load resistor RL. Using Eq. (10.11), the
signal-to-noise ratio is
S
N =
i2
s · RL
i2
s,yh · RL
=
i2
s · RL
4kB · T · B
(10.13)
where B is the bandwidth and T is the resistor’s temperature. The S
N ratio cannot increase
indeﬁnitely by increasing value of RL because of the effect of junction capacitance Cj. In
the typical situation, the bandwidth is determined by

RL · Cj
−1. Using the expression for
the bandwidth B =

2π · RL · Cj
−1 (see problem), Eq. (10.13) takes the form
S
N =
i2
s
8kB · T · B2 · Cj
(10.14)

251
Receiver analysis
10
6
10
7
10
8
10
9
10
10
10
−10
10
−8
10
−6
10
−4
Detector bandwidth (Hz)
Minimum signal power (W)
500 K
1500 K
Fig. 10.11
Plot of Pmin versus bandwidth for PIN detector for three values of temperature (1500 K, 1000 K and 500 K).
Minimum detectable signal is,min can be determined from the above by setting S
N = 1. One
ﬁnds
is,min = 2 · B ·

2π · kB · T · Cj
1/2
(10.15)
Minimum detectable optical power is determined from Eq. (10.12) as
Pmin = 2hc
ηeλ · B ·

2π · kB · T · Cj
1/2
(10.16)
The plot of Pmin versus bandwidth B is shown in Fig. 10.11. The following parameters were
assumed: Cj = 1pF, η = 1, T = 1000 K, λ = 0.85 µm. MATLAB code is provided in an
Appendix, Listing 10A.1.
10.3 Receiver analysis
Optical detection theory is extensively discussed, e.g. by Einarsson [12]. The problem in-
volves detection of signals with noise. In optical systems the information is transmitted
using light which consists of photons. Due to their statistical nature, the transmitted in-
formation will always show random ﬂuctuations. Those ﬂuctuations determine the lowest
limit on transmitted power. In addition, there exist other noise contributions which originate
from various processes. Some of them have already been discussed.
Digital signal under consideration operates at a bit rate B. The time slot (or bit interval)
T is
T = 1
B

252
Optical receivers
and it is the inverse of the bit rate. The input data sequence in the communication system
is denoted by {bk}. The optical power p(t) falling on the photodetector is the sequence of
pulses and it is written as
p(t) =
k=+∞

k=−∞
bk hp(t −k · T )
(10.17)
where k is a parameter denoting the k-th time slot and hp(t) represents the pulse shape of
an isolated optical pulse at the photodetector input.
It is assumed that [5]
1
T
 +∞
−∞
hp(t)dt = 1
(10.18)
so that bk represents the received optical power in the k-th time slot.
Eq. (10.17) is based on the assumption that the system consisting of transmitter and
optical ﬁbre is a linear one and time-invariant. bk in Eq. (10.17) can take two values b0
and b1, which correspond to logical values in the k-th time slot being ZERO or ONE. In
an ideal case one would expect the b0 to be zero so no optical power is transmitted for the
logical ZERO. However, semiconductor lasers always operate at the nonzero bias current,
so there is always some small optical power transmitted.
10.3.1 BER of an ideal optical receiver
There are several ways to measure bit error rate (BER), that is the rate of error occurrence
in a digital data stream. It is equal to number of errors occurring over some time interval
divided by total number of pulses (both ones and zeros).
The simplest method to deﬁne BER is [13]
BER = Ne
Np
= Ne
B · t
(10.19)
where Ne is the number of errors appearing over time interval t, Np is the number of pulses
transmitted during that interval, B = 1/T is the bit rate and T is the bit interval.
The required BER for high-speed optical communication systems today is typically
10−12, which means that on average one bit error is allowed for every terabit of data
transmitted. BER depends on the various signal-to-noise ratio (SNR) of the ﬁbre system,
like the receiver noise level.
Direct optical detection is a process of determining the presence or absence of light
during a bit interval. No light is interpreted as logical ZERO; some of the light present
signals is logical ONE.
In a real life, the detection process is not so simple because of the random nature of
photons arriving at the receiver. Their arrival is modelled as a Poisson random process. The
random process, in time arrivals of photons at the photodetector, is shown in Fig. 10.12.
For an ideal optical receiver we will assume that there are no noise sources in the system.
The average number of photons arriving at the photodetector, with hνc being the energy of

253
Receiver analysis
time
T
Fig. 10.12
RandomarrivalsofphotonsatphotodetectoraredescribedbythePoissonprocess.Eachphotonisrepresentedbyabox
and they all have the same amplitude.
a single photon, is thus
N = p(t)
hνc
(10.20)
where p(t) is power of light signal, h is Planck’s constant and νc is the carrier frequency.
The optical power impinging on the photodetector is expressed by Eq. (10.17).
A simple expression for BER for ideal receiver (no noise) can be obtained as follows
(following Ramaswani and Sivarajan [2]).
The probability that n photons are received during a bit interval T is
e−N
B
 N
B
n
n!
where N is the average number of photons given by Eq. (10.20). Probability of not receiving
any photons (n = 0) is exp (−N/B). Assume equal probabilities of receiving ZERO and
ONE. The BER of an ideal receiver is thus
BER = 1
2e−N/B ≡1
2e−M
(10.21)
where M = N
B =
p
hνcB represents the average number of photons received during one bit.
Expression (10.21) represents BER for an ideal receiver and it is called the quantum
limit. To get a typical bit rate of 10−12, the average number of photons is M = 27 per one
bit.
10.3.2 Error probability in the receiver
Assume that a binary signal current at the photodetector is [4]
itot(t) =
+∞

n=−∞
Bn · hp(t −nTB) + ID + inoise(t)
= iph(t) + ID + inoise(t)
where iph(t) is due to the amplitude modulated pulse signal, ID is the dark current of the
photodiode and inoise(t) is the noise current. Bn takes two values BH and BL corresponding
to logical ONE and logical ZERO, respectively.
Assume (after Liu [4]) that H(ω) is the combined transfer function of the front-end
receiver and equalizer. The output at the equalizer is
yout(t) = itot(t) ⊗h(t)
(10.22)

254
Optical receivers
where ⊗denotes convolution and h(t) corresponds to the transfer function H(ω). The
signal component at the output of the equalizer is
ys(t) = iph(t) ⊗h(t) =
+∞

n=−∞
Bn · hp(t −nTB) ⊗h(t)
≡
+∞

n=−∞
Bn · hp(t −nTB)
The signal output of the equalizer is sampled at the bit rate and compared with a threshold.
This process allows for detection of the amplitudes Bn. The output signal after equalizer
without (constant) dark current is
yout(t) =
+∞

n=−∞
Bn · pp(t −nTB)
where pp(t) contains signal and noise. The above is sampled and the output at time
nTB + τ(0 < τ < TB) is
yout,n(t) ≡yout(nTB + τ ) =

k
Bk · pp([n −k]TB + τ ) + ynoise,n
≡Bn · pp[0] + ISIn + ynoise,n
(10.23)
with the following deﬁnitions:
pp[n] = pp(nTB + τ )
ISIn =

k̸=n
Bk · pp([n −k])
and
ynoise,n = ynoise,out(nTB + τ )
is the sampled noise term. ISIn refers to the intersymbol interference.
In a practical receiver, the decision as which bit (ZERO or ONE) was transmitted in each
bit interval is done by sampling current after equalizer. With the presence of noise, there is
nonzero probability of an error. The errors are typically described by BER (bit error rate).
Introduce yth as a threshold used in error detection. From Eq. (10.23), one can observe
that errors occur when
Bk = BH
when
yout,n < yth
or
Bk = BL
when
yout,n > yth
Therefore, the probability of an error detection is [14]
Perror = p0P

yout,n > yth|Bk = BL

+ p1P

yout,n < yth|Bk = BH

Here p0 and p1 are a priori probabilities for bits ZERO and ONE.

255
Receiver analysis
P(0|1)
P(1|0)
VH
VL
Vthreshold
Fig. 10.13
Determination of bit error rate for a Gaussian process.
The decision taken involves comparison of the measured photocurrent I with a threshold
Ith. If I > Ith, one decides that a ONE bit was transmitted; otherwise for I < Ith a bit ZERO
was transmitted.
10.3.3 BER and Gaussian noise
In optical digital communication the transmitted signal is never perfectly recovered. Noise,
adjacent channel interference, ampliﬁed spontaneous emission, all result in creation of
errors. Additionally, pulses are broadened due to ﬁbre dispersion, device nonlinearity or
slow photodiode response. Created signal distortion is known as an intersymbol interference
(ISI) and it arises when adjacent bits are corrupted. It results in possible detection errors
for the transmitted bits. ISI is random because the binary bits in a digital signal are random.
To minimize ISI, an equalizer is generally used.
We analyse the performance of real receiver with noise [15]. We want to establish
connection between the signal-to-noise ratio (SNR) and BER. By referring to Fig. 10.13,
we assume that VH (high voltage at the output of the receiver) and VL (low voltage at the
output of the receiver) are random variables described by the Gaussian probability density
function (pdf) as
p(x) =
1
√
2π
e−x2
2
(10.24)
BER is deﬁned in terms of two conditional probabilities P(0|1) and P(1|0) as
BER = p0P(0|1) + p1P(1|0)
(10.25)
where p0 and p1 are a priori probabilities for bits ZERO and ONE. Their values are p0 =
p1 = 1
2. Conditional probability P(A|B) for two events A and B is deﬁned as
P(A|B) = P(A · B)
P(B)

256
Optical receivers
3
4
5
6
7
8
10−20
10−15
10−10
10−5
100
Q
Bit Error Rate
Fig. 10.14
Plot of bit error rate versus Q.
The conditional probabilities P(0|1) and P(1|0) are shown in Fig. 10.13. Assuming Gaus-
sian pdf, they are determined as
P(0|1) =
1
√
2π
∞

Q1
e−x2
2 dx
P(1|0) =
1
√
2π
∞

Q2
e−x2
2 dx
where functions Q1 =
Vth−VL
σnoise
and Q1 =
VH−Vth
σnoise
are integration limits. We assume that
distributions of ZERO and ONE are identical and that noise variance σnoise is the same for
both. It follows that the optimum threshold is 1
2 (VH + VL). Thus
Q = Q1 = Q2 = VH −VL
2σnoise
Using deﬁnition (10.25), the BER is evaluated as
BER = 1
2P(0|1) + 1
2P(1|0)
=
1
√
2π
∞

Q
e−x2
2 dx
The above function relates BER to the signal-to-noise ratio Q. It is plotted in Fig. 10.14.
For a typical BER of 10−6, Q = 6. MATLAB code used to create this ﬁgure is shown in
Appendix, Listing 10A.2.

257
Modelling of a photoelectric receiver
The average incident input power P is deﬁned as
P = 1
2 (PH + PL)
(10.26)
where PH and PL are optical powers corresponding to logical ONE and ZERO (high and
low), respectively. Those powers are related to voltages VH and VL introduced earlier as
VH = R · PH · ys,max(t)
(10.27)
VL = R · PL · ys,max(t)
(10.28)
where R is the responsivity of the detector and ys,max(t) is the maximum output voltage of
the receiver during a given bit period. In terms of the above quantities, the average power
P is evaluated as follows:
P = 1
2 (PH + PL) = 1
2
PH + PL
PH −PL
(PH −PL)
= 1
2 ·
1 + PL
PH
1 −PL
PH
· 1
R ·
1
ys,max(t) · (VH −VL)
= 1
2 · 1 + r
1 −r · 1
R · Q ·

n2
out
ys,max(t)
(10.29)
The above expression gives the average incident input power level necessary to obtain a
given BER. In the above derivation, we have used σ 2
noise = n2
out, where n2
out is the variance
of the output noise. We also deﬁned extinction ratio r as
r = PL
PH
(10.30)
For a PIN photodiode, the receiver sensitivity takes the form
ηP = hν
q · 1 + r
1 −r · Q ·

n2
out
ys,max(t)
(10.31)
Ideal sensitivity is obtained where no power is transmitted (r = 0) as
ηP = hν
q · Q ·

n2
out
ys,max(t)
(10.32)
Using the above results, one can analyse receiver sensitivity for various types of noise
ﬁlters. We refer to the literature for a more detailed discussion [15], [14], [4].
10.4 Modelling of a photoelectric receiver
A schematic of the receiver is shown in Fig. 10.15. It is modelled by a ﬁlter function H(ν),
see Geckeler [16]. As a front end it contains an avalanche photodiode, with M being the
multiplication factor of the photocurrent and G the gain factor of an electronic ampliﬁer.

258
Optical receivers
PD
M
G
H(ν)
S (ν)
1
S (ν)
2
s(t)
P1
τ
Fig. 10.15
Block scheme of the receiver which is described by a filter function H(ν) with parameter τ.
Both M and G are assumed to be frequency-independent. Frequency dependence of the
receiver is described by a low-pass ﬁlter function H(ν), which we assume to be a real
function (not complex). Possible phase distortions which will result in function H(ν) being
complex can be compensated by an equalizer.
In Fig. 10.15 S1(ν) is the frequency spectrum of the input, S2(ν) is the output frequency
spectrum, s(t) is the temporal output signal and P1 is the average power arriving at the
photoelectric receiver. Parameter τ characterizes ﬁlter function H(ν).
10.5 Problems
1.
Determine rise time τr for a simple RC circuit. Relate it to 3 dB bandwidth.
2.
Analyse noise in an avalanche photodiode (APD). Determine signal-to-noise ratio in
terms of gain of APD.
3.
Analyse signal limitations for an analogue transmission. Determine signal power in
terms of S/N ratio.
10.6 Projects
1. Conduct small-signal equivalent circuit analysis of a photodetector [1]. Write a MAT-
LAB program. Determine frequency dependence of the small signal impedance of a
photodiode.
2. Analyse frequency response of a photodiode [17]. Determine the upper limit of the
frequency response of GaAs p-n junction photodiode assuming data provided in [17].
Appendix 10A: MATLAB listings
In Table 10.3 we provide a list of MATLAB ﬁles created for Chapter 10 and a short
description of each function.

259
Appendix 10A
Table 10.3 List of MATLAB functions for Chapter 10.
Listing
Function name
Description
10A.1
min power.m
Determines minimum signal power
10A.2
berQ.m
Plots bit error rate versus Q
Listing 10A.1
Function min power.m. MATLAB function which determines minimum
signal power for a PIN photodetector for three values of temperature.
% File name: min_power.m
% Determines minimum signal power required to give S/N ratio of one
% for a PIN detector
clear all
h_Planck = 6.6261d-34;
% Planck’s constant (J s)
c_light=299.80d6;
% speed of light (m/s)
k_B= 1.3807d-23;
% Boltzmann constant (J/K)
e=1.602d-19;
% electron’s charge (C)
%
C_j = 1d-12;
% junction capacitance (1pF)
eta = 1;
% quantum efficiency
lambda = 0.85d-6;
% wavelength (0.85 microns)
B = 1d6:1d5:1d10;
% range of detector bandwidth
%
for T_eff = [500 1000 1500]
P_min=(2*h_Planck*c_light/(eta*e*lambda))*sqrt(2*pi*k_B*T_eff*C_j)*B;
loglog(B,P_min,’LineWidth’,1.5)
hold on
end
%
xlabel(’Detector bandwidth (Hz)’,’FontSize’,14);
ylabel(’Minimum signal power (W)’,’FontSize’,14);
text(1d9, 4d-7, ’500K’,’Fontsize’,14)
text(5d7, 4d-7, ’1500K’,’Fontsize’,14)
set(gca,’FontSize’,14);
% size of tick marks on both axes
grid on
pause
close all
Listing 10A.2
Program berQ.m. MATLAB program which plots bit error rate versus Q.
Takes one minute to execute.
% File name: berQ.m
% Plots bit error rate versus Q
syms x
% defines symbolic variable

260
Optical receivers
f=(1/sqrt(2*pi))*exp(-x^2/2);
% defines function for plot
Q_i = 3.5; Q_f = 8; Q_step = 0.5;
% defines range and step
yy = double(int(f,x,Q_i,inf));
for Q = Q_i+Q_step:Q_step:Q_f
y = double(int(f,x,Q,inf));
yy = [yy,y];
end
Qplot = Q_i:Q_step:Q_f;
% defines Q for plot
semilogy(Qplot,yy,’LineWidth’,1.5)
xlabel(’Q’,’FontSize’,14);
ylabel(’Bit Error Rate’,’FontSize’,14);
set(gca,’FontSize’,14);
% size of tick marks on both axes
grid on
pause
close all
References
[1] S. B. Alexander. Optical Communication Receiver Design. SPIE Optical Engineering
Press and Institution of Electrical Engineers, Bellingham, Washington, and London,
1997.
[2] R. Ramaswami and K. N. Sivarajan. Optical Networks: A Practical Perspective.
Morgan Kaufmann Publishers, San Francisco, 1998.
[3] J. C. Cartledge and G. S. Burley. The effect of laser chirping on lightwave system
performance. J. Lightwave Technol., 7:568–73, 1989.
[4] M. M.-K. Liu. Principles and Applications of Optical Communications. Irwin,
Chicago, 1996.
[5] T. V. Muoi. Receiver design of optical-ﬁber systems. In E. E. Bert Basch, ed., Optical-
Fiber Transmission, pp. 375–425. Howard W. Sams & Co., Indianapolis, 1986.
[6] D. L. Rogers. Integrated optical receivers using MSM detectors. J. Lightwave Technol.,
9:1635–8, 1991.
[7] J.-M. Liu. Photonic Devices. Cambridge University Press, Cambridge, 2005.
[8] S. O. Kasap. Optoelectronics and Photonics: Principles and Practices. Prentice Hall,
Upper Saddle River, NJ, 2001.
[9] J. C. Palais. Fiber Optic Communications. Fifth Edition. Prentice Hall, Upper Saddle
River, NJ, 2005.
[10] G. Keiser. Optical Fiber Communications. Fourth Edition. McGraw-Hill, Boston,
2011.
[11] J. Wilson and J. F. B. Hawkes. Optoelectronics. An Introduction. Prentice Hall, En-
glewood Cliffs, 1983.
[12] G. Einarsson. Principles of Lightwave Communications. Wiley, Chichester, 1996.
[13] G. Keiser. Local Area Networks. Second Edition. McGraw Hill, Boston, 2002.

261
References
[14] W. van Etten and J. van der Plaats. Fundamentals of Optical Fiber Communications.
Prentice Hall, New York, 1991.
[15] A. E. Stevens. An integrate-and-dump receiver for ﬁber optic networks. PhD thesis,
Columbia University, 1995.
[16] S. Geckeler. Optical Fiber Transmission System. Artech House, Inc., Norwood, MA,
1987.
[17] A. Yariv and P. Yeh. Photonics. Optical Electronics in Modern Communications. Sixth
Edition. Oxford University Press, New York, Oxford, 2007.

11
Finite difference time domain (FDTD) formulation
The ﬁnite-difference time-domain (FDTD) method is a widely used numerical scheme for
approximate description of propagation of electromagnetic waves. It can be used to study
such phenomena as pulse propagation in various media. It is a simple scheme and can be
mastered relatively fast.
Deﬁnite reference on the subject is a book by Taﬂove and Hagness [1]. Several other
books can be cited: Kunz and Luebbers [2], Sullivan [3], Yu et al. [4], Elsherbeni and Demir
[5]. Also, recently published books by Bondeson et al. [6] and by Garg [7] have instructive
chapters on the FDTD method.
11.1 General formulation
To develop a general formulation, one starts from Maxwell’s equations which we cast in the
form suitable for 1D, 2D and 3D discretizations. In the following, we assume that J = 0
and ρ = 0; i.e there is no ﬂow of current and no free charges. Assume also nonmagnetic
material and therefore set μ = μ0. General Maxwell’s equations are
∇× H = ∂D
∂t
(11.1)
∇× E = −μ0
∂H
∂t
(11.2)
Here E and H are, respectively, electric and magnetic ﬁelds and D is the electric displacement
ﬂux density which is related to electric ﬁeld E. The relation between E and D will be
summarized in later sections for more detailed models.
First we write the above equations in terms of components. The following cases are
typically considered:
1. 1D (one-dimensional) case: inﬁnite medium in y-direction and z-direction and no change
in those directions and therefore ∂
∂y = ∂
∂z = 0.
2. 2D (two-dimensional) case: inﬁnite medium in z-direction and no change in z-direction
and therefore ∂
∂z = 0.
3. 3D (three-dimensional) case: no restriction on variations in all three directions.
In this chapter we will not discuss the 3D case in detail since it requires signiﬁcant
hardware resources for typical calculations.
262

263
General formulation
11.1.1 Three-dimensional formulation
Use general mathematical formula
∇× H =

ax
ay
az
∂
∂x
∂
∂y
∂
∂z
Hx
Hy
Hz

= ax
∂Hz
∂y −∂Hy
∂z

−ay
∂Hz
∂x −∂Hx
∂z

+ az
∂Hy
∂x −∂Hx
∂y

By applying the above expression, Maxwell’s equations can be written as
∂Dx
∂t
= ∂Hz
∂y −∂Hy
∂z
−∂Dy
∂t
= ∂Hz
∂x −∂Hx
∂z
∂Dz
∂t
= ∂Hy
∂x −∂Hx
∂y
(11.3)
−μ0
∂Hx
∂t
= ∂Ez
∂y −∂Ey
∂z
μ0
∂Hy
∂t
= ∂Ez
∂x −∂Ex
∂z
−μ0
∂Hz
∂t
= ∂Ey
∂x −∂Ex
∂y
These are general equations used as a starting point for 3D implementation, see e.g. [1].
11.1.2 Two-dimensional formulation
In the 2D model we assume that ∂
∂z = 0 and evaluate
∇× H =

ax
ay
az
∂
∂x
∂
∂y
0
Hx
Hy
Hz

= ax
∂Hz
∂y −ay
∂Hz
∂x + az
∂Hy
∂x −∂Hx
∂y

where ax, ay, az are (as before) unit vectors deﬁning coordinate system. Using the above
expression, Maxwell’s equations in terms of components become
ax
∂Hz
∂y −ay
∂Hz
∂x + az
∂Hy
∂x −∂Hx
∂y

= ax
∂Dx
∂t + ay
∂Dy
∂t + az
∂Dz
∂t
ax
∂Ez
∂y −ay
∂Ez
∂x + az
∂Ey
∂x −∂Ex
∂y

= −μ0

ax
∂Hx
∂t + ay
∂Hy
∂t + az
∂Hz
∂t

The above equations are then usually split into two groups, see [1] and [8].

264
Finite difference time domain (FDTD) formulation
Group 1:
∂Dx
∂t
= ∂Hz
∂y
(11.4)
∂Dy
∂t
= −∂Ez
∂x
(11.5)
∂Hz
∂t
= −μ0
∂Ey
∂x −∂Ex
∂y

(11.6)
Group 2:
∂Hx
∂t
= −1
μ0
∂Hz
∂y
(11.7)
∂Hy
∂t
=
1
μ0
∂Ez
∂x
(11.8)
∂Dz
∂t
= ∂Hy
∂x −∂Hx
∂y
(11.9)
The ﬁrst group is called TEx mode by Taﬂove and TE to z polarization by Umashankar,
and the group 2 is called TMz mode by Taﬂove and TM to z polarization by Umashankar.
11.1.3 One-dimensional model
In one dimension, the medium extends to inﬁnity in the y-direction and z-direction. There-
fore ∂
∂y = ∂
∂z = 0. Using the following result,
∇× E =

ax
ay
az
∂
∂x
0
0
Hx
Hy
Hz

= −ay
∂Hz
∂x + az
∂Hy
∂x
one can write Maxwell’s equations in two groups according to ﬁeld vector components.
First group is
∂Hy
∂t
=
1
μ0
∂Ez
∂x
(11.10)
∂Dz
∂t
= ∂Hy
∂x
(11.11)
Taﬂove [1] classiﬁes this group as the x-directed, z-polarized TEM mode. It contains Dy
and Hy.
The second group is
∂Hz
∂t
= −1
μ0
∂Ey
∂x
(11.12)
∂Dy
∂t
= −∂Hz
∂x
(11.13)
This group is referred to as the x-directed, y-polarized TEM mode. It contains Dy and Hz.
In the following, we will concentrate on group 2. The equations describe wave propagating

265
General formulation
0
10
20
30
40
50
0
0.2
0.4
0.6
0.8
1
time
amplitude
0
20
40
60
80
100
−1
−0.5
0
0.5
1
time
amplitude
Fig. 11.1
Gaussian pulse (left), and modulated Gaussian pulse (right).
in the x-direction with electric ﬁeld oriented in the y-direction and magnetic ﬁeld oriented
in the z-direction.
We ﬁnish this section with a discussion of the Gaussian pulse and modulated Gaussian
pulse.
11.1.4 Gaussian pulse and modulated Gaussian pulse
In practice one often analyses propagation of the Gaussian pulse or modulated Gaussian
pulse. A Gaussian pulse centred at t0 is deﬁned as
g(t) = exp
!
−(t −t0)2
w2
"
(11.14)
where w is the width of the pulse in space. Deﬁne also the modulation signal as
m(t) = sin (2π f0 · t)
(11.15)
where f0 = c/λ0 = 1/T0. Here T0 is the period of the modulation signal m(t). A continuous
Gaussian pulse is created by multiplying Eqs. (11.14) and (11.15):
g(t) = sin (2π f0 · t) · exp
!
−(t −t0)2
w2
"
(11.16)
Its discretized version is
g(n) = sin (2π f0 · n · t) · exp
!
−(n · t −t0)2
w2
"
(11.17)
In Fig. 11.1 we plot Gaussian and modulated Gaussian pulses. The results were obtained
with MATLAB code presented in Appendix, Listings 11A.1 and 11A.2.

266
Finite difference time domain (FDTD) formulation
11.2 One-dimensional Yee implementation without dispersion
In this section, we discuss the basic implementation of FDTD method in 1D. It is known
as the 1D-Yee algorithm since it was ﬁrst proposed by Yee [9] for the 3D case. We also
introduce the concept of a staggered grid [3], [7]. To illustrate basic principles of FDTD
method, let us develop ﬁrst the 1D lossless case.
11.2.1 Lossless case
Our formulation is based on the second group of Eqs. (11.12) and (11.13). We supplement
those equations with the relation between Dy and Ey, which for the free space is
Dy = ε0Ey
(11.18)
The equations take the form
∂Hz
∂t
= −1
μ0
∂Ey
∂x
(11.19)
∂Ey
∂t
= −1
ε0
∂Hz
∂x
(11.20)
In order to introduce 1D Yee discretization, let us introduce the following notation:
Ey(i · x, n · t) ≡

Ey
n
i
Hz(i · x, n · t) ≡

Hy
n
i
To discretize Eqs. (11.19) and (11.20), we use central-difference approximation for space
and time derivatives. They are second-order accurate in the space and time increments:
∂Ey
∂x (i · x, n · t) =
(Ey)n
i+1/2 −(Ey)n
i−1/2
x
+ O(x)2
∂Ey
∂t (i · x, n · t) = (Ey)n+1/2
i
−(Ey)n−1/2
i
t
+ O(t)2
In the Yee algorithm [9] E and H components are interleaved in the space lattice at intervals
of x/2. Such an approximation is called the staggered grid approximation. They are also
interleaved in time at intervals t/2, see Fig. 11.2.
At time t = 0, values of Ey are placed at x = i · x, with i = 0, 1, 2, . . . N. (Total N + 1
components).
At time t = 1
2t, values of Hz are placed at x = (i −1
2 ) · x, with i = 1, 2, . . . N. (Total
N components).
In general
(Ey)n
i = Ey((i −1) · x, n · t),
i = 1, 2, . . . N + 1; n = 0, 1, 2 . . .
(Hz)n
i = Hz

i −1
2

· x,

n −1
2

· t

,
i = 1, 2, . . . N; n = 0, 1, 2 . . .

267
One-dimensional Yee implementation without dispersion
time
Hz
Hz
Hz
Hz
Hz
Hz
Hz
Hz
x
Ey
Ey
Ey
Ey
Ey
Ey
Ey
Ey
Ey
Ey
x = 0
t = 0
2
1
Δt
Δt
Δt
Δx
2Δx
3Δx
4Δx
2
3
Fig. 11.2
One-dimensional formulation of the FDTD method. Orientations of Hz and Ey fields are shown.
Ey
Hz
n+1
n
n+2
i+-1
2
i--1
2
i+1
i-1
i-2
i
n+-1
2
Fig. 11.3
Visual illustration of numerical dependencies in the 1D FDTD method.
Initial values (corresponding to n = 0), i.e. E(. . . ,t = 0) and H(. . . ,t = 0), in most cases
are set to zero.
The discretized equations are
(Ey)n+1/2
i
−(Ey)n−1/2
i
t
= −1
ε0
(Hz)n
i+1/2 −(Hz)n
i−1/2
x
(Hz)n+1
i+1/2 −(Hz)n
i+1/2
t
= −1
μ0
(Ey)n+1/2
i+1
−(Ey)n−1/2
i+1
x
The space-time interdependencies of Ey and Hz ﬁelds at different grid points are illustrated
in Fig. 11.3. Here, squares represent Ey ﬁeld and circles represent Hz ﬁeld. One can observe
that the value of a ﬁeld at any point is determined by three previous values: two from two
neighbours of opposite ﬁeld from the previous half time step and one from the same ﬁeld
at a single previous time step.

268
Finite difference time domain (FDTD) formulation
0
50
100
150
200
−1
−0.5
0
0.5
1
Ey
FDTD cells
0
50
100
150
200
−1
−0.5
0
0.5
1
Hz
FDTD cells
Fig. 11.4
FDTD simulation of a Gaussian pulse after several time steps.
Constants ε0 and μ0 appearing in these equations differ by several orders of magnitude.
Therefore, one usually introduces a new scaled variable deﬁned as [3]
1Ey =
 ε0
μ0
Ey
Scaled equations are
1En+1/2
y
(i) = 1En−1/2
y
(i) −
1
√ε0μ0
t
x

H n
z (i + 1/2) −H n
z (i −1/2)

H n+1
z
(i + 1/2) = H n
z (i + 1/2) −
1
√ε0μ0
t
x
+
1En+1/2
y
(i + 1) −1En+1/2
y
(i)
,
In our simulations, due to stability reasons we set
1
√ε0μ0
x
t = 1
2
(11.21)
The value of v = x/t is chosen to be the maximum phase velocity of the wave expected
in the medium. The above system has been implemented. The MATLAB program is shown
in Appendix, Listing 11A.3. Two versions of MATLAB code have been produced: one of
which uses regular loop and one that takes advantage of parallel capabilities of MATLAB.
The reader should analyse speed of operation for both versions.
The results of propagation of Gaussian pulse using that code are shown in Fig. 11.4.

269
One-dimensional Yee implementation without dispersion
11.2.2 Determination of cell size
In one dimension the cell size is just x. In 2D it is a square and a cube in 3D. The
fundamental question is how to determine size of basic cell.
For a detailed discussion we refer to the book by Kunz and Luebbers [2]. For us, it is
enough to notice that cell size should be much less than the smallest wavelength and typical
rule is to take it as λ/10. Such choice should provide accurate results.
11.2.3 Dispersion and stability
Here, we discuss some general properties of the wave equation. It was formulated before.
Its discretized version is (here we use index r instead of i to avoid conﬂict with a symbol
i =
√
−1)
En+1
r
−2En
r + En−1
r
t2
= c2 En
r+1 −2En
r + En
r−1
x2
(11.22)
As usual, n refers to time and r is the space index. Explicitly En
r = E(r · z, n · t). The
dispersion relation for Eq. (11.22) is found by assuming
En
r = ei(ω·n·t−k·r·x)
Substituting these assumptions into Eq. (11.22) gives

eiω·t·(n+1) −2eiω·t·n + eiω·t·(n−1)
e−ik·r·x
= c2t2
x2

e−ik·z·(r+1) −2e−ik·r·x + e−ik·x·(r−1)
eiω·t·n
Dividing the above by exp[i (ω · n · t −k · r · x)]:
eiω·t −2 + e−iω·t = c2t2
z2

e−ik·z −2 + eik·z
The above can be written as a square:

eiω·t/2 −e−iω·t/22 = c2t2
x2

eik·x/2 −e−ik·x/22
Finally, using trigonometric relation eiα−e−iα = 2i sin α, one obtains formula for numerical
dispersion:
sin 1
2ω · t = ±ct
x sin 1
2k · x
(11.23)
The important case is that of linear dispersion, i.e. when ω = c · k. Eq. (11.23) then holds
when x = ct. For such a linear case different frequency components propagate with
the same speed, just c. For nonlinear dispersion relations, different frequencies of a pulse
numerically propagate with different velocities and therefore pulse will change shape.
Introduce parameter
α = c t
z
(11.24)

270
Finite difference time domain (FDTD) formulation
0
1
2
3
4
0
0.5
1
1.5
2
2.5
3
3.5
k Δ x
ω Δ z /c
α = 1
α = 0.8
α = 0.2
Fig. 11.5
Illustration of numerical dispersion for various values of parameter α.
In Fig. 11.5 we showed numerical dispersions as described by Eq. (11.23) for several values
of parameter α. MATLAB code is shown in Appendix, Listing 11A.4. Depending on the
value of α, one can distinguish the following cases:
1. α = 1. In this case t = x
c . Numerical dispersion is linear and given by ω = ±c·k. This
choice of time step t is called the magic time step [10]. In this case wave propagates
exactly one cell (or x) per time step in both x-directions.
2. α < 1. In this case t < x
c . One observes numerical dispersion which increases when
α decreases.
3. α > 1. In this case t > x
c . This inequality implies that numerical front propagates
faster than physical speed (given by c). In this case, the scheme becomes unstable.
Because of its importance, we provide next a separate discussion of the stability criterion.
11.2.4 Stability criterion
Stability criterion imposes condition on x
t ratio. It is known as Courant-Friedrichs-Levy
(CFL) condition [11]. It explains convergence of various schemes.
For the 1D model, the CFL condition is illustrated in Fig. 11.6. Each row of points
represents the sampling points in space at a given instant of time (say n). The solution at
point A is determined using previous values at the indicated points. In the ﬁgure we show
characteristics which correspond to stable (left) and unstable (right) situations.
The stability criterion summarizes the physical fact that speed of numerical propagation
should not exceed the physical speed. A summary of stability criteria for various dimensions
is presented in Table 11.1 [10].

271
One-dimensional Yee implementation without dispersion
Table 11.1 Summary of stability criteria for various dimensions.
Dimensionality
Criterion
1D medium
v t ≤x
2D medium
v t ≤
(
1
x2 +
1
y2
)−1/2
3D medium
v t ≤
(
1
x2 +
1
y2 +
1
z2
)−1/2
t
x
A
Δt
Δx
i
i+1
i-1
n
n-3
n-1
n-2
i-2
i+2
t
x
A
i
i+1
i-1
n
n-3
n-1
n-2
i-2
i+2
Fig. 11.6
Illustration of the CFL condition. For the parameters chosen within the dashed lines, the propagation is stable (left
figure) and becomes unstable (right figure.)
11.2.5 One-dimensional model with losses
When we consider ohmic losses, Maxwell’s Eq. (11.1) is modiﬁed as
∇× H = ∂D
∂t + σE
(11.25)
where σ is the conductivity.
The discretization of Eqs. (11.25) and (11.2) with losses is done in a similar way as for
the lossless case. The resulting equations after scaling are
(Ey)n+1/2
i
−(Ey)n−1/2
i
t
= −
1
εr√ε0μ0
(Hz)n
i+1/2 −(Hz)n
i−1/2
x
−
σ
2εrε0

(Ey)n+1/2
i
+ (Ey)n−1/2
i

(11.26)
and
(Hz)n+1
i+1/2 −(Hz)n
i+1/2
t
= −1
μ0
(Ey)n+1/2
i+1
−(Ey)n−1/2
i
x
(11.27)

272
Finite difference time domain (FDTD) formulation
time
boundary
boundary point
direction of
travelling wave
x
i = 0
i = 1/2
i = 1
tn = nΔt
tn+ _ = (    )Δt
1
2
n+ 1
2_
Fig. 11.7
Illustration of propagating wave close to the left boundary.
When selecting the time step given by Eq. (11.21), one arrives at the following equations:
(Ey)n+1/2
i
−(Ey)n−1/2
i
= −1
2εr

(Hz)n
i+1/2 −(Hz)n
i−1/2

−σt
2εrε0

(Ey)n+1/2
i
+ (Ey)n−1/2
i

(Hz)n+1
i+1/2 −(Hz)n
i+1/2 = −1
μ0
t
x
(
(Ey)n+1/2
i+1
−(Ey)n−1/2
i
)
Solving the ﬁrst equation for En+1/2
y
(i) gives
(Ey)n+1/2
i
=
1 −σt
2εrε0
1 + σt
2εrε0
(Ey)n−1/2
i
−
1
2εr
(
1 + σt
2εrε0
) 
(Hz)n
i+1/2 −(Hz)n
i−1/2

(11.28)
Implementation and analysis of the above equations is left as a project.
11.3 Boundary conditions in 1D
11.3.1 Mur’s first-order absorbing boundary conditions (ABC)
Here, based on intuitive arguments we derive the so-called Mur’s ﬁrst-order absorbing
boundary conditions [12]. Consider plane wave φ(x,t) travelling left at the left boundary,
see Fig. 11.7.
Reﬂections of this wave will be eliminated if [7]
φ(x,t) = φ(x −x,t + t)
(11.29)
Perform Taylor expansion
φ(x −x,t + t) = φ(x,t) −∂φ
∂x x + ∂φ
∂t t

273
Boundary conditions in 1D
Velocity of the propagating wave is
c = x
t
Substitute into Eq. (11.29) and have
φ(x,t) = φ(x,t) −∂φ
∂x ct + ∂φ
∂t t
or
∂φ
∂x = 1
c
∂φ
∂t
(11.30)
It describes ABC for a plane wave incident from the right.
Finite difference of Eq. (11.30) close to the left boundary is
φn+1/2
1
−φn+1/2
0
x
= 1
c
φn+1
1/2 −φn
1/2
t
(11.31)
The values at half grid points and half time steps are determined as
φn+1/2
i
= 1
2

φn+1
i
+ φn
i

φn
i+1/2 = 1
2

φn
i+1 + φn
i

Substitute the above into Eq. (11.31) and obtain an expression for φn+1
0
:
φn+1
0
= φn
1 + ct −x
ct + x

φn+1
1
+ φn
0

(11.32)
The formula (11.32) determines the new (updated) ﬁeld value at the boundary node point
at x = 0.
The above expression is known as the ﬁrst-order Mur’s absorbing boundary conditions
(ABC). A similar derivation can be performed for right boundary. It is left as an exercise.
11.3.2 Second-order boundary conditions in 1D
We will provide a more rigorous discussion of the boundary conditions based on the work
by Umashankar [8] and Taﬂove [10]. It allows for the introduction of the second-order
Mur’s radiation boundary conditions.
We start with a 1D wave equation for any scalar component of the ﬁeld
∂2U
∂x2 −1
c2
∂2U
∂t2 = 0
(11.33)
Introduce operator L deﬁned as
L = ∂2
∂x2 −1
c2
∂2
∂t2 = D2
x −1
c2 D2
t
The wave equation can therefore be written as
LU = 0

274
Finite difference time domain (FDTD) formulation
0
Δx
U0
U1/2
U1
U2
UN-1
UN
UN-1/2
x
x1
x2
x1/2
xN-1
xN-1/2
xN
Fig. 11.8
Illustration of derivation of ABC in one dimension.
The above operator can be factored as
LU = L+L−U = 0
where L+ = Dx + 1
cDt and L−= Dx −1
cDt.
Suppose that 1D computational region extends from 0 to h; i.e. one has 0 ≤x ≤h.
Engquist and Majda [13] showed that at x = 0 the application of an operator L−to U
exactly absorbs a plane wave propagating towards the boundary. A similar relation holds
for an operator L+ operating at x = h.
In light of the above, the PDE that can be numerically implemented as a ﬁrst-order
accurate ABC at x = 0 grid boundary is
L−U =

Dx −1
cDt

u = 0
Multiplying the above by an operator Dt, one ﬁnds
Dt

Dx −1
cDt

U = 0
In the full form
∂2U
∂t∂x −1
c
∂2U
∂t2 = 0
(11.34)
which is a second-order ABC at x = 0. For the above equation original numerical schemes
have been proposed by Mur [12]. Here, we followed an improved scheme as described by
Taﬂove [10].
Let U represent a Cartesian component of E or H located on the Yee grid, see Fig. 11.8.
We use central differences expansion around an auxiliary grid point x = 1/2 and time
tn = n · t. The derivatives are approximated as follows:
∂2U
∂t∂x

n
1/2
=
1
2t
!
∂U
∂x

n+1
1/2
−∂U
∂x

n−1
1/2
"
=
1
2t
!
U n+1
1
−U n+1
0
x
−U n−1
1
−U n−1
0
x
"
and
∂2U
∂t2

n
1/2
= 1
2
!
∂2U
∂t2

n
0
+ ∂2U
∂t2

n
1
"
= 1
2
!
U n+1
0
−2U n
0 + U n−1
0
t2
+ U n+1
1
−2U n
1 + U n−1
1
t2
"

275
Two-dimensional Yee implementation without dispersion
Substitution of the above results into Eq. (11.34) and solving for U n+1
0
gives
U n+1
0
= U n−1
0
+ ct −x
ct + x

U n+1
1
+ U n−1
0

+
2x
ct + x

U n
1 + U n
0

(11.35)
That expression determines the value of the ﬁeld U (x,t) at the next time tn+1 = (n+1)·t
for x = 0.
In exactly the same way one obtains the updated equation at the right boundary. The
ABC wave equation is
∂2U
∂t∂x + 1
c
∂2U
∂t2 = 0
(11.36)
The derivatives are approximated as follows:
∂2U
∂t∂x

n
N−1/2
=
1
2t
!
∂U
∂x

n+1
N−1/2
−∂U
∂x

n−1
N−1/2
"
=
1
2t
!
U n+1
N
−U n+1
N−1
x
−U n−1
N
−U n−1
N−1
x
"
and
∂2U
∂t2

n
N−1/2
= 1
2
!
∂2U
∂t2

n
N
+ ∂2U
∂t2

n
N−1
"
= 1
2
!
U n+1
N
−2U n
N + U n−1
N
t2
+ U n+1
N−1 −2U n
N−1 + U n−1
N−1
t2
"
Substituting the last result into Eq. (11.36) and solving for U n+1
0
gives
U n+1
N
= U n−1
N−1 + ct −x
ct + x

U n+1
N−1 + U n−1
N

+
2x
ct + x

U n
N + U n
N−1

(11.37)
11.4 Two-dimensional Yee implementation without dispersion
We assume medium with the constitutive relation of the form
Dy = ε0εrEy
Using the above constitutive relation, from the group 2 (Eqs. 11.8) (also called TMz mode)
of Maxwell’s equations one has (ε = ε0εr)
∂Ez
∂t = 1
ε
∂Hy
∂x −∂Hx
∂y

∂Hx
∂t
= −1
μ0
∂Hz
∂y
∂Hy
∂t
= 1
μ0
∂Ez
∂x

276
Finite difference time domain (FDTD) formulation
i
i-1
i+1
i-1/2
i+1/2
j
j+1
j+1/2
j-1
j-1/2
Ez
Ez
Ez
Ez
x
cell
y
Hy
Hy
Hx
Hx
Hx
Hx
Hx
Hx
Δx
Δy
Fig. 11.9
Yee mesh in 2D for the TMz mode.
For 2D discretization we introduce the Yee mesh, shown in Fig. 11.9. A Yee cell is formed
around point (i, j). The electric ﬁeld distribution within each cell is assumed to be constant
and the z-component Ez of electric ﬁeld is deﬁned at the midpoint of each cell. We also
introduce (i, j) = (ix, jy) and Fn(i, j) = F(ix, jy, nt). Maxwell’s equations are
approximated as
En+1
z
(i, j) −En
z (i, j)
t
=
1
ε0εr(i, j)
H n+1/2
y
(i + 1/2, j) −H n+1/2
y
(i −1/2, j)
x
(11.38)
−
1
ε0εr(i, j)
H n+1/2
x
(i, j + 1/2) −H n+1/2
x
(i, j −1/2)
y
H n+1/2
x
(i, j + 1/2) −H n−1/2
x
(i, j + 1/2)
t
= −1
μ0
En
z (i, j + 1) −En
z (i, j)
y
(11.39)
H n+1/2
y
(i + 1/2, j) −H n−1/2
y
(i + 1/2, j)
t
= 1
μ0
En
z (i + 1, j) −En
z (i, j)
x
(11.40)
From the above equations one determines the time-stepping numerical algorithm for the
interior region. For the same reason as in the 1D case, we need to perform scaling. As
before we introduce new scaled variable 1Ez as follows:
1Ez =
 ε0
μ0
Ez
(11.41)
An algorithm for scaled variables is
1En+1
z
(i, j) = 1En
z (i, j) +
t
ε0εr(i, j)
1
√ε0μ0
	
H n+1/2
y
(i + 1/2, j) −H n+1/2
y
(i −1/2, j)
x
−H n+1/2
x
(i, j + 1/2) −H n+1/2
x
(i, j −1/2)
y

(11.42)

277
Absorbing boundary conditions (ABC) in 2D
0
20
40
60
0
20
40
60
0
0.5
1
x
time = 20
y
Ez
0
20
40
60
0
20
40
60
0
0.5
1
x
time = 30
y
Ez
0
20
40
60
0
20
40
60
0
0.5
1
x
time = 40
y
Ez
0
20
40
60
0
20
40
60
0
0.5
1
x
time = 60
y
Ez
Fig. 11.10
Propagation of a Gaussian pulse initiated in the middle and travelling outwards. Four values of time are shown.
H n+1/2
x
(i, j + 1/2) = H n−1/2
x
(i, j + 1/2) −t
y
1
√ε0μ0
1En
z (i, j + 1) −1En
z (i, j)

(11.43)
H n+1/2
y
(i + 1/2, j) = H n−1/2
y
(i + 1/2, j) −t
y
1
√ε0μ0
1En
z (i + 1, j) −1En
z (i, j)

(11.44)
The above equations were implemented in MATLAB for the propagation of Gaussian
pulse. A MATLAB program implementing 2D propagation of the Gaussian pulse is shown
in Appendix, Listing 11A.6.
Propagation of the Gaussian pulse initiated in the middle and travelling outwards is
shown in Fig. 11.10. We illustrate pulse shape at four values of time. One can then observe
its spread in time.
11.5 Absorbing boundary conditions (ABC) in 2D
Absorbing boundary conditions (ABC) in 2D are derived here. We follow the methodology
based on the wave equation used in the 1D case [7] and [10]. The two-dimensional wave

278
Finite difference time domain (FDTD) formulation
h
h
x
y
0
Fig. 11.11
Rectangular region used to illustrate derivations of ABC.
equation for scalar component U is
1
c2
∂2U
∂t2 = ∂2U
∂x2 + ∂2U
∂y2
In a rectangular coordinate system, the plane-wave time-harmonic solution to wave equation
is
U (x, y,t) = ei(ωt−kxx−kyy)
Substituting into a wave equation gives the condition
k2
x + k2
y = ω2
c2 ≡k2
Solution for kx is therefore
kx = ±
(
k2 −k2
y
)1/2
= ±k
&
1 −
k2
y
k2
'1/2
≃±k
&
1 −1
2
k2
y
k2
'
The last result can be written as
kkx = ±k2 ∓1
2k2
y
(11.45)
From the above relation, we can reconstruct partial differential equations that can be nu-
merically implemented as a second-order accurate ABC. First observe that for a rectangular
region shown in Fig. 11.11 near x = 0 boundary, the left travelling wave is described by the
following equation:
1
c
∂2U
∂x∂t = 1
c2
∂2U
∂t2 −1
2
∂2U
∂y2
(11.46)
Analogously, at the x = h boundary
1
c
∂2U
∂x∂t = −1
c2
∂2U
∂t2 + 1
2
∂2U
∂y2

279
Absorbing boundary conditions (ABC) in 2D
y
x
x = 0
U0,j
U
y = (j+1)Δy
y = (j–1)Δy
x = Δx
y = jΔy
0,j+1
U1,j+1
U1,j-1
U0,j-1
U1,j
U1/2,j
Fig. 11.12
Numerical boundary conditions.
To obtain numerical boundary conditions, we approximate the above derivatives around the
central point ( 1
2, j), see Fig. 11.12.
One obtains
∂2U n
1/2,j
∂x∂t
=
1
2t
	
∂U n+1
1/2,j
∂x
−
∂U n−1
1/2,j
∂x

=
U n+1
1,j
−U n+1
0,j
2tx
−
U n−1
1,j
−U n−1
0,j
2tx
The second-order derivative with respect to time t is implemented as an average of time
derivatives at the adjacement points (0, j) and (1, j) as
∂2U n
1/2,j
∂t2
= 1
2
	
∂2U n
0,j
∂t2
+
∂2U n
1,j
∂t2

=
U n+1
0,j
−2U n
0,j + U n−1
0,j
2t2
+
U n+1
1,j
−2U n
1,j + U n−1
1,j
2t2
Also, as an average of the y derivatives we implement
∂2U n
1/2,j
∂y2
= 1
2
	
∂2U n
0,j
∂y2
+
∂2U n
1,j
∂y2

=
U n
0,j+1 −2U n
0,j + U n
0,j−1
2y2
+
U n
1,j+1 −2U n
1,j + U n
1,j−1
2y2
Substitute the above results into Eq. (11.46) and have
U n+1
1,j
−U n+1
0,j
2tx
−
U n−1
1,j
−U n−1
0,j
2tx
= −
1
c22t2
(
U n+1
0,j
−2U n
0,j + U n−1
0,j
+ U n+1
1,j
−2U n
1,j + U n−1
1,j
)
(11.47)
= −
1
4y2
(
U n
0,j+1 −2U n
0,j + U n
0,j−1 + U n
1,j+1 −2U n
1,j + U n
1,j−1
)
From the above we can ﬁnd the time-stepping algorithm for the component of U along
x = 0 boundary, i.e. U n+1
0,j .

280
Finite difference time domain (FDTD) formulation
11.6 Dispersion
Dispersion exists when medium properties are frequency-dependent. Examples include
dielectric constant and/or conductivity which can vary with frequency. Generally, the fol-
lowing situations exist [1]:
• linear dispersion
• nonlinearity
• nonlinear dispersion
• gain.
Here, we will only summarize the most important models of material dispersion and
brieﬂy outline one of the possible numerical approaches to dispersion.
11.6.1 Material dispersion
Usually, the dependencies are established in frequency domain. The deﬁning equation is
D(ω) = ε0εr(ω)E(ω)
The physics is contained in εr(ω). We assume non-conducting media. Main cases are:
• Debye medium (ﬁrst order)
ε(ω) = ε∞+ εs −ε∞
1 + jωt0
(11.48)
• Lorentz medium
εr(ω) = εr +
ε1
1 + 2jδ0
(
ω
ω0
)
−
(
ω
ω0
)2
Speciﬁc analytical and numerical work with the inclusion of dispersion is left as a project.
11.7 Problems
1.
Derive an expression for the ﬁrst-order Mur’s boundary conditions at the right
interface.
2.
Determine the residual reﬂection produced by Mur’s ﬁrst-order ABC. Assume the
existence of the following wave at the boundary:
φ(x,t) = exp (iωt) · [exp (ikx) + R exp (−ikx)]
(11.49)
Analyse reﬂection coefﬁcient R.

281
Appendix 11A
Table 11.2 List of MATLAB functions for Chapter 11.
Listing
Function name
Description
11A.1
gauss.m
Plots Gaussian pulse
11A.2
gauss modul.m
Plots modulated Gaussian pulse
11A.3
f dtd f ree.m
Propagation of Gaussian pulse in a free space
11A.4
num disp.m
Illustrates numerical dispersion
11A.5
gm f .m
Animates Gaussian pulse in a free space (not used in text)
11A.6
f dtd 2D.m
Propagation of Gaussian pulse in 2D
11.8 Projects
1. Implement a 1D FDTD approach with losses. Analyse propagation of Gaussian and
super-Gaussian pulses.
2. Implement boundary conditions for 1D and 2D problems.
3. Use a convolution integral approach which relates D and E:
D(t) = ε∞ε0E(t) + ε0
 t
0
E(t −t′)χ(t′)dt′
(11.50)
to develop discretization scheme for the ﬁrst-order Debye medium as described by
Eq. (11.48). Implement in MATLAB the resulting numerical scheme. For more details,
consult the book by Kunz and Lubbers [2].
4. Conduct similar analysis for the ﬁrst-order Drude dispersion; i.e.
ε(ω) = 1 +
ω2
p
ω ( jνc −ω)
(11.51)
where ωp is the plasma frequency and νc is the collision frequency.
Appendix 11A: MATLAB listings
In Table 11.2 we provide a list of MATLAB ﬁles created for Chapter 11 and a short
description of each function.
Listing 11A.1
Program gauss.m. MATLAB program which creates Gaussian pulse.
% File name: gauss.m
% Plots Gaussian pulse
clear all;
%
t_zero = 20.0;
% center of incident pulse

282
Finite difference time domain (FDTD) formulation
width = 6.0;
% width of the incident pulse
%
N
= 300.0;
time = linspace(0,50,N);
pulse = exp(-0.5*((t_zero - time)/width).^2);
% Gaussian pulse
plot(time,pulse,’LineWidth’,1.5)
xlabel(’time’,’FontSize’,14);
ylabel(’amplitude’,’FontSize’,14);
set(gca,’FontSize’,14);
% size of tick marks on both axes
pause
close all
Listing 11A.2
Program gauss modul.m. MATLAB program which creates a modulated
Gaussian pulse.
% File name: gauss_modul.m
% Plots modulated Gaussian pulse
alpha = 0.6;
mu_0=4*pi*1e-7; e_0=8.854e-12;
% fundamental constants
c=1/sqrt(mu_0*e_0);
% velocity of light
dx = 4.2e-2;
% step in space
dt=alpha*dx/c;
% time step
f_mod = 2e9;
% modulating frequency (2 GHz)
t_0 = 3e-09;
% peak position of Gaussian pulse in time
T = t_0/3;
% pulse width
N_x = 400;
spec = [0:N_x];
for n = 1:100
y(n) = exp(-(((n-1)*dt-t_0)/T).^2).*cos(2*pi*f_mod*((n-1)*dt-t_0));
end
plot(y,’LineWidth’,1.5)
xlabel(’time’,’FontSize’,14); ylabel(’amplitude’,’FontSize’,14);
set(gca,’FontSize’,14);
% size of tick marks on both axes
pause
close all
Listing 11A.3
Function fdtd free.m MATLAB program which describes propagation of
a Gaussian pulse in a free space using the FDTD method.
% File name: fdtd_free.m
% Plots E and H components of Gaussian pulse in a free space
% after some number of time steps using FDTD method
% No animation
clear all;
N_x = 200;
% number of x-cells

283
Appendix 11A
N_time = 100;
% number of time steps
time = 0.0;
E_y = zeros(N_x,1);
% Initialize fields to zero at all points
H_z = zeros(N_x,1);
t_zero = 40.0;
% center of incident pulse
width = 12;
% width of the incident pulse
tic;
% start timer
for istep = 1:N_time
% time loop
time = time + 1;
pulse = exp(-0.5*((t_zero - time)/width)^2); % Gaussian pulse
for i = 2:(N_x)
E_y(120) = pulse;
% location of initial pulse
E_y(i) = E_y(i) - 0.5*(H_z(i) - H_z(i-1));
end
%
for i = 1:(N_x -1)
H_z(i) = H_z(i) - 0.5*(E_y(i+1) - E_y(i));
end
end
toc
% measure elapsed time since last call to tic
subplot(2,1,1); plot(E_y)
ylabel(’E_y’); xlabel(’FDTD cells’)
axis([0 200 -1 1])
subplot(2,1,2); plot(H_z)
ylabel(’H_z’); xlabel(’FDTD cells’)
axis([0 200 -1 1])
pause
close all
Listing 11A.4
Function num disp.m. MATLAB program used to produce Fig. 11.5 to
illustrate numerical dispersion.
% File name: num_disp.m
% Illustrates numerical dispersion
N_max = 10;
% number of points for plot
x = linspace(0,pi,N_max);
hold on
for alpha = [1.0 0.8 0.2]
y = 2*asin(alpha*sin(x/2));
plot(x,y,’LineWidth’,1.5)
end
xlabel(’k \Delta z’,’FontSize’,14)
ylabel(’\omega \Delta x /c’,’FontSize’,14)
set(gca,’FontSize’,14);
% size of tick marks on both axes

284
Finite difference time domain (FDTD) formulation
text(2.5, 3, ’\alpha = 1’,’Fontsize’,12)
text(2.5, 2, ’\alpha = 0.8’,’Fontsize’,12)
text(2.5, 0.5, ’\alpha = 0.2’,’Fontsize’,12)
pause
close all
Listing 11A.5
Function gmf.m. MATLAB program which generates and animates prop-
agation of a Gaussian pulse in a free space.
% File name: gmf.m
% gauss, modulated, free space
% Animation of propagation of Gaussian pulse in a free space
% without boundary conditions
% Program not used in the main text
clear all
alpha = 0.5;
% alpha = c*dt/dx
mu0=4*pi*1e-7;
% magnetic permeability
e0=8.854e-12;
% electric permittivity
c=1/sqrt(mu0*e0);
% velocity of light in a vacuum
dx = 4.2e-2;
% space step
dt=alpha*dx/c;
% time step
f_mod = 1e9;
% modulating frequency
lambda = c/f_mod;
% wavelength
x_end = 400;
t_0 = 3e-09;
% peak position of Gaussian pulse in time
dxl = dx/lambda;
index=[0:x_end];
e=zeros(length(index),1); h=e; e1=e; h0=e;
ha = plot(e);
% get the handle to the plot
set(ha,’EraseMode’,’xor’)
% for simulation of wave propagation
%
t_end = 500;
% number of time steps
for n = 1:t_end
for i=1:400
% simulate for h-nodes
h(i) = h(i) - (e(i+1)-e(i))*dt/dx/mu0;
end
for i=2:400
% simulate for e-nodes
e(i) = e(i) - (h(i)-h(i-1))*dt/dx/e0;
end
% launch Gaussian or modulated Gaussian pulse
T = t_0/3;
% specify pulse width
y(n) = exp(-(((n-1)*dt-t_0)/T).^2).*cos(2*pi*f_mod*((n-1)*dt-t_0));
%
y(n) = exp(-(((n-1)*dt-t_0)/T).^2);
e(1)= y(n);
% Gauss pulse starts here
drawnow;
%refresh data and plot the current condition of the pulse

285
Appendix 11A
set(ha,’YData’,(e));
end
pause
close all
Listing 11A.6
Function fdtd 2D.m. MATLAB program which describes propagation of
a Gaussian pulse in 2D.
% File name: fdtd_2D.m
% Program for finite-difference time-domain method in 2D
% Propagation of Gaussian pulse
clear all;
N_x = 60;
% number of steps in x-direction
N_y = 60;
% number of steps in y-direction
N_steps = 60;
% number of time steps
%
N_x_middle = N_x/2.0;
% middle point; location of pulse
N_y_middle = N_y/2.0;
%
%
delta_x = 0.01;
% cell size
delta_t = delta_x/6e8;
% time step
epsilon = 8.8e-12;
%
% Initialization
E_z = zeros(N_x,N_y);
% Initialize field to zero at all points
H_x = zeros(N_x,N_y);
H_y = zeros(N_x,N_y);
%
t_zero = 20.0;
% center of incident pulse
width = 6.0;
% width of the incident pulse
time = 0.0;
%
for istep = 1:N_steps
% main loop
time = time + 1;
% calculate E_z field
for i = 2:N_x
for j = 2:N_y
E_z(i,j)=E_z(i,j)+0.5*(H_y(i,j)-H_y(i-1,j)-H_x(i,j)+H_x(i,j-1));
end
end
% Gaussian pulse in the middle
pulse = exp(-0.5*((t_zero - time)/width)^2); % Gaussian pulse
E_z(N_x_middle,N_y_middle) = pulse;
%
% Calculate H_x field
for i = 1:(N_x-1)
for j = 1:(N_y-1)

286
Finite difference time domain (FDTD) formulation
H_x(i,j) = H_x(i,j) - 0.5*(E_z(i,j+1) - E_z(i,j));
end
end
%
% Calculate H_y field
for i = 1:(N_x-1)
for j = 1:(N_y-1)
H_y(i,j) = H_y(i,j) + 0.5*(E_z(i+1,j) - E_z(i,j));
end
end
end
%----------- Plotting------------------------------
[x,y] = meshgrid(0:1:N_x-1,0:1:N_y-1);
mesh(x,y,E_z);
xlabel(’\bfx’,’FontSize’,14);
ylabel(’\bfy’,’FontSize’,14);
zlabel(’\bfE_z’,’FontSize’,14);
set(gca,’FontSize’,14);
% size of tick marks on both axes
axis([0 60 0 60 0 1])
text(50,40,0.5, ’time = 60’, ’Fontsize’, 14)
pause
close all
References
[1] A. Taﬂove and S. C. Hagness. Computational Electrodynamics. The Finite-Difference
Time-Domain Method. Artech House, Boston, 2005.
[2] K. S. Kunz and R. J. Luebbers. The Finite Difference Time Domain Method for
Electromagnetics. CRC Press, Boca Raton, 1993.
[3] D. M. Sullivan. Electromagnetic Simulation using the FDTD Method. IEEE Press,
New York, 2000.
[4] W. Yu, X. Yang, Y. Liu, and R. Mittra. Electromagnetic Simulation Techniques Based
on the FDTD Method. Wiley, Hoboken, NJ, 2009.
[5] A. Z. Elsherbeni and V. Demir. The Finite-Difference Time-Domain Method for Elec-
tromagnetics with Matlab Simulations. Scitech Publishing, Inc., Raleigh, NC, 2009.
[6] A. Bondeson, Th. Rylander, and P. Ingelstroem. Computational Electromagnetics.
Springer, New York, 2005.
[7] R. Garg. Analytical and Computational Methods in Electromagnetics. Artech House,
Boston, 2008.
[8] K. R. Umashankar. Finite-difference time domain method. In S. M. Rao, ed., Time
Domain Electromagnetics, pages 151–235. Academic Press, San Diego, 1999.
[9] K. S. Yee. Numerical solution of initial boundary value problems involving Maxwell’s
equations in isotropic media. IEEE Trans. Antennas and Propag., 17:585, 1966.

287
References
[10] A. Taﬂove. Computational Electrodynamics. The Finite-Difference Time-Domain
Method. Artech House, Boston, 1995.
[11] W. H. Press, S. A. Teukolsky, W. T. Vetterling, and B. P. Flannery. Numerical Recipes
in Fortran 90. The Art of Scientiﬁc Computing. Second Edition. Cambridge University
Press, Cambridge, 1992.
[12] G. Mur. Absorbing boundary conditions for the ﬁnite-difference approximation of the
time-domain electromagnetic-ﬁeld equations. IEEE Trans. Electromagn. Compat.,
23:377–82, 1981.
[13] B. Engquist and A. Majda. Absorbing boundary conditions for the numerical simula-
tion of waves. Math. Comp., 31:629–51, 1977.

12
Beam propagation method (BPM)
In this chapter we summarize the beam propagation method (BPM). The method is widely
used for the numerical solution of the Helmholtz equation and also for the numerical
solution to the nonlinear Schroedinger equation (to be discussed in Chapter 15 dealing
with solitons). It is the most powerful technique for studying the propagation of light in
integrated optics. The method was originally introduced by Feit and Fleck in the late 1970s
[1]. The BPM was initially based on FFT algorithm. Later on it has been extended to
ﬁnite-difference based BPM schemes (FD-BPM) and ﬁnite-element BPM (FE-BPM) and
many others. The main characteristics [2] of FD-BPM are the ability to simulate structures
with large index discontinuity, less memory and time consumption in modelling complex
structures, the possibility to incorporate wide-angle and full vector algorithms and the
ability to incorporate transparent boundary conditions.
There is a large number of algorithms available in the literature and almost all of them
are based on the concept of a propagator. Propagators are mathematical ‘objects’ which
propagate ﬁelds from one space coordinate to another. An example of the system where
propagation takes place, known as an optical waveguide, is shown in Fig. 12.1. It splits
input optical signal into two arms, see also Fig. 12.2. The role of BPM is to determine ﬁeld
proﬁle along the waveguide knowing the distribution of refractive index over the whole
waveguide.
There is a huge amount of literature on the principles of BPM and its applications in
integrated photonics. We recommend books by Kawano and Kitoh [3], Pollock and Lipson
[4], Okamoto [5] and Lifante [6]. We start our discussion by illustrating the principles of
BPM in the paraxial approximation.
12.1 Paraxial formulation
12.1.1 Introduction
We start this section by outlining the simplest version of BPM, where one assumes scalar
electric ﬁeld and paraxial approximations which restrict its applicability to the ﬁelds prop-
agating at small angles with respect to the axis of the waveguide (guiding axis), which
we deﬁne as the z axis. The geometry of the waveguide is determined by refractive index
n(x, y, z). The method consists of the repeated propagation of the electric ﬁeld from a
perpendicular plane at a given position along the waveguide to the next parallel plane. To
288

289
Paraxial formulation
Fig. 12.1
Example of a planar waveguide. Here we show the beam splitter.
Fig. 12.2
Schematical illustration of a typical problem solved by BPM. Knowing the input electric field on the left, determine
fields at the output (shown by dotted lines on the right).
illustrate the method, one starts from the wave equation for a monochromatic wave:
∂2E
∂x2 + ∂2E
∂y2 + ∂2E
∂z2 + k2(x, y, z)E = 0
(12.1)
Here, the spatially dependent wavenumber is given by k(x, y, z) = k0n(x, y, z) and k0 =
2π/λ is the wavenumber in free space. The main assumption is that the phase variation due
to propagation along the z axis represents the fastest variation in the ﬁeld E. This variation
is exempliﬁed by introducing slowly varying ﬁeld u and expressing E as
E(x, y, z) = u(x, y, z)e−jβz
(12.2)
where β is a constant that represents the characteristic propagation wave vector, β = n0ω/c.
Here n0 is a reference refractive index which can be, for example, the refractive index of
the substrate or cladding. β represents the average phase variation of the ﬁeld E and it is
known as propagation constant. Substituting Eq. (12.2) into Eq. (12.1) yields the equation
equivalent to the exact Helmholtz for the slowly varying ﬁeld
−∂2u
∂z2 + 2jβ ∂u
∂z = ∂2u
∂x2 + ∂2u
∂y2 + (k2 −β2)u
(12.3)
At this stage one assumes the slow variation of optical ﬁeld in the propagation direction
(SVEA or slowly varying envelope approximation), which requires

∂2u
∂z2
 ≪
2β ∂u
∂z

(12.4)

290
Beam propagation method (BPM)
This approximation allows us to ignore the ﬁrst term on the left hand side of Eq. (12.3)
with respect to the second one. It is also known as Fresnel approximation. Eq. (12.3) thus
reduces to
2iβ ∂u
∂z = ∂2u
∂x2 + ∂2u
∂y2 + (k2 −β2)u
(12.5)
which is known as a Fresnel or paraxial equation. It is a starting point for the description
of the evolution of electric (or magnetic) ﬁeld in inhomogeneous medium, for example an
optical waveguide. It does not describe polarization effects. It determines the evolution of
the ﬁeld for z > 0 given an input u(x, y, z = 0).
The above equation can be expressed as
2jβ ∂u
∂z = Du + 
W u
(12.6)
with the operators on the right hand side being
D =
1
2jβ
 ∂2
∂x2 + ∂2
∂y2

(12.7)

W =
1
2jβ

k2 −β2
(12.8)
Operator D represents free-space propagation (diffraction) and operator 
W describes guid-
ing effects.
Assuming that operators are z-independent, the solution is symbolically written as
u(x, y, z + z) = e(D+
W )zu(x, y, z)
Use the Baker-Hausdorf lemma [7]
eAe
B = eA+Be
1
2 [A,B]
given that A and B each commutes with [A, B]. Using it, we can approximate
u(x, y, z + z) ≈eDze

W zu(x, y, z)
From the above, it follows that actions due to both operators can be considered indepen-
dently.
The action of operator D is better understood in the spectral domain. It will be de-
scribed in the next section. The second operator 
W describes the effect of propagation
in the presence of medium inhomogeneities and its action is incorporated in the spatial
domain.
12.1.2 Operators D and 
W
Consider an equation containing only operator D:
2jβ ∂u(x, y, z)
∂z
=
 ∂2
∂x2 + ∂2
∂y2

u(x, y, z)
(12.9)

291
Paraxial formulation
Deﬁne 2D continuous Fourier transform as
1u(kx, ky, z) =
+∞

−∞
u(x, y, z)e−j(kxx+kyy)dxdy ≡Fx,y {u(x, y, z)}
and its inverse
u(x, y, z) =
+∞

−∞
1u(kx, ky, z)e j(kxx+kyy)dkxdkyF −1
x,y {1u(x, y, z)}
Apply the 2D FT to Eq. (12.9) and have for Fourier components
2jβ ∂
∂z1u(x, y, z) = −(k2
x + k2
y )1u(x, y, z)
Integrate the above from z to z + z and have
1u(x, y, z + z) = e−1
2jβ (k2
x +k2
y )z1u(x, y, z)
≡
H(kx, ky, z)1u(x, y, z)
(12.10)
To analyse operator 
W , introduce the relation
β = k0ne f f
(12.11)
Write also refractive index n as
n = ne f f + n
(12.12)
Substituting the above into Eq. (12.8) gives an expression for operator 
W to the ﬁrst order
in n

W = −jk0n
(12.13)
12.1.3 The implementation using the Fourier transform split-step method
A general scheme of FD-BPM is described by the propagator U, which we use to advance
ﬁeld as
1Et(z + z) = U (z)1Et(z)
PropagatorU can take many forms depending on the chosen BPM technique. Its operation
is illustrated in Fig. 12.3. In practice two versions of BPM are used: 1 + 1 FD-BPM and
1 + 2 FD-BPM. The nomenclature refers to one dimension along the propagation direction
(usually the z-axis) and one or two perpendicular dimensions (along x-axis (1D case) or
in x-y plane (2D case)). Finite difference discretization in the 1 + 1 and 1 + 2 cases is
illustrated in Fig. 12.4.
We illustrate the application of Fourier transform split-step BPM for the propagation of
a two-dimensional Gaussian pulse. The guiding structure is divided into a large number of
segments. During each segment of length z, the optical pulse is propagated as shown in

292
Beam propagation method (BPM)
z
z + Δz
Fig. 12.3
Illustration of the BPM scheme. Field profile is propagated from the position within one plane to a position within
another plane along the z-axis.
X
X
X
X
j
i-1
i-1
i
i
i+1
i+1
j+1
j-1
x
1 + 2 FD-BPM
1 + 1 FD-BPM
y
Fig. 12.4
Illustration of finite-difference discretization for 1D and 2D BPM.
the ﬂow diagram, see Fig. 12.5. The accompanying MATLAB script is shown in Appendix,
Listing 12B.1. The results of a 3D view of pulse before propagation and after propagation
are shown in Fig. 12.6. One can observe spread of pulse width as expected.
12.2 General theory
12.2.1 Introduction
Polarization effects are not included in the previous version of BPM. When one wants to
describe polarization effects, the vector wave equation must replace the scalar Helmholtz
equation used earlier. In this section we will outline a general approach to systematically
handle those effects. General formulation is based on an approach established by W. P.
Huang’s group [8], [9]. As usual, one starts from Maxwell’s equations in the frequency

293
General theory
Initial profile u(x,y,z = 0)
Finished?
Yes
No
u(k ,k ,z) = F {u(x,y,z)}
x
y
xy
~
u(k ,k ,z + z) = H(k ,k
z) u(k ,k ,z)
x
y
x
y
x
y
Δ
Δ
,
~
~
ˆ
u'(x,y,z + z) = F {u(k ,k ,z+ z)}
Δ
Δ
xy
x
y
~
-1
u(x,y,z + z) = e    u'(x,y,z + z)
Δ
Δ
SΔz
^
Fig. 12.5
Flow diagram for the BPM split-step method.
domain:
∇× E = −jωμ0H
(12.14)
∇× H =jωε0n2E
(12.15)
∇· n2E = 0
(12.16)
where we have introduced refractive index n as ε = ε0n2. We separate all quantities into
longitudinal (along z-axis) and transversal components, as follows:
∇= ∇t +z ∂
∂z,
E = Et +zEz,
H = Ht +zHz
where
∇t =
 ∂
∂x, ∂
∂y, 0

,
Et = [Ex, Ey, 0],
Ht =

Hx, Hy, 0


294
Beam propagation method (BPM)
−5
0
5
−5
0
5
0
0.2
0.4
0.6
0.8
1
−5
0
5
−5
0
5
0
0.2
0.4
0.6
0.8
Fig. 12.6
Initial Gaussian pulse (top). Pulse after propagation (bottom).
are the transversal components andz = [0, 0, 1] is the unit vector along z-axis. Eq. (12.16)
can be rearranged as follows:
∇· n2E = 0

295
General theory
or
∇t · n2Et + ∂
∂zn2Ez = 0
or
∇t · n2Et + Ez
∂n2
∂z + n2 ∂Ez
∂z
= 0
∂
∂xn2Ex + ∂
∂yn2Ey + ∂
∂zn2Ez = 0
The z-derivative is
∂Ez
∂z = −1
n2 Ez
∂n2
∂z −1
n2 ∇t · n2Et
(12.17)
If the refractive index varies slowly along z-axis, we can set ∂n2
∂z ≈0 (z-invariant structures
[9]) and obtain
∂Ez
∂z ≈−1
n2 ∇t · n2Et
= −1
n2
∂
∂xn2Ex −1
n2
∂
∂yn2Ey
(12.18)
The above relation is exact for z-invariant systems, i.e. when there is no change of refractive
index n2 along z-axis.
The wave equation is derived by taking ∇× · · · operation on Eq. (12.14). One ﬁnds
∇× ∇× E = −jωμ0∇× H = ω2μ0ε0n2E
(12.19)
In the last step we have used Eq. (12.15). Next, we use the following general relation which
holds for arbitrary vector
∇× ∇× E = ∇(∇· E) −∇2E
Applying it to expression (12.19), we obtain wave equation
−∇2E + ∇(∇· E) = n2k2
0E
(12.20)
where ω2μ0ε0 = k2
0.
Transversal components of the wave equation (12.20) are
−∇2Ex + ∂
∂x (∇· E) = n2k2
0Ex
(12.21)
−∇2Ey + ∂
∂y (∇· E) = n2k2
0Ey
(12.22)
where ∇2Ex = ∂2Ex
∂x2 + ∂2Ex
∂y2 + ∂2Ex
∂z2 . We will analyse the behaviour of Ez component. In the
above equations, term ∇· E is expanded as
∇· E =∂Ex
∂x + ∂Ey
∂y + ∂Ez
∂z

296
Beam propagation method (BPM)
and the last term is replaced using relation (12.18). One ﬁnds
∇· E =∂Ex
∂x + ∂Ey
∂y −1
n2
∂
∂xn2Ex −1
n2
∂
∂yn2Ey
(12.23)
Substituting (12.23) into (12.21), one obtains
∂
∂x
1
n2
∂
∂xn2Ex + ∂2Ex
∂y2 + ∂2Ex
∂z2 + ∂
∂x
1
n2
∂
∂yn2Ey −∂2Ey
∂x∂y + n2k2
0Ex = 0
(12.24)
Similarly, from (12.22) we have
∂
∂y
1
n2
∂
∂xn2Ex −∂2Ex
∂y∂x + ∂2Ey
∂x2 + ∂2Ey
∂z2 + ∂
∂y
1
n2
∂
∂yn2Ey + n2k2
0Ey = 0
(12.25)
The above equations in a matrix form are
⎡
⎢⎢⎣
∂
∂x
1
n2
∂
∂xn2 + ∂2
∂y2 + ∂2
∂z2 + n2k2
0
∂
∂x
1
n2
∂
∂yn2 −
∂2
∂x∂y
∂
∂y
1
n2
∂
∂xn2 −
∂2
∂y∂x
∂
∂y
1
n2
∂
∂yn2 + ∂2
∂x2 + ∂2
∂z2 + n2k2
0
⎤
⎥⎥⎦
Ex
Ey

= 0
(12.26)
Those equations form the starting point for detailed approximations.
12.2.2 Slowly varying envelope approximation (SVEA)
Assume that the transversal ﬁeld components Ex and Ey are of the form
Ex(x, y, z) = ux(x, y, z)e−jβz
(12.27)
Ey(x, y, z) = uy(x, y, z)e−jβz
(12.28)
SVEA requires that

∂2ui
∂z2
 ≪2β

∂ui
∂z

(12.29)
Applying SVEA to term ∂2
∂z2 where (i = x, y), one obtains
∂2
∂z2 Ei =
∂2
∂z2 uie−jβz = e−jβz
∂2ui
∂z2 −2jβ ∂ui
∂z −β2ui

≃e−jβz

−2jβ ∂ui
∂z −β2ui

Using SVEA in Eqs. (12.24) and (12.25) results in the paraxial wave equations [9]
j ∂ux
∂z = Axxux + Axyuy
(12.30)
j ∂uy
∂z = Ayxux + Ayyuy
(12.31)

297
General theory
where the differential operators are deﬁned by [9]
Axxux = 1
2β
 ∂
∂x
1
n2
∂
∂xn2
x + ∂2
x
∂y2 + ∂2
x
∂z2 +

n2k2
0 −β2
ux
(12.32)
Axyuy = 1
2β
	
∂
∂x
1
n2
∂
∂yn2
y −
∂2
y
∂x∂y

uy
(12.33)
Ayxux = 1
2β
	
∂
∂y
1
n2
∂
∂xn2
x −
∂2
x
∂y∂x +
∂2
y
∂x2

ux
(12.34)
Ayyuy = 1
2β
	
∂2
y
∂x2 +
∂2
y
∂z2 + ∂
∂y
1
n2
∂
∂yn2
y +

n2k2
0 −β2

uy
(12.35)
The above can be written in a matrix form:
j ∂
∂z
ux
uy

=
Axx
Axy
Ayx
Ayy
 ux
uy

(12.36)
The evolution of electric ﬁeld described by Eq. (12.36) is known as vectorial BPM [9]. It
takes into account the polarization (Axx ̸= Ayy) and includes coupling between Ex and Ey
(Axy ̸= Ayx).
12.2.3 Semi-vector BPM
Often the coupling between two polarizations is weak and may be neglected. The two
polarizations are decoupled as long as they are not synchronized with some mechanism
within the device. The resulting equations which describe semi-vector formulation are
j ∂ux
∂z = Axxux
j ∂uy
∂z = Ayyuy
Under the semi-vector approximation, the polarization dependencies of the EM waves are
taken into account.
12.2.4 Scalar formulation
If the structure is weakly guiding and/or the polarization dependence is not important, we
can neglect it. The resulting scalar approximation is described by the equation
j ∂u
∂z = Au
(12.37)
where the operator A is
A = 1
2β
 ∂2
x
∂x2 + ∂2
x
∂y2 +

n2k2
0 −β2
The above reproduces a simple theory summarized in the introductory section.

298
Beam propagation method (BPM)
We ﬁnish this section with the remark that similar equations can be derived for the
magnetic ﬁeld, known as the H-formulation (consult [9] for more details).
12.2.5 Finite-difference (FD) approximations
In this section we provide ﬁnite-difference discretization of the above equations. Due to its
simplicity, the FD is the popular numerical method of solving such problems. One replaces
continuous space by a discrete lattice where all ﬁelds are determined at the lattice’s points.
The lattice points are deﬁned by xi = i · x and y j = j · y, see Fig. 12.4. Some details
of discretization are provided in Appendix 12A. The ﬁnal discrete form of the previous
equations for E-formulation is [9] (here we made a replacement ε = n2)
Axxux
= 1
2β
	
Ti,j+1ux(i, j + 1) −

2 −Ri,j+1 −Ri−1,j

ux(i, j) + Ti−1,jux(i −1, j)
x2
+ ux(i, j + 1) −2ux(i, j) + ux(i, j −1)
y2
+

εi,j,k −β2
ux(i, j)

(12.38)
Ayyuy
= 1
2β
	
Ti+1,jux(i + 1, j) −

2 −Ri+1,j −Ri−1,j

uy(i, j) + Ti,j−1uy(i, j −1)
y2
+ uy(i + 1, j) −2uy(i, j) + uy(i −1, j)
x2
+

εi,j,k −β2
k2uy(i, j)

(12.39)
Axyuy
=
1
8βxy
εi+1,j+1,k
εi+1,j,k
−1

ux(i + 1, j + 1) −
εi+1,j−1,k
εi+1,j,k
−1

ux(i + 1, j −1)
−
εi−1,j+1,k
εi−1,j,k
−1

ux(i −1, j + 1) +
εi−1,j−1,k
εi−1,j,k
−1

ux(i −1, j −1)

(12.40)
Ayxux
=
1
8βxy
εi+1,j+1,k
εi,j+1,k
−1

ux(i + 1, j + 1) −
εi−1,j+1,k
εi,j−1,k
−1

ux(i −1, j + 1)
−
εi+1,j−1,k
εi,j+1,k
−1

ux(i + 1, j −1) +
εi−1,j−1,k
εi,j−1,k
−1

ux(i −1, j −1)

(12.41)
In the previous equations
Ti±1,j =
2εi±1,j,k
εi±1,j,k + εi,j,k
(12.42)
Ri+1,j = Ti±1,j −1
(12.43)

299
The 1 + 1 dimensional FD-BPM formulation
are the transmission and reﬂection coefﬁcients across index interfaces between points i and
i + 1. Similarly,
Ti,j±1 =
2εi,j±1,k
εi,j±1,k + εi,j,k
(12.44)
Ri,j±1 = Ti,j±1 −1
(12.45)
are the transmission and reﬂection coefﬁcients across index interfaces between points j and
j + 1.
12.3 The 1 + 1 dimensional FD-BPM formulation
If we can neglect y-dependence of the refractive index (wide waveguides), the scalar
formulation described by Eq. (12.37) can be further simpliﬁed to the 1 + 1 description.
Cross-sectional dependence of the refractive index is n = n(x, z). The relevant Helmholtz
equation is [10]
2jβ ∂u
∂z = ∂2
x u
∂x2 +

n2k2
0 −β2
u
(12.46)
where u is the only electric ﬁeld component of the TE mode of the waveguide. This equation
will now be analysed using two methods. The second method will be implemented.
12.3.1 Simple approach
Here we discuss the FD-BPM formulation as described by Chung and Dagli [10]. First,
replace continuous ﬁeld u(z, x) by its discrete values as
ui ≡u(i · x, z),
i = 0, 1, 2 . . . N −1
Second derivative is approximated as
∂2u
∂x2 = ui−1 −2ui + ui+1
x2
The resulting ﬁnite difference equation is
2jβ ∂ui
∂z = ui−1 −2ui + ui+1
x2
+

n2
i k2
0 −β2
ui ≡fi(z)
Integrate the equation using trapezoidal rule
2jβ
 ui(z+z)
ui(z)
dui =
 z+z
z
fi(z)dz
and have
2jβ [ui(z + z) −ui(z)] = 1
2z [ fi(z + z) + fi(z)]

300
Beam propagation method (BPM)
Using the deﬁnition of fi(z) in the above formula and combining relevant terms, one ﬁnds
[10]
−aui+1(z + z) + bui(z + z) −aui−1(z + z) = aui+1(z) + cui(z) + aui−1(z)
(12.47)
where
a =
z
2x2
b =
z
x2 −1
2z

k2
0n2
i (z + z) −β2
+ 2jβ
c = −z
x2 + 1
2z

k2
0n2
i (z) −β2
+ 2jβ
The scheme results in a tridiagonal system of linear equations. For more details, see [10].
12.3.2 Propagator approach
Approach 1
When one approximates propagation within the waveguide by a one-dimensional approach
using variables (z, x) with z as the propagation direction, the y dependence is irrelevant and
one then sets ∂/∂y = 0. The resulting equation is
2jβ ∂u
∂z = ∂2u
∂x2 + (k2 −β2)u
(12.48)
where k = nk0.
The ﬁnite-difference discretization of Eq. (12.48) in 1D is the following:
j un+1
i
−un
i
h
= 1
2β
un
i+1 −2un
i + un
i−1
x2
+ 1
2β (k2
i −β2)
(12.49)
where k2
i = k2
0 n2
i (x) ≡k2
0 n2(xi). With an introduction of the propagation operator P, the
above scheme is
j un+1
i
−un
i
h
=
N

k=1
Pik un
k
(12.50)
The matrix elements of the operator P are
Pik = 1
2β
1
x2 (δi+1,k −2 δi,k + δi−1,k) + 1
2β (k2
i δi,k −β2)
(12.51)
The solution of Eq. (12.50) can be written as
−→u n+1 =
(←→
I
−jh←→
P
) −→
u n
(12.52)
where −→u n is a column vector which consists of elements un
i , ←→
I
is the identity matrix and
←→
P is the propagation matrix operator having elements given by Eq. (12.51). The scheme
is known as the explicit scheme. It is numerically unstable if the h step is too large.

301
The 1 + 1 dimensional FD-BPM formulation
The improvement is made by applying operator P to the future value of u [11]. From
Eq. (12.50)
j un+1
i
−un
i
h
=
N

k=1
Pik un+1
k
(12.53)
or
−→u n+1 = −→u n −jh ←→
P −→
u n+1
or
(←→
I
+ jh←→
P
) −→
u n+1 = −→
u n
The solution is
−→u n+1 =
(←→
I
+ jh←→
P
)−1 −→
u n
(12.54)
The scheme is called implicit method, and it is stable, see Problem.
The combination of the above two methods is created by taking the average between
implicit and explicit schemes. The new scheme is known as the Crank-Nicolson method
[11]. It is both more accurate and stable. Adding Eqs. (12.50) and (12.53), one obtains (the
Crank-Nicolson scheme)
2j un+1
i
−un
i
h
=
N

k=1
Pik

un
k + un+1
k

(12.55)
In matrix form
−→u n+1 = −→u n −1
2 jh ←→
P

un
k + un+1
k

(12.56)
The above can be expressed as
←→
I
+ 1
2 jh←→
P

−→
u n+1 =
←→
I
−1
2 jh←→
P

−→u n
(12.57)
or
L+ −→u n+1 = L−−→
u n
(12.58)
where
L+ = ←→
I
+ 1
2 jh←→
P
(12.59)
and
L−= ←→
I
−1
2 jh←→
P
(12.60)
From that equation, the ﬁnal form which can be implemented is
−→
u n+1 = L−1
+ L−−→u n
(12.61)

302
Beam propagation method (BPM)
Approach 2
The above derivation can be made more formal. For that purpose, write Eq. (12.48) as
j ∂u
∂z = P · u
(12.62)
where the propagation operator P is deﬁned as
P = 1
2β

∂2
x + (k2 −β2)

(12.63)
The solution of Eq. (12.62) is
u(z) = e−jzPu(0)
or, when one introduces ‘small’ step h:
u(z + h) = e−jhPu(z)
(12.64)
For a small step, the solution (12.64) can be approximated as
u(z + h) ≈(1 −jhP) u(z)
(12.65)
One might notice that the solution (12.64) can also be written as
ejhPu(z + h) = u(z)
(12.66)
or
(1 + jhP) u(z + h) ≈u(z)
(12.67)
or
u(z + h) ≈(1 + jhP)−1 u(z)
(12.68)
To solve this problem, a practically important method is known as the Crank-Nicolson
scheme which is obtained from the solutions (12.65) and (12.68). One thus makes the
following manipulations:
u(z + h) =

1 + jh
2 P
−1
u

z + h
2

=

1 + jh
2 P
−1 
1 + jh
2 P

u(z)
(12.69)
using Eq. (12.65) for h →h/2. The implementation of this scheme is shown in Appendix,
Listing 12A.2. It is used to propagate a Gaussian pulse in an empty space. In our im-
plementation we assumed that β = n · k0. With this choice, last term in propagator P
vanishes.
Proﬁles of a Gaussian pulse at various locations along the propagation direction in a
free space are shown in Fig. 12.7. One can observe reduction of a peak value and also the
effects of reﬂections from the boundaries of the computational window. Elimination of those
reﬂections will be discussed in the next sections. In Fig. 12.8 we show a three-dimensional
view of proﬁles of Gaussian pulses shown in Fig. 12.7.

303
The 1 + 1 dimensional FD-BPM formulation
0
50
100
150
0
0.2
0.4
0.6
0.8
1
Fig. 12.7
Profiles of Gaussian pulses at various locations along z-axis.
−5
0
5
0
20
40
0
0.5
1
x (mm)
z (mm)
Fig. 12.8
Three-dimensional view of profiles shown in Fig. 12.7 of Gaussian pulses propagating in a free space.
Approach 3
Before starting the discussion of boundary conditions, we want to summarize yet another
possible numerical approach to Eq. (12.48). It will then be used to derive details of trans-
parent boundary conditions.
Assuming an equidistant step along x-axis and using standard formulas (h ≡z)
∂u
∂z = un+1
i
−un
i
h
(12.70)
∂2u
∂x2 = ui+1 −2ui + ui−1
x2
(12.71)

304
Beam propagation method (BPM)
the discretized version of Eq. (12.48) is
2jβ un+1
i
−un
i
h
= ui+1 + ui−1
x2
+

−2
x2 +

k2
i −β2
ui
(12.72)
Introduce modiﬁcations on the right hand side of Eq. (12.72):
ui+1 = 1
2

un+1
i+1 + un
i+1

(12.73)
ui−1 = 1
2

un+1
i−1 + un
i−1

(12.74)
k2
i = 1
2

k2
i (n + 1) + k2
i (n)

(12.75)
After new algebraic steps, Eq. (12.72) can be expressed as
un+1
i
+ jh
2
 1
2β
1
x2

un+1
i+1 −2un+1
i
+ un+1
i−1

+ 1
2β

k2
i (n + 1) −β2
un+1
i

= un
i −jh
2
 1
2β
1
x2

un
i+1 −2un
i + un
i−1

+ 1
2β

k2
i (n) −β2
un
i

(12.76)
Note the different n dependence in k2
i . The ﬁnal form of the above in a condensed form is
L+(n + 1)−→u n+1 = L−(n)−→u n
(12.77)
where
L+(n + 1)−→u n+1 = un+1
i
+ jh
2
 1
2β
1
x2

un+1
i+1 −2un+1
i
+ un+1
i−1

+ 1
2β

k2
i (n + 1) −β2
un+1
i

(12.78)
and
L−(n)−→u n = un
i −jh
2
 1
2β
1
x2

un
i+1 −2un
i + un
i−1

+ 1
2β

k2
i (n) −β2
un
i

(12.79)
12.3.3 Transparent boundary conditions
To eliminate reﬂections shown in the previous example, one needs to introduce appropriate
boundary conditions outside the computational window. The popular solution is to introduce
the so-called transparent boundary conditions (TBC) which were invented by Hadley [12],
[13]. TBC have been extensively discussed in the literature [14], [15], [16], [17].
Consider the system with left and right boundaries as shown in Fig. 12.9. Nodes x0 and
xN+1 are outside the system; however, they are needed in the implementation of numerical
scheme.

305
The 1 + 1 dimensional FD-BPM formulation
i=0
1
2
3
N
N+1
N-1
x0
x
x1
x3
xN-1
xN
xN+1
x2
Fig. 12.9
Numbering of nodes used in deriving transparent boundary conditions.
Left-hand boundary
Analyse the left boundary ﬁrst. Assume that near the boundary the ﬁeld is approximated as
u(x, z) ≈A(z) eikxx
(12.80)
For the ﬁrst left points shown in Fig. 12.9, one obtains
u0 = u(x0) = A(z) eikxx0
(12.81)
u1 = u(x1) = A(z) eikxx1
(12.82)
u2 = u(x2) = A(z) eikxx2
(12.83)
From the above equations one ﬁnds
u2
u1
= eikxx2
eikxx1 = eikx(x2−x1) ≡eikxx
(12.84)
and
u1
u0
= eikxx1
eikxx0 = eikx(x1−x0) ≡eikxx
(12.85)
assuming uniform grid; i.e. x = x2 −x1 = x1 −x0. From the above equations, one
determines value of the ﬁeld at the outside point x0:
u0 = u1 eikxx
(12.86)
Wave number kx is determined from known ﬁelds using Eq. (12.84):
kx =
1
ix ln u2
u1
(12.87)
For a ﬁeld travelling leftward (an outgoing wave), the real part of kx, Re(kx) is positive.
The implementation of TBC at the left point for operator Ln+1
+
will be illustrated now.
Consider the ﬁrst element for i = 1, which from Eq. (12.78) is
Ln+1
+ (1) = un+1
1
+ 1
2 jh 1
2β
1
x2 (−2)un+1
1
+ 1
2 jh 1
2β
1
x2 un+1
0
(12.88)
Replacing un+1
0
using Eq. (12.86) gives
Ln+1
+ (1) = un+1
1
+ 1
2 jh 1
2β
1
x2 (−2)un+1
1
+ 1
2 jh 1
2β
1
x2 un+1
1
e jkxx
=

1 + 1
2 jh 1
2β
1
x2 (−2) + 1
2 jh 1
2β
1
x2 ejkxx

un+1
1
= (old term + left correction) un+1
1
(12.89)

306
Beam propagation method (BPM)
The last expression is directly implemented. For operator Ln+1
−
there is only a change of
sign. Similar steps can be taken for the right boundary, which is left as a problem.
Right-hand boundary
At the right-hand boundary, the point xN+1 is outside the system and the ﬁeld there must
be determined. One starts with assuming the following expression for the right-travelling
ﬁeld:
u(x) ≈A(z) e−ikxx
(12.90)
Based on this assumption, we can write ﬁelds at three points around the right boundary:
uN−1 = u(xN−1) = A(z) e−ikxxN−1
(12.91)
uN = u(xN ) = A(z) e−ikxxN
(12.92)
uN+1 = u(xN+1) = A(z) e−ikxxN+1
(12.93)
Here uN−1 and uN are ﬁelds within the system and uN+1 is outside. From the above relations
one determines the outside ﬁeld as
uN+1 = uN e−ikxx
(12.94)
where the wavenumber is
kx =
1
ix ln u2
u1
(12.95)
Cross sections are shown in Fig. 12.10. One can observe that reﬂections were eliminated.
The three-dimensional view of an initial Gaussian pulse at various positions is shown in
Fig. 12.11. MATLAB code is shown in Appendix, Listings 12B.3 and 12B.3.1.
12.4 Concluding remarks
A few years ago an article was published with the title ‘What is the future for beam
propagation methods?’ [18]. The role played by BPM in the simulations of photonic
devices was discussed. The authors also provided an extensive literature summary on the
following issues associated with the BPM: transverse discretization, explicit and implicit
formulations, vector effects, wide angle effects, reﬂective schemes and time domain BPM.
They concluded with highlighting the outstanding issues (as of 2004) of BPM, which
were: ﬂexible meshing, development of wide-angle schemes, improvement of boundary
conditions and creation of hybrid BPM schemes, e.g. with time and/or frequency domain
methods.
A more recent assessment of BPM (and also Eigenmode Expansion Method and Finite
Difference Time Domain) for Photonic CAD is reported by Gallagher [19]. He summa-
rizes the main algorithms used in photonic modelling and discusses their strengths and
weaknesses.

307
Problems
0
50
100
150
0
0.2
0.4
0.6
0.8
1
Fig. 12.10
Comparison of field profiles at various locations along z-axis of Gaussian pulse propagating in a free space by BPM with
transparent boundary conditions. One observes reduction of its peak value and spreading of pulse. No reflections are
observed.
−5
0
5
0
20
40
0
0.5
1
x
z
Fig. 12.11
Three-dimensional view of Gaussian pulse shown in Fig. 12.10 propagating in a free space by BPM with transparent
boundary conditions.
12.5 Problems
1.
Develop H-formulation of BPM.
2.
Perform von Neumann stability analysis for the implicit method.
3.
Based on the example in the text for TBC for the left boundary, develop expressions
for the right TBC.

308
Beam propagation method (BPM)
12.6 Project
1. Implement 1-1 FD-BPM as discussed in Section 12.3.1. Consult work by [10]. Analyse
waveguides described in Ref. [10].
Appendix 12A: Details of derivation of the FD-BPM equation
We describe details of discretization of the earlier equations, like Eq. (12.32). We present
details for the 1D case only. Generalization to 2D is straightforward. A typical term which
needs discretization is
K = ∂
∂x
1
ε
∂
∂x (εu) ≡∂
∂xg(x)
Simple approach
First-order derivative is
∂φ
∂x = φp+1 −φp
x
where φ = εu. Applying the above formula with difference centred around the points p+ 1
2
and p −1
2, one ﬁnds
K = 1
x
	
1
εp+ 1
2
φp+1 −φp
x
−
1
εp−1
2
φp −φp−1
x

where
φp±1 = εp±1up±1
φp = εpup
We also use the following intuitive relations (which will be proved in the next section):
εp+ 1
2 = εp+1 + εp
2
εp−1
2 = εp+1 + εp−1
2
Combining the above relations, one obtains
K =
1
x
2
εp+1 + εp
εp+1up+1 −εpup
x
−1
x
2
εp + εp−1
εpup −εp−1up−1
x
=
2
x2

εp+1
εp+1 + εp
up+1 −

εp
εp+1 + εp
+
εp
εp + εp−1

up +
εp−1
εp + εp−1
up−1


309
Appendix 12A
Taylor series approach
We differentiate
K = ∂
∂x
1
ε
∂
∂x (εu) = ∂
∂x
1
ε
∂ε
∂x

u + ∂2u
∂x2
First term is evaluated as follows. First, we expand around point p:
1
ε
∂ε
∂x

u

p± 1
2
=
1
ε
∂ε
∂x

u

p
± x
2
∂
∂x
1
ε
∂ε
∂x

u

p
Subtracting gives
∂
∂x
1
ε
∂ε
∂x

u

p
= 1
x
	1
ε
∂ε
∂x

u

p+ 1
2
−
1
ε
∂ε
∂x

u

p−1
2

(12.96)
From the above, one can observe that the values of u and ε are needed at intermediate points
p + 1
2 and p −1
2. Those can be obtained by performing expansions
up+1 = up+ 1
2 + ∂u
∂x

p+ 1
2
x
2
and
up = up+ 1
2 −∂u
∂x

p+ 1
2
x
2
Adding the above gives
up+ 1
2 = 1
2(up + up+1)
(12.97)
Expansions of ε gives
εp+1 = εp+ 1
2 −∂ε
∂x

p+ 1
2
x
2
and
εp = εp+ 1
2 −∂ε
∂x

p+ 1
2
x
2
Adding the above gives
εp+ 1
2 = 1
2(εp + εp+1)
(12.98)
Subtracting gives
∂ε
∂x

p+ 1
2
= 1
2(εp+1 −εp)
(12.99)

310
Beam propagation method (BPM)
From Eqs. (12.98) and (12.99) we have
1
ε
∂ε
∂x

p+ 1
2
= 2
x
εp+1 −εp
εp + εp+1
(12.100)
Using Eqs. (12.97) and (12.100), we obtain
1
ε
∂ε
∂xu

p+ 1
2
= 1
x
εp+1 −εp
εp + εp+1
(up + up+1)
(12.101)
In exactly the same way, performing the relevant expansions around point p −1
2 one
ﬁnds
1
ε
∂ε
∂xu

p−1
2
= 1
x
εp −εp−1
εp + εp−1
(up + up−1)
(12.102)
Substituting Eqs. (12.101) and (12.102) into (12.96), we obtain an intermediate result
∂
∂x
1
ε
∂ε
∂x

u

p
=
1
x2
εp+1 −εp
εp + εp+1
(up + up+1) −εp −εp−1
εp + εp−1
(up + up−1)

(12.103)
A complete derivative is obtained by combining discretization for a second derivative
∂2u
∂x2 =
1
x2

up+1 −2up + up−1

with expression (12.103). The result is
K =
∂
∂x
1
ε
∂
∂x (εu)
=
2
x2

εp+1
εp + εp+1
up+1 −εp

1
εp + εp+1
+
1
εp + εp+1

up +
εp−1
εp + εp−1
up−1

The last result is the same as the one obtained by Lidgate [20].
Appendix 12B: MATLAB listings
In Table 12.1 we provide a list of MATLAB ﬁles created for Chapter 12 and a short
description of each function.
Table 12.1 List of MATLAB functions for Chapter 12.
Listing
Function name
Description
12B.1
pbpm.m
Gaussian pulse in free space in the paraxial approximation
12B.2
f d bpm f ree.m
Gaussian pulse in free space (Crank-Nicholson)
12B.3
bpm tbc.m
Transparent boundary conditions
12B.3.1
prop.m
Function called by bpm tbc.m. Performs single step

311
Appendix 12B
Listing 12B.1
Function pbpm.m. Function performs propagation of a two-dimensional
Gaussian pulse using the Fourier transform split-step beam propagation method in the
paraxial approximation.
% File name: pbpm.m
% Propagation of 2D Gaussian pulse by paraxial FT split-step BPM
clear all N= 10; delta_x = 1/N;
x = -5:delta_x:5;
% creation of space arguments
y = -5:delta_x:5;
% creation of space arguments
delta_z = 5.0;
% step size along z-axis
delta_n = 0.4; k_zero = 100;
beta = 20;
% propagation constant
%
u_init=(exp(-x.^2))’*exp(-y.^2);
% initial Gaussian pulse
mesh(x,y,abs(u_init));
% plots original pulse
pause close all
%
k_x = -5:1/N:5;
% creation of Fourier variables
k_y = -5:1/N:5;
% creation of Fourier variables
%
temp = delta_z/(2*beta); H_transfer =
(exp(1i*temp*k_x.^2))’*(exp(1i*temp*k_y.^2)); H_transfer =
fftshift(H_transfer); S_phase = exp(-1i*k_zero*delta_n);
%
for n=1:100
z = fft2(u_init);
zz = z.*H_transfer;
u_prime = ifft2(zz);
u = S_phase.*u_prime;
u_init = u;
end
%
mesh(x,y,abs(u_init))
% plots pulse after propagation
pause close all
Listing 12B.2
Program fd bpm free.m. Illustrates propagation of a Gaussian pulse in a
free space.
% File name: fd_bpm_free.m
% Propagation of Gaussian pulse in a free space by Crank-Nicholson method
% No boundary conditions are introduced
clear all
L_x=10.0;
% transversal dimension (along x-axis)
w_0=1.0;
% width of input Gaussian pulse
lambda = 0.6;
% wavelength

312
Beam propagation method (BPM)
n=1.0;
% refractive index of the medium
k_0=2*pi/lambda;
% wavenumber
N_x=128;
% points on x axis
Delta_x=L_x/(N_x-1);
% x axis spacing
h=5*Delta_x;
% propagation step along z-axis
N_z=100;
% number of propagation steps
plotting=zeros(N_x,N_z);
% storage for plotting
x=linspace(-0.5*L_x,0.5*L_x,N_x);
% coordinates along x-axis
x = x’;
E=exp(-(x/w_0).^2);
% initial Gaussian field
%
% beta = n*k_0. With this choice, last term in propagator vanishes
prefactor = 1/(2*n*k_0*Delta_x^2); main = ones(N_x,1); above =
ones(N_x-1,1); below = above;
P = prefactor*(diag(above,-1)-2*diag(main,0)+diag(below,1)); % matrix P
%
step_plus = eye(N_x) + 0.5i*h*P;
% step forward
step_minus =eye(N_x)-0.5i*h*P;
% step backward
%
z = 0; z_plot = zeros(N_z); for r=1:N_z
z = z + h;
z_plot(r) = z + h;
plotting(:,r)=abs(E).^2;
E=step_plus\step_minus*E;
end;
%
for k = 1:N_z/10:N_z
% choosing 2D plots every 10-th
step
plot(plotting(:,k),’LineWidth’,1.5)
set(gca,’FontSize’,14);
% size of tick marks on both axes
hold on
end pause close all
%
for k = 1:N_z/10:N_z
% choosing 3D plots every 10-th step
y = z_plot(k)*ones(size(x));
% spread out along y-axis
plot3(x,y,plotting(:,k),’LineWidth’,1.5)
hold on
end grid on xlabel(’x (mm)’,’FontSize’,14)
ylabel(’z (mm)’,’FontSize’,14)
% along propagation direction
set(gca,’FontSize’,14);
% size of tick marks on both axes
pause close all
Listing 12B.3
Program bpm tbc.m. Illustrates propagation of Gaussian pulse in a free
space with transparent boundary conditions.
% File name: bpm_tbc.m
% Illustrates propagation of Gaussian pulse in a free space

313
Appendix 12B
% using BPM with transparent boundary conditions
% Operator P is determined in a separate function
clear all
L_x=10.0;
% transversal dimension (along x-axis)
w_0=1.0;
% width of input Gaussian pulse
lambda = 0.6;
% wavelength
n=1.0;
% refractive index of the medium
k_0=2*pi/lambda;
% wavenumber
N_x=128;
% number of points on x axis
Delta_x=L_x/(N_x-1);
% x axis spacing
h=5*Delta_x;
% propagation step
N_z=100;
% number of propagation steps
plotting=zeros(N_x,N_z);
% storage for plotting
x=linspace(-0.5*L_x,0.5*L_x,N_x);
% coordinates along x-axis
x = x’;
E=exp(-(x/w_0).^2);
% initial Gaussian field
%
z = 0;
z_plot = zeros(N_z);
for r=1:N_z
% BPM stepping
z = z + h;
z_plot(r) = z + h;
plotting(:,r)=abs(E).^2;
E = step(Delta_x,k_0,h,n,E);
% Propagates pulse over one step
end;
%
for k = 1:N_z/10:N_z
% choosing 2D plots every 10-th
step
plot(plotting(:,k),’LineWidth’,1.5)
set(gca,’FontSize’,14);
% size of tick marks on both axes
hold on
end
pause
close all
%
for k = 1:N_z/10:N_z
% choosing 3D plots every 10-th step
y = z_plot(k)*ones(size(x));
% spread out along y-axis
plot3(x,y,plotting(:,k),’LineWidth’,1.5)
hold on
end
grid on
xlabel(’x’,’FontSize’,14)
ylabel(’z’,’FontSize’,14)
% along propagation direction
set(gca,’FontSize’,14);
% size of tick marks on both axes
pause
close all

314
Beam propagation method (BPM)
Listing 12B.3.1
Function step.m used by bpm tbc.m. Function performs a single step in
BPM.
% File name: step.m
function E_new = step(Delta_x,k_0,h,n,E_old)
% Function propagates BPM solution along one step
N_x = size(E_old,1);
% determine size of the system
%--- Defines operator P outside of a boundary
prefactor = 1/(2*n*k_0*Delta_x^2);
main = ones(N_x,1);
above = ones(N_x-1,1);
below = above;
P = prefactor*(diag(above,-1)-2*diag(main,0)+diag(below,1)); % matrix P
%
L_plus = eye(N_x) + 0.5i*h*P;
% step forward
L_minus = eye(N_x)-0.5i*h*P;
% step backward
%
%---- Implementation of boundary conditions
%
pref = 0.5i*h/(2*k_0*Delta_x^2);
k=1i/Delta_x*log(E_old(2)/E_old(1));
if real(k)<0
k=1i*imag(k);
end;
left = pref*exp(1i*k*Delta_x);
% left correction for next step
L_plus(1) = L_plus(1)+left;
L_minus(1) = L_minus(1)-left;
%
k=-1i/Delta_x*log(E_old(N_x)/E_old(N_x-1));
if real(k)<0
k=1i*imag(k);
end;
right = pref*exp(1i*k*Delta_x);
% right correction for nest step
L_plus(N_x) = L_plus(N_x) + right;
L_minus(N_x) = L_minus(N_x) - right;
%
E_new = L_minus\L_plus*E_old;
% determine new solution
References
[1] M. D. Feit and J. A. Fleck Jr. Light propagation in grated0index optical ﬁbres. Appl.
Opt., 17:3990–8, 1978.

315
References
[2] V. P. Tzolov, D. Feng, S. Tanev, and Z. J. Jakubczyk. Modeling tools for integrated
and ﬁber optical devices. In G. C. Righini and S. Iraj Najaﬁ, eds., Integrated Optics
Devices III. Proceedings of SPIE, volume 3620, pages 162–73. EMW Publishing,
Cambridge, MA, 1999.
[3] K. Kawano and T. Kitoh. Introduction to Optical Waveguide Analysis. Solving
Maxwell’s Equations and the Schroedinger Equation. Wiley, New York, 2001.
[4] C. R. Pollock and M. Lipson. Integrated Photonics. Kluwer Academic Publishers,
Boston, 2003.
[5] K. Okamoto. Fundamentals of Optical Waveguides. Academic Press, Amsterdam,
2006.
[6] G. Lifante. Integrated Photonics. Fundamentals. Wiley, Chichester, 2003.
[7] R. L. Liboff. Introductory Quantum Mechanics. Addison-Wesley, Reading, MA, 1992.
[8] C. L. Xu and W. P. Huang. Finite-difference beam propagation method for guide-
wave optics. In J. A. Kong, ed., Progress in Electromagnetic Research, PIER 11,
pages 1–49. EMW Publishing, Cambridge, MA, 1995.
[9] W. P. Huang and C. L. Xu. Simulation of three-dimensional optical waveguides by a
full-vector beam propagation method. IEEE J. Quantum Electron., 29:2639–49, 1993.
[10] Y. Chung and N. Dagli. An assessment of ﬁnite difference beam propagation method.
IEEE J. Quantum Electron., 26:1335–9, 1990.
[11] A. L. Garcia. Numerical Methods for Physics. Second Edition. Prentice Hall, Upper
Saddle River, 2000.
[12] G. R. Hadley. Transparent boundary condition for beam propagation. Opt. Lett.,
16:624–6, 1991.
[13] G. R. Hadley. Transparent boundary condition for the beam propagation method.
IEEE J. Quantum Electron., 28:363–70, 1992.
[14] F. Schmidt and P. Deuﬂhard. Discrete transparent boundary conditions for the numer-
ical solution of Fresnel’s equation. Computers Math. Applic., 29:53–76, 1995.
[15] F. Fogli, G. Bellanca, and P. Bassi. TBC and PML conditions for 2D and 3D BPM: a
comparison. Optical and Quantum Electronics, 30:443–56, 1998.
[16] D. Yevick, T. Friese, and F. Schmidt. A comparison of transparent boundary conditions
for the Fresnel equation. Journal of Computational Physics, 168:433–44, 2001.
[17] F. Schmidt, T. Friese, and D. Yevick. Transparent boundary conditions for split-step
Pade approximations of the one-way Helmholtz equation. Journal of Computational
Physics, 170:696–719, 2001.
[18] T. M. Benson, B. B. Hu, and P. Sewell. What is the future for beam propagation meth-
ods? In G. Lampropoulos, J. Armitage, and R. Lessard, eds., Proc. of SPIE Photonics
North 2004: Photonic Applications in Telecommunications, Sensors, Software and
Lasers, volume 5579, pages 351–8. SPIE, Bellingham, WA, 2004.
[19] D. Gallagher. Photonic CAD matures. IEEE LEOS Newsletter, 2:8–14, 2008.
[20] S. Lidgate. Advanced Finite Difference – Beam Propagation Method Analysis of
Complex Components. PhD thesis, Nottingham, 2004.

13
Some wavelength division multiplexing
(WDM) devices
Wavelength division multiplexing (WDM) is a modern practical method of increasing
transmission capacity in ﬁbre communication systems. It uses the principle that optical
beams with different wavelengths can propagate simultaneously over a single ﬁbre without
interfering with one another. In the wavelength range of 1280–1650 nm (like an AllWave
ﬁbre [1]) the useable bandwidth of a single mode ﬁbre is about 53 THz. In recent years an
improved (denser) WDM system known as DWDM is under development.
In this chapter we discuss some of the WDM devices and also provide some applications
of BPM developed earlier to simulate those devices. We start by summarizing the basic
WDM system.
13.1 Basics of WDM systems
WDM is the main technique used in the realization of all optical networks. WDM is the
technology which combines a number of wavelengths onto the same ﬁbre.
Key features include:
• capacity upgrade
• transparency (each optical channel can carry any transmission format)
• wavelength routing
• wavelength switching
Implementation of a typical WDM system employing N channels is shown in Fig. 13.1.
In the shown system three wavelengths are multiplexed in one ﬁbre to increase transmission
capacity. The light of laser diodes with wavelengths recommended by the ITU is launched
into the inputs of a wavelength multiplexer (MUX) where all wavelengths are combined
and coupled into a single-mode ﬁbre. When needed, propagating light can be ampliﬁed by
an optical ﬁbre ampliﬁer and eventually imputed at the wavelength demultiplexer (DMUX)
which separates all optical channels and sends them to different outputs.
In order to ﬁnd the optical bandwidth corresponding to a spectral width in optical region,
we use the relation c = λ · ν, where λ is wavelength and ν carrier frequency and c velocity
of light. Differentiating
dν = c d
dλ
1
λ

dλ = −c
λ2 dλ
316

317
Basic WDM technologies
RX
RX
RX
TX
TX
TX
Optical fibre
Multiplexer
λ1
λ1
λ2
λ3
Demultiplexer
Fig. 13.1
Implementation of a typical WDM link.
or
|ν| = c
λ2 |λ|
(13.1)
The above equation describes the frequency change ν which corresponds to the wave-
length change λ around λ. Using the above formula, we can estimate the usable wavelength
range for a standard single-mode ﬁbre. Assuming that telecommunication wavelength range
extends from λ1 = 1280 nm to λ2 = 1625 nm, the ultimate bandwidth of optical ﬁbre is
40 THz [2]. Assuming 50 or 25 GHz channel spacing, there is the possibility to transmit
800–1600 wavelength channels.
In the remainder of this chapter, we will consider some of the basic devices used in WDM
systems and provide two applications of the beam propagation method (BPM) to simulate
simple structures.
13.2 Basic WDM technologies
In an ideal WDM system where nonlinear effects are neglected, the discrete wavelengths
can be optically processed, i.e. routed and/or switched without interfering with each other.
Optical processing can be performed using passive or active components.
One refers to passive components where there is no external control of their operation.
Typically, they are used to split or combine signals. Examples of passive components are:
N × N couplers, power splitters and star couplers.
Active components, which can be controlled electronically, include tunable optical ﬁlters,
tunable sources, optical ampliﬁers. Here, we will concentrate on passive components.
Basic technologies which are used to develop WDM devices are [3]: ﬁbre Bragg grating
(FBG), array waveguide grating (AWG), thin-ﬁlm ﬁlter (TFF) and diffraction grating (DG).
Another classiﬁcation of main WDM components used in ﬁbre optic communication
systems is described by Agrawal [4] and includes: tunable optical ﬁlters (Fabry-Perot
ﬁlters, Mach-Zehnder ﬁlters, grating-based ﬁlters, application-based ﬁlters), multiplexers
and demultiplexers, add/drop multiplexers and ﬁlters, broadcast star couplers, wavelength
routers, optical cross-connects, wavelength converters and WDM transmitters and receivers.
In the following, we will discuss basic WDM technologies. We start with ﬁbre Bragg
grating.

318
Some wavelength division multiplexing (WDM) devices
Grating
period
λ1 λ2
λB
λ3
Fibre
core
Fig. 13.2
Fibre grating operating as an optical filter.
λ1
λ2
λ3
λ1 λ2 λ3
Fig. 13.3
Schematic illustration of a simple array waveguide demultiplexer.
13.2.1 Fibre Bragg grating
Fibre Bragg grating (FBG) devices are based on the principle discovered by Bragg in 1913
and demonstrated in ﬁbre by Hill in 1978 [5]. It is illustrated in Fig. 13.2.
In a ﬁbre’s core a periodic change of the refractive index (known as grating) is created
using the effect of photosensitivity in germanium-doped optical ﬁbre [5]. When a light
signal consisting of several wavelengths travels in optical ﬁbre (here from left to right),
the signal with a wavelength which obeys the Bragg condition is reﬂected. The reﬂected
wavelength centred at λB that fulﬁlls the Bragg condition is
λB = 2ne f f
(13.2)
where  is the grating period and ne f f is the effective group refractive index of the core.
Applications of Bragg grating are numerous and include ﬁlters and dispersion compen-
sation. A comprehensive review on FBG including ﬁbre grating lasers and ampliﬁers was
written by Kashyap [6].
13.2.2 Array waveguide grating
Array waveguide grating (AWG) is shown schematically in Fig. 13.3 [2]. It is formed by
several waveguides with different lengths. At both ends all waveguides are converging to
the same points. Light composed of several wavelenths (λ1, λ2, . . .) enters the device on
the left. The length of each waveguide is carefully designed so to provide precise phase
difference between neighbouring waveguides at the end of the guiding structure (on the
right). At the output, a diffraction pattern is created which allows output waveguide to
collect light at a particular wavelength. AWG can be used as a passive optical multiplexer
and/or demultiplexer.

319
Basic WDM technologies
Pin
Pin
0.5
Pin
0.5
Fig. 13.4
Y-branch power splitter.
Pin
0.25
Pin
0.25
Pin
0.25
Pin
0.25
Pin
Fig. 13.5
A four-port splitter.
1
2
3
4
Input
Output
Output
Fig. 13.6
Integrated optics directional coupler.
13.2.3 Couplers and splitters
Optical couplers are passive devices which either split optical signal into multiple paths, or
combine several signals into one path. A prime characteristic of couplers is the number of
input and output ports, which is typically expressed as an N × M conﬁguration, where N
represents the number of inputs and M represents the number of outputs.
A splitter is a modiﬁcation of a coupler. As an example, a Y-branch power splitter is shown
in Fig. 13.4. Typically, such Y-branch splits power evenly between the two output ports. By
combining several Y-branches more outputs can be provided, as shown in Fig. 13.5.
Couplers can be constructed within the waveguide structure as shown in Fig. 13.6. Such
a structure can be formed by ion exchange, ion implantation or chemical vapour deposition.
Couplers can also be constructed by twisting two or more ﬁbres together and melting
them in a ﬂame. The process creates a fused coupler, a very popular device.
These techniques can be used to make 50−50% or 99−1% couplers. The numbers
indicate splitting ratios. The length of the coupling region (fused region) as well as the
twisting determines the splitting ratio. Such couplers are simple to construct but fabrication
requires signiﬁcant experience.
In the coupler shown in Fig. 13.6, the optical signal enters port 1. Some of its power exits
in port 2 and some in port 3. In an ideal situation, no light reaches port 4 and also no power
is lost. In practice, however, a few tenths of a dB are lost and the coupling to port 4 is about
30 dB relative to input power at port 1. The percentage of light coupled to different ports
can be varied by changing the coupling length L.

320
Some wavelength division multiplexing (WDM) devices
a
b
z
x
y
Fig. 13.7
Two coupled optical waveguides. Distribution of electric fields is also shown.
Some of the common applications of couplers and splitters are
• to monitor output of light locally (usually 99−1% couplers are used)
• to distribute an incoming signal to several locations simultaneously. For example, a
four-part splitter (Fig. 13.5) allows a signal to drive four receivers.
Next, we provide a summary of the mathematical description of a passive coupler.
13.2.4 Mathematical theory of a passive coupler
Consider two waveguides ‘a’ and ‘b’ (Fig. 13.7), see [7]. For a single waveguide, say ‘a’,
one can express the ﬁeld as
⃗E (x, y, z) = ⃗E(a) (x, y) a (z)
⃗H (x, y, z) = ⃗H (a) (x, y) a (z)
and where
a (z) = a0eiβaz
where ⃗E(a) (x, y) and ⃗H (a) (x, y) are modal distributions in (x, y) plane. They are normalized
as
1
2Re
 
⃗E(a)∗(x, y) × ⃗H (a)∗dxdy ·z = 1
Also
da (z)
dz
= iβaa (z)
Total guided power
P = 1
2
 
⃗E(a)∗(x, y, z) × ⃗H ∗(x, y, z) ·zdxdy
= |a (z)|2
For two parallel waveguides, ﬁelds in each one are written as
⃗E (x, y, z) = a (z) ⃗E(a) (x, y) + b (z) ⃗E(b) (x, y)
(13.3)
⃗H (x, y, z) = a (z) ⃗H (a) (x, y) + b (z) ⃗H (b) (x, y)
(13.4)

321
Basic WDM technologies
Amplitudes a (z) and b (z) satisfy the following (coupled-mode) equations:
da(z)
dz
= iβaa(z) + iκabb(z)
(13.5)
db(z)
dz
= iκbaa(z) + iβbb(z)
(13.6)
where κab and κba are coupling coefﬁcients. Guided power is
P = sa |a (z)|2 + sb | b (z)|2 + Re

a (z) b∗(z)Cba + b (z) a∗(z)Cab

(13.7)
where
Cpq = 1
2

+∞

−∞
⃗E(q) (x, y) × ⃗H (p)∗( x, y) ·zdxdy
(13.8)
In the above, sa, sb = +1 is for propagation in the +z direction and sa, sb = −1 is for
propagation in the −z direction.
Coupled mode equations can be written in a matrix form as
d
dz
a(z)
b(z)

= i←→
M
a(z)
b(z)

(13.9)
where
←→
M =
βa
κab
κba
βb

(13.10)
The solution is assumed to be
a(z)
b(z)

=
A
B

eiβz
(13.11)
After substitution into Eq. (13.9), one ﬁnds
+←→
M −β←→
1
, A
B

= 0
(13.12)
where ←→
1 is an identity matrix. In the full form
βa −β
κab
κba
βb −β
 A
B

= 0
(13.13)
For non-trivial solutions, a determinant must vanish:
det = (βa −β) (βb −β) −κab · κba = 0
(13.14)
From the above, two eigenvalues are found as
β = 1
2 (βa + βb) ± γ ≡
β+
β−
(13.15)
where
γ =

2 + κab · κba,  = 1
2 (βb −βa)
(13.16)

322
Some wavelength division multiplexing (WDM) devices
Eigenvectors are
⃗V1 =
 κab
 + γ

or
− + γ
κba

for β+
(13.17)
and
⃗V2 =
 κab
 −γ

or
− −γ
κba

for β−
(13.18)
The general solution is therefore
a(z)
b(z)

= ←→
V
eiβ+z
0
0
eiβ−z
 ←→
V −1
a(0)
b(0)

(13.19)
where matrix ←→
V is formed from eigenvectors as
←→
V =
+
⃗V1; ⃗V2
,
(13.20)
After some algebra, one ﬁnds the ﬁnal solution
a(z)
b(z)

= ←→
S (z)
a(0)
b(0)

(13.21)
with
←→
S (z) =
!
cos γ z −i 
γ sin γ z
i κba
γ sin γ z
i κba
γ sin γ z
cos γ z + i 
γ sin γ z
"
· e
i
2 (βa+βb)z
(13.22)
As a special case, consider a situation when at z = 0 the optical power is incident only
in waveguide 1, a (0) = 1, b (0) = 0. One ﬁnds in this case
|b (z)|2 =

κba
γ

2
sin2 γ z
At γ z = π
2 , 3 π
2 , . . . , (2n + 1) π
2 , the power transfer from guide ‘a’ to guide ‘b’ is maximum.
Since

κba
γ

2
=
|κba|2
 1
2 (βb −βa)
2 + |κba|2 < 1
for βa ̸= βb the power transfer between waveguides is never complete. For more discussion
consult Chuang [7].
13.2.5 Optical isolators
An optical isolator is a passive device which allows the transmission of an optical signal
in only one direction. At the same time the reﬂections in the opposite direction will be
eliminated.
Two key parameters of an isolator are: the insertion loss which is the loss in the forward
direction, and its isolation which is the loss in the reverse direction. Typical insertion loss
is about 1 dB, whereas the isolation loss is 40–50 dB.

323
Applications of BPM to photonic devices
Polarizer
Incident
light
Output
light
Faraday rotator
Polarizer
Fig. 13.8
Illustration of the principle of Faraday rotation.
An optical isolator based on the Faraday effect is shown in Fig. 13.8. The device consists
of two linear polarizers and a 45◦Faraday rotator. A light beam entering the device from the
left passes through a linear polarizer which polarizes it vertically. Then it passes through a
Faraday rotator which rotates it (here, say by 45◦) with respect to vertical direction. After
passing through a rotator, it travels through another linear polarizer aligned at 45◦which
allows the beam to pass through. Therefore, a vertically polarized beam can be transmitted
through the device. However, all beams polarized at other angles will be blocked.
The angle of rotation α in a Faraday rotator is given by
α = V BL
(13.23)
where V is the Verdet constant, B is magnetic induction and L is the interaction length.
For glass (crown) at a temperature of 18◦C, the Verdet constant is V = 2.68 × 10−5 deg/
Gauss· mm.
13.3 Applications of BPM to photonic devices
The development of new types of components for WDM applications requires accurate
modelling before any fabrication attempts. Over the years many approaches and numerical
methods have been developed. They can generally be divided into two main groups [8]: time-
harmonic (monochromatic CW operation) and general time-dependent (pulse operation).
The important role in numerical analysis of those components is played by BPM.
There are many speciﬁc applications of the BPM to modelling different aspects of pho-
tonic devices or circuits, such as passive waveguiding devices [9], channel-dropping ﬁlters
[10], multimode waveguide devices [11], polarization splitters [12], multimode interference
devices [13] and many more.

324
Some wavelength division multiplexing (WDM) devices
−5
0
5
0
10
20
30
40
0
0.5
1
1.5
2
x
z
Fig. 13.9
Propagation of Gaussian pulse in a waveguide by BPM.
−5
0
5
0
20
40
0
0.5
1
1.5
x
z
Fig. 13.10
Propagation of Gaussian pulse in a tapered waveguide by BPM.
For a recent summary on integrated optics consult the recent book by Hunsperger [14].
In this section we show the results of applications of the BPM developed earlier to the
simplest two waveguiding structures which are the building blocks of WDM devices. Here,
we consider a rib waveguide and a tapered waveguide. In Figs. 13.9 and 13.10 we show
propagation of a Gaussian pulse and also proﬁles of the refractive indices. The MATLAB
code used to generate those ﬁgures is provided in the Appendix, Listings 13A.1 and 13A.2.
To avoid reﬂections at the boundaries, transparent boundary conditions were imple-
mented.

325
Appendix 13A
13.4 Projects
1. Function y junction.m provided in the Appendix can be used to create a Y-junction.
Use this function and other BPM routines to develop a program which will propagate
a Gaussian pulse in the Y-junction. Analyse various conﬁgurations from the literature.
Consult Refs. [15] and [16].
2. Implement the method of ﬁnding propagation constants using BPM. Consult Refs. [17]
and [18].
3. Write MATLAB code to analyse propagation of Gaussian pulses in a coupled rib wave-
guide. Determine coupling length. Consult Refs. [19] and [20].
4. Analyse a ﬁbre Bragg grating ﬁlter using BPM.
Appendix 13A: MATLAB listings
In Table 13.1 we provide a list of MATLAB ﬁles created for Chapter 13 and a short
description of each function.
Listing 13A.1
Program bpm wg.m. Describes propagation of a Gaussian pulse in a
waveguide using BPM.
% File name: bpm_wg.m
% Driver function which propagates Gaussian pulse
% in a strip waveguide using BPM with transparent boundary conditions
clear all
x_0 = 1;
% center of Gaussian pulse
L_x=10.0;
% transversal dimension (along x-axis)
w_0=1.0;
% width of input Gaussian pulse
lambda = 1.6;
% wavelength
k_0=2*pi/lambda;
% wavenumber
Table 13.1 List of MATLAB functions for Chapter 13.
Listing
Function name
Description
13A.1
bpm wg.m
Gaussian pulse in a waveguide with TBC
13A.1.1
wg struct.m
Constructs waveguiding structure used by bpmwg.m
13A.1.2
step.m
Propagates BPM solution along one step
13A.2
bpm taper.m
Gaussian pulse in a tapered waveguide with TBC
13A.2.1
taper struct.m
Constructs tapered structure used by bpmtaper.m
13A.3
plot y.m
Plots Y-junction
13A.3.1
y junction.m
Function deﬁnes Y-junction

326
Some wavelength division multiplexing (WDM) devices
N_x=128;
% points on x axis
Delta_x=L_x/(N_x-1);
% x axis spacing
h=5*Delta_x;
% propagation step
N_z=100;
% number of propagation steps
plot_index=zeros(N_x,N_z);
% storage for plotting ref. index
plot_field=zeros(N_x,N_z);
% storage for plotting field
x=linspace(-0.5*L_x,0.5*L_x,N_x);
% coordinates along x-axis
x = x’;
E=exp(-((x - x_0)/w_0).^2);
% initial Gaussian field
ref_index = wg_struct(x);
% structure is uniform along z-axis
n_eff = 1.40;
% assumed value of prop. constant
%
z = 0; z_plot = zeros(N_z); for r=1:N_z
z = z + h;
z_plot(r) = z + h;
plot_index(:,r)=wg_struct(x);
plot_field(:,r)=abs(E).^2;
E = step(Delta_x,k_0,h,ref_index,n_eff,E);
end;
%
for k = 1:N_z/10:N_z
% choosing 2D plots every 10-th
step
plot(x,plot_index(:,k),’LineWidth’,1.2)
plot(x,plot_field(:,k),’LineWidth’,1.5)
hold on
end pause close all
%
for k = 1:N_z/10:N_z
% choosing 3D plots every 10-th step
y = z_plot(k)*ones(size(x));
% spread out along y-axis
plot3(x,y,plot_index(:,k),’LineWidth’,1.2)
plot3(x,y,plot_field(:,k),’LineWidth’,1.5)
hold on
end grid on xlabel(’x’)
ylabel(’z’)
% along propagation direction
pause close all
Listing 13A.1.1
Program wg struct.m. Constructs a waveguiding structure.
function ref_index = wg_struct(x)
% Construction of the waveguide structure used by BPM
width = 2.0;
% film width
n_c = 1.48;
% refractive index of cover
n_s = 1.49;
% refractive index of substrate
n_f = 1.52;
% refractive index of film
ref_index = n_s*(x<0)+n_f*((x>=0)&(x<=width))+n_c*(x>width);

327
Appendix 13A
Listing 13A.1.2
Function step.m is slightly modiﬁed from the function of the same name
used in Chapter 12.
% File name: step.m
function E_new = step(Delta_x,k_0,h,ref_index,n_eff,E_old)
% Function propagates BPM solution along one step
N_x = size(E_old,1);
% determine size of the system
last_term = k_0^2*Delta_x^2*(ref_index.^2 - n_eff^2);
prefactor = 1/(2*k_0*n_eff*Delta_x^2);
main = ones(N_x,1) - 0.5*last_term; above = ones(N_x-1,1); below =
above;
P = prefactor*(diag(above,-1)-2*diag(main,0)+diag(below,1)); % matrix P
%
L_plus = eye(N_x) + 0.5i*h*P;
% step forward
L_minus = eye(N_x)-0.5i*h*P;
% step backward
%
%---- Implementation of boundary conditions
%
pref = 0.5i*h/(2*k_0*Delta_x^2);
k=1i/Delta_x*log(E_old(2)/E_old(1)); if real(k)<0
k=1i*imag(k);
end;
left = pref*exp(1i*k*Delta_x);
% left correction for next step
L_plus(1) = L_plus(1)+left; L_minus(1) = L_minus(1)-left;
%
k=-1i/Delta_x*log(E_old(N_x)/E_old(N_x-1)); if real(k)<0
k=1i*imag(k);
end;
right = pref*exp(1i*k*Delta_x);
% right correction for nest step
L_plus(N_x) = L_plus(N_x) + right; L_minus(N_x) = L_minus(N_x) -
right;
%
E_new = L_minus\L_plus*E_old;
% determine new solution
Listing 13A.3
Function plots a Y-junction.
% File name: plot_y.m
% Plots y-junction
clear all
L_x=10.0;
% computational window along x-axis
N_x=100;
% number of steps along x-axis

328
Some wavelength division multiplexing (WDM) devices
L_z = 20; N_z = 100;
h = L_z/N_z;
% step size
plotting=zeros(N_x,N_z);
% storage for plotting
z=0;
%
for i=1:N_z
z = z + h;
z_plot(i) = z + h;
x = linspace(-L_x,L_x,N_x);
plotting(:,i)=y_junction(z,x,N_x,N_z);
end
%
for k = 1:10:N_z
% choosing 3D plots every 10-th step
y = z_plot(k)*ones(size(x));
% spread out along y-axis
plot3(x,y,plotting(:,k),’.-’,’LineWidth’,1.0)
hold on
end xlabel(’x’); grid on pause close all
Listing 13A.3.1
Function deﬁnes a Y-junction.
function index = y_junction(z,x,N_x,N_z)
% Construction of the Y-junction structure used by BPM
% z - coordinate along propagation direction
% x - perpendicular coordinate
% Structure is described in only 2D, so we do not need cover
%
w = 2.0;
% film width
n_s = 1.0;
% refractive index of substrate
n_f = 1.52;
% refractive index of film
a = 10; b = 20;
% Construction of Y-junction
slope = 0.1;
%
%index = zeros(N_x,N_z);
upper_1 = w/2 + slope*z; upper_2 = slope*z; lower_1 = - slope*z;
lower_2 = -w/2- slope*z;
%
n_1 = n_s*(x<-w/2)+n_f*((x>=-w/2)&(x<=w/2))+n_s*(x>w/2);
n_2 = n_s*(x<=lower_2)+n_f*((x>=lower_2)&(x<=lower_1))+...
n_s*((x>=lower_1)&(x<=upper_2))+n_f*((x>=upper_2)&(x<=upper_1))+...
n_s*(x>upper_1);
index = ((0<z)&(z<=a))*n_1+((a<z)&(z<=b))*n_2; end

329
References
References
[1] G. Keiser. Optical Fiber Communications. Third Edition. McGraw-Hill, Boston, 2000.
[2] E. S. Koteles. Integrated planar waveguide demultiplexers for high density WDM
applications. In R. T. Chen and L. S. Lome, eds., Wavelength Division Multiplexing,
pages 3–32. SPIE, 1999.
[3] B. Chomycz. Planning Fiber Optic Networks. McGraw-Hill, New York, 2009.
[4] G. P. Agrawal. Fiber-Optic Communication Systems. Second Edition. Wiley, New
York, 1997.
[5] K. O. Hill, Y. Fujii, D. C. Johnson, and B. S. Kawasaki. Photosensitivity in optical ﬁber
waveguides: applications to reﬂection ﬁlter fabrication. Appl. Phys. Lett., 32:647–9,
1978.
[6] R. Kashyap. Fiber Bragg Gratings. Academic Press, San Diego, 1999.
[7] S.-L. Chuang. Physics of Optoelectronic Devices. Wiley, New York, 1995.
[8] R. Scarmozzino, A. Gopinath, R. Pregla, and S. Helfert. Numerical techniques for
modeling guided-wave photonic devices. IEEE J. Select. Topics Quantum Electron.,
6:150–62, 2000.
[9] L. Eldada, M. N. Ruberto, R. Scarmozzino, M. Levy, and R. M. Osgood. Laser-
fabricated low-loss single-mode waveguiding devices in GaAs. J. Lightwave Technol.,
10:1610, 1992.
[10] M. Levy, L. Eldada, R. Scarmozzino, R. M. Osgood, P. S. D. Lin, and F. Tong.
Fabrication of narrow-band channel-dropping ﬁlters. IEEE Photon. Technol. Lett.,
4:1378, 1992.
[11] I. Ilic, R. Scarmozzino, R. M. Osgood, J. T. Yardley, K. W. Beeson, and M. J. Mc-
Farland. Modeling multimode-input star couplers in polymers. J. Lightwave Technol.,
12:996–1003, 1994.
[12] M. Hu, J. Z. Huang, R. Scarmozzino, M. Levy, and R. M. Osgood. Tunable Mach-
Zehnder polarization splitter using heigh-tapered Y-branches. IEEE Photon. Technol.
Lett., 9:773–5, 1997.
[13] D. S. Levy, Y. M. Li, R. Scarmozzino, and R. M. Osgood. A multimode interference-
based variable power splitter in GaAs-AlGaAs. IEEE Photon. Technol. Lett., 9:1373–
5, 1977.
[14] R. G. Hunsperger. Integrated Optics. Theory and Technology. Sixth Edition. Springer,
New York, 2009.
[15] M. H. Hu, J. Z. Huang, R. Scarmozzino, M. Levy, and R. M. Osgood. A low-loss and
compact waveguide Y-branch using refractive-index tapering. IEEE Photon. Technol.
Lett., 9:203–5, 1997.
[16] T. A. Ramadan, R. Scarmozzino, and R. M. Osgood. Adiabatic couplers: design rules
and optimization. J. Lightwave Technol., 16:277–83, 1998.
[17] G. Lifante. Integrated Photonics. Fundamentals. Wiley, Chichester, 2003.
[18] H. J. W. M. Hoekstra. On beam propagation methods for modelling in integrated
optics. Optical and Quantum Electronics, 29:157–71, 1997.

330
Some wavelength division multiplexing (WDM) devices
[19] C. Xu. Finite-Difference Techniques for Simulation of Vectorial Wave Propagation in
Photonic Guided-Wave Devices. PhD thesis, University of Waterloo, 1994.
[20] H.-P. Nolting, J. Haes, and S. Helfert. Benchmark tests and modelling tasks. In
G. Guekos, ed., Photonic Devices for Telecommunications, pages 67–109. Springer,
Berlin, 1999.

14
Optical link
In the present chapter we will combine some of the methods developed earlier to create
the simple point-to-point optical simulator which represents the simplest photonic system.
It involves the transmitter, optical ﬁbre and receiver. Some issues of how to quantify the
quality of transmission in such a system will also be reviewed. Performance evaluation and
tradeoff analysis are the central issues in the design of any communication system. Using
only analytical methods, it is practically impossible to evaluate realistic communication
systems. One is therefore left with computer-aided techniques.
In the last 10–15 years the design of photonic systems has moved from the back-of-the-
envelope calculations to the use of sophisticated commercial simulators, see for example,
products advertised by Optiwave, like OptiSystem [1], by RSoft Design Group the Optical
Communication Design Suite [2] and by VPI Photonics line of products [3], to just name
a few important players. They contain sophisticated physical models and allow for rapid
assessment of new component technologies in the system under design.
Around 1995 the design of optical communication systems (operating over medium
distances) would involve only a balance of power losses and pulse spreading. Later on,
the demand on billion-dollar systems required complex analysis during the design process.
This in turn created the need for sophisticated simulators.
Computer simulations can quickly provide answers to several important questions essen-
tial to every engineer designing optical communication system, like: what repeater spacing
is needed for a given bit rate, or what is the required power generated by a transmitter?
There exists extensive literature on the subject of modelling and simulation of ﬁbre optic
communication systems. Early extensive work on the description and calculation of the
transmission properties of optical ﬁbres for communications was published by Geckeler
[4]. There were several books published by van Etten and van der Plaats [5], Einarsson [6],
Liu [7], Lachs [8], Keiser [9] and Palais [10], to list a few.
Literature published in journals is also extensive. Some of the relevant journal publica-
tions are: [11], [12], [13], [14], [15], [16], [17], [18], [19], [20]; that includes statistical
design of long optical ﬁbre systems is [21]. A general review intended for wide audience
was written by Lowery [22].
14.1 Optical communication system
A generic optical link consisting of a transmitter, optical ﬁbre and receiver was shown in
the Introduction, Fig. 1.1. In that ﬁgure we showed a transmitter which employs a laser
331

332
Optical link
Laser
Transmitter
Channel
Receiver
Photodetector
Filter
Sampler
Threshold
detector
BER
estimation
{Ak}
{Bk}
Hf (ω)
Fig. 14.1
More realistic optical link.
Amp
O-E
E-O
Fiber
Fibre
Amplifier
Optical receiver
Photonic regime
Photonic regime
Electronic regime
Optical transmitter
Fig. 14.2
Principle of regeneration of optical signals. O-E means optical to electronic; E-O means electronic to optical.
diode to generate light, a channel which is formed by an optical ﬁbre and a receiver whose
main element is a photodetector. Actual systems are more complicated.
In Fig. 14.1 we show a block diagram of a digital lightwave system (after Lima et al.
[23]). Several detailed elements of the receiver are displayed. Some of them were already
discussed in the earlier chapters. In the ﬁgure we also show notation for signals used to
characterize operation of the particular elements.
Sequence Ak denotes the data values which are independent and identically distributed,
Hf (ω) is the transfer function of the optical ﬁbre and Bk is the output data sequence created
by the receiver.
When light is transmitted over long distances, optical pulses degenerate due to various
effects discussed previously. As a result, maximum transmission distance is limited. In
order to increase that distance, repeaters are installed. Typical structure of the repeater is
schematically shown in Fig. 14.2. An optical pulse is converted into electrical form, then
ampliﬁed and regenerated and then converted back to light.
Such a process is costly and has also other limitations. Intensive research is conducted
to have this process done entirely in the optical domain without conversion to an electronic
regime.
Regenerators are devices which regenerate signals by removing noise and distortion after
ampliﬁcation. The process is normally possible only in digital systems. It serves 2R or 3R
purposes. In general, the following terminology has been established:
• 1R (Re-ampliﬁcation only) – signal is ampliﬁed only.
• 2R (Re-ampliﬁcation and Re-shaping). Re-shaping corrects a pulse’s shape.

333
Design of optical link
Table 14.1 Typical values of losses for various components.
Wavelength [nm]
Losses [dB km−1]
850
1.81
1300
0.35
1310
0.34
1380
0.40
1550
0.19
Table 14.2 Typical values of losses for various components.
Type of element
Losses [dB]
Connector
0.1–0.2
Splice losses
0.3
• 3R (Re-ampliﬁcation, Re-shaping and Re-timing). Re-timing corrects the time drift in
an optical pulse.
As a result of the regeneration process, clean digital pulses are created. The distance
between repeaters varies, typically 50–70 km.
14.2 Design of optical link
There is a vast amount of literature on the design of optical communications links. Some of
the useful papers and books are: Carnes et al. [24], Pepeljugoski and Kuchta [25], Iannone
et al. [26], Binh [27], Mortazy et al. [28], Zheng et al. [29], Lowery et al. [30], Sabella et
al. [31], de Melo et al. [32].
The design of the optical link involves several interrelated variables which describe
operating characteristics of transmitter, ﬁbre and receiver. The key practical requirements
are: transmission distance, data rate and bit error rate.
The simplest approach to the design of optical link is based on the evaluation of power
budget and rise time budget [33]. Power budget analysis is needed to ensure that the system
will work over the proposed distance with given components. The rise times of the source,
ﬁbre and the detector will determine the bandwidth available for transmission.
In the tables we will summarize losses in typical optical components. Losses of
a single-mode ﬁbre from Corning Glass Works at various wavelengths are summa-
rized in Table 14.1 [33]. Typical values of losses of other components are provided in
Table 14.2.

334
Optical link
Connectors
Splice
Margin
Receiver
sensitivity
Connector
losses
Fibre
losses
Splice
losses
Transmitter
output
Distance from
transmitter
Link
losses
Transmitter
Receiver
Connectors
Fig. 14.3
Illustration of power budget.
14.2.1 Power budget analysis
In the analysis of power budget one determines the total allowed optical power loss between
the transmitter and the receiver. Typical components which contribute to losses are: ﬁbre,
connector, splices, couplers and splitters. Typical values of losses in standard components
are summarized in Table 14.2.
In Fig. 14.3 we show a typical power budget which illustrates loss of power over existing
components as a function of distance from transmitter. In our example losses are created
within connectors, splices and within an optical ﬁbre.
In calculating power budget one considers passive and active components of the link.
Passive loss is made up of ﬁbre loss, connectors, splices, couplers and splitters, among
others. An example of a system power budget is illustrated in Table 14.3.
In this example, one has an excess power margin of 29 dB −28 dB = 1 dB (total 7 dB
with the included system margin). As a general rule, the link loss margin should be greater
than 3 dB to allow for link degradation over time, ageing of transmitters, etc. If during
operation cables are accidentally cut, excess margin is needed to accommodate splices for
restoration.
14.2.2 Rise time budget
The rise time budget is needed to determine whether the link will operate at the required
bit rate. The bit rate is mostly limited by the dispersion. As explained earlier, dispersion

335
Design of optical link
Table 14.3 Illustration of power budget determination.
Transmitter
Output power
−13 dBm
Receiver
Rx sensitivity
−42 dBm
Margin
29 dBm
System loss
Fibre (3.5 × 5 km)
17.5 dB
Connector (1 dB × 2)
2 dB
Splicing (0.5 dB × 5)
2.5 dB
System margin
6 dB
Total
28 dB
is responsible for pulse broadening as it travels through the ﬁbre. Those effects introduce
rise time due to the material dispersion (τmat) and modal dispersion (τmod). Additionally,
the response of the transmitter and the receiver must also be included. Therefore, total link
rise time of the system is determined by the rms sum of all the rise times [33]:
τsys =
#
$
$
%
N

i=1
τ 2i =

τ 2
tx + τ 2
mat + τ 2
mod + τ 2rx
(14.1)
For two main data coding schemes, namely RZ and NRZ, a general rule is that the system
rise time should be determined as
τsys,RZ ≤0.35
B ,
RZ
(14.2)
τsys,NRZ ≤0.70
B ,
NRZ
(14.3)
where B is the bit rate. The rise times of the optical transmitter and receiver are known
from the manufacturer. The rise time for multimode step index ﬁbre is determined as [33]
(subscript im stands for intermodal)
τim = n1
c L
(14.4)
For material dispersion
τmat ≃85Lλps
(λ0 ∼850 nm)
0.5Lλps
(λ0 ∼1300 nm)
≃20Lλps
(λ0 ∼1500 nm)
(14.5)
where L is in km and λ in nm.

336
Optical link
Table 14.4 Illustration of rise-time budget.
Component
Rise time (ns)
System budget (NRZ)
1.75
Light source
1.0
Fibre
0.23
Photodetector
Transit time
0.5
Circuit
1.3
Total
1.4
System rise time
1.75
1.75
For single-mode ﬁbres
τ f ≃D · L · λ
≃2 · L · λ
(λ0 ∼1300 nm, λz ∼1300 nm)
≃16 · L · λ
(λ0 ∼1550 nm, λz ∼1300 nm)
≃2 · L · λ
(λ0 ∼1550 nm, λz ∼1550 nm)
(14.6)
with D ≃2 ps/km·nm at 1300 nm and ∼16 ps/km·nm at 1550 nm with ﬁbres with
λz ∼1300 nm. Also D ≃2 ps/km·nm at 1550 nm for ﬁbres with λz ∼1550 nm. Here λ
is the source spectral width, L is ﬁbre length, λ0 is the operating wavelength and λz is the
zero dispersion wavelength.
Typical rise time budget calculations are summarized in Table 14.4 [10].
14.3 Measures of link performance
There are various requirements which determine the performance of optical networks. One
of them is network security, which will not be discussed here.
The simplest optical network is formed by a point-to-point optical link. Performance of
such a link can be determined by the amount of information received at the acceptable level
of errors [34]. Loss of information can be caused by a number of factors, of which some
typical ones are (a) decrease in the amplitude of the received signal and (b) loss of timing.
Signal quality is determined by analysing the so-called eye diagram and also signal-to-
noise ratio (SNR). The main parameter determining the quality of a digital link is the bit
error rate (BER). The smaller the bit error rate, the better the link transmission quality.
Typical error rates for optical ﬁbre telecommunication systems range from 10−9 to 10−12
[35]. They depend on the SNR at the receiver. BER was discussed in Chapter 10 dealing
with receivers. Here, we only discuss the eye diagram.

337
Measures of link performance
Transmitter
Trigger line
Receiver
Fibre
Test system
Bit pattern
generator
Trigger Data out
Oscilloscope
Vertical
Trigger
Fig. 14.4
Schematic of an experimental equipment setup for making eye diagram measurements.
0
0
0
0
0
0
0
0
0
0
0
0
1
1
1
1
1
1
1
1
1
1
1
1
Fig. 14.5
Construction of an eye diagram for 3-bits.
14.3.1 Eye diagram
The eye diagram technique is a simple and convenient method of diagnosing problems
with data systems. The eye diagram is generated in the time domain using an oscilloscope
connected to the demodulated data, see Fig. 14.4. Pseudorandom data are generated and
applied to the test system. After being transmitted through the test system, the data are
applied to the vertical input of an oscilloscope. The oscilloscope is triggered at every
symbol period (here using data from a separate line) or ﬁxed multiple of symbol periods.
As a result, the signal is retraced and superimposed on the same plot. Construction of an
eye diagram for a 3-bit long sequence of data is shown in Fig. 14.5.
The result is an overlap of consecutive received symbols which form an eye pattern on the
oscilloscope. The eye diagram provides a lot of information about the system’s performance
or about performance of its elements.
A created sequence of Gaussian pulses with random component for a predeﬁned logical
combination is shown in Fig. 14.6. For this sequence, the eye diagram is shown in Fig. 14.7.
MATLAB code used in the generation of those results is shown in Appendix, Listing 14A.1.

338
Optical link
0
0.5
1
1.5
2
2.5
3
× 10−7
0
0.2
0.4
0.6
0.8
1
time [s]
Fig. 14.6
Sequence of six Gaussian pulses with a random term. The logical data sequence is: 010101.
0
1
2
3
4
5
× 10−8
0
0.2
0.4
0.6
0.8
1
Fig. 14.7
Generated eye diagram for the sequence of Gaussian pulses shown in Fig. 14.6. Eye opening is located in the middle of
all pulses.
14.4 Optical fibre as a linear system
In this section we consider the optical ﬁbre modelled as a linear system and illustrate
propagation of signals in such a system.
When an optical pulse propagates through optical ﬁbre, it exhibits attenuation, delay
and distortion. Delay can be handled through appropriate synchronization. Attenuation
of a particular ﬁbre determines the ultimate distance between transmitter and receiver.
Distortion causes pulse broadening known as dispersion; it can produce situations when

339
Optical fibre as a linear system
(a)
(b)
h(t)
Fibre
s  (t)
in
s  (t)
in
s  (t)
in
s    (t)
out
s    (t)
out
s    (t)
out
0
L
z
t
t = 0
t
Fig. 14.8
Illustration of pulse transmission in an optical fibre represented as a linear system described by the impulse response
function h(t). (a) Schematic of optical fibre and its representation as a linear system, (b) pulse broadening during
propagation.
one cannot distinguish between pulses representing different logical information due to
their overlap.
Attenuation and dispersion determine practical limits on the information transmission
performance of optical communication systems. Additional distortions, including noise,
are produced in the receiver.
Propagation of optical signal of frequency ω through ﬁbre of length L having attenuation
coefﬁcient α is schematically illustrated in Fig. 14.8. In a ﬁrst approximation, the optical
ﬁbre is considered as a linear system with an impulse response h(t). Its Fourier transform
H(ω) known as a transfer function is
H(ω) =
 +∞
−∞
h(t) e−iωt dt
(14.7)
The ﬁbre is not an ideal system. Therefore during the passage, the properties of the trans-
mitted pulse described by its time function s(t) or its spectral function S(ω) are distorted,
see Fig. 14.8. (Spectral function S(ω) and the time function s(t) are related by the FT
relation.)
In the frequency domain, the pulse propagation is described by the transfer function
H(ω) as
H(ω) = Sout(ω)
Sin(ω) = e−α(ω)−iφ(ω)
(14.8)
where α(ω) is the system’s attenuation and φ(ω) its phase. Sout(ω) and Sin(ω) are FT of
output and input time functions of a propagating pulse.
Some of the examples of spectral functions H(ω) which are used to model pulse spectra
and ﬁlter functions will now be summarized. These functions are easy to program. All are
dimensionless, normalized low-pass functions approaching unity at ν = 0 and zero for

340
Optical link
ν −→∞(we use the relation ω = 2πν, where ω is angular frequency and ν is frequency).
They are real functions and symmetric with respect to ν = 0. The functions are [36]:
a) Gaussian pulse
HG(ν) = exp

−πν2τ 2
(14.9)
b) Rectangular pulse of duration τ
HRP(ν) = sin (πντ )
πντ
(14.10)
c) Raised cosine spectrum
HRC(ν) = cos2 (πντ
2
)
= 1
2 (1 + cos πντ )
(14.11)
d) Spectrum of a trapezoidal pulse of duration τ and rise time tr
HTP(ν) = sin (πντ )
πντ
· 1
2 (1 + cos πνtr)
(14.12)
e) Spectrum with Nyquist slope
HN(ν) = 1
2

1 −sgn (1 −2ντ ) ((1 −|2ντ|)N −1)

(14.13)
where N is the parameter which controls roll-off of this function.
f) Receiver ﬁlter that equalizes
HE(ν) =
1 + cos πντ
2 exp

−πν2τ 2Q

(14.14)
We will now summarize a description of the three main elements of an optical link:
transmitter, ﬁbre and receiver.
14.5 Model of optical link based on filter functions
In a typical practical situation the optical system transmits pulses. As they propagate from
the transmitter to the receiver, they broaden and also their slopes get distorted. A presence
of noise in all of a system’s components also adds to the modiﬁcation of propagating pulse.
We start with a simple analysis where the whole system is modelled by a single function.
Here, we only consider a rectangular pulse.
14.5.1 Test analysis for a rectangular pulse
In this section we present the analysis of propagation of a rectangular pulse. Although not
a very realistic situation, it serves as a test.
In Fig. 14.9 on the left we show the input rectangular pulse. It propagates through the
system modelled as a rectangular ﬁlter (shown on right). The output after propagation is
shown in Fig. 14.10. MATLAB code in shown in the Appendix, Listing 14A.2.

341
Model of optical link based on filter functions
−40
−20
0
20
40
0
1
2
3
4
5
6
time (a.u.)
Pulse amplitude
−100
−50
0
50
100
0
0.5
1
1.5
Frequency (a.u.)
Amplitude
Fig. 14.9
Rectangular pulse (left) and rectangular filter.
−40
−20
0
20
40
0
1
2
3
4
5
6
Time (a.u.)
amplitude
Fig. 14.10
Rectangular pulse after regeneration.
PD
M
G
S (ω)
1
S (ω)
2
Transmitter
Fibre
Receiver
H (ω)
2
2
s(t)
S (ω)
0
P0
E
τ
0
H (ω)
0
0
E
E0
1
H (ω)
1
1
τ
τ
Fig. 14.11
Main elements of the transmission system.
Next, we build a more realistic model of the optical link, which is done in the following
section. We summarize simple models for all the main components that constitute optical
ﬁbre system and then develop a program which allows for the analysis of pulse propagation
in such a system.
Our approach is based on the work by Geckeler [36]. Main parts of transmission system
are shown in Fig. 14.11. Here, E0 is the energy of the optical pulse produced by the

342
Optical link
Table 14.5 Parameters of typical generated pulses.
Parameter
Symbol
Value
Bit rate
R0
50 Mbits/s−1
Power
P0
0.5 mW
Normalized pulse width
T0
0.7
transmitter, τ0 is the width of that pulse and H0(ω) is the spectral function of the produced
optical pulse. Detailed discussion of all the three elements now follows.
14.5.2 Transmitter
It is usually a semiconductor laser which can be directly modulated by changing bias
current or by employing an external modulator. The main characteristics of light source are:
wavelength, output power, modulation speed, spectral width, noise. For a directly modulated
semiconductor laser, the performance is determined by frequency chirping (discussed in
Chapter 7).
Here we assume a particular optical pulse as produced by a transmitter. Optical pulses
were discussed in Chapter 6. Of particular importance are rectangular and Gaussian pulses.
Pulse produced by the transmitter in the time domain is described by the function p0(t).
Its Fourier spectrum is
S0(ω) =
 +∞
−∞
p0(t) e−jωt dt
Fourier spectrum is related to spectral function H0(ω) as
S0(ω) = p0,max · τ0 · H0(ω)
Parameters of the generated pulse are provided in Table 14.5. They refer to a system with
a bit rate R0 = 50 Mbits/s−1 and an LED transmitter operating at 1.3 µm wavelength with
a maximum launched power of 0.5 mW.
14.5.3 Fibre
The frequency spectrum of propagating pulse after it leaves ﬁbre is obtained by multiplying
pulse spectral function and ﬁbre spectrum.
Pulse propagation in the ﬁbre is described by the product of two functions: D1 which
describes losses and its transfer function H1(ω). Losses are represented by
D1 = E1
E0
= 10−αL1
10dB
(14.15)
The function H1(ω) is a normalized ﬁlter function approximately expressed as a Gaussian
low-pass ﬁlter:
H1(ω) = e−1
4π πω2τ 2
1
(14.16)

343
Model of optical link based on filter functions
Table 14.6 Parameters of typical fibre.
Parameter
Symbol
Value
Losses
α
3 dB
Length
L1
15 km
Mode coupling length
Lc
10 km
Bandwidth-length
BL
500 MHz· km
Fibre parameter
τ1
Eq. (14.17)
The parameter τ1 can be determined from the measured bandwidth B1 of a ﬁbre. Fibre
parameters are listed in Table 14.6.
The ﬁbre parameter τ1 is related to the bandwidth as
τ1 =
1
2B1
(14.17)
Bandwidth is modelled after Geckeler [36] as
B1 = BL
 1
L1
+ 1
3Lc

(14.18)
where Lc is the mode coupling length and BL is the bandwidth-length product. The ap-
proximation (14.18) is valid for 0 < L1 < 3Lc. The parameters BL and Lc are empirical
parameters. Their values are summarized in Table 14.6.
14.5.4 Receiver
An optical receiver is described by the low-pass ﬁlter transfer function
H2(ω) = 1
2

1 + cos
1
2ωτ2

at |ω| ≤2π
τ2
(14.19)
with the parameter τ2.
The signal spectrum at the receiver output is determined as [4]
S2(ω) = iT · T · M · R · G · H0(ω) · H1(ω) · H2(ω)
(14.20)
where M is the multiplication factor of an avalanche photodiode (if used), G is its ampliﬁ-
cation factor and
iT = P0,max · τ0
T · D1
ηe
hν
(14.21)
is the mean photocurrent of a pulse in a time slot of duration T.
The parameter of the receiver is provided in Table 14.7.
14.5.5 Implementation of link model
The above approach has been implemented following work by Geckeler [36] and [4]. MAT-
LAB code is shown in Appendix, Listing 14A.3. Typical results are shown in Fig. 14.12.

344
Optical link
Table 14.7 Parameter of a typical receiver.
Parameter
Symbol
Value
Receiver parameter
τ2
0.7
0
2
4
6
8
−0.4
−0.2
0
0.2
0.4
0.6
0.8
1
Frequency (a.u.)
Fig. 14.12
Spectrum of rectangular pulse before (dotted line) and after propagation (solid line).
The signal spectrum generated by the transmitter is sin(πντ0)/(πντ0), which represents
rectangular pulse of duration τ0. Input pulse is shown as a dotted line, the output signal
after the receiver as a solid line. More details were provided by Geckeler in Refs. [36] and
[4].
14.6 Problems
1.
Analyse spectral functions summarized in Section 14.4. Plot the time dependence of
each function. Evaluate Fourier transform and plot frequency spectra.
2.
Analyse Gaussian pulse using the ﬁlter approach.
3.
Analyse transmission of a Gaussian pulse by a single-mode ﬁbre system. Determine
the output pulse width as a function of the input pulse width.
14.7 Projects
1. Write MATLAB code to construct an eye diagram for the program link.m.
2. Add noise component to program link.m. Analyse the effect of noise on a system’s
performance.

345
Appendix 14A
Table 14.8 List of MATLAB functions for Chapter 14.
Listing
Function name
Description
14A.1
bits gen eye.m
Generates pattern of Gaussian pulses and eye diagram
14A.2
rectangular.m
Rectangular pulse before and after ﬁltering
14A.3
link.m
Simulation of optical link (rectangular pulse)
Appendix 14A: MATLAB listings
In Table 14.8 we provide a list of MATLAB ﬁles created for Chapter 14 and a short
description of each function.
Listing 14A.1
Function bits gen eye.m Function generates a 6-bits long pattern of Gaus-
sian pulses with random terms and eye diagram.
% File name: bits_gen_eye.m
% Purpose:
% Generates 6-bits long pattern of Gaussian pulses with random terms
% Based on generated sequence, eye diagram is created
%
clear all
bits = [0 1 0 1 0 1];
% def. of bit’s sequence
T_period = 50d-9;
% pulse period [s]
t_zero = 20d-9;
% center of incident pulse [s]
width = 6d-9;
% width of the incident pulse [s]
% Generation of current pattern corresponding to bit pattern
I_p = 0;
N_div = 50;
% number of divisions within each bit interval
t = linspace(0, T_period, N_div);
% the same time interval is
% generated for each bit
g = exp(-0.5*((t_zero - t)/width).^2); % def. of a single Gaussian pulse
%
if bits(1)==0,
I_p_1 = rand(1)*(1- g); % generates first bit
elseif bits(1)==1, I_p_1 = rand(1)*g;
end
temp = I_p_1;
number_of_bits = length(bits);
for k = 2:number_of_bits
% generation of remaining bits
if bits(k)==1
A = rand(1)*g;
elseif bits(k)==0, A = rand(1)*(1- g);
end
A = [temp,A];

346
Optical link
temp = A;
end
temp_t = t;
for k = 2:number_of_bits
t = linspace(0, T_period, N_div);
t = [temp_t,(k-1)*T_period+t];
temp_t = t;
end
%
h = plot(t,A,’LineWidth’,1.5);
xlabel(’time [s]’,’FontSize’,14);
% size of x label
set(gca,’FontSize’,14);
% size of tick marks on both axes
pause
close all
%
%=============== Eye diagram ============================
% put all bit plots on the first one
t_eye = linspace(0, T_period, N_div);
hold on
for m = 1:number_of_bits
A_temp = A((1+(m-1)*N_div):(m*N_div));
e = plot(t_eye,A_temp);
set(e,’LineWidth’,1.5);
% thickness of plotting lines
set(gca,’FontSize’,14);
% size of tick marks on both axes
end
pause
close all
Listing 14A.2
Function rectangular.m. Function which shows a rectangular pulse before
and after ﬁltering.
% File name: rectangular.m
% Analysis of rectangular pulse after filtering
%
clear all
hwidth = 10;
% half-width of a pulse
time_step = 0.001;
% time step
range = 40;
t = -range:time_step:range;
% time range
%------ Creation of rectangular pulse -------
y = (5/2)*(sign(t+hwidth)-sign(t-hwidth));
plot(t,y,’LineWidth’,1.5);
xlabel(’time (a.u’,’FontSize’,14);
ylabel(’Pulse amplitude’,’FontSize’,14);
set(gca,’FontSize’,14);
% size of tick marks on both axes
axis([-range range 0 6]);

347
Appendix 14A
pause
% %----- Fourier transform of a rectangular pulse -------
y_shift = fftshift(fft(y));
N=length(y_shift);
n=-(N-1)/2:(N-1)/2;
%------ Definitions of different filters ------------------
filter = (1/2)*(sign(n+100)-sign(n-100));
%filter = exp(-pi*n*0.0001);
%filter = 0.1*cos(pi*n*0.005).^2;
%filter = (1 + cos(0.05*n))/2;
plot(n,filter,’LineWidth’,1.5);
axis([-3*range 3*range 0 1.5]);
xlabel(’Frequency (a.u.)’,’FontSize’,14);
ylabel(’Amplitude’,’FontSize’,14);
set(gca,’FontSize’,14);
% size of tick marks on both axes
pause
%-------- Regeneration of signal using filtered output ----------
y_reg=filter.*y_shift;
% Filter original frequency spectrum
y_reg_inv=ifft(y_reg);
% Inverse Fourier transform
plot (t,abs(y_reg_inv),’LineWidth’,1.3);
axis([-range range 0 6]);
xlabel(’Time(a.u.)’,’FontSize’,14);
ylabel(’amplitude’,’FontSize’,14);
set(gca,’FontSize’,14);
% size of tick marks on both axes
pause
close all
Listing 14A.3
Function link.m. Function models propagation of a rectangular pulse in
an optical link.
% File name: link.m
% Optical link simulations
% Follow code on p.133 of S. Geckeler (1983) paper
% No model of a transmitter
% No noise
%
clear all
%----------- Pulse produced by transmitter ----------------------
R_0 = 50d5;
% Bit rate of binary digital signal, 50 Mbit/s
P_0 = 5d-4;
% Max power of optical pulse, 0.5 mW
T_0 = 0.7;
% Normalized pulse duration = tau_0/T
%------------- Fibre parameters -------------------------
L_1 = 15;
% Fibre length, 15 km
A_L = 3.0;
% Attenuation coefficient, 3 dB/km
D_1 = 10^(-A_L*L_1/10);
% Power ratio
P_1 = P_0*T_0*D_1/2;
% Mean optical power at the end of fibre

348
Optical link
B_L = 5d8;
% Bandwidth-length product, 500 MHz km
L_C = 10;
% Coupling length of a multimode fibre, 10 km
B_1 = B_L/L_1 + B_L/(3*L_C);
% Fibre bandwidth
T_1 = R_0/(2*B_1);
%-------------- Receiver parameters -------------------------
T_2 = 0.7;
%============== System evaluation =======================================
% Output signal spectrum
D_F = pi/(20*T_2);
N = 32;
f = zeros(1,N);
f_A = zeros(1,N);
f_B = zeros(1,N);
f_C = zeros(1,N);
H_F = zeros(1,N);
H_F(1) = 1.0;
for j = 1:N
f(j) = j*D_F;
f_A(j) = sin(f(j)*T_0)/(f(j)*T_0);
% transmitter
f_B(j) = exp(-f(j)^2*T_1*T_1/pi);
% fibre
f_C(j) = (1/2)*(1 + cos(f(j)*T_2));
% receiver
H_F(j) = f_A(j)*f_B(j)*f_C(j);
end
%
plot(f,f_A,’.’,f,H_F,’LineWidth’,1.5)
% Plot signal after propagation
xlabel(’Frequency (a.u.)’,’FontSize’,14);
set(gca,’FontSize’,14);
% size of tick marks on both axes
pause
s = ifft(H_F);
s = s/max(s);
ff = linspace(0,2/3,N);
%
plot(fftshift(abs(s)),’LineWidth’,1.5);
xlabel(’time’,’FontSize’,14);
ylabel(’time output function’,’FontSize’,14);
set(gca,’FontSize’,14);
% size of tick marks on both axes
grid
pause
close all
References
[1] Optiwave, www.optiwave.com/, 3 July 2012.
[2] RSoft, www.rsoftdesign.com/, 3 July 2012.

349
References
[3] VPI photonics, www.vpiphotonics.com/, 3 July 2012.
[4] S. Geckeler. Optical Fiber Transmission System. Artech House, Inc., Norwood, MA,
1987.
[5] W. van Etten and J. van der Plaats. Fundamentals of Optical Fiber Communications.
Prentice Hall, New York, 1991.
[6] G. Einarsson. Principles of Lightwave Communications. Wiley, Chichester, 1996.
[7] M. M.-K. Liu. Principles and Applications of Optical Communications. Irwin,
Chicago, 1996.
[8] G. Lachs. Fiber Optic Communications. Systems, Analysis, and Enhancements.
McGraw-Hill, New York, 1998.
[9] G. Keiser. Optical Fiber Communications. Third Edition. McGraw-Hill, Boston, 2000.
[10] J. C. Palais. Fiber Optic Communications. Fifth Edition. Prentice Hall, Upper Saddle
River, NJ, 2005.
[11] D. G. Duff. Computer-aided design of digital lightwave systems. IEEE J. Select. Areas
Commun., 2:171–85, 1984.
[12] P. J. Corvini and T. L. Koch. Computer simulation of high-bit-rate optical ﬁber
transmission using single-frequency lasers. J. Lightwave Technol., 5:1591–5, 1987.
[13] G. P. Shen, and T.-M. Agrawal. Computer simulation and noise analysis of the system
performance at 1.5 µm single-frequency semiconductor lasers. J. Lightwave Technol.,
5:653–9, 1987.
[14] A. F. Elrefaie, J. K. Townsend, M. B. Romeiser, and K. S. Shanmugan. Computer
simulation of digital lightwave links. IEEE J. Select. Areas Commun., 6:94–104,
1988.
[15] J. C. Cartledge and G. S. Burley. The effect of laser chirping on lightwave system
performance. J. Lightwave Technol., 7:568–73, 1989.
[16] K. Hinton and T. Stephens. Modeling high-speed optical transmission systems. IEEE
J. Select. Areas Commun., 11:380–92, 1993.
[17] K. B. Letaief. Performance analysis of digital lightwave systems using efﬁcient com-
puter simulation techniques. IEEE Trans. on Communications, 43:240–51, 1995.
[18] A. Lowery, O. Lenzmann, I. Koltchanov, R. Moosburger, R. Freund, A. Richter,
S. Georgi, D. Breuer, and H. Hamster. Multiple signal representation simulation of
photonic devices, systems, and networks. IEEE J. Select. Topics Quantum Electron.,
6:282–96, 2000.
[19] S. H. S. Al-Bazzaz. Simulation of single mode ﬁber optics and optical communication
components using VC++. IJCSNS International Journal of Computer Science and
Network Security, 8:300–8, 2008.
[20] L. N. Binh. MATLAB simulink simulation platform for photonic transmission sys-
tems. I.J. Communications, Network and System Sciences, 2:97–117, 2009.
[21] T. J. Batten, A. J. Gibbs, and G. Nicholson. Statistical design of long optical ﬁber
systems. J. Lightwave Technol., 7:209–17, 1989.
[22] A. J. Lowery. Computer-aided photonics design. Spectrum, 4:26–31, 1997.
[23] R. A. A. Lima, M. C. R. Carvalho, and L. F. M. Conrado. On the simulation of digital
optical links with EDFAs: an accurate method for estimating BER through Gaussian
approximation. IEEE J. Select. Topics Quantum Electron., 3:1037–44, 1997.

350
Optical link
[24] H. Carnes, R. Kearns, and E. Basch. Digital optical system design. In E. E. B.
Basch, ed., Optical-Fiber Transmission, pages 461–86. Howard W. Sams and Co.,
Indianapolis, 1987.
[25] P. K. Pepeljugoski and D. M. Kuchta. Design of optical communications data links.
IBM J. Res. and Dev., 47:223–37, 2003.
[26] E. Iannone, F. Matera, A. Mocozzi, and M. Settembre. Nonlinear Optical Communi-
cation Networks. Wiley, New York, 1998.
[27] L. N. Binh. Optical Fiber Communications Systems. CRC Press, Boca Raton, 2010.
[28] E. Mortazy and M. K. Moravvej-Farshi. A new model for optical communication
systems. Optical Fiber Technology, 11:69–80, 2005.
[29] H. Zheng, S. Xie, Z. Zhou, and B. Zhou. Simulation of optical ﬁber transmission
systems using SPW and an HP workstation. SIMULATION, 71:312–15, 1998.
[30] A. J. Lowery and P. C. R. Gurney. Two simulators for photonic computer-aided design.
Applied Optics, 37:6066–77, 1998.
[31] R. Sabella and P. Lugli. High Speed Optical Communications. Kluwer Academic
Publishers, Dordrecht, 1999.
[32] C. F. de Melo Jr, C. A. Lima, L. D. S. Alcantara, R. O. dos Santos, and J. C. W.
A. Costa. A Simulink toolbox for simulation and analysis of optical ﬁber links. In
J. Javier Sanchez-Mondragon, ed., Sixth International Conference on Education and
Training in Optics and Photonics, volume 3831, pages 240–51. SPIE, 2000.
[33] G. Ghatak and K. Thyagarajan. Introduction to Fiber Optics. Cambridge University
Press, Cambridge, 1998.
[34] L. D. Green. Fiber Optic Communications. CRC Press, Boca Raton, 1993.
[35] G. Keiser. Optical Fiber Communications. Fourth Edition. McGraw-Hill, Boston,
2011.
[36] S. Geckeler. Modelling of ﬁber-optic transmission systems on a desk-top computer.
Siemens Res. and Dev. Reports, 12:127–34, 1983.

15
Optical solitons
In this chapter we concentrate on optical solitons and their propagation in optical ﬁbre.
They are pulses of a special shape and owe their existence due to the presence of dispersion
and nonlinearity in optical ﬁbre. They are able to propagate ultra-long distances while
maintaining their shape.
Here, we provide some basic knowledge for understanding the underlying physical
principles of soliton creation and propagation. We generalize the theory of linear pulses
developed in Chapter 5 and include the nonlinear part of polarization. We will then derive
a nonlinear equation which describes propagation of solitons in optical ﬁbre.
Soliton propagation in an optical ﬁbre was ﬁrst demonstrated at Bell Laboratories by
L. F. Mollenauer, R. S. Stolen and J. P. Gordon. We refer to the book by Mollenauer and
Gordon [1] for the description of basic principles and a brief history of solitons.
Some other relevant books on optical solitons and also on applications in optical com-
munications are [2], [3], [4], [5], [6].
15.1 Nonlinear optical susceptibility
Solitons exist due to nonlinearity and dispersion. Dispersion was discussed earlier in the
book. Here, we will concentrate on nonlinear effects. Optical responses including nonlinear
effects are described as [7]
P(t) = ϵ0

χ (1)E(t) + χ (2)E2(t) + χ (3)E3(t) + · · ·

(15.1)
≡P(1)(t) + P(2)(t) + P(3)(t) + · · ·
where we have expressed polarization P(t) as a power series in the ﬁeld strength E(t). The
quantities χ (1), χ (2), χ (3) are known as susceptibilities; χ (1) is a linear susceptibility and
χ (2), χ (3) are known as the second order- and third-order nonlinear susceptibilities.
For a typical solid-state system χ (1) is of the order of unity whereas χ (2) is of the order of
1/Eat and χ (3) of the order of 1/E2
at, where Eat = e/(4πϵ0a2
0) is the characteristic atomic
electric ﬁeld strength and a0 = 4πϵ0ℏ2/me2 is the Bohr radius of the hydrogen atom.
Explicitly [7]
χ (2) ≃1.94 × 10−12m/V
χ (3) ≃3.78 × 10−24m2/V 2
351

352
Optical solitons
Formal expression for the third-order susceptibility is [7]
Pi(ω0 + ωn + ωm) = ϵ0D

jkl
χ (3)
ijkl (ω0 + ωn + ωm, ω0, ωn, ωm)
× E j(ω0) Ek(ωn) El(ωm)
where i, j, k, l refer to the Cartesian components of the ﬁelds and the degeneracy factor D
represents the number of distinct permutations of the frequencies ω0, ωn, ωm.
χ ( j) ( j = 1, 2, . . .) is the j-th order susceptibility. The linear susceptibility χ (1) con-
tributes to the linear refractive index n0 (real and imaginary parts; the imaginary part
being responsible for attenuation). The second-order susceptibility χ (2) is responsible for
the second harmonic generation. For SiO2 the second-order nonlinear effect is negligible
since SiO2 has the inversion symmetry. Therefore optical ﬁbres normally do not show the
second-order nonlinear effects.
The third-order susceptibility χ (3) is responsible for the lowest order nonlinear effects
in optical ﬁbres. Generally, it manifests itself as the change in the refractive index with
optical power or as a scattering phenomenon. It is linked with the optical Kerr effect, four-
wave mixing, third-harmonic generation, stimulated Raman scattering, etc. An excellent
discussion of third-order optical susceptibilities has been reported by Hellwarth [8].
Assuming linear polarization of propagating light and neglecting tensorial character of
χ (3)
ijkl, one ﬁnds the following relation for the nonlinear polarization:
PNL(ω) = 3ϵ0χ (3) (ω = ω + ω −ω) |E(ω)|2E(ω)
Total polarization, which consists of linear and nonlinear parts, is written as
P(ω) = ϵ0χ (1)E(ω) + 3ϵ0χ (3)|E(ω)|2E(ω)
= ϵ0χeff E(ω)
The effective susceptibility is ﬁeld dependent as
χeff = χ (1) + 3χ (3)|E(ω)|2
and it is linked to refractive index as
n = 1 + χ (3) ≡n0 + n2I
(15.2)
Here I denotes the time-averaged intensity of the optical ﬁeld. We start with the discussion
of the main features of nonlinear effects.
15.2 Main nonlinear effects
15.2.1 Kerr effect
It was discovered by J. Kerr in 1875. He found that a transparent liquid becomes dou-
bly refracting (birefringent) when placed in a strong electric ﬁeld. Generally, Kerr effect

353
Derivation of the nonlinear Schr¨odinger equation
E(z,t)
(a)
(b)
t
A(z,t)
E(z,ω)
~
Δω
ω0
ω
Fig. 15.1
Illustration of the propagating modulated pulse (a) and its spectrum (b).
describes situations where refractive index depends on electric ﬁeld as
n

ω, |E|2
= n0 (ω) + n2 (ω) E|2
Here, n2 is known as Kerr coefﬁcient and it is related to susceptibility as
n2 (ω) = 3
4π χ (3)
xxx
for a linearly polarized wave in the x direction. For silica its value is approximately 1.3 ×
10−22 m2/V2. Kerr effect originates from the non-harmonic motion of electrons bound in
molecules. Consequently, it is fast effect, the response time of the order of 10−15s.
15.2.2 Stimulated Raman scattering
Scattering phenomena are responsible for Raman and Brillouin effects. During those
scatterings, the energy of the optical ﬁeld is transferred to local phonons: in Raman
scattering optical phonons are generated whereas in the Brillouin scattering the acoustic
phonons.
15.3 Derivation of the nonlinear Schr¨odinger equation
Solitons in optical ﬁbres are described by the so-called nonlinear Schr¨odinger (NSE)
equation, which will be now derived. In the derivation we use the concept of the Fourier
spectrum of the propagating pulse, see Fig. 15.1.
A medium where solitons propagate exhibits Kerr nonlinearity. In such a medium,
refractive index depends on intensity of electric ﬁeld I(t) given by Eq. (15.2), again
reproduced here:
n(t) = n0 + n2 · I(t)
(15.3)

354
Optical solitons
where [7]
I(t) = 2n0ε0c|A(z,t)|2
(15.4)
Here A(z,t) is the slowly varying envelope connected to the optical pulse described by the
optical pulse E(z,t) as, see Fig. 15.1:
E(z,t) = A(z,t) ei(ω0t−β0z)
(15.5)
Fourier transform of the optical ﬁeld is [3], [9]
E(z,t) =
 +∞
−∞
dω 1E(z, ω) ei(ωt−βz)
(15.6)
where 1E(z, ω) is the Fourier spectrum of the pulse, β propagation constant and ω0 the
frequency at which the pulse spectrum is centered (also known as carrier frequency), see
Fig. 15.1.
For quasi-monochromatic pulses with ω ≡ω −ω0 ≪ω0, it is useful to expand
propagation constant β(ω) in a Taylor series:
β(ω) = β0 + β1 · (ω −ω0) + 1
2β2 · (ω −ω0)2 + βNL
(15.7)
where we have neglected higher order derivatives. Here βNL = n2k0I is the nonlinear
contribution to the propagation constant.
Substitute expansion (15.7) into Eq. (15.6):
E(z,t) = e−iβ0z
 +∞
−∞
d(ω) 1E(z, ω) exp

iωt −iβ1zω −1
2iβ2zω2 −i · z · βNL

= ei(ω0t−β0z)
 +∞
−∞
d(ω) 1E(z, ω0 + ω)
× exp

itω −iβ1zω −1
2iβ2zω2 −i · z · βNL

≡ei(ω0t−β0z) A(z,t)
where we have introduced
A(z,t) =
 +∞
−∞
d(ω) 1E(z, ω0 + ω)
× exp

itω −iβ1zω −1
2iβ2zω2 −i · z · βNL

≡
 +∞
−∞
d(ω) 1E(z, ω0 + ω) eig(z,t)
(15.8)
Our next step is to obtain a differential equation describing evolution of the amplitude
A(z,t) from Eq. (15.8) which is in the integral form. To do this, one needs to take partial

355
Derivation of the nonlinear Schr¨odinger equation
derivatives of Eq. (15.8). One obtains
∂A(z,t)
∂t
=
 +∞
−∞
d(ω) 1E(z, ω0 + ω) iω eig(z,t)
∂2A(z,t)
∂t2
=
 +∞
−∞
d(ω) 1E(z, ω0 + ω) (iω)2 eig(z,t)
∂A(z,t)
∂z
=
 +∞
−∞
d(ω) 1E(z, ω0 + ω)

−iβ1ω −1
2iβ2ω2 −i · βNL

eig(z,t)
When evaluating time derivatives, we have assumed in the above that I(t) does not depend
on time. Addition of the above combination of derivatives produces
∂A(z,t)
∂z
+ β1
∂A(z,t)
∂t
−i1
2β2
∂2A(z,t)
∂t2
=
 +∞
−∞
d(ω) 1E(z, ω0 + ω)
×

−iβ1ω −1
2iβ2ω2 −i · βNL

+ β1iω −i1
2β2(iω)2

× eig(z,t)
(15.9)
The term in the bracket is, [· · · ] = −i · βNL = −in2k0I. Eq. (15.9) thus gives
∂A(z,t)
∂z
+ β1
∂A(z,t)
∂t
−i1
2β2
∂2A(z,t)
∂t2
=
 +∞
−∞
d(ω) 1E(z, ω0 + ω) (−in2k0I) eig(z,t)
= −in2k0I
 +∞
−∞
d(ω)1E(z, ω)eig(z,t)
≡−in2k0I A(z,t)
when using (15.8). The ﬁnal equation describing solitons is therefore [3], [10]
∂A(z,t)
∂z
+ β1
∂A(z,t)
∂t
+ i1
2β2
∂2A(z,t)
∂t2
= iγ |A(z,t)|2 A(z,t) −α
2 A(z,t)
(15.10)
where we have deﬁned nonlinear coefﬁcient γ (after [3]) as
γ = 2πn2
λAeff
(15.11)
Here Aeff is the effective core area.
Our interests here lie in the pulse evolution during propagation and not in the time of pulse
arrival. We can therefore simplify the above equation by transforming it to a coordinate
system which moves with group vg. In this moving frame, new time T and new coordinate
Z are
Z = z
(15.12)
T = t −β1z

356
Optical solitons
To obtain the transformed equation, we must evaluate derivatives with respect to new
variables as follows:
∂A
∂t = ∂A
∂T
∂T
∂t + ∂A
∂|Z
∂Z
∂t = ∂A
∂T
since ∂T
∂t = 1 and ∂Z
∂t = 0. From the above one ﬁnds
∂2A
∂t2 = ∂2A
∂T 2
Using the above results, one has
∂A
∂z = ∂A
∂T
∂T
∂z + ∂A
∂|Z
∂Z
∂z = −β1
∂A
∂T + ∂A
∂|Z
The last result is used in Eq. (15.10) to replace ∂A
∂t . The transformed equation is
∂A
∂z + i1
2β2
∂2A
∂T 2 −iγ |A|2A + 1
2αA = 0
(15.13)
where in the ﬁnal step we replaced Z by z. It is known as a nonlinear Schr¨odinger equation
(NSE).
To further analyse NSE, we will introduce two characteristic lengths describing dispersion
(LD) and nonlinearity (LNL). Those are deﬁned as
LD = T 2
0
|β2| = T 2
0 2πc
|D|λ2
(15.14)
and
LNL =
1
γ P0
(15.15)
where P0 is the peak power of the slowly varying envelope A(z, T ) and T0 is a temporal
characteristic value of the initial pulse, which is often deﬁned as full width half maximum
(the pulse 3 dB width). Those two lengths characterize how far a pulse must propagate to
show the respective effect. Physically, LD is the propagation length at which a Gaussian
pulse broadens by a factor of √(2) due to group velocity dispersion (GVD).
GVD dominates pulse propagation in ﬁbres whose length L is L ≪LNL and L ≥LD.
In such situation. the nonlinearity in NLSE can be ignored and the equation can be solved
analytically. Nonlinear effects dominate in ﬁbre where L ≪LD and L ≥LNL. In this limit
the dispersion term can be ignored.
Typical values of parameters used in the simulations are summarized in Table 15.1.
For numerical analysis normalize variables
U =
1
√P0
A
and
τ = T
T0
(15.16)
The width parameter T0 is related to the full-width at half-maximum (FWHM) intensity of
the input pulse. Speciﬁcally
Ts = 2T0ln(1 +

(2)) ≈1.763T0
(15.17)

357
Split-step Fourier method
Table 15.1 Typical parameters used in simulation of solitons.
Parameter
Symbol
Value
Unit
wavelength
λ
1.55
µm
nonlinear coeff.
γ
1.3
1/ kmW
GVD
β2
15 × 10−24
s2/km
width parameter
T0
100
ps
peak power
P0
0.15
mW
losses
α
0.01
dB/km−1
chirp parameter
c
1.2
dimensionless
soliton period
z0
1047.2
km
After simple algebra, Eq. (15.13) takes the form
∂U
∂z −isign(β2)
2LD
∂2U
∂τ 2 + i 1
LNL
|U|2U + 1
2αU = 0
(15.18)
Another normalized form of the Schr¨odinger equation exists in the literature. We obtain it
in the lossless case, i.e. with α = 0. To derive it, normalize the z coordinate as follows:
ξ = z
LD
(15.19)
After a few algebraic steps, one obtains
∂U
∂ξ −isign(β2)
2
∂2U
∂τ 2 + iN2|U|2U = 0
(15.20)
where N is known as soliton order and is deﬁned as
N2 = LD
LNL
= γ P0T 2
0
|β2|
(15.21)
The last popular form of the NLSE is found by introducing u as
u = NU =
γ P0T 2
0
|β2|
1/2
A
(15.22)
Eq. (15.20) then takes the form
∂u
∂ξ −isign(β2)
2
∂2u
∂τ 2 −i|u|2u = 0
(15.23)
15.4 Split-step Fourier method
In this section we will discuss the numerical solution of the nonlinear Schr¨odinger equation
(NSE) which describes propagation of optical solitons using the so-called split-step Fourier
method (SSFM).

358
Optical solitons
L
h
A1
Ai
Ai+1
A2
A3
A4
A5
A6
A7
A8
A9
A10
A11
A12
(a)
(b)
nonlinear
linear
linear
h/2
h/2
Ai+ 1
2
Fig. 15.2
Illustration of split-step Fourier method. (a) Division of optical fibre into N regions (here N = 11) of equal lengths.
(b) Illustration of operation of linear and nonlinear operations at arbitrary segments.
The SSFM is a numerical technique used to solve nonlinear partial differential equations
like the NSE. The method relies on computing the solution in small steps and on taking into
account the linear and nonlinear steps separately. The linear step (dispersion) can be made
in either frequency or time domain, while the nonlinear step is made in the time domain.
The method is widely used for studying nonlinear pulse propagation in optical ﬁbres. For
more detail see [11]
A nonlinear Schr¨odinger equation, Eq. (15.13) contains dispersive and nonlinear terms.
To introduce SSFTM, write the NLSE equation in the following form:
∂A(z, T )
∂z
=
L + N

A(z, T )
(15.24)
where
LA = −α
2 −i
2β2
∂2A
∂T 2
(15.25)
contains losses and dispersion in the linear medium and nonlinear term
NA = iγ |A|2A
(15.26)
accounts for the nonlinear effects in the medium.
The basis of the SSFM is to split a propagation from z to z + h (h is a small step) into
two operations (assuming that they act independently): during ﬁrst step nonlinear effects
are included and in the second step one accounts for linear effects, see Fig. 15.2.

359
Split-step Fourier method
Formal solution of Eq. (15.24) over a small step h is thus
A(z + h,t) = eh(L+N)A(z,t)
(15.27)
In the ﬁrst-order approximation, the above formula can be written as
A(z + h,t) = ehL ehNA(z,t) + O(h2)
(15.28)
The basis of this approximation is established by Baker-Hausdorf lemma [12], which is
eA e
B = eA+B e
1
2[A,B]
(15.29)
given that operators A and B commute with [A, B].
The basis of the method is suggested by Eq. (15.28). It tells us that A(z + h,t) can be
determined by applying the two operators independently. The propagation from z to z + h
is split into two operations: ﬁrst the nonlinear step and then the linear step assuming that
they act independently. If h is sufﬁciently small, Eq. (15.28) gives good results.
The value of step h can be determined by assuming that the maximum phase shift
φmax = γ |Ap|2h, where Ap is the peak value of A(z,t) due to the nonlinear operator is
smaller than the predeﬁned value. Iannone et al. [2] reported that φmax ≤0.05 rad.
For a practical implementation of the SSFM, we need to establish practical expressions
for dispersive and nonlinear terms. In the following we will therefore analyse the effect of
both terms independently neglecting losses.
Let us analyse the effect of the dispersive term alone. For that we temporally switch off
the nonlinear term. After Fourier transform, the ‘linear equation’ becomes
∂1A(z, ω)
∂z
= −i
2ω2β21A(z, ω)
which has the solution
1A(z, ω) = 1A(0, ω)e−iω2β2z/2
The action of the nonlinear term alone is described by the equation
∂A(z,t)
∂z
= iγ |A(z,t)|2A(z,t)
The ‘natural’ solution is in the time domain. It produces
A(z,t) = A(0,t)eiγ |A|2A
15.4.1 Split-step Fourier transform method
The propagation medium (say, cylindrical optical ﬁbre) is divided into small segments, each
of length h, see Fig. 15.2. Further, each individual segment of length h is subdivided into
two of equal lengths. The linear operator operates over each subsegment in the frequency
domain, whereas the nonlinear operator operates only locally at the central point.

360
Optical solitons
Operation of the linear operator L, Eq. (15.25) over ﬁrst subsegment is done as follows:
ehL/2A(z,t) = F −1 
ehL/2 F {A(z,t)}

(15.30)
i.e. one must Fourier transform original amplitude from time domain into frequency domain,
apply linear operator L and then apply inverse Fourier transform to get the amplitude back
to time domain.
The operation of nonlinear operator deﬁned by Eq. (15.26) is as follows:
Ai+1/2,L(z,t) = Ai+1/2,R(z,t) eh N
(15.31)
where Ai+1/2,L is the value of ﬁeld amplitude at an inﬁnitesimal point left from i+ 1
2. Finally,
the operation of linear operator over second subsegment of length h
2 is done exactly the
same way as over the ﬁrst segment.
To summarize, the method over each segment of length h consists of three steps:
step 1
⎧
⎪⎨
⎪⎩
1Ai(z, ω) = F {Ai(z,t)}
1Ai−(z, ω) = 1Ai(z, ω) · exp

−i 1
2ω2β2h

Ai−(z,t) = F −1 1Ai−(z, ω)

step 2
Ai+(z,t) = Ai−(z,t) · exp

iγ |A|2Ah

step 3
⎧
⎪⎨
⎪⎩
1Ai+1(z, ω) = F {Ai+1(z,t)}
1Ai+1(z, ω) = 1Ai+1(z, ω) · exp

−i 1
2ω2β2h

Ai+1(z,t) = F −1 1Ai+(z, ω)

where F indicates Fourier transform (FT) and F−1 inverse FT.
15.4.2 Symmetrized split-step Fourier transform method (SSSFM)
The simulation time of Eq. (15.28) essentially depends on the size of step h. To reduce
simulation time, a new method was invented which allows us to use larger steps, h.
Mathematically, one uses the following second-order approximation:
A(z + h,t) = e
1
2 hL exp
 z+h
z
N(z′)dz′

e
1
2 hLA(z,t) + O(h3)
(15.32)
In this approach one assumes that the nonlinearities are distributed over h, which is more
realistic. For small h, one can approximately evaluate
 z+h
z
N(z′)dz′ ≈h
2
N(z) + N(z + h)

In the SSSFM algorithm Eq. (15.31) is replaced by
Ai+1/2,L(z,t) = Ai+1/2,R(z,t) eh[N(z)+N(z+h)]
(15.33)
The above scheme requires iteration to ﬁnd Ai+1 since it is not known at z + 1
2h. Initially
N(z + h) will be assumed to be the same as N(z).

361
Numerical results
−1000
0
1000
0
500
1000
0
0.005
0.01
0.015
time (ps)
distance (km)
Fig. 15.3
Evolution in time over one soliton period for N = 1 soliton.
−1000
0
1000
0
500
1000
0
0.005
0.01
0.015
time (ps)
distance (km)
Fig. 15.4
Evolution in time over one soliton period for N = 1 soliton with damping.
15.5 Numerical results
Based on the developed software, in this section we will report on numerical analysis of
soliton propagation in optical ﬁbre. The SSFM has been implemented and MATLAB code
is provided in Appendix, Listing 15A.1. We start with the single solitons.
15.5.1 Single solitons
In our analysis we used ﬁbre and pulse parameters summarized in Table 15.1. The input
soliton was considered to be in the form
Ain (ξ = 0, T ) = √A0 sech
 T
T0

(15.34)
where N is the soliton order given by Eq. (15.21). In Fig. 15.3 we illustrated the propagation
of N = 1 soliton without damping and in Fig. 15.4 the evolution of the same soliton with
damping (α = 0.01 dB km−1).

362
Optical solitons
−1000
0
1000
0
500
1000
0
0.05
0.1
0.15
0.2
time (ps)
distance (km)
Fig. 15.5
Evolution in time over one soliton period for N = 3 soliton. Note soliton splitting near z0 = 0.5 and its recovery
beyond that point.
−1000
0
1000
0
500
1000
0
0.05
0.1
0.15
0.2
time (ps)
distance (km)
Fig. 15.6
Evolution in time over one soliton period for N = 3 soliton with damping.
A higher-order soliton with N = 3 is deﬁned as
Ain (ξ = 0, T ) = N3√A0 sech
 T
T0

(15.35)
Propagation of higher-order soliton with N = 3 is shown in Fig. 15.5 (no damping) and in
Fig. 15.6 (with damping). One can observe periodic evolution of the undamped soliton.
15.5.2 Chirped solitons
Here we analyse how chirp affects single soliton propagation. We assume the following
input:
Ain (ξ = 0, T ) = √A0 sech
 T
T0

exp
!
−iC/2
 T
T0
2"
(15.36)

363
Numerical results
−1000
0
1000
0
500
1000
0
0.005
0.01
0.015
0.02
time (ps)
distance (km)
Fig. 15.7
Evolution in time of a chirped soliton for N = 1 without damping.
−1000
0
1000
0
500
1000
0
0.005
0.01
0.015
time (ps)
distance (km)
Fig. 15.8
Evolution in time of two interacting solitons without damping.
where C is the chirped parameter. Evolution of such soliton in the case of N = 1 and
C = 1.6 is shown in Fig. 15.7. The pulse is initially compressed and then broadens.
15.5.3 Two interacting solitons
The effect of nonlinearity produces mutual interaction between soliton pulses if they are
launched close together [13]. This interaction is important from a practical point of view
and also from a fundamental perspective related to soliton propagation. For example, it was
shown [13] that nonlinear interaction between solitons can result in a bandwidth reduction
by a factor of 10. See also the review in [14].
First, we consider an interaction between two solitons of the same strength and N = 1.
We assume the initial pulses of the form [15]
Ain (ξ = 0, T ) = √A0sech
 T
T0
−1

+ √A0sech
 T
T0
+ 1

(15.37)
The result of two interacting solitons is shown in Fig. 15.8.

364
Optical solitons
TB
0
0
0
1
1
1
1
solitons
Fig. 15.9
Stream of solitons.
15.6 A few comments about soliton-based communications
As mentioned at the beginning of this chapter, an important application of solitons is in
the transmission of information in optical ﬁbre systems. Soliton pulses are stable when
they propagate over long distances. Losses in ﬁbres are an important limiting factor, so it
becomes necessary to compensate periodically for ﬁbre loss. This can be done by using
EDFA.
In the transmission of information, solitons are considered like linear pulses. In a bit
stream each soliton has its own bit slot and it represents logical one or zero, see Fig. 15.9.
Here TB is the duration of the bit slot and it is related to bit rate B as
TB = 1
B = 2aT0
(15.38)
where T0 is the soliton width and 2a speciﬁes the distance between neighbouring solitons.
To prevent their interactions, the neighbouring solitons should be well separated.
Solitons are very well suited for long-haul communication because of their high
information carrying capacity and the possibility of periodic ampliﬁcation. However,
soliton systems are still waiting for the full ﬁeld deployment. The reader might con-
sult recent publications on soliton-based optical communication systems [16], [17],
[18], [19].
15.7 Problems
1.
Implement a symmetrized SSFM based on Eq. (15.33).
2.
Generalize the implementation by including the third-order dispersion effect where
β3 ̸= 0. Analyse the inﬂuence of β3 on propagation of N = 1 and N = 3
solitons.
3.
Implement SSFM for a normalized form of NLSE given by Eq. (15.23). Using your
implementation, conduct the analysis for N = 1 and N = 3 solitons.
4.
Analyse the propagation of Gaussian pulses in ﬁbres with nonlinearity using SSFM.
Consider regular Gaussian and also chirped Gaussian pulses.

365
Appendix 15A
Table 15.2 List of MATLAB functions for Chapter 15.
Listing
Function name
Description
15A.1
ss f tm f ull.m
Analysis of various types of solitons
Appendix 15A: MATLAB listings
In Table 15.2 we provide a list of MATLAB ﬁles created for Chapter 15 and a short
description of each function.
Listing 15B.1
Program ssftw full.m. Here we conduct analysis of various solitons using
the split-step Fourier transform method.
% File name: ssftm_full.m
% Split-step Fourier transfer method for the analysis of solitons
% Contains the following initial pulses
% N=1 soliton
% N=3 solitons
% Chirp N=1 soliton
% Two interacting solitons
% For the analysis of the appropriate case it should be uncommented
%
clear all
tic;
%===== Material parameters ===================
%alpha=0.01;
% Fibre loss (dB/km)
alpha = 0.0;
alpha=alpha/(4.343);
% Fibre loss (1/km)
gamma = 1.3;
% Fibre nonlinearity [1/W/km]
beta_2=15d-24;
% 2nd order disp. (s^2/km)
%====== Time parameters ===========
T =- 512e-12:1e-12: 511e-12;
delta_t=1e-12;
%======= Input pulse and its parameters ========
T_0 = 100d-12;
% Initial pulse width (s)
P_0 = 0.15d-3;
% Input power (Watts)
A_0 = sqrt(P_0);
L_D =((T_0^2)/(abs(beta_2)));
% Dispersion length in [km]
L_NL = (1/(gamma*P_0));
h = 2d0;
% step size [km]
z_plot = (0:h:((pi/2)*L_D));
% z-values to plot [in km]
n = 1;
% controls stepping
z_0 = (pi/2)*L_D;
% Soliton period [km]
N = 3;
% Soliton number

366
Optical solitons
%A = N^2*A_0*sech(T/T_0);
% N=3 soliton
%A = A_0*sech(T/T_0);
% N=1 soliton
C = 1.6;
% chirp parameter
%A = A_0*sech(T/T_0).*exp((-1i*C/2).*(T/T_0).^2);
% N=1 soliton with chirp
A = A_0*sech(T/T_0-1.6)+A_0*sech(T/T_0+1.6);
% interacting solitons
%
L = max(size(A));
Delta_omega=1/L/delta_t*2*pi;
omega = (-L/2:1:L/2-1)*Delta_omega;
A_f = fftshift(fft(A));
% Pulse in frequency domain
for jj=h:h:z_0
A_f = A_f.*exp(-alpha*(h/2)-1i*beta_2/2*omega.^2*(h/2));
A_t =ifft(A_f);
% Pulse in time domain
A_t = A_t.*exp(1i*gamma*((abs(A_t)).^2)*(h));
A_f = fft(A_t);
A_f = A_f.*exp(-alpha*(h/2)-1i*beta_2/2*omega.^2*(h/2));
A_t = ifft(A_f);
plotting(:,n) = abs(A_t);
n = n+1;
end
toc;
cputime=toc;
%
z_plot = h:h:z_0;
% creates distance for plotting
length(z_plot)
for k = 1:80:length(z_plot)
% Choosing 3D plots every 10-th step
y = z_plot(k)*ones(size(T));% Spread out along y-axis
plot3(T*1d12,y,plotting(:,k),’LineWidth’,1.5)
hold on
end
xlabel(’time (ps)’,’FontSize’,14);
ylabel(’distance (km)’,’FontSize’,14);
set(gca,’FontSize’,14);
% size of tick marks on both axes
grid on
pause
close all
References
[1] L. F. Mollenauer and J. P. Gordon. Solitons in Optical Fibers. Fundamentals and
Applications. Elsevier, Amsterdam, 2006.
[2] E. Iannone, F. Matera, A. Mocozzi, and M. Settembre. Nonlinear Optical Communi-
cation Networks. Wiley, New York, 1998.
[3] G. P. Agrawal. Fiber-Optic Communication Systems. Second Edition. Wiley, New
York, 1997.

367
References
[4] Y. S. Kivshar and G. P. Agrawal. Optical Solitons. From Fibers to Photonic Crystals.
Academic Press, Amsterdam, 2003.
[5] A. Hasegawa and M. Matsumoto. Optical Solitons in Fibers. Springer, Berlin, 2003.
[6] A. Hasegawa and Y. Kodama. Solitons in Optical Communications. Clarendon Press,
Oxford, 1995.
[7] R. W. Boyd. Nonlinear Optics. Third Edition. Academic Press, Amsterdam, 2008.
[8] R. W. Hellwarth. Third-order optical susceptibilites of liquids and solids. Prog. Quant.
Electr., 5:1–68, 1977.
[9] A. Yariv and P. Yeh. Photonics. Optical Electronics in Modern Communications. Sixth
Edition. Oxford University Press, New York, Oxford, 2007.
[10] G. P. Agrawal. Nonlinear Fiber Optics. Academic Press, Boston, 1989.
[11] G. P. Agrawal. Nonlinear Fiber Optics, Fourth Edition. Elsevier Science & Technology
Books, Boston, 2006.
[12] R. L. Liboff. Introductory Quantum Mechanics. Addison-Wesley, Reading, MA, 1992.
[13] P. L. Chu and C. Desem. Mutual interaction between solitons of unequal amplitudes
in optical ﬁbre. Elect. Lett., 21:1133–4, 1985.
[14] C. Desem and P. L. Chu. Soliton-soliton interactions. In J. R. Taylor, ed., Optical
Solitons – Theory and Experiment, pages 107–51, Cambridge University Press,
Cambridge, 1992.
[15] Z. B. Wang, H. Y. Yang, and Z. Q. Li. The numerical analysis of soliton propagation
with split-step Fourier transform method. Journal of Physics: Conference Series,
48:878–82, 2006.
[16] A. Hasegawa. Soliton-based optical communications: An overview. IEEE J. Select.
Topics Quantum Electron., 6:1161–72, 2000.
[17] M. F. Ferreira, M. V. Facao, S. V. Latas, and M. H. Sousa. Optical solitons in ﬁbers
for communication systems. Fiber and Integrated Optics, 24:287–313, 2005.
[18] R. Gangwar, S. P. Singh, and N. Singh. Soliton based optical communication. Progress
in Electromagnetics Research, PIER, 74:157–66, 2007.
[19] N. Vijayakumar and N. S. Nair. Solitons in the context of optical ﬁbre communications:
a review. Journal of Optoelectronics and Advanced Materials, 9:3702–14, 2007.

16
Solar cells
In this chapter we provide the fundamentals of solar cell operations. We outline basic
physical principles, summarize a model based on equivalent circuit and discuss ways to
increase efﬁciency of single-junction solar cell by employing multijunction structures or
by creating intermediate bands.
General introductory books describing solar cells are [1], [2] and [3]. Anderson [1] and
Rabl [2] provide a practical background in solar-energy conversion including techniques
for estimating the solar radiation incident upon a collector, fundamentals of optics for solar
collectors, discussion of types of concentrators and economical analysis, among others.
Moeller [3] concentrates on fundamental, physical and material aspects of semiconductors
for photovoltaic energy conversion.
16.1 Introduction
World consumption of electric energy circa 2009 was around 12–13 TW [4]. This energy
was created by several methods. Let us look brieﬂy at two of them: nuclear power and solar
energy.
Assuming that a single nuclear plant produces 1 GW of power, creation of 10 TW of
power would require 10 000 nuclear power plants. This huge number will certainly create
social problems. Also, the uranium needed for those plants could be diminished in less than
20 years.
As far as the solar energy is concerned, the Sun supplies more solar energy on Earth
in one hour than we use globally in one year. To make another comparison, a football
ﬁeld covered with silicon solar cells with an efﬁciency around 17% at 1-Sun illumination
produces approximately 500 kW of power. The USA uses about 3 TW, so to produce that
amount one will need about 6 million football ﬁelds. However, by increasing efﬁciency
of solar cells, for example by using multijunction devices and increasing concentration of
solar energy, the area of semiconductor solar cells can be signiﬁcantly reduced [5].
Those rough estimates indicate that solar energy can be a practical alternative as a source
of electric energy, and also that increasing the efﬁciency of solar cells is important. One
should, however, remember that the incidence of solar energy is not uniform.
Solar irradiation spectrum (spectrum of solar energy) is shown in Fig. 16.1. This graph
will be important later when we discuss in detail multijunction cells. In the ﬁgure we
show spectral intensity, that is intensity of solar energy per unit wavelength. Above the
Earth’s atmosphere it is denoted as AM0 (air-mass zero). The integrated (over the whole
368

369
Introduction
2.5
2.0
1.5
1.0
0.5
0.2
0.4
0.6
0.8
1.0
Wavelength [μm]
Energy distribution [kW/m2 μm]
Black body radiation 6000 K
AM0 radiation
AM1.5 radiation
1.2
1.4
1.6
1.8
2.0
Fig. 16.1
Solar irradiation spectrum. Reprinted and adapted with permission from C. H. Henry, J.Appl.Phys. 51, 4494 (1980).
Copyright 1980, American Institute of Physics.
h
Θ
h0
Atmosphere
Fig. 16.2
Definition of air-mass.
spectrum) intensity above the Earth’s atmosphere is constant and its approximate value is
1.353 kW m2. It gives the total power ﬂow through a unit area perpendicular to the direction
of the Sun.
The Earth’s atmosphere signiﬁcantly absorbs radiation from the Sun. In Fig. 16.1 the
radiation at the Earth’s surface is labelled as AM1.5. In the ﬁgure several absorption bands
and lines due to various effects are shown. For comparison, the spectrum of black body
radiation at the temperature of 6000 K is also shown. One can notice that the solar spectrum
above the Earth’s atmosphere (AM0) resembles black body radiation.
The air mass coefﬁcient deﬁnes the direct optical path length through the Earth’s at-
mosphere, expressed as a ratio relative to the path length vertically upwards, i.e. at the
zenith.
Let us ﬁnish this section with an explanation of AM (air-mass) convention. Generally air
mass m (AMm) is deﬁned (see Kasap [6]) as the ratio of the actual radiation path h to the
shortest path h0, m = h/h0 = cos , see Fig. 16.2.
Changing the light intensity incident on a solar cell changes all solar cell parameters,
including the short-circuit current, the open-circuit voltage, the efﬁciency and the impact
of series and shunt resistances. The light intensity on a solar cell is measured in the number
of ‘suns’, where 1 sun corresponds to standard illumination at AM1.5, or 1 kW m2. For

370
Solar cells
sunlight
p-type
n-type
Fig. 16.3
A p-n junction operating as a solar cell.
example, a system with 10 kW m2 incident on the solar cell would be operating at 10 suns,
or at 10X.
16.2 Principles of photovoltaics
The simplest solar cell (or photovoltaic (PV) cell) is a single p-i-n junction operating
under forward bias. It is formed by using, e.g. properly doped silicon, see Fig. 16.3. It can
produce potential difference, thus acting as a battery. It contains a very narrow and heavily
doped n-region. It is covered with thin antireﬂecting coating to reduce sun reﬂection which
penetrates p-n junction from n-side, see Fig. 16.4 for more details.
Short wavelengths penetrate only the n-region, longer wavelengths penetrate depletion
region of width w, and ﬁnally the longest wavelengths reach the p-region, see Fig. 16.5.
Photons of frequency ν having energies hν ≥Eg, where Eg is the bandgap energy,
generate electron-hole (e-h) pairs. Due to a built-in electric ﬁeld E0 in the depletion region,
electrons move towards metal contact in the n-region whereas holes travel in opposite
direction towards metallic contact in the p-region. Since the n-region is very narrow, most
of the photons are absorbed in the depletion region. Each generated electron increases
charge in the n-region by −e; similarly each hole makes the p-region more positive by +e.
Thus potential difference is created between metallic electrodes.
A semiconductor can only efﬁciently convert photons into current with energies equal to
the bandgap. Photons with energies smaller than the bandgap are not absorbed, and photons
with higher energies reduce their energies to the bandgap energy by thermalization of the
photogenerated carriers; a process which involves losses.
The basic relation which provides the link between photons’ energy and their wavelength
is
λ[µm] = 1.24
E[eV ]
(16.1)
If both terminals of solar cell are shorted, the excess electrons on the n-side will start
ﬂowing through an external wire contributing to electrical current known as photocurrent,

371
Principles of photovoltaics
bottom
contact
top contact
incident light
p+ layer
p-layer
n-layer
antireflection
coating
Fig. 16.4
Solar cell perspective.
+
–
Ev
EFc
Ec
Eg
AR coating
n-region
p-region
Iph
w
E
λ
0
Fig. 16.5
The principle of photocurrent generation in a solar cell in short circuit.
Iph, see Fig. 16.6. The short circuit conventional current Isc ﬂows opposite to photocurrent.
If Ilight is the light intensity, one can write
Isc = −Iph = −K · Ilight
where K is some (device dependent) constant.

372
Solar cells
Id  – Iph
I =
R
V
Fig. 16.6
Solar cell driving an external load resistance R.
Iph
V
I
Voc
dark
under illumination
power
Fig. 16.7
Finding an operating point of a solar cell.
When the illuminated solar cell is loaded with resistance R, the conventional current I is
I = Id −Iph, see Fig. 16.6, where Id is a forward diode current:
Id = I0

exp
 eV
ηkBT

−1

(16.2)
and where I0 is a constant, V is the voltage across diode and η is known as diode ﬁdelity
factor. It is equal to 1 for diffusion controlled and 2 for space charge layer recombination
controlled characteristics.
The I-V characteristic of solar cell is shown in Fig. 16.7. It is obtained from a dark
diode by shifting its I-V curve downward by Iph. The analytical expression for conventional
current is
I = −Iph + I0

exp
 eV
ηkBT

−1

(16.3)
With the load resistance R connected to the solar cell, see Fig. 16.6, the current-voltage
relation is
I = −V
R
(16.4)
Operating point of solar cell with load resistance R is obtained by solving Eqs. (16.3) and
(16.4). The graphical solution is illustrated in Fig. 16.8., where we have plotted Eqs. (16.3)
and (16.4). Crossing of both lines determines operating point (V1, I1) of a solar cell.
The point at which a characteristic intersects the vertical current axis is known as a short
circuit condition and the corresponding current as short-circuit current Isc. Similarly, the
point at which I-V characteristic intersects the horizontal voltage axis is known as the open

373
Equivalent circuit of solar cells
Isc     –Iph
V
I
Voc
P (operating point)
=
Fig. 16.8
Finding an operating point of a solar cell.Voc is an open-circuit voltage.
Iph
Id
I
Rs
Rsh
V
Fig. 16.9
Equivalent circuit of a solar cell.
circuit condition. It deﬁnes the open-circuit voltage Voc, which is the maximum voltage
which can be drawn from the solar cell. It corresponds to zero current.
Power delivered to the load R is Pload = I1 · V1, which is the area of the rectangle, see
Fig. 16.7. The goal of the solar cell design is to maximize that power.
16.3 Equivalent circuit of solar cells
Over the years several methods of modelling solar cells have been introduced. The simplest
approach is based on equivalent circuit models. Some recently published works with an
emphasis on using MATLAB are [7], [8], [9].
16.3.1 Basic model
The equivalent circuit of solar cell which includes parasitic effects is shown in Fig. 16.9.
It consists of current source which generates photoelectric current Iph, ideal diode, shunt
resistor and series resistor. Based on this model, the goal is to obtain current-voltage relation.
From Kirchoff rule one obtains (from now on we reverse direction of ﬂow of conventional
current, which is a common practice)
I = Iph −Id
(16.5)
where I is the cell total current and Id is the diode current. Combining the above and
relation (16.3), one ﬁnds
I = Iph −I0

exp
 eVd
ηkBT

−1

(16.6)

374
Solar cells
This equation describes an ideal situation without parasitic effects. In a real solar cell
there exists leakage current ﬂowing through shunt resistance Rsh. Potential drop across the
device is represented by series resistance Rs. The inclusion of shunt resistance modiﬁes
solar current I as
I = Iph −Id −Vd
Rsh
(16.7)
The impact of series resistance is included as
Vd = V + I · Rs
(16.8)
With the parasitic effects included, the solar current I takes the form
I = Iph −I0

exp
 eVd
ηkBT

−1

−V + I · Rs
Rsh
(16.9)
The photocurrent Iph depends on the solar insolation and cell’s temperature and it is given
by [10], [11]
Iph =

Isc + KI

Tc −Tre f

Sin
(16.10)
where Isc is the cell’s short-circuit current at a 25◦C and 1 kW m2, KI is the cell’s short-
circuit current temperature coefﬁcient, Tre f is the cell’s reference temperature and Sin is the
solar insolation in kW m2.
The expression for I0 is [10], [11]
I0 = IRS
 Tc
Tre f
3/n
exp
⎡
⎣
Egap
AkB
(
1
Tre f −1
Tc
)
⎤
⎦
(16.11)
where IRS is cell’s reverse saturation at a reference temperature and a solar radiation, Egap
is the bandgap energy of the semiconductor used in the cell and A is an ideal factor which
depends on PV technology. Some typical values are: A = 1.2 for Si-mono, A = 1.3 for
Si-poly and A = 1.5 for CdTe (after [10]).
16.3.2 Other models
There exist other models of solar cells which are based on a basic model. Here, we will
only mention two such models: the double exponential model and ideal PV cell model.
Double exponential model [12] is shown in Fig. 16.10. This model contains a light
generated current source, two diodes D1 and D2 and a series and parallel resistances. The
model is derived from the physics of the p-n junction and can describe cells constructed
from polycrystalline silicon.
Simple models. The shunt resistance Rsh is inversely related to shunt leakage current to
the ground. PV efﬁciency shows little sensitivity to the variation of Rsh and one can assume
that Rsh = ∞. The resulting model is similar to the basic one, shown in Fig. 16.9, without
Rsh. The current-voltage expression for this model is
I = Iph −I0

exp
e (V + I · Rs)
ηkBT

−1

(16.12)

375
Equivalent circuit of solar cells
Table 16.1 Parameters for equivalent circuit model of Si solar cell.
Description of parameter
Symbol
Value
Illumination
Iph
10 mA
eta
η
1.5
Current
I0
3 × 10−6 mA
Series resistance
Rs
0 , 20 , 50 
Shunt resistance
Rsh
415 
Iph
I
Rs
D2
D1
Rsh
V
Fig. 16.10
Double exponential model of a solar cell.
0
0.2
0.4
0.6
0.8
0
0.005
0.01
0.015
0.02
Current (mA)
Voltage (V)
RS = 50 Ω 
RS = 20 Ω 
RS = 20 Ω 
Fig. 16.11
Current-voltage characteristics of an ideal solar cell based on Si for several values of series resistance.
An ideal PV cell model assumes no series loss and no leakage to ground; i.e. Rs = 0 and
Rsh = ∞. The equivalent circuit consists of only current source and one diode. Current is
expressed as
I = Iph −I0

exp
 eV
ηkBT

−1

(16.13)
We conducted analysis using typical parameters, which are summarized in Table 16.1.
Current-voltage characteristics for several values of series resistance are shown in Fig. 16.11
and in Fig. 16.12 we presented current-voltage characteristics at three different values

376
Solar cells
0
0.2
0.4
0.6
0.8
0
0.005
0.01
0.015
0.02
Current (mA)
Voltage (V)
300K
350K
Fig. 16.12
Current-voltage characteristics of an ideal solar cell based on Si for several values of temperature.
of temperatures. MATLAB code used to generate those characteristics is shown in the
Appendix, Listings 16A.1, 16A.2 and 16A.3. These are typical results as reported in the
literature.
16.4 Multijunctions
As determined by Shockley and Queisser [13], the maximum theoretical limit for a single
junction solar cell is about 31%. In order to increase theoretical efﬁciency one needs to
increase number of p-n junctions in the cell. Henry [14] found that maximum theoretical
efﬁciency at a concentration of 1 sun is 31%. At a concentration of 1000 suns with the cell
at 300 K, the maximum efﬁciencies are 37%, 50%, 56% and 72% for cells with 1, 2, 3 and
36 p-n junctions (with different, properly chosen energy gaps), respectively.
Increase in efﬁciencies can be obtained by splitting solar spectrum into several parts
and using different materials for conversion in various parts. This principle is illustrated in
Fig. 16.13 for a triple solar cell built from Ga0.49In0.51P(1.9 eV), Ga0.99In0.01As(1.4 eV) and
Ge(0.7 eV) (adopted from Dimroth [15]). Germanium is used mainly due to its robustness
and its low cost of production. Those different semiconductor materials are grown on
one substrate. Tunnel junctions are used to form an electrical series connection of the
subcells.
Suitable materials must be chosen for each cell so that photons of appropriate wavelengths
are absorbed. The bandgap of each material is determined using Eq. (16.1). Energy bandgap
Eg must decrease from top cell to bottom cell in order not to absorb all photons by the top
cell. Also, all layers of semiconductors must be lattice matched, so that there is no built-in
strain.
The anti-reﬂective (AR) coating typically consists of several layers. Design of AR layers
can be performed using methods discussed in Chapter 3.

377
Multijunctions
0.2
0.5
1.0
1.5
2.0
2.5
0.4
0.6
0.8
1.0
1.2
1.4
1.6
1.8
wavelength (μm)
visible range
AM0 radiation
Middle
cell
Bottom cell
Top cell
Energy distribution (kW/ m2 μm)
Tunnel junction
AR coating
wavelength
long middle short
Top cell: GaInP
Middle cell: GaAs
Bottom cell: Ge
Ge substrate
Tunnel junction
Contact
Contact
Fig. 16.13
Triple-junction solar cell. (From F. Dimroth, High-efficiency solar cells from III-V compound semiconductors, Phys.Stat.
Sol. (c) 3, 373–9 (2006). Copyright Wiley-VCH Verlag GmbH and Co. KGaA. Reproduced with permission.)
The presence of tunnel junctions is to provide low electrical resistance between subcells.
Modelling of those layers speciﬁcally for the purpose of MJ solar cells has been described
recently by Baudrit and Algora [16].
16.4.1 Quantum dots in multijunctions
The triple-junction subcells shown are connected in series and their voltages add up, but
the current ﬂowing through the structure is determined by the smallest current produced by
subcells. Total power generated by the structure is greater than that of the single junction
cell.
The thickness of each subcell is determined by its absorption and the light power available
in the spectral range where the subcell operates. Referring to Fig. 16.13, the bottom cell
(formed by Ge, including substrate) is much thicker than two upper subcells. Due to this
and also because it covers much larger spectral range, the Ge subcell produces much larger
current compared to two upper subcells.
One of the possible solutions of reducing current of the Ge subcell and at the same
time increasing current of the GaAs subcell, is to introduce InAs-based quantum dots into
the GaAs subcell [17]. These quantum dots are designed to have an effective bandgap
slightly smaller than that of GaAs. Therefore they can ‘steal’ current from bottom Ga
subcell roughly by about 15%. Increasing also the thickness of top GaInP subcell to match
the increased current of GaAs results in an overall current increase by about 15%. With

378
Solar cells
Ev
EIB
Ec
Fig. 16.14
Illustration of a concept of intermediate-band solar cell.
the minimal change in voltage over GaAs subcell, this concept resulted in an increase of
triple-junction conversion efﬁciency by about 13%.
16.4.2 Intermediate band solar cells (IBSC)
The concept of intermediate band solar cells (IBSC) was ﬁrst described by Luque and Marti
[18] and by Wolf [19]. The main idea was to create an additional band between conduction
and valence bands, see Fig. 16.14. The additional intermediate band can be created using
several approaches, like, for example, minibands.
The standard cell is only able to absorb photons with energy equal to or greater than
Egap = Ec −Ev. Within this new scheme it is possible to have additional absorption via
the IB.
The electronic states in the IB should be accessible via direct transitions. Therefore
photon of energy EIV can transfer an electron from the valence band into IB whereas
another photon with energy ECI will be able to pump electrons from IB to conduction band.
Thus the performance of solar cell is increased.
Solar cells based on this design are attractive because of their predicted photon conver-
sion efﬁciency of up to about 60% [20]. The authors of Ref. [20] show that the ordered
three-dimensional arrays of quantum dots, i.e., quantum dot supracrystals, can be used to
implement the intermediate-band solar cell with the efﬁciency signiﬁcantly exceeding the
Shockley-Queisser limit for a single junction cell. The increase is due to the utilization of
photogenerated hot carriers which can produce higher voltages and higher photocurrents.
Modelling of such structures has been conducted using the CFD Research Corporation
3D device simulator, NanoTCAD [21]. They performed accurate simulations of quantum
dot solar cell performance and degradation due to effects of space radiation.
A recent summary of some aspects of intermediate-band solar cells was published in
Nature Photonics [22].
16.4.3 Role of simulations
Numerical simulations and modelling of solar cells play an important role. One particular
example has been mentioned in the preceding section. Optimization of modern structures,
especially for multijunction or quantum dots by experimental trial-and-error methods, is
deﬁnitely too costly. This opens the room for simulations.

379
Appendix 16A
The optical and electrical interactions between the numerous layers in a multi-junction
solar cell are very complex. Over the years several groups have developed simulation models
of various levels of sophistication. The simplest approach based on equivalent circuits
model was summarized in an earlier section. There were also many successful attempts to
develop microscopic models of various complexity. Full discussion of microscopic models,
including those based on drift-diffusion approach, is beyond the scope of this book.
Also, a few commercial products are found on the market: Sentaurus from Synopsys,
Atlas from Silvaco or Solar Cell utility from RSoft. Some recent examples of using com-
mercial software to simulate and design solar cells are described in [23], [24] and [25].
The authors of Ref. [25] describe details of using Sentaurus to simulate quantum well solar
cells.
More sophisticated approaches to designing of quantum well solar cells using quantum
transport are also under development [26], [27]. Such approaches combine elements from
semiconductor optics and quantum transport in nanostructures. A very fundamental
approach based on non-equilibrium Green’s functions (NEGF) is discussed extensively
in [26]. The developed approach treats absorption, transport and relaxation on equal foot-
ing and within a framework based on non-equilibrium quantum statistical mechanics.
We ﬁnish this discussion by mentioning the role played by plasmonics in improving
properties of photovoltaic devices, see a recent summary [28]. Plasmonics describe guiding
and localizing light at the nanoscale smaller than the wavelength of light in free space.
Using plasmonics allows for new designs of solar cells in which light is fully absorbed in a
single quantum well. Proposed solutions can result in improved absorption in photovoltaic
devices.
Appendix 16A: MATLAB listings
In Table 16.2 we provide a list of MATLAB ﬁles created for Chapter 16 and a short
description of each function.
Listing 16A.1
Program solar Si.m. MATLAB program which plots I-V characteristics of
an ideal solar cell for several values of series resistance based on equivalent circuit model.
% File name: solar_Si.m
% Simulates ideal solar cell based on Si
Table 16.2 List of MATLAB functions for Chapter 16.
Listing
Function name
Description
16A.1
solar Si.m
Generates I-V characteristics for several values of series resistance
16A.2
current V.m
Function used by solar Si.m and solar Si T.m
16A.3
solar Si T.m
Generates I-V characteristics for several values of temperature

380
Solar cells
clear all
eta = 1.5;
I_ph = 0.02;
% illumination current, in mA
T = 330;
V_init = 0;
V_final = 1.0;
V_step = 0.01;
V=0;
hold on
for R_s = [0.01 20 50]
% series resistance, in ohms
curr_total = fzero(@(curr) current_V(curr,V,T,eta,I_ph,R_s),0.2);
for V = V_init:V_step:V_final
curr = fzero(@(curr) current_V(curr,V,T,eta,I_ph,R_s),0.2);
curr_total = [curr_total, curr];
end
V_plot = V_init:V_step:V_final;
% creation voltage values for plot
V_plot = [0, V_plot];
plot(V_plot, curr_total,’LineWidth’,1.5)
set(gca,’FontSize’,14);
% size of tick marks on both axes
axis([0 V_final*0.8 0 I_ph*1.2]);
ylabel(’Current (mA)’,’Fontsize’,14)
xlabel(’Voltage (V)’,’Fontsize’,14)
text(0.65, 0.01, ’R_s = 0 \Omega’,’Fontsize’,14)
text(0.45, 0.01, ’R_s = 20 \Omega’,’Fontsize’,14)
text(0.2, 0.01, ’R_s = 50 \Omega’,’Fontsize’,14)
end
pause
close all
Listing 16A.2
Function current V.m. MATLAB function which creates an expression for
current in the equivalent circuit model.
function fun = current_V(I,V,T,eta,I_ph,R_s)
% Expression for current used in solar cell model based on equivalent
% circuit
q = 1.6d-19;
% charge of electron
k_B = 1.38d-23;
% Boltzmann constant
R_sh = 415;
% shunt resistance in ohms
I_0 = 3d-9;
% reverse saturation current of the diode
VV = V+I*R_s;
fun = I_ph - I - I_0*(exp(q*VV/(eta*k_B*T))-1) - VV/R_sh;
Listing 16A.3
Function solar Si T.m. MATLAB program which plots current-voltage
characteristics of an ideal solar cell for three temperatures using the equivalent circuit
model.

381
References
% File name: solar_Si_T.m
% Simulates effect of temperature for ideal solar cell based on Si
clear all
eta = 1.5;
I_ph = 0.02;
% illumination current, in mA
R_s = 10;
% series resistance, in ohms
V_init = 0;
V_final = 1.0;
V_step = 0.01;
V=0;
hold on
for T = [300 325 350]
% temperature
curr_total = fzero(@(curr) current_V(curr,V,T,eta,I_ph,R_s),0.2);
for V = V_init:V_step:V_final
curr = fzero(@(curr) current_V(curr,V,T,eta,I_ph,R_s),0.2);
curr_total = [curr_total, curr];
end
V_plot = V_init:V_step:V_final;
% creation voltage values for plot
V_plot = [0, V_plot];
plot(V_plot, curr_total,’LineWidth’,1.5)
set(gca,’FontSize’,14);
% size of tick marks on both axes
axis([0 V_final*0.8 0 I_ph*1.2]);
ylabel(’Current (mA)’,’Fontsize’,14)
xlabel(’Voltage (V)’,’Fontsize’,14)
text(0.65, 0.005, ’300K’,’Fontsize’,14)
text(0.38, 0.01, ’350K’,’Fontsize’,14)
end
pause
close all
References
[1] E. E. Anderson. Fundamentals of Solar Energy Conversion. Addison-Wesley, Read-
ing, MA, 1983.
[2] A. Rabl. Active Solar Collectors and Their Applications. Oxford University Press,
New York, Oxford, 1985.
[3] H. J. Moeller. Semiconductors for Solar Cells. Artech House, Boston, 1993.
[4] K. Tanabe. A review of ultrahigh efﬁciency III-V semiconductor compound solar
cells: multijunction tandem, lower dimensional, photonic uo/down conversion and
plasmonic nanometallic structures. Energies, 2:504–30, 2009.
[5] G. S. Kinsey, R. A. Sherif, R. R. King, C. M. Fetzer, H. L. Cotal, and N. H. Karam.
Concentrator multijunction solar cells for utility-scale energy production, 2005.
unpublished.

382
Solar cells
[6] S. O. Kasap. Optoelectronics and Photonics: Principles and Practices. Prentice Hall,
Upper Saddle River, NJ, 2001.
[7] F. M. Gonzalez-Longatt. Model of photovoltaic module in Matlab. 2do Congreso
Iberoamericano de Estudiantes de Ingenieria Electrica, Electronica y Computacion
(II Cibelec, 2005), pages 1–5, 2005.
[8] R. K. Nema, S. Nema, and G. Agnihotri. Computer simulation based study of pho-
tovoltaic cells/modules and their experimental veriﬁcation. International Journal of
Recent Trends in Engineering, 1:151–6, 2009.
[9] M. Azab. Improved circuit model of photovoltaic array. International Journal of
Electrical Power and Energy Systems Engineering, 2:185–8, 2009.
[10] H.-L. Tsai, C.-S. Tu, and Y.-J. Su. Development of generalized photovoltaic model
using Matlab/Simulink. Proceedings of the World Congress on Engineering and
Computer Science, WCECS 2008, 2008.
[11] R. Hernanz, C. Martin, Z. Belver, L. Lesaka, Z. Guerrero, and E. P. Perez. Modelling
of photovoltaic module. International Conference on Renewable Energies and Power
Quality, ICREPQ’10, 2010.
[12] J. A. Gow and C. D. Manning. Development of a photovoltaic array model for use in
power-electronics simulation studies. IEE Proc.-Electr. Power Appl., 146:193–200,
1999.
[13] W. Shockley and H. J. Queisser. Detailed balance limit of efﬁciency of p-n junction
solar cells. J. Appl. Phys., 32:510–19, 1961.
[14] C. H. Henry. Limiting efﬁciencies of ideal single and multiple energy gap terrestrial
solar cells. J. Appl. Phys., 51:4494–500, 1980.
[15] F. Dimroth. High-efﬁciency solar cells from III-V compound semiconductors. Phys.
Stat. Sol.(C), 3:373–9, 2006.
[16] M. Baudrit and C. Algora. Tunnel diode modeling, including nonlocal trap-assisted
tunneling: a focus on III-V multijunction solar cell simulation. IEEE Trans. Electron
Devices, 57:2564–71, 2010.
[17] B. Riel. Quantum dots: higher CPV efﬁciencies, same production cost. Future Pho-
tovoltaics, May, 2010.
[18] A. Luque and A. Marti. Increasing the efﬁciency of ideal solar cells by photon induced
transitions at intermediate levels. Phys. Rev. Lett., 78:5014–17, 1997.
[19] W. Wolf. Limitations and possibilities for improvement of photovoltaic solar energy
converters. Proc. IRE, 48:1246–63, 1960.
[20] Q. Shao, A. A. Balandin, A. I. Fedoseyev, and M. Turowski. Intermediate-band solar
cells based on quantum dot supracrystals. Appl. Phys. Lett., 91:163503, 2007.
[21] A. I. Fedoseyev, M. Turowski, A. Raman, E. W. Taylor, S. Hubbard, S. Polly, S. Shao,
and A. A. Balandin. Space radiation effects modeling and analysis of quantum dot
based photovoltaic cells. In E. W. Taylor and D. A. Cardimona, eds., Proc. of SPIE.
Nanophotonics and Macrophotonics for Space Environments III, volume 7467, page
746705. 2009.
[22] A. Luque and A. Marti. Towards the intermediate band. Nature Photonics, 5:137–8,
2011.

383
References
[23] M. Hermle, G. Letay, S. P. Philipps, and A. W. Bett. Numerical simulation of tunnel
diodes for multi-junction solar cells. Prog. Photovolt: Res. Appl., 16:409–18, 2008.
[24] S. P. Philipps, M. Hermle, G. Letay, F. Dimroth, B. M. George, and A. W. Bett.
Calibrated numerical model of a GaInP-GaAs dual-junction solar cell. Phys. Stat.
Sol. (RRL), 2:166–8, 2008.
[25] P. Kailuweit, R. Kellenbenz, S. P. Philipps, W. Guter, A. W. Bett, and F. Dimroth.
Numerical simulation and modeling of GaAs quantum-well solar cells. J. Appl. Phys.,
107:064317, 2010.
[26] U. Aeberhard. A microscopic theory of quantum well photovoltaics. PhD thesis, Swiss
Federal Institute of Technology, Zurich, 2008.
[27] S. Agarwal. Design guidelines for high efﬁciency photovoltaics and low power tran-
sistors using quantum transport. PhD thesis, Purdue University, 2010.
[28] H. A. Atwater and A. Polman. Plasmonics for improved photovoltaic devices. Nature
Materials, 9:205–13, 2010.

17
Metamaterials
In this chapter we review the basic concept of metamaterials as those possessing simulta-
neously negative permittivity and permeability over the same frequency range. Theoretical
principles and basic experimental results are reviewed. Possible applications including
cloaking, slow light and optical black holes are described.
17.1 Introduction
Metamaterials are artiﬁcially created structures with predeﬁned electromagnetic properties.
They are fabricated from identical elements (atoms) which form one-, two- or three-
dimensional structures. They resemble natural solid state structures. Metamaterials typically
form a periodic arrangement of artiﬁcial elements designed to achieve new properties
usually not seen in Nature [1]. In a sense, they are composed of elements in the same way
as matter consists of atoms.
Metamaterials are characterized and deﬁned by their response to electromagnetic wave.
Optical properties of such materials are determined by an effective permittivity εeff and
permeability μeff valid on a length scale greater than the size of the constituent units.
In order to introduce such a description, one requires that the size of artiﬁcial inclusions
characterized by d be much smaller than wavelength λ, i.e. d ≪λ.
The name meta originates from Greek, μϵτα and means ‘beyond’. Main characteristics
of metamaterials (MM) are:
• man-made,
• have properties not found in Nature,
• have rationally designed properties,
• are constructed by placing inclusions at desired locations.
With modern fabrication techniques it is possible to create structures which are much
smaller than the wavelength of visible light. An example of the unusual properties that such
structures could have is the negative refractive index. Although the problem has a long
history (for example, Mandelstam [2] in 1945 discussed negative refraction and negative
group velocity), it was only in 1967 when Victor Veselago [3] indicated the possibility
of materials having simultaneously negative μ and ε. He demonstrated the technological
potential that materials with a negative refractive index could have for applications in
imaging. It recently made its way to optics, mostly due to rapid progress in nanofabrication.
384

385
Introduction
Fig. 17.1
Schematics of the elementary cells and the wavelength of external electromagnetic wave in two extreme cases.
The most well-known property of metamaterials is the negative index of refraction
(NIM – negative index materials). Another popular name used is left-handed material. This
terminology will soon be explained.
The situation is illustrated in Fig. 17.1. For a longer wavelength, one cannot sense
the properties of individual constituent atoms, shown on the left, whereas the shorter
wavelength, on the order of the distance between ‘atoms’, can effectively be used to
determine some of the atom’s properties (like their locations). In metamaterials we deal
with the situation on the left.
Metamaterials can have controlled magnetic and electric responses over a broad range of
frequencies. Those responses depend on the properties of individual elements (atoms). In
the long-wavelength limit, where a ≪λ, where a is the characteristic dimension and λ is the
wavelength of electromagnetic wave, one should perform some sort of averaging procedure
to determine effective parameters of MM. Details of those procedures are discussed in the
literature [4]. In the end, it is possible to achieve the condition where εeff < 0 and μeff < 0.
A diagram which illustrates the classiﬁcation of metamaterials is shown in Fig. 17.2. In
general negative index materials do not exist in Nature; the rare exception is bismuth, which
when placed in a waveguide shows a negative refractive index at a wavelength of λ = 60µm
[5]. There are no known naturally occurring NIMs in the optical range. However, artiﬁcially
designed materials (metamaterials) can act as NIM. One should, however, notice that the
occurrence of NIM needs both negative εeff < 0 and μeff < 0 over the same frequency
range.
Metamaterials can open new avenues to achieve unprecedented physical properties and
functionality unattainable with naturally existing materials. Optical NIMs promise to create
entirely new prospects for controlling and manipulating light, optical sensing and nanoscale
imaging and photolithography.
17.1.1 Short history of MM
The earliest discussion of the concept of negative refraction goes probably to Schuster
[6]. In the book entitled An Introduction to the Theory of Optics he noted that negative
dispersion of the refractive index with respect to wavelength, i.e. dn/dλ < 0, can produce
negative refraction of light entering such a medium from a vacuum. Some other early works

386
Metamaterials
conventional
(Permeability)
(Permittivity)
LHM
ferrites
split-ring structures
plasma
wire structures
μ
ε
ε<0,  μ<0
ε>0,  μ<0
n<0
n>0
ε<0,  μ>0
ε>0,  μ>0
Fig. 17.2
Classification of materials according to the sign of electric permittivity and magnetic permeability.
on negative refraction include Lamb [7] published in 1904 and Pocklington [8] published
in 1905. Historical aspects were summarized by Simovski and Tretyakov [9] and by Moroz
[10].
In recent years the ﬁeld of metamaterials has received remarkable attention with the
number of published papers growing exponentially. This is due to unusual properties of
such systems (see [4] for a recent review) and also important practical applications like
perfect lenses [11], invisibility cloaking [12], [13], slow light [14] and enhanced optical
nonlinearities [15]. Parallel to theoretical developments, there has been noted spectacular
experimental progress in the ﬁeld [16].
The subject of metamaterials is attracting enormous attention from researchers. We
searched ISI Web of Knowledge, and as of October, 2011 there were 4545 published papers
on the subject of ‘metamaterials’. The plot of the number of published papers is shown in
Fig. 17.3. As can be seen, the number of published papers grows exponentially with some
saturation observed recently.
The modern research progress started in 1999 with the pioneering work by Pendry
and collaborators [17] who discussed artiﬁcial electromagnetic structures, such as split-
ring resonators (SRR) (in general, two concentric split rings), for which they predicted the
existence of negative magnetic permeability. In those structures the incident electromagnetic
wave excites circulating currents in the loops. These currents in turn create oscillating
magnetic dipole moments. With proper design, those currents are resonantly enhanced,
leading to a negative magnetic permeability.
An SRR meta-atom can, in the long-wavelength (quasi-static) regime, be modelled as
a resistor/inductor/capacitor (RLC) resonant circuit [18]. Stacks of such structures exhibit
negative permeability.
The creation of a negative electric permittivity is relatively easy. For instance, it is well-
known that metals at optical frequencies exhibit a plasmon-like permittivity that can assume

387
Introduction
Year
Number of published papers
1200
1000
800
600
400
200
0
2000
2002
2004
2006
2008
2010
Fig. 17.3
Number of papers published on the subject of ‘metamaterials’.
negative values. At smaller (e.g. microwave) frequencies, it was shown by Pendry et al.
in 1996 [19] that an array of long wires acts as a diluted Drude metal when the electric
ﬁeld is oriented along the wire axis. Such a system allows for the existence of a negative
permittivity below the effective plasma frequency. A combination of both magnetic and
electric elements in a suitable design leads to negative index of refraction over a speciﬁed
frequency band.
A report on the ﬁrst negative-index material (NIM) designed and fabricated along the
above principles was published in 2000 by Smith et al. [20]. It operated at microwave
frequencies. The individual SRR had its resonance frequency at 4.845 GHz. The diameter
of the wires was about 0.8 mm, which resulted in a plasma frequency of ωp = 13×109s−1.
There, the authors performed transmission measurements on a NIM structure having a
range of frequencies over which the refractive index was negative for one direction of
propagation. In a subsequent paper, Shelby et al. [21] (again in a transmission experiment)
demonstrated a negative refraction of microwaves incident on the interface between air and
NIM.
In 2003, a group from Boeing Phantom Works reported [22] a very accurate measure-
ments of a Snell’s law using a NIM wedge at frequencies from 12.6 to 13.2 GHz.
Following those pioneering demonstrations, in the next few years the operation fre-
quency has been increased by more than four orders of magnitude. In particular, Yen
et al. [23] demonstrated a NIM response at 1 THz (λ = 300 µm) by making use of
SRRs placed on a double-sided polished quartz substrate. Further design and fabrica-
tion improvements have led to the possibility of creating a three-dimensional double-
negative medium with subwavelength meta-atoms in the optical regime [24], [25]. Indeed,
in 2008, a three-dimensional photonic NIM at optical frequencies has been demonstrated in
Ref. [26].

388
Metamaterials
17.2 Veselago approach
In this section we summarize an early approach as developed by Veselago [3].
17.2.1 Wave equation
In order to proceed with a quantitative description, at this stage we will introduce Maxwell’s
equations, which in the absence of free charges and currents are
∇× E = −μ∂H
∂t
and
∇× H =ε∂E
∂t
(17.1)
Take ∇× (rotation) operation on the ﬁrst equation and then use second equation
∇× ∇× E = −ε ∂
∂t (∇× H) = −με∂2E
∂t2
Use general relation valid for arbitrary vector A
∇× ∇× A = ∇(∇· A) −∇2A = −∇2A
In the last step, we used ∇· E =0. One obtains the wave equation
∇2E = −με∂2E
∂t2 = 0
(17.2)
If we disregard losses and consider ε and μ as real numbers, then one can observe that
wave equation is unchanged when we simultaneously change signs of ε and μ.
17.2.2 Left-handed materials
Start with the basic Maxwell’s equations (17.1). Assume time-harmonic ﬁelds
E(x, y, z,t) = E(x, y, z)eiωt + c.c.
and introduce wave vector k by assuming plane-wave dependence
E, H ∼eik·r
Maxwell’s equations take the form
k × E = −μωH
(17.3)
k × H = εωE
(17.4)
From Eqs. (17.3) and (17.4) and deﬁnition of cross product, one can immediately see
that for ε > 0 and μ > 0 vectors E, H and k form a right-handed triplet of vectors, and if
ε < 0 and μ < 0 they form a left-handed system, see Fig. 17.4.

389
How to create metamaterial?
E
H
k
E
H
k
(b)
(a)
Fig. 17.4
(a) Right-hand orientation of vectors E, H, k for the case when ε > 0, μ > 0. (b) Left-hand orientation of vectors
E, H, k for the case when ε < 0, μ < 0. The figure is taken, with permission of the Canadian Association of
Physicists (CAP), from an article by Wartak et al. [27].
1
2
θ
3
4
1
2
n1
n2
θ
Fig. 17.5
Reflection and refraction in negative index material. The figure is taken, with permission of the Canadian Association
of Physicists (CAP), from an article by Wartak et al. [27].
17.2.3 The refraction of a ray
Consider propagation of a ray through the boundary between left-handed and right-handed
media, in Fig. 17.5. Light crossing the interface at non-normal incidence undergoes
refraction, that is a change in its direction of propagation. The angle of refraction depends
on the absolute value of the refractive index of the medium. Here, 1 is the incident ray,
2 is the reﬂected ray, 3 is the refracted ray assuming medium ′2′ is right-handed, and 4
is the refracted ray when assuming that medium ′2′ is left-handed. In a metamaterial the
refraction of light would be on the same side of the normal as the incident beam, see
Fig. 17.5. The relation between angles is determined by Snell’s law.
17.3 How to create metamaterial?
17.3.1 Metamaterials with negative effective permittivity in the microwave regime
At optical frequencies metals are characterized by an electric permittivity that varies with
frequency according to Drude relation
ε(ω) = ε0
!
1 −
ω2
p
ω(ω + iγ )
"
(17.5)

390
Metamaterials
E
B
k
a
z
y
x
Fig. 17.6
Schematic illustration of a periodic arrangement of infinitely long thin wires along z direction used in the creation of
an effective plasma medium at microwave frequencies. The figure is taken, with permission of the Canadian
Association of Physicists (CAP), from an article by Wartak et al. [27].
Here ω2
p = Ne2
mε0 is the plasma frequency, i.e. the frequency with which the plasma consisting
of free electrons oscillates in the presence of an external electric ﬁeld. Typical values for ωp
are in the ultraviolet regime. The other symbols are: N is the electron density; e is charge of
an electron and m its mass. The parameter γ describes damping and its value, for example
for copper is γ ≈4 × 1013 rad s−1.
In the limit when γ = 0, from Eq. (17.5) it follows that ε < 0 for ω < ωp; i.e. the
medium is characterized by a negative permittivity. Considering typical values of ωp, the
resulting range of negative values of ε is in the ultraviolet regime. Unfortunately, in this
frequency range ω ≪γ , and as a result losses dominate the behaviour of ε. Thus, using
metals to achieve negative ε over this frequency range will be impractical (high losses) and
the propagation of light will be mainly evanescent.
To achieve negative ε at microwave frequencies, Pendry et al. [28] proposed to use
periodic structure consisting of long thin metallic wires of radius r arranged on a horizontal
plane (xy), see Fig. 17.6. The unit cell of this periodic structure is a square whose sides
have length equal to a.
When electric ﬁeld E = E0e−i(ωt−kz)z is incident on this structure, it forces free electrons
to move inside the wires in the direction of the incident ﬁeld. Effective electron density Neff
of such structures which participate in plasma oscillations is Neff = N πr2
a2 (with N being
the electron density inside each wire, r the radius of a wire and a distance between wires),
which is signiﬁcantly smaller compared to N, thus reducing the effective plasma frequency.
For example, for a wire with radius r = 1 µm and wire spacing a =5 mm, one ﬁnds that
Neff ≈1.3 × 10−7N; i.e. the effective electron density of the new medium is reduced by
seven orders of magnitude compared to that of the free electron gas inside an isolated wire.
Additionally, in such engineered structures the effective mass meff of the electrons is
signiﬁcantly larger compared to that of a free electron. To determine effective mass of an
electron in this wired medium, we use the classical equation of motion of a moving electron:
d(mv)/dt = e[E + v × B] →d
dt [mv + eA] = −e∇(ϕ −v · A)
(17.6)
where e is the charge of an electron and v the velocity of an electron. One also has B = ∇×A
and E = −∇ϕ −∂A/∂t. We divide the xy plane into circles of radius Rc, centred at each

391
How to create metamaterial?
wire and having area equal to that of the square unit cell; i.e. Rc = a/√π. Furthermore,
we assume that the wires are sufﬁciently apart from each other so that the magnetic ﬁeld
inside each circle arises only from the current I that ﬂows perpendicularly to the centre of
the circle, and that the ﬁeld at the circumference of each circle vanishes; i.e. H(Rc) = 0.
Magnetic ﬁeld intensity at a distance R from each wire is given by
H =
I
2πR

1 −R2
R2c

(17.7)
Magnetic ﬁeld H associated with a vector potential A according to the relation H =
μ−1
0 ∇× A gives the following expression for the vector potential A:
A = μ0I
2π

ln(Rc/R) + R2 −R2
c
2R2c

z
(17.8)
where z is a unit vector along the z-direction. It has been assumed that A(R ≥Rc) = 0. For
distances very close to the wires, i.e. for R →r << Rc, Eq. (17.8) gives
A ≈μ0I
2π ln(a/r)z
(17.9)
Since both v and A point along z, the right hand side of the second part of Eq. (17.6) will
vanish (for a given R); i.e. the so-called ‘conjugate momentum’ (mv + eA) of an electron
will be conserved along the z-direction. As a result, an electron will be moving in the above
engineered medium with an effective mass, meff = eA(r)/v. Realizing that the current I can
be simply re-expressed as I = −(πr2)(Nev), we ﬁnally obtain using Eq. (17.9) the effective
mass of a moving electron inside our effective medium meff = 0.5 × μ0Ne2r2ln(a/r).
Thus, for copper wires of radius r = 1µm, being separated by a =5 mm, we obtain: meff ≈
1.3×104 m; i.e. the effective mass of an electron in our engineered medium is increased by
more than four orders of magnitude. This, combined with the fact that the effective electron
density is reduced by approximately seven orders of magnitude, leads to an effective plasma
frequency that is in the microwave regime:
ω2
p =
Neff e2
meff ε0
= 5.1 × 1010[rad s−1]2
→νp = ωp/2π = 8.2 GHz
(17.10)
It should be noted that, based on Eq. (17.10), the calculated wavelength, λp = c/νp, which
corresponds to our medium’s effective plasma frequency, turns out to be considerably larger
compared to the periodicity of the structure (λp ≈7a), justifying the description of the
periodic structure as an effective medium. Therefore we are able to construct an engineered
medium that can exhibit a negative electric permittivity in the microwave regime with
reasonably low losses.
17.3.2 Magnetic properties: split-ring resonators
In the previous section, we examined how to construct an artiﬁcial structure possessing
negative effective permittivity ε. Here, we will show how to create negative effective
permeability μ in the microwave regime using the so-called split-ring resonators (SRR).

392
Metamaterials
Fig. 17.7
Perspective view of split-ring resonator.
x
z
y
d
r
I
a
a
l
t
dc
x
z
y
I
B
)
b
(
)a(
(c)
Fig. 17.8
Arrangement of SRR in space. Reprinted with permission from H. Chen et al., J. Appl. Phys., 100, 024915 (2006).
Copyright 2006, American Institute of Physics.
The perspective view of SRR is shown in Fig. 17.7. The structure consists of two cut
cylinders. The model used to represent SRR is illustrated in Fig. 17.8. Here we will describe
description of split-ring resonators (SRR) based on equivalent circuit model approach [18].
The structure under consideration is shown in Fig. 17.8.

393
How to create metamaterial?
I
Cg
Cg
L
L'
M
U
V
R
Fig. 17.9
Equivalent circuit of SRR.
We will establish the equivalent circuit model of this structure and show that it can
produce negative effective permittivity μ. The unit cell shown above can be modelled using
equivalent circuit model shown in Fig. 17.9.
Apply a time-varying external magnetic ﬁeld H0 in the y-direction. It will induce a
current I ﬂowing in each SRR unit. From Faraday’s law, the voltage V due to the external
ﬁeld H0 is
V = iωμ0πr2H0
(17.11)
where r is the radius of the ring. Along the y-direction, SRR loops form a column (stack)
which behaves like a solenoid. In each loop there is a current I ﬂowing. Neglect the fringing
effects, i.e. spreading of the magnetic ﬁeld lines. The magnetic ﬂux in such a column is
thus
 = πr2μ0
I
l
(17.12)
where l is the separation between loops. The inductance L appearing in the circuit model is
L = μ0π r2
l
(17.13)
The inductance L is deﬁned per ring of an inﬁnite column of rings.
Let L′ be the total inductance of the SRR units in the other column (excluding column
represented by inductance L). Coupling between L and L′ is represented by the mutual
inductance M. For very long columns in y-direction, the mutual inductance M is
M = L
I
= lim
n→∞
πr2
na2
φd
I = lim
n→∞
πr2
na2 (n −1) L
= πr2
a2 L = F · L
(17.14)
Here L is the ﬂux of the depolarization ﬁeld located in the interior of L,  = L · I is the
depolarization ﬁeld generated by one column of the rings, φd = (n −1)  = (n −1) L · I
is the ﬂux of the total depolarization ﬁeld, and F = πr2
a2 is the fractional volume of the
periodic unit cell in the xz plane occupied by the interior of the SRR.

394
Metamaterials
Applying Kirchoff’s voltage drop law for a loop in the equivalent circuit shown in
Fig. 17.9 gives
V = R · I +
I
−iωC + (−iωL) I −(−iωM) I
(17.15)
where C = 1
2Cg is the total capacitance in the loop.
From the previous equations
V = iωμ0πr2H0 = iωL I H0
(17.16)
From Eq. (17.15) one has
V =

R −
1
iωC −iωL + iωM

I
Solving for current
I =
V
R −
1
iωC −iωL + iωM =
iω L I H0
R −
1
iωC −iωL + iωF · L
(17.17)
=
L H0
R
iωL +
1
ω2LC −1 + F =
−L H0
(1 −F) −
1
ω2LC + i R
ωL
Magnetic dipole moment per unit volume of the material is
M = πr2
la2 I
with the current I inferred from the above equation to be
I = −
H0l
(1 −F) −1/(ω2LC) + iR/(ωL)
(17.18)
As a result, the (relative) effective magnetic permeability associated with this medium will
be (in the direction, x, that the incident magnetic ﬁeld is polarized)
μr =
B/μ0
B/μ0 −Md
= 1 −
F
1 −1/(ω2LC) + iR/(ωL)
(17.19)
From Eq. (17.19) we can see that μ assumes negative values in the range: 1/
√
LC <
ωp < 1/√LC(1 −F), where ωm0 = 1/
√
LC is the resonance frequency of the Lorentzian
variation of the medium’s magnetic permeability, and ωmp = 1/√LC(1 −F) is the cor-
responding plasma frequency (where Re{μ} = 0). Crucially, we note that the resonant
wavelength (λm0) of the structure depends entirely on the rings’ effective inductance (L)
and capacitance (C), and can therefore be made considerably larger than the periodicity (a)
of the structure, thereby fully justifying its description as an effective medium.
Plot of real and imaginary parts of effective magnetic permeability is shown in Fig. 17.10
and the MATLAB code is in Appendix, Listing 17A.1.
The combination of long wires and SRR in a unit cell is shown in Fig. 17.11. The effect
of both results in a negative effective permittivity and permeability over the same frequency
band.
We ﬁnish this section by showing in Fig. 17.12 schematic plots of effective permittivity
(εeff ) and permeability (μeff ).

395
Some applications of metamaterials
0
2
4
6
8
10
−20
−15
−10
−5
0
5
10
15
20
Frequency (GHz)
Effective permeability
Fig. 17.10
Real and imaginary parts of magnetic permeability.
I
E
B
z
y
x
Fig. 17.11
Elementary cell of metamaterial formed by SRR and thin wire. The figure is taken, with permission of the Canadian
Association of Physicists (CAP), from an article by Wartak etal. [27].
(a)
(b)
mp
m0
p
Re{εeff}
Re{μeff}
μeff =1
ω
ω
ω
ω
ω
Fig. 17.12
(a) Permittivity of wire medium demonstrating plasma-like frequency dependent permittivity and (b) Frequency
response of effective permeability. The figure is taken, with permission of the Canadian Association of Physicists (CAP),
from an article by Wartak etal. [27].
17.4 Some applications of metamaterials
Materials with such unusual properties allow for unusual applications. We do not attempt
to review all of them; we just concentrate on a few interesting possibilities. We start with
the possibility of creating a so-called ‘perfect lens’.

396
Metamaterials
source
focus
refocus
RH
LH
RH
Fig. 17.13
Double focussing of a source with a planar double negative (left-handed) metamaterials slab surrounded by regular
(right-handed) dielectrics.
17.4.1 Perfect lenses
Until recently, it was thought that the manipulation of light is limited by the fundamental
law of diffraction to a relatively long wavelengths (say around 0.5λ). The sub-wavelength
details are carried by evanescent harmonics which decay exponentially and are also subject
to noise. A conventional lens only collects the propagating waves. The evanescent waves
are lost due to their decay.
A planar slab consisting of NIM with sufﬁcient thickness can act as a lens, known
as Veselago lens. Such a slab lens with refractive index n = −1 placed in vacuum (see
Fig. 17.13) can resolve details of an object with subwavelength precision [11]. Detailed
mathematical analysis is discussed, for example, by Ramakrishna and Grzegorczyk [4] and
Cai and Shalaev [29].
To understand the problem, consider a slab of thickness d and refractive index of, e.g.
n = −1, surrounded by air. It will bring all rays emanating from a source to a double focus:
ﬁrst, at a point inside the NIM slab, at a distance s = l < d, where l is the distance of the
source from the slab, and second at a point outside the slab, at a distance d −l. Hence, such
a slab acts like a lens, and is able to bring the rays radiated by a source to a focus outside
the slab, without reﬂections occurring at the media interfaces because the n = −1 slab is
impedance-matched to free space.
Evanescent waves are associated with the high spatial frequencies of the electromagnetic
waves created by source. They carry ﬁne (subwavelength) features of the source. Therefore,
a NIM slab can, in principle, enable us to obtain the image of an object with ‘perfect’
resolution, containing all the subwavelength features of an object and overcoming the usual
diffraction limitations that characterize conventional lenses.
17.4.2 Stopped light in metamaterials
For decades scientists maintained that optical data cannot be stored statically and must be
processed and switched on the ﬂy. The reason for this conclusion was that stopping and
storing an optical signal by dramatically reducing the speed of light itself was thought to
be unfeasible.
At present, some of the most successful slow-light designs based on photonic-crystals
(PhCs) [30] or coupled-resonator optical waveguides (CROWs) [31], can indeed slow

397
Some applications of metamaterials
a
teff>a
A
B
C
D
Fig. 17.14
Classical G-H shift in regular dielectrics. The figure is taken, with permission of the Canadian Association of Physicists
(CAP), from an article by Wartak etal. [27].
a
0<teff<a
A
A
B
B
Fig. 17.15
G-H shift in NIM forming central layer. The figure is taken, with permission of the Canadian Association of Physicists
(CAP), from an article by Wartak etal. [27].
down light efﬁciently by a factor of only 40; otherwise, large group-velocity-dispersion
and attenuation-dispersion occur; i.e. the guided light pulses broaden and the attainable
bandwidth is severely restricted.
Recently Tsakmakidis et al. [14] proposed a new method that can allow for a true
stopping of light in NIM. The stopping of light in the proposed conﬁguration is associated
with a negative Goos-H¨anchen (G-H) phase shift, a lateral displacement of light ray when
it is totally reﬂected at the interface of two different dielectric media. Classical G-H shift
between dielectrics having positive refractive indices is illustrated in Fig. 17.14.
In a structure where the central layer is formed by NIM, the G-H shift is reversed as it is
illustrated in Fig. 17.15.
To more precisely understand the manner in which light is decelerated in this structure,
let us imagine a ray of light propagating in a zig-zag fashion along a waveguide with a
negative-index (‘left-handed’) core. The ray experiences negative Goos-H¨anchen lateral
displacements each time it strikes the interfaces of the core with the positive-index (‘right-
handed’) claddings, see Fig. 17.15. Accordingly, the cross points of the incident and reﬂected
rays will sit inside the left-handed core and the effective thickness of the guide will be
smaller than its natural thickness. It is reasonable to expect that by gradually reducing
the core physical thickness, the effective thickness of the guide will eventually vanish.
Obviously, beyond that point the ray will not be able to propagate further down, and will
effectively be trapped inside the negative index metamaterial (NIM) heterostructure, see
Fig. 17.16.
The authors of [14] proposed stopping a light pulse by varying the thickness of the
waveguide core to the point where the cycle-averaged power ﬂow in the core and the

398
Metamaterials
a
teff = 0
A=B
Fig. 17.16
G-H shift in NIM at critical thickness. The figure is taken, with permission of the Canadian Association of Physicists
(CAP), from an article by Wartak etal. [27].
cladding become comparable. At the degeneracy point, where the magnitudes of these
powers become equal, the total time-averaged power ﬂow directed along the central axis
of the core vanishes. At this point the group (or energy) velocity goes to zero and the
path of the light ray forms a double light cone (‘optical clepsydra’) where the negative
GH lateral shift experienced by the ray is equal to its positive lateral displacement as it
travels across the core. Adiabatically reducing the thickness of the NIM core layer may
thus, in principle, enable complete trapping of a range of light rays, each corresponding to
a different frequency contained within a guided wavepacket.
This ability of metamaterial-based heterostructures to dramatically decelerate or even
completely stop [32] light under realistic experimental conditions, has recently led to a series
of experimental works [33], [34] that have reported an observation of so-called ‘trapped
rainbow’ light-stopping in metamaterial waveguides.
17.4.3 Cloaking (invisibility)
Unusual light-bending properties constitute a rather generic feature of metamaterials. Part
of the excitement surrounding these materials is that they could be engineered to ‘cloak’
objects from electromagnetic radiation such as light: that is, make them seem invisible at
speciﬁc frequencies. A metamaterial ‘invisibility’ cloak can be designed such that it does not
reﬂect waves back nor scatter them in other directions. Several methods were proposed to
make extended bodies invisible, such as those based on cancellation of scattering [35] or on
coordinate transformations. The method suggested by Pendry et al. [36] (see also Leonhardt
[12]) relies on controlling the paths of electromagnetic waves. It was applied to a spherical
volume and uses coordinate transformation that expels the paths of electromagnetic waves
(rays) from a spherical volume, squeezing them into a spherical shell around the volume
that is to be cloaked, thereby making it invisible to incident radiation, see Fig. 17.17. The
light rays smoothly avoid the cloaked object and ﬂow around it like a ﬂuid. They appear
to have properties of the free space when observed externally. The rays make a detour
around the hidden part of the device. On the left side they must arrive at the same time
as if they were propagating through empty space. Since in the cloaking region they travel
longer distances, their phase velocity must exceed c. This is in principle possible [37] (for
a speciﬁc frequency).

399
Some applications of metamaterials
Fig. 17.17
The rays go around the inner object and then go to the eye. An observer at the left of the cloak would see the point
source.
To introduce the relevant transformation, one starts with a mathematical point (placing it
at the origin of a coordinate system), which is obviously invisibly small. To hide an extended
object, say a sphere of radius R1, we transform the mathematical point at the origin into a
sphere of radius R1 and the vicinity of the sphere into another sphere of radius R2 > R1.
The transformation which does this is
r′ = R1 + R2 −R1
R2
r,
θ′ = θ,
φ′ = φ
(17.20)
Maxwell’s equations are form-invariant to coordinate transformations like the one above.
Only the components of μ and ε are affected by the transformation. They become spatially
varying and anisotropic tensors. Their forms were determined by Pendry et al. [36] and for
R1 < r < R2 are
ε′
r′ = μ′
r′ =
R2
R2 −R1

r′ −R1
2
r′
ε′
θ′ = μ′
θ′ =
R2
R2 −R1
(17.21)
ε′
φ′ = μ′
φ′ =
R2
R2 −R1
Inside the sphere with radius R1 the permittivity and permeability can be arbitrary, whereas
the space between the spheres is ﬁlled with a material having the permittivity and per-
meability tensors determined by Eqs. (17.21). As a result, any object inside the sphere
with radius r < R1 is concealed. These conclusions follow from exact manipulations of
Maxwell’s equations and are not restricted to a ray approximation.
17.4.4 Optical black holes
By extending the concept behind the invisibility cloak, one can speculate on the possibility
of creating an optical analogue of a black hole. In this concept, by proper design of a
new class of metamaterials, one can expect to concentrate and trap light waves, similarly
to what can happen in a ‘black hole’, see Fig. 17.18. In such a system, light will be
permanently trapped. Such a black hole design has recently been proposed by Narimanov
and Kildishev [38]. Numerical simulations showed a highly efﬁcient light absorption. The
electromagnetic black hole was built recently [39], [40] and it operates at microwave

400
Metamaterials
Fig. 17.18
Metamaterial black hole fabricated from properly crafted gradient-index material.
frequencies. The structure is composed of 60 concentric layers, and each layer is a thin
printed circuit board etched with a numbers of subwavelength unit structures on one side and
coated with 0.018 mm thick copper on the other side. The permittivity changes radially in
the shell of the microwave black hole, and hence the unit cells are identical in each layer but
have different sizes in adjacent layers. The structure can efﬁciently absorb electromagnetic
waves coming from all directions owing to the local control of electromagnetic ﬁelds. It is
expected that such a microwave black hole could ﬁnd important applications in solar-light
harvesting, thermal emitting, and cross-talk reduction in microwave circuits and devices.
These specially designed analogues of black holes could also be used for controlling,
slowing and trapping electromagnetic waves [40], as well as for investigating some of the
more exotic physics associated with celestial mechanics.
17.5 Metamaterials with an active element
This last section is intended to brieﬂy discuss the problem of losses in metamaterials and
how to compensate for them.
As mentioned before, metamaterials show large losses which at present are orders of
magnitude too large for practical applications and are considered as an important factor
limiting practical applications of metamaterials. For example, detailed analytical studies
show that losses limit the superresolution of a theoretical superlens [41]. There was some
controversy whether loss elimination can be feasible [42], but as shown by Webb and Thylen
[43] it is possible to completely eliminate losses in metamaterials.
Very recently, several computational [44], [45], [46] and experimental [47] works have
demonstrated that optical losses can be fully overcome in realistic negative-refractive-
index metamaterials. The speciﬁc loss-free design considered in [44] and [47] consisted of
two metallic ﬁlms perforated with small rectangular holes (‘ﬁshnets’), and with an active
medium (laser dye) spacer between two ﬁlms. Additionally, several reports [48], [49],
[50] speculated about possible compensation for losses in metamaterials by introducing a
gain element. For example, Wegener et al. [49] formulated a simple model where gain is
represented by a fermionic two-level system which is coupled via a local-ﬁeld to a single
bosonic resonance representing the plasmonic resonance of the metamaterial. Also recently,

401
Appendix 17A
Fang et al. [50] described a model where the gain system is modelled by a generic four-
level atomic system. They conducted numerical analysis using the FDTD technique. Gain
material was introduced in the gap region of the split-ring resonators (SRR). The system
had a magnetic resonance frequency at 100 THz. Some other reports of the design and
analysis of active metamaterials are by Yuan et al. [51] and Sivan et al. [32].
17.6 Annotated bibliography
We ﬁnish this short review by highlighting some recently published textbooks where further
useful information about metamaterials can be found. We start with the most recent:
• T. J. Cui, D. R. Smith, R. Liu, eds., Metamaterials. Thory, Design, and Applications,
Springer, 2010.
Concentrates on the recent progress in metamaterials, in particular the optical trans-
formation theory, invisible cloaks, new type of antennas and optical metamaterials.
• W. Cai and V. Shalaev, Optical Metamaterials. Fundamentals and Applications, Springer,
2010.
Details recent advances on optical metamaterials from fundamental aspects to current
implementations.
• F. Capolino, ed., Metamaterials Handbook. Vol. 1: Theory and Phenomena of Metama-
terials, Vol. 2: Applications of Metamaterials, CRC Press, Boca Raton, 2009.
A very broad collection of topics covered by many authors.
• L. Solymar and E. Shamonina, Waves in Metamaterials, Oxford University Press, 2009.
Offers a comprehensive treatment of all aspects of research in this ﬁeld at a level
that should appeal to ﬁnal year undergraduates in physics or in electrical and electronic
engineering.
• S. A. Ramakrishna and T. M. Grzegorczyk, Physics and Applications of Negative Refrac-
tive Index Materials, SPIE and CRC Press, 2009.
Discussion of principles of negative refraction and comparison with other media that
exhibit similar properties.
Appendix 17A: MATLAB listings
In Table 17.1 we provide a list of MATLAB ﬁles (in fact, only one ﬁle) created for Chapter 17
and a short description of its function.
Table 17.1 List of MATLAB functions for Chapter 17.
Listing
Function name
Description
17A.1
ChenFig3.m
Reproduces Fig. 3 from the paper by Chen et al. [18]

402
Metamaterials
Listing 17A.1
Program ChenFig3.m.
% File name: ChenFig3.m
% Matlab code to plot Fig.3 of Chen et al
% using equivalent circuits approach
% Plot Fig3. of Chen et al, JAP,v.100, 024915 (2006)
clear all
% Fundamental constants
epsilon_zero=8.8542d-12;
% epsilon zero (F/m)
mu_zero = 4*pi*10^-7;
% mu zero (H/m)
%
% Geometrical dimensions, see Fig.1 of Chen
r = 2.0;
% internal radius = 2 mmm
a = 5.0;
% distance between elements = 5 mm
l_vert = 1.0;
% vertical separation = 1 mm
L_c = 1.0;
% Dimension of capacitor = 1 mm
t = 0.8;
% Dimension of capacitor = 0.8 mm
d_c = 0.2;
% Dimension of capacitor = 0.2 mm
eps_r = 4.0;
% permittivity of the gap
sigma = 10^-6;
% resistance per unit length
%
% Intermediate parameters
F = pi*r^2/(a^2);
% fractional volume (dimensionless)
C_g = (epsilon_zero*eps_r*L_c*t/d_c)*10^-3; % gap capacitance unit (F)
L = (mu_zero*pi*r^2/l_vert)*10^-3;
% Eg.(2) unit (H)
% pause
R = 2*pi*r*sigma;
% resistance of the ring
C = C_g/2.0;
% total capacitance in the loop
%
% Determination of frequency range
N_max = 200;
% number of points for plot
% in the interval [0,10] GHz
freq_GHz = linspace(0,10,N_max);
% creation of frequency arguments
freq_Hz = freq_GHz*10^9;
omega_Hz = 2.0*pi*freq_Hz;
%
tt = 1./(omega_Hz.^2*L*C);
ttt = R./(omega_Hz.*L);
temp = 1./tt + 1i*ttt;
%
% effective permeability without coupling M, Eq.(9) of Chen
extra = F./(1. + F - tt + 1i*ttt);
%
mu_eff = 1. - F./(1. + F - tt + 1i*ttt);
result_re = real(mu_eff);
result_im = imag(mu_eff);

403
References
%
% plot(freq_GHz,result_im);
% pause
plot(freq_GHz,result_re,freq_GHz,result_im,’.’,’LineWidth’,1.5);
axis([0 10 -20 20])
xlabel(’Frequency (GHz)’,’FontSize’,14);
ylabel(’Effective permeability’,’FontSize’,14);
set(gca,’FontSize’,14);
% size of tick marks on both axes
grid
pause
close all
References
[1] M. Lapine and S. Tretyakov. Contemporary notes on metamaterials. IET Microw.
Antennas Propag., 1:3–11, 2007.
[2] L. I. Mandelstam. Group velocity in crystal lattice. Zh. Eksp. Teor. Fiz., 15:475–8,
1945.
[3] V. G. Veselago. The electrodynamics of substances with simultaneously negative
values of ϵ and μ. Soviet Physics Uspekhi, 10:509–14, 1968.
[4] S. A. Ramakrishna and T. M. Grzegorczyk. Physics and Applications of Negative
Refractive Index Materials. SPIE Press and CRC Press, Bellingham, WA, 2009.
[5] V. A. Podolskiy, L. Alekseev, and E. E. Narimanov. J. Mod. Optics, 52:2343–9, 2005.
[6] A. Schuster. An Introduction to the Theory of Optics. Edward Arnold, London, 1904.
[7] H. Lamb. On group-velocity. Proc. London Math. Soc, 1:473–9, 1904.
[8] H. C. Pocklington. Nature, 71:607–8, 1905.
[9] C. R. Simovski and S. A. Tretyakov. Historical notes on metamaterials. In F. Capolino,
ed., Theory and Phenomena of Metamaterials, pages 1: 1–17. CRC Press and Taylor
and Francis Group, Boca Raton and London, 2009.
[10] A. Moroz, www.wave-scattering.com/negative.html, 3 July 2012.
[11] J. B. Pendry. Negative refraction makes a perfect lens. Phys. Rev. Lett., 85:3966–9,
2000.
[12] U. Leonhardt. Optical conformal mapping. Science, 312:1777–80, 2006.
[13] D. Schurig, J. J. Mock, B. J. Justice, S. A. Cummer, J. B. Pendry, A. F. Starr, and
D. R. Smith. Metamaterial electromagnetic cloak at microwave frequencies. Science,
314:977–80, 2006.
[14] K. L. Tsakmakidis, A. D. Boardman, and O. Hess. ‘Trapped rainbow’ storage of light
in metamaterials. Nature, 450:397–401, 2007.
[15] S. O’Brien, D. McPeake, S. A. Ramakrishna, and J. B. Pendry. Near-infrared photonic
band gaps and nonlinear effects in negative magnetic metamaterials. Phys. Rev. B,
69:241101(R), 2004.
[16] V. M. Shalaev. Optical negative-index metamaterials. Nature Photonics, 1:41–8, 2007.

404
Metamaterials
[17] J. B. Pendry, A. J. Holden, D. J. Robbins, and W. J. Stewart. Magnetism from conductors
and enhanced nonlinear phenomena. IEEE Trans. Microw. Theory Tech., 47:2075–84,
1999.
[18] H. Chen, L. Ran, J. Huangfu, T. M. Grzegorczyk, and J. A. Kong. Equivalent circuit
model for left-handed metamaterials. J. Appl. Phys., 100:024915, 2006.
[19] J. B. Pendry, A. J. Holden, W. J. Stewart, and I. Youngs. Extremely low frequency
plasmons in metallic mesostructures. Phys. Rev. Lett., 76:4773–6, 1996.
[20] D. R. Smith, W. J. Padilla, D. C. Vier, S. C. Nemat-Nasser, and S. Schultz. Composite
medium with simultaneously negative permeability and permittivity. Phys. Rev. Lett.,
84:4184–7, 2000.
[21] R. A. Shelby, D. R. Smith, and S. Schultz. Experimental veriﬁcation of a negative
index of refraction. Science, 292:77–9, 2001.
[22] C. G. Parazzoli, R. B. Greegor, K. Li, B. E. C. Koltenbah, and M. Tanielian. Exper-
imental veriﬁcation and simulation of negative index of refraction using Snell’s law.
Phys. Rev. Lett., 90:107401, 2003.
[23] T. J. Yen, W. J. Padilla, N. Fang, D. C. Vier, D. R. Smith, J. B. Pendry, D. N. Basov, and
X. Zhang. Terahertz magnetic response from artiﬁcial materials. Science, 303:1494–6,
2004.
[24] N. Liu, H. Guo, L. Fu, S. Kaiser, H. Schweizer, and H. Giessen. Three-dimensional
photonic metamaterials at optical frequencies. Nature Materials, 7:31–7, 2008.
[25] J. Yao, Z. Liu, Y. Liu, Y. Wang, C. Sun, G. Bartal, A. M. Stacy, and X. Zhang. Optical
negative refraction in bulk metamaterials of nanowires. Science, 321:930, 2008.
[26] J. Valentine, S. Zhang, T. Zentgraf, E. Ulin-Avila, D. A. Genov, G. Bartal, and
X. Zhang. Three-dimensional optical metamaterial with a negative refractive index.
Nature, 455:376–80, 2008.
[27] M. S. Wartak, K. L. Tsakmakidis, and O. Hess. Introduction to metamaterials. Physics
in Canada, 67:30–4, 2011.
[28] J. B. Pendry, A. J. Holden, D. J. Robbins, and W. J. Stewart. Low frequency plasmons
in thin-wire structures. J. Phys. Condens. Matter, 10:4785–809, 1998.
[29] W. Cai and V. Shalaev, eds. Optical Metamaterials. Fundamentals and Applications.
Springer, New York, 2010.
[30] B. Corcoran, C. Monat, C. Grillet, D. J. Moss, T. P. Eggleton, B. J. White, L. O.
O’Faolain, and T. F. Krauss. Green light emission in silicon through slow-light en-
hanced third-harmonic generation in photonic crystal waveguides. Nature Photonics,
3:206–10, 2009.
[31] F. Xia, L. Sekaric, and Y. Vlasov. Ultracompact optical buffers on a silicon chip.
Nature Photonics, 1:65–71, 2006.
[32] Y. Sivan, S. Xiao, U. K. Chettiar, A. V. Kildishev, and V. M. Shalaev. Frequency-
domain simulations of a negative-index material with embedded gain. Opt. Express,
26:24060–74, 2009.
[33] X. P. Zhao, W. Luo, J. X. Huang, Q. H. Fu, K. Song, C. Cheng, and C. R. Luo.
Trapped rainbow effect in visible light left-handed heterostructures. Appl. Phys. Lett.,
95:071111, 2009.

405
References
[34] V. N. Smolyaninova, I. I. Smolyaninov, A. V. Kildishev, and V. M. Shalayev. Experi-
mental observation of the trapped rainbow. Appl. Phys. Lett., 96:211121, 2010.
[35] A. Alu and N. Engheta. Plasmonic materials in transparency and cloaking problems:
mechanism, robustness, and physical insights. Opt. Express, 15:3318–32, 2007.
[36] J. B. Pendry, D. Schuring, and D. R. Smith. Controlling electromagnetic ﬁelds. Science,
312:1780, 2006.
[37] P. W. Milonni. Fast Light, Slow Light and Left-Handed Light. Institute of Physics
Publishing, Bristol and Philadelphia, 2005.
[38] E. E. Narimanov and A. V. Kildishev. Optical black hole: Broadband omnidirectional
light absorber. Appl. Phys. Lett., 95:041106, 2009.
[39] Q. Cheng and T. J. Cui. An Electromagnetic Black Hole Made of Metamaterials, 2009.
arXiv:0910.2159v1.
[40] Q. Bai, J. Chen, N.-H. Shen, C. Cheng, and H.-T. Wang. Controllable optical black
hole in left-handed materials. Opt. Express, 18:2106–15, 2010.
[41] C. Hafner, C. Xudong, and R. Vahldieck. Resolution of negative-index slabs. J. Opt.
Soc. Am. A, 23:1768–78, 2006.
[42] M. I. Stockman. Criterion for negative refraction with low optical losses from a
fundamental principle of causality. Phys. Rev. Lett., 98:177404, 2007.
[43] K. J. Webb and L. Thylen. Perfect-lens-material condition from adjacent absorptive
and gain resonances. Optics Letters, 33:747–9, 2008.
[44] S. Wuestner, A. Pusch, K. L. Tsakmakidis, J. M. Hamm, and O. Hess. Overcom-
ing losses with gain in a negative refractive index metamaterial. Phys. Rev. Lett.,
105:127401, 2010.
[45] K. L. Tsakmakidis, M. S. Wartak, J. J. H. Cook, J. M. Hamm, and O. Hess. Negative-
permeability electromagnetically induced transparent and magnetically-active meta-
materials. Phys. Rev. B, 81:195128, 2010.
[46] A. Fang, Th. Koschny, and C. M. Soukoulis. Self-consistent calculations of loss-
compensated ﬁshnet metamaterial. Phys. Rev. B, 82:121102, 2010.
[47] S. Xiao, V. P. Drachev, A. V. Kildishev, X. Ni, U. K. Chettiar, H. K. Yuan, and V. M.
Shalaev. Loss-free and active optical negative-index metamaterials. Nature, 466:735–
40, 2010.
[48] A. Bratkovsky, E. Ponizovskaya, S.-Y. Wang, P. Holmstrom, L. Thylen, Y. Fu, and
H. Agren. A metal-wire/quantum-dot composite metamaterial with negative ε and
compensated optical loss. Appl. Phys. Lett., 93:193106, 2008.
[49] M. Wegener, J. L. Garcia-Pomar, C. M. Soukoulis, N. Meinzer, M. Ruther, and
S. Linden. Toy model for plasmonic metamaterial resonances coupled to two-level
system gain. Optics Express, 16:19785–98, 2008.
[50] A. Fang, Th. Koschny, M. Wegener, and C. M. Soukoulis. Self-consistent calculation
of metamaterials with gain. Phys. Rev. B, 79:241104(R), 2009.
[51] Y. Yuan, B.-Iopa Popa, and S. A. Cummer. Zero loss magnetic metamaterials using
powered active unit cells. Optics Express, 17:16135–43, 2009.

A
Appendix A Basic MATLAB
In this Appendix we discuss basic elements of MATLAB, including code design and
speciﬁc examples of programming in MATLAB. Some introductory books are: MATLAB
Programming for Engineers by Chapman [1], MATLAB. An Introduction with Applications
by Gilat [2] and Mastering MATLAB 5. A Comprehensive Tutorial and Reference by
Hanselman and Littleﬁeld [3] – a reference book with a broad range of examples.
MATLAB can operate in two modes:
1. from the command window (interactive mode), where one introduces commands at
MATLAB prompt
2. from the m-ﬁle (script). All commands are written in a ﬁle (with *.m extension). Such
ﬁles are activated (run) by typing their names (without an extension) at MATLAB
prompt. Each *.m ﬁle can call several other *.m ﬁles.
We would always advocate using m-ﬁles. They can be reused, combined with other
programs, etc. In short, all code can be used in both ways.
The Appendix is divided into several sections, each dealing with different aspects of
MATLAB. In the code provided, we put many comments describing its workings. We
suggest that in each case the reader runs the code and analyses its outputs.
In Table A.1 we provide a list of MATLAB ﬁles created for this Appendix A and a short
description of each function.
Before we start a more detailed description of MATLAB and its rules, we will introduce
and run sessions dealing with fundamental MATLAB issues.
Table A.1 List of MATLAB functions for Chapter A.
Listing
Function name
Description
A.1
intro session.m
Preliminary use of MATLAB
A.2
memory.m
Compares execution times for various memory handling
A.3
loops.m
Compares execution times for various loops
A.4
basic 2D plot.m
Basic 2D MATLAB plot
A.5
sub plots.m
Introduces subplots
A.6
pview.m
3D plot
A.7
f ile write.m
Writes to a ﬁle
A.8
f ile read.m
Reads from ﬁle
A.9
deriv.m
Numerical differentiation using MATLAB function di f f ()
406

407
Working session with m-files
A.1 Working session with m-files
Here, we will illustrate preliminary use of MATLAB using the m-ﬁle. The full code named
introsession.m is shown below. We suggest run this code and observe the results. Try also
to modify it and analyse the outputs. We put many comments inside the code to explain its
operation.
% File name: intro_session.m
%----------------------- Initialization --------------------------
clear all
’its me’
% outputs text on screen
pause
d=6;
% assigns value 6 to variable d
C=[1 2 3; 3 2 1; 4 5 6];% defines matrix C
C
who
% lists defined matrices
pause
whos
% lists the matrices and their sizes
pause
%------------------ Colon operator -------------------------------
x =C( : , 3)
% selects third column of C matrix
pause
format long
% shows variables on a screen in a long format
% format short
t = 0:0.1:2;
t
% lists value of t
pause
t’
% transpose operator, creates vertical vector
pause
%------------- Special values and special matrices -----------------
pi
% shows the value of pi
1i
Inf
clock
% year, month, day, hour, minute, seconds
pause
date
% date in string format
eps
% the smallest number on my computer
pause
A = zeros(4)
% creates 4x4 matrix consisting of zeros
B = zeros(4,3)
% creates 3x4 matrix consisting of zeros
pause
A1 = ones(3)
% creates 3x3 matrix consisting of ones
B1 = ones(4,3)
% creates 3x4 matrix consisting of ones

408
Basic MATLAB
G = ones(1,5)
% creates vector, length 5 consisting of ones
pause
D = eye(3)
% creates identity matrix
z=input(’input
z’);
z
% shows inputed number
pause
%------------- Prints a short table of cos values ----------------
clc
% clears screen
n = 21; x = linspace(0,1,n); y = cos(2*pi*x);
disp(’ ’)
disp(’k
x(k)
cos(x(k))’)
disp(’------------------------’)
for k=1:n
degrees = (k-1)*360/(n-1);
fprintf(’ %2.0f
%5.0f %8.3f \n’,k,degrees,y(k));
end
disp( ’ ’);
disp(’x(k) is given in degrees.’)
pause
%------------- Output Options ------------------------------------
a = 1.23456789;
format short
a
% display a in short format
pause
format long
a
% display a in long format
disp(a)
% another display of a in long format
fprintf(’Its me,\n %4.24f ’, a)
pause
%--------------------- Data files ----------------------------
save data_1 x y;
% as *.mat file
pause
load data_1;
z=x’
save data_5.dat z /ascii;
pause
%------------- Scalar and array operations -----------------------
clear all
2+5
A=[1 2 3; 3 2 1; 4 5 6]; B=[2 3 4; 4 5 6; 5 6 7];
%
C1=A+B
% addition of two matrices
C2=A*B
% matrix multiplication

409
Basic rules
C3=A.*B
% element by element multiplication
C4=A./B
% element by element division
C5=A.^B
% element by element exponentiation
pause
A.2 Basic rules
Several of the special symbols used in MATLAB are listed in Table A.2. All variables
in MATLAB are treated as matrices. Each operation is therefore considered as a matrix
operation and as such has been optimized for vector and matrix operations. For the best
use, one should vectorize algorithms and loops and also reserve in advance memory for all
objects (matrices). We summarize basic rules and illustrate them with preliminary examples.
• vectorization of loops. This means replacement of for and while loops by proper vector
or matrix notation.
Suppose that we need to generate 101 values of sin function in the interval from 0 to 1.
It can be done in two ways:
1. using f or loop (no vectorization)
t0 = clock; for n = 0:0.001:1
x = sin(n)
end
time_no_vect = etime(clock,t0)
Run time on my computer is time no vect = 0.2300.
2. applying vectorization as shown below
t0 = clock;
n = 0:0.001:1;
Table A.2 Some of the special symbols used in MATLAB.
Symbol
Description
=
assigning value
[]
construction of an array
+
array addition
−
array subtraction
.∗
array multiplication
∗
matrix multiplication
./
array right division
′
transpose operator
%
beginning of a comment

410
Basic MATLAB
x = sin(n);
time_vect = etime(clock,t0);
Now, run time on the same machine is time vect = 0.0810. In order to determine
time difference between start and end points, we used MATLAB function etime, which
accurately computes time differences over many orders of magnitude.
• reserve memory.
• use colon (:) notation
• limit using f or in loops
• use m-ﬁles with functions instead of scripts
• provide extensive comments
• create descriptive names for variables
• use dot (.) notation
Some of the above rules will be discussed now in more detail.
A.3 Some rules about good programming in MATLAB
Here we summarize several general rules of programming including those speciﬁc to
MATLAB (but not solely).
1. Always comment your program, so another person (even yourself after several months)
can understand it.
• use meaningful variable names,
• use units consistently in your formulas or (better) work with dimensionless (or scaled)
variables.
2. All calculations in MATLAB can be either performed in the Command Window or m-
ﬁles can be created containing the same source code as typed in the Command Window.
m-ﬁles play the role of functions or subroutines.
3. A semicolon at the end of all MATLAB statements suppresses printing the assigned
values on the screen, in the Command Window. This speeds up program execution.
A.3.1 Preallocate memory
Always preallocate memory for the generated matrix. It increases execution speed because
MATLAB does not need to increase matrix size after determining each element. Run
and experiment with program memory res.m shown below. A signiﬁcant difference in the
execution time can be observed.
% File name: memoryMSW.m
% comparison of execution time with and without memory reservation
clear all
% regular loop without memory allocation

411
Some rules about good programming in MATLAB
% we use functions tic and toc to measure elapsed time
N = 10000;
tic;
% start timer
n = 0;
for x = 1:N
n = n + 1;
y(n) = cos(2*pi*x);
end
toc
% measure elapsed time since last call to tic
%
% the same loop with preallocated memory
tic
n = 0;
y
=zeros(1,N);
for x = 1:N
n = n + 1;
y(n) = cos(2*pi*x);
end
toc
A.3.2 Vectorize loops
MATLAB has been designed for vectorial operations. They execute much faster than regular
loops. The comparison of both methods is illustrated in the program loops.m shown below.
We use MATLAB functions tic and toc to measure elapsed time.
% File name: loops.m
% comparison of execution time for regular loop and vector loop
clear all
% regular loop is executed first
% we use functions tic and toc to measure elapsed time
tic;
% start timer
n = 0;
for x = 1:0.1:1000
n = n + 1;
y(n) = cos(2*pi*x);
end
toc
% measure elapsed time since last call to tic
%
% the same loop is vectorized below
tic
x = 0:0.1:1000;
y = cos(2*pi*x);
toc

412
Basic MATLAB
A.4 Basic graphics
Very good quality graphics is one of the reasons for MATLAB’s popularity. Here we
summarize the basic rules.
A.4.1 Basic 2D plot
A basic plot is produced in two steps:
1. Creating two arrays of equal lengths, one containing values of independent variable x
and the other containing dependent variable y = f (x).
Creation of an array of values of independent variable can be done in several ways. Below
we created arrays of points ranging from 0 to 2π using different methods.
x1 = 0:pi/100:2*pi;
% 100 evenly spaced points
x2 = [0:0.25:2*pi];
% predefined spacing of 0.25
x3 = linspace(0,2*pi,100); % 100 evenly spaced points
2. Inputting created arrays x and y into the MATLAB plot function.
The steps are illustrated in the MATLAB program below.
clear all
% clears all variables in memory
x = 0:pi/100:2*pi;
% creates array containing independent variable
y = cos(2*x);
% creates array containing function values
plot(x,y)
% creates generic plot, without description
pause
% pause, to view the plot
close all
% closes all figures
A.4.2 Two-dimensional plots
The main function used here is plot. It can be called up with different number of arguments
plot(y) plot(x,y plot(x,y,’line_type’)
Here, we illustrate several ways to use it.
Listing: Basic 2D plot.
Here we show creation of the simplest two-dimensional plot by plotting function y = 3x,
adding basic description and grid. The graph generated by basic 2D plot.m ﬁle is shown
in Fig. A.1.
MATLAB code is shown below. It explains creation of a basic two-dimensional graph.
% File name: basic_2D_plot.m
% Basic plotting of MATLAB are explained.
clear all
% Generate data for plot
n = 100;
% number of plotting points
x = linspace(0,10,n);
% generates points on x-axis

413
Basic graphics
0
2
4
6
8
10
0
5
10
15
20
25
30
Plot of function 3*x
x value
y value
Fig. A.1
Basic two-dimensional plot.
y = 3*x;
% function to be plotted
% Creation of basic plot and adding description
h = plot(x,y);
% basic plot
pause
% stop to analyse plot
title(’Plot of function 3*x’,’FontSize’,14)
% adding title
xlabel(’x value’,’FontSize’,14);% adding text on x-axis and size of x label
ylabel(’y value’,’FontSize’,14);% adding text on y-axis and size of y label
%
pause(2)
% stop for 2 seconds
grid
% adding grid
set(h,’LineWidth’,1.5);
% new thickness of plotting lines
set(gca,’FontSize’,14);
% new size of tick marks on both axes
%
pause
% final stop
close all
% closing all windows
Listing: Creating subplots.
Function subplot (2,2,1) divides the Figure window into 2 vertical and 2 horizontal
windows and places the current plot into window 1 (top, left). In the remaining code other
types of plots are created and placed in the remaining subwindows.
The results of sub plots.m are shown in Fig. A.2. MATLAB code is shown below. It
explains the creation of subplots.
% File name: sub_plots.m
% Creation of subplots with different properties.
clear all
% Generate data for plot

414
Basic MATLAB
0
5
10
0
100
200
300
10−1
100
101
0
100
200
300
0
5
10
10−5
100
105
10−1
100
101
10−5
100
105
Fig. A.2
Creation of subplots with different properties.
n = 100;
% number of plotting points
x = linspace(0,10,n);
% generates points on x-axis
y = 3*x.^2;
% function to be plotted
subplot(2,2,1)
% division of Figure window
h1 = plot(x,y);
% basic plot shown in top-left window
set(gca,’FontSize’,10);
% size of tick marks on both axes
pause
% stop to contemplate effects
% The above function is now plotted on different log scales
% and plots are placed in the remaining sub-windows
subplot(2,2,2)
h2 = semilogx(x,y);
% log scale on x-axis
set(gca,’FontSize’,14);
% size of tick marks on both axes
subplot(2,2,3)
h3 = semilogy(x,y);
% log scale on y-axis
set(gca,’FontSize’,15); subplot(2,2,4)
h4 = loglog(x,y);
% log scale on both axes
set(gca,’FontSize’,16);
% size of tick marks on both axes
%
% Below we set new thicknesses of plotting lines
set(h1,’LineWidth’,1.5); set(h2,’LineWidth’,2);
set(h3,’LineWidth’,2.5); set(h4,’LineWidth’,3.5);
pause
close all
Types of lines (both colours and symbols) are summarized in Table A.3. Colours are
automatically selected by MATLAB.

415
Basic graphics
Table A.3 Colours and symbols used to create lines.
Symbol
Colour
Symbol
Type of line
y
yellow
.
point
m
magenta
o
circle
c
cyan
x
shown symbol
r
red
+
shown symbol
g
green
*
shown symbol
b
blue
-
continuous
w
white
:
shown symbol
k
black
-.
dash-dotted line
0
5
10
0
0.2
0.4
0.6
0.8
1
−1
0
1
x
y
z
Fig. A.3
A 3D plot.
A.4.3 Some 3D plots
We show how to put several 2D plots on one graph and make it look like a 3D plot. The
code is shown below and the generated graph is as Fig. A.3.
% File name: pview.m
% Allows multiple 2D plots to be stacked next to one another
% along one dimension; also provides 3D view of all plots
clear all
x = linspace(0,3*pi).’;
% x-axis data
Z = [sin(x) sin(2*x) sin(3*x) sin(4*x)];
% Code below gives each curve different value on y-axis
Y = [zeros(size(x)) ones(size(x))/3 (2/3)*ones(size(x)) ones(size(x))];
plot3(x,Y,Z,’LineWidth’,1.5)
grid on
xlabel(’x’,’FontSize’,14)

416
Basic MATLAB
ylabel(’y’,’FontSize’,14)
zlabel(’z’,’FontSize’,14)
set(gca,’FontSize’,14);
% size of tick marks on both axes
view(-40,60)
pause
close all
A.5 Basic input-output
A.5.1 Writing to a text file
To save the results of some calculations to a ﬁle in text format requires the following steps:
a) Open a new ﬁle, or overwrite an old ﬁle, keeping a ‘handle’ for the ﬁle.
b) Print the values of expressions to the ﬁle, using the ﬁle handle.
c) Close the ﬁle, using the ﬁle handle.
The ﬁle handle is just a variable which identiﬁes the open ﬁle in your program. This
allows you to have any number of ﬁles open at any one time.
% File name: file_write.m
% open file
fid = fopen(’myfile.txt’,’wt’);
% ’wt’ means "write text"
if (fid < 0)
error(’could not open file "myfile.txt"’);
end;
for i=1:10
% write to file
fprintf(fid,’Number = %3d Square = %6d\n’,i,i*i);
end;
fclose(fid);
% close the file
A.5.2 Reading from a text file
To read some results from a text ﬁle is straightforward if you just want to load the whole
ﬁle into the memory. This requires the following steps:
a) Open an existing ﬁle, keeping a ‘handle’ for the ﬁle.
b) Read expressions from the ﬁle into a single array, using the ﬁle handle.
c) Close the ﬁle, using the ﬁle handle.
The fscanf() function is the inverse of fprintf(). However, it returns the values it reads as
values in a matrix. You can control the ‘shape’ of the output matrix with a third argument.
% File name: file_read.m
% open file

417
Numerical differentiation
fid = fopen(’myfile.txt’,’rt’); % ’rt’ means "read text"
if (fid < 0)
error(’could not open file "myfile.txt"’);
end;
% read from file into table with 2 rows and 1 column per line
out = fscanf(fid,’Number = %d Square = %d\n’,[2,inf]);
fclose(fid);
% close the file
xx = out’;
% convert to 2 columns and 1 row per line.
xx
% output results to screen
A.6 Numerical differentiation
We will illustrate numerical differentiation using MATLAB function diff(x). It computes
the difference between elements in an array.
Given a vector x = {...xk−1, xk, xk+1...} containing points xk, one can derive approxima-
tions to the ﬁrst derivative f ′(x) = dy
dx of the function y = f (x). Three basic possibilities
are [4]
Backward difference,
f ′(xk) ≈f (xk) −f (xk−1)
xk −xk−1
(A.1)
Forward difference,
f ′(xk) ≈f (xk+1) −f (xk)
xk+1 −xk
(A.2)
Central difference,
f ′(xk) ≈f (xk+1) −f (xk−1)
xk+1 −xk−1
(A.3)
To compute ﬁrst derivative we use MATLAB function diff(x), which determines the
difference between adjacent values of the vector x. The derivative is then determined as
dy = diff(y)./diff(x);
The returned array of differences contains one less element than the original array. One
should observe that trimming the last value of x produces a forward difference and trimming
the ﬁrst value gives a backward difference.
To obtain the second derivative, we apply the above algorithm a second time. Using
backward difference, one has
f ′′(xk) ≈f ′(xk) −f ′(xk−1)
xk −xk−1
(A.4)
% File name: deriv.m
% Program evaluates first and second derivatives and plots results
clear all
font_size = 18;
N_max = 190;
x = linspace(0,2,N_max);

418
Basic MATLAB
y1 = sin(pi.*x);
h1 = plot(x,y1);
% plot of original function
xlabel(’x’,’FontSize’,font_size);
ylabel(’Original function’,’FontSize’,font_size);
grid on
pause
%
temp1 = y1;
dy1 = diff(temp1)./diff(x);
xnew1 = x(1:length(x)-1);
h2 = plot(xnew1,dy1);
% plots first derivative
xlabel(’x’,’FontSize’,font_size);
ylabel(’First derivative’,’FontSize’,font_size);
grid on
pause
%
temp2 = dy1;
dy2 = diff(temp2)./diff(xnew1);
xnew2 = xnew1(1:length(xnew1)-1);
h3 = plot(xnew2,dy2);
% plots second derivative
xlabel(’x’,’FontSize’,font_size);
ylabel(’Second derivative’,’FontSize’,font_size);
grid on
pause
close all
A.7 Review questions
1. How are variables represented in MATLAB?
2. What is the role of the semicolon (;) operator in MATLAB?
3. What does MATLAB function linspace(0, 1, 10)?
4. What is the role of dot (.) operator in MATLAB?
5. What does MATLAB function subplot(3, 2, 1)?
6. Perform a polar plot.
7. Estimate π using the random method.
References
[1] S. J. Chapman. MATLAB Programming for Engineers. Brooks/Cole, Paciﬁc Grove,
CA, 2000.

419
References
[2] A. Gilat. MATLAB. An Introduction with Applications. John Wiley & Sons, Hoboken,
NJ, 2008.
[3] D. Hanselman and B. Littleﬁeld. Mastering MATLAB 5. A Comprehensive Tutorial and
Reference. Prentice Hall, Upper Saddle River, NJ, 1998.
[4] S. E. Koonin. Computational Physics. The Benjamin/Cummings, Menlo Park,
CA, 1986.

B
Appendix B Summary of basic numerical methods
In a book like this, the development of computer programs for various tasks and also
execution of simulations for different processes and devices, plays an essential role. The
fundamentals of many computer programs are supported by numerical methods. Therefore,
in this Appendix we summarize main elements of numerical analysis with an emphasis on
methods related to the development of programs used in this book, and also to understanding
of operation of those programs.
There are many excellent textbooks devoted to numerical analysis. We found the books
by Koonin [1], DeVries [2], Garcia [3], Gerald and Wheatley [4], Rao [5], Heath [6] and
Recktenwald [7] of signiﬁcant pedagogical value. The books by Press et al. [8] stand on
their own as an excellent source of practical computer codes ready to use.
We concentrate on description and implementation of some practical numerical methods
and not on the problems which those methods are typically used for. We start our discussion
with a summary of methods of solving nonlinear equations.
There are many textbooks aimed to the introduction of numerical methods and their ap-
plications. Some of the most popular are: Applied Numerical Analysis Using MATLAB by
Fausett [9], Numerical Methods for Physics by Garcia [3], Introduction to Scientiﬁc Com-
puting by van Loan [10], Advanced Engineering Mathematics with MATLAB by Harman
et al. [11], A Friendly Introduction to Numerical Analysis by Bradie [12].
They contain extensive code written in MATLAB (sometimes also in other languages)
which should help with understanding and could be easily adopted to a particular problem.
Our aim here is to summarize some of the numerical methods and techniques which are
directly relevant to the problems discussed in the main text.
In Table B.1 we provide a list of MATLAB ﬁles created for this Appendix B and a short
description of each function.
B.1 One-variable Newton’s method
The very efﬁcient and popular method, also known as Newton-Raphson method, is used to
ﬁnd roots. Here we establish its principles by showing how to ﬁnd root x∗for an arbitrary
function of single variable f (x) such that
f (x∗) = 0
(B.1)
420

421
One-variable Newton’s method
Table B.1 List of MATLAB functions for Appendix B.
Listing
Function name
Description
B.1
muller.m
Function implements Muller’s method
B.2
dmuller.m
Driver to test Muller’s method
B.3
f muller.m
Test functions for Muller’s method
B.4
ode single.m
Driver for RK method (single eq.)
B.5
f unc ode.m
Function called by ode single.m
B.6
f unc ode sys.m
Function called by ode sys.m
B.7
ode sys.m
Driver for RK method (system of eqs.)
B.8
square wave.m
Implements Fourier series for square wave
B.9
FT example 1.m
Preliminary Fourier transform
B.10
FT example 2.m
Testing Fourier transform in MATLAB
x
f(x)
x1
x2
x*
Fig. B.1
Graphical illustration of Newton’s method.
The Newton method is based on a linear approximation of the function by employing a
tangent to this function at a particular point. In Fig. B.1 we provide graphical illustration
of Newton’s method.
One starts from an initial guess point, say x1, which should be not too far from root x∗.
Evaluating tangent at point x1 and its intersection with the x axis creates new point x2 and
the process is repeated. The relevant mathematical formulas are obtained by writing the
Taylor expansion of f (x) around initial guess x1:
f (x∗) = f (x1 −δx) = f (x1) −df (x1)
dx
δx + O(δx2)
(B.2)
In the previous, f (x∗) = 0. Solving for δx, one ﬁnds
δx = f (x1)
f ′(x1)
From Fig. B.1 one observes that point x2 can be obtained as
x2 = x1 −δx = x1 −f (x1)
f ′(x1)
(B.3)
The procedure can be generalized and for arbitrary step n, one has
xn+1 = xn −f (xn)
f ′(xn),
n = 1, 2, . . .
(B.4)

422
Summary of basic numerical methods
B.2 Muller’s method
Muller’s method is an efﬁcient technique of ﬁnding both real and complex roots of a
scalar-valued function f (x) of a single variable x where there is no information about
its derivatives. It uses quadratic interpolation involving three points [13]. The method is
described in several textbooks, including Atkinson [14] and Fausett [9].
In order to illustrate how the method works, let us start with three initial guesses x0, x1, x2.
By applying Muller’s method, a new improved approximate point x3 is determined. In this
method one uses quadratic function y(x) which is used in ﬁtting original function f (x).
Function y(x) is of the form
y(x) = a (x −x2)2 + b (x −x2) + c
(B.5)
It contains three constants a, b, c which can be determined by evaluating Eq. (B.5) at points
x0, x1, x2. One obtains
for x = x2
f (x2) = c
for x = x1
f (x1) = a (x1 −x2)2 + b (x1 −x2) + c
or
f (x1) −f (x2) = a (x1 −x2)2 + b (x1 −x2)
for x = x0
f (x0) = a (x0 −x2)2 + b (x0 −x2) + c
or
f (x0) −f (x2) = a (x0 −x2)2 + b (x0 −x2)
Introduce notation u0 = x0 −x2 and u1 = x1 −x2, which allows us to write the above
equations as
f (x0) −f (x2) = a u2
0 + b u0
(B.6)
f (x1) −f (x2) = a u2
1 + b u1
(B.7)
The system of Eqs. (B.6) and (B.7) can be solved by any standard method and one obtains
a = u1

f (x0) −f (x2)

−u0

f (x1) −f (x2)

(x0 −x2) (x1 −x2) (x0 −x1)
b = u2
0

f (x1) −f (x2)

−u2
1

f (x0) −f (x2)

(x0 −x2) (x1 −x2) (x0 −x1)
With the above information at hand and using Eq. (B.5), one can determine roots of
y(x) = 0
in order to generate a new approximation of the root of f (x). One obtains
x −x2 = −b ±
√
b2 −4ac
2a
(B.8)
Out of the above two roots we choose the one which is closest to x2. To avoid round-off errors
due to subtraction of nearly equal numbers, one multiplies numerator and denominator of

423
Muller’s method
(B.8) by −b ∓
√
b2 −4ac and obtains (we call new solution x by x3)
x3 −x2 =
(
−b ±
√
b2 −4ac
) (
−b ∓
√
b2 −4ac
)
2a
(
−b ∓
√
b2 −4ac
)
= −
2c
−b ±
√
b2 −4ac
(B.9)
Once x3 is determined, the ‘oldest’ point x0 is ignored by setting x0 = x1, x1 = x2, x2 = x3
and the process is repeated. MATLAB implementation of Muller’s method using the above
algorithm is shown below.
% File name: muller.m
function out = muller(f, x0, x1, x2 , epsilon, max)
% Finds zeroes using Muller’s method, good for complex roots.
% Variable description:
% out
- result of search
% x1,x2,x3 - previous guesses
% epsilon
- tolerance
% max
- max number of iterations
%
y0 = f(x0);
y1 = f(x1);
y2 = f(x2);
iter = 0;
while (iter <= max)
iter = iter + 1;
a =( (x1 - x2)*(y0 - y2) - (x0 - x2)*(y1 - y2)) / ...
( (x0 - x2)*(x1 - x2)*(x0 - x1) );
%
b = ( ( x0 - x2 )^2 *( y1 - y2 ) - ( x1 - x2 )^2 *( y0 - y2 )) / ...
( (x0 - x2)*(x1 - x2)*(x0 - x1) );
%
c = y2;
%
if (a ~= 0)
disc = b*b - 4*a*c;
q1 = b + sqrt(disc);
q2 = b - sqrt(disc);
if (abs(q1) < abs(q2))
dx = - 2*c/q2;
else
dx = - 2*c/q1;
end
elseif (b ~= 0)
dx = - c/b;
end

424
Summary of basic numerical methods
x3 = x2 + dx;
x0 = x1;
x1 = x2;
x2 = x3;
%
y0 = y1;
y1 = y2;
y2 = f(x2);
%
if (abs(dx) < epsilon)
out = x2; break;
end
end
Driver for the Muller method is shown below:
% File name: dmuller.m
% Driver to test Muller’s method
clear all
format short
max = 100;
epsilon = 1e-6;
% starting points
x1 = 0.5;
x2 = 1.5;
x3 = 1.0;
% call to Muller’s method
out = muller(@fmuller, x1, x2, x3 , epsilon, max)
Test functions for the Muller method are shown below. One can make appropriate choices.
% File name: fmuller.m
function out = fmuller(x)
% Test functions for Muller’s method
out = x.^6 - 2;
%out = x.^10 - 0.5;
%out = x - x.^3/3;
%out = x.^3 - 5*x.^2 + 4*x;
B.2.1 Tests of Muller’s method
Using the above functions, we tested Muller’s algorithm on two functions:
1. calculations of
6√
2, after Fausett [9]. We deﬁne function f (x) = x6 −2, and assume
starting values to be: x0 = 0.5, x1 = 1.5, x2 = 1.0. Obtained solution is x = 1.1225.

425
Numerical differentiation
2. ﬁnding root of f (x) = ex + 1 = 0. The analytical method gives x = iπ. Assuming
starting values x0 = 1, x1 = 0, x2 = −1, one obtains from Muller’s method x =
−0.0000 + 3.1416i.
B.3 Numerical differentiation
Very often scientiﬁc and engineering problems are formulated in terms of differential
equations. To solve them numerically, we need to establish schemes to replace derivatives
by ﬁnite differences.
A typical scientiﬁc or engineering problem is described by the second-order differential
equation. Examples include Newton’s second law m
..x = F, or Laplace’s equation V ′′(x) =
0. General second-order differential equation is written as
d2y(x)
dx2
+ a(x)dy(x)
dx
= b(x)
with a(x) and b(x) known functions. The above can be rewritten as two ﬁrst-order equations:
dy(x)
dx
= z(x)
dz(x)
dx
= b(x) −a(x)z(x)
where z(x) is a new variable. The process can be generalized for a differential equation
of arbitrary order, say n −th order, and when applied, results in n ﬁrst-order differential
equations, as
dyi(x)
dx
= fi(x, y1, y2, . . . yn),
i = 1, 2, . . . n
where the functions fi on the right-hand side are known.
In order to have a well-deﬁned mathematical problem, the above set of equations must
be supplemented by boundary (or initial) conditions. Boundary conditions are algebraic
conditions on the value of the functions yi to be satisﬁed at discrete speciﬁed points, but
not between those points.
The (ﬁrst) derivative of a function f (x) is deﬁned as
df (x)
dx

x0
= f ′(x0) = lim
x→x0
f (x) −f (x0)
x −x0
For a ﬁnite (and nonzero) value of x = x−x0, the above derivative can be approximated
as
f ′(x0) ≈f (x) −f (x0)
x
In Table B.2 we summarize common ﬁnite-difference formulas.

426
Summary of basic numerical methods
Table B.2 Summary of common finite-difference formulas.
Type of approximation
Formula
Truncation error
Forward differences
f ′
i = fi+1 −fi
h
O(h)
f ′′
i = fi+2 −2 fi+1 + fi
h2
Backward differences
f ′
i = fi −fi−1
h
O(h)
f ′′
i = fi −2 fi−1 + fi−2
h2
Central differences
f ′
i = fi+1 −fi−1
2h
O(h2)
f ′′
i = fi+1 −2 fi + fi−1
h2
x
xi
xi+1
xi-1
xi+2
xi-2
fi
fi+1
fi-1
fi+2
fi-2
f(x)
Fig. B.2
Illustration used in determining derivatives.
B.3.1 Numerical differentiation using Taylor’s series expansion
We want to determine a derivative of function f (x) at point xi and also its second derivative.
Using notation from Fig. B.2, we write Taylor expansions
fi+1 = fi + h f ′
i + 1
2h2 f ′′
i + 1
6h3 f ′′′
i
+ O(h4)
(B.10)
fi−1 = fi −h f ′
i + 1
2h2 f ′′
i −1
6h3 f ′′′
i
+ O(h4)
(B.11)
where the following notation has been used:
fn = f (xn),
xn = n · h,
n = 0, ±1, ±2, . . .
All numerical schemes deﬁning the ﬁrst derivative are derived from the above equations.
From Eq. (B.10) we obtain the forward formula
f ′
i = fi+1 −fi
h
+ O(h)
From Eq. (B.11) we obtain the backward formula
f ′
i = fi −fi−1
h
+ O(h)

427
Numerical differentiation
x
xi
xi+1
xi-1
fi
fi+1
fi-1
f(x)
h
h
Fig. B.3
Illustration of interpolation process.
Subtracting both, we obtain the central formula
f ′
i = fi+1 −fi−1
2h
Taylor expansion for next points (i ± 2) gives
fi+2 = fi + 2h f ′
i + 1
2(2h)2 f ′′
i + 1
6(2h)3 f ′′′
i
+ O(h4)
(B.12)
and
fi−2 = fi −2h f ′
i + 1
2(2h)2 f ′′
i −1
6(2h)3 f ′′′
i
+ O(h4)
(B.13)
Multiplying Eq. (B.10) by 2 and adding to Eq. (B.12), we obtain
fi+2 −2 fi+1 = fi + 2h f ′
i + 2h2 f ′′
i −2 fi −2h f ′
i −h2 f ′′
i + O(h3)
= −fi + h2 f ′′
i + O(h3)
or
f ′′
i = fi+2 −2 fi+1 + fi
h2
Other schemes can be obtained in a similar way.
B.3.2 Numerical differentiation using interpolating polynomials
To illustrate a basic concept, consider a second-order polynomial f (x) passing through
three data points, Fig. B.3:
(xi, fi) , (xi+1, fi+1) , (xi+2, fi+2)
The analytical form of that polynomial is
f (x) = a0 + a1x + a2x2
(B.14)

428
Summary of basic numerical methods
Function f (x) has to pass through all three points deﬁned previously. This requirement
creates three equations:
fi = a0 + a1xi + a2x2
i
fi+1 = a0 + a1(xi + h) + a2(xi + h)2
fi+2 = a0 + a1(xi + 2h) + a2(xi + 2h)2
The above equations will now be solved to ﬁnd coefﬁcients a0, a1, a2. The scheme must
be independent of the choice of point xi, so we can choose xi = 0, which signiﬁcantly
simpliﬁes algebra. One obtains
fi = a0
fi+1 = a0 + a1h + a2h2
fi+2 = a0 + 2a1h + 4a2h2
The solutions are
a0 = fi
a1 = −fi+2 + 4 fi+1 −3 fi
2h
(B.15)
a2 = fi+2 −2 fi+1 + fi
2h2
Differentiate Eq. (B.14) and use Eqs. (B.15) to obtain
f ′
i = f ′(xi = 0) = a1 = −fi+2 + 4 fi+1 −3 fi
2h
f ′′
i
= f ′′(xi = 0) = 2a2 = fi+2 −2 fi+1 + fi
h2
The above are forward-difference approximations of the order O(h2).
Given a vector x = {. . . xk−1, xk, xk+1 . . .} containing points xk, one can derive approxi-
mations to the ﬁrst derivative f ′(x) = dy
dx of the function y = f (x). Three basic possibilities
are [1]:
Backward difference,
f ′(xk) ≈f (xk) −f (xk−1)
xk −xk−1
(B.16)
Forward difference,
f ′(xk) ≈f (xk+1) −f (xk)
xk+1 −xk
(B.17)
Central difference,
f ′(xk) ≈f (xk+1) −f (xk−1)
xk+1 −xk−1
(B.18)
To compute ﬁrst derivative we use MATLAB function diff(x), which determines the
difference between adjacent values of the vector x. The returned array of differences
contains one less element than the original array. One should observe that trimming the
last value of x produces a forward difference and trimming the ﬁrst value gives a backward
difference.

429
Numerical differentiation
To obtain the second derivative, we apply the above algorithm a second time. Using the
backward difference, one has
f ′′(xk) ≈f ′(xk) −f ′(xk−1)
xk −xk−1
(B.19)
B.3.3 Crank-Nicolson method
We illustrate the method on the diffusion equation, which we write in the form
∂u
∂t = ∂2u
∂x2
(B.20)
The Crank-Nicolson (CN) method is the ﬁnite-difference discretization of the above equa-
tion. It was invented to overcome stability limitations and to improve the rate of convergence
of the solution of diffusion equation. It has O (t)2 convergence rate compared to O (t)
of the implicit and explicit methods.
The CN method is essentially an average of the implicit and explicit methods. It is
created as follows. Applying a forward difference approximation to the time derivative in
the diffusion equation gives the explicit scheme
un+1
i
−un
i
t
+ O (t) = un
i+1 −2un
i + un
i−1
(x)2
+ O (x)2
(B.21)
When using backward difference to the same equation, one creates the implicit scheme
un+1
i
−un
i
t
+ O (t) = un+1
i+1 −2un+1
i
+ un+1
i−1
(x)2
+ O (x)2
(B.22)
The algebraic average of the two schemes gives
un+1
i
−un
i
t
+ O (t) = 1
2
	
un
i+1 −2un
i + un
i−1
(x)2
+ un+1
i+1 −2un+1
i
+ un+1
i−1
(x)2

+ O (x)2
(B.23)
From the above equation one ﬁnally obtains the Crank-Nicolson scheme
un+1
i
−1
2α

un+1
i+1 −2un+1
i
+ un+1
i−1

= un
i + 1
2α

un
i+1 −2un
i + un
i−1

(B.24)
where α =
t
(x)2 . One can show (see Problems) that the scheme is accurate to O (t)2
rather than O (t). Note that in CN scheme un+1
i+1 , un+1
i
, un+1
i−1 are determined implicitly in
terms of un
i+1, un
i , un
i−1.
B.3.4 Simple methods of numerical differentiation
Euler method
The simplest method is the Euler method, which is
yn+1 = yn + h f (xn, yn)

430
Summary of basic numerical methods
which advances a solution from xn to xn+1 = xn + h. It is not a practical method, because it
is not very accurate and also not very stable (see discussion below).
Let us illustrate several methods which originate from the Euler method. We will use
deﬁnition of an acceleration in one-dimensional motion as an illustration. It is
d2x(t)
dt2
= a(x, v)
In general, acceleration can depend on position and velocity. First, write the above equation
as a system of two ﬁrst-order differential equations:
dv
dt = a(x, v)
(B.25)
dx
dt = v
Introduce τ as a time step. The right-derivative formula for a general function g(t) is
dg(t)
dt
= g(t + τ ) −g(t)
τ
+ O(τ )
Application of that formula to a system (B.25) gives
v(t + τ ) −v(t)
τ
+ O(τ ) = a(x(t), v(t))
x(t + τ ) −x(t)
τ
+ O(τ ) = v(t)
We have explicitly indicated the dependence of all quantities involved on the speciﬁc time.
From the above
v(t + τ ) = v(t) + τ · a(x(t), v(t)) + O(τ 2)
x(t + τ ) = x(t) + τ · v(t) + O(τ 2)
For the future use, let us introduce the following notation:
gn ≡g((n −1)τ ),
n = 1, 2, 3, . . .
(B.26)
and
g1 ≡g(t = 0)
In the above, n refers to time steps. In our notation, the Euler method for the acceleration
problem reads
vn+1 = vn + τ · an
xn+1 = xn + τ · vn
The algorithm based on Euler method goes as follows:
1. specify initial conditions (i.e. values corresponding to t = 0) x1 and v1
2. choose time step τ
3. calculate acceleration for current values of xn and vn

431
Numerical differentiation
4. use Euler method to compute new x and v
5. loop through step 3, until all time steps are done.
An implementation of the Euler method is left as a problem.
Euler-Cromer (E-C) and mid-point methods
Both of these methods are simple modiﬁcations of the Euler method just discussed. E-C
method consists in replacing vn by vn+1, the value of velocity at the next time step (it must
be calculated ﬁrst, so the calculations must be done in a proper sequence). Explicitly, the
E-C method is
vn+1 = vn + τ · an
xn+1 = xn + τ · vn+1
Another possible modiﬁcation (and in a similar spirit) results in a mid-point method:
vn+1 = vn + τ · an
xn+1 = xn + τ · 1
2(vn + vn+1)
where the last term represents algebraic average of velocities at present and the next time
steps.
Leap-frog method
The development of this method starts with Eqs. (B.25). Use the central derivative approach
to write (note that central time value is different for both equations)
v(t + τ ) −v(t −τ )
2τ
+ O(τ 2) = a(x(t))
x(t + 2τ ) −x(t)
2τ
+ O(τ 2) = v(t + τ )
Applying notation (B.26), the above system reads
vn+1 −vn−1
2τ
= a(xn)
xn+2 −xn
2τ
= vn+1
or
vn+1 = vn−1 + 2τ · a(xn)
xn+2 = xn + 2τ · vn+1
In order that this scheme works, we need to know values at proper initial points. Note
that position and velocity are evaluated at different points, as
position is evaluated at points:
x1, x3, x5, . . .
velocity is evaluated at points:
v2, v4, v6, . . .

432
Summary of basic numerical methods
Verlet method
To develop the Verlet method, instead of using Eqs. (B.25), we will write them as [3]
dx
dt = v
d2x
dt2 = a
Use central difference formulas for ﬁrst and second derivatives and obtain
xn+1 −xn−1
2τ
+ O(τ 2) = vn
xn+1 + xn−1 −2xn
τ 2
+ O(τ 2) = an
From above, we obtain formulas which deﬁne Verlet method:
vn =
1
2τ (xn+1 −xn−1)
xn+1 = 2xn −xn−1 + τ 2an
B.4 Runge-Kutta (RK) methods
B.4.1 Second-order Runge-Kutta
Our goal is to solve linear system of linear differential equations
d−→x (t)
dt
= −→f (−→x (t),t)
with vector −→x expressed as −→x
= [x1x2 . . . xn]. In order to establish second-order RK
method, let us start with the simple Euler approximation to the ﬁrst derivative (which is
also Taylor expansion to ﬁrst order):
−→x (t + τ ) = −→x (t) + τ · −→f (−→x (ξ), ξ)
where τ is some arbitrary time step and t < ξ < t + τ. We have freedom to choose ξ
to have the most convenient value for us. The second-order RK method originates when
ξ = t + τ/2 and also
−→x (t + τ ) = −→x (t) + τ · −→f (−→x ∗(t + τ/2),t + τ/2)
where
−→x ∗(t + τ/2) = −→x (t) + 1/2 · τ · −→f (−→x (t),t)

433
Solving differential equations
B.4.2 Fourth-order Runge-Kutta
This is one of the best schemes available and is commonly used in practice. It is deﬁned as
−→x (t + τ ) = −→x (t) + 1/6 · τ · (−→
F 1 + 2−→
F 2 + 2−→
F 3 + −→
F 4)
where
−→
F 1 = −→f (−→x ,t)
−→
F 2 = −→f (−→x + τ/2 · −→
F 1,t + τ/2)
−→
F 3 = −→f (−→x + τ/2 · −→
F 2,t + τ/2)
−→
F 4 = −→f (−→x + τ · −→
F 3,t + τ )
MATLAB has some built-in routines implementing RK methods.
B.5 Solving differential equations
Here we provide some practical methods of solving ordinary differential equations (ODE),
both single and systems, using MATLAB function ode45.m.
B.5.1 Single differential equation
To start with, consider an equation with an initial condition
dx(t)
dt
= x(t)
2
t −1

,
x(0) = 0.009
(B.27)
We want to solve it and plot the solution in the interval [0.1, 10]. MATLAB code is divided
into two m-ﬁles: one (the driver) contains all needed parameters and calls the appropriate
m-function which deﬁnes the function.
% File name: ode_single.m
% Illustrates application of R-K method to a single diff. equation
% Results are compared with an exact solution
%
clear all
tspan = [0.1 10];
% time interval
x0 = 0.009;
% initial value
%
[t,x] = ode45(’func_ode_single’,tspan,x0);
t_ex = linspace(0.1, 10, 100);
x_ex = t_ex.^2.*exp(-t_ex);
% Exact solution
plot(t,x,t_ex,x_ex,’.’,’LineWidth’,1.5)

434
Summary of basic numerical methods
0
2
4
6
8
10
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
t
x
Fig. B.4
Comparison of the solution of a single ordinary differential equation using numerical and analytical methods.
xlabel(’t’,’FontSize’,14)
ylabel(’x’,’FontSize’,14)
set(gca,’FontSize’,14);
% size of tick marks on both axes
pause
close all
The function itself is
function xdot = func_ode_single(t,x)
% Function called by ode_single.m
xdot = x*(2/t -1);
The result of solving the above problem is plotted in Fig. B.4 along with an exact solution,
which is x(t) = t2e−t.
B.5.2 System of differential equations
To illustrate application of ode45.m function in solving systems of differential equations,
consider the Lorenz model [3] deﬁned by the following system:
dx1(t)
dt
= σ (x2 −x1)
dx2(t)
dt
= rx1 −x2 −x1x3
(B.28)
dx3(t)
dt
= x1x2 −bx3
where σ, r, b are positive constants. This system was originally developed to describe
buoyant convection in a ﬂuid. It shows chaotic behaviour. The following initial conditions
are assumed: x1(t) = 1, x2(t) = 1, x3(t) = 10.04. The analysis is conducted in the time
interval [0, 10]. That system of equations is coded as

435
Numerical integration
function xdot = func_ode_sys(t,x)
% Function called by ode_sys.m
%
sigma = 10; b = 7/3; r = 25;
% parameters
%
xdot(1) = sigma*(x(2) - x(1));
xdot(2) = r*x(1) - x(2) - x(1)*x(3);
xdot(3) = x(1)*x(2) - b*x(3);
xdot = xdot’;
The MATLAB code of the driver of the above system is
% File name: ode_sys.m
% Illustrates application of R-K method to system of diff. equations
%
clear all
tspan = [0 10];
% time interval
x0 = [1, 1, 10.04];
% initial value
%
[t,x] = ode45(’func_ode_sys’,tspan,x0);
plot(t,x(:,1), t,x(:,2), t,x(:,3),’LineWidth’,1.5)
xlabel(’time’,’FontSize’,14)
set(gca,’FontSize’,14);
% size of tick marks on both axes
pause
close all
The results of two runs using the above functions are shown in Fig. B.5.
B.6 Numerical integration
The problem is to calculate a numerically deﬁnite integral
I =
 b
a
f (x)dx
The interval [a, b] can be split into equidistant subintervals with total number N = b−a
h ,
with h separation between neighbours. The above integral is thus replaced by
I =
 b
a
f (x)dx =
 xi
a
f (x)dx +
 x2
xi
f (x)dx + · · · =

i
Ai
where Ai is the area of an elementary element. In the following, we therefore only consider
an integral within a single subinterval:
Ai =
 xi
xi−1
f (x)dx
(B.29)
Different schemes will originate depending on how we evaluate the above integral.

436
Summary of basic numerical methods
0
2
4
6
8
10
−20
−10
0
10
20
30
40
time
0
2
4
6
8
10
−20
−10
0
10
20
30
40
time
Fig. B.5
Solution of a system of ordinary differential equations showing chaos for two different values of initial conditions;
[1,1,10.04] (top) and [1,1,10.02] (bottom).
B.6.1 Euler’s rule
Subarea is deﬁned within an interval xi−1 < xi < xi+1. The integral (B.29) thus takes the
form
Ai =
 xi
xi−1
f (x)dx ≈h · fi
with fi = f (xi) taken at the right end of subinterval. The value of the function can also be
taken at the left point, or in fact at any point within the subinterval xi−1 < xi < xi+1. Total
area is thus
I ≈

i
Ai
= h · ( f1 + f2 + · · · fn)

437
Numerical integration
B.6.2 Trapezoidal rule
In this method the integral is approximated by a series of trapezoids. The area of each
subinterval is evaluated as
Ai =
 xi
xi−1
f (x)dx ≈1
2 ( fi−1 + fi) · (xi −xi−1)
with h = xi −xi−1. Taking h as a constant, the integral is
I =
 b
a
f (x)dx ≈

i
1
2 ( fi−1 + fi) · h
= 1
2h {( f0 + f1) + ( f1 + f2) + ( f2 + f3) + · · · + ( fn−2 + fn−1) + ( fn−1 + fn)}
= 1
2h { f0 + 2 f1 + 2 f2 + · · · 2 fn−1 + fn}
In a condensed form, the integral is
I = h
n−1

i=1
fi + 1
2h ( f0 + fn)
B.6.3 Simpson’s rule
Simpson’s method gives more accurate results than trapezoidal rule. Trapezoidal rule con-
nects consecutive points by a straight line; Simpson’s rule connects three points. Normally,
a second-order polynomial (a parabola) is used to do so. Consider one:
p(x) = c2x2 + c1x + c0
Without loss of generality, we can take xi = 0. Then, xi−1 = −h and xi+1 = h. Evaluating
the above polynomial gives
p(−h) = c2h2 −c1h + c0 = fi−1
p(0) = c0 = fi
p(h) = c2h2 + c1h + c0 = fi+1
Solving the above system gives
c0 = fi
c1 =
1
2h ( fi+1 −fi−1)
c2 =
1
2h2 ( fi+1 + fi−1 −2 fi)

438
Summary of basic numerical methods
Evaluating elementary integral for an area Ai gives
Ai =
 h
−h
p(x)dx
=
 h
−h
 1
2h2 ( fi+1 + fi−1 −2 fi) x2 + 1
2h ( fi+1 −fi−1) x + fi

dx
= 1
3h ( fi−1 + 4 fi + fi+1)
The complete integral is
I =
 b
a
f (x)dx =

i
Ai
= 1
3h { f0 + 4 f1 + 2 f2 + 4 f3 + · · · + 2 fn−2 + 4 fn−1 + fn}
B.7 Symbolic integration in MATLAB
MATLAB allows us to perform symbolic manipulations. It uses Maple, a powerful com-
puter algebra system, to manipulate and solve symbolic expressions. To use symbolic
mathematics, we must use the syms operator to tell MATLAB that we are using a symbolic
variable, and that it does not have a speciﬁc value.
In this book we only use symbolic manipulations to evaluate indeﬁnite integral. We
illustrate symbolic concepts of MATLAB with the example below.
Example
Evaluate integral of the function f (x) = x2.
The shortest method is to type on a prompt: >> int(x2). The answer is ans = x3/3.
Alternatively, we can deﬁne x symbolically ﬁrst, and then remove the single quotes in
the int statement.
>> syms x
>> int(x^2)
ans =
x^3/3
B.8 Fourier series
According to Fourier, any function can be expressed in the form known as the Fourier
series:
f (t) = 1
2a0 +
∞

n=1
an cos nt +
∞

n=1
bn sin nt
(B.30)

439
Fourier series
Fourier series representation is useful in describing functions over a limited region, say
[0, T], or on the inﬁnite interval (−∞, +∞) if the function is periodic. We assume that
the Fourier series converges for any problem of interest, see Arfken [15]. Cosine and sine
functions form a complete set and are orthonormal on any 2π interval. Therefore they may
be used to describe any function. The orthogonality relations are
 2π
0
sin mt sin nt dt =
	
πδm,n,
m ̸= 0
0,
m = 0
(B.31)
 2π
0
cos mt cos nt dt =
	
πδm,n,
m ̸= 0
2π,
m = n = 0
(B.32)
 2π
0
sin mt cos nt dt = 0,
all integral m and n
(B.33)
One also has the relation
1
2π
 2π
0

eimt∗eint dt = δm,n
(B.34)
Using the above orthogonality relations, the coefﬁcients of expansion in Eq. (B.30) are
an = 1
π
 2π
0
f (t) cos nt dt
(B.35)
and
bn = 1
π
 2π
0
f (t) sin nt dt
(B.36)
Also, the exponential form of the Fourier series is often used where the function is expanded
as
f (t) =
n=+∞

n=−∞
cn eint
(B.37)
Comparison of the above relations gives formulas for coefﬁcients cn as
c0 = 1
2a0
n = 0
cn = 1
2 (an −ibn)
n > 0
c−n = 1
2

a|n| + ib|n|

n < 0
(B.38)
B.8.1 Change of interval
In the above formulation, the discussion has been restricted to an interval [0, 2π]. If the
function f (t) is periodic with the period 2T, we may write
f (x) = 1
2a0 +
∞

n=1
an cos nt +
∞

n=1
bn sin nt
(B.39)
where
an = 1
T
 T
−T
f (t′) cos nπt′
T
dt′,
n = 0, 1, 2, 3, . . .
(B.40)

440
Summary of basic numerical methods
1
-1
T
2T
t
f(t)
Fig. B.6
Square wave.
and
bn = 1
T
 T
−T
f (t′) sin nπt′
T
dt′,
n = 1, 2, 3, . . .
(B.41)
Expressions (B.30) and (B.39) are related by obvious change of variables, namely t = πt′
T .
The choice of the symmetric interval [−T, T] is not essential; in fact, for periodic function
with a period 2T it is possible to choose any interval [t0,t0 + 2T].
B.8.2 Example
Use the Fourier series to approximate a square wave function f (t) as shown in Fig. B.6.
Using Heaviside step function H(t), the function f (t) can be written as
f (t) = 2

H
 t
T

−H
 t
T −1

−1
where
H(t) =
	
0
t < 0
1
t > 0
Determine coefﬁcients an and bn in the Fourier series expansion. Write a MATLAB program
which plots the above approximation for various number of terms in the series.
From Fig. B.6 one observes that f (t) = f (2T −t); i.e. function f (t) is odd. Therefore
coefﬁcients an vanish. Coefﬁcients bn are evaluated as follows:
bn = 1
T
 2T
0
f (t) sin
nπt
T

dt = 1
T
 T
0
sin
nπt
T

dt −1
T
 2T
T
sin
nπt
T

dt =
=
1
nπ
 nπ
0
sin xdx −1
nπ
 2nπ
nπ
sin xdx
=
	 4
nπ
n odd
0
n even
The Fourier series is
f (t) = 4
π
∞

n=1,3,5,...
1
n sin
nπt
T

The MATLAB program which evaluates the above is shown overleaf. The result is shown
in Fig. B.7.

441
Fourier transform
−0.2
0
0.2
0.4
0.6
0.8
1
−1
−0.5
0
0.5
1
f(t)
t
Fig. B.7
Fourier series approximation to the square wave. Line with oscillations corresponds to N = 20 terms; the other one
was obtained using 100 terms.
% File name: square_wave.m
clear all
L = 0.5;
t = [0:100]/100;
% arguments of independent variable
hold on
for N = [20 100];
f = zeros(1,101);
% function initialization
for n = 1:2:N
pref = 4/(pi*n);
% evaluate prefactor
f = f + pref*sin(n*pi*t/L);
% summation of function
end
plot(t,f,’LineWidth’,1.5)
end
axis([-0.2 1.2 -1.2 1.2])
ylabel(’f(t)’,’FontSize’,14)
xlabel(’t’,’FontSize’,14)
set(gca,’FontSize’,14);
% size of tick marks on both axes
pause
close all
B.9 Fourier transform
Based on the results from previous section, we now introduce Fourier transform (FT).
Consider function f (t) to be nonperiodic on the inﬁnite interval. FT is introduced by
considering ﬁrst a Fourier series representation (B.30) of the function which is periodic on
the interval [0, T], where T is the period. First, make substitution
t →π
T t

442
Summary of basic numerical methods
in Eq. (B.37) and obtain
f (t) =
n=+∞

n=−∞
cn ein πt
T ,
cn = 1
T

f (t) e−in πt
T dt
(B.42)
Next, introduce discrete angular frequencies
ωn = nπ
T
The difference between two successive frequencies ω is evaluated as
ω = ωn+1 −ωn = (n + 1) π
T −nπ
T = π
T
Using the above deﬁnition, the original series given by Eq. (B.42) can be written as
f (t) =
n=+∞

n=−∞
cn eintω,
cn = 1
T
 +T
−T
f (t) e−intωdt
(B.43)
Introducing new function g by the relation
cn = ω
√
2π
g (n · ω)
(B.44)
one obtains
g (nω) =
1
√
2π
 +T
−T
f (t) e−intωdt
(B.45)
and
f (t) =
1
√
2π
n=+∞

n=−∞
ωg (nω) eintω
(B.46)
Taking the limit T →∞, summation becomes an integral and nω becomes continuous
variable ω. One ﬁnds
g(ω) =
1
√
2π
 +∞
−∞
f (t) e−iωtdt
(B.47)
and
f (t) =
1
√
2π
 +∞
−∞
g(ω) eiωtdt
(B.48)
The above relations are known as the Fourier transform and inverse Fourier transform.
There is a freedom in choosing prefactor in Eq. (B.44). By making different choices, one
can introduce different Fourier transforms.

443
FFT in MATLAB
B.10 FFT in MATLAB
Fast Fourier transform (FFT) in MATLAB is deﬁned as
X (k) =
N

n=1
x(n)e−j2π(k−1)(n−1)/N,
1 ≤k ≤N
(B.49)
which corresponds to the analytical deﬁnition (B.47) but without
1
√
2π factor. FFT in MAT-
LAB is performed by the function fft.m.
The inverse FFT (IFFT) which is performed by MATLAB function ifft.m is deﬁned in
MATLAB as
x(n) = 1
N
N

k=1
X (k)ej2π(k−1)(n−1)/N,
1 ≤k ≤N
(B.50)
and it corresponds to the analytical deﬁnition (B.48). Again, the
1
√
2π factor is absent. Let
us illustrate a simple application of FT in MATLAB.
Example 1 As the simplest illustration of fft.m and ifft.m functions, we provide below
MATLAB code to conduct FT and its inverse for a Gaussian pulse. In the end, one recovers
original Gaussian pulse.
% File name: FT_example_1.m
% Doing preliminary Fourier transform in Matlab
clear all
N = 320;
T_0 = 10;
T_domain = 200;
Delta_t = T_domain/N;
T = Delta_t*(-N/2:1:(N/2)-1);
A_in = exp(-(T/T_0).^2);
% input gaussian pulse
plot(A_in)
% plot of input gaussian pulse
pause
A_freq = fft(A_in);
plot(A_freq)
% not a correct pulse
pause
% (I explain it in the next example)
orig = ifft(A_freq);
plot(orig)
% plots original input gaussian pulse
pause
close all
Example 2 As the previous example shows, Fourier transform in MATLAB must be done
carefully. In this example we illustrate the workings of FFT in MATLAB. MATLAB code

444
Summary of basic numerical methods
0
20
40
60
80
100
0
0.2
0.4
0.6
0.8
1
Number of points
y(x)
y = exp(−x2)
−20
−10
0
10
20
−0.8
−0.6
−0.4
−0.2
0
0.2
0.4
0.6
0.8
F = fft(y)
Fig. B.8
Original Gaussian pulse (left) and and its FT (right).
is shown in the following. First, a Gaussian pulse is created and plotted against a number
of points along the x-axis. When needed, one can also plot it against x values. At the top of
each ﬁgure (as a title) we provide an expression for the plotted function.
As the second ﬁgure, we plotted normalized Fourier transform using MATLAB function
f f t(). The plot does not resemble the expected result because the Fourier transform
produces a complex function of the frequency. Vector F contains complex numbers and
when you plot it in MATLAB, it plots the real part against the imaginary part.
To correct for the above deﬁciency, in the third ﬁgure we plotted the above transform
plus the MATLAB abs() function. Altogether, both functions produce the desired result,
i.e. magnitude of the Fourier transform of the Gaussian pulse.
In the remaining two ﬁgures we performed the inverse Fourier transform of the created
Fourier transform.
Observe the use of function fftshift.m which puts the negative frequencies before the
positive frequencies. The reason for using it is that when MATLAB function fft.m computes
FFT, it outputs the positive frequency components ﬁrst and then outputs the negative
frequency components.
Below we show full MATLAB code for this exercise and all the ﬁgures created starting
with an initial Gaussian pulse. In Figs. B.8–B.10, we show Gaussian pulse in time and its
Fourier transform. It was obtained with the following MATLAB program.
% File name: FT_example_2.m
% Testing Fourier transform in Matlab
clear all;
x=-4:0.1:4;
% Interval of independent variable
y=exp(-x.^2);
% Define Gaussian function
plot(y,’LineWidth’,1.5);
% Plot Gaussian (Fig.1)
xlabel(’Number of points’,’FontSize’,14); ylabel(’y(x)’,’FontSize’,14);
set(gca,’FontSize’,14);
% size of tick marks on both axes

445
FFT in MATLAB
0
20
40
60
80
100
0
5
10
15
20
abs(F)
0
20
40
60
80
100
0
5
10
15
20
Spatial frequency
|F|
FT of a Gaussian: fftshift(abs(F)))
Fig. B.9
The next steps in the application of Fourier transform to the Gaussian pulse. After application of function abs() (left),
and f f tshi f t() (right).
0
20
40
60
80
100
0
0.2
0.4
0.6
0.8
1
1.2
1.4
ifft(abs(F))
0
20
40
60
80
100
0
0.2
0.4
0.6
0.8
1
1.2
1.4
Inverse FT: fftshift(ifft(abs(F)))
number of points
y(x)
Fig. B.10
Steps in producing inverse Fourier transform of an original Gaussian pulse. After application of i f f t() (left), and
after application of fftshift(ifft()) (right).
title(’y=exp(-x^2)’);
pause
%
F=fft(y);
% Calculate FFT
plot(F,’LineWidth’,1.5);
% Plot of
FT (Fig.2)
title(’F=fft(y)’);
pause
%
plot(abs(F),’LineWidth’,1.5);
% Plot of abs value (Fig.3)

446
Summary of basic numerical methods
title(’abs(F)’);
% Take absolute value and plot
pause
%
plot(fftshift(abs(F)),’LineWidth’,1.5);
% Use Matlab fftshift function
xlabel( ’Spatial frequency’); ylabel(’|F|’); % (Fig.4)
title(’FT of a Gaussian: fftshift(abs(F)))’);
pause
%--------------------------------------------------------
% Take inverse Fourier transform
%--------------------------------------------------------
plot(ifft(abs(F)),’LineWidth’,1.5);
% Use Matlab function ifft (Fig.5)
title(’ifft(abs(F))’);
pause
%
plot(fftshift(ifft(abs(F))),’LineWidth’,1.5); % Use functions fftshift
title(’Inverse FT: fftshift(ifft(abs(F)))’);
% and ifft (Fig.6)
xlabel(’number of points’); ylabel(’y(x)’);
pause
close all
B.11 Problems
1.
Use Newton’s method to ﬁnd roots of the following function: ex = 1 −cos3x. Plot it
ﬁrst and use the graph to determine the starting point used by Newton’s method.
2.
Verify orthogonality relations, Eqs. (B.35) and (B.36) (where the limits of integration
are [0, 2π]) for another limit, i.e. [−π, π].
3.
Derive expressions for coefﬁcients an, bn, cn using new limits.
4.
Show that the Crank-Nicolson scheme is accurate to O(t)2.
5.
Use the 2D version of Euler method to analyse projectile motion [3].
6.
Analyse the effect of scaling within Fourier transform in MATLAB.
References
[1] S. E. Koonin. Computational Physics. The Benjamin/Cummings, Menlo Park, CA,
1986.
[2] P. L. DeVries. A First Course in Computational Physics. John Wiley & Sons, New
York, 1994.
[3] A. L. Garcia. Numerical Methods for Physics. Second Edition. Prentice Hall, Upper
Saddle River, NJ, 2000.

447
References
[4] C. F. Garald and P. O. Wheatley. Applied Numerical Analysis. Addison-Wesley,
Reading, MA, 1999.
[5] S. S. Rao. Applied Numerical Methods for Engineers and Scientists. Prentice Hall,
Upper Saddle River, NJ, 2002.
[6] M. T. Heath. Scientiﬁc Computing. An Introductory Survey. Second Edition. McGraw-
Hill, Boston, MA, 2002.
[7] G. W. Recktenwald. Numerical Methods with Matlab. Implementations and Applica-
tions. Prentice Hall, Upper Saddle River, NJ, 2000.
[8] W. H. Press, S. A. Teukolsky, W. T. Vetterling, and B. P. Flannery. Numerical Recipes
in Fortran 90. The Art of Scientiﬁc Computing. Second Edition. Cambridge University
Press, Cambridge, 1992.
[9] L. V. Fausett. Applied Numerical Analysis Using MATLAB. Prentice Hall, Upper
Saddle River, NJ, 1999.
[10] C. F. van Loan. Introduction to Scientiﬁc Computing. Second Edition. Prentice-Hall,
Upper Saddle River, NJ, 2000.
[11] T. L. Harman, J. Dabney, and N. Richert. Advanced Engineering Mathematics with
MATLAB. Brooks/Cole, Paciﬁc Grove, 2000.
[12] B. Bradie. A Friendly Introduction to Numerical Analysis. Pearson Prentice Hall,
Upper Saddle River, NJ, 2006.
[13] I. Barrodale and K. B. Wilson. A Fortran program for solving a nonlinear equation
by Muller’s method. Journal of Computational and Applied Mathematics, 4:159–66,
1978.
[14] K. E. Atkinson. An Introduction to Numerical Analysis. Second Edition. Wiley, New
York, 1989.
[15] G. Arfken. Mathematical Methods for Physicists. Academic Press, Orlando, FL, 1985.

Index
absorption
coefﬁcient, 181
in a two-level system, 168, 169
infrared, 109
of power in photodetectors, 242
spectrum, 243
ultraviolet, 109
acceptance angle, see critical angle
active region, 173, 176
in a VCSEL, 173
air mass, 369
ampliﬁer gain, 206
ampliﬁer, erbium-doped ﬁbre (EDFA),
209–13
typical characteristics, 213, 215
ampliﬁer, semiconductor (SOA)
Fabry-Perot (FPA), 223
travelling-wave (TWA), 223, 227
antireﬂection (AR) coating, 50–1, 205
half-wave layer, 53
quarter-wave layer, 53
array waveguide grating (AWG), 318
asymmetry parameter, 67
attenuation, see loss
band gap, 243
in solar cells, 376
bandwidth
3-dB, 207
of a photodetector, 247
of an NRZ signal, 144
of an optical ampliﬁer, 207
of an RZ signal, 143
of gain, 206, 224
Bessel functions
modiﬁed, 113, 114, 129, 132, 133
ordinary, 113, 129, 131, 132
bit error rate (BER), 240, 252–7, 259,
336
bit-pattern independency, 242
bit-rate transparency, 241
boundary conditions
absorbing (ABC) in 1D, 272–5
absorbing (ABC) in 2D, 277–9
for a magnetic ﬁeld, 37–8
for an electric ﬁeld, 36–7
Mur’s ﬁrst order, 272–3
Bragg mirror, 53, 54, 62
reﬂectivity spectrum, 57, 62
Brewster’s angle, 49–50
C-band, see transmission bands
carrier
generation rate, 182
leakage rate, 183
lifetime, 184
recombination rate, 183
chirping, 192–3
cloaking, 398–9
coefﬁcient of ﬁnesse, 29
coordinate transformation, 398
Courant-Friedrichs-Levy (CFL) stability
condition, 270
Crank-Nicolson scheme, 301, 302
critical angle, 18, 30, 64, 106
cross-gain modulation (XGM), 234–5
cross-phase modulation (XPM), 233,
235
current
bias, 144
dark, 246
forward diode, 372
injection, 143
leakage, 182
photocurrent, 242, 245, 371, 374
reverse saturation, 374
short-circuit, 369
threshold, 143
current density, 35
cutoff wavelength
in optical ﬁbres, 122–3, 128
in photodiodes, 245
Debye medium, 280
depletion region, 370
detection
coherent, 240
incoherent (direct), 240
diffraction, 396
dispersion
equation of the waveguide, 66
group velocity (GVD), 106, 124
in free space, 24
material, 124–8, 136, 280
448

449
Index
modal, 124
multipath, 108
numerical, 269, 270, 283
of a 1D wave, 21
of a Debye medium, 280
of a Lorentz medium, 280
of a pulse in optical ﬁbre, 127–8
waveguide, 124–127
distributed Bragg reﬂector (DBR), 173,
174
Drude relation, 389
dynamic range, 241
E-band, see transmission bands
effective index method, 89–92
effective medium, 391, 394
effective thickness of a slab waveguide, 77
EH modes, 116, 117, 119
electric
boundary conditions, 36–37
ﬁeld intensity, 35
ﬂux, 35
electron, see carrier
emission
ampliﬁed spontaneous (ASE), 215, 248,
255
spontaneous, 168, 169, 208
stimulated, 168, 169
equivalent circuit, 193
for bulk laser, 194–6
for PIN photodetector, 245, 250
for solar cell, 373–6, 380
error function, 231
Euler differentiation method, 429–31
Euler’s rule (integration method), 436
Euler-Cromer differentiation method, 431
evanescent waves, 396
excited state, 168
external modulator, 6, 193
eye diagram, 337
Fabry-Perot (FP)
interferometer, 29–30
resonance conditions, 171
resonant modes, 171, 172
resonator, 170
Faraday rotator, 323
Fast Fourier transform (FFT), 443–4
Fermi golden rule, 180
Fermi level, 176
ﬁbre Bragg grating, 318
ﬁlter function, 258
ﬁnite difference method, 425–9
backward differences, 426
central differences, 426
forward differences, 426
ﬁnite-difference (FD) approximation, 297–9
focal
length, 19, 20
plane, 19, 20
point, 19
four-wave mixing (FWM), 233, 352
Fourier series, 438–9
change of interval, 439–40
of a square wave, 440–1
Fourier transform, 441–2
of a chirped Gaussian pulse, 142
of a Gaussian pulse, 141
of a rectangular pulse, 139, 140, 158
of an electric ﬁeld, 146
Fresnel
coefﬁcients and phases for TE polarization, 44–7
coefﬁcients and phases for TM polarization,
47–8
reﬂection, 45, 47
Fresnel approximation, 290
gain
approximate formula, 206
differential, 178
in an EDFA, 213
in semiconductors, 177–81
peak, 178, 180
ripple, 227, 237
saturation, 190, 207, 216, 234
spectrum of semiconductor laser, 172
Gaussian probability density function (pdf), 255
generation of carriers
in laser didoes, 183
in PIN photodiodes, 244
in solar cells, 371
geometrical optics, 17–21
Goos-H¨anchen (G-H) shift, 58–9, 397
graded index, 20, 107
grid, see mesh
GRIN system, 20–1
group
delay, 124–5, 148
velocity, 32
guides modes
in optical ﬁbres, 114
in slab waveguides, 65–6
HE modes, 116, 117, 119
Helmholtz equation, 288, 289, 292, 299
hole, see carrier
hybrid modes, 116, 119
impedance, 41
interference
in dielectric ﬁlms, 26–7
intersymbol (ISI), 255
multiple, 27–9
invisibility cloak, see cloaking

450
Index
L-band, see transmission bands
large-signal analysis (in laser diodes), 192
laser diode
distributed feedback laser (DFB), 173, 174
in-plane laser, 172
vertical cavity surface-emitting laser (VCSEL),
172, 173
leap-frog differentiation method, 431
left-handed materials (LHM), see negative index
materials (NIM)
lens
perfect, 396
thin, 19
linear system, 338
linewidth enhancement factor (Henry factor), 228
Lorentz medium, 280
loss
extrinsic, 110
in optical ﬁbres, 108, 129
intrinsic, 109–10
LP modes, 119–20
Mach-Zehnder interferometer (MZI), 235
magic time step, 270
magnetic
boundary conditions, 37–8
ﬁeld intensity, 35
ﬂux, 35
Maxwell’s equations, 262
differential form, 35
in cylindrical coordinates, 111–12
integral form, 36
source-free, 69, 388
mesh
1D generation algorithm, 102
staggered grid, 266
Yee grid in 1D, 266, 267
Yee grid in 2D, 276
mid-point differentiation method, 431
mode number
azimuthal, 116
radial, 116
modulation format
non-return-to-zero (NRZ), 143–5
return-to-zero (RZ), 143–5
modulation of semiconductor lasers, 143, 144
modulation response function, 188, 190–2
Muller’s method, 100, 422–5
negative index materials (NIM), 385, 386
Newton’s method, 420–1
noise
Gaussian, 255–7
in optical ampliﬁers, 208–9
in photodetectors, 248–9
shot, 249
thermal (Johnson), 249–50
nonlinear Schr¨odinger equation, 353–7
normalized guide index, 67, 94
Numerical aperture (NA), 65, 106–7
O-band, see transmission bands
optical black holes, 399–400
optical cavity, 168
Fabry-Perot, 170
optical communication system, 331–3
optical coupler, 319–22
optical ﬁbre
bit-rate, 108
extrinsic loss, 110
intrinsic loss, 109–10
modes, 116–17
single-mode, 122–3
optical isolator, 322–3
optical splitter, 319–20
p-n junction
double heterostructure, 176–7
homogeneous (homojunction), 175–6
multijunction, 376–7
paraxial approximation, 288–92
permeability, 35
negative, 386, 391–5
permittivity, 35
negative, 387, 389–91, 395
plasmon-like, 386
photocurrent, 245
in photodiodes, 242
in solar cells, 370, 371, 374
photodiode
avalanche (APD), 242, 248, 258
metal-semiconductor-metal (MSM),
246
PIN, 242, 244
power, 252
sensitivity, 241, 257
photon
density, 183
lifetime, 183, 184, 187
Planck’s radiation law, 169
plane wave , 40–1
plasma, 390
frequency, 390, 391
Poisson distribution, 249, 252, 253
polarization
circular, 42–3
elliptical, 42–3
linear, 42
transverse electric (TE), 44
transverse electric (TM), 47
polarization of dielectric medium, 148
population inversion, 167, 204, 208
power budget, 333–4
Poynting vector, 59–60

451
Index
propagation constant, 41, 42
in slab waveguides, 66, 95
pulse broadening, 12, 151
in optical ﬁbres, 106
pulse half-width, 142
pulse type
chirped Gaussian, 141–2, 159
Gaussian, 139–40, 159, 163, 164, 281–6
rectangular, 138–9, 157, 340–2, 344
Super-Gaussian, 140–1, 159, 162
pulse wave, see waveform
pumping, 167, 168
quantum efﬁciency, 247
quantum well, 173, 232
quasi-Fermi level, 175, 176
rate equations in EDFA, 211
rate equations in laser diodes
for an electric ﬁeld, 184–7
for carriers, 182–3
for photons, 183
parameters, 184
ray optics, 17
in metamaterials, 389
in slab waveguides, 64–9
Rayleigh scattering, 110
receiver, 331, 343
recombination of carriers, 183
reﬂection
at a plane interface, 17, 18
coefﬁcient, 17, 45, 46, 48
external, 48, 49
internal, 48
of TE polarized waves, 44–7, 61
of TM polarized waves, 48, 61
total internal, see critical angle
refractive index, 17
in GRIN structures, 20
negative, 384
numerical values for popular materials, 18
relative difference, 65
relaxation-oscillation frequency, 189
Resonant cavity, see optical cavity
rise time, 144
rise time budget, 333–6
Runge-Kutta method
fourth order, 433
second order, 432
S-band, see transmission bands
Sellmeier equation, 31, 125–6, 135
signal-to-noise ratio (SNR), 208, 248,
336
Simpson’s rule (integration method), 437–8
slowly varying envelope approximation (SVEA), 150,
296–7
small-signal analysis (in laser diodes)
with linear gain, 188–9
with non-linear gain, 189–92
Snell’s law, 18
soliton
interactions, 363
period, 362
spectral
intensity of solar energy, 368, 369
responsivity, 247
split-ring resonator (SRR), 391–4
split-step Fourier method, 357–60
steady-state analysis
in a laser diode, 187
in an EDFA, 211–12
step index, 107
Stokes relations, 24–6
susceptibility, 186
TE modes
in optical ﬁbres, 116–18
in slab waveguides, 71–2
three-level system, 210
threshold
carrier density, 178, 182
current, 143
time constant in photodetectors, 246, 247
time division multiplexing (TDM), 11
time-harmonic ﬁeld, 39–41
TM modes
in optical ﬁbres, 116–18
in slab waveguides, 71–2
train of pulses, see waveform
transatlantic telecommunications cable (TAT), 6
transfer function, 339
transfer matrix approach
for antireﬂection (AR) coatings, 51–3
for Bragg mirrors, 54–7
for slab waveguides, 79–85
transitions
in a two-level system, 169–70
in semiconductors, 174–5
transmission bands, 10
transmittance of Fabry-Perot interferometer, 29, 33
transmitter, 331, 342
transparency density, 178
transparent boundary conditions, 304–6
transverse resonance condition, 66–7
normalized form, 67–9
trapezoidal rule (integration method), 437
two-level system (TLS), 167, 169
U-band, see transmission bands
velocity
group, 23–4, 124, 126
phase, 21–3, 32
Verlet differentiation method, 432

452
Index
wave equation, 38–9
for TE modes, 72
for TM modes, 72
in cylindrical coordinates, 112
in metamaterials, 388
waveform, 145, 160
waveguide
2D, 88–92
asymmetric slab (planar), 75–9, 95
cylindrical (optical ﬁbre), 110–23
lossy, 86
symmetric slab (planar), 72–5
wavevector, see propagation constant
weakly guiding approximation (wga),
118–19
wire medium, 395
Y-junction, 14, 325, 327
Yee algorithm
lossless in 1D, 266–8, 282
lossless in 2D, 275–7, 285
lossy in 1D, 271–2

