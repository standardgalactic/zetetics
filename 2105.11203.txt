How particular is the physics of the free energy
principle?
Miguel Aguileraa, Beren Millidgeb, Alexander Tschantza,c, Christopher L.
Buckleya
aSchool of Engineering and Informatics, University of Sussex, Falmer, Brighton, BN1
9QJ, United Kingdom
bMRC Brain Network Dynamics Unit, University of Oxford, Oxford, OX1 3TH, United
Kingdom
cSackler Center for Consciousness Science, University of Sussex , Falmer,
Brighton, BN1 9QJ, United Kingdom
Abstract
The free energy principle (FEP) states that any dynamical system can be
interpreted as performing Bayesian inference upon its surrounding environ-
ment. In this work, we examine in depth the assumptions required to de-
rive the FEP in the simplest possible set of systems – weakly-coupled non-
equilibrium linear stochastic systems. Speciﬁcally, we explore (i) how general
the requirements imposed on the statistical structure of a system are and (ii)
how informative the FEP is about the behaviour of such systems. We dis-
cover that two requirements of the FEP – the Markov blanket condition
(i.e. a statistical boundary precluding direct coupling between internal and
external states) and stringent restrictions on its solenoidal ﬂows (i.e. tenden-
cies driving a system out of equilibrium) – are only valid for a very narrow
space of parameters. Suitable systems require an absence of perception-action
asymmetries that is highly unusual for living systems interacting with an en-
vironment. More importantly, we observe that a mathematically central step
in the argument, connecting the behaviour of a system to variational infer-
ence, relies on an implicit equivalence between the dynamics of the average
states of a system with the average of the dynamics of those states. This
equivalence does not hold in general even for linear systems, since it requires
an eﬀective decoupling from the system’s history of interactions. These ob-
Email address: sci@maguilera.net (Miguel Aguilera)
Preprint submitted to Physics of Life Reviews
May 23, 2022
arXiv:2105.11203v3  [q-bio.NC]  19 May 2022

servations are critical for evaluating the generality and applicability of the
FEP and indicate the existence of signiﬁcant problems of the theory in its
current form. These issues make the FEP, as it stands, not straightforwardly
applicable to the simple linear systems studied here and suggest that more
development is needed before the theory could be applied to the kind of
complex systems that describe living and cognitive processes.
Keywords:
Free energy principle, Markov blanket, Non-equilibrium
systems, Bayesian inference, Linear stochastic systems
1. Introduction
During the last decade, the ‘free energy principle’ (FEP) has become
an inﬂuential framework which aims to provide a grand theory promoting a
Bayesian interpretation of living systems [1, 2, 3]. The FEP states that any
self-organizing system (i.e. any dynamical system, and therefore any living
or cognitive entity) equipped with a Markov blanket – a statistical separa-
tion between internal and external states – can be interpreted as performing
Bayesian inference upon the surrounding environment, such that its internal
states come to encode probabilistic beliefs about the external environment
[3, 4].
The core claim of the FEP is exceptionally ambitious. It implies that
the dynamics of any pair of coupled systems, under speciﬁc conditions about
the interaction of internal and external states, can be described as one sys-
tem trying to statistically infer the states of the second system (cf an agent
and its environment). This claim licenses an interpretation of the agent as
performing a basic kind of Bayesian inference and encoding beliefs about
the surrounding environment [5, 6]. Such an equivalence could have a far-
reaching inﬂuence on the study of living systems. For example, it could en-
able approximate calculations of the dynamics of complex systems in terms
of a more tractable description of the dynamics of their suﬃcient statistics.
Furthermore, the FEP has been defended based on singular claims about its
explanatory power, suggesting that it reveals novel insights among funda-
mental psychological concepts such as memory, attention, value, reinforce-
ment, and salience [7] and uniﬁes diﬀerent aspects of motor behaviour and
perception, from retinal stabilization to goal-seeking [8]. In addition, it has
been proposed that the FEP provides a basis for integrating several general
brain theories, including the Bayesian brain hypothesis, neural Darwinism,
2

Hebbian cell assembly theory, and optimal control and decision theory [9].
The FEP has also inspired theories such as predictive coding [10, 11, 12,
13] and active inference [14, 15, 16], which oﬀer explanations and models of
brain function and dysfunction [17] through the lens of Bayesian inference,
and have become widely inﬂuential in theoretical neuroscience and beyond.
For instance, predictive coding has been proposed to be a biologically plau-
sible model of cortical function [11, 12, 18], and has been applied to explain
binocular rivalry [19] or attention [20]. Active inference, on the other hand,
has seen substantial use in modelling the behaviour of human or animal sub-
jects in various paradigms [14, 15], as well as understanding rational decision-
making and behavioural control [21, 22, 23, 24]. Moreover, biological theories
proposing that neurons [25], synapses [26], bacteria [27] or plants [28] could
be explicitly performing Bayesian (variational) inference by minimizing free
energy gradients have been proposed and justiﬁed using explicit appeals to
the FEP. While such theories do not entirely depend upon the validity of the
mathematical core of the FEP reviewed here, they nevertheless derive a sub-
stantial amount of their intellectual and rhetorical support from it. Thus,
the fundamental validity of the mathematical framework of the FEP is of
great importance to this large and rapidly increasing modelling literature.
In a vast body of work that spans over the course of about 15 years,
the FEP has detailed the mathematical steps required to derive its central
claims. In the ﬁrst phase, an intuitive and heuristic idea of an imperative to
minimize variational free energy was developed [29, 7] based on the need for
any recognizable ‘system’ to maintain itself in a low entropy conﬁguration
over time against dissipative forces trying to push it towards a high entropy
equilibrium state. Later, this heuristic argument and intuition was more for-
mally related to concepts from stochastic thermodynamics [2, 1], speciﬁcally
by bringing in the Markov blanket condition and expressing the dynamics of
the system in terms of a gradient descent on a variational free energy corre-
sponding to a generative model of the environment of the system. Finally,
the mathematical formulation and some of its arguments have been recently
reﬁned in a new series of publications [3, 4, 30], a process that is still ongoing.
Despite the extensive literature on the FEP, there are few concrete ex-
amples that apply all the required steps to a speciﬁc, well-studied system.
Similarly, it has rarely been explored whether the assumptions (which are
sometimes left unstated) required for deriving the principle hold under the
dynamics we expect from cognitive and living systems. In light of the in-
creasing rate of publications concerning the FEP (the number of published
3

2000
2005
2010
2015
2020
year
0
500
1000
1500
publications per year
Figure 1: Growth in publications pertaining the free energy principle. Publica-
tions per year searching for ‘free energy principle’. Source: Google Scholar. The number
of papers has approximately doubled from 2013 (link) to 2017 (link) and from 2017 to
2020 (link), as indicated by the dashed lines.
papers on the topic doubles every few years, Fig. 1), we believe it is imper-
ative to ground and test the foundations of the theory in concrete models
to assess the generality and validity of its claims. To this end, we explore
a class of systems deﬁned by stochastic linear diﬀerential equations, under
a weak-coupling assumption. Such systems are the simplest possible exam-
ple that can display the dynamics required for the FEP, as well as capture
non-equilibrium properties of systems engaged in perception-action cycles (as
we expect from living systems). Moreover, the absence of nonlinear interac-
tions in this class of systems allows for precise analytic calculations, which
oﬀers an interesting test-bed to examine, in detail, the connection between
non-trivial dynamics and the statistical properties of coupled systems. In
general, due to the special independence properties imposed by the theory, if
the assumptions and steps of the FEP do not hold in such simple systems, we
consider it unlikely that they hold in more complex nonlinear systems where
the dynamics are expected to be more deeply intertwined. Moreover, we
observe that stronger couplings result in higher-order interactions that make
diﬃcult the separation between internal and external states required by the
FEP. Because of this, we expect that the introduction of non-linearities will
in general have a similar eﬀect.
4

How general is the free energy principle
We ﬁrst inspect the generality of the assumptions about the statistical
structure of a system required by the principle. A crucial step to derive the
FEP is to establish a relation between the average ﬂow of change of a system
that interacts with an environment and the gradient of a variational free en-
ergy of a model of this environment. This step relies on speciﬁc assumptions
about how perception and action mediate the interaction of the internal and
external states of a system. We aim to explore how general these assump-
tions are and whether they can be expected in the dynamical systems models
of living systems.
Perception-action interface. The FEP partitions the states of a sys-
tem into external, sensory, active and internal states.
Then, the theory
assumes that perception-action cycles involve causal dependencies such that
internal and external states are only mutually inﬂuenced through the eﬀect
of active and sensory states [2]. We will refer to this idea as a perception-
action interface (see Appendix
A). One example of this interface is a cell
membrane around a cell [2], although the formal deﬁnition of a perception-
action interface does not require the interface to be a physical boundary.
Thus, a perception-action interface could describe any set of variables me-
diating between system and environment as, for example, a combination of
retinal activity and oculomotor states mediating between neural activity in
the visual cortices and the location of an object in the environment [4].
Then, the FEP requires the system to be endowed with a particular sta-
tistical structure with two special properties: a Markov blanket (i.e. condi-
tional independence between internal and external states) and the absence
of solenoidal couplings.
Markov blanket. The FEP prescribes that variables in a perception-
action interface constitute a Markov blanket [2, 30]. A Markov blanket (see
Appendix A) is deﬁned as a set of states (the ‘blanket’) that separates two
other sets in a statistical sense (i.e. they are conditionally independent, given
the blanket). The term was initially introduced in the context of Bayesian
networks or graphs [31], and it is also known as the general Markov condition
[32]. In the FEP, Markov blankets are used for identifying a set of variables
that separate the internal and external states of a system (see [33] for a
detailed study on the speciﬁc use of the concept of Markov blanket in the
FEP). Here, we note that Markov blankets can be easily identiﬁed in models
deﬁned by directed acyclic Bayesian networks (Fig. 2.A). In these systems,
a suﬃcient condition for a Markov blanket of variable x (e.g., an internal
5

A Directed acyclic graph
B Cyclic causal model
s
a
y
x
s
a
y
x
s
a
y
x
s
a
y
x
Figure 2: Markov blankets and causal cyclic models. (A) An example of a Markov
blanket (grey nodes s, a, e.g. perception and action) for a variable x (e.g. an internal
state) in a directed acyclic graph representing a Bayesian network. (B) An example of a
cyclic causal model where the Markov blanket is not directly identiﬁable from the graph
structure. In this case, nodes that meet the local Markov condition (grey nodes) do not
guarantee the conditional independence required for a Markov blanket, as new couplings
might emerge (dashed arrows between x, y). In each case, the graph at the right represents
the equivalent correlations of the system probability distribution for ﬁxed s, a.
state) is that it contains the parent nodes of x, the children nodes of x and
the other parents of each children node (in this case, the minimum Markov
blanket is composed by the grey nodes, s, a, in Fig. 2.A). This is deﬁned as
the local Markov condition [32] (which implies the general Markov condition
in the directed acyclic graphs of Bayesian networks). However, in [2] the FEP
suggests that a Markov blanket arises naturally from the perception-action
interface depicted in Fig.
2.B (although recent works restrict this to the
case of an absence of particular solenoidal ﬂows [30]). However, such a cyclic
structure can generate couplings that propagate beyond causal interactions.
In this case, the local Markov condition does not imply a Markov blanket, as
marginalization over local blanket variables generates new couplings (dashed
arrows in Fig. 2.B). This important issue (identiﬁed by [34]) contradicts the
intuition that perception-action states always constitute Markov blankets,
which we will explore in following sections.
Solenoidal couplings. The second required property is that solenoidal
couplings between internal, external, sensor and motor states are absent. The
idea of solenoidal ﬂows (see Appendix A) arises from the separation of the
ﬂow of a dynamical system into two components. The ﬁrst component is a
dissipative (curl-free) ﬂow that counters the dispersion of the density caused
by random ﬂuctuations in the system. The second component, the solenoidal
ﬂow, is deﬁned as a conservative (divergent-free) ﬂow capturing dissipative
tendencies in the system, driving it away from equilibrium [3, p.11]. This
6

nonequilibrium nature is a fundamental aspect of living entities. Examples
of this are asymmetric organism-environment interactions [35] or the oscil-
latory behaviour underpinning most biorhythms and neural dynamics [36].
The FEP assumes that solenoidal couplings between internal and external
states are absent, meaning that these ﬂows will not penetrate through the
perception-action interface.
Average ﬂows and the variational free energy. The conﬂuence of
these properties entails an important result: due to this particular statisti-
cal structure, the average ﬂow of a system can be described in terms of a
variational free energy gradient. The average ﬂow (also called the marginal
ﬂow, see Appendix A) describes the average rate of change of the system
conditioned on the blanket state. In turn, the variational free energy (see
Appendix A) represents an upper bound of the surprise of observed states,
according to an internal model of the environment.
In the ﬁrst section of this manuscript, we study how likely these conditions
are for the type of dynamical interactions we expect to ﬁnd in living system.
By considering the simplest case of non-equilibrium stochastic dynamics,
we show that Markov blankets and absence of solenoidal ﬂows only emerge
for very particular perception-action interfaces, forcing symmetries in agent-
environment interactions that are not expected in living beings.
The core issue is that these three requirements – a perception-action par-
tition where sensor and active states mediating the internal and the external
states, the existence of a Markov blanket, and decoupled solenoidal ﬂows –
are, in principle, independent conditions. A perception-action interface does
not necessarily guarantee the required conditional independence relationships
and, in fact, generally does not since statistical correlations can propagate
beyond this interface over time due to the intrinsic ﬂuctuations and reen-
trant connections in the system. Conversely, the conditional independence
relationship decreed by the Markov blanket does not imply that there is a
lack of dynamical coupling between internal and external states [34]. In prac-
tice, we discover that the kinds of systems that can fulﬁl both the Markov
blanket condition and the block-diagonal solenoidal coupling condition are
extremely specialized and generally do not possess the kind of sparsity and
asymmetry of dynamical couplings that we expect from a perception-action
interface. These asymmetries are present at diﬀerent levels of living systems,
leading to qualitative diﬀerences between the inside and outside of a system,
shaping system-environment interactions and its related ﬂows of energy and
matter [35, 37, 38, 39].
7

In other words, although the Markov blanket assumption is typically
maintained in systems with very weak couplings, we observe that there are
direct interactions between external and internal states in the system’s dy-
namics. This subtle distinction between the conditional independence rela-
tionships of the mechanisms of a system (perception-action interface) and its
statistical couplings (Markov blanket) – which is analogous to the distinction
between anatomical and functional connectivity in neuroscience – has per-
haps been underappreciated in the FEP literature. This ambiguity leads to
the claim that the requirements of the FEP naturally describe systems with
a causal boundary between the external and internal states [2], when this is
not necessarily the case.
How informative is the free energy principle
Once the relation between a free energy gradient and the average ﬂow of a
system has been established, we explore how informative this relationship is
about the behaviour of an organism or the evolution of a dynamical system.
Conditional synchronisation manifold. To justify the relation be-
tween a gradient of a free energy functional and the behaviour of a system,
the FEP assumes the existence of a conditional synchronisation manifold (see
Appendix A). This manifold is deﬁned as a mapping that, given a blanket
state, connects the most likely internal and external states. The FEP pro-
poses that its existence allows us to characterise the relationship between
(maximum a posteriori) internal and external states in terms of internal
states ‘sensing’ or ‘tracking’ external states through the Markov blanket [3].
Next, the FEP links the evolution of the most likely external states with
the average ﬂow of the system, conditioned on the blanket states. Since the
step described in the previous section connects the free energy gradient with
the average ﬂow, this assumption implies that the evolution of the most likely
external states is driven by the gradient of a variational free energy. More-
over, given the conditional synchronisation manifold, the most likely internal
states are also driven by this free energy gradient. The FEP suggests this
result leads to the appearance that any system with the properties described
above behaves as if internal states were performing variational inference to
predict external states.
Average ﬂows and the rate of change of the average. The claim
that systems under the required properties behave as if performing infer-
ence relies on a venturesome assumption. It implicitly attributes the rate of
change of the average (expected) state of a system– i.e. the expected change
8

in the internal state of an agent at a particular moment – can be roughly
described by the steady-state average ﬂow of the system conditioned on a
blanket state – i.e. the average rate of that state during many trajectories
(see Appendix
A). This assumption is driven by the intuition that if the
average ﬂow points in a direction that minimizes variational free energy, in-
ternal states will behave as if they are trying, on average, to minimize this
free energy. As well, this can be read as an implicit assumption that these
two quantities are approximately the same. However, as we will show, this
intuition is incorrect since the average ﬂow conditioned on blanket states dis-
connects the rate of change in the system from its previous trajectory, which
is crucial to predict the system’s behaviour. In practice, this assumption
implies decoupling the actions of an agent from its history of previous states.
We will show that, in the class of linear system explored in this work, this
results in the free energy gradients being uninformative about the behaviour
of an agent or its speciﬁc trajectories.
We should note that this claim has been relaxed in more recent work
[30], proposing (instead of an equivalence between rates of change of ex-
pected states and average rates) that an interpretation in terms of Bayesian
inference emerges only in expectation. We will see however that this still
presents important practical and conceptual problems. To draw an analogy
that portrays this issue, we could propose that the actions of a population
of organisms in a particular evolutionary context maximize, on average, a
ﬁtness function – e.g. the number of genes the population passes on to the
next generation.
That is, however, a largely uninformative statement for
describing the behaviour of an individual organism, which depends on that
organism’s speciﬁc history.
Moreover, the behaviour of an organism that
systematically inferred what to do next in terms of (evolutionary) ﬁtness
maximization would likely be entirely diﬀerent from the realized behaviour
of any living organism.
This is not only a point of philosophical nuance
but, as we will show, translates into assumptions and important equations
required for deriving the FEP.
Overview of the mathematical review
In this article, we present a technical and conceptual critique of the FEP.
As the theory is in continuous development, its mathematical details have
been described in diﬀerent forms and notations in the literature. For our
study we try to remain as close as possible to the verbal and formal descrip-
tions described in the most recent publications [3, 4, 30]. However, in at least
9

two instances (see Assumption 1 and Assumptions 3∗and 3∗∗), we identify
conﬂicting interpretations of the theory. In these cases, we attempt to derive
our argument with as much mathematical coherence as possible while also
presenting results that address the diﬀerent identiﬁed possibilities.
The rest of the article is organized as follows. First, we present a summary
of the FEP, including a list of conditions and assumptions required to derive
it.
Next, we survey the steps prescribed to derive the FEP for a linear
stochastic system under a weak coupling assumption. We then evaluate in
which cases we expect the requirements of the FEP to hold. Finally, we
evaluate the implications of our study for the theory and its applicability to
the type of processes that living systems are expected to manifest.
2. Summary of the theory
Here we present a succinct description of the theory, based on the most
recent publications [3, 4, 30], although some steps apply to previous versions
as well. Generally, the FEP assumes a random dynamical system described
in terms of a Langevin stochastic diﬀerential equation:
dzt
dt = f(zt) + ωt,
(1)
where zt = {zi,t}, i = 1 . . . N is a vector, f is an arbitrary but diﬀerentiable
function and ωt = {ωi,t} is a Gaussian white noise with covariance 2Γ, which
is a diagonal matrix. Throughout this article, bold symbols represent vectors
and matrices.
The FEP further assumes that the system can be decomposed into ex-
ternal, sensory, active and internal states, z = {y, s, a, x}, conﬁgured as a
perception-action loop reﬂecting an interface mediating between ‘autonomous’
states (active and internal states {a, x}) and ‘non-autonomous’ states (ex-
ternal and sensory states {y, s}). This leads to
Condition 1. The ﬂow function f decouples autonomous and non-autonomous
states according to the following perception-action interface:
f(zt) =


fy(yt, st, at)
fs(yt, st, at)
fa(st, at, xt)
fx(st, at, xt)

.
(2)
10

  Assumption 3*
b
my
my
  Condition 3
b
y
x
  Assumption 2
b
my
mx
  Condition 2
s
a
y
x
  Condition 1
s
y
x
a
s
y
x
a
  Assumption 1
s
a
y
x
Causal inﬂuence
Solenoidal coupling, Q
Diﬀusion tensor, Γ 
Statistical dependence
Mapping
b = {s, a}
Figure 3: Conditions for the free energy principle. List of conditions and assump-
tions for deriving the FEP. The conditions for the FEP are: the ﬂow of the system is
constrained to deﬁne a perception-action interface (Condition 1, illustrated in the ﬁgure
for an Euler integration step), the system has a global attractor described by a state-
independent SDE decomposition (Condition 2), and from this conﬁguration a Markov
blanket emerges (Condition 3). The assumptions necessary for deriving the FEP are: the
global attractor presents an uncoupling of solenoidal ﬂows (Assumption 1), there is an
invertible mapping between the most likely internal and external states (Assumption 2)
and the evolution of the most likely external dynamics is described by the marginal ﬂow
(Assumption 3∗).
11

Under the presence of random ﬂuctuations, some systems will converge
toward a stable global attractor reﬂecting the steady-state dynamics of the
system. In systems out of thermodynamic equilibrium, this global attrac-
tor will describe a non-equilibrium steady-state (NESS), characterized by a
continuous energy ﬂux between the system and its environment. The next
condition of the FEP is that this global attractor exists and can be described
by a stochastic diﬀerential equation (SDE) decomposition [40, 41] (often re-
ferred in the FEP literature as a ‘Helmholtz’ decomposition) describing the
ﬂow function as a linear function of the logarithmic steady state distribution
of the system:
Condition 2. The FEP assumes that the system will reach a non-equilibrium
steady state described by the probability density function p(zt), which can be
described using a SDE decomposition that separates the ﬂow into dissipative
(−Γ∇zJ(zt)) and solenoidal (Q∇zJ(zt)) components
f(zt) =(Q −Γ)∇zJ(zt),
(3)
J(zt) = −log p(zt),
(4)
where Q is an antisymmetric matrix – i.e. equal to its negative transpose,
Q = −Q⊺. This condition requires Γ and Q to be constant matrices – i.e.
state-independent, as it is the case in linear systems1.
The third condition is that the perception-action interface induces a
Markov blanket into the NESS probability distribution. In a Markov blan-
ket, internal states are independent when conditioned on the blanket states,
composed of sensory and active states, b = {s, a}:
Condition 3. The steady state distribution is described in terms of a Markov
blanket, where internal/external states are independent when conditioned on
its blanket states.
p(yt, xt|bt) = p(yt|bt)p(xt|bt).
(5)
1Recent works have relaxed this assumption, considering the case of state-dependent
Γ and Q matrices [42, 43]. However, these changes do not materially aﬀect our critique
(which uses systems where these matrices are independent of the state of the system) and
we focus on the state-independent case here.
12

It is important to note (see [34]), that Conditions 1 and Condition 3
are independent and one does not entail the other. This is an important
point, as some presentations of the FEP assume that a perception-action
interface directly involves a causal barrier (Markov blanket) between system
and environment, and this is not always the case.
2.1. First move: Capturing Bayesian inference with an average ﬂow
The FEP starts by describing the average ﬂows of the external states of
a system as following a gradient minimizing a variational free energy. This
connects these ﬂows with notions from Bayesian inference.
The principle starts from a description of the ‘surprise’ of the observed
blanket states, under the steady-state distribution deﬁned by the (random)
dynamics of the system, which we denote with J(b) being the negative log-
probability
J(b) = −log p(b).
(6)
This implies that highly unlikely states will have a large surprise value and
vice versa.
However, a system cannot access this surprise value without complete
knowledge of its environment. Thus, Bayesian inference prescribes to use a
lower bound of this surprise described by the variational free energy F(θ, b):
−log p(b) < F(θ, b) = −log p(b) + DKL(q(y|θ)||p(y|b))
(7)
DKL(q(y|θ)||p(y|b)) =
Z
dyq(y|θ) log q(y|θ)
p(y|b)
(8)
which is composed of the surprise plus a term capturing the distance from
the probability of external states given the blanket p(y|b) to a variational
model of the environment q(y|θ) parametrized by θ.
This free energy constitutes a bound on the surprise, which is exact
when the variational distribution q(y|θ) is equal to the reference distribution
p(y|b). The FEP often assumes that q is a normal distribution:
q(y|θ) =N(θ, Σθ),
(9)
where θ are the most likely states of the system and Σθ its covariance matrix.
A simple instance of Bayesian inference can be derived from the assump-
tion that the integral of the negative conditional log-probability (or surprise)
13

in the Free energy equation is approximately quadratic in the region near the
mode of the conditional density θ. This is called the Laplace approximation
[44] and allows approximating
F(θ, b) ≈−ny
2 (1 + log(2π)) −1
2 log |Σθ|
+
Z
dyq(y|θ)

J(θ, b) + 1
2(y −θ)⊺Hyy(y −θ)

=J(θ, b) + 1
2 Tr

ΣθHyy

−ny
2 (1 + log(2π)) −1
2 log |Σθ|.
(10)
where Tr is a trace operator, Hyy = ∇yyJ(θ, b) is the Hessian matrix respect
to y of the marginal probability distribution p(y, b) at y = θ.
In this scenario, ﬁnding the model q(y|θ) that minimizes the variational
free energy is equivalent to approximating the distribution p(y|b). From a
gradient descent perspective, if we are interested in adjusting parameters θ,
this minimization process results from following the negative gradient
∇θF(θ, b) =∇θJ(θ, b).
(11)
Under the FEP it is suggested that a system displaying a Markov blanket
minimizes the free energy functional by implementing a gradient descent
scheme referred to as recognition dynamics [7, 45, 46]. A literal interpretation
of this claim involves a dynamics of the variational parameter with the form
dθt
dt = −γ∇θJ(θt, bt),
(12)
where γ is a matrix characterizing the rates of adjustment of the variational
parameters.
This type of dynamics (or a discrete counterpart) is usually
proposed by active inference schemes (e.g. [46]). However, in the most recent
articles (e.g. [30]) this claim is not taken literally, and the proponents of the
FEP suggest that it is only the average ﬂows of the system (not the actual
dynamics) that point in the direction of the free energy gradient. Throughout
this manuscript, we will explore both a literal interpretation of a gradient
descent on the free energy and the case in which the free energy gradient is
only connected with the average ﬂows.
The FEP asserts that any system with a Markov blanket partition that
reaches a non-equilibrium steady-state (NESS) can be construed as perform-
ing an elementary sort of Bayesian inference. This implies that the behaviour
14

of a system can be described by some variable that behaves as θt in Eq. 12,
at least on average. Speciﬁcally, the FEP proposes that the evolution of the
statistics of internal states can be described in terms of the variational free
energy, given a blanket bt.
Under Condition 3, given a blanket state at time t (bt), the statistics
of internal and external states can be described independently. The FEP
proposes to describe change in internal and external states through variables
encoding the most likely2 internal and external states conditioned on the
blanket
mx(bt) =arg maxxp(xt|bt),
(13)
my(bt) =arg maxyp(yt|bt).
(14)
Then, the average ﬂow of the system (or marginal ﬂow) conditioned on
the blanket bt can be computed from the SDE decomposition in Condition 2
as
⟨fy(yt, bt)⟩bt =
Z
dxtdytp(yt, xt|bt)fy(yt, bt)
=
Z
dxtdytp(yt, xt|bt)(Qyz −Γyz)∇zJ(zt)
=(Qyy −Γyy) ⟨∇yJ(zt)⟩bt
+ Qyb ⟨∇bJ(zt)⟩bt + Qyx ⟨∇xJ(zt)⟩bt .
(15)
The ﬁrst term in this expression can be related to the gradient of the
surprise in Eq. 11 (see below). However, the second and third terms in the
Eq. 15 preclude a straightforward connection between the average ﬂow of the
system and the minimization of the variational free energy. The necessary
step in deriving the FEP is removing the solenoidal couplings between blocks
of the system, encoded in the matrix Q, to remove these second and third
terms. Thus, in order to describe the equivalence between the dynamics of a
system and free energy minimization, the FEP assumes that
2Choosing the arg max function can imply problems in some cases (e.g. if it is non-
diﬀerentiable), and in some cases the expectation has been proposed as an alternative
statistic. However, in the case of Gaussian systems these two functions are equivalent, so
this does not aﬀect the conclusions in this article.
15

Assumption 1. Solenoidal couplings between ‘blocks’ of states (y, s, a, x)
are precluded when a Markov blanket emerges under sparse coupling [3].
Q =


Qyy
Qss
Qaa
Qxx

.
(16)
This leads to
⟨fy(yt, bt)⟩bt =(Qyy −Γyy) ⟨∇yJ(zt)⟩bt
≈(Qyy −Γyy)∇myJ(my(bt), bt).
(17)
Where the approximation is obtained neglecting couplings of order larger
than quadratic in the average of the surprise J(zt), as prescribed by the
Laplace assumption, knowing that the ﬂow of external states is independent
of internal states x. The obtained expression is proportional to the gradient
in Eq. 11 for θt = my(bt), therefore pointing to a direction minimizing the
free energy, where the factor −(Qyy −Γyy) represents the rate of adjustment
of variational parameters (γ in Eq. 12).
In a recent work [30], it has been proposed that in the general case Q
is only block-diagonal for autonomous ({a, x}) and ‘non-autonomous’ states
({y, s}), allowing non-zero components Qys, Qsy, Qax, Qxa. However, it is not
clear (to our knowledge) how this case can be directly connected with free
energy minimization, and this should be perhaps clariﬁed by future work. In
any case, the ﬁndings in the next sections of this article bring forward similar
problems considering one type of block-diagonal matrix or the other.
This step concludes the ﬁrst move for deriving the FEP, by connecting
the average ﬂow of a system with the gradient minimizing a variational free
energy functional.
2.2. Second move: Linking the average ﬂow with the dynamics of the most
likely states
The second move for deriving the FEP involves connecting the average
ﬂow in the system with its (averaged) dynamics. This second step starts by
assuming a mapping connecting the most likely internal and external states:
16

Assumption 2. There is a smooth and diﬀerentiable function σ that maps
between the most likely internal and external states given a blanket state,
my(bt) = σ(mx(bt)),
(18)
and the gradient ∇mxσ(mx) is invertible (i.e. (∇mxσ(mx))−1 exists)
A suﬃcient requisite for Assumption 2 is that the mapping from bt to
mx(bt) is injective [4].
Once the mapping between internal and external states is deﬁned, the
next step, as we anticipated, admits two possible interpretations. The ﬁrst is
an interpretation in which the dynamics of the average states of the system
strictly follow a gradient descent on the free energy (in the form of Eq. 12, e.g.
[46]). A second interpretation relaxes this view to propose that free energy
minimization only takes place on average over counterfactual trajectories
(rather than directly). The distinction between the two (see Assumptions
3∗and 3∗∗) has been generally not discussed in detail, but it is of great
importance to evaluate the claims of the FEP.
The ﬁrst interpretation proposes that the dynamics of the most likely
states can be described by the gradient on the free energy captured by the
average ﬂow described by Eq. 17, which results in:
Assumption 3∗. The evolution of the most likely external states is similar
to their conditional marginal ﬂow given the blanket state
dmy(bt)
dt
≈⟨fy(yt, bt)⟩bt .
(19)
The star ∗symbol in this assumption indicates that this assumption is
in general not explicitly stated, and that two competing interpretations are
possible. The ﬁrst interpretation, in which Assumption 3∗holds strictly, is
supported by verbal descriptions and some mathematical steps in [3] and
[4] (speciﬁcally the equivalents of Eq. 20 and 21 below3 and several verbal
3In these works, the same symbol is used to represent dmy(bt)
dt
and ⟨fy(yt, bt)⟩bt in
Eq. 20 and 21 (Eq. 3.3 and 3.5 in [4], Eq. 8.22 and 8.23 in [3]), therefore making the
implicit assumption that they are approximately the same quantity. Also, it should be
noted that Eq. 22 can only be obtained under the combination of Assumption 2 and
Assumption 3∗, as it combines properties of the mapping σ (related to the most likely
states) with the gradient of the free energy (related to the average ﬂows).
17

descriptions4). The alternative interpretation of this assumption relaxes the
equivalence between dmy(bt)
dt
and ⟨fy(yt, bt)⟩bt (see Assumption 3∗∗below).
Taken together, these three assumptions let us derive a connection be-
tween the evolution of the most likely states and the gradient of the varia-
tional free energy:
dmy(bt)
dt
=(Qyy −Γyy)∇myJ(my(bt), bt).
(20)
This has an important implication, as it allows us to derive that my(bt)
behaves as the variational inference parameter θ in Eq. 11. Therefore, the
dynamics of a system can be described as if performing variational inference.
This is possible because the conditional synchronisation manifold (As-
sumption 2) allows deriving a mapping between the evolution of the most
likely states through the chain rule:
my(bt) = σ(mx(bt)) ⇒dmy(bt)
dt
= ∇mxσdmx(bt)
dt
.
(21)
Finally, under Assumption 3∗, the dynamics of the most likely internal
states can be described as minimizing the variational free energy about ex-
ternal states
dmx(bt)
dt
=(∇mxσ)−1dmy(bt)
dt
≈(∇mxσ)−1(Q −Γ)(∇mxσ)−1∇mxJ(σ(mx(bt)), bt),
(22)
which corresponds to following the gradient descent on the variational free
energy described by Eq. 12, now rewritten in terms of the most likely internal
states.
Here, we shall note that, in general, Assumption 3∗does not hold for
most dynamical systems with stochastic ﬂuctuations, as it equates the rate
of change of an average with the average of the rate of change. The propo-
nents of the FEP in recent works oﬀer instead a more relaxed interpretation
of the gradient descent on the variational free energy. This interpretation
proposes that the FEP applies just to the marginal ﬂows, and thus a system
4Particularly sentences about variable ˙η(b) in these works, for which it is stated ‘the
dynamics of the internal mode as a gradient ﬂow on the surprisal of the external mode’
([3], p. 97) ‘the rate of change of the most likely internal states’ ([4]), p. 7.)
18

behaves ‘as if’ performing Bayesian inference just on average. For exam-
ple in [30] the authors propose that ‘the interpretation in terms of Bayesian
inference emerges only in expectation — or on average [. . . ] The classical
example here is the averaging of multiple responses to sensory perturbations,
when characterizing evoked responses in internal states’. This results in the
substitution of Assumption 3∗by
Assumption 3∗∗. If the conditional average ﬂows follow the direction of a
descending gradient of a variational free energy, the behaviour of the states
of the system can be interpreted ‘as if’ they were, on average, performing a
gradient descent or minimizing a free energy functional.
In general, it is not easy to distinguish in the FEP literature when As-
sumption 3∗or Assumption 3∗∗is considered, as verbal descriptions some-
times refer to dynamics of most likely states and average ﬂows indistinctly.
Note also that some important steps like the chain rule in Eq. 21 can only
be derived for the interpretation promoted by Assumption 3∗. Despite the
interpretation, under these assumptions the proponents of the FEP conclude
that the dynamics of the most likely internal and external states can be de-
scribed as following a negative free energy gradient, which is equivalent to
stating that they evolve as if performing a Bayesian inference. Moreover,
the FEP proposes that this can be extended to the dynamics of actions a [4],
deriving the principle of active inference [10, 12].
The two moves described here make important assumptions about the
underlying dynamical systems used to derive the theory.
The ﬁrst move
assumes a very speciﬁc statistical structure in which a gradient of the free
energy functional is directly connected to average ﬂows in the systems, with-
out justifying to what extent it can be expected from the classes of systems
capturing properties from biological systems. The second move makes fur-
ther assumptions to justify that average ﬂows (i.e. the average of the rate
of change) in the system are informative about its behaviour and dynamics
(i.e. the rate of change of the average), supporting an interpretation that
described the behaviour of a system as if performing Bayesian inference. In
the next sections, we will see that the steps for deriving this interpretation
are not justiﬁed for the non-equilibrium linear systems studied in this paper.
In the rest of the document, we will take Conditions 1 and 2 for granted
and explore the generality of the other conditions and assumptions in linear
stochastic systems with weak couplings. We will see that Assumption 2 hold
under special conditions and can be expected for a given class of systems.
19

In contrast, we show that Condition 3 and Assumption 1 only hold for very
speciﬁc sensorimotor loops and Assumption 3∗and 3∗∗do not hold in gen-
eral, threatening the viability of the FEP and its applicability to most living
systems.
3. Mathematical review of the FEP under linear stochastic dynam-
ics
In order to explore the assumptions enumerated above in a class of tractable
non-equilibrium dynamical systems, we restrict our analysis to the class of
systems captured by a linear Langevin dynamics (which can be seen as an
approximation of an Ornstein-Uhlenbeck process [47]) deﬁned by
dzt
dt = J(zt −ρ) + ωt,
(23)
where J is an n × n invertible real matrix, ρ is an n dimensional real vector,
ωt is a standard n-dimensional Gaussian white noise with a diagonal covari-
ance matrix 2Γ. The linearity of the process guarantees that the model will
eventually result in a Gaussian distribution.
The solution of this system (see Appendix
B) in the non-equilibrium
steady state (NESS) takes the form of a multivariate Gaussian distribution
N(ρ, Σ∗) [47, 48] with statistical moments:
lim
t→∞mt =ρ,
(24)
lim
t→∞Σt =Σ∗,
JΣ∗+ Σ∗J⊺+ 2Γ = 0,
(25)
where Σ∗can be found numerically by solving the above continuous Lyapunov
equation.
If J is symmetric, the steady state of the system is a state of
equilibrium with Σ∗= −J−1Γ. However, the FEP focuses instead on NESS,
which are more appropriate for describing living systems.
For studying the NESS of the system, in this article we explore the case
in which non-diagonal couplings in J are small, although we explore the
eﬀect of considering higher orders of this approximation. Thus, we deﬁne
the coupling matrix as, J = −I + C, where C2 are assumed to be small.
This leads to the following power series expansion,
Σ∗= Γ + 1
2(CΓ + ΓC⊺) + 1
4
 C2Γ + 2CΓC⊺+ Γ(C⊺)2
+ O(C3).
(26)
20

To further simplify things, we also deﬁne a homogeneously distributed noise
Γ = ς2I, being ς a scalar constant.
The details of the derivation of the
equations above are described in Appendix B.
3.1. Can we expect the requirements for deriving the FEP in living systems?
To explore the generality of the conditions required to connect the average
ﬂow of a system to the gradient of the free energy, here we explore Conditions
3 and Assumption 1 required to derive the ﬁrst move of the FEP.
Condition 3: Markov blanket
First, the FEP requires the existence of a Markov blanket imposing a con-
ditional independence between internal and external states given a blanket
state (Condition 3, [3, 4]). We will see that not all linear systems meet this
condition, although it can be considered as an approximation in the case of
very weak-couplings.
For systems represented by Gaussian distributions, the Markov blanket
condition (Condition 3) is only met when the inverse of the covariance, the
Hessian matrix H = (Σ∗)−1, satisﬁes,
Hyx = Hxy = 0.
(27)
Thus this begs the questions: How common are Markov blankets?
And
when can we expect to ﬁnd them in living systems?
The FEP generally
proposes that the theory holds when the Markov blanket condition is satisﬁed
under a ‘canonical ﬂow constraint’ [30] that is deﬁned in our linear system
by ∇zf(z) = J structured as in Fig. 4.A. This means that, mechanistically,
external and sensory states do not depend on internal states, and that action
and internal states do not depend on external states. This is representative of
the kind of asymmetries we expect from a sensorimotor loop in living systems.
However, even in linear systems, it is not easy to know under what conditions
a system can satisfy both the canonical ﬂow constraint and possess a Markov
blanket. As [34] points out, neither one of these conditions is suﬃcient to
guarantee the other.
In the case of weak couplings where J = −I + C, and homogenous noise
Γ = ς2I, the covariance of the system can be expanded as Eq. 26, and the
inverse covariance (Hessian) can be computed as a Neumann series (Appendix
B),
H = (Σ∗)−1 = ς−2I −ς−2
2 (C + C⊺) + ς−2
4 (C⊺C −CC⊺) + O(C3).
(28)
21

y
s
a
x
C Symmetric loop
s
a
y
x
B Circular loop
s
a
y
x
A 'Canonical' loop
Figure 4: Sensorimotor loop structures. The ﬁgure shows the ‘canonical’ or general
sensorimotor structure proposed by the FEP [30] (A), a circular loop where all connections
between elements are asymmetric and unidirectional (B) and a restricted sensorimotor
loop where all interactions between blocks of the system are symmetric, only allowing
asymmetric connections within blocks (B).
22

Under the couplings determined by Condition 1 we can see that for a
ﬁrst order approximation Hyx = 0 + O(C2), satisfying the Markov blanket
condition.
For a second order weak coupling approximation we have,
Hyx = −ς−2
4 (CysC⊺
xs + CyaC⊺
xa) + O(C3).
(29)
Under the canonical ﬂow constraints, relatively few systems will display an
exact Markov blanket, except for combinations of parameters that happen
to cancel the terms in the equation above. One exception is systems with
weak couplings under circular loops (Fig. 4.B) or systems with two layers of
blanket states (e.g. the system in Fig. 4.C). Note that this is because cycles
generating conditional couplings between x, y are of order higher than 2. In
general, these cases will not display a Markov blanket for stronger couplings
(see Eq. B.15,B.16, except for perfectly symmetric couplings). Thus, we can
conclude that Markov blankets will emerge only for particular combinations
of parameters, as cycles in the system will in general introduce couplings
preventing their existence.
Assumption 1: solenoidal coupling
The FEP requires that the averaged marginal ﬂow of external states y,
given a blanket state b, depends only on the gradients of its marginal density.
For this, it is a requirement that there is no solenoidal coupling between
external and other states (Assumption 1). We will see in this section that
most linear systems will not meet this condition.
We can rewrite Eq. 25 to express the matrix of solenoidal couplings Q as
(see Appendix B.2 or [34])
JQ + QJ⊺= JΓ −ΓJ⊺.
(30)
Again, the values of Q can be obtained by solving the corresponding
continuous Lyapunov equation. Assuming J = C −I, this matrix can be
expressed as the power series
Q = 1
2(CΓ −ΓC⊺) + 1
4
 C2Γ −Γ(C2)⊺
+ O(C3).
(31)
The ﬁrst order approximation under weak coupling J = −I + C and
Γ = ς2I and the canonical ﬂow constraints (Condition 1, Fig. 4.A) results in
23

the solenoidal coupling matrix
Q = ς2
2


Cyy −C⊺
yy
Cys −C⊺
sy
Cya
Csy −C⊺
ys
Css −C⊺
ss
Csa −C⊺
as
−C⊺
xs
−C⊺
ya
Cas −C⊺
sa
Caa −C⊺
aa
Cax −C⊺
xa
Cxs
Cxa −C⊺
ax
Cxx −C⊺
xx

+ O(C2). (32)
Where Assumption 1 is not met for most parameter combinations.
In the best-case scenario, we can make many terms in the matrix above
disappear by making blocks symmetric when possible. This however does
not completely remove non-diagonal blocks, and leaves
Q = ς2
2


Cyy −C⊺
yy
Cya
Css −C⊺
ss
−C⊺
xs
−C⊺
ya
Caa −C⊺
aa
Cxs
Cxx −C⊺
xx

+ O(C2).
(33)
Thus we observe that, even in a very weakly coupled system, the only way of
setting QyaQsx and their antisymmetric counterparts to zero is to eﬀectively
decouple some parts of the sensorimotor loop completely that results in a
‘symmetric’ interaction loop with the form displayed in Fig. 4.C). In this
type of system, detailed balance is only broken by interactions inside blocks
y, s, a, x, as all couplings between blocks are symmetric. Therefore, the sys-
tem is driven out-of-equilibrium only by internal tendencies of these blocks,
not by their interactions between them. This precludes for example the ex-
istence of asymmetric agent-environment interactions, which may be crucial
for many living processes as a mechanism for generating qualitative diﬀer-
ences between the inside and the outside of a system, as well as for regulating
exchanges of matter and energy with the environment [35, 37, 38, 39].
For a second order approximation, we ﬁnd the solenoidal coupling terms
24

between external and autonomous states:
Qya =ς2
4
 2Cya + CyyCya + CysCsa + CyaCaa −C⊺
syC⊺
as

+ O(C3),
(34)
Qyx =ς2
4
 CyaCax −C⊺
syC⊺
xs

+ O(C3),
(35)
Qsa =ς2
4

2(Csa −C⊺
sa) + CsyCya + CssCsa + CsaCaa
−C⊺
ssC⊺
as −C⊺
asC⊺
aa −C⊺
xsC⊺
ax

+ O(C3),
(36)
Qsx =ς2
4 (−2C⊺
xs + CsaCax −C⊺
ssC⊺
xs −C⊺
asC⊺
xa −C⊺
xsC⊺
xx) + O(C3). (37)
We can see that this matrix will in general only be block diagonal in very spe-
ciﬁc cases, exemplifying how the presence of higher-order terms complicates
the uncoupling of solenoidal terms.
These results show how, in the case of linear, weakly-coupled systems,
the assumptions about the statistical structure of a system required by the
FEP is restricted to a very narrow space of parameters (i.e. values of C).
In particular, removing solenoidal couplings between blocks of the system
requires a highly symmetric coupling structure (Fig. 4.C). This prevents the
application of the theory to many common structures found in biological
systems.
3.2. Can the FEP explain and describe the behaviour of living systems?
Above, we have shown that the conditions for connecting the conditional
average ﬂow with the gradient of the free energy functional only hold for a
very narrow class of systems. Now we explore, in the cases where the previous
requirements are met, the connection between the conditional average ﬂow
and the behaviour of the most likely states of the system.
That is, are
the results of the FEP able to describe, explain or predict the dynamics of
the systems that conform to its assumptions? Here we will see that, while
Assumption 2 follows from a broad class of linear systems, one of the major
ﬁndings of our study is that Assumptions 3∗and 3∗∗present important issues
that prevent the results of the FEP to be good descriptions of the behaviour
of stochastic dynamical systems
Assumption 2: Mapping between internal and external statistics
A further requirement of the FEP is that a mapping σ exists between in-
ternal and external states (Assumption 2). We will see that in linear systems,
25

at least, there are many systems that meet this condition.
Given a NESS well characterized by Gaussian distributions over states
p(zt) = N(ρ, Σ∗), the conditional distributions given a particular blanket
state b = {s, a} results in the most likely states (Eq.
13 and 14) being
described as
mx(bt) =ρx + Σ∗
xb (Σ∗
bb)g (bt −ρb),
(38)
my(bt) =ρy + Σ∗
yb (Σ∗
bb)g (bt −ρb),
(39)
where (Σ∗
bb)g is a generalized inverse matrix (which is equivalent to the inverse
for nonsingular matrices). If Σ∗
xb and Σ∗
bb are nonsingular (this implies that
nx ≥nb), we can derive the linear mapping,
my(bt) =ρy + Σ∗
yb (Σ∗
xb)−1 (mx(bt) −ρx) ≡σ(mx(bt)),
(40)
which is invertible if Σ∗
yb is non-singular (for this ny ≥nb is required)
mx(bt) =mx + Σ∗
xb
 Σ∗
yb
−1  my(bt) −ρy

≡σ−1(my(bt)).
(41)
Yielding the evolution of the most likely states as,
dmx(bt)
dt
=∇myσ−1(my(bt))dmy(bt)
dt
= Σ∗
xb
 Σ∗
yb
−1 dmy(bt)
dt
.
(42)
This shows that, in general, a mapping between the most likely internal
and external states exists if the corresponding covariance submatrices are
invertible.
The FEP often states that the existence of this mapping is a consequence
of a Markov blanket [4], but we note that the existence of such a mapping is
independent of Conditions 1 and 3. The existence of a Markov blanket implies
a conditional covariance Σyx(bt) = 0, but this does not aﬀect the relation
between internal and external states. Thus, in linear systems any variable
can potentially mediate an invertible mapping, independently of a Markov
blanket, if the corresponding covariance submatrices are nonsingular5.
5At the moment of writing this manuscript, we have found that a similar result has
been found independently in unpublished work [49].
26

Assumption 3∗: The dynamics and Bayesian inference
The ﬁnal assumption for deriving the FEP is that the evolution of the
most likely external states is linked with the evolution of the marginal ﬂow
conditioned on blanket states bt. In this section, we see that this assumption
does not hold in general.
The time derivative of my(bt) yields,
dmy(bt)
dt
=Σ∗
yb (Σ∗
bb)g dbt
dt = Σ∗
yb (Σ∗
bb)g (Jbz(zt −ρ) + ωb,t) .
(43)
Conversely, the equation proposed by the FEP uses the marginal ﬂow
(Assumption 3∗, see [4] or Appendix B in [3]). We represent the dynamics of
a variable driven by this marginal ﬂow as
d emy(bt)
dt
≡⟨fy(yt, bt)⟩bt = (Qyz −Γyz) ⟨∇zJ(zt)⟩bt
=Jyy(my(bt) −ρy) + Jyb(bt −ρb),
(44)
where emy(bt) captures the evolution of the most likely dynamics in a system
behaving in a way that strictly minimizes the free energy. The diﬀerence
between the behaviour of my(bt) and emy(bt) allows us to evaluate how in-
formative is the FEP about the behaviour of a system. If a system approx-
imately follows a free energy gradient, the behaviour of these two variables
will present some similarities in their evolution. This approximation is crucial
for the FEP as it is this marginal ﬂow that is connected with the gradient of
the free energy (therefore equating dynamics and inference, see Assumption
3∗). By using Eq. 39 this expression can be rewritten simply as,
d emy(bt)
dt
=
 JyyΣ∗
yb (Σ∗
bb)g + Jyb

(bt −ρb).
(45)
We can thus see that these two equations represent quite diﬀerent quantities
and that, in general, Assumption 3∗will not hold for linear systems.
Furthermore, we can show that this equivalence is also incorrect even in
the case of weak couplings. Speciﬁcally, for the ﬁrst order weak coupling
approximation with J = −I + C and Γ = ς2I. Assuming Σ∗
bb is nonsingular
(i.e. (Σ∗
bb)g = (Σ∗
bb)−1), the weak coupling expansion of its inverse according
to the Neumann series (other expansions exist in the case of generalized
inverses [50]) is,
(Σ∗
bb)−1 =ς−2(I −1
2(Cbb + C⊺
bb)) + O(C2).
(46)
27

A
B
0
10
20
30
t
−0.02
0.00
0.02
my
0
10
20
30
t
−2.5
0.0
2.5
emy
×10−16
0
10
20
30
t
−5
0
5
my
×10−6
0
10
20
30
t
−2
0
2
emy
×10−5
Figure 5: Divergence between system evolution and the marginal ﬂow. Compar-
ison between the true evolution of the system my(bt) versus the marginal ﬂow emy(bt) for
(A) ς = 0.1 and random couplings Cij = ±0.1 with the connection scheme from Fig. 4.C
and (B) ς = 10−3 and random couplings Cij = ±0.1 with the connection scheme from
Fig. 4.B but with Cyb = 0. In both cases ny = nx = 2, na = ns = 1. Note that diﬀerent
parameters (e.g. reducing the noise) yield qualitatively similar results.
Using the weak-coupling approximation of Σ∗(Eq. 26), Eq. 43 results in
dmy(bt)
dt
=1
2(Cyb + C⊺
by)(I −1
2(Cbb + C⊺
bb))
 (−Ibz + Cbz)(zt −ρ)
+ ωb,t

+ O(C2)
= −1
2(Cyb + C⊺
by)(bt −ρb −ωb,t) + O(C2).
(47)
In contrast, the marginal ﬂow in Eq. 44 results in
d emy(bt)
dt
=

(−Iyy + Cyy)1
2(Cyb + C⊺
by)(I −1
2(Cbb + C⊺
bb))
+ Cyb

(bt −ρb) + O(C2)
= −1
2(−Cyb + C⊺
by)(bt −ρb) + O(C2),
(48)
which not only ignores the random ﬂuctuations term, but also reverses the
sign of the term Cyb. Note that Cyb = C⊺
by when we force solenoidal uncou-
pling (Assumption 1, see Section 3.1), making d e
my(bt)
dt
= 0 in that case (while
dmy(bt)
dt
is non-zero).
28

For this weak coupling approximation, the only case in which the approx-
imation is valid is one in which ς = 0 (a deterministic system) and Cyb = 0
(a system where the agent just observes the environment without aﬀecting
it). Similar expressions could be derived for higher order approximations.
As an example of the dissimilarity of these quantities, in Fig. 5.A we
display my(bt) and emy(bt) for arbitrary parameters structured as the senso-
rimotor loop described in Fig. 4.C with random couplings Cij = ±0.1 (note
that some weights are set to zero and others forced to be symmetric) and
ny = nx = 2, na = ns = 1, ς = 0.1. We see that emy(bt) cannot capture the
structure in my(bt). The reason behind this is that the derivative of emy(bt)
accumulates an error from ﬂuctuations in the system that are not captured,
displaying a random walk behaviour that is absent in the real variable my(bt)
. Similarly, in the most favourable case, setting a very small noise ς = 10−3
and Cyb = 0 (Figure 5.B), the situation is similar, as even very small noise
terms are suﬃcient for driving the two terms apart due to the integration of
random ﬂuctuations over time.
Assumption 3∗∗: A way out? Problems with interpreting behaviour as Bayesian
inference only ‘on average’
The results of the previous section suggest that the FEP could be, in
practice, inapplicable for describing or explaining the behaviour of living
systems. Some of the most recent works on the FEP [30] try to avoid the
problems described above and state that the free energy principle describes
just marginal ﬂows, that is, it describes the behaviour of a system just on
average over diﬀerent trajectories. This could appear to circumvent some
issues presented in the previous section, as it implies substituting Assump-
tion 3∗by a more relaxed interpretation of a gradient descent on the free
energy described by Assumption 3∗∗. However, under a close inspection, we
encounter that the situation is not improved by this claim. Assumption 3∗∗
entails two problems: 1) the mapping described by Assumption 2 no longer
connects internal and external ﬂows, and 2) the conditional average ﬂow fol-
lowing the gradient of the free energy does not guarantee a gradient descent
in the eﬀective behaviour. While the ﬁrst problem can be solved, the second
has deep implications as in most cases the average ﬂow does not describe
the true behaviour of a system in the presence of stochastic ﬂuctuations,
therefore threatening to render the FEP inapplicable to describe most living
systems. In this last section, we brieﬂy explore the validity of the theory
when applied only to the average ﬂows of a system (and not the evolution of
29

the most likely states).
A ﬁrst, practical problem implied by this claim is that if the FEP only
applies to marginal ﬂows ⟨fy(yt, bt)⟩bt , ⟨fx(bt, xt)⟩bt, then a new mapping
between ﬂows is required. As we described in Eq. 21, a mapping between
the dynamics of the most likely states is derived from the chain rule as the
gradient of the mapping σ. If instead one interprets the FEP as connecting
the conditional average ﬂow of external and internal states a new mapping
is required:
⟨fy(yt, bt)⟩bt = φ(⟨fx(bt, xt)⟩bt).
(49)
In general, this mapping can take complicated forms, and often a unique
mapping will not exist.
In linear systems, however, we can simplify the
marginal ﬂows
⟨fy(yt, bt)⟩bt =Jyy(my(bt) −ρy) + Jyb(bt −ρb)
=
 Jyy + (Σ∗
yb(Σ∗
bb)g)−1
(my(bt) −ρy)
=
 Jyy + (Σ∗
yb(Σ∗
bb)g)−1
Σ∗
yb (Σ∗
xb)−1 (mx(bt) −ρx) ,
(50)
⟨fx(bt, xt)⟩bt =Jxx(mx(bt) −ρx) + Jxb(bt −ρb)
=
 Jxx + (Σ∗
xb(Σ∗
bb)g)−1
(mx(bt) −ρx).
(51)
Which, if Σ∗
bb is invertible, yields
⟨fy(yt, bt)⟩bt =
 Jyy + Σ∗
bb(Σ∗
yb)−1
Σ∗
yb (Σ∗
xb)−1
·
 Jxx + Σ∗
bb(Σ∗
xb)−1−1 ⟨fx(bt, xt)⟩bt
≡φ(⟨fx(bt, xt)⟩bt),
(52)
that results in the mapping φ being very diﬀerent from ∇mxσ. Thus, in
general,
⟨fy(yt, bt)⟩bt ̸= ∇mxσ ⟨fx(bt, xt)⟩bt ,
(53)
thus contradicting [3, 4]. Thus, an interpretation of the FEP over condi-
tional average ﬂows should replace Assumption 2 with a new mapping. This
result, in combination with a block-diagonal Q (Assumption 1) allows rewrit-
ing ⟨fy(yt, bt)⟩bt and ⟨fx(xt, bt)⟩bt pointing in the direction of free energy
minimization, mediated by a mapping φ.
30

However, there is an important conceptual problem that remains even if
a new mapping is derived. The FEP relies on ﬁnding a variable that behaves
as a gradient descent on the free energy functional as described in Eq. 12.
If Assumption 3∗is not met, then there is no variable in the system that
behaves following a gradient descent on the free energy (i.e. a variable θt
with behaviour determined by
dθt
dt
= −γ∇θF(θt, bt)).
In this case, this
assumption could be relaxed to Assumption 3∗∗but, as we observed in the
results and simulations above, even when the average ﬂow of the system is
related with the free energy (i.e.

 dθt
dt

bt = −γ∇θF(θt, bt)) this is not a
good description of the behaviour of a system.
In this case, the claim of the FEP, if all other assumptions are hold, can be
described by Eq. 17, which relaxes the requirement of a strict gradient descent
(described by Eq. 20) and requires instead that the conditional average ﬂow
is directed in the direction of the gradient of the free energy. The problem
with this relaxed gradient descent interpretation is that it does not guarantee
that a system eﬀectively performs a gradient descent, not even on average.
In Appendix C we illustrate this issue in a simple bivariate linear stochastic
model with variables y, b. We observe that this particular model presents a
global attractor located at y = b = 0 with solenoidal ﬂows in the form of
a spiral ﬂow (Fig. C.2.A). In contrast, the conditional average ﬂow suggests
a monotonic gradient ascent on m2
y(b), dismissing solenoidal ﬂows in the
system and transforming an attracting ﬂow into a repelling one. This is a
simple example showing how, in general, the conditional average ﬂows do not
describe the behaviour of the system. Moreover, conditional average ﬂows
can be misleading and not even a good approximation about the average
behaviour of a system, indicating a gradient ascent/descent on some quantity
when the behaviour of the system performs the opposite action. This is also
exempliﬁed in recent work simulating linear systems, where the free energy
gradient only captures attracting tendencies at highly surprising states, not
capturing solenoidal ﬂows nor behaviour near the NESS global attractor [49,
43].
To summarize, our results show that, in general, even if a relaxed version
of the assumptions of the FEP holds, a system cannot be interpreted as if
performing Bayesian inference over external states. The reason behind this
is that the average ﬂows ⟨fy(yt, bt)⟩bt and ⟨fx(bt, xt)⟩bt do not describe the
behaviour of the system, as it can be easily seen from the results in Fig. 5.
Intuitively, substituting the true ﬂow – fy(yt, bt) – by an average ﬂow ﬁxing
the blanket state – ⟨fy(yt, bt)⟩bt –decouples the trajectory of y from its pre-
31

vious state, which in most dynamical systems will result in an impoverished
description, not capturing its real, history-dependent, behaviour.
4. Conclusion
The latest formulation of the free energy principle [3, 4] states that, in
any dynamical system equipped with a Markov blanket, the ﬂow of internal
states can be construed as a gradient ascent on Bayesian model evidence.
This assumption rests on two crucial moves. The ﬁrst move connects the
system’s average ﬂow with a gradient on a variational free energy.
This
connection relies on the existence of a Markov blanket and the emergence of
a particular statistical structure precluding solenoidal couplings. The second
is the interpretation that this relation between free energy and an average
ﬂow results in systems behaving as if performing variational inference over
the states of its environment. In this review, we have summarized crucial
steps required for this claim (Conditions 1–3 and Assumptions 1–3∗) and
have shown that several of these conditions cannot be met in general by
linear, weakly-coupled stochastic systems.
The ﬁrst step compels a discussion about the generality of the FEP. That
is, if the principle requires a particular statistical structure, how general is
this structure, and how broadly can we expect it to be present among the
class of systems capturing the properties of living and cognitive processes?
We discover that, in the class of linear systems explored, the answer to this
question is that the statistical structure required by the FEP only arises in
a very narrow class of systems, requiring stringent conditions such as fully
symmetric agent-environment interactions that we cannot, in general, expect
from living systems [35, 37, 38, 39]. The generality of the FEP has been ques-
tioned in the past due to conceptual issues [51, 33] or the existence of coun-
terexamples challenging the idea that perception-action interfaces, Markov
blankets and solenoidal decoupling follow from each other [34]. However, to
our knowledge, our study is the ﬁrst that shows that the assumptions of the
FEP do not hold for a vast class of systems, namely, linear, weakly coupled
systems, except for the limited case of fully symmetric agent-environment
interaction.
This is concerning for two reasons. First, the FEP is designed for Gaus-
sian (i.e. in most cases linear) stochastic systems [4, 34]. Thus, our results
would imply that, as currently deﬁned, the FEP cannot be fully implemented
in a broad set of systems from the class it was designed for. Second, one could
32

hope that the introduction of strong couplings or non-linearity allows some
speciﬁc systems to meet the required conditions. Some recent approximations
of the behaviour of chaotic oscillators point in this direction [42]. However,
this claim should be regarded with some scepticism, as the introduction of
stronger or higher-order couplings would result in additional terms in the
expansions explored in this article (see Appendix B). For most parameter
settings, systems with stronger couplings will not result in the independence
relations required for Condition 3 and Assumption 1. This will lead, in gen-
eral, to a more signiﬁcant divergence between the evolution of the system
and its average ﬂow, making it more unlikely that Assumptions 3∗or 3∗∗will
hold. We leave it to future work to explore the accuracy of this claim and
investigate whether the assumptions of the FEP can be met beyond the class
of systems explored here, e.g. displaying strong or nonlinear couplings.
The second step concerns how informative the FEP is about the be-
haviour of an agent. The FEP justiﬁes that any system can be described
as if performing variational inference through the existence of a conditional
synchronization manifold relating the direction of the free energy gradient
and the evolution of the most likely states of a system. We observe that
this manifold can exist in a broad class of systems. Nevertheless, assuming
a strict gradient descent interpretation (Assumption 3∗), it is problematic to
connect the evolution of the most likely states to the average ﬂow of a system
(and, in consequence, to assume a system will behave as if minimizing the
variational free energy). The problem lies in implicitly relating the rate of
change of the average (expected) state as being described by the average ﬂow
(the expectation of the rate of change) conditioned on a blanket state. If,
instead, we consider a more relaxed interpretation of the free energy gradi-
ent descent (i.e. just taking place on average, Assumption 3∗∗), we encounter
that new problems arise. First, a new mapping between the ﬂows of internal
and external states is required. Second, we observe that the average ﬂow
cannot, in general, describe the true behaviour of a system. In sum, the FEP
as it stands does not do justice to the inﬂuence of the system’s trajectory in
determining its future behaviour. The reason behind this is that the gradient
of the free energy deﬁned by the principle is computed for the average of an
ensemble of trajectories. Thus, even when the free energy gradient can be
connected with an average ﬂow (which, as we have shown, happens under
very speciﬁc conditions), this is mainly uninformative about the behaviour
of a system subject to stochastic interactions. This is especially relevant for
emergent discussions about the compatibility of the FEP with enactive and
33

autopoietic theories of cognition (e.g. [52, 53, 54]). Speciﬁcally, enactive
principles stress the history-dependence of living systems, and this supposes
a fundamental incompatibility with the assumptions of the FEP [55].
In
particular, enactive views of cognition conceive sense-making as a process
emerging from the history of interactions of a system, which is invisible for
a gradient of the free energy described as an average ﬂow.
The motivation behind the FEP aims to connect ideas from variational
inference with the dynamics of complex, self-organizing systems. This claim
is exceptionally appealing, as it could potentially allow applying the machin-
ery from Bayesian and information theoretical approaches to describe many
systems that are intractable in practice. However, by inspecting the theory
and its assumptions in the context of a broad class of analytically tractable
models, we discover that many of the steps required to derive the theory
do not straightforwardly follow or present signiﬁcant conceptual problems
that need to be resolved. This ﬁnding illustrates the diﬃculties in develop-
ing a theory of life and cognition over interdependent sets of mathematical
assumptions, and how testing these assumptions and their relations against
tractable models can help overcome these diﬃculties.
Acknowledgements
We are grateful to Karl Friston, Lancelot Da Costa, Thomas Parr, I˜nigo
Arandia-Romero and Hideaki Shimazaki for their constructive feedback and
comments on this manuscript. M.A. is thankful to Martin Biehl for helpful
discussions about references [3, 4, 30]. We are also grateful to Manuel Baltieri
for his open peer-review of a preprint of this manuscript.
M.A. was funded by the European Union’s Horizon 2020 research and in-
novation programme under a Marie Sk lodowska-Curie Action (grant agree-
ment 892715) and supported in part by the Basque Government project
IT 1228-19 and the Spanish Ministry of Science and Innovation project PID2019-
104576GB-I00. C.L.B. is supported by BBRSC grant BB/P022197/1.
References
[1] K. Friston, P. Ao, Free energy, value, and attractors, Computational
and mathematical methods in medicine 2012 (2012).
[2] K. Friston, Life as we know it, Journal of the Royal Society Interface
10 (86) (2013) 20130475.
34

[3] K. Friston, A free energy principle for a particular physics, arXiv
preprint arXiv:1906.10184 (2019).
[4] T. Parr, L. Da Costa, K. Friston, Markov blankets, information geom-
etry and stochastic thermodynamics, Philosophical Transactions of the
Royal Society A 378 (2164) (2020) 20190159.
[5] J. Hohwy, The self-evidencing brain, Nous 50 (2) (2016) 259–285.
[6] A. Clark, Surﬁng uncertainty: Prediction, action, and the embodied
mind, Oxford University Press, 2015.
[7] K. Friston, The free-energy principle: a rough guide to the brain?,
Trends in cognitive sciences 13 (7) (2009) 293–301.
[8] K. Friston, J. Daunizeau, J. Kilner, S. J. Kiebel, Action and behavior: a
free-energy formulation, Biological cybernetics 102 (3) (2010) 227–260.
[9] K. Friston, The free-energy principle: a uniﬁed brain theory?, Nature
reviews neuroscience 11 (2) (2010) 127–138.
[10] K. Friston, J. Mattout, N. Trujillo-Barreto, J. Ashburner, W. Penny,
Variational free energy and the laplace approximation, Neuroimage
34 (1) (2007) 220–234.
[11] K. Friston, A theory of cortical responses, Philosophical transactions of
the Royal Society B: Biological sciences 360 (1456) (2005) 815–836.
[12] C. L. Buckley, C. S. Kim, S. McGregor, A. K. Seth, The free energy
principle for action and perception: A mathematical review, Journal of
Mathematical Psychology 81 (2017) 55–79.
[13] B. Millidge, A. Seth, C. L. Buckley, Predictive coding: a theoretical and
experimental review, arXiv preprint arXiv:2107.12979 (2021).
[14] K. Friston, F. Rigoli, D. Ognibene, C. Mathys, T. Fitzgerald, G. Pezzulo,
Active inference and epistemic value, Cognitive neuroscience 6 (4) (2015)
187–214.
[15] K. Friston, J. Daunizeau, S. J. Kiebel, Reinforcement learning or active
inference?, PloS one 4 (7) (2009) e6421.
35

[16] K. Friston, T. FitzGerald, F. Rigoli, P. Schwartenbeck, G. Pezzulo, Ac-
tive inference: a process theory, Neural computation 29 (1) (2017) 1–49.
[17] M. Cullen, B. Davey, K. Friston, R. J. Moran, Active inference in ope-
nai gym: A paradigm for computational investigations into psychiatric
illness, Biological psychiatry: cognitive neuroscience and neuroimaging
3 (9) (2018) 809–818.
[18] B. Millidge, A. Tschantz, C. L. Buckley, Predictive coding approx-
imates backprop along arbitrary computation graphs, arXiv preprint
arXiv:2006.04182 (2020).
[19] J. Hohwy, A. Roepstorﬀ, K. Friston, Predictive coding explains binocu-
lar rivalry: An epistemological review, Cognition 108 (3) (2008) 687–701.
[20] R. Kanai, Y. Komura, S. Shipp, K. Friston, Cerebral hierarchies: predic-
tive processing, precision and the pulvinar, Philosophical Transactions
of the Royal Society B: Biological Sciences 370 (1668) (2015) 20140169.
[21] A. Tschantz, B. Millidge, A. K. Seth, C. L. Buckley, Reinforce-
ment learning through active inference, arXiv preprint arXiv:2002.12636
(2020).
[22] L. Da Costa, T. Parr, N. Sajid, S. Veselic, V. Neacsu, K. Friston, Active
inference on discrete state-spaces: a synthesis, Journal of Mathematical
Psychology 99 (2020) 102447.
[23] B. Millidge, Deep active inference as variational policy gradients, Jour-
nal of Mathematical Psychology 96 (2020) 102348.
[24] T. H. FitzGerald, P. Schwartenbeck, M. Moutoussis, R. J. Dolan,
K. Friston, Active inference, evidence accumulation, and the urn task,
Neural computation 27 (2) (2015) 306–328.
[25] T. Parr, D. Markovic, S. J. Kiebel, K. Friston, Neuronal message passing
using mean-ﬁeld, bethe, and marginal approximations, Scientiﬁc reports
9 (1) (2019) 1–18.
[26] D. Kappel, C. Tetzlaﬀ, A synapse-centric account of the free energy
principle, arXiv preprint arXiv:2103.12649 (2021).
36

[27] A. Tschantz, A. K. Seth, C. L. Buckley, Learning action-oriented mod-
els through active inference, PLoS computational biology 16 (4) (2020)
e1007805.
[28] P. Calvo, K. Friston, Predicting green: really radical (plant) predic-
tive processing, Journal of the Royal Society Interface 14 (131) (2017)
20170096.
[29] K. Friston, J. Kilner, L. Harrison, A free energy principle for the brain,
Journal of physiology-Paris 100 (1-3) (2006) 70–87.
[30] K. Friston, L. Da Costa, T. Parr, Some interesting observations on the
free energy principle, Entropy 23 (8) (2021) 1076.
[31] J. Pearl, Probabilistic reasoning in intelligent systems: networks of plau-
sible inference, Elsevier, 1988.
[32] T. S. Richardson, P. Spirtes, et al., Automated discovery of linear feed-
back models, Carnegie Mellon, 1996.
[33] J. Bruineberg, K. Dolega, J. Dewhurst, M. Baltieri, The emperor’s new
markov blankets, Behavioral and Brain Sciences (2021) 1–63.
[34] M. Biehl, F. A. Pollock, R. Kanai, A technical critique of some parts of
the free energy principle, Entropy 23 (3) (2021) 293.
[35] J. E. Rothman, J. Lenard, Membrane asymmetry, Science 195 (4280)
(1977) 743–753.
[36] G. Buzsaki, Rhythms of the Brain, Oxford University Press, 2006.
[37] B. Fadeel, D. Xue, The ins and outs of phospholipid asymmetry in
the plasma membrane: roles in health and disease, Critical reviews in
biochemistry and molecular biology 44 (5) (2009) 264–277.
[38] X. E. Barandiaran, E. Di Paolo, M. Rohde, Deﬁning agency: Individual-
ity, normativity, asymmetry, and spatio-temporality in action, Adaptive
Behavior 17 (5) (2009) 367–386.
[39] K. Ruiz-Mirazo, A. Moreno, Basic autonomy as a fundamental step in
the synthesis of life, Artiﬁcial life 10 (3) (2004) 235–259.
37

[40] C. Kwon, P. Ao, Nonequilibrium steady state of a stochastic system
driven by a nonlinear drift force, Physical Review E 84 (6) (2011) 061106.
[41] R. Yuan, Y. Tang, P. Ao, Sde decomposition and a-type stochastic inter-
pretation in nonequilibrium processes, Frontiers of Physics 12 (6) (2017)
1–9.
[42] K. Friston, C. Heins, K. Ueltzh¨oﬀer, L. Da Costa, T. Parr, Stochastic
chaos and markov blankets, Entropy 23 (9) (2021) 1220.
[43] T. Parr, L. Da Costa, C. Heins, M. J. D. Ramstead, K. Friston, Memory
and markov blankets, Entropy 23 (9) (2021) 1105.
[44] N. Reid, Approximate likelihoods, Proceedings of the ICIAM (2015).
[45] C. S. Kim, Recognition dynamics in the brain under the free energy
principle, Neural computation 30 (10) (2018) 2616–2659.
[46] L. Da Costa, T. Parr, B. Sengupta, K. Friston, Neural dynamics under
active inference: Plausibility and eﬃciency of information processing,
Entropy 23 (4) (2021) 454.
[47] P. Vatiwutipong, N. Phewchean, Alternative way to derive the distribu-
tion of the multivariate ornstein–uhlenbeck process, Advances in Diﬀer-
ence Equations 2019 (1) (2019) 1–7.
[48] C. Godr`eche, J.-M. Luck, Characterising the nonequilibrium stationary
states of ornstein–uhlenbeck processes, Journal of Physics A: Mathe-
matical and Theoretical 52 (3) (2018) 035002.
[49] L. Da Costa, K. Friston, C. Heins, G. A. Pavliotis, Bayesian mechanics
for stationary processes, arXiv preprint arXiv:2106.13830 (2021).
[50] J. J. Climent, N. Thome, Y. Wei, A geometrical approach on generalized
inverses by neumann-type series, Linear algebra and its applications 332
(2001) 533–540.
[51] V. Raja, D. Valluri, E. Baggs, A. Chemero, M. L. Anderson, The markov
blanket trick: On the scope of the free energy principle and active in-
ference, Physics of Life Reviews (2021).
38

[52] J. Bruineberg, J. Kiverstein, E. Rietveld, The anticipating brain is not a
scientist: the free-energy principle from an ecological-enactive perspec-
tive, Synthese 195 (6) (2018) 2417–2444.
[53] A. Constant, A. Clark, K. J. Friston, Representation wars: Enacting
an armistice through active inference, Frontiers in Psychology 11 (2021)
3798.
[54] M. J. Ramstead, M. D. Kirchhoﬀ, A. Constant, K. J. Friston, Multi-
scale integration: beyond internalism and externalism, Synthese 198 (1)
(2021) 41–70.
[55] E. Di Paolo, E. Thompson, R. D. Beer, Laying down a forking
path: Incompatibilities between enaction and the free energy principle,
PsyArXiv (2021).
39

Appendix A. Mathematical deﬁnitions of main concepts of the
free energy principle
Perception-action partition. The FEP assumes that the system can
be decomposed into external, sensory, active and internal states, z = {y, s, a, x},
conﬁgured as a perception-action loop reﬂecting an interface mediating be-
tween ‘autonomous’ states (active and internal states {a, x}) and ‘non-autonomous’
states (external and sensory states {y, s}). This leads to describing the evo-
lution of the system as
dzt
dt =f(zt) + ωt,
(A.1)
f(zt) =


fy(yt, st, at)
fs(yt, st, at)
fa(st, at, xt)
fx(st, at, xt)

.
(A.2)
NESS and solenoidal ﬂows. The FEP assumes that the system will
reach a non-equilibrium steady state described by the probability density
function p(zt), which can be described using a SDE decomposition that sep-
arates the ﬂow into dissipative (−Γ∇zJ(zt)) and solenoidal (Q∇zJ(zt)) com-
ponents
f(zt) =(Q −Γ)∇zJ(zt),
(A.3)
J(zt) = −log p(zt),
(A.4)
The FEP makes some requirements about the solenoidal ﬂow matrix Q, as it
assumes it is state-independent (i.e. Q does not change with z) and that it
is sparse in the sense that couplings between some states (e.g. internal and
external) are zero (see 1).
Markov blanket. The steady state distribution of the system is de-
scribed in terms of a Markov blanket, where internal/external states are
independent when conditioned on its blanket states.
p(yt, xt|bt) = p(yt|bt)p(xt|bt).
(A.5)
Conditional synchronisation manifold. The FEP assumes that there
is a smooth and diﬀerentiable function, σ, which maps between the most
likely internal and external states given a blanket state,
my(bt) = σ(mx(bt)),
(A.6)
40

and the gradient ∇mxσ(mx) is invertible (i.e. (∇mxσ(mx))−1 exists). The
FEP generally refers to this mapping as a conditional synchronisation man-
ifold, and proposes that its existence allows to characterise the relationship
between (maximum a posteriori) internal and external states in terms of inter-
nal states ‘sensing’ or ‘tracking’ external states through the Markov blanket
[3].
Rate of change of the average. By virtue of the conditional synchro-
nisation manifold, the rate of change of the average internal and external
states of the system are connected by the gradients of the mapping function.
my(bt) = σ(mx(bt)) ⇒dmy(bt)
dt
= ∇mxσdmx(bt)
dt
.
(A.7)
Variational free energy. A system performing Bayesian inference tries
to minimize the surprise of observed states (−log p(b)), according to an
internal model. However, a system cannot access this surprise value without
complete knowledge of its environment, Bayesian inference prescribes to use a
lower bound of this surprise described by the variational free energy F(θ, b):
−log p(b) < F(θ, b) = −log p(b) + DKL(q(y|θ)||p(y|b)),
(A.8)
which is composed of the surprise plus a term capturing the distance from the
probability of external states given the blanket p(y|b) to an internal model
of the world q(y|θ) parametrized by θ.
Average ﬂow and the free energy gradient. The FEP proposes that
the evolution of internal and external states of a system can be described,
under a Gaussian approximation, as a gradient of the free energy of the
system respect to its suﬃcient statistics.
⟨fy(yt, bt)⟩bt =(Qyy −Γyy) ⟨∇yJ(zt)⟩bt
≈(Qyy −Γyy)∇myF(θ, b).
(A.9)
Then, the conditional synchronization manifold is proposed to connect the
internal and external average ﬂows (i.e. the gradients ∇my and ∇mx), sug-
gesting that internal states are behaving as if trying to perform Bayesian
inference over external states.
Appendix B. Solution of the linear Langevin dynamics.
We start with the Ornstein-Uhlenbeck process
dzt = J(zt −ρ)dt + dwt,
(B.1)
41

which can be approximated by the equivalent Langevin dynamics
dzt
dt = J(zt −ρ) + ωt,
(B.2)
where J is an n×n invertible real matrix, ρ is an n dimensional real vector, wt
is a standard n-dimensional Wiener process, ωt is a standard n-dimensional
Gaussian white noise with covariance matrix 2Γ.
The model can be solved using standard methods for systems of diﬀeren-
tial equations
e−Jtdzt
dt −e−JtJ(zt −ρ) =e−Jtωt,
(B.3)
d
dt(e−Jt(zt −ρ)) =e−Jtωt,
(B.4)
zt =eJt(z0 −ρ) + ρ +
Z t
0
dt′e−J(t′−t)ωt′.
(B.5)
This solution of the system [47, 48] yields statistical moments
mt =
Z
dωp(ω)zt
=eJtz0 + (I −eJt)ρ,
(B.6)
Σt =
Z
dωp(ω)(zt −mt)(zt −mt)⊺
=
Z
dωp(ω)
Z t
0
dt′
Z t
0
dt′′eJ(t−t′)ωt′ω⊺
t′′eJ⊺(t−t′′)
=2
Z t
0
dt′e−J(t′−t)Γe−J⊺(t′−t).
(B.7)
These equations are hard to solve analytically. However, we can ﬁnd the
diﬀerential equations that result in equivalent integrals, obtaining the time
evolution of statistical moments
dmt
dt
=eJtJ(z0 −ρ) = J(mt −ρ),
(B.8)
dΣzz,t
dt
=2Γ + Σzz,tJ⊺+ JΣzz,t.
(B.9)
42

At equilibrium or at the NESS, when the solution is unique, the system
stabilizes to the values that make the derivatives equal to zero
lim
t→∞mt =ρ,
(B.10)
lim
t→∞Σzz,t =Σ∗,
JΣ∗+ Σ∗J⊺+ 2Γ = 0.
(B.11)
where Σ∗can be found numerically solving the above continuous Lyapunov
equation (a particular case of a Sylvester equation). If J is symmetric, the
steady state of the system is a state of equilibrium with Σ∗= −J−1Γ. How-
ever, the FEP focuses instead on NESS, which are more appropriate for
describing living systems.
Appendix B.1. Weak coupling approximation
In order to study the solution at the NESS, we assume weak couplings of
the form J = −I + C, with C2 being small. We derive
2Γ = −JΣ∗−Σ∗J⊺= 2Σ∗−CΣ∗−Σ∗C⊺,
(B.12)
Σ∗=Γ + 1
2(CΣ∗+ Σ∗C⊺).
(B.13)
Recursively substituting Σ∗in the right-hand side with Γ + 1
2CΣ∗+ 1
2Σ∗C⊺,
we obtain the time series expansion
Σ∗=Γ + 1
2(CΓ + ΓC⊺) + 1
4
 C2Γ + 2CΓC⊺+ Γ(C⊺)2
+ 1
8
 C3Γ + 3C2ΓC⊺+ 3CΓ(C⊺)2 + Γ(C⊺)3
+ O(C4).
(B.14)
In the equilibrium case of symmetric couplings, the Hessian is trivially
H = JΓ−1. For systems at a NESS, for J = −I+C and under a uniform noise
Γ = ς−2I, the inverse covariance (Hessian) can be computed as a Neumann
43

series,
H = (Σ∗)−1 = ς−2
∞
X
k=0

−1
2(C + C⊺) −1
4
 C2 + 2CC⊺+ (C⊺)2
−1
8
 C3 + 3C2C⊺+ 3C(C⊺)2 + (C⊺)3
+ O(C4)
k
=ς−2I −ς−2
2 (C + C⊺) −ς−2
4
 C2 + 2CC⊺+ (C⊺)2
+ ς−2
4
 C2 + CC⊺+ C⊺C + (C⊺)2
−ς−2
8
 C3 + 3C2C⊺+ 3C(C⊺)2 + (C⊺)3
−ς−2
8
 C3 + C2C⊺+ CC⊺C + C(C⊺)2
+ C⊺C2 + C⊺CC⊺+ (C⊺)2C + (C⊺)3
+ ς−2
8

2C3 + 3C2C⊺+ 2CC⊺C + 3C(C⊺)2
+ C⊺C2 + 2C⊺CC⊺+ (C⊺)2C + 2(C⊺)3
+ O(C4)
=ς−2I −ς−2
2 (C + C⊺) + ς−2
4 (C⊺C −CC⊺)
+ ς−2
8 (C (C⊺C −CC⊺) + (C⊺C −CC⊺) C⊺)) + O(C4).
(B.15)
The submatrix of the Hessian for y, x couplings is
Hyx = −ς−2
4

CysC⊺
xs + CyaC⊺
xa

+ ς−2
8

Cya(−CaaC⊺
xa −CasC⊺
xs −CaxC⊺
xx + C⊺
aaCax −C⊺
aaC⊺
xa
−C⊺
saC⊺
xs + C⊺
xaCxx −C⊺
xaC⊺
xx)
+ Cys(−CsaC⊺
xa −CssC⊺
xs + C⊺
asCax −C⊺
asC⊺
xa −C⊺
ssC⊺
xs + C⊺
xs
Cxx −C⊺
xsC⊺
xx) + Cyy(−CyaC⊺
xa −CysC⊺
xs −C⊺
syC⊺
xs)
+ C⊺
sy(CsaC⊺
xa + CssC⊺
xs) + C⊺
yy(CyaC⊺
xa + CysC⊺
xs)

+ O(C4)
(B.16)
44

Appendix B.2. Solenoidal ﬂows
We can describe the surprise of the system and its gradient as
J(z) = −log p(z)
=1
2(z −mz)⊺Σ−1
zz (z −mz) + k
2 log (2π) + 1
2 log |Σzz|,
(B.17)
∇zJ(z) = (Σ∗)−1 (z −mz).
(B.18)
where we know from Eq. 25 that Σ∗= −2J−1Γ −J−1Σ∗J⊺.
At the NESS, the solution can be described in two terms consistent with
a SDE decomposition:
J(z −ρ) =(Q −Γ)(−2J−1Γ −J−1Σ∗J⊺)−1(z −ρ),
(B.19)
Q =Γ −J(2J−1Γ + J−1Σ∗J⊺) = −Σ∗J⊺−Γ = Γ + JΣ∗.
(B.20)
Rearranging the terms in the equation above to substitute Σ∗= J−1(Q−
Γ) we obtain the equivalence
JQ + QJ⊺= JΓ −ΓJ⊺,
(B.21)
which again takes the form of a continuous Lyapunov equation. This equation
can be solve numerically, or analytically using a power series expansion of
J = −I + C, expanding the expression
Q = 1
2(CΓ −ΓC⊺) + 1
2(CQ + QC⊺),
(B.22)
into the power series
Q = 1
2(CΓ −ΓC⊺) + 1
4
 C2Γ −Γ(C⊺)2
+ 1
8
 C3Γ + C2ΓC⊺−CΓ(C⊺)2 −Γ(C⊺)3
+ O(C4).
(B.23)
Appendix B.3. Mapping between the most likely internal and external states
If z can be divided into blanket states b, and internal/external states
h = {x, y}, the conditional distribution given blanket states is a Normal
distribution with moments
mh(bt) =ρh + Σ∗
hb (Σ∗
bb)g (bt −ρb),
(B.24)
Σhh(bt) =Σ∗
hh −Σ∗
hb (Σ∗
bb)g Σ∗
bh.
(B.25)
45

Note that the Markov blanket imposes that Σxy(bt) = Σyx(bt) = 0, since
x, y are conditionally independent.
Similarly, we can decompose h into an internal and external state
mx(bt) =ρx + Σ∗
xb (Σ∗
bb)g (bt −ρb),
(B.26)
my(bt) =ρy + Σ∗
yb (Σ∗
bb)g (bt −ρb).
(B.27)
If the mapping from b to x is injective (for this nx ≥nb is required), the ﬁrst
term can be rearranged into
bt −ρb = Σ∗
bb (Σ∗
xb)−1 (mx(bt) −ρx) ,
(B.28)
yielding
my(bt) =my + Σ∗
yb (Σ∗
bb)g Σ∗
bb (Σ∗
xb)−1 (mx(bt) −ρx) ,
=ρy + Σ∗
yb (Σ∗
xb)−1 (mx(bt) −ρx) ≡σ(mx(bt)),
(B.29)
which is a linear mapping of mx(bt) to my(bt).
mx(bt) =mx + Σ∗
xb (Σ∗
bb)g Σ∗
bb
 Σ∗
yb
−1 (my(bt) −my(bt))
=mx + Σ∗
xb
 Σ∗
yb
−1 (my(bt) −my(bt)) ≡σ−1(my(bt)).
(B.30)
In the NESS limit
dmy(bt)
dt
=Σ∗
yb (Σ∗
xb)−1 dmx(bt)
dt
= ∇mxσ(mx(bt))dmx(bt)
dt
.
(B.31)
Similarly, if the mapping from b to y is injective (for this ny ≥nb is required),
we can invert the relation
dmx(bt)
dt
=Σ∗
xb
 Σ∗
yb
−1 dmy(bt)
dt
= ∇myσ−1(my(bt))dmy(bt)
dt
.
(B.32)
Appendix C. How informative are conditional marginal ﬂows? A
minimal example
In order to illustrate the debate about how informative are average ﬂows,
we study a simple two-dimensional linear stochastic system
dyt
dt =Jyyyt + Jybbt + ωy,t,
(C.1)
dbt
dt =Jbyyt + Jbbbt + ωb,t,
(C.2)
46

which can be studied as the Langevin dynamics described in Appendix B.
We select a variance of ωy,t, ωb,t, ς2 = 1, and
J =
−1
1.2
−1
−1

.
(C.3)
The resulting covariance matrix is
Σ =
 0.9545
0.04545
0.04545
1.05455

.
(C.4)
Fig. C.1 displays an example of a trajectory of this system.
Appendix C.1. Conditional marginal ﬂows capture partial tendencies, not
real behaviour
Flows in the system are described as
fy(yt, bt) =Jyyyt + Jybbt,
(C.5)
fb(yt, bt) =Jbyyt + Jbbbt.
(C.6)
Following the results in Appendix B, conditional average ﬂows can be
described as
⟨fy(yt, bt)⟩bt =Jyymy(bt) + Jybbt
=
 JyyΣ∗
yb/Σ∗
bb + Jyb

bt,
(C.7)
⟨fy(yt, bt)⟩yt =
 Jyy + JybΣ∗
by/Σ∗
yy

yt,
(C.8)
⟨fb(yt, bt)⟩bt =
 JbyΣ∗
yb/Σ∗
bb + Jbb

bt,
(C.9)
⟨fb(yt, bt)⟩yt =
 Jby + JbbΣ∗
by/Σ∗
yy

yt.
(C.10)
In Fig. C.2.A we describe the ﬂow structure in the system, which describes
a spiral behaviour due to the non-equilibrium tendencies in the system. This
is an example of the solenoidal ﬂows captured by the matrix Q.
In contrast, Fig. C.2.B captures the marginal ﬂow structure when variable
b is ﬁxed. This separates tendencies in the system, resulting in a diverging
tendency for variable y (diverging to −∞for negative b and to +∞for
positive b. Similarly, combining cross marginal ﬂows (ﬁx b for the marginal
ﬂow of y and vice versa) result in another combination of partial tendencies as
shown in Fig. C.2.C. In this case, the rotation of solenoidal ﬂows is captured,
but no the attractor that structures this rotation into an spiral behaviour.
47

0
5
10
15
20
25
30
35
t
−2
0
2
y
−2
0
2
b
Figure C.1: Evolution of a bivariate linear stochastic system. Example trajectory
of the system described by Eq. C.2 with parameters ς = 1, Jyy = Jbb = −1, Jyb = 1.2,
Jby = −1.
In sum, conditonal marginal ﬂows do not capture the behaviour of the
system. Even if the ﬂows point in some direction (e.g. free energy mini-
mization) we cannot conclude that this is equivalent to the system behaving
‘as if’ following that particular direction. An alternative illustration of this
problem can be described by writing the conditional average ﬂow of y in
terms of the most likely state my(b)
⟨fy(yt, bt)⟩bt =
 Jyy + JybΣ∗
by/Σ∗
yy

my(bt).
(C.11)
Where the term
 Jyy + JybΣ∗
by/Σ∗
yy

is a positive constant (see Fig. C.3.B).
Following the logic of a relaxed interpretation of the FEP, this could be inter-
preted as a gradient ascent on m2
y(bt). However, as we see in the Fig. C.2.A
the real behaviour of the system will display a global attractor at y = b = 0
with solenoidal couplings, eventually minimizing m2
y(bt).
Appendix C.2. Rates of conditional averages are diﬀerent to conditional marginal
ﬂows
The second issue we illustrate in this simple system is the diﬀerence be-
tween conditional marginal ﬂows and the dynamics of the most likely states.
From Appendix B we can derive
dmy(bt)
dt
=Σ∗
yb/Σ∗
bb
dbt
dt = Σ∗
yb/Σ∗
bb (Jbyyt + Jbbbt + ςωb,t) .
(C.12)
48

A
B
C
−2
0
2
b
−3
−2
−1
0
1
2
3
y
fy(y, b), fb(y, b)
−2
0
2
b
−3
−2
−1
0
1
2
3
y
⟨fy(yt, bt)⟩bt, ⟨fb(yt, bt)⟩bt
−2
0
2
b
−3
−2
−1
0
1
2
3
y
⟨fy(yt, bt)⟩bt, ⟨fb(yt, bt)⟩yt
Figure C.2: Flow structure vs conditional average ﬂow structure of the system.
Comparison between the ﬂow structure in the system displaying a spiral behaviour (A),
the conditional average ﬂows when variable b is ﬁxed, displaying divergent tendencies in y
and convergent tendencies in b (B), and the cross conditional average ﬂow when variable b
is ﬁxed for fy and variable y is ﬁxed for fb, displaying rotation without an attractor (B).
For a ﬁxed b, this variable is distributed as a Normal distribution N(u, s),
with mean and standard deviation
u =Σ∗
yb/Σ∗
bbJbymy(b),
(C.13)
s =Σ∗
yb/Σ∗
bb

Jby(Σ∗
yy −Σ∗
ybΣ∗
by/Σ∗
bb) +
√
2ςsω

,
(C.14)
where sω is the standard deviation of the noise introduced in the Langevin
dynamics (described as
q
1
dt).
For a range of values of b, Fig. C.3 captures the conditional average ﬂows
⟨fy(yt, bt)⟩bt (solid dark line), and the distribution of the derivatives of the
conditional average state dmy(bt)
dt
(the mean is represented by the dashed line
and error bars of three standard deviations by the light area). As we can
observe, the dependency with my(b) is positive with respect to ⟨fy(yt, bt)⟩bt
(indicating a gradient ascent on m2
y(b)) while the true dynamics is captured
by the negative dependency between dmy(bt)
dt
and my(b) (indicating a gradient
descent on m2
y(b)). Note that for diﬀerent parameters the sign of the slope of
⟨fy(yt, bt)⟩bt can change (being negative or positive) but the slope of dmy(bt)
dt
is always negative, given the presence of a global attractor. This shows how,
even in very simple examples, these quantities can have radically diﬀerent
49

A
B
−3
−2
−1
0
1
2
3
b
−3
−2
−1
0
1
2
3
⟨fy(yt, bt)⟩bt
−3
−2
−1
0
1
2
3
dmy(bt)
dt
−0.10 −0.05
0.00
0.05
0.10
my(b)
−3
−2
−1
0
1
2
3
⟨fy(yt, bt)⟩bt
−3
−2
−1
0
1
2
3
dmy(bt)
dt
Figure C.3: Rate of conditional averages versus conditional average ﬂows. The
conditional average ﬂow of y ﬁxing b, ⟨fy(yt, bt)⟩yt, is represented by the solid dark line.
The rate of change of the conditional average my(bt)
dt
is represented by the dashed line
(representing its average value for a given b, and the light area (representing error bars for
3 standard deviations for a ﬁxed b.). These quantities are represented with respect to a b
axis (A) and a my(b) axis (B), as one is a linear transformation of the other.
behaviours and that the conditional average ﬂow does not necessarily capture
the true behaviour of a system.
50

