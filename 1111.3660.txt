arXiv:1111.3660v1  [math.AG]  15 Nov 2011
POSITROID VARIETIES: JUGGLING AND GEOMETRY
ALLEN KNUTSON, THOMAS LAM, AND DAVID E SPEYER
ABSTRACT. While the intersection of the Grassmannian Bruhat decompositions for all co-
ordinate ï¬‚ags is an intractable mess, the intersection of only the cyclic shifts of one Bruhat
decomposition turns out to have many of the good properties of the Bruhat and Richardson
decompositions.
This decomposition coincides with the projection of the Richardson stratiï¬cation of the
ï¬‚ag manifold, studied by Lusztig, Rietsch, Brown-Goodearl-Yakimov and the present au-
thors. However, its cyclic-invariance is hidden in this description. Postnikov gave many
cyclic-invariant ways to index the strata, and we give a new one, by a subset of the afï¬ne
Weyl group we call bounded juggling patterns. We call the strata positroid varieties.
Applying results from [KnLamSp], we show that positroid varieties are normal, Cohen-
Macaulay, have rational singularities, and are deï¬ned as schemes by the vanishing of
PlÂ¨ucker coordinates. We prove that their associated cohomology classes are represented
by afï¬ne Stanley functions. This latter fact lets us connect Postnikovâ€™s and Buch-Kresch-
Tamvakisâ€™ approaches to quantum Schubert calculus.
CONTENTS
1.
Introduction, and statement of results
1
2.
Some combinatorial background
7
3.
Afï¬ne permutations, juggling patterns and positroids
9
4.
Background on Schubert and Richardson varieties
19
5.
Positroid varieties
20
6.
Examples of positroid varieties
27
7.
The cohomology class of a positroid variety
28
8.
Quantum cohomology, toric Schur functions, and positroids
35
References
41
1. INTRODUCTION, AND STATEMENT OF RESULTS
1.1. Some decompositions of the Grassmannian. This paper is concerned with the geo-
metric properties of a stratiï¬cation of the Grassmannian studied in [Lus98, Pos, Rie06,
BroGooYa06, Wi07]. It ï¬ts into a family of successively ï¬ner decompositions:
{Bruhat cells}, {open Richardson varieties}, {open positroid varieties}, {GGMS strata}.
We discuss the three known ones in turn, and then see how the family of positroid vari-
eties ï¬ts in between.
Date: November 17, 2011.
AK was partially supported by NSF grant DMS-0604708.
TL was partially supported by NSF grants DMS-0600677, DMS-0652641, and DMS-0901111, and by a
Sloan Fellowship.
DES was supported by a Research Fellowship from the Clay Mathematics Institute.
1

The Bruhat decomposition of the Grassmannian of k-planes in n-space dates back, despite
the name, to Schubert in the 19th century. It has many wonderful properties:
â€¢ the strata are easily indexed (by partitions in a k Ã— (n âˆ’k) box)
â€¢ it is a stratiï¬cation: the closure (a Schubert variety) of one open stratum is a union
of others
â€¢ each stratum is smooth and irreducible (in fact a cell)
â€¢ although the closures of the strata are (usually) singular, they are not too bad: they
are normal and Cohen-Macaulay, and even have rational singularities.
The Bruhat decomposition is deï¬ned relative to a choice of coordinate ï¬‚ag, essentially
an ordering on the basis elements of n-space. The Richardson decomposition is the common
reï¬nement of the Bruhat decomposition and the opposite Bruhat decomposition, using the
opposite order on the basis. Again, many excellent properties hold for this ï¬ner decom-
position:
â€¢ it is easy to describe the nonempty intersections of Bruhat and opposite Bruhat
strata (they correspond to nested pairs of partitions)
â€¢ it is a stratiï¬cation, each open stratum is smooth and irreducible, and their closures
are normal and Cohen-Macaulay with rational singularities [Bri02].
At this point one might imagine intersecting the Bruhat decompositions relative to all
the coordinate ï¬‚ags, so as not to prejudice one over another. This gives the GGMS decom-
position of the Grassmannian [GeGorMacSe87], and as it turns out, these good intentions
pave the road to Hell:
â€¢ it is infeasible to index the nonempty strata [Va78]
â€¢ it is not a stratiï¬cation [GeGorMacSe87, Â§5.2]
â€¢ the strata can have essentially any singularity [Mn88]. In particular, the nonempty
ones need not be irreducible, or even equidimensional.
This raises the question: can one intersect more than two permuted Bruhat decomposi-
tions, keeping the good properties of the Bruhat and Richardson decompositions, without
falling into the GGMS abyss?
The answer is yes: we will intersect the n cyclic permutations of the Bruhat decompo-
sition. That is to say, we will deï¬ne an open positroid variety to be an intersection of n
Schubert cells, taken with respect to the the n cyclic rotations of the standard ï¬‚ag. We
will deï¬ne a positroid variety to be the closure of an open positroid variety. See section 5
for details.
It is easy to show, though not immediately obvious, that this reï¬nes the Richardson
decomposition. It is even less obvious, though also true, that the open positroid varieties
are smooth and irreducible (as we discuss in Section 5.4).
There is a similar decomposition for any partial ï¬‚ag manifold G/P, the projection of
the Richardson stratiï¬cation from G/B. That decomposition arises in the study of several
seemingly independent structures:
â€¢ total nonnegativity, in e.g. [Lus98, Pos, Rie06], see Â§1.2;
â€¢ prime ideals in noncommutative deformations of G/P (though worked out only
for the Grassmannian, in [LauLeRig08]), and a semiclassical version thereof in
Poisson geometry [BroGooYa06, GooYa];
â€¢ the characteristic p notion of Frobenius splitting ([KnLamSp]).
2

We show that the positroid stratiï¬cation and the projected Richardson stratiï¬cation
coincide. Speciï¬cally, we prove:
Theorem (Theorem 5.9). If Xw
u is a Richardson variety in the full ï¬‚ag manifold (u, w âˆˆSn), then
its image under projection to Gr(k, n) is a positroid variety. If w is required to be a Grassmannian
permutation, then every positroid variety arises uniquely this way.
Theorem 5.9 has been suspected, but has not previously been proved in print, and is
surprisingly difï¬cult in its details. This result was already known on the positive part of
Gr(k, n), as we explain in Remark 1.2.
Once we know that positroid varieties are projected Richardson varieties, the follow-
ing geometric properties follow from the results of [KnLamSp]. Part (1) of the following
Theorem was also established by Billey and Coskun [BiCo] for projected Richardson va-
rieties.
Theorem ([KnLamSp] and Theorem 5.15).
(1) Positroid varieties are normal and Cohen-Macaulay, with rational singularities.
(2) Though positroid varieties are deï¬ned as the closure of the intersection of n cyclically per-
muted Bruhat cells, they can also be deï¬ned (even as schemes) as the intersection of the n
cyclically permuted Schubert varieties. In particular, each positroid variety is deï¬ned as a
scheme by the vanishing of some PlÂ¨ucker coordinates.
Theorem ([KnLamSp]). The standard Frobenius spliting on the Grassmannian compatibly splits
all positroid varieties. Furthermore, positroid varieties are exactly the compatibly split subvarieties
of the Grassmannian.
Before going on, we mention a very general construction given two decompositions
{Ya}aâˆˆA,{Zb}bâˆˆB of a scheme X, one reï¬ning the other. Assume that
â€¢ X = `
A Ya = `
B Zb,
â€¢ for each a âˆˆA, there exists a subset Ba âŠ†B such that Ya = `
Ba Zb,
â€¢ each Ya is irreducible (hence nonempty), and each Zb is nonempty. (We do not
assume that each Zb is irreducible.)
Then there is a natural surjection B Ö‰ A taking b to the unique a such that Zb âŠ†Ya,
and a natural inclusion A Ö’â†’B taking a to the unique b âˆˆBa such that Zb is open in
Ya. (Moreover, the composite A Ö’â†’B Ö‰ A is the identity.) We will call the map B Ö‰ A
the A-envelope, and will generally use the inclusion A Ö’â†’B to identify A with its image.
Post this identiï¬cation, each a âˆˆA corresponds to two strata Ya, Za, and we emphasize
that these are usually not equal; rather, one only knows that Ya contains Za densely.
To each GGMS stratum X, one standardly associates the set of coordinate k-planes that
are elements of X, called the matroid of X. (While â€œmatroidâ€ has many simple deï¬nitions,
this is not one of them; only realizable matroids arise this way, and characterizing them
is essentially out of reach [Va78].) It is a standard, and easy, fact that the matroid charac-
terizes the stratum, so via the A Ö’â†’B yoga above, we can index the strata in the Schubert,
Richardson, and positroid decompositions by special classes of matroids. Schubert ma-
troids have been rediscovered many times in the matroid literature (and renamed each
time; see [BoDM06]). Richardson matroids are known as lattice path matroids [BoDM06].
The matroids associated to the open positroid varieties are exactly the positroids [Pos]
(though Postnikovâ€™s original deï¬nition was different, and we give it in the next section).
3

In our context, the observation two paragraphs above says that if a matroid M is a
positroid, then the positroid stratum of M is usually not the GGMS stratum of M, but
only contains it densely.
Remark 1.1. For each positroid M, Postnikov gives many parametrizations by Râ„“
+ of the
totally nonnegative part (whose deï¬nition we will recall in the next section) of the GGMS
stratum of M. Each parametrization extends to a rational map (CÃ—)â„“â†’Gr(k, n); if we
use the parametrization coming (in Postnikovâ€™s terminology) from the Le-diagram of M
then this map is well deï¬ned on all of (CÃ—)â„“. The image of this map is neither the GGMS
stratum nor the positroid stratum of M (although the nonnegative parts of all three coin-
cide). For example, if (k, n) = (2, 4) and M is the â€œuniformâ€ matroid in which any two
elements of [4] are independent, this parametrization is
(a, b, c, d) 7â†’(p12 : p13 : p14 : p23 : p24 : p34) = (1 : d : cd : bd : (a + 1)bcd : abcd2).
The image of this map is the open set where p12, p13, p14, p23 and p34 are nonzero. It is
smaller than the positroid stratum, where p13 can be zero. The image is larger than the
GGMS stratum, where p24 is also nonzero.
One may regard this, perhaps, as evidence that matroids are a philosophically incorrect
way to index the strata. We shall see another piece of evidence in Remark 5.17.
1.2. Juggling patterns, afï¬ne Bruhat order, and total nonnegativity. We now give a low-
brow description of the decomposition we are studying, from which we will see a natural
indexing of the strata.
Start with a k Ã— n matrix M of rank k (â‰¤n), and think of it as a list of column vectors
âƒ—v1, . . .,âƒ—vn. Extend this to an inï¬nite but repeating list . . . ,âƒ—vâˆ’1,âƒ—v0,âƒ—v1, . . . ,âƒ—vn,âƒ—vn+1, . . . where
âƒ—vi = âƒ—vj if i â‰¡j mod n. Then deï¬ne a function f : Z â†’Z by
f(i) = min {j â‰¥i : âƒ—vi âˆˆspan({âƒ—vi+1,âƒ—vi+2, . . .,âƒ—vj)}
Since âƒ—vn+i = âƒ—vi, each f(i) â‰¤n + i, and each f(i) â‰¥i with equality only if âƒ—vi = âƒ—0. It is fun to
prove that f must be 1 : 1, and has enough ï¬niteness to then necessarily be onto as well.
Permutations of Z satisfying f(i +n) = f(i) +n âˆ€i are called afï¬ne permutations, and the
group thereof can be identiï¬ed with the afï¬ne Weyl group of GLn (see e.g. [EhRe96]).
This association of an afï¬ne permutation to each k Ã— n matrix of rank k depends only
on the k-plane spanned by the rows, and so descends to Gr(k, n), where it provides a
complete combinatorial invariant of the strata in the cyclic Bruhat decomposition.
Theorem (Theorem 3.16, Corollary 3.17). 1 This map from the set of positroid strata to the
afï¬ne Weyl group is order-preserving, with respect to the closure order on positroid strata (Post-
nikovâ€™s cyclic Bruhat order) and the afï¬ne Bruhat order, and identiï¬es the set of positroids with
a downward Bruhat order ideal.
Consequently, the cyclic Bruhat order is Eulerian and EL-shellable (as shown by hand already
in [Wi07]).
We interpret these f physically as follows. Consider a juggler who is juggling k balls,
one throw every second, doing a pattern of period n. At time i âˆˆZ, they throw a ball
1This result is extended to projected Richardson varieties in partial ï¬‚ag varieties G/P of arbitrary type
by He and Lam [HeLa].
4

that lands shortly2 before, to be thrown again at, time f(i). No two balls land at the same
time, and there is always a ball available for the next throw. If we let ti = f(i) âˆ’i be the
throw at time i, this cyclic list of n numbers (t1, . . . , tn) is a juggling pattern3 or siteswap (for
which our references are [Pol03, Kn93]; see also [BuEiGraWr94, EhRe96, War05, ChGra07,
ChGra08]). This mathematical model of juggling was developed by several groups of
jugglers independently in 1985, and is of great practical use in the juggling community.
If M is generic, then the pattern is the lowest-energy pattern, where every throw is a
k-throw.4 At the opposite extreme, imagine that M only has entries in some k columns.
Then n âˆ’k of the throws are 0-throws, and k are n-throws.5
If one changes the cyclic action slightly, by moving the ï¬rst column to the end and mul-
tiplying it by (âˆ’1)kâˆ’1, then one preserves the set of real matrices for which every k Ã— k
submatrix has nonnegative determinant. This, by deï¬nition, lies over the totally non-
negative part Gr(k, n)â‰¥0 of the Grassmannian. (This action may have period either n or
2n up on matrices, but it always has period n down on the Grassmannian.) Postnikovâ€™s
motivation was to describe those matroids whose GGMS strata intersect this totally non-
negative part; it turns out that they are exactly the positroids, and the totally nonnegative
part of each open positroid stratum is homeomorphic to a ball.
Remark 1.2. Now that we have deï¬ned the totally nonnegative part of the Grassmannian,
we can explain the antecedents to Theorem 5.9. Postnikov ([Pos]) deï¬ned the totally
nonnegative part of the Grassmannian as we have done above, by nonnegativity of all
minors. Lusztig ([Lus98]) gave a different deï¬nition which applied to any G/P. That the
two notions agree is not obvious, and was established in [Rie09]. In particular, the cyclic
symmetry seems to be special to Grassmannians.6
Lusztig, using his deï¬nition, gave a stratiï¬cation of (G/P)â‰¥0 by the projections of Richard-
son varieties. Theorem 3.8 of [Pos] (which relies on the results of [MarRie04] and [RieWi08])
states that Postnikovâ€™s and Lusztigâ€™s stratiï¬cations of Gr(k, n)â‰¥0 coincide. This result says
nothing about how the stratiï¬cations behave away from the totally nonnegative region.
Theorem 5.9 can be thought of as a complex analogue of [Pos, Theorem 3.8]; it implies but
does not follow from [Pos, Theorem 3.8].
We thank Konni Rietsch for helping us to understand the connections between these
results.
1.3. Afï¬ne permutations, and the associated cohomology class of a positroid variety.
Given a subvariety X of a Grassmannian, one can canonically associate a symmetric poly-
nomial in k variables, in a couple of equivalent ways:
(1) Sum, over partitions Î» with |Î»| = codim X, the Schur polynomial SÎ»(x1, . . . , xk)
weighted by the number of points of intersection of X with a generic translate
2almost exactly at time f(i) âˆ’1
2, according to video analysis of competent jugglers
3Not every juggling pattern arises this way; the patterns that arise from matrices can only have throws
of height â‰¤n. This bound is very unnatural from the juggling point of view, as it excludes the standard
3-ball cascade (t1 = 3) with period n = 1.
4These juggling patterns are called â€œcascadesâ€ for k odd and â€œ(asynchronous) fountainsâ€ for k even.
5These are not the most excited k-ball patterns of length n; those would each have a single kn-throw, all
the others being 0-throws. But juggling patterns associated to matrices must have each ti â‰¤n.
6Milen Yakimov has proven the stronger result that the standard Poisson structure on Gr(k, n), from
which the positroid stratiï¬cation can be derived, is itself cyclic-invariant [Ya10].
5

of XÎ»c (the Schubert variety associated to the complementary partition inside the
k Ã— (n âˆ’k) rectangle).
(2) Take the preimage of X in the Stiefel manifold of k Ã— n matrices of rank k, and the
closure X inside k Ã— n matrices. (In the k = 1 case this is the afï¬ne cone over a
projective variety, and it seems worth it giving the name â€œStiefel coneâ€ in general.)
This has a well-deï¬ned class in the equivariant Chow ring Aâˆ—
GL(k)(CkÃ—n), which is
naturally the ring of symmetric polynomials in k variables.
The most basic case of X is a Schubert variety XÎ», in which case these recipes give the
Schur polynomial SÎ». More generally, the ï¬rst construction shows that the symmetric
polynomial must be â€œSchur-positiveâ€, meaning a positive sum of Schur polynomials.
In reverse, one has ring homomorphisms
{symmetric functions} Ö‰ Z[x1, . . ., xk]Sk âˆ¼= Aâˆ—
GL(k)(CkÃ—n) Ö‰ Aâˆ—
GL(k)(Stiefel) âˆ¼= Aâˆ—(Gr(k, n))
and one can ask for a symmetric function f whose image is the class [X].
Theorem (Theorem 7.17). The cohomology class associated to a positroid variety can be repre-
sented by the afï¬ne Stanley function of its afï¬ne permutation, as deï¬ned in [Lam06].
This is a surprising result in that afï¬ne Stanley functions are not Schur-positive in gen-
eral, even for this restricted class of afï¬ne permutations. Once restricted to the variables
x1, . . ., xk, they are! In Theorem 7.12 we give a much stronger abstract positivity result,
for positroid classes in T-equivariant K-theory.
Our proof of Theorem 7.1 is inductive. In future work, we hope to give a direct geomet-
ric proof of this and Theorem 3.16, by embedding the Grassmannian in a certain subquo-
tient of the afï¬ne ï¬‚ag manifold, and realizing the positroid decomposition as the trans-
verse pullback of the afï¬ne Bruhat decomposition.
1.4. Quantum cohomology and toric Schur functions. In [BucKresTam03], Buch, Kresch,
and Tamvakis related quantum Schubert calculus on Grassmannians to ordinary Schubert
calculus on 2-step partial ï¬‚ag manifolds. In [Pos05], Postnikov showed that the structure
constants of the quantum cohomology of the Grassmannian were encoded in symmetric
functions he called toric Schur polynomials. We connect these ideas to positroid varieties:
Theorem (Theorem 8.1). Let S âŠ‚Gr(k, n) be the union of all genus-zero stable curves of degree
d which intersect a ï¬xed Schubert variety X and opposite Schubert variety Y. Suppose there
is a non-trivial quantum problem associated to X, Y and d. Then S is a positroid variety: as a
projected Richardson variety it is obtained by a pull-push from the 2-step ï¬‚ag variety considered
in [BucKresTam03]. Its cohomology class is given by the toric Schur polynomial of [Pos05].
The last statement of the theorem is consistent with the connection between afï¬ne Stan-
ley symmetric functions and toric Schur functions (see [Lam06]).
7 Snider [Sni10] has given a direct geometric explanation of this result by identifying afï¬ne patches on
Gr(k, n) with opposite Bruhat cells in the afï¬ne ï¬‚ag manifold, in a way that takes the positroid stratiï¬cation
to the Bruhat decomposition. Also, an analogue of this result for projected Richardson varieties in an
arbitrary G/P is established by He and Lam [HeLa]: the connection with symmetric functions is absent, but
the cohomology classes of projected Richardson varieties and afï¬ne Schubert varieties are compared via
the afï¬ne Grassmannian.
6

Acknowledgments. Our primary debt is of course to Alex Postnikov, for getting us ex-
cited about positroids. We also thank Michel Brion, Leo Mihalcea, Su-Ho Oh, Konni Ri-
etsch, Frank Sottile, Ben Webster, Lauren Williams, and Milen Yakimov for useful conver-
sations.
2. SOME COMBINATORIAL BACKGROUND
Unless otherwise speciï¬ed, we shall assume that nonnegative integers k and n have
been ï¬xed, satisfying 0 â‰¤k â‰¤n.
2.1. Conventions on partitions and permutations. For integers a and b, we write [a, b]
to denote the interval {a, a + 1, . . ., b}, and [n] to denote the initial interval {1, 2, . . ., n}. If
i âˆˆZ, we let Â¯i âˆˆ[n] be the unique integer satisfying i â‰¡Â¯i mod n. We write
 S
k

for the set
of k-element subsets of S. Thus
 [n]
k

denotes the set of k-element subsets of {1, 2, . . ., n}.
As is well known, there is a bijection between
 [n]
k

and the partitions of Î» contained in
a k Ã— (n âˆ’k) box. There are many classical objects, such as Schubert varieties, which can
be indexed by either of these
 n
k

-element sets. We will favor the indexing set
 [n]
k

, and
will only discuss the indexing by partitions when it becomes essential, in Â§7.
We let Sn denote the permutations of the set [n]. A permutation w âˆˆSn is written in
one-line notation as [w(1)w(2) Â· Â· Â·w(n)]. Permutations are multiplied from right to left
so that if u, w âˆˆSn, then (uw)(i) = u(w(i)). Thus multiplication on the left acts on
values, and multiplication on the right acts on positions. Let w âˆˆSn be a permutation.
An inversion of w is a pair (i, j) âˆˆ[n] Ã— [n] such that i < j and w(i) > w(j). The length
â„“(w) of a permutation w âˆˆSn is the number of its inversions. A factorization w = uv is
called length-additive if â„“(w) = â„“(u) + â„“(v).
The longest element [n(n âˆ’1) Â· Â· Â·1] of Sn is denoted w0. The permutation [234 Â· Â· Â·n1]
is denoted Ï‡ (for Coxeter element). As a Coxeter group, Sn is generated by the simple
transpositions {si = [12 Â· Â· Â·(i âˆ’1)(i + 1)i(i + 2) Â· Â· Â·n]}.
For k âˆˆ[0, n], we let Sk Ã— Snâˆ’k âŠ†Sn denote the parabolic subgroup of permutations
which send [k] to [k] and [k + 1, n] to [k + 1, n]. A permutation w âˆˆSn is called Grass-
mannian (resp. anti-Grassmannian) if it is minimal (resp. maximal) length in its coset
w(Sk Ã— Snâˆ’k); the set of such permutations is denoted Smin
n,k (resp. Smax
n,k ).
If w âˆˆSn and k âˆˆ[0, n], then Ïƒk(w) âˆˆ
 [n]
k

denotes the set w([k]). Often, we just write Ïƒ
for Ïƒk when no confusion will arise. The map Ïƒk : Sn â†’
 [n]
k

is a bijection when restricted
to Smin
n,k .
2.2. Bruhat order and weak order. We deï¬ne a partial order â‰¤on
 [n]
k

as follows. For
I = {i1 < i2 < Â· Â· Â· < ik} and J = {j1 < j2 Â· Â· Â· < jk} âˆˆ
 [n]
k

, we write I â‰¤J if ir â‰¤jr for r âˆˆ[k].
We shall denote the Bruhat order, also called the strong order, on Sn by â‰¤and â‰¥. One
has the following well known criterion for comparison in Bruhat order: if u, w âˆˆSn then
u â‰¤w if and only if u([k]) â‰¤w([k]) for each k âˆˆ[n]. Covers in Bruhat order will be
denoted by â‹–and â‹—. The map Ïƒk : (Smin
n,k , â‰¤) â†’
 [n]
k

, â‰¤

is a poset isomorphism.
The (left) weak order â‰¤weak on Sn is the transitive closure of the relations
w â‰¤weak siw if â„“(siw) = â„“(w) + 1.
The weak order and Bruhat order agree when restricted to Smin
n,k .
7

2.3. k-Bruhat order and the poset Q(k, n). The k-Bruhat order [BeSo98, LasSchÂ¨u82] â‰¤k
on Sn is deï¬ned as follows. Let u and w be in Sn. Then u k-covers w, written u â‹—k w,
if and only if u â‹—w and Ïƒk(u) Ì¸= Ïƒk(w). The k-Bruhat order is the partial order on Sn
generated by taking the transitive closure of these cover relations (which remain cover
relations). We let [u, w]k âŠ‚Sn denote the interval of Sn in k-Bruhat order. It is shown in
[BeSo98] that every interval [u, w]k in (Sn, â‰¤k) is a graded poset with rank â„“(w)âˆ’â„“(u). We
have the following criterion for comparison in k-Bruhat order.
Theorem 2.1 ([BeSo98, Theorem A]). Let u, w âˆˆSn. Then u â‰¤k w if and only if
(1) 1 â‰¤a â‰¤k < b â‰¤n implies u(a) â‰¤w(a) and u(b) â‰¥w(b).
(2) If a < b, u(a) < u(b), and w(a) > w(b), then a â‰¤k < b.
Deï¬ne an equivalence relation on the set of k-Bruhat intervals, generated by the re-
lations that [u, w]k âˆ¼[x, y]k if there is a z âˆˆSk Ã— Snâˆ’k so that we have length-additive
factorizations uz = x and wz = y. If u â‰¤k w, we let âŸ¨u, wâŸ©denote the equivalence class
containing [u, w]k. Let Q(k, n) denote the equivalence classes of k-Bruhat intervals.
We discuss this construction in greater generality in [KnLamSp, Â§2]. To obtain the cur-
rent situation, specialize the results of that paper to (W, WP) = (Sn, Sk Ã—Snâˆ’k). The results
we describe here are all true in that greater generality.
Proposition 2.2. If [u1, w1] âˆ¼[u2, w2] then uâˆ’1
1 u2 = wâˆ’1
1 w2 and this common ratio is in Sk Ã—
Snâˆ’k. Also â„“(w1) âˆ’â„“(w2) = â„“(u1) âˆ’â„“(u2).
Proof. This is obvious for the deï¬ning equivalences and is easily seen to follow for a chain
of equivalences.
â–¡
We will prove a converse of this statement below as Proposition 2.4. The reader may
prefer this deï¬nition of âˆ¼.
Proposition 2.3. Every equivalence class in Q(k, n) has a unique representative of the form
[uâ€², wâ€²] where wâ€² is Grassmannian. If [u, w] is a k-Bruhat interval, and [uâ€², wâ€²] is equivalent to
[u, w] with wâ€² Grassmannian, then we have length-additive factorizations u = uâ€²z and w = wâ€²z
with z âˆˆSk Ã— Snâˆ’k.
Proof. See [KnLamSp, Lemma 2.4] for the existence of a representative of this form. If
[uâ€², wâ€²] and [uâ€²â€², wâ€²â€²] are two such representatives, then (wâ€²)âˆ’1wâ€²â€² is in Sk Ã— Snâˆ’k and both
wâ€² and wâ€²â€² are Grassmannian, so wâ€² = wâ€²â€². Then (uâ€²)âˆ’1uâ€²â€² = (wâ€²)âˆ’1wâ€²â€² = e so uâ€² = uâ€²â€² and
we see that the representative is unique.
Finally, let [uâ€², wâ€²] be the representative with wâ€² Grassmannian, and let [u, w] âˆ¼[uâ€², wâ€²].
Set z = (uâ€²)âˆ’1u = (wâ€²)âˆ’1w with z âˆˆSk Ã— Snâˆ’k. Since wâ€² is Grassmannian, we have
â„“(w) = â„“(wâ€²) + â„“(z). Then the equation â„“(w) âˆ’â„“(wâ€²) = â„“(u) âˆ’â„“(uâ€²) from Proposition 2.2
shows that â„“(u) = â„“(uâ€²) + â„“(z) as well. So the products u = uâ€²z and w = wâ€²z are both
length-additive, as desired.
â–¡
We can use this observation to prove a more computationally useful version of the
equivalence relation:
Proposition 2.4. Given two k-Bruhat intervals [u1, w1] and [u2, w2], we have [u1, w1] âˆ¼[u2, w2]
if and only if uâˆ’1
1 u2 = wâˆ’1
1 w2 and common ratio lies in Sk Ã— Snâˆ’k.
8

Proof. The forward implication is Proposition 2.2. For the reverse implication, let [u1, w1]
and [u2, w2] be as stated. Let [uâ€²
1, wâ€²
1] and [uâ€²
2, wâ€²
2] be the representatives with wâ€²
i Grass-
mannian. Since (wâ€²
1)âˆ’1wâ€²
2 is in Sk Ã— Snâˆ’k, and both wâ€²
i are Grassmannian, then wâ€²
1 = wâ€²
2.
Since (uâ€²
1)âˆ’1uâ€²
2 = (wâ€²
1)âˆ’1wâ€²
2 = e, we deduce that uâ€²
1 = uâ€²
2. So [u1, w1] âˆ¼[uâ€²
1, wâ€²
1] = [uâ€²
2, wâ€²
2] âˆ¼
[u2, w2] and we have the reverse implication.
â–¡
We also cite:
Theorem 2.5 ([BeSo98, Theorem 3.1.3]). If u â‰¤k w and x â‰¤k y with wuâˆ’1 = yxâˆ’1, then the
map v 7â†’vuâˆ’1x induces an isomorphism of graded posets [u, w]k â†’[x, y]k.
We equip Q(k, n) with a partial order â‰¤given by qâ€² â‰¤q if and only if there are repre-
sentatives [u, w]k âˆˆq and [uâ€², wâ€²]k âˆˆqâ€² so that [uâ€², wâ€²] âŠ†[u, w]. This partial order was
studied by Rietsch [Rie06], see also [Wi07, GooYa].
The poset Q(2, 4) already has 33 elements; its Hasse diagram appears in [Wi07]. See
also Figure 1.
3. AFFINE PERMUTATIONS, JUGGLING PATTERNS AND POSITROIDS
Fix integers 0 â‰¤k â‰¤n. In this section, we will deï¬ne several posets of objects and prove
that the posets are all isomorphic. We begin by surveying the posets we will consider.
The objects in these posets will index positroid varieties, and all of these indexing sets
are useful. All the isomorphisms we deï¬ne are compatible with each other. Detailed
deï¬nitions, and the deï¬nitions of the isomorphisms, will be postponed until later in the
section.
We have already met one of our posets, the poset Q(k, n) from Â§2.3.
The next poset will be the poset Bound(k, n) of bounded afï¬ne permutations: these are
bijections f : Z â†’Z such that f(i + n) = f(i) + n, i â‰¤f(i) â‰¤f(i) + n and (1/n) Pn
i=1(f(i) âˆ’
i) = k. After that will be the poset Jugg(k, n) of bounded juggling patterns. The elements
of this poset are n-tuples (J1, J2, . . ., Jn) âˆˆ
 [n]
k
n such that Ji+1 âŠ‡(Ji \ {1}) âˆ’1, where the
subtraction of 1 means to subtract 1 from each element and our indices are cyclic modulo
n. These two posets are closely related to the posets of decorated permutations and of
Grassmann necklaces, considered in [Pos].
We next consider the poset of cyclic rank matrices. These are inï¬nite periodic matrices
which relate to bounded afï¬ne permutations in the same way that Fultonâ€™s rank matrices
relate to ordinary permutations. Finally, we will consider the poset of positroids. Intro-
duced in [Pos], these are matroids which obey certain positivity conditions.
The following is a combination of all the results of this section:
Theorem 3.1. The posets Q(k, n), Bound(k, n), Jugg(k, n), the poset of cylic rank matrices of
type (k, n) and the poset of positroids of rank k on [n] are all isomorphic.
The isomorphism between Bound(k, n) and cyclic rank matrices is Corollary 3.12; the
isomorphism between Jugg(k, n) and Bound(k, n) is Corollary 3.13; the isomorphism be-
tween Q(k, n) and Bound(k, n) is Theorem 3.16; the isomorphism between Jugg(k, n) and
positroids is Proposition 3.21.
9

3.1. Juggling states and functions. Deï¬ne a (virtual) juggling state S âŠ†Z as a subset
whose symmetric difference from âˆ’N := {i â‰¤0} is ï¬nite. (We will motivate this and other
juggling terminology below.) Let its ball number be |S âˆ©Z+| âˆ’|âˆ’N \ S|, where Z+ :=
{i > 0}. Ball number is the unique function on juggling states such that for S âŠ‡Sâ€², the
difference in ball numbers is |S \ Sâ€²|, and âˆ’N has ball number zero.
Call a bijection f : Z â†’Z a (virtual) juggling function if for some (or equivalently,
any) t âˆˆZ, the set f ({i : i â‰¤t}) is a juggling state. It is sufï¬cient (but not necessary) that
{|f(i) âˆ’i| : i âˆˆZ} be bounded. Let G be the set of such functions: it is easy to see that G is
a group, and contains the element s+ : i 7â†’i + 1. Deï¬ne the ball number of f âˆˆG as the
ball number of the juggling state f(âˆ’N), and denote it av(f) for reasons to be explained
later.
Lemma 3.2. av : G â†’Z is a group homomorphism.
Proof. We prove what will be a more general statement, that if S is a juggling state with
ball number b, and f a juggling function with ball number bâ€², then f(S) is a juggling state
with ball number b + bâ€². Proof: if we add one element to S, this adds one element to f(S),
and changes the ball numbers of S, f(S) by 1. We can use this operation and its inverse to
reduce to the case that S = âˆ’N, at which point the statement is tautological.
Now let f, g âˆˆG, and apply the just-proven statement to S = g(âˆ’N).
â–¡
For any bijection f : Z â†’Z, let
st(f, t)
:=
{f(i) âˆ’t : i â‰¤t}
=
st(st
+fsâˆ’t
+ , 0)
and if f âˆˆG, call it the juggling state of f at time t. By the homomorphism property just
proven av(f) = av
 sk
+fsâˆ’k
+

, which says that every state of f âˆˆG has the same ball number
(â€œball number is conservedâ€). The following lemma lets one work with juggling states
rather than juggling functions:
Lemma 3.3. Say that a juggling state T can follow a state S if T = {t}âˆª
 sâˆ’1
+ Â· S

, and t /âˆˆsâˆ’1
+ Â·S.
In this case say that a t-throw takes state S to state T.
Then a list (Si)iâˆˆZ is the list of states of a juggling function iff Si+1 can follow Si for each i. In
this case the juggling function is unique.
Proof. If the (Si) arise from a juggling function f, then the condition is satisï¬ed where the
element ti added to sâˆ’1
+ Â·Siâˆ’1 is f(i)âˆ’i. Conversely, one can construct f as f(i) = i+ti.
â–¡
In fact the ï¬niteness conditions on juggling states and permutations were not necessary
for the lemma just proven. We now specify a further ï¬niteness condition, that will bring
us closer to the true functions of interest.
Lemma 3.4. The following two conditions on a bijection f : Z â†’Z are equivalent:
(1) there is a uniform bound on |f(i) âˆ’i|, or
(2) there are only ï¬nitely many different st(f, i) visited by f.
If they hold, f is a juggling function.
Proof. Assume ï¬rst that f has only ï¬nitely many different states. By Lemma 3.3, we can
reconstruct the value of f(i) âˆ’i from the states Si, Si+1. So f(i) âˆ’i takes on only ï¬nitely
many values, and hence |f(i) âˆ’i| is uniformly bounded.
10

For the reverse, assume that |f(i) âˆ’i| < N for all i âˆˆZ. Then f(âˆ’N) âŠ†{i < N},
and f(Z+) âŠ†{i > âˆ’N}. Since f is bijective, we can complement the latter to learn that
f(âˆ’N) âŠ‡{i â‰¤âˆ’N}. So st(f, 0), and similarly each st(f, t), is trapped between {i â‰¤âˆ’N}
and {i < N}. There are then only 22N possibilities, all of which are juggling states.
â–¡
In the next section we will consider juggling functions which cycle periodically through
a ï¬nite set of states.
Deï¬ne the height of the juggling state S âŠ†Z as
ht(S) :=
X
iâˆˆSâˆ©Z+
i âˆ’
X
iâˆˆâˆ’N\S
i,
a sort of weighted ball number. We can now motivate the notation av(f), computing ball
number as an average:
Lemma 3.5. Let a, b âˆˆZ, a â‰¤b and let f âˆˆG. Then
b
X
i=a+1
(f(i) âˆ’i) = (b âˆ’a) av(f) + ht(st(f, b)) âˆ’ht(st(f, a)).
In particular, if f satisï¬es the conditions of Lemma 3.4, then for any a âˆˆZ,
lim
bâ†’âˆ
1
b âˆ’a
b
X
i=a+1
(f(i) âˆ’i) = av(f).
This equality also holds without taking the limit, if st(f, a) = st(f, b).
Proof. It is enough to prove the ï¬rst statement for b = a + 1, and add the b âˆ’a many
equations together. They are of the form
f(a + 1) âˆ’(a + 1) = av(f) + ht(st(f, a + 1)) âˆ’ht(st(f, a)).
To see this, start with S = st(f, a), and use f(a + 1) to calculate st(f, a + 1). The three sets
to consider are
S
=
f({i â‰¤a}) shifted left by a
Sâ€²
=
f({i â‰¤a}) shifted left by a + 1
st(f, a + 1)
=
f({i â‰¤a + 1}) shifted left by a + 1
By its deï¬nition, ht(Sâ€²) = ht(S) âˆ’av(f). And ht(st(f, a + 1)) = ht(Sâ€²) + f(a + 1) âˆ’(a + 1).
The equation follows.
For the second, if f only visits ï¬nitely many states then the difference in heights is
bounded, and dividing by b âˆ’a kills this term in the limit.
â–¡
We now motivate these deï¬nitions from a jugglerâ€™s point of view. The canonical ref-
erence is [Pol03], though our setting above is more general than considered there. All
of these concepts originated in the juggling community in the years 1985-1990, though
precise dates are difï¬cult to determine.
Consider a idealized juggler who is juggling with one hand8, making one throw every
second, of exactly one ball at a time, has been doing so since the beginning of time and
8or as is more often assumed, rigidly alternating hands
11

will continue until its end. If our juggler is only human (other than being immortal) then
there will be a limit on how high the throws may go.
Assume at ï¬rst that the hand is never found empty when a throw is to be made. The
history of the juggler can then be recorded by a function
f(t) = the time that a ball thrown at time t is next thrown.
The number f(t) âˆ’t is usually called the throw at time t. If ever the juggler does ï¬nd the
hand empty i.e. all the balls in the air, then of course the juggler must wait one second for
the balls to come down. This is easily incorporated by taking f(t) = t, a 0-throw.
While these assumptions imply that f is a juggling function, they would also seem to
force the conclusion that f(i) â‰¥i, i.e. that balls land after they are thrown. Assuming that
for a moment, it is easy to compute the number of balls being juggled in the permutation
f: at any time t, count how many balls were thrown at times {i â‰¤t} that are still in the
air, f(i) > t. This is of course our formula for the ball number, in this special case. The
formula av(f) = av(st
+fsâˆ’t
+ ) then says that balls are neither created nor destroyed.
The state of f âˆˆG at time t is the set of times in the future (of t) that balls in the air
are scheduled to land. (This was introduced to study juggling by the ï¬rst author and,
independently, by Jack Boyce, in 1988.) The â€œheightâ€ of a state does not seem to have
been considered before.
Thus, the sub-semigroup of G where f(t) â‰¥t encodes possible juggling patterns. Since
we would like to consider G as a group (an approach pioneered in [EhRe96]), we must
permit f(t) < t. While it may seem fanciful to view this as describing juggling with
antimatter, the â€œDirac seaâ€ interpretation of antimatter is suggestive of the connection
with the afï¬ne Grassmannian.
3.2. Afï¬ne permutations. Let ËœSn denote the group of bijections, called afï¬ne permuta-
tions, f : Z â†’Z satisfying
f(i + n) = i + n for all i âˆˆZ.
Plainly this is a subgroup of G. This group ï¬ts into an exact sequence
1 â†’Zn
tâˆ’â†’ËœSn Ö‰ Sn â†’1
where for Âµ = (Âµ1, . . ., Âµn) âˆˆZn, we deï¬ne the translation element tÂµ âˆˆËœSn by tÂµ(i) =
nÂµi+i for 1 â‰¤i â‰¤n. The map ËœSn Ö‰ Sn is evident. We can give a splitting map Sn â†’ËœSn by
extending a permutation Ï€ : [n] â†’[n] periodically. By this splitting, we have ËœSn â‰ƒSnâ‹‰Zn,
so every f âˆˆËœSn can be uniquely factorized as f = w tÂµ with w âˆˆSn and Âµ âˆˆZn.
An afï¬ne permutation f âˆˆËœSn is written in one-line notation as [Â· Â· Â· f(1)f(2) Â· Â· Â·f(n) Â· Â· Â·]
(or occasionally just as [f(1)f(2) Â· Â· Â·f(n)]). As explained in Section 1.2, jugglers instead list
one period of the periodic function f(i) âˆ’i (without commas, because very few people
can make 10-throws9 and higher), and call this the siteswap. We adopt the same conven-
tions when multiplying afï¬ne permutations as for usual permutations. The ball number
9The few that do sometimes use A, B, . . . to denote throws 10, 11, . . ., which prompts the question of
what words are jugglable. Michael Kleber informs us that THEOREM and TEAKETTLE give valid juggling
patterns.
12

av(f) = 1
n
Pn
i=1(f(i) âˆ’i) is always an integer; indeed av(w tÂµ) = av(tÂµ) = P
i Âµi. Deï¬ne
ËœSk
n = {f âˆˆËœSn | av(f) = k} = sk
+ËœS0
n
so that ËœS0
n = ker av is the Coxeter group with simple generators s0, s1, . . ., snâˆ’1, usually
called the afï¬ne symmetric group.10 Note that if f âˆˆËœSa
n and g âˆˆËœSb
n then the product fg is
in ËœSa+b
n
. There is a canonical bijection f 7â†’f â—¦(i 7â†’i + b âˆ’a) between the cosets ËœSa
n and
ËœSb
n. The group ËœS0
n has a Bruhat order â€œâ‰¤â€ because it is a Coxeter group ]
Anâˆ’1. This induces
a partial order on each ËœSa
n, also denoted â‰¤.
An inversion of f is a pair (i, j) âˆˆZ Ã— Z such that i < j and f(i) > f(j). Two inversions
(i, j) and (iâ€², jâ€²) are equivalent if iâ€² = i+rn and jâ€² = j+rn for some integer r. The number
of equivalence classes of inversions is the length â„“(f) of f. This is sort of an â€œexcitation
numberâ€ of the juggling pattern; this concept does not seem to have been studied in the
juggling community (though see [EhRe96]).
An afï¬ne permutation f âˆˆËœSk
n is bounded if i â‰¤f(i) â‰¤i + n for i âˆˆZ. We denote the
set of bounded afï¬ne permutations by Bound(k, n). The restriction of the Bruhat order to
Bound(k, n) is again denoted â‰¤.
Lemma 3.6. The subset Bound(k, n) âŠ‚ËœSk
n is a lower order ideal in (ËœSk
n, â‰¤). In particular,
(Bound(k, n), â‰¤) is graded by the rank function â„“(f).
Proof. Suppose f âˆˆBound(k, n) and g â‹–f. Then g is obtained from f by swapping the
values of i + kn and j + kn for each k, where i < j and f(i) > f(j). By the assumption on
the boundedness of f, we have i + n â‰¥f(i) > f(j) = g(i) â‰¥j > i and j + n > i + n â‰¥
f(i) = g(j) > f(j) â‰¥j. Thus g âˆˆBound(k, n).
â–¡
Postnikov, in [Pos, Â§13], introduces â€œdecorated permutationsâ€. A decorated permuta-
tion is an element of Sn, with each ï¬xed point colored either 1 or âˆ’1. There is an obvious
bijection between the set of decorated permutations and `n
k=0 Bound(k, n): Given an el-
ement f âˆˆBound(k, n), form the corresponding decorated permutation by reducing f
modulo n and coloring the ï¬xed points of this reduction âˆ’1 or 1 according to whether
f(i) = i or f(i) = i + n respectively. In [Pos, Â§17], Postnikov introduces the cyclic Bruhat
order, CBkn, on those decorated permutations corresponding to elements of Bound(k, n).
From the list of cover relations in [Pos, Theorem 17.8], it is easy to see that CBkn is anti-
isomorphic to Bound(k, n).
Example 3.7. In the Gr(2, 4) case there are already 33 bounded afï¬ne permutations, but
only 10 up to cyclic rotation. In Figure 1 we show the posets of siteswaps, afï¬ne permua-
tions, and decorated permutations, each modulo rotation. Note that the cyclic symmetry
is most visible on the siteswaps, and indeed jugglers draw little distinction between cyclic
rotations of the â€œsameâ€ siteswap.
10One reason the subgroup ËœS0
n is more commonly studied than ËœSn is that it is the Coxeter group ^
Anâˆ’1;
its relevance for us, is that it indexes the Bruhat cells on the afï¬ne ï¬‚ag manifold for the group SLn. In Â§7 we
will be concerned with the afï¬ne ï¬‚ag manifold for the group GLn, whose Bruhat cells are indexed by all of
ËœSn.
13

[5247]
[2547]
[5634]
[3546]
[3456]
[3564]
[5346]
[5364]
[3654]
[5274]
[3 4 1 2]
[3 1 4 2]
[2 1 4 3]
[3 1 2 4]
[1 3 4 2]
[1 2 4 3]
[1 3 2 4]
[3 2 1 4]
[1 2 3 4]
[1 2 3 4]
2222
2312
1313
4013
4400
2330
4130
4112
2420
4040
FIGURE 1. The posets of siteswaps, bounded afï¬ne permutations, and dec-
orated permutations for Gr(2, 4), each up to cyclic rotation. (The actual
posets each have 33 elements.)
3.3. Sequences of juggling states. A (k, n)-sequence of juggling states is a sequence
J = (J1, . . ., Jn) âˆˆ
 [n]
k
n such that for each i âˆˆ[n], we have that Ji+1 âˆªâˆ’N follows Ji âˆªâˆ’N,
where the indices are taken modulo n. Let Jugg(k, n) denote the set of such sequences.
Let f âˆˆBound(k, n). Then the sequence of juggling states
. . ., st(f, âˆ’1), st(f, 0), st(f, 1), . . .
is periodic with period n. Furthermore for each i âˆˆZ, (a) âˆ’N âŠ‚st(f, i), and (b) st(f, i) âˆ©
[n] âˆˆ
 [n]
k

. Thus
J (f) = (st(f, 0) âˆ©[n], st(f, 1) âˆ©[n], . . ., st(f, n âˆ’1) âˆ©[n]) âˆˆJugg(k, n).
Lemma 3.8. The map f 7â†’J (f) is a bijection between Bound(k, n) and Jugg(k, n).
We now discuss another way of viewing (k, n)-sequences of juggling states which will
be useful in Â§5.1. Let S be a k-ball virtual juggling state. For every integer j, deï¬ne
Rj(S) = k âˆ’#{x âˆˆS : x > j}.
These {Rj} satisfy the following properties:
â€¢ Rj(S) âˆ’Rjâˆ’1(S) is either 0 or 1, according to whether j Ì¸âˆˆJ or j âˆˆJ respectively,
â€¢ Rj(S) = k for j sufï¬cently positive, and
â€¢ Rj(S) = j for j sufï¬ciently negative.
Conversely, from such a sequence (Rj) one can construct a k-ball juggling state.
Let S1 and S2 be two k-ball juggling states. Deï¬ne a 2Ã—âˆmatrix (rij) by rij = Rjâˆ’i+1(Si).
Lemma 3.9. The state S2 can follow S1 if and only if r1j âˆ’r2j = 0 or 1 for all j âˆˆZ and there is
no 2 Ã— 2 submatrix for which r1j = r2j = r2(j+1) = r1(j+1) âˆ’1.
Proof. It is easy to check that S2 = sâˆ’1
+ S1âˆª{t} if and only if r1j = r2j +1 for j â‰¤t and r1j = r2j
for j â‰¥t + 1. If this holds, it immediately follows that r1j âˆ’r2j = 0 or 1 for all j and that
there is no j for which r1j = r2j while r2(j+1) = r1(j+1) âˆ’1.
Conversely, suppose that r1j âˆ’r2j = 0 or 1 for all j âˆˆZ and there is no j for which
r1j = r2j = r2(j+1) = r1(j+1) âˆ’1. Then we claim that there is no j for which r1j = r2j and
r2(j+1) = r1(j+1) âˆ’1. Proof: suppose there were. If r2(j+1) = r2j, then we are done by our
hypothesis; if r2(j+1) = r2j then r1(j+1) = r1j +2, contradicting that r1(j+1) âˆ’r1j = 0 or 1. Since
r2(j+1) âˆ’r2j = 0 or 1, we have a contradiction either way. This establishes the claim. Now,
14

we know that r1j = r2j for j sufï¬cently positive and r1j = r2j + 1 for j sufï¬cently negative,
so there must be some t such that r1j = r2j + 1 for j â‰¤t and r1j = r2j for j â‰¥t + 1. Then S2
can follow S1.
â–¡
It is immediate to extend this result to a sequence of juggling states. Let G be the group
of juggling functions introduced in Â§3.1 and let Gav=k be those juggling functions with
ball number k. For any f in Gav=k, let J (f) = (J1, J2, . . ., Jn) be the corresponding (k, n)-
sequence of juggling states. Deï¬ne an âˆÃ— âˆmatrix by rij = R(jâˆ’i+1)(Ji âˆªâˆ’N). Then,
applying Lemma 3.9 to each pair of rows of (rij) gives:
Corollary 3.10. The above construction gives a bijection between Gav=k and âˆÃ— âˆmatrices
such that
(C1) for each i, there is an mi such that rij = j âˆ’i + 1 for all j â‰¤mi,
(C2) for each i, there is an ni such that rij = k for all j â‰¥ni,
(C3) rij âˆ’r(i+1)j âˆˆ{0, 1} and rij âˆ’ri(jâˆ’1) âˆˆ{0, 1} for all i, j âˆˆZ, and
(C4) if r(i+1)(jâˆ’1) = r(i+1)j = ri(jâˆ’1) then rij = r(i+1)(jâˆ’1).
Under this bijection, rij = r(i+1)j = ri(jâˆ’1) > r(i+1)(jâˆ’1) if and only if f(i) = j.
Proposition 3.11. Let f, g âˆˆËœSk
n âŠ‚Gav=k and let r and s be the corresponding matrices. Then
f â‰¤g (in Bruhat order) if and only if rij â‰¥sij for all (i, j) âˆˆZ2.
Proof. See [BjBre05, Theorem 8.3.1].
â–¡
When rij = r(i+1)j = ri(jâˆ’1) > r(i+1)(jâˆ’1), we say that (i, j) is a special entry of r.
An easy check shows:
Corollary 3.12. Under the above bijection, Bound(k, n) corresponds to âˆÃ— âˆmatrices such
that
(C1â€™) rij = j âˆ’i + 1 for all j < i,
(C2â€™) rij = k for all j â‰¥i + n âˆ’1,
(C3) rij âˆ’r(i+1)j âˆˆ{0, 1} and rij âˆ’ri(jâˆ’1) âˆˆ{0, 1} for all i, j âˆˆZ,
(C4) if r(i+1)(jâˆ’1) = r(i+1)j = ri(jâˆ’1) then rij = r(i+1)(jâˆ’1), and
(C5) r(i+n)(j+n) = rij.
We call a matrix (rij) as in Corollary 3.12 a cyclic rank matrix. (See [Fu92] for the
deï¬nition of a rank matrix, which we are mimicking.) We now specialize Proposition 3.11
to the case of Bound(k, n): Deï¬ne a partial order â‰¤on Jugg(k, n) by
(J1, . . ., Jn) â‰¤(Jâ€²
1, . . ., Jâ€²
n) if and only if Ji â‰¤Jâ€²
i for each i.
Corollary 3.13. The map f 7â†’J (f) is an isomorphism of posets from bounded afï¬ne permutations
(Bound(k, n), â‰¤) to (k, n)-sequence of juggling states (Jugg(k, n), â‰¤).
Proof. One simply checks that the condition rij â‰¥râ€²
ij for all j is equivalent to Ji â‰¤Jâ€²
i.
â–¡
Example 3.14. Let n = 4 and k = 2. Consider the afï¬ne permutation [Â· Â· Â·2358 Â· Â· Â·], last
seen in Figure 1. Its siteswap is 4112, and the corresponding sequence of juggling states
is (14, 13, 12, 12). Below we list a section of the corresponding inï¬nite permutation matrix
15

and cyclic rank matrix. Namely, we display the entries (i, j) for 1 â‰¤i â‰¤4 and i â‰¤j â‰¤i+4.
The special entries have been underlined.
ï£«
ï£¬
ï£¬
ï£­
0
1
0
0
0
0
1
0
0
0
0
0
1
0
0
0
0
0
0
1
ï£¶
ï£·
ï£·
ï£¸
ï£«
ï£¬
ï£¬
ï£­
1
1
1
2
2
1
1
2
2
2
1
2
2
2
2
1
2
2
2
2
ï£¶
ï£·
ï£·
ï£¸
In Â§1.2 we associated an afï¬ne permutation to each k Ã— n matrix M of rank k; a modi-
ï¬cation of that rule gives instead a (k, n)-sequence of juggling states. Call a column of M
pivotal if it is linearly independent of the columns to its left. (If one performs Gaussian
elimination on M, a column will be pivotal exactly if it contains a â€œpivotâ€ of the resulting
reduced row-echelon form.) There will be k pivotal columns, giving a k-element subset
of {1, . . ., n}; they form the lex-ï¬rst basis made of columns from M.
Now rotate the ï¬rst column of M to the end.
What happens to the set of pivotal
columns? Any column after the ï¬rst that was pivotal still is pivotal, but (unless the ï¬rst
column was all zeroes) there is a new pivotal column; the new state can follow the previ-
ous state. The n cyclic rotations of M thus give a (k, n)-sequence of juggling states.
3.4. From Q(k, n) to Bound(k, n). The symmetric group Sn acts on Zn (on the left) by
(1)
w Â· (Ï‰1, . . ., Ï‰n) = (Ï‰wâˆ’1(1), . . .Ï‰wâˆ’1(n)).
If w âˆˆSn and tÎ», tÎ»â€² âˆˆËœSn are translation elements, we have the following relations in ËœSn:
(2)
wtÎ»wâˆ’1 = twÂ·Î»
tÎ»tÎ»â€² = tÎ»+Î»â€².
Let Ï‰k = (1, . . ., 1, 0, . . ., 0) with k 1s be the kth fundamental weight of GL(n). Note
that tÏ‰k âˆˆËœSk
n. Now ï¬x âŸ¨u, wâŸ©âˆˆQ(k, n), the set of equivalence classes we deï¬ned in Â§2.3.
Deï¬ne an afï¬ne permutation fu,w âˆˆËœSk
n by
fu,w = utÏ‰kwâˆ’1.
The element fu,w does not depend on the representative [u, w]k of âŸ¨u, wâŸ©: if uâ€² = uz and
wâ€² = wz for z âˆˆSk Ã— Snâˆ’k then
uâ€²tÏ‰k(wâ€²)âˆ’1 = uztÏ‰kzâˆ’1wâˆ’1 = utzÂ·Ï‰kwâˆ’1 = utÏ‰kwâˆ’1
since z stabilizes Ï‰k.
Proposition 3.15. The map âŸ¨u, wâŸ©7â†’fu,w is a bijection from Q(k, n) to Bound(k, n).
Proof. We ï¬rst show that âŸ¨u, wâŸ©7â†’fu,w is an injection into ËœSk
n. Suppose that fu,w = fuâ€²,wâ€².
It is clear from the factorization ËœSn â‰ƒSn â‹‰Zn that there is some z âˆˆSk Ã— Snâˆ’k such that
u = uâ€²z and w = wâ€²z. Using Proposition 2.4, we have [u, w] âˆ¼[uâ€², wâ€²].
We now show that for âŸ¨u, wâŸ©âˆˆQ(k, n), we have fu,w âˆˆBound(k, n). Let i âˆˆ[1, n] and
a = wâˆ’1(i). Then
fu,w(i) =

u(a)
if a > k
u(a) + n
if a â‰¤k.
The boundedness of fu,w now follows from Theorem 2.1(1).
Conversely, if f âˆˆBound(k, n) then it is clear from (2) that f has a factorization as
f = utÏ‰wâˆ’1
16

for u, w âˆˆSn and Ï‰ âˆˆ{0, 1}n. Since f âˆˆËœSk
n, the vector Ï‰ has k 1s. By changing u and
w, we may further assume that Ï‰ = Ï‰k and w âˆˆSmin
n,k . It remains to check that u â‰¤k w,
which we do via Theorem 2.1; its Condition (2) is vacuous when w âˆˆSmin
n,k and checking
Condition (1) is the same calculation as in the previous paragraph.
â–¡
Theorem 3.16. The bijection âŸ¨u, wâŸ©7â†’fu,w is a poset isomorphism from the pairs (Q(k, n), â‰¤) to
bounded afï¬ne permutations (Bound(k, n), â‰¤). Furthermore, one has â„“(fu,w) =
 n
k

âˆ’â„“(w)+â„“(u).
Proof. It is shown in [Wi07] that (Q(k, n), â‰¤) is a graded poset, with rank function given
by Ï(âŸ¨u, wâŸ©) = k(nâˆ’k) âˆ’(â„“(w) âˆ’â„“(u)). It follows that each cover in Q(k, n) is of the form
(1) âŸ¨u, wâ€²âŸ©â‹—âŸ¨u, wâŸ©where wâ€² â‹–w, or
(2) âŸ¨uâ€², wâŸ©â‹—âŸ¨u, wâŸ©where u â‹–uâ€².
We may assume that w âˆˆSmin
n,k (Proposition 2.3). Suppose we are in Case (1). Then wâ€² =
w(ab) where a â‰¤k < b and w(a) > w(b). Here (ab) âˆˆSn denotes the transposition
swapping a and b. Thus fu,wâ€² = fu,w(w(a)w(b)). Using the formula in the proof of
Proposition 3.15, we see that fu,w(w(a)) > n while fu,w(w(b)) â‰¤n. Thus fu,wâ€² > fu,w.
Suppose we are in Case (2), and that uâ€² = u(ab) where a < b and u(a) < u(b). It
follows that fu,wâ€² = (u(a)u(b))fu,w. Suppose ï¬rst that a â‰¤k < b. Then (tÏ‰k)âˆ’1(a) = aâˆ’n,
while (tÏ‰)âˆ’1(b) = b so we also have fu,wâ€² = fu,w((w(a)âˆ’n)w(b)) where w(a)âˆ’n is clearly
less than w(b). Thus fu,wâ€² > fu,w. Otherwise suppose that a, b â‰¥k (the case a, b â‰¤k is
similar). Then fu,wâ€² = fu,w(w(a)w(b)). Since w âˆˆSmin
n,k , we have w(a) < w(b). Again we
have fu,wâ€² > fu,w.
We have shown that âŸ¨uâ€², wâ€²âŸ©â‰¥âŸ¨u, wâŸ©implies fuâ€²,wâ€² â‰¥fu,w. The converse direction is
similar.
The last statement follows easily, using the fact that both of the posets (Q(k, n), â‰¤) and
(Bound(k, n), â‰¤) are graded.
â–¡
3.5. Shellability of Q(k, n). A graded poset P is Eulerian if for any x â‰¤y âˆˆP such that
the interval [x, y] is ï¬nite we have Âµ(x, y) = (âˆ’1)rank(x)âˆ’rank(y), where Âµ denotes the MÂ¨obius
function of P. A labeling of the Hasse diagram of a poset P by some totally ordered set Î›
is called an EL-labeling if for any x â‰¤y âˆˆP:
(1) there is a unique label-(strictly)increasing saturated chain C from x to y,
(2) the sequence of labels in C is Î›-lexicographically minimal amongst the labels of
saturated chains from x to y.
If P has an EL-labeling then we say that P is EL-shellable.
Verma [Ve71] has shown that the Bruhat order of a Coxeter group is Eulerian. Dyer
[Dy93, Proposition 4.3] showed the stronger result that every Bruhat order (and also its
dual) is EL-shellable. (See also [BjWac82].) Since these properties are preserved under tak-
ing convex subsets, Lemma 3.6 and Corollary 3.13 and Theorem 3.16 imply the following
result, proved for the dual of (Q(k, n), â‰¤) by Williams [Wi07].
Corollary 3.17. The posets (Q(k, n), â‰¤), (Bound(k, n), â‰¤), and (Jugg(k, n), â‰¤), and their du-
als are Eulerian and EL-shellable.
Remark 3.18. Williamsâ€™ result is stronger than Corollary 3.17: in our language, she shows
that the poset
\
Q(k, n), formed by adding a formal maximal element ^1 to Q(k, n), is
shellable.
17

3.6. Positroids. A matroid M on [n] with rank k is a non-empty collection of k-element
subsets of [n], called bases, satisfying the Unique Minimum Axiom: For any permutation
w âˆˆSn, there is a unique minimal element of w Â· M, in the partial order â‰¤on
 [n]
k

. This
is only one of many equivalent deï¬nitions of a matroid; see [Bry86] for a compendium of
many others, in which this one appears as Axiom B2(6).
Let M be a matroid of rank k on [n]. Deï¬ne a sequence of k-element subsets J (M) =
(J1, J2, . . ., Jn) by letting Jr be the minimal base of Ï‡âˆ’r+1(M), which is well-deï¬ned by
assumption. Postnikov proved, in the terminology of Grassmann necklaces,
Lemma 3.19 ([Pos, Lemma 16.3]). For a matroid M, the sequence J (M) is a (k, n)-sequence
of juggling states.
Let J = (J1, J2, . . ., Jr) âˆˆJugg(k, n). Deï¬ne
MJ =

I âˆˆ
[n]
k

| Ï‡âˆ’r+1(I) â‰¥Jr

.
Lemma 3.20 ([Pos, Oh]). Let J âˆˆJugg(k, n). Then MJ is a matroid and J (MJ ) = J .
The matroids MJ are called positroids.
Proposition 3.21. The maps J 7â†’MJ and M 7â†’J (M) are inverse isomorphisms between the
poset Jugg(k, n) and the poset of positroids, J (M1) â‰¤J (M2) if and only if M1 âŠ‡M2.
Proof. The composition J 7â†’MJ 7â†’J (MJ ) is the identity by the above lemma and,
since the set of positroids is deï¬ned as those matroids of the form MJ , the compositions
are inverse in the other order as well.
It is easy to see from the deï¬nitions, that M1 âŠ‡M2 implies J (M1) â‰¤J (M2) and that
J1 â‰¤J2 implies MJ1 âŠ‡MJ2. Since these correspondences are inverse, then J1 â‰¤J2 if
and only if MJ1 âŠ‡MJ2.
â–¡
If M is an arbitrary matroid, then we call the positroid MJ (M) the positroid envelope
of M (see the discussion before Remark 1.1). Every positroid is a matroid. The positroid
envelope of a positroid is itself.
Example 3.22. Let M1 and M2 be the matroids {12, 13, 14, 23, 24, 34} and {12, 23, 34, 14}. In
both cases, J (Mi) is (12, 23, 34, 14) and, thus, M1 is the positroid envelope of both M1 and
M2. The corresponding afï¬ne permutation is [Â· Â· Â·3456 Â· Â· Â·]. On the other hand, if M3 =
{12, 13, 14, 23, 24}, then J (M3) = {12, 23, 13, 14}, with corresponding afï¬ne permutation
[Â· Â· Â·3546 Â· Â· Â·].
Remark 3.23. Postnikov [Pos] studied the totally nonnegative part Gr(k, n)â‰¥0 of the Grass-
mannian. Each point V âˆˆGr(k, n)â‰¥0 has an associated matroid MV. Postnikov showed
that the matroids that can occur this way, called positroids, were in bijection with Grass-
mann necklaces of type (k, n) (similar to our (k, n)-sequences of juggling states), with
decorated permutations of [n] with k anti-exceedances, and with many other combinato-
rial objects. Oh [Oh], proving a conjecture of Postnikov, showed that positroids can be
deï¬ned in the way we have done.
18

4. BACKGROUND ON SCHUBERT AND RICHARDSON VARIETIES
We continue to ï¬x nonnegative integers k and n, satisfying 0 â‰¤k â‰¤n. For S any subset
of [n], let ProjectS : Cn Ö‰ CS denote the projection onto the coordinates indexed by S. (So
the kernel of ProjectS is SpansÌ¸âˆˆS es.)
4.1. Schubert and Richardson varieties in the ï¬‚ag manifold. Let Fâ„“(n) denote the vari-
ety of ï¬‚ags in Cn. For a permutation w âˆˆSn, we have the Schubert cell
ËšXw = {Gâ€¢ âˆˆFâ„“(n) | dim(Project[j](Gi)) = #{w([i]) âˆ©[j]} for all i, j}
and Schubert variety
Xw = {Gâ€¢ âˆˆFâ„“(n) | dim(Project[j](Gi)) â‰¤#{w([i]) âˆ©[j]} for all i, j}
which both have codimension â„“(w); moreover Xw = ËšXw. (For basic background on the
combinatorics of Schubert varieties, see [Fu92] or [MilStu05, Chapter 15].) We thus have
Fâ„“(n) =
a
wâˆˆSn
ËšXw
and
Xw =
a
vâ‰¥w
ËšXv.
Similarly, we deï¬ne the opposite Schubert cell
ËšXw = {Gâ€¢ âˆˆFâ„“(n) | dim(Project[nâˆ’j+1,n](Gi)) = #{w([i]) âˆ©[n âˆ’j + 1, n]} for all i, j}
and opposite Schubert variety
Xw = {Gâ€¢ âˆˆFâ„“(n) | dim(Project[nâˆ’j+1,n](Gi)) â‰¤#{w([i]) âˆ©[n âˆ’j + 1, n]} for all i, j}
It may be easier to understand these deï¬nitions in terms of matrices. Let M be an
n Ã— n invertible matrix and let Gi be the span of the top i rows of M. Then Gâ€¢ is in ËšXw
(respectively, Xw), if and only if, for all 1 â‰¤i, j â‰¤n, the rank of the top left i Ã— j submatrix
of M is the same as (respectively, less than or equal to) the rank of the corresponding
submatrix of the permutation matrix w. Similarly, Gâ€¢ is in ËšXw (respectively Xw) if the
ranks of the top right submatrices of M are equal to (respectively less than or equal to)
those of w. (The permutation matrix of w has 1s in positions (i, w(i)) and 0s elsewhere.)
Deï¬ne the Richardson varieties as the transverse intersections
Xw
u = Xu âˆ©Xw
and
ËšXw
u = ËšXu âˆ©ËšXw.
The varieties Xw
v and ËšXw
v are nonempty if and only if v â‰¤w, in which case each has
dimension â„“(w) âˆ’â„“(v). Let Eâ€¢ be the ï¬‚ag (Span(e1), Span(e1, e2), . . .) The coordinate ï¬‚ag
vEâ€¢ is in Xw
u if and only if u â‰¤v â‰¤w.
We will occasionally need to deï¬ne Schubert cells and varieties with respect to a ï¬‚ag
Fâ€¢. We set
ËšXw(Fâ€¢) = {Gâ€¢ âˆˆFâ„“(n) | dim(Gi/(Gi âˆ©Fnâˆ’j)) = #{w([i]) âˆ©[j]} for all i, j}
and deï¬ne Xw(Fâ€¢) by replacing = with â‰¤. Warning: under this deï¬nition Xw is Xw(w0Eâ€¢).
19

4.2. Schubert varieties in the Grassmannian. Let Gr(k, n) denote the Grassmannian of
k-planes in Cn, and let Ï€ : Fâ„“(n) â†’Gr(k, n) denote the natural projection. For I âˆˆ
 [n]
k

,
we let
ËšXI = {V âˆˆGr(k, n) | dim Project[j](V)) = #(I âˆ©[j])}
denote the Schubert cell labeled by I and
XI = {V âˆˆGr(k, n) | dim Project[j](V) â‰¤#(I âˆ©[j])}
the Schubert variety labeled by I.
Thus we have Ï€(Xw) = XÏ€(w) and
Gr(k, n) =
a
Iâˆˆ([n]
k )
ËšXI
and
XJ =
a
Iâ‰¥J
ËšXI.
We deï¬ne
ËšXI = {V âˆˆGr(k, n) | dim Project[nâˆ’j+1,n](V) = #(I âˆ©[n âˆ’j + 1, n])},
XI = {V âˆˆGr(k, n) | dim Project[nâˆ’j+1,n](V) â‰¤#(I âˆ©[n âˆ’j + 1, n])},
So, for J âˆˆ
 [n]
k

, the k-plane SpanjâˆˆJ ej lies in XI if and only if I â‰¤J, and lies in XK if and
only if J â‰¤K.
To review: if u and w lie in Sn, then Xu is a Schubert variety, Xw an opposite Schubert
and Xw
u a Richardson variety in Fâ„“(n). If I and J lie in
 [n]
k

, then XI, XJ and XJ
I mean
the similarly named objects in Gr(k, n). (Note that permutations have lower case letters
from the end of the alphabet while subsets have upper case letters chosen from the range
{I, J, K}.) The symbol ËšX would indicate that we are dealing with an open subvariety, in
any of these cases.
5. POSITROID VARIETIES
We now introduce the positroid varieties, our principal objects of study. Like the Schu-
bert and Richardson varieties, they will come in open versions, denoted ËšÎ , and closed
versions, denoted Î .11 The positroid varieties will be subvarieties of Gr(k, n), indexed by
the various posets introduced in Â§3. For each of the different ways of viewing our posets,
there is a corresponding way to view positroid varieties. The main result of this section
will be that all of these ways coincide. Again, we sketch these results here and leave the
precise deï¬nitions until later.
Given [u, w]k, representing an equivalence class in Q(k, n), we can project the Richard-
son variety ËšXw
u (respectively Xw
u ) to Gr(k, n). Given a (k, n)-sequence of juggling states
(J1, J2, . . ., Jn) âˆˆJugg(k, n), we can take the intersection T Ï‡iâˆ’1ËšXJi (respectively T Ï‡iâˆ’1XJi)
in Gr(k, n). (Recall Ï‡ is the cyclic shift [234 . . .n1].) Given a cyclic rank matrix r, we can
consider the image in Gr(k, n) of the space of k Ã— n matrices such that the submatrices
made of cyclically consecutive columns have ranks equal to (respectively, less than or
equal to) the entries of r. Given a positroid M, we can consider those points in Gr(k, n)
whose matroid has positroid envelope equal to (respectively, contained in) M.
11Î  stands for â€œpositroidâ€, â€œPostnikovâ€, and â€œprojected Richardsonâ€.
20

Theorem 5.1. Choose our [u, w]k, (J1, . . . , Jn), r and M to correspond by the bijections in Â§3.
Then the projected open Richardson variety, the intersection of cyclically permuted open Schu-
bert varieties, the space of matrices obeying the rank conditions, and the space of matrices whose
matroids have the required positroid envelope, will all coincide as subsets of Gr(k, n).
The equalities of the last three spaces is essentially a matter of unwinding deï¬nitions.
The equality between the projected open Richardson variety, and the space of matrices
obeying the cyclic rank conditions, is nontrivial and is checked in Proposition 5.4.
We call the varieties we obtain in this way open positroid varieties or positroid vari-
eties respectively, and denote them by ËšÎ  or Î  with a subscript corresponding to any of
the possible combinatorial indexing sets.
The astute reader will note that we did not describe how to deï¬ne a positroid variety
using a bounded afï¬ne permutation (except by translating it into some other combinato-
rial data). We hope to address this in future work using the geometry of the afï¬ne ï¬‚ag
manifold. The signiï¬cance of bounded afï¬ne permutations can already be seen in this
paper, as it is central in our description in Â§7 of the cohomology class of Î .
5.1. Cyclic rank matrices. Recall the deï¬nition of a cyclic rank matrix from the end of
Â§3.1.
As we explained there, cyclic rank matrices of type (k, n) are in bijection with
Bound(k, n) and hence with Q(k, n) and with bounded juggling patterns of type (k, n).
Let V âˆˆGr(k, n). We deï¬ne an inï¬nite array râ€¢â€¢(V) = (rij(V))i,jâˆˆZ of integers as follows:
For i > j, we set rij(V) = j âˆ’i + 1 and for i â‰¤j we have
rij(V) = dim(Project{i,i+1,...,j}(V)}).
where the indices are cyclic modulo n. (So, if n = 5, i = 4 and j = 6, we are projecting
onto Span(e4, e5, e1).) Note that, when j â‰¥i + n âˆ’1, we project onto all of [n]. If V is the
row span of a k Ã— n matrix M, then rij(V) is the rank of the submatrix of M consisting of
columns i, i + 1, . . . , j.
5.2. Positroid varieties and open positroid varieties.
Lemma 5.2. Let V âˆˆGr(k, n). Then râ€¢â€¢(V) is a cyclic rank matrix of type (k, n).
Proof. Conditions (C1â€™), (C2â€™), and (C5) are clear from the deï¬nitions. Let M be a kÃ—n ma-
trix whose row span is V; let Mi be the ith column of M. Condition (C3) says that adding
a column to a matrix either preserves the rank of that matrix or increases it by one. The
hypotheses of condition (C4) state that Mi and Mj are in the span of Mi+1, Mi+2, . . . , Mjâˆ’1;
the conclusion is that dim Span(Mi, Mi+1, . . ., Mjâˆ’1, Mj) = dim Span(Mi+1, . . ., Mjâˆ’1).
â–¡
For any cyclic rank matrix r, let ËšÎ r be the subset of Gr(k, n) consisting of those k-planes
V with cyclic rank matrix r. We may also write ËšÎ f, ËšÎ J or ËšÎ w
u where f is the bounded afï¬ne
permutation, J the juggling pattern or âŸ¨u, wâŸ©the equivalence class of k-Bruhat interval
corresponding to r.
The next result follows directly from the deï¬nitions. Recall that Ï‡ = [23 Â· Â· Â·(n âˆ’1)n1] âˆˆ
Sn denotes the long cycle.
Lemma 5.3. For any J = (J1, J2, . . ., Jn) âˆˆJugg(k, n), we have
ËšÎ J = ËšXJ1 âˆ©Ï‡(ËšXJ2) âˆ©Â· Â· Â· âˆ©Ï‡nâˆ’1(ËšXJn).
21

By Lemma 5.2 and our combinatorial bijections, we have
Gr(k, n) =
a
J âˆˆJugg(k,n)
ËšÎ J .
We call the sets ËšÎ J open positroid varieties. Postnikov [Pos] showed that ËšÎ J (and even
(ËšÎ J )â‰¥0) is non-empty if J âˆˆJugg(k, n) (this statement also follows from Proposition 5.4
below). We deï¬ne the positroid varieties Î J to be the closures Î J := ËšÎ J .
5.3. From Q(k, n) to cyclic rank matrices. We now describe a stratiï¬cation of the Grass-
mannian due to Lusztig [Lus98], and further studied by Rietsch [Rie06]. (This stratiï¬ca-
tion was also independently discovered by Brown, Goodearl and Yakimov [BroGooYa06,
GooYa], motivated by ideas from Poisson geometry; we will not discuss the Poisson per-
spective further in this paper.) Lusztig and Rietschâ€™s work applies to any partial ï¬‚ag
variety, and we specialize their results to the Grassmannian.
The main result of this section is the following:
Proposition 5.4. Let u â‰¤k w, and fu,w be the corresponding afï¬ne permutation from Â§3.4. Recall
that ËšXw
u denotes the open Richardson variety in Fâ„“(n) and Ï€ the map Fâ„“(n) â†’Gr(k, n). Then
ËšÎ f = Ï€(ËšXw
u ).
Remark 5.5. If u â‰¤w, but u Ì¸â‰¤k w, then Ï€(ËšXw
u ) may not be of the form ËšÎ f. See [KnLamSp,
Remark 3.5].
The projection Ï€(ËšXw
u ) depends only on the equivalence class of [u, w]k in Q(k, n).
Proposition 5.6 ([KnLamSp, Lemma 3.1]). Suppose [u, w]k âˆ¼[uâ€², wâ€²]k in Q(k, n). Then
Ï€(ËšXw
u ) = Ï€(ËšXwâ€²
uâ€² ).
We now introduce a piece of notation which will be crucial in the proof of Proposi-
tion 5.4, but will then never appear again. Let V âˆˆGr(k, n). Given a ï¬‚ag Fâ€¢ in Cn, we
obtain another ï¬‚ag Fâ€¢(V) containing V as the kth subspace, as follows. Take the sequence
F0 âˆ©V, F1 âˆ©V, . . ., Fn âˆ©V and remove repetitions to obtain a partial ï¬‚ag Fâ€¢ âˆ©V inside Cn,
with dimensions 1, 2, . . . k. Next take the sequence V + F0, V + F1, V + F2, . . . , V + Fn and
remove repetitions to obtain a partial ï¬‚ag Fâ€¢ + V inside Cn of dimensions k, k + 1, . . . , n.
Concatenating Fâ€¢ âˆ©V and Fâ€¢ + V gives a ï¬‚ag Fâ€¢(V) in Cn. The ï¬‚ag Fâ€¢(V) is the â€œclosestâ€
ï¬‚ag to Fâ€¢ which contains V as the kth subspace. This notion of â€œclosest ï¬‚agâ€ is related
to the notion of â€œclosest Borel subgroupâ€ in [Rie06, Â§5], and many of our arguments are
patterned on arguments of [Rie06].
Lemma 5.7. Let w be a Grassmannian permutation. Let Fâ€¢ be a complete ï¬‚ag and let V = Fk.
Then Fâ€¢ âˆˆËšXw if and only if
(1) V âˆˆËšXÏƒ(w) and
(2) Fâ€¢ = Eâ€¢(V).
Proof. The ï¬‚ag Fâ€¢ is in ËšXw if and only if, for every i and j,
dim(Fi âˆ©Ej) = # (w([i]) âˆ©[j]) or, equivalently, dim(Fi + Ej) = (i + j) âˆ’# (w([i]) âˆ©[j]) .
When i = k, the equation above is precisely the condition that V âˆˆËšXÏƒ(w). Therefore, when
proving either direction of the equivalence, we may assume that V âˆˆËšXÏƒ(w).
22

Since V âˆˆËšXÏƒ(w),
Eâ€¢(V) =
 Ew(1) âˆ©V, Ew(2) âˆ©V, . . . , Ew(k) âˆ©V, Ew(k+1) + V, Ew(k+2) + V, . . ., Ew(n) + V

.
Let i â‰¤k. If Fâ€¢ âˆˆËšXw, then dim(Fi âˆ©Ew(i)) = # (w([i]) âˆ©[w(i)]) = i, where we have
used that w is Grassmannian. However, Fi âˆ©Ew(i) âŠ†V âˆ©Ew(i), which also has dimension i
because V âˆˆËšXÏƒ(w). So Fâ€¢ âˆˆËšXw implies that Fi = V âˆ©Ew(i). Similarly, for i > k, the equation
dim(Fi + Ew(i)) = i + w(i) âˆ’# (w([i]) âˆ©[w(i)]) implies that Fi = Ew(i) + V. So, if Fâ€¢ âˆˆËšXx
then Fâ€¢ = Eâ€¢(V). The argument is easily reversed.
â–¡
Lemma 5.8. Let w be a Grassmannian permutation, with u â‰¤w and let V âˆˆGr(k, n). Then
V âˆˆÏ€(ËšXw
u ) if and only if
(3)
Eâ€¢(V)i = V âˆ©Ew(i) for 1 â‰¤i â‰¤k
(4)
Eâ€¢(V)i = V + Ew(i) for k < i â‰¤n
and
(5)
Eâ€¢(V) âˆˆËšXu.
Proof. By deï¬nition, V âˆˆÏ€(ËšXw
u ) if and only if there is a ï¬‚ag Fâ€¢ with V = Fk and Fâ€¢ âˆˆËšXuâˆ©ËšXw.
By Lemma 5.7, this ï¬‚ag Fâ€¢, should it exist, must be Eâ€¢(V). By Lemma 5.7, Eâ€¢(V) lies in ËšXw if
and only if V lies in ËšXÏƒ(w). So Eâ€¢(V) âˆˆËšXuâˆ©ËšXw if and only if V âˆˆËšXÏƒ(w) and Eâ€¢(V) âˆˆËšXu. Now,
conditions (3) and (4) determine the dimension of V âˆ©Ew(i) for all i. They are precisely
the condition on dim (V âˆ©w(j)) occuring in the deï¬nition of ËšXÏƒ(w). So conditions (3), (4)
and (5) are equivalent to the condition that V âˆˆËšXÏƒ(w) and Eâ€¢(V) âˆˆËšXu.
â–¡
Proof of Proposition 5.4. First, note that by Proposition 5.6, and the observation that fu,w
only depends on the equivalence class âŸ¨u, wâŸ©in Q(k, n), we may replace (u, w) by any
equivalent pair in Q(k, n). We may thus assume that w is Grassmannian (Proposition 2.3).
By Lemma 5.8, V âˆˆÏ€(ËšXw
u ) if and only if conditions (3), (4) and (5) hold.
Suppose that V âˆˆÏ€(ËšXw
u ). Let r = râ€¢â€¢(V). Let a âˆˆZ and let b = fu,w(a); without loss of
generality we may assume that 1 â‰¤a â‰¤n. Set i = wâˆ’1(a). We now check that (a, b) is a
special entry of r.
Case 1: i Ì¸âˆˆ[k]. In this case fu,w(a) = utÏ‰kwâˆ’1(a) âˆˆ[n]. Since fu,w âˆˆBound(k, n), we
deduce that a â‰¤b â‰¤n. (Occasionally, our notation will implicitly assume a < b, we
leave it to the reader to check the boundary case.) By conditions (4) and (5),
dim Project[b] (V + Ea) = # (u([i]) âˆ©[b]) .
We can rewrite this as
dim (V + Ea + w0Enâˆ’b) = (n âˆ’b) + # (u([i]) âˆ©[b])
or, again,
dim Project[a+1,b](V) = # (u([i]) âˆ©[b]) âˆ’a.
(We have used a â‰¤b â‰¤n to make sure that dim Ea + w0Enâˆ’b = n âˆ’b + a.) In conclusion,
r(a+1)b = # (u([i]) âˆ©[b]) âˆ’a.
23

A similar computation gives us
r(a+1)(bâˆ’1) = # (u([i]) âˆ©[b âˆ’1]) âˆ’a.
We now wish to compute rab and ra(bâˆ’1). This time, we have V + Eaâˆ’1 = Eâ€¢(V)iâˆ’1. So
we deduce from condition (4) that
rab = # (u([i âˆ’1]) âˆ©[b]) âˆ’(a âˆ’1)
and
ra(bâˆ’1) = # (u([i âˆ’1]) âˆ©[b âˆ’1]) âˆ’(a âˆ’1).
Now, u(i) = u(wâˆ’1(a)) = b. So, r(a+1)b âˆ’r(a+1)(bâˆ’1) = 1 and, since b Ì¸âˆˆu([i âˆ’1]), we also
have rab âˆ’ra(bâˆ’1) = 0. So (a, b) is special as claimed.
Case 2: i âˆˆ[k]. In this case, b = u(i) + n and n + 1 â‰¤b â‰¤a + n. We mimic the previous
argument, using V âˆ©Ea âˆ©w0E2nâˆ’b in place of V +Ea +w0Enâˆ’b, the conclusion again is that
(a, b) is a special entry of r.
We have now checked, in both cases, that (a, b) is a special entry of r. Therefore, the
afï¬ne permutation g associated to r has g(a) = b. Since fu,w(a) = b, we have checked
that fu,w = g. We have thus shown that, if V âˆˆÏ€(ËšXw
u ), then V âˆˆËšÎ fu,w.
We now must prove the converse. Let râ€¢â€¢(V) = r(fu,w). Let (uâ€², wâ€²) be such that Eâ€¢(V) âˆˆ
ËšXwâ€²
uâ€² , so we know that V âˆˆÏ€(ËšXwâ€²
uâ€² ). By Lemma 5.7, wâ€² is Grassmannian. So râ€¢â€¢(V) =
r(fuâ€²,wâ€²) and fuâ€²,wâ€² = fu,w. However, by Proposition 3.15, this shows that [u, w]k and
[uâ€², wâ€²]k represent the same element of Q(k, n). Since w and wâ€² are both Grassmannian,
this means that u = uâ€² and w = wâ€², and V âˆˆÏ€(ËšXw
u ) as desired.
â–¡
5.4. Positroid varieties are projected Richardson varieties. Lusztig [Lus98] exhibited a
stratiï¬cation ` P(u,v,w) of Gr(k, n) indexed by triples (u, v, w) âˆˆSmax
n,k Ã— (Sk Ã— Snâˆ’k) Ã— Smin
n,k
satisfying u â‰¤wv, and showed that his strata satisfy
P(u,v,w) = Ï€(ËšXwv
u ) = Ï€(ËšXw
uvâˆ’1).
Furthermore, the projection Ï€ : Fâ„“(n) â†’Gr(k, n) restricts to an isomorphism on ËšXwv
u .
Using the bijection between the triples (u, v, w) and Q(k, n) (see Â§2.3), it thus follows
from Proposition 5.4 that
Theorem 5.9. The stratiï¬cation of Gr(k, n) by open positroid varieties is identical to Lusztigâ€™s
stratiï¬cation. If f = fu,w corresponds to âŸ¨u, wâŸ©under the bijection Q(k, n) â†’Bound(k, n) of
Â§3.4, then Ï€(ËšXw
u) = ËšÎ f. The varieties Î f and ËšÎ f are irreducible of codimension â„“(f), and ËšÎ f is
smooth. For any Richardson variety Xw
u , whether or not u â‰¤k w, the projection Ï€(Xw
u) is a closed
positroid variety.
Proof. Open Richardson varieties in the ï¬‚ag manifold are smooth and irreducible (by
Kleiman transversality). Lusztigâ€™s strata are, by deï¬nition, the projected open Richardson
varieties, which we have just showed are the same as the open positroid varieties. Lusztig
shows that Ï€ restricted to ËšXw
u is an isomorphism on its image, so dim Î f = dim Xw
u =
â„“(w) âˆ’â„“(u) and Î f is irreducible. By Theorem 3.16, â„“(w) âˆ’â„“(u) = k(n âˆ’k) âˆ’â„“(f), so ËšÎ f
has codimension â„“(f), as does its closure Î f.
See [KnLamSp, Proposition 3.3] for the fact that the projection of any Richardson Xw
u is
equal to the projection of some Xwâ€²
uâ€² with uâ€² anti-Grassmannian.
â–¡
24

For u â‰¤k w, we shall call Xw
u a Richardson model for Î fu,w. We refer the reader to
[KnLamSp] for a discussion of projections of closed Richardson varieties. In particular, for
any u â‰¤w (not necessarily a k-Bruhat relation) there exists a bounded afï¬ne permutation
f such that Ï€(Xw
u ) = Î f.
Postnikov [Pos] parametrized the â€œtotally nonnegative partâ€ of any open positroid va-
riety, showing that it is homeomorphic to an open ball. Before one knows that positroid
varieties are actually irreducible, one can use this parametrizability to show that only one
component intersects the totally nonnegative part of the Grassmannian. A priori there
might be other components, so it is nice to know that in fact there are not.
We now describe the containments between positroid varieties:
Theorem 5.10. Open positroid varieties form a stratiï¬cation of the Grassmannian. Thus for
f âˆˆBound(k, n) we have
Î f =
a
fâ€²â‰¥f
ËšÎ fâ€² = XJ1 âˆ©Ï‡(XJ2) âˆ©Â· Â· Â· âˆ©Ï‡nâˆ’1(XJn).
where (J1, J2, . . ., Jn) âˆˆJugg(k, n) corresponds to f.
Proof. Rietsch [Rie06] described the closure relations of Lusztigâ€™s stratiï¬cation of partial
ï¬‚ag varieties; see also [BroGooYa06]. The ï¬rst equality is Rietschâ€™s result, translated from
the language of Q(k, n) to Bound(k, n).
We know that XJ = `
Iâ‰¥J ËšXI. Using this to expand the intersection XJ1 âˆ©Ï‡(XJ2) âˆ©Â· Â· Â· âˆ©
Ï‡nâˆ’1(XJn) and applying Lemma 5.3 gives the second equality.
â–¡
We note that Postnikov [Pos] also described the same closure relations for the totally
nonnegative Grassmannian, using Grassmann necklaces and decorated permutations.
For a matroid M let
GGMS(M) = {V âˆˆGr(k, n) | âˆ†I(V) Ì¸= 0 â‡â‡’I âˆˆM}
denote the GGMS stratum of the Grassmannian [GeGorMacSe87]. Here for I âˆˆ
 [n]
k

, âˆ†I
denotes the PlÂ¨ucker coordinate labeled by the columns in I. Recall that in Section 3.6, we
have deï¬ned the positroid envelope of a matroid. It is easy to see that
ËšÎ f =
a
M: J (M)=J (f)
GGMS(M).
Proposition 5.11. Let M be a positroid. Then GGMS(M) is dense in ËšÎ J (M).
Proof. Suppose f âˆˆBound(k, n) is such that J (f) = J (M). Postnikov [Pos] showed
that the totally nonnegative part GGMS(M)â‰¥0 of GGMS(M) is a real cell of dimension
k(nâˆ’k)âˆ’â„“(f). Thus GGMS(M) has at least dimension k(nâˆ’k)âˆ’â„“(f). By Theorem 5.9 ËšÎ f
is irreducible with the same dimension. It follows that GGMS(M) is dense in ËšÎ J (M).
â–¡
Corollary 5.12. Let M be a positroid. Then as sets,
Î J (M) = GGMS(M) = {V âˆˆGr(k, n) | I /âˆˆM â‡’âˆ†I(V) = 0}.
Proof. The ï¬rst equality follows from Proposition 5.11. The second follows from Theo-
rem 5.10 and the description of Schubert varieties by vanishing of PlÂ¨ucker coordinates:
XJ = {V âˆˆGr(k, n) | I < Ïƒ(J) â‡’âˆ†I(V) = 0}.
â–¡
25

Consider the set on the right hand side of the displayed equation in Corollary 5.12.
Lauren Williams conjectured that this set was irreducible; this now follows from Corol-
lary 5.12 and Theorem 5.9.
5.5. Geometric properties of positroid varieties. The following results follow from The-
orem 5.9 and the geometric results of [KnLamSp].
Theorem 5.13. Positroid varieties are normal, Cohen-Macaulay, and have rational singularities.
Theorem 5.14. There is a Frobenius splitting on the Grassmannian that compatibly splits all the
positroid varieties therein. Furthermore, the set of positroid varieties is exactly the set of compatibly
split subvarieties of the Grassmannian.
Theorem 5.15. Let M be a positroid. Then the ideal deï¬ning the variety Î J (M) inside Gr(k, n)
is generated by the PlÂ¨ucker coordinates {âˆ†I : I /âˆˆM}.
Proof. By Theorem 5.10, Î J (M) is the set-theoretic intersection of some permuted Schubert
varieties. By the Frobenius splitting results of [KnLamSp], it is also the scheme-theoretic
intersection.
Hodge proved that Schubert varieties (and hence permuted Schubert varieties) are de-
ï¬ned by the vanishing of PlÂ¨ucker coordinates. (See e.g. [Ra87], where a great generaliza-
tion of this is proven using Frobenius splitting.) The intersection of a family of them is
deï¬ned by the vanishing of all their individual coordinates.
As explained in [FoZ00, Proposition 3.4], it is easy to determine which PlÂ¨ucker coordi-
nates vanish on a T-invariant subscheme X of the Grassmannian; they correspond to the
ï¬xed points not lying in X.
â–¡
Corollary 5.16. Let M be a positroid. Embed Gr(k, n) into P(n
k)âˆ’1 by the PlÂ¨ucker embedding.
Then the ideal of Î J (M) in P(n
k)âˆ’1 is generated in degrees 1 and 2.
Proof. By Theorem 5.15, the ideal of Î J (M) is the sum of a linearly generated ideal and the
ideal of Gr(k, n). It is classical that the ideal of Gr(k, n) is generated in degree 2.
â–¡
Remark 5.17. For a subvariety X âŠ†G/P âŠ†PV of a general ï¬‚ag manifold embedded in the
projectivization PV of an irreducible representation, one can ask whether X is deï¬ned as
a set by the vanishing of extremal weight vectors in V. This is easy to show for Schubert
varieties (see [FoZ00]) and more generally for Richardson varieties.
Since the above collorary proves this property for positroid varieties, and [FoZ00] prove
it for Richardson varieties in G/B, one might conjecture that it would be true for projected
Richardson varieties in other G/Ps. This is not the case: consider the Richardson variety
X4231
1324 projecting to a divisor in the partial ï¬‚ag manifold {(V1 âŠ‚V3 âŠ‚C4)}. One can check
that the image contains every T-ï¬xed point, so no extremal weight vector vanishes on it.
For any irreducible T-invariant subvariety X âŠ†G/P, the set of T-ï¬xed points XT âŠ†
(G/P)T âˆ¼= W/WP forms a Coxeter matroid [BorGeWh03], and X is contained in the set
where the extremal weight vectors corresponding to the complement of XT vanish. If the
containment is proper, as in the above example, one may take this as evidence that the
Coxeter matroid is not a good description of X. We saw a different knock against matroids
in Remark 1.1.
26

6. EXAMPLES OF POSITROID VARIETIES
In this section, we will see that a number of classical objects studied in algebraic geom-
etry are positroid varieties, or closely related to positroid varieties.
First, for any I âˆˆ
 [n]
k

, the Schubert variety XI in the Grassmannian is the positroid
variety associated to the positroid {J : J â‰¥I}. Similarly, the cyclically permuted Schubert
varieties Ï‡i Â· XI are also positroid varieties. Similarly, the Richardson varieties XK
I are
positroid varieties, corresponding to the positroid {J : I â‰¤J â‰¤K}.
Another collection of objects, closely related to Schubert varieties, are the graph Schubert
varieties. Let Xw be a Schubert variety in Fâ„“(n). Considering Fâ„“(n) as Bâˆ’\GLn (where
Bâˆ’is the group of invertible lower triangular matrices), let Xâ€²
w be the preimage of Xw
in GLn. The matrix Schubert variety MXw, introduced in [Fu92], is the closure of Xâ€²
w
in MatnÃ—n. MXw is cut out of MatnÃ—n by imposing certain rank conditions on the top-left
justiï¬ed submatrices (as was explained in Â§4.1). Embed MatnÃ—n into Gr(n, 2n) by the map
Î“ which sends a matrix M to the graph of the linear map âƒ—v 7â†’Mâƒ—v; its image is the big
cell {âˆ†[n] Ì¸= 0}. In coordinates, Î“(M) is the row span of the n Ã— 2n matrix [ Id M ]. We will
abuse notation by also calling this matrix Î“(M). We introduce here the graph Schubert
variety, GXw, as the closure of Î“(MXw) in Gr(n, 2n). Graph Schubert varieties will be
studied further in a separate paper by the ï¬rst author, [Kn3].
Let us write M[1,i],[1,j] for the top-left i Ã— j submatrix of M. Then the rank of M[1,i],[1,j]
is n âˆ’i less than the rank of the submatrix of Î“(M) using rows {i + 1, i + 2, . . ., n, n +
1, . . ., n+j}. So every point of GXw obeys certain rank bounds on the submatrices of these
types. These rank bounds are precisely the rank bounds imposed by r(f), where f is the
afï¬ne permutation f(i) = w(i) + n for 1 â‰¤i â‰¤n, f(i) = i + n for n + 1 â‰¤i â‰¤2n. So
GXw is contained in Î f, with equality on the open set Î“(MatnÃ—n). But Î f and GXw are
both irreducible, so this shows that GXw = Î f. In Â§7, we will see that cohomology classes
of general positroid varieties will correspond to afï¬ne Stanley symmetric functions; un-
der this correspondence, graph Schubert varieties give the classical Stanley symmetric
functions.
The example of graph Schubert varieties can be further generalized [BroGooYa06, Â§0.7].
Let u and v be two elements of Sn and consider the afï¬ne permutation f(i) = u(i) + n
for 1 â‰¤i â‰¤n, f(i) = vâˆ’1(i âˆ’n) + 2n for n + 1 â‰¤i â‰¤2n. (So our previous example
was when v is the identity.) Let us look at Î f âˆ©Î“(MatnÃ—n). This time, we impose condi-
tions both on the ranks of the upper left submatrices and the lower right submatrices. In
fact, ËšÎ f lies entirely within Î“(GLn) and is Î“ (Bâˆ’uB+ âˆ©B+vBâˆ’). This is essentially Fomin
and Zelevinskyâ€™s [FoZ01] double Bruhat cell. Precisely, the double Bruhat cell GLu,v
n
is
B+uB+ âˆ©Bâˆ’vBâˆ’. So the positroid variety Î f is the closure in Gr(n, 2n) of Î“(w0GLw0u,w0v
n
).
Finally, we describe a connection of positroid varieties to quantum cohomology, which
we discuss further in Â§8. For C any algebraic curve in Gr(k, n), one deï¬nes the degree
of C to be its degree as a curve embedded in P(n
k)âˆ’1 by the PlÂ¨ucker embedding; this can
also be described as
R
Gr(k,n)[C] Â· [Xâœ·] where Xâœ·is the Schubert divisor. Let I, J and K be
three elements of
 n
k

and d a nonnegative integer, d â‰¤k, such that codim XI + codim XJ +
codim XK = k(n âˆ’k) + dn.
Intuitively, the (genus zero) quantum product âŸ¨XIXJXKâŸ©d is the number of curves in
Gr(k, n), of genus zero and degree d, which meet XI(Fâ€¢), XJ(Gâ€¢) and XK(Hâ€¢) for a generic
27

choice of ï¬‚ags Fâ€¢, Gâ€¢ and Hâ€¢. This is made precise via the construction of spaces of stable
maps, see [FuPa97].
Deï¬ne E(I, J, d) to be the space of degree d stable maps of a genus zero curve with three
marked points to Gr(k, n), such that the ï¬rst marked point lands in XI and the second
marked point lands in XJ. Let S(I, J, d) be the subset of Gr(k, n) swept out by the third
marked point. It is intuitively plausible that âŸ¨XIXJXKâŸ©d is
R
Gr(k,n)[S(I, J, d)] Â· [XK] and we
will show that, under certain hypotheses, this holds. We will show that (under the same
hypotheses) S(I, J, d) is a positroid variety.
7. THE COHOMOLOGY CLASS OF A POSITROID VARIETY
Let Hâˆ—(Gr(k, n)), Hâˆ—
T(Gr(k, n)) denote the ordinary and equivariant (with respect to the
natural action of T = (Câˆ—)n) cohomologies of the Grassmannian, with integer coefï¬cients.
If X âŠ‚Gr(k, n) is a T-invariant subvariety of the Grassmannian, we let [X]0 âˆˆHâˆ—(Gr(k, n))
denote its ordinary cohomology class, and [X] âˆˆHâˆ—
T(Gr(k, n)) denote its equivariant co-
homology class. We also write [X]|p for the restriction of [X] to a T-ï¬xed point p. We
index the ï¬xed points of Gr(k, n) by
 [n]
k

. We use similar notation for the ï¬‚ag manifold
Fâ„“(n), whose ï¬xed points are indexed by Sn. Recall that Ï€ : Fâ„“(n) â†’Gr(k, n) denotes the
(T-equivariant) projection.
In [Lam06], a symmetric function ËœFf âˆˆSym is introduced for each afï¬ne permutation f.
Let Ïˆ : Sym â†’Hâˆ—(Gr(k, n)) denote the natural quotient map. In this section, we show
Theorem 7.1. Let f âˆˆBound(k, n). Then Ïˆ(ËœFf) = [Î f]0 âˆˆHâˆ—(Gr(k, n)).
7.1. Monkâ€™s rule for positroid varieties. The equivariant cohomology ring Hâˆ—
T(Gr(k, n))
is a module over Hâˆ—
T(pt) = Z[y1, y2, . . ., yn]. The ring Hâˆ—
T(Gr(k, n)) is graded with the
real codimension, so that deg(yi) = 2 and deg([X]T) = 2 codim(X) for an irreducible T-
equivariant subvariety X âŠ‚Gr(k, n).
Let Xâ–¡âˆˆHâˆ—
T(Gr(k, n)) denote the class of the Schubert divisor. Note that Ï€âˆ—(Xâ–¡) âˆˆ
Hâˆ—
T(Fâ„“(n)) is the class [Xsk] of the kth Schubert divisor. We recall the equivariant Monkâ€™s
formula (see for example [KosKu86]):
(6)
[Xsk].[Xw] = ([Xsk]|w).[Xw] +
X
wâ‹–kv
[Xv].
Proposition 7.2. Let Î f be a positroid variety with Richardson model Xw
u . Then
(7)
Xâ–¡Â· [Î f] = (Xâ–¡|Ïƒ(u)) Â· [Î f] +
X
uâ‹–kuâ€²â‰¤kw
[Î fuâ€²,w].
Here Ïƒ is the map Ïƒk : Sn â†’
 [n]
k

.
28

Proof. Let Xw
u be a Richardson model for Î f. Then, using the projection formula and (6),
we have in Hâˆ—
T(Gr(k, n)),
Xâ–¡Â· [Î f] = Ï€âˆ—(Ï€âˆ—(Xâ–¡) Â· [Xw] Â· [Xu])
= ([Xsk]|u) Â· [Î f] + Ï€âˆ—(
X
uâ‹–kuâ€²
[Xuâ€²] Â· [Xw])
= (Xâ–¡|Ïƒ(u)) Â· [Î f] +
X
uâ‹–kuâ€²
Ï€âˆ—([Xw
uâ€²]).
But
Ï€âˆ—([Xw
uâ€²]) =

[Î fuâ€²,w]
if uâ€² â‰¤k w,
0
otherwise.
â–¡
Corollary 7.3. Let Î f be a positroid variety with Richardson model Xw
u , and let Xâ–¡âŠ†Gr(k, n)
denote the Schubert divisor. Then as a scheme,
(u Â· Xâ–¡) âˆ©Î f =
[
uâ‹–kuâ€²â‰¤kw
Î fuâ€²,w.
Proof. The containment âŠ‡follows from Theorem 5.15. The above Proposition tells us that
the two sides have the same cohomology class, hence any difference in scheme structure
must occur in lower dimension; this says that (uÂ·Xâ–¡)âˆ©Î f is generically reduced (and has
no other top-dimensional components). But since Î f is irreducible and normal (Theorem
5.9 and Theorem 5.13), a generically reduced hyperplane section of it must be equidimen-
sional and reduced.
â–¡
Lemma 7.4. The collection of positroid classes [Î f] âˆˆHâˆ—
T(Gr(k, n)) are completely determined
by:
(1) [Î f] is homogeneous with degree deg([Î f]) = 2â„“(f),
(2) Proposition 7.2, and
(3) the positroid point classes

[Î tw.Ï‰k] = [Ïƒ(w)] | w âˆˆSmin
n,k
	
.
Proof. Let f âˆˆBound(k, n). We may assume by induction that the classes [Î fâ€²] for â„“(fâ€²) >
â„“(f) have all been determined. The case â„“(f) = k(n âˆ’k) is covered by assumption (3), so
we assume â„“(f) < k(n âˆ’k). Using Proposition 7.2, we may write
(Xâ–¡âˆ’Xâ–¡|Ïƒ(v)).[Î f] =
X
vâ‹–kvâ€²â‰¤kw
[Î f(vâ€²,w)].
Now, the class Xâ–¡âˆ’Xâ–¡|Ïƒ(v) does not vanish when restricted to any ï¬xed point J Ì¸= Ï€(v)
(see [KnTao03]), so the above equation determines [Î f]|J for every J Ì¸= Ï€(v). Thus if a and
b are two classes in Hâˆ—
T(Gr(k, n)) satisfying (7), then a âˆ’b must be supported on Ï€(v).
This means that a âˆ’b is a multiple of the point class [Ï€(v)]. But deg([Ï€(v)]) = 2k(n âˆ’k)
and deg(a) = deg(b) = â„“(f) < 2k(n âˆ’k) so a = b. Thus [Î f] is determined by the three
assumptions.
â–¡
29

7.2. Chevalley formula for the afï¬ne ï¬‚ag variety. Let f
Fâ„“(n) denote the afï¬ne ï¬‚ag vari-
ety of GL(n, C). We let {Î¾f âˆˆHâˆ—
T(f
Fâ„“(n)) | f âˆˆËœSn} denote the equivariant Schubert classes,
as deï¬ned by Kostant and Kumar in [KosKu86].
Now suppose that f âˆˆËœSn. We say that f is afï¬ne Grassmannian if f(1) < f(2) <
Â· Â· Â· < f(n).
For any f âˆˆËœSn, we write f0 âˆˆËœSn for the afï¬ne permutation given by
f0 = [Â· Â· Â·g(1)g(2) Â· Â· Â·g(n) Â· Â· Â·] where g(1), g(2), Â· Â· Â· , g(n) is the increasing rearrangement
of f(1), f(2), Â· Â· Â· , f(n). Then f0 is afï¬ne Grassmannian. Suppose that f â‹–g and f0 Ì¸= g0.
Then we say that g 0-covers f and write f â‹–0 g. These afï¬ne analogues of k-covers were
studied in [LamLapMoSh10].
For a transposition (ab) âˆˆËœS with a < b, we let Î±(ab) (resp. Î±âˆ¨
(ab)) denote the corre-
sponding positive root (resp. coroot), which we shall think of as an element of the afï¬ne
root lattice Q = Lnâˆ’1
i=0 Z Â· Î±i (resp. afï¬ne coroot lattice Qâˆ¨= Lnâˆ’1
i=0 Z Â· Î±âˆ¨
i ). We have
Î±(ab) = Î±a + Î±a+1 + Â· Â· Â· Î±bâˆ’1, where the Î±i are the simple roots, and the indices on the
right hand side are taken modulo n. A similar formula holds for coroots. Note that
Î±(ab) = Î±(a+n,b+n).
In the following s0 denotes [Â· Â· Â· k, k + 2, k + 3, . . ., k + n âˆ’1, k + n + 1 Â· Â· Â· ] âˆˆËœSn.
Lemma 7.5. Suppose that f âˆˆBound(k, n). Then
Î¾s0 Â· Î¾f = Î¾s0|f Â· Î¾f +
X
fâ‹–0gâˆˆBound(k,n)
Î¾g + other terms,
where the other terms are a linear combination of Schubert classes not labeled by Bound(k, n).
Proof. We deduce this formula by specializing the Chevalley formula for Kac-Moody ï¬‚ag
varieties in [KosKu86]12, which in our situation states that for any f âˆˆËœS,
Î¾s0 Â· Î¾f = Î¾s0|f Â· Î¾f +
X
fâ‹–g=fÂ·(ab)
âŸ¨Î±âˆ¨
(ab), Ï‡0âŸ©Î¾g
where Ï‡0 is a weight of the afï¬ne root system satisfying âŸ¨Î±âˆ¨
i , Ï‡0âŸ©= Î´i0. We see that
âŸ¨Î±âˆ¨
(ab), Ï‡0âŸ©= # ({. . . , âˆ’2n, âˆ’n, 0, n, 2n, . . .} âˆ©[a, b)).
Now suppose that g âˆˆBound(k, n). Since i â‰¤g(i) â‰¤i+n, if gÂ·(ab)â‹–g then we must have
0 < b âˆ’a < n. In this case, the condition that [a, b) intersects {. . . , âˆ’2n, âˆ’n, 0, n, 2n, . . .}
is the same as fâ‹–0 g, and furthermore one has âŸ¨Î±âˆ¨
(ab), Ï‡0âŸ©= 1. This proves the Lemma.
â–¡
7.3. Positroid classes and Schubert classes in afï¬ne ï¬‚ags. For the subsequent discussion
we work in the topological category. Our ultimate aim is to calculate certain cohomology
classes, and changing from the algebraic to the topological category does not alter the
answers. We refer the reader to [PrSe86, Mag] for background material.
Let Un denote the group of unitary n Ã— n matrices and let TR â‰ƒ(S1)n denote the sub-
group of diagonal matrices. We write LUn for the space of polynomial loops into Un, and
â„¦Un for the space of polynomial based loops into Un. It is known that LUn/TR is weakly
homotopy equivalent to f
Fâ„“(n), and that â„¦Un â‰ƒLUn/Un is weakly homotopy equivalent
to the afï¬ne Grassmannian (see [PrSe86]).
12The formula in Kostant and Kumar [KosKu86], strictly speaking, applies to the afï¬ne ï¬‚ag variety
f
Fâ„“(n)0 of SL(n). But each component of f
Fâ„“(n) is isomorphic to f
Fâ„“(n)0.
30

The connected components of â„¦Un and LUn are indexed by Z, using the map L det :
LUn â†’LU1 = Map(S1, U(1)) âˆ¼Ï€1(U(1)) = Z. We take as our basepoint of the k-
component of â„¦Un the loop t 7â†’diag(t, . . ., t, 1, . . ., 1), where there are k tâ€™s. Abusing
notation, we write tÏ‰k âˆˆâ„¦Un for this point, identifying the basepoint with a translation
element.
The group LUn acts on â„¦Un by the formula
(a Â· b)(t) = a(t)b(t)a(t)âˆ’1
where a(t) âˆˆLUn and b(t) âˆˆâ„¦Un. The group Un embeds in LUn as the subgroup of
constant loops. The action of LUn on â„¦Un restricts to the conjugation action of U(n) on
U(n). It then follows that the orbit of the basepoint under the action of Un
(8)
Un Â· tÏ‰k â‰ƒUn/(Uk Ã— Unâˆ’k)
is isomorphic to the Grassmannian Gr(k, n).
Thus we have a map q : Gr(k, n) Ö’â†’â„¦Un. Let r : â„¦Un â†’LUn/T be the map obtained
by composing the natural inclusion â„¦Un Ö’â†’LUn with the projection LUn Ö‰ LUn/T. We
let
p := r â—¦q : Gr(k, n) âˆ’â†’LUn/T
denote the composition of q and r. All the maps are TR-equivariant, so we obtain a ring
homomorphism pâˆ—: Hâˆ—
T(f
Fâ„“(n)) â†’Hâˆ—
T(Gr(k, n)).
Lemma 7.6. Suppose w âˆˆSmin
n,k and I = Ïƒ(w), which we identify with a T-ï¬xed point of Gr(k, n).
Then p(I) = twÂ·Ï‰kTR âˆˆLUn/TR.
Proof. It follows from the action of Sn â‰¤Un on â„¦Un that q(I) = twÂ·Ï‰k âˆˆâ„¦Un. But by
deï¬nition r(twÂ·Ï‰k) = twÂ·Ï‰k âˆˆLUn.
â–¡
Lemma 7.7.
(1) Suppose w âˆˆSmin
n,k . Then pâˆ—(Î¾twÂ·Ï‰k) = [Ïƒ(w)].
(2) pâˆ—(Î¾s0) = Xâ–¡.
Proof. We prove (1). Let f = twÂ·Ï‰k. It is enough to check that Î¾f|tuÂ·Ï‰k = [Ï€(w)]|Ïƒ(u) for
each u âˆˆSmin
n,k . We have [Ï€(w)]|Ïƒ(u) = 0 unless u = w. By [KosKu86, Proposition 4.24(a)],
Î¾f|g = 0 unless f â‰¤g. Since f is maximal in Bound(k, n), it is enough to calculate
Î¾f|f =
Y
Î±âˆˆfâˆ’1(âˆ†âˆ’)âˆ©âˆ†+
Î¸(Î±).
Here âˆ†+ (resp. âˆ†âˆ’) are the positive (resp. negative) roots of the root system of ËœSn, and
Î¸(Î±) âˆˆHâˆ—
T(pt) = Z[y1, y2, . . ., yn] denotes the image of Î± under the linear map deï¬ned by
Î¸(Î±i) =

yi âˆ’yi+1
for i = 1, 2, . . ., n âˆ’1,
yn âˆ’y1
for i = 0.
Applying Î¸ corresponds to specializing from Hâˆ—
TÃ—S1(f
Fâ„“(n)) to Hâˆ—
T(f
Fâ„“(n)).
With this terminology, Î±(ab) âˆˆfâˆ’1(âˆ†âˆ’) if and only if f(a) > f(b). We have Î¸(Î±(ab)) =
ya âˆ’yb, where the indices are taken modulo n. Thus
Î¾f|f =
Y
iâˆˆÏƒ(w) and jâˆˆ[n]\Ïƒ(w)
(yi âˆ’yj)
31

which is easily seen to agree with [Ï€(w)]|Ïƒ(w).
Now we prove (2). The class pâˆ—(Î¾s0) âˆˆHâˆ—
T(G/P) is of degree 2. So by [KnTao03, Lemma
1], it is enough to show that it vanishes when restricted to the identity basepoint, and
equals Xâ–¡|sk = yk âˆ’yk+1 when restricted to sk. We know that
Î¾s0|id = 0
and
Î¾s0|s0 = yk âˆ’yk+1
since id < s0, and the inversions of sâˆ’1
0
are exactly {Î±k}. (Here id denotes [Â· Â· Â· k + 1, k +
2, . . ., k + n Â· Â· Â· ].) But we have that tÏ‰k is in the same (right) Sn-coset as id and tskÂ·Ï‰k is
in the same Sn-coset as s0. Since Î¾s0 is a Grassmannian class, it follows that [KosKu86]
Î¾s0|id = Î¾s0|tÏ‰k and Î¾s0|s0 = Î¾s0|tskÂ·Ï‰k. Applying Lemma 7.6, we see that pâˆ—(Î¾s0) has the
desired properties.
â–¡
Theorem 7.8. For each f âˆˆËœSk
n, we have in Hâˆ—
T(Gr(k, n)),
pâˆ—(Î¾f) =

[Î f]
if f âˆˆBound(k, n),
0
otherwise.
Proof. Suppose f /âˆˆBound(k, n). Then by [KosKu86, Proposition 4.24(a)], Î¾f|g = 0 unless
f â‰¤g, so that Î¾f|g = 0 for g âˆˆBound(k, n) (using Lemma 3.6). It follows that pâˆ—(Î¾f)
vanishes at each T-ï¬xed point of Gr(k, n), and so it is the zero class.
We shall show that the collection of classes {pâˆ—(Î¾f) | f âˆˆBound(k, n)} satisï¬es the con-
ditions of Lemma 7.4. (1) is clear. (3) follows from Lemma 7.7(1). We check (2). The map
pâˆ—is a ring homomorphism, so the formula in Lemma 7.5 holds for the classes pâˆ—(Î¾f) as
well. Suppose f â‹–g âˆˆBound(k, n) and f = fu,w and g = fuâ€²,wâ€². As in the proof of Theorem
3.16, we may assume that either (1) uâ€² = u and wâ€² â‹–w, or (2) uâ€² â‹—u and wâ€² = w. If
f â‹–0 g, then writing fu,w = tuÂ·Ï‰kuwâˆ’1 and recalling that right multiplication by uwâˆ’1 acts
on the positions, we see that we must have u Â· Ï‰k Ì¸= uâ€² Â· Ï‰k. This implies that we are in
Case (2), and that uâ€² â‹—k u. Conversely, if wâ€² = w and uâ€² â‹—k u then we must have f â‹–0 g.
Comparing Lemma 7.5 and Proposition 7.2, and using Lemma 7.7(2), we see that we may
apply Lemma 7.4 to the classes {pâˆ—(Î¾f) | f âˆˆBound(k, n)}.
Thus pâˆ—(Î¾f) = [Î f] for every f âˆˆBound(k, n).
â–¡
7.4. Afï¬ne Stanley symmetric functions. Let Sym denote the ring of symmetric func-
tions over Z. For each f âˆˆËœS0
n, a symmetric function ËœFf âˆˆSym, called the afï¬ne Stanley
symmetric function is deï¬ned in [Lam06]. This deï¬nition extends to all f âˆˆËœSn via the
isomorphisms ËœSk
n â‰ƒËœS0
n.
We will denote the simple reï¬‚ections of the Coxeter group ËœS0
n by s0, s1, . . ., snâˆ’1, where
the indices are taken modulo n. Let w âˆˆËœS0
n. We say that w is cyclically decreasing if there
exists a reduced expression si1si2 Â· Â· Â·siâ„“for w such that (a) no simple reï¬‚ection is repeated,
and (b) if si and si+1 both occur, then si+1 precedes si. Then the afï¬ne Stanley symmet-
ric function ËœFf is deï¬ned by letting the coefï¬cient of xa1
1 xa2
2 Â· Â· Â·xar
r
in ËœFf(x1, x2, . . .) to be
equal to the number of factorizations w = w(1)w(2) Â· Â· Â· w(r), where each w(i) is cyclically
decreasing, â„“(w(i)) = ai, and â„“(w) = â„“(w(1)) + â„“(w(2)) + Â· Â· Â· + â„“(w(r)).
For example, consider k = 2, n = 4 and f = [5, 2, 7, 4]. The corresponding element of
ËœS0
n is f0 = [3, 0, 5, 2]; the reduced words for f0 are s1s3s0s2, s1s3s2s0, s3s1s0s2 and s3s1s2s0.
32

So the coefï¬cient of x1x2x3x4 in ËœFf is 4, corresponding to these 4 factorizations. Similar
computations yield that ËœFf = 4m1111 + 2m211 + m22 = s22 + s211 âˆ’s1111 where the mâ€™s are
the monomial symmetric functions and the sâ€™s are the Schur functions. Note that afï¬ne
Stanley symmetric functions are not necessarily Schur positive!
The ordinary cohomology Hâˆ—(â„¦SUn) can be identiï¬ed with a quotient of the ring of
symmetric functions:
Hâˆ—(â„¦SUn) â‰ƒSym/âŸ¨mÎ» | Î»1 > nâŸ©,
where mÎ» denotes the monomial symmetric function labeled by Î». We refer to [Sta99] for
general facts concerning symmetric functions, and to [Lam08] for more about Hâˆ—(â„¦SUn).
Let sÎ» âˆˆSym denote the Schur functions, labeled by partitions. As each component
of â„¦Un is homeomorphic to â„¦SUn, the inclusion q : Gr(k, n) â†’â„¦Un (deï¬ned after (8))
induces a map ËœÏˆ : Hâˆ—(â„¦SUn) â†’Hâˆ—(Gr(k, n)). Let Ïˆ : Sym â†’Hâˆ—(Gr(k, n)) denote the
composition of the quotient map Sym Ö‰ Hâˆ—(â„¦SUn) with ËœÏˆ : Hâˆ—(â„¦SUn) â†’Hâˆ—(Gr(k, n)).
For a partition Î» = (Î»1, Î»2, . . ., Î»k) with Î»1 â‰¤nâˆ’k, let Ïƒ(Î») be {Î»k+1, Î»kâˆ’1+2, . . . , Î»1+k}.
This is a bijection from partitions with at most k parts and largest part at most n âˆ’k to
 [n]
k

. We denote the set of such partitions by Par(k, n).
Lemma 7.9. The map Ïˆ : Sym â†’Hâˆ—(Gr(k, n)) is the natural quotient map deï¬ned by
Ïˆ(sÎ») =

[XÏƒ(Î»)]0
Î» âˆˆPar(k, n),
0
otherwise.
Proof. The copy of Gr(k, n) inside â„¦Un is the union of the
 n
k

Schubert varieties labeled
by the translation elements {twÂ·Ï‰k | w âˆˆSmin
n,k }. It follows that the map ËœÏˆ : Hâˆ—(â„¦SUn) â†’
Hâˆ—(Gr(k, n)) sends Schubert classes to Schubert classes.
It is well known that Hâˆ—(Gr(k, n)) is isomorphic to the quotient ring of Sym as stated
in the Lemma. To check that the quotient map agrees with Ïˆ, it sufï¬ces to check that
they agree on the homogeneous symmetric functions hi âˆˆSym, which generate Sym. In
[Lam08, Theorem 7.1] it is shown that the Schubert classes of Hâˆ—(â„¦SUn) are the â€œafï¬ne
Schur functionsâ€, denoted ËœFÎ». When Î» is a single row, we have ËœF(r) = hr âˆˆSym/âŸ¨mÎ» |
Î»1 > nâŸ©. Furthermore, the ï¬nite-dimensional Schubert variety in â„¦Un with dual Schubert
class ËœF(r) lies in Gr(k, n) âŠ‚â„¦Un exactly when r â‰¤n âˆ’k. It follows that Ïˆ(hr) = [X(r)]0 âˆˆ
Hâˆ—(Gr(k, n)) for r â‰¤n âˆ’k, and Ïˆ(hr) = 0 for r â‰¥n âˆ’k. Thus Ïˆ is the stated map.
â–¡
Proof of Theorem 7.1. Let Î¾f
0 âˆˆHâˆ—(f
Fâ„“(n)) denote the non-equivariant Schubert classes. It is
shown13 in [Lam08, Remark 8.6] that we have râˆ—(Î¾f
0) = ËœFf âˆˆHâˆ—(â„¦SUn), where we identify
ËœFf âˆˆSym with its image in Hâˆ—(â„¦SUn) = Sym/âŸ¨mÎ» | Î»1 > nâŸ©. Thus we calculate using the
non-equivariant version of Theorem 7.8
[Î f]0 = pâˆ—(Î¾f
0) = qâˆ—râˆ—(Î¾f
0) = Ïˆ(ËœFf).
â–¡
Recall our previous example where k = 2, n = 4 and f = [5274], with siteswap 4040.
This positroid variety is a point. The afï¬ne Stanley function ËœFf was s22 + s211 âˆ’s1111, so
Ïˆ(ËœFf) = Ïˆ(s22), the class of a point.
13The setup in [Lam08] involves â„¦SUn, but each component of â„¦Un is isomorphic to â„¦SUn so the
results easily generalize.
33

Example 7.10. Stanley invented Stanley symmetric functions in order to prove that the
number of reduced words for the long word w0 in Sm was equal to the number of standard
Young tableaux of shape (m âˆ’1, m âˆ’2, . . ., 2, 1). He showed that Fw0 = s(mâˆ’1)(mâˆ’2)Â·Â·Â·21, so
the number of reduced words for w0 is the coefï¬cient of the monomial m11Â·Â·Â·1 in the Schur
polynomial s(mâˆ’1)(mâˆ’2)Â·Â·Â·21, as required. See [Sta84] for more background. We show how to
interpret this result using positroid varieties.
Let (k, n) = (m, 2m). The Stanley symmetric function Fw0 is the afï¬ne Stanley associ-
ated to the afï¬ne permutation
v : i 7â†’

i + n
1 â‰¤i â‰¤n
w0(i âˆ’n) + 2n
n + 1 â‰¤i â‰¤2n
As discussed in section 6, the positroid variety Î v is a graph matrix Schubert variety,
and can be described as the Zariski closure, within G(m, 2m), of m-planes that can be
represented in the form
RowSpan
ï£«
ï£¬
ï£¬
ï£¬
ï£¬
ï£­
1
0
0
0
0
0
0
0
0
âˆ—
0
1
0
0
0
0
0
0
âˆ—
âˆ—
0
0
1
0
0
0
0
âˆ—
âˆ—
âˆ—
0
0
0
1
0
0
âˆ—
âˆ—
âˆ—
âˆ—
0
0
0
0
1
âˆ—
âˆ—
âˆ—
âˆ—
âˆ—
ï£¶
ï£·
ï£·
ï£·
ï£·
ï£¸
(The example shown is for m = 5.)
Reordering columns turns Î v into the Zariski closure of those m-planes that can be
represented in the form
RowSpan
ï£«
ï£¬
ï£¬
ï£¬
ï£¬
ï£­
0
0
0
0
0
0
0
0
1
âˆ—
0
0
0
0
0
0
1
âˆ—
0
âˆ—
0
0
0
0
1
âˆ—
0
âˆ—
0
âˆ—
0
0
1
âˆ—
0
âˆ—
0
âˆ—
0
âˆ—
1
âˆ—
0
âˆ—
0
âˆ—
0
âˆ—
0
âˆ—
ï£¶
ï£·
ï£·
ï£·
ï£·
ï£¸
This is the Schubert variety X1357Â·Â·Â·(2mâˆ’1), which is associated to the partition (m âˆ’1)(m âˆ’
2) Â· Â· Â·321. Reordering columns acts trivially in Hâ€¢(G(k, n)), so the cohomology classes of
Î v and X135Â·Â·Â·(2mâˆ’1) are the same, and they thus correspond to the same symmetric function.
This shows that Fw0 = s(mâˆ’1)(mâˆ’2)Â·Â·Â·21.
7.5. The K- and KT-classes of a positroid variety. We conjecture that the K-class of a
positroid variety is given by the afï¬ne stable Grothendieck polynomials deï¬ned in [Lam06].
These symmetric functions were shown in [LamSchiSh10] to have the same relationship
with the afï¬ne ï¬‚ag manifold as afï¬ne Stanley symmetric functions, with K-theory replac-
ing cohomology.
Conjecture 7.11. The K-theory class of the structure sheaf of a positroid variety Î f is given by
the image of the afï¬ne stable Grothendieck polynomial ËœGf, when Kâˆ—(Gr(k, n)) is identiï¬ed with a
ring of symmetric functions as in [Buc02].
This conjecture would follow from suitable strengthenings of Proposition 7.2, Lemma
7.4, and Lemma 7.5. We have the necessary characterization of the KT positroid classes:
Corollary 7.3 and the main result of [Kn2] give the KT-analogue of Proposition 7.2. The
34

degree-based argument used in Lemma 7.4 must be modiï¬ed, in the absence of a grad-
ing on K-theory, to comparing pushforwards to a point, and it is easy to show using
[KnLamSp, Theorem 4.5] that the pushforward of a positroid class is 1. What is currently
missing are the two corresponding results on afï¬ne stable Grothendieck polynomials.
While the class associated to an algebraic subvariety of a Grassmannian is always a
positive combination of Schubert classes, this is not visible from Theorem 7.1, as afï¬ne
Stanley functions are not in general positive combinations of Schur functions sÎ».
We can give a much stronger positivity result on positroid classes:
Theorem 7.12. Let X be a positroid variety, and [OX] âˆˆKT(Gr(k, n)) the class of its structure
sheaf in equivariant K-theory. Then in the expansion [OX] = P
Î» aÎ»[OÎ»] into classes of Schubert
varieties, the coefï¬cient aÎ» âˆˆKT(pt) lies in (âˆ’1)|Î»|âˆ’dim XN [{eâˆ’Î±i âˆ’1}], where the {Î±i} are the
simple roots of GL(n).
Proof. This is just the statement of [AGriMil, Corollary 5.1], which applies to any T-
invariant subvariety X of a ï¬‚ag manifold such that X has rational singularities (as positroid
varieties do, [KnLamSp, Corollary 4.8]).
â–¡
After our ï¬rst version of this preprint was circulated, a very direct geometric proof
of Theorem 7.8 was given in [Sni10], which also proves the corresponding statement in
equivariant K-theory. Snider identiï¬es each afï¬ne patch on Gr(k, n) with an opposite
Bruhat cell in the afï¬ne ï¬‚ag manifold, T-equivariantly, in a way that takes the positroid
stratiï¬cation to the Bruhat decomposition, thereby corresponding the KT-classes.
8. QUANTUM COHOMOLOGY, TORIC SCHUR FUNCTIONS, AND POSITROIDS
8.1. Moduli spaces of stable rational maps to the Grassmannian. For background mate-
rial on stable maps we refer the reader to [FuWo04]. Let I, J âˆˆ
 [n]
k

, which we assume to be
ï¬xed throughout this section. We now investigate the variety S(I, J, d) consisting of points
lying on a stable rational map of degree d, intersecting XJ âŠ‚Gr(k, n) and XI âŠ‚Gr(k, n).
Let M0,3(d) denote the moduli space of stable rational maps to Gr(k, n) with 3 marked
points and degree d. Write p1, p2, p3 : M0,3(d) â†’Gr(k, n) for the evaluations at the three
marked points.
Denote by E(I, J, d) the subset
E(I, J, d) = pâˆ’1
1 (XJ) âˆ©pâˆ’1
2 (XI) âŠ‚M0,3(d).
It is known [FuWo04] that E(I, J, d) is reduced and locally irreducible, with all com-
ponents of dimension dim(XJ) + dim(XI) + dn âˆ’k(n âˆ’k). Furthermore, the pushfor-
ward (p3)âˆ—([E(I, J, d)]) âˆˆHâˆ—(Gr(k, n)) is a generating function for three-point, genus zero,
Gromov-Witten invariants, in the sense that
(9)
(p3)âˆ—([E]) Â· Ïƒ = âŸ¨[XJ], [XI], ÏƒâŸ©d
for any class Ïƒ âˆˆHâˆ—(Gr(k, n)). We now deï¬ne S(I, J, d) := p3(E(I, J, d)). Let us say that
there is a non-zero quantum problem for (I, J, d) if âŸ¨[XJ], [XI], ÏƒâŸ©d is non-zero for some
Ïƒ âˆˆHâˆ—(Gr(k, n)). It follows from (9) that S(I, J, d) and E(I, J, d) have the same dimension
whenever there is a non-zero quantum problem for (I, J, d), namely,
(10)
dim(S(I, J, d)) = dim(E(I, J, d)) = dim(XJ) + dim(XI) + dn âˆ’k(n âˆ’k).
35

The torus T acts on M0,3(d) and, since XJ and XI are T-invariant, the space E(I, J, d) also
has a T-action. The torus ï¬xed-points of E(I, J, d) consist of maps f : C â†’Gr(k, n), where
C is a tree of projective lines, such that fâˆ—(C) is a union of T-invariant curves in Gr(k, n)
whose marked points are T-ï¬xed points, satisfying certain stability conditions. Since p3
is T-equivariant, we have S(I, J, d)T = p3(E(I, J, d)T). The T-invariant curves in Gr(k, n)
connect pairs of T-ï¬xed points labeled by I, J âˆˆ
 [n]
k

satisfying |I âˆ©J| = k âˆ’1. Weâ€™ll write
T(I, J, d) for S(I, J, d)T, considered as a subset of
 [n]
k

.
We now survey the rest of this section. In Â§8.2, we use the ideas of the previous para-
graph to give an explicit combinatorial description of T(I, J, d). We then deï¬ne an ex-
plicit afï¬ne permutation f associated to (I, J, d) in (11) below.
We say that (I, J, d) is
valid if for i âˆˆI, we have i + k â‰¤f(I, J, d)(i) â‰¤i + n and, for m âˆˆ[n] \ I, we have
m â‰¤f(I, J, d)(m) â‰¤m + k. In particular, (I, J, d) is valid implies f(I, J, d) is bounded. The
main result of this section is:
Theorem 8.1. When (I, J, d) is valid, the image p3(E(I, J, d)) is Î f. Moreover, there is one
component F0 of E(I, J, d) for which p3 : F0 â†’Î f is birational; on any other component F of
E(I, J, d), we have dim p3(F) < dim F.
When (I, J, d) is not valid, then dim p3(F) < dim F for every component F of E(I, J, d). Thus,
(I, J, d) is valid if and only if there is a non-zero quantum problem for (I, J, d).
Our key combinatorial result is
Proposition 8.2. Let (I, J, d) be valid.
Then T(I, J, d) is the positroid corresponding to the
bounded afï¬ne permutation f(I, J, d).
We should point out that we use previously known formulas for Gromov-Witten invari-
ants to establish part of Theorem 8.1. Namely, when f is valid, we can establish directly
that p3(E(I, J, d)) âŠ†Î f. To prove that (p3)âˆ—([E]) = [Î f], we combine previous work of
Postnikov with Theorem 7.1.
It was shown in [Lam06] that Ïˆ(ËœFf) is Postnikovâ€™s â€œtoric Schur functionâ€. Postnikov
showed that this toric Schur function computed Gromov-Witten invariants but did not
provide a subvariety of Gr(k, n) representing his class; Theorem 8.1 can thus be viewed
as a geometric explanation for toric Schur functions.
8.2. Formulas for T(I, J, d) and f(I, J, d). We proceed to describe S(I, J, d)T explicitly.
If I âˆˆ
 [n]
k

, then we let A(I) (resp. B(I)) denote the upper (resp. lower) order ideals
generated by I. Thus A(J) = {K âˆˆ
 [n]
k

| K â‰¥J} is the set of T-ï¬xed points lying in XJ
and B(I) is the set of T-ï¬xed points lying in XI. Deï¬ne the undirected Johnson graph Gk,n
with vertex set
 [n]
k

, and edges I â†”J if |I âˆ©J| = k âˆ’1. The distance function dist(I, J) in
Gk,n is given by dist(I, J) = k âˆ’|I âˆ©J|. Then one has
S(I, J, d)T = T(I, J, d) :=

K âˆˆ
[n]
k

| dist(K, B(I)) + dist(K, A(J)) â‰¤d

.
For a pair (I, J), it is shown in [FuWo04] the minimal d such that T(I, J, d) is non-empty
(or equivalently, that there is a path of length d from I to J in Gk,n), is equal to the minimal
d such that a non-zero quantum problem for (I, J, d) exists.
Denote by M = {m1 < m2 < Â· Â· Â· < mnâˆ’k} the complement of I in [n] and similarly
L = {l1 < l2 < Â· Â· Â· < lnâˆ’k} the complement of J. We deï¬ne a bi-inï¬nite sequence Ëœi such
36

that Ëœia = ia for 1 â‰¤a â‰¤k and Ëœia+k = Ëœia + n. Similarly, we extend J, M and L to bi-inï¬nite
sequencesËœj, Ëœm and Ëœl, such thatËœja+k = Ëœja +n, Ëœma+nâˆ’k = Ëœma +n and Ëœla+nâˆ’k = Ëœla +n. Deï¬ne
an afï¬ne permutation f(I, J, D) by
(11)
f(I, J, d)(Ëœir) = Ëœjr+kâˆ’d
f(I, J, d)( Ëœmr) = Ëœlr+d
We say that (I, J, d) is valid if, for i âˆˆI, we have i + k â‰¤f(I, J, d)(i) â‰¤i + n and, for
m âˆˆM, we have m â‰¤f(I, J, d)(m) â‰¤m + k. In particular, if (I, J, d) is valid, then f(I, J, d)
is bounded.
For example, let k = 2 and n = 6. Pick I = {1, 4}, J = {2, 4}, d = 1. Then M =
{2, 3, 5, 6} and L = {1, 3, 5, 6}. The equation f(Ëœir) = Ëœjr+kâˆ’d gives f(1) = 4 and f(4) = 8. The
equation f( Ëœmr) = Ëœlr+d gives f(2) = 3, f(3) = 5, f(5) = 6 and f(6) = 7. Thus f(I, J, d) =
[Â· Â· Â·435867 Â· Â· Â·].
Our next task is to prove proposition 8.2; we shorten f(I, J, d) to f. Our approach is to
ï¬rst ï¬nd the cyclic rank matrix for f. Let ËœI and ËœJ be the preimages of I and J under the pro-
jections Z â†’Z/nZ. For integers a â‰¤b, we adopt the shorthand I[a, b] for #

ËœI âˆ©[a, b]

and similar notations J[a, b) etcetera. For 1 â‰¤a â‰¤b â‰¤a + n, deï¬ne
(12)
rab := min (b âˆ’a + 1, d + J[1, b] âˆ’I[1, a), k)
and deï¬ne rab for all rab such that ra+n,b+n = rab; by rab = b âˆ’a + 1 for a > b and by
rab = k for a + n < b.
Lemma 8.3. If (I, J, d) is valid, then the matrix rab is the cyclic rank matrix for f.
It will be convenient to introduce the functions Î±1(a, b) = b âˆ’a + 1, Î±2(a, b) = d +
J[1, b] âˆ’I[1, a) and Î±3(a, b) = k, so that rab = min(Î±1(a, b), Î±2(a, b), Î±3(a, b)).
Proof. We ï¬rst check that rab is a cyclic rank matrix, meaning that it obeys the conditions
in Corollary 3.12. Conditions (C1â€²), (C2â€²) and (C5) hold by deï¬nition.
For r = 1, 2 or 3, it is easy to see that, Î±r(a, b) âˆ’Î±r(a + 1, b) and Î±r(a, b + 1) âˆ’Î±r(a, b)
are clearly either 0 or 1, and are integer valued. So rab âˆ’r(a+1)b) and rab âˆ’ra(bâˆ’1) are either
0 or 1. This veriï¬es (C3).
Similarly, for any (a, b) and r = 1, 2 or 3, the 2 Ã— 2 matrix

Î±r(a,bâˆ’1)
Î±r(a,b)
Î±r(a+1,bâˆ’1) Î±r(a+1,b)

is of one
of the forms

s
s
s
s


s
s + 1
s
s + 1


s + 1
s + 1
s
s


s + 1
s + 2
s
s + 1

for some integer s. Looking at what happens when we take the minimum of three ma-
trices of this form (where we never take both the two middle matrices), we see that we
always get one of the above forms, or
  s+1 s+1
s
s+1

. In particular, condition (C4) holds. We
have now shown that rab is a cyclic rank matrix. Let g be the associated permutation.
We now show that g = f. Let (a, b) = (ir,Ëœjr+kâˆ’d) for some r between 1 and k. Then
#

ËœI âˆ©[1, a)

= râˆ’1 and #

ËœJ âˆ©[1, b]

= r+kâˆ’d, so Î±2(a, b) = k+1. Similar arguments
let us compute

Î±2(a, b âˆ’1)
Î±2(a, b)
Î±2(a + 1, b âˆ’1)
Î±2(a + 1, b)

=

k
k + 1
k âˆ’1
k

.
37

The assumption that ir + k â‰¤f(I, J, d)(ir) = Ëœjr+kâˆ’d translates into b âˆ’a â‰¥k, so the Î±1 term
in (12) has no effect and we deduce that

ra,bâˆ’1
ra,b
ra+1,bâˆ’1
ra+1,b

=

k
k
k âˆ’1
k

.
By the last sentence of Corollary 3.10, this means that g(a) = b.
Similarly, if (a, b) = (mr,Ëœlr+d) we can show that g(a) = b. So, for every a âˆˆZ, we have
shown that g(a) = f(a), as desired.
â–¡
We now begin proving the lemmas which will let us prove Proposition 8.2.
Lemma 8.4. We have dist(K, B(I)) â‰¤s if and only if for all r âˆˆ[n], one has I[1, r) âˆ’K[1, r) â‰¤s.
Proof. Suppose dist(K, B(I)) â‰¤s. Then dist(K, L) â‰¤s for some L â‰¤I. Thus for each r, we
have I[1, r) âˆ’K[1, r) â‰¤L[1, r) âˆ’K[1, r) â‰¤s.
Now suppose I[1, r) âˆ’K[1, r) â‰¤s for each r. Construct L â‰¤I recursively, starting with
L = âˆ…. Assume L âˆ©[1, r) is known. If r âˆˆK, place r in L. Otherwise, if r /âˆˆK, place r in L
only if r âˆˆI and L[1, r) = I[1, r). Repeat until we have constructed a k-element subset L
which clearly satisï¬es L â‰¤I. The elements in L \ K are all in I. Let â„“be the largest element
in L\K. Then I[1, â„“] differs from K[1, â„“] by |L\K|, and so |L\K| â‰¤s. Thus dist(K, L) â‰¤s.
â–¡
Lemma 8.5. We have K âˆˆT(I, J, d) if and only if
(13)
I[1, r) âˆ’K[1, r) + K[1, s) âˆ’J[1, s) â‰¤d
for all 1 â‰¤r, s, â‰¤n + 1.
Proof. By Lemma 8.4, we have K âˆˆT(I, J, d) if and only if
(14)
max(I[1, r) âˆ’K[1, r), 0) + max(K[1, s) âˆ’J[1, s), 0) â‰¤d
for all 1 â‰¤r, s, â‰¤n+1. Equation (14) certainly implies the stated condition. Conversely, if
(13) holds, but (14) fails, then we must have I[1, r) âˆ’K[1, r) > d or K[1, s) âˆ’J[1, s) > d for
some r, s. In the ï¬rst case setting s = 1 in (13) gives a contradiction. In the second case,
setting r = 1 gives a contradiction.
â–¡
Proof of Proposition 8.2. First, suppose that K âˆˆT(I, J, d).
By Lemma 8.3, K is in the positroid corresponding to f(I, J, d) if and only if for each
cyclic interval [a, b] âŠ‚[n] we have
K[a, b] â‰¤min(b âˆ’a + 1, d + J[1, b] âˆ’I[1, a), k).
Since #[a, b] = bâˆ’a+1 and #(K) = k, we always have K[a, b] â‰¤bâˆ’a+1 and K[a, b] â‰¤k,
so we must check that K[a, b] â‰¤d + J[1, b] âˆ’I[1, a).
First, suppose that 1 â‰¤a â‰¤b â‰¤n. Then K[a, b] = K[1, b] âˆ’K[1, a) so the required
equation is
K[1, b] âˆ’K[1, a) â‰¤d + J[1, b] âˆ’I[1, a).
This is easily equivalent to (13) for (r, s) = (a, b). Now, suppose that a â‰¤n < b. Then
K[a, b] := K[1, b] âˆ’K[1, a) and we again want to show that K[1, b] âˆ’K[1, a) â‰¤d + J[1, b] âˆ’
I[1, a). Let b = bâ€² + n. Then K[1, b] = K[1, bâ€²] + n and J[1, b] = J[1, bâ€²] + n. So it is
equivalent to show
K[1, bâ€²] âˆ’K[1, a) â‰¤d + J[1, bâ€²] âˆ’I[1, a)
38

which is (13) for (r, s) = (a, bâ€²).
The reverse implication is similar.
â–¡
8.3. Toric shapes and toric Schur functions. In [Pos05], Postnikov introduced a family
of symmetric polynomials, called toric Schur polynomials, and showed that the expansion
coefï¬cients of these symmetric functions in terms of Schur polynomials gave the three-
point, genus zero, Gromov-Witten invariants of the Grassmannian. In [Lam06], it was
shown that toric Schur functions were special cases of afï¬ne Stanley symmetric functions.
We now put these results in the context of Theorem 7.1 and equation (9): the subvariety
S(I, J, d) âŠ‚Gr(k, n) is a positroid variety whose cohomology class is a toric Schur poly-
nomial.
We review the notion of a toric shape and refer the reader to [Pos05] for the notion of a
toric Schur function. A cylindric shape is a connected, row and column convex subset of
Z2 which is invariant under the translation (x, y) 7â†’(x + n âˆ’k, y âˆ’k). Also, every row
or column of a cylindric shape must be ï¬nite, and in addition the â€œborderâ€ of a cylindric
shape is an inï¬nite path which has steps going north and east only (when read from the
southwest). A toric shape is a cylindric shape such that every row has at most n âˆ’k
boxes, and every column has at most k boxes. For example, the following is a toric shape
for k = 2, n = 5:
where a fundamental domain for the action of the translation has been highlighted. In
[Pos05], Postnikov associated a toric shape Î¸(I, J, d) to each triple (I, J, d) for which a non-
trivial quantum problem could be posed involving the Schubert varieties XI and XJ, and
rational curves of degree d. The steps of the upper border of Î¸ is determined by I, the
lower border by J. The gap between the two borders is determined by d. We do not give
a precise description of Postnikovâ€™s construction here as our notations differ somewhat
from Postnikovâ€™s.
If Î¸ is a cylindric shape, we can obtain an afï¬ne permutation as follows. First label
the edges of the upper border of Î¸ by integers, increasing from southwest to northeast.
Now label the edges of the lower border of Î¸ by integers, so that if e and eâ€² are edges
on the upper border and lower border respectively, and they lie on the same northwest-
southeast diagonal, then eâ€² has a label which is k bigger than that of e. One then deï¬nes
f(Î¸) as follows: if a âˆˆZ labels a vertical step of the upper border, then f(a) is the label of
the step of the lower border on the same row; if a âˆˆZ labels a horizontal step, then f(a)
is the label of the step of the lower border on the same column. This determines Î¸(I, J, d)
from f(I, J, d) up to a translation: the equations (11) say that the labels inside I or J are
vertical steps, while labels in M and L are horizontal steps.
The condition that (I, J, d) is valid translates to Î¸(I, J, d) being toric. In our language,
Postnikov [Pos05, Lemma 5.2 and Theorem 5.3] shows that a non-trivial quantum prob-
lem exists for (I, J, d) if and only if the toric shape Î¸(I, J, d) is well-deï¬ned. Thus:
39

Lemma 8.6. A non-trivial quantum problem exists for (I, J, d) if and only if (I, J, d) is valid.
Lemma 8.7. Suppose (I, J, d) is valid. Then
â„“(f(I, J, d)) = |Î¸(I, J, d)| = codim(XJ) + codim(XI) âˆ’dn.
where |Î¸(I, J, d)| is the number of boxes in a fundamental domain for Î¸(I, J, d).
Proof. The ï¬rst equality follows from [Lam06], and can be explained simply as follows:
each box in a fundamental domain for Î¸(I, J, d) corresponds to a simple generator in a
reduced expression for f(I, J, d). Indeed, the equations (11) can be obtained by ï¬lling
Î¸(I, J, d) with a wiring diagram, where each wire goes straight down (resp. across) from
a horizontal (resp. vertical) step. The second equality follows from [Pos05]. A simple
proof is as follows: if we decrease d by 1, then the lower border of d is shifted one step
diagonally southeast, increasing |Î¸(I, J, d)| by n. When the upper and lower borders are
far apart, then changing codim(XI) or codim(XJ) by one also changes |Î¸(I, J, d)| by one.
Finally, when I = J and d = 0, one checks that |Î¸(I, J, d)| is k(n âˆ’k).
â–¡
Proof of Theorem 8.1. Suppose that (I, J, d) is valid.
Consider any index K âˆˆ
 [n]
k

\ T(I, J, d). Then the PlÂ¨ucker coordinate pK is zero on
T(I, J, d), and hence on S(I, J, d). By Corollary 5.12, Î f is cut out by {pK = 0 | K /âˆˆT(I, J, d)},
so S(I, J, d) âŠ†Î f.
By Lemma 8.7, (10) and Theorem 5.9, S(I, J, d) and Î f(I,J,d) have the same dimension and
Î f is irreducible. So S(I, J, d) = Î f. Now, let F1, F2, . . . , Fr be the components of E(I, J, d);
let c1, c2, . . . , cr be the degrees of the maps p3 : Fi â†’S(I, J, d). Using again that Î f is
irreducible, we know that (p3)âˆ—(E(I, J, d)) = (Pr
i=1 ci) [Î f]. By the main result of [Pos05],
the left hand side of this equation is the toric Schur polynomial with shape Î¸(I, J, d) and
by [Lam06, Proposition 33], this is the afï¬ne Stanley function Ïˆ(ËœFf). But by Theorem 7.1,
the right hand side is (Pr
i=1 ci) Ïˆ(ËœFf). So Pr
i=1 ci = 1. We deduce that p3 is birational on
one component of S(I, J, d) and collapses every other component.
Finally, if (I, J, d) is not valid, then there is no nonzero quantum product for (I, J, d) by
Lemma 8.6, so p3 must collapse all components of E(I, J, d) in this case.
â–¡
8.4. Connection with two-step ï¬‚ag varieties. Let Fâ„“(k âˆ’d, k, k + d; n) and Fâ„“(k âˆ’d, k +
d; n) be the spaces of three-step and two-step ï¬‚ags of dimensions (k âˆ’d, k, k + d) and
(k âˆ’d, k + d) respectively. We have maps q1 : Fâ„“(k âˆ’d, k, k + d; n) â†’Gr(k, n) and
q2 : Fâ„“(k âˆ’d, k, k + d; n) â†’Fâ„“(k âˆ’d, k + d; n). For a subvariety X âŠ‚Gr(k, n) we deï¬ne,
following [BucKresTam03],
X(d) = q2(qâˆ’1
1 (X)) âŠ‚Fâ„“(k âˆ’d, k + d; n).
Let us now consider the subvariety
Y(I, J, d) = (XJ)(d) âˆ©(XI)(d) âŠ‚Fâ„“(k âˆ’d, k + d; n).
Buch-Kresch-Tamvakis studied varieties similar to Y(I, J, d), which arise from intersec-
tions of three Schubert varieties, and showed in a bijective manner that these intersec-
tions solved quantum problems. Let us now consider the subvariety q1(qâˆ’1
2 (Y(I, J, d))) âŠ‚
Gr(k, n). The subvarieties (XJ)(d), (XI)(d) âŠ‚Fâ„“(k âˆ’d, k + d; n) are Schubert (and oppo-
site Schubert) subvarieties. Thus q1(qâˆ’1
2 (Y(I, J, d))) âŠ‚Gr(k, n) is a positroid variety by
Theorem 5.9.
40

The following result can also be deduced directly from [BucMih].
Proposition 8.8. Suppose (I, J, d) is valid. Then q1(qâˆ’1
2 (Y(I, J, d))) = S(I, J, d).
Proof. Let us ï¬rst show that S(I, J, d) âŠ‚q1(qâˆ’1
2 (Y(I, J, d))). Since (I, J, d) is valid, we know
that dim S(I, J, d) = dim(XJ) + dim(XI) + dn âˆ’k(n âˆ’k) =: N. Choose K âˆˆ
 [n]
d

such that
codim XK = N and âŸ¨[S(I, J, d)], [XK]âŸ©Ì¸= 0. Then, for a general ï¬‚ag Fâ€¢, S(I, J, d) intersects
XK(Fâ€¢) at a ï¬nite set of points. Moreover, the set of all points that occur as such intersec-
tions is dense in S(I, J, d). (If this set were contained in a subvariety of smaller dimension,
then XK(Fâ€¢) would miss S(I, J, d) for generic Fâ€¢, contradicting our choice of K.)
So, for V in a dense subset of S(I, J, d), we know that V also lies on some XK(Fâ€¢) and we
can impose furthermore that Fâ€¢ is in general position with both Eâ€¢ and w0Eâ€¢. It follows
from [BucKresTam03, Theorem 1] that there is a corresponding point W âˆˆY(I, J, d) such
that V âˆˆq1(qâˆ’1
2 (W)). Thus S(I, J, d) âŠ‚q1(qâˆ’1
2 (Y(I, J, d))).
Conversely, let W âˆˆY(I, J, d) be a generic point, and Z = q1(qâˆ’1
2 (W)) âŠ‚Gr(k, n).
The space Z is isomorphic to Gr(d, 2d). Pick a point U âˆˆZ âˆ©XJ and V âˆˆZ âˆ©XI, and
another generic point T âˆˆZ. By [BucKresTam03, Proposition 1], there is a morphism
f : P1 â†’Z âŠ‚Gr(k, n) of degree d which passes through U, V, and T. It follows that a
generic point in Z lies in S(I, J, d). Thus q1(qâˆ’1
2 (Y(I, J, d))) âŠ‚S(I, J, d).
â–¡
8.5. An example. Let k = 2 and n = 5. We take I = J = {1, 4} and d = 1. The afï¬ne
permutation f(I, J, d) is [Â· Â· Â·43567 Â· Â· Â·], with siteswap 31222. The positroid T(I, J, d) is
{12, 13, 14, 15, 24, 25, 34, 35, 45}and the juggling states are J (f(I, J, d)) = (12, 13, 12, 12, 12).
If we pull back Y(I, J, d) to Fâ„“(n) we get the Richardson variety X45132
12435. (Following the de-
scription given in [BucKresTam03], we obtained 12435 by sorting the entries of the Grass-
mannian permutation 14235 in positions kâˆ’d+1, kâˆ’d+2, . . . , k+d in increasing order.
For 45132, we ï¬rst applied w0 to J = {1, 4} to get {2, 5}. Then we did the sorting, and
left-multiplied by w0 again.)
By [KnLamSp, Proposition 3.3], we have Ï€(X45132
12435) = Ï€(X54312
21543). With (u, w) = (21543, 54312),
we have fu,w = [2, 1, 5, 4, 3] Â· t(1,1,0,0,0) Â· [4, 5, 3, 2, 1] = [4, 3, 5, 6, 7], agreeing with f(I, J, d).
Alternatively, one can check that the T-ï¬xed points inside X54312
21543, that is, the interval
[21543, 54312], project exactly to T(I, J, d).
REFERENCES
[AGriMil] D. ANDERSON, S. GRIFFETH, E. MILLER: Positivity and Kleiman transversality in equivariant
K-theory of homogeneous spaces. http://arxiv.org/abs/0808.2785 (In Â§7.5)
[BeSo98] N. BERGERON, F. SOTTILE: Schubert polynomials, the Bruhat order, and the geometry of ï¬‚ag
manifolds, Duke Math. J. 95 (1998), no. 2, 373â€“423. http://arxiv.org/abs/alg-geom/9703001 (In
Â§2.3, 2.1, and 2.5)
[BiCo] S. BILLEY,
I. COSÂ¸KUN:
Singularities of generalized Richardson varieties,
preprint 2010.
http://arxiv.org/abs/1008.2785 (In Â§1.1)
[BjBre05] A. BJ Â¨ORNER, F. BRENTI: Combinatorics of Coxeter Groups, Graduate Texts in Mathematics, 231.
Springer-Verlag, New York, 2005. (In Â§3.3)
[BjWac82] A. BJ Â¨ORNER, M. WACHS: Bruhat order of Coxeter groups and shellability, Adv. in Math. 43
(1982), no. 1, 87â€“100. (In Â§3.5)
[BoDM06] J. BONIN, A. DE MIER: Lattice path matroids: Structural properties, European Journal of Com-
binatorics, 27 (2006) 701â€“738. http://arxiv.org/abs/math.CO/0403337 (In Â§1.1)
41

[BorGeWh03] A. BOROVIK, I. GELFAND, N. WHITE: Coxeter matroids. Progress in Mathematics, 216.
BirkhÂ¨auser Boston, Inc., Boston, MA, 2003. (In Â§5.17)
[Bri02] M. BRION: Positivity in the Grothendieck group of complex ï¬‚ag varieties, J. Algebra (special vol-
ume in honor of Claudio Procesi) 258 (2002), 137â€“159. (In Â§1.1)
[Bri05]
: Lectures on the Geometry of Flag Varieties, in Topics in cohomological studies of algebraic
varieties, ed. Piotr Pragacz, Trends in Mathematics. BirkhÂ¨auser Verlag, 2005, 33â€“85.
[BroGooYa06] K.
BROWN,
K.
GOODEARL,
M.
YAKIMOV:
Poisson
structures on afï¬ne spaces
and
ï¬‚ag
varieties
I.
Matrix
afï¬ne
Poisson
space,
Adv.
Math.
206
(2006),
567â€“629.
http://arxiv.org/abs/math.QA/0501109 (In Â§1.1, 5.3, 5.4, and 6)
[Bry86] T. BRYLAWSKI: Appendix of Matroid Cryptomorphisms, Theory of Matroids, N. White ed. Encyclo-
pedia Math. Appl. 26 (1986), 298â€“312. (In Â§3.6)
[Buc02] A. S. BUCH: A Littlewood-Richardson rule for the K-theory of Grassmannians, Acta Math. 189
(2002), 37â€“78. http://arxiv.org/abs/math.AG/0004137 (In Â§7.11)
[BucKresTam03] A. S. BUCH, A. KRESCH, H. TAMVAKIS: Gromov-Witten invariants on Grassmannians,
J. Amer. Math. Soc. 16 (2003), no. 4, 901â€“915 (electronic). http://arxiv.org/abs/math.AG/0306388
(In Â§1.4, 8.4, 8.4, and 8.5)
[BucMih] A. S. BUCH, L. MIHALCEA: Quantum K-theory of Grassmannians, to appear in Duke Math. J.
http://arxiv.org/abs/0810.0981 (In Â§8.4)
[BuEiGraWr94] J. BUHLER, D. EISENBUD, R. GRAHAM, C. WRIGHT: Juggling drops and descents, Amer.
Math. Monthly 101 (1994), no. 6, 507â€“519. http://www.msri.org/~de/papers/pdfs/1994-001.pdf
(In Â§1.2)
[ChGra07] F. CHUNG, R. GRAHAM: Universal juggling cycles, Combinatorial Number Theory, B. Landman,
M.B. Nathanson, J. Nesetril, R.J. Nowakowski, C. Pomerance, eds. (2007), 121â€“130. (In Â§1.2)
[ChGra08]
,
: Primitive juggling sequences, Amer. Math. Monthly 115 (2008), no. 3, 185â€“194.
(In Â§1.2)
[DeLak81] C. DE CONCINI, V. LAKSHMIBAI: Arithmetic Cohen-Macaulayness and arithmetic normality
for Schubert varieties, Amer. J. Math. 103 (1981), no. 5, 835â€“850.
[Dy93] M. DYER: Hecke algebras and shellings of Bruhat intervals, Compositio Math. 89 (1993), 91â€“115.
(In Â§3.5)
[EhRe96] R. EHRENBORG, M. READDY: Juggling and applications to q-analogues, Discrete Math. 157
(1996), no. 1-3, 107â€“125. (In Â§1.2, 3.1, and 3.2)
[FoZ00] S. FOMIN, A. ZELEVINSKY: Recognizing Schubert cells, Journal of Algebraic Combinatorics 12
(2000), 37â€“57. http://arxiv.org/abs/math/9807079 (In Â§5.5 and 5.17)
[FoZ01]
,
: Double Bruhat cells and total positivity, J. Amer. Math. Soc. 12 (1999), no. 2, 335â€“
380. http://arxiv.org/abs/math.RT/9802056 (In Â§6)
[Fu92] W. FULTON: Flags, Schubert polynomials, degeneracy loci, and determinantal formulas, Duke
Math. J. 65 (1992), no. 3, 381â€“420. (In Â§3.3, 4.1, and 6)
[FuPa97] W. FULTON, R. PANDHARIPANDE: Notes on stable maps and quantum cohomology. Algebraic
geometryâ€”Santa Cruz 1995, 45â€“96, Proc. Sympos. Pure Math., 62, Part 2, Amer. Math. Soc., Provi-
dence, RI, 1997. http://arxiv.org/abs/alg-geom/9608011 (In Â§6)
[FuWo04] W. FULTON, C. WOODWARD: On the quantum product of Schubert classes, J. Algebraic Geom.
13 (2004), no. 4, 641â€“661. http://arxiv.org/abs/math.AG/0112183 (In Â§8.1 and 8.2)
[GeGorMacSe87] I. GEL â€²FAND, M. GORESKY, R. MACPHERSON, V. SERGANOVA: Combinatorial geome-
tries, convex polyhedra, and Schubert cells, Adv. in Math. 63 (1987), no. 3, 301â€“316. (In Â§1.1 and 5.4)
[GooYa] K. GOODEARL, M. YAKIMOV: Poisson structures on afï¬ne spaces and ï¬‚ag varieties. II. Trans.
Amer. Math. Soc. 361 (2009), no. 11, 5753â€“5780. http://arxiv.org/abs/math/0509075v2 (In Â§1.1,
2.3, and 5.3)
[Ha77] R. HARTSHORNE: Algebraic Geometry, Graduate Texts in Mathematics, 52. Springer-Verlag, New
York, 1977.
[HeLa] X. HE, T. LAM:
Projected Richardson varieties and afï¬ne Schubert varieties, preprint 2011.
http://arxiv.org/abs/1106.2586 (In Â§1 and 7)
[Ho72] M. HOCHSTER: Rings of invariants of tori, Cohen-Macaulay rings generated by monomials, and
polytopes, Ann. of Math. (2) 96 (1972), 318â€“337.
42

[Kn93] A. KNUTSON: The siteswap FAQ. (1993) http://www.juggling.org/help/siteswap/faq.html(In
Â§1.2)
[Kn2]
: Frobenius splitting and MÂ¨obius inversion, preprint. http://arxiv.org/abs/0902.1930(In
Â§7.5)
[Kn3]
: Matroids, shifting, and Schubert calculus, in preparation. (In Â§6)
[KnLamSp]
,
,
: Projections of Richardson varieties, preprint, 2010; arXiv:1008.3939.
(In Â§(document), 1.1, 1.1, 2.3, 2.3, 5.5, 5.6, 5.4, 5.5, 5.5, 7.5, 7.5, and 8.5)
[KnTao03]
, T. TAO: Puzzles and (equivariant) cohomology of Grassmannians, Duke Math. J. 119
(2003), no. 2, 221â€“260. http://arxiv.org/abs/math.AT/0112150 (In Â§7.1 and 7.3)
[KosKu86] B. KOSTANT, S. KUMAR: The nil Hecke ring and cohomology of G/P for a Kac-Moody group
G, Adv. in Math. 62 (1986), no. 3, 187â€“237. (In Â§7.1, 7.2, 7.2, 12, 7.3, and 7.3)
[KreiLak04] V. KREIMAN, V. LAKSHMIBAI: Richardson Varieties in the Grassmannian, Contributions to
automorphic forms, geometry, and number theory, 573â€“597, Johns Hopkins Univ. Press, Baltimore,
MD, 2004. http://arxiv.org/abs/math.AG/0203278
[Lam06] T. LAM:
Afï¬ne Stanley symmetric functions, American J. of Math., 128 (2006), 1553â€“1586.
http://www.arxiv.org/abs/math.CO/0501335 (In Â§1.3, 1.4, 7, 7.4, 7.5, 8.1, 8.3, and 8.3)
[Lam08]
: Schubert polynomials for the afï¬ne Grassmannian, J. Amer. Math. Soc., 21 (2008), 259â€“
281. http://www.arxiv.org/abs/math.CO/0603125 (In Â§7.4, 7.4, and 13)
[LamLapMoSh10]
,
L.
LAPOINTE,
J.
MORSE,
M.
SHIMOZONO:
Afï¬ne
insertion
and
Pieri
rules
for
the
afï¬ne
Grassmannian,
Memoirs
of
the
AMS,
208
(2010),
no.
977.
http://www.arxiv.org/abs/math.CO/0609110 (In Â§7.2)
[LamSchiSh10]
, A. SCHILLING, M. SHIMOZONO: K-theory Schubert calculus of the afï¬ne Grass-
mannian, Compositio Mathematica, 146 (2010), 811â€“852. http://arxiv.org/abs/0901.1506 (In
Â§7.5)
[LasSchÂ¨u82] A. LASCOUX, M. SCH Â¨UTZENBERGER: Symmetry and ï¬‚ag manifolds, in Invariant Theory,
(Montecatini, 1982), vol. 996 of Lecture Notes in Math., Springer-Verlag, 1983, pp. 118144. (In Â§2.3)
[LauLeRig08] S. LAUNOIS, T. LENAGAN, L. RIGAL: Prime ideals in the quantum grassmannian, Selecta
Mathematica 13 (2008), 697â€“725. http://arxiv.org/abs/0708.0744 (In Â§1.1)
[Lus98] G. LUSZTIG: Total positivity for partial ï¬‚ag varieties, Represent. Theory 2 (1998), 70â€“78. (In Â§1.1,
1.2, 5.3, and 5.4)
[Mag] P. MAGYAR: Notes on Schubert classes of a loop group, preprint.
http://arxiv.org/abs/0705.3826 (In Â§7.3)
[MarRie04] R. MARSH, K. RIETSCH: Parametrizations of ï¬‚ag varieties, Represent. Theory, 8 (2004), 212â€“
242. http://arxiv.org/abs/math.RT/0307017 (In Â§1.2)
[MilStu05] E. MILLER, B. STURMFELS: Combinatorial commutative algebra, Graduate Texts in Mathemat-
ics, 227. Springer-Verlag, New York, 2005. (In Â§4.1)
[Mn88] N. E. MNÂ¨EV: The universality theorems on the classiï¬cation problem of conï¬guration varieties
and convex polytopes varieties. Topology and geometryâ€”Rohlin Seminar, 527â€“543, Lecture Notes
in Math., 1346, Springer, Berlin, 1988. (In Â§1.1)
[Oh]
S. OH: Positroids and Schubert matroids, preprint. http://arxiv.org/abs/0803.1018 (In Â§3.20
and 3.23)
[Pol03] B. POLSTER: The Mathematics of Juggling, Springer-Verlag, New York, 2003. (In Â§1.2 and 3.1)
[Pos05] A. POSTNIKOV: Afï¬ne approach to quantum Schubert calculus, Duke Mathematical Journal, 128
(2005), no. 3, 473â€“509. http://arxiv.org/abs/math.CO/0205165 (In Â§1.4, 8.3, and 8.3)
[Pos]
A. POSTNIKOV: Total positivity, Grassmannians, and networks, preprint.
http://www-math.mit.edu/~apost/papers/tpgrass.pdf (In Â§1.1, 1.1, 1.2, 3, 3.2, 3.19, 3.20, 3.23,
5.2, 5.4, 5.4, and 5.4)
[PrSe86] A. PRESSLEY, G. SEGAL: Loop groups. Oxford Mathematical Monographs, Oxford University
Press, 1986. (In Â§7.3)
[Ra87] A. RAMANATHAN: Equations deï¬ning Schubert varieties and Frobenius splitting of diagonals,
Publ. Math. IHES 65 (1987), 61â€“90. (In Â§5.5)
[Rie06] K. RIETSCH: Closure relations for totally nonnegative cells in G/P, Mathematical Research Letters,
13 (2006), 775â€“786. http://arxiv.org/abs/math.AG/0509137 (In Â§1.1, 2.3, 5.3, 5.3, and 5.4)
43

[Rie09] K. RIETSCH: Private communication, 2009. (In Â§1.2)
[RieWi08] K. RIETSCH, L. WILLIAMS: The totally nonnegative part of G/P is a CW complex, Transform.
Groups, 13, (2008), 839â€“853. http://arxiv.org/abs/0802.0889 (In Â§1.2)
[Sni10] M. SNIDER, Afï¬ne Patches on Positroid Varieties and Afï¬ne Pipe Dreams, Ph. D. Dissertation,
Cornell University 2010 http://arxiv.org/abs/1011.3705 (In Â§7 and 7.5)
[Sta99] R. STANLEY: Enumerative Combinatorics Vol. 2. Cambridge Studies in Advanced Mathematics, 62.
Cambridge University Press, Cambridge, 1999. (In Â§7.4)
[Sta84] R. STANLEY, On the number of reduced decompositions of elements of Coxeter groups, European
Journal of Combinatorics, 5, (1984), 359â€“372 (In Â§7.10)
[Va78] P. V Â´AMOS: The missing axiom of matroid theory is lost forever, J. London Math. Soc. (2) 18 (1978),
no. 3, 403â€“408. (In Â§1.1 and 1.1)
[Ve71] D.-N. VERMA: MÂ¨obius inversion for the Bruhat order on a Weyl group, Ann. Sci. Â´Ecole Norm. Sup.
4 (1971), 393â€“398. (In Â§3.5)
[War05] G. WARRINGTON: Juggling probabilities, American Mathematical Monthly 112, no. 2 (2005), 105â€“
118. http://arxiv.org/abs/math.PR/0302257 (In Â§1.2)
[Wi07] L. WILLIAMS: Shelling totally nonnegative ï¬‚ag varieties, Journal fur die Reine und Angewandte
Mathematik (Crelleâ€™s Journal), issue 609 (2007), 1â€“22. http://arxiv.org/abs/math.RT/0509129(In
Â§1.1, 1.2, 2.3, 3.4, and 3.5)
[Ya10] M. YAKIMOV: Cyclicity of Lusztigâ€™s stratiï¬cation of Grassmannians and Poisson geometry, in:
Noncommutative structures in mathematics and physics, Eds: S. Caenepeel, J. Fuchs, S. Gutt, Ch.
Schweigert, A. Stolin, and F. Van Oystaeyen, pp. 258-262, Royal Flemish Acad. of Belgium for Sci-
ences and Arts, 2010. http://arxiv.org/abs/0902.2181 (In Â§6)
DEPARTMENT OF MATHEMATICS, CORNELL UNIVERSITY, ITHACA, NY 14853 USA
E-mail address: allenk@math.cornell.edu
DEPARTMENT OF MATHEMATICS, UNIVERSITY OF MICHIGAN, ANN ARBOR, MI 48109 USA
E-mail address: tfylam@umich.edu
DEPARTMENT OF MATHEMATICS, UNIVERSITY OF MICHIGAN, ANN ARBOR, MI 48109 USA
E-mail address: speyer@umich.edu
44

