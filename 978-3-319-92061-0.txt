Compact Textbooks in Mathematics
Piotr Sołtan
A Primer 
on Hilbert 
Space 
Operators

Compact Textbooks in Mathematics

Compact Textbooks in Mathematics
This textbook series presents concise introductions to current topics in
mathematics and mainly addresses advanced undergraduatesand master
students. The concept is to offer small books covering subject matter
equivalent to 2- or 3-hour lectures or seminars which are also suitable
for self-study. The books provide students and teachers with new per-
spectives and novel approaches. They may feature examplesand exercises
to illustrate key concepts and applications of the theoretical contents.
The series also includes textbooks specifically speaking to the needs of
students from other disciplines such as physics, computer science, engi-
neering, life sciences, finance.
• compact: small books presenting the relevant knowledge
• learning made easy: examples and exercises illustrate the application
of the contents
• useful for lecturers: each title can serve as basis and guideline for a
semester course/lecture/seminar of 2–3 hours per week.
More information about this series at http://www.springer.com/series/11225

Piotr Sołtan
A Primer on Hilbert
Space Operators

Piotr Sołtan
Faculty of Physics
University of Warsaw
Warsaw, Poland
ISSN 2296-4568
ISSN 2296-455X
(electronic)
Compact Textbooks in Mathematics
ISBN 978-3-319-92060-3
ISBN 978-3-319-92061-0
(eBook)
https://doi.org/10.1007/978-3-319-92061-0
Library of Congress Control Number: 2018944130
Mathematics Subject Classification (2010): 47A05, 47A10, 47A60, 47B15, 47B25, 47B10, 47D03
© Springer Nature Switzerland AG 2018
This work is subject to copyright. All rights are reserved by the Publisher, whether the whole
or part of the material is concerned, specifically the rights of translation, reprinting, reuse
of illustrations, recitation, broadcasting, reproduction on microfilms or in any other physical
way, and transmission or information storage and retrieval, electronic adaptation, computer
software, or by similar or dissimilar methodology now known or hereafter developed.
The use of general descriptive names, registered names, trademarks, service marks, etc. in this
publication does not imply, even in the absence of a specific statement, that such names are
exempt from the relevant protective laws and regulations and therefore free for general use.
The publisher, the authors and the editors are safe to assume that the advice and information
in this book are believed to be true and accurate at the date of publication. Neither the
publisher nor the authors or the editors give a warranty, express or implied, with respect
to the material contained herein or for any errors or omissions that may have been made.
The publisher remains neutral with regard to jurisdictional claims in published maps and
institutional affiliations.
This book is published under the imprint Birkhäuser, www.birkhauser-science.com by the
registered company Springer Nature Switzerland AG
The registered company address is: Gewerbestrasse 11, 6330 Cham, Switzerland

For Asia, Marcin, and Adam

vii
Preface
Theory of operators on Hilbert spaces is one of the great achievements of
functional analysis with applications in countless branches of mathematics
and physics. It is also the basis of fascinating generalizations which include
theory of C∗-algebras, von Neumann algebras, non-commutative geometry,
and many other domains of current research in mathematics. This book is
based on extended lecture notes from a course held by the author at the
Faculty of Physics of the University of Warsaw. Its main goals are:
▬To provide a concise presentation of the rudiments of the theory of
operators on Hilbert spaces with complete and direct proofs
▬To prepare the reader for further study of operator theory itself as well as
the theory of operator algebras (C∗-algebras and von Neumann algebras)
The extent to which the ﬁrst goal has been achieved can only be judged
having deﬁned the rudiments of the theory of operators on Hilbert spaces
which tends to be a highly subjective matter. Some fragments of the theory
have been purposefully left out in the hope of keeping the book’s size
moderate. More importantly, the reason for restricting the scope of the book
to a bare minimum is the existence of a considerable number of unrivaled
monographs and textbooks on the subject which cover a vastly larger range of
material (e.g., [AkGl, Kat, ReSi1, ReSi2] and particularly [Mau]). However,
studying these books might turn out to be quite challenging, and we hope
that reading this modest volume might serve as a worthwhile preparatory
exercise.
The material splits into two main parts. The ﬁrst one is devoted to
studying bounded operators, while the second deals with unbounded ones. In
the latter part, we employ a novel and very useful tool introduced into world’s
mathematics by S.L. Woronowicz, namely, the so-called z-transform of a
closed densely deﬁned operator. Skipping ahead of the detailed introduction
of the z-transform in ▷Chap. 9, we can somewhat imprecisely describe it as
a way to encode full information about a closed densely deﬁned operator on
a Hilbert space in a bounded operator on this space. The z-transform allows
for simple and elegant proofs of many fundamental results of the theory.
Most of the excellent textbooks and monographs listed at the end of the
book develop spectral theory of operators on Hilbert spaces based on several
aspects of the theory of Banach algebras and C∗-algebras. This approach
requires the reader to work with rather sophisticated structures ﬁrst and only
then apply them to more elementary problems of operator theory. Our route
is different: spectral theory of operators on Hilbert spaces is presented with
minimal use of deeper results of Banach algebras. It is worth mentioning
that, in fact, the theory of Banach algebras (in particular C∗-algebras and
von Neumann algebras) grew out of operator theory and can be viewed as its

viii
Preface
generalization par excellence. It is for this reason that we have chosen not to
put too much emphasis on various aspects of the theory of Banach algebras.1
It is the hope of the author that this approach will facilitate at least partial
achievement of the second of the goals mentioned above.
Since the book aims to be a primer on theory of operators on Hilbert
spaces, we decided not to include exercises nor many examples. Instead,
we placed short notes at the end of each chapter containing references to
textbooks and monographs containing a wealth of examples and exercises
and, in some instances, information about possible further developments and
generalizations of the subject of each chapter.
The lecture course on which the book is based was intended for students
who have had previous experience with basic functional analysis including
rudiments of Banach and Hilbert spaces. In particular, we assume the reader
is familiar with:
▬Basic linear algebra and calculus
▬Elements of general topology including the concept of a locally compact
topological space, a net and its convergence, and the Stone–Weierstrass
theorem
▬Elementary complex analysis including the notion of a holomorphic
function, the Cauchy formula, and Liouville’s theorem
▬Theory of measure and integral including the dominated convergence
theorem, product measures and Fubini’s theorem, complex measures,
Radon–Nikodym theorem, and Riesz–Markov–Kakutani representation
theorem
▬The concept of a Banach space and Hilbert space, Lp spaces, bounded
operators on Banach spaces, and the operator norm
▬The Riesz representation theorem (for functionals on Hilbert spaces),
bounded sesquilinear forms and their relation to bounded operators on
Hilbert spaces, and the notion of the adjoint operator of a bounded
operator on a Hilbert space.
We will also make use of integrals of continuous Banach space-valued
functions over compact intervals which are often discussed in courses of
ordinary differential equations. A much more general theory of such integrals
is presented e.g. in the monograph [Rud2]. All of the above topics are
covered in standard courses of complex analysis and measure theory, and
textbooks such as e.g. [ReSi1, Rud1] discuss most of them. For the reader’s
convenience, we have gathered in the Appendix of the book some of the
most important tools (inducing classical results such as the Banach-Steinhaus
theorem and the closed graph theorem) with complete proofs.
1One exception from this rule comes in ▷Chap. 7 in which we apply several results of C∗-algebra theory. The
results in question have been gathered in Appendix A.5.2.

Preface
ix
All vector spaces considered in this book will be over the ﬁeld of complex
numbers. We will employ the conventions of the physics literature according
to which scalar products will be linear in the second variable and anti-linear
in the ﬁrst. We will also use the “ket” and “bra” notation which we will now
brieﬂy discuss. Let H be a Hilbert space. Then any vector ψ ∈H deﬁnes a
unique linear operator C →H mapping 1 ∈C to ψ. We denote this linear
map by the symbol ψ⟩.
Now consider on C the standard Hilbert space structure (one for which
{1} is an orthonormal basis). Then the adjoint ψ⟩∗of ψ⟩is a bounded linear
functional on H mapping any vector φ onto the number ⟨ψ φ⟩. This map is
denoted by ⟨ψ . In particular, the composition ⟨ψ1 ◦ψ2⟩is a linear map
C →C given by multiplication by the scalar ⟨ψ1 ψ2⟩, while the composition
ψ2⟩◦⟨ψ1 (customarily written as ψ2⟩⟨ψ1 ) is a map H →H taking ϕ ∈H
to ⟨ψ1 ϕ⟩ψ2.
One of the fundamental formulas from the theory of vector spaces
endowed with a sesquilinear form is the polarization formula. It has various,
sometimes highly sophisticated, formulations one of which will be especially
useful to us: let F be a sesquilinear form on a vector space H (linear with
respect to the second argument). Then
F(ξ, η) = 1
4
3

k=0
ikF(η + ikξ, η + ikξ),
ξ, η ∈H.
The material covered in this book is for the most part linearly ordered,
i.e. each chapter uses results established in preceding ones. The notable
exception to this rule are ▷Chap. 6 devoted to the theory of the trace and ▷
Chap. 7 dealing with functional calculus for families of self-adjoint operators
and for normal operators. The results of these chapters are not used in the
remaining parts of the book. Also the results of ▷Chap. 10 on spectral theory
of unbounded operators are not used until ▷Chap. 12.
As we already mentioned, the Appendix contains additional material
needed in various places in the book arranged into ﬁve sections.
I wish to thank my teacher professor S.L. Woronowicz who introduced
me to the theory of operators on Hilbert spaces and has over the years shared
with me his knowledge of the subject. I also thank colleagues and students
from the Faculty of Physics and from the Department of Mathematics of
the University of Warsaw for their support and helpful remarks during the
writing of this book.
Warsaw
Piotr Mikołaj Sołtan
July 2018

xi
Contents
Part I
Bounded Operators
1
Spectrum of an Operator ........................................
3
1.1
C*-Algebra of Operators on a Hilbert Space ........................
3
1.2
Spectrum and Spectral Radius......................................
4
1.3
Spectrum in C*-Algebras ...........................................
11
2
Continuous Functional Calculus ................................
13
3
Positive Operators ...............................................
19
3.1
Positive Operators..................................................
19
3.2
Projections .........................................................
24
3.3
Partial Isometries ...................................................
26
3.4
Polar Decomposition ...............................................
27
3.5
Monotone Convergence of Operators ..............................
29
4
Spectral Theorems and Functional Calculus ...................
33
4.1
Multiplication Operators ...........................................
34
4.2
Borel Functional Calculus...........................................
40
4.3
Spectral Measures ..................................................
43
4.4
Holomorphic Functional Calculus ..................................
47
4.5
Theorems of Fuglede and Putnam ..................................
53
4.6
Functional Calculus in C*-algebras..................................
55
5
Compact Operators ..............................................
59
5.1
Compact Operators on a Hilbert Space .............................
59
5.2
Fredholm Alternative...............................................
62
6
The Trace ..........................................................
69
6.1
Definition of the Trace ..............................................
69
6.2
Trace Class and Hilbert-Schmidt Operators .........................
71
6.3
Hilbert-Schmidt Operators on L2 ...................................
84
7
Functional Calculus for Families of Operators .................
87
7.1
Holomorphic Functional Calculus ..................................
87
7.2
Continuous Functional Calculus ....................................
91
7.3
Joint Spectrum .....................................................
92
7.4
Functional Calculus for Normal Operators ..........................
93

xii
Contents
Part II
Unbounded Operators
8
Operators and Their Graphs .....................................
101
8.1
Basics of Unbounded Operators ....................................
101
8.2
Adjoint Operator....................................................
105
8.3
Algebraic Operations ...............................................
107
8.4
Spectrum ...........................................................
110
9
z-Transform .......................................................
113
9.1
The Operator T ∗T ..................................................
113
9.2
z-Transform of a Closed Operator ...................................
115
9.3
Polar Decomposition ...............................................
123
10
Spectral Theorems ...............................................
129
10.1
Continuous Functional Calculus.....................................
129
10.2
Borel Functional Calculus ...........................................
134
10.3
Spectral Measure ...................................................
137
11
Self-Adjoint Extensions of Symmetric Operators..............
145
11.1
Containment of Operators in Terms of z-Transforms ................
145
11.2
Cayley Transform ...................................................
147
11.3
Krein and Friedrichs Extensions .....................................
154
12
One-Parameter Groups of Unitary Operators..................
165
12.1
Stone’s Theorem ....................................................
166
12.2
Trotter Formula .....................................................
170
A
Appendix A........................................................
175
A.1
Banach-Steinhaus Theorem.........................................
175
A.2
Dynkin’s Theorem...................................................
177
A.3
Tensor Product of Hilbert Spaces....................................
178
A.4
Open Mapping Theorem............................................
181
A.5
Quotient Spaces and Algebras ......................................
184
Index of Notation ...........................................................
193
References ..................................................................
195
Index........................................................................
197

Part I
Bounded Operators

3
1
Spectrum of an Operator
© Springer Nature Switzerland AG 2018
P. Sołtan, A Primer on Hilbert Space Operators, Compact Textbooks in Mathematics,
https://doi.org/10.1007/978-3-319-92061-0_1
1.1
C*-Algebra of Operators on a Hilbert Space
Let H be a Hilbert space. The Banach space B(H) of bounded operators on H is an
algebra over C with multiplication deﬁned as composition of operators and the identity
operator 1 : H →H is the unit (neutral element of multiplication) of this algebra. The
operation of passing to the adjoint operator
B(H) ∋x 	−→x∗∈B(H)
is an anti-linear, anti-multiplicative involution (for any x ∈B(H) we have x∗∗= x).
Moreover, the operator norm is compatible with algebra structure in the sense that
∥xy∥≤∥x∥∥y∥,
x, y ∈B(H).
In particular B(H) is a Banach algebra.
Proposition 1.1 For x ∈B(H) we have
(1)
∥x∥= ∥x∗∥,
(2)
∥x∗x∥= ∥x∥2.
Proof
Both equalities are obvious for x = 0. Therefore let us assume that ∥x∥> 0. Then clearly
∥x∗x∥≤∥x∗∥∥x∥.
Furthermore, the computation
∥x∗x∥= sup
∥ξ∥=1
∥x∗xξ∥= sup
∥ξ∥=1
sup
∥η∥=1
 
η x∗xξ
 
≥sup
∥ξ∥=1
 
ξ x∗xξ  = sup
∥ξ∥=1
∥xξ∥2 = ∥x∥2.

1
4
Chapter 1 • Spectrum of an Operator
yields
∥x∥2 ≤∥x∗x∥≤∥x∗∥∥x∥.
(1.1)
Dividing both sides by ∥x∥we obtain
∥x∥≤∥x∗∥,
which by symmetry shows that ∥x∗∥
=
∥x∥. Substituting this into (1.1) gives
∥x∗x∥= ∥x∥2.
⊓⊔
ⓘRemark 1.2 Let us note that the proof of Proposition 1.1 can easily be extended to the
case when x is an operator between different Hilbert spaces. Thus if H and K are
Hilbert spaces then for any x ∈B(H, K) we have ∥x∗x∥= ∥x∥2.
Proposition 1.1(1) says that the involution x 	→x∗on B(H) is isometric. A Banach
algebra together with an isometric, anti-linear and anti-multiplicative involution is called
a Banach ∗-algebra, while a Banach ∗-algebra whose involution additionally possesses
property (2) from Proposition 1.1 is called a C∗-algebra. Thus B(H) is a C∗-algebra.
Moreover any norm-closed ∗-subalgebra1 A ⊂B(H) is also a C∗-algebra. For any
subset S ⊂B(H) there exists the smallest C∗-algebra A ⊂B(H) containing S and it
is called the C∗-algebra generated by S. We denote it by the symbol C∗(S). It is easy
to show that C∗(S) is the closure of the set of linear combinations of all products of
elements of the sets S and S∗= {s∗
s ∈S}. For x ∈B(H) we will write C∗(x) and
C∗(x,1) instead of C∗({x}) and C∗({x, 1}).
Another example of a C∗-algebra is the space C(X) of continuous functions on a
compact space X with uniform norm ∥· ∥∞, pointwise addition and multiplication and
involution given by f 	→f . A seemingly different example would be the space Cb(Y)
of bounded continuous functions on a locally compact space Y with norm ∥· ∥∞and
pointwise algebraic operations. However this example is not really different from the
previous one, as in fact Cb(Y) is naturally isomorphic to C(βY), where βY is the Stone-
ˇCech compactiﬁcation of Y.2
1.2
Spectrum and Spectral Radius
Let x ∈B(H). Recall that x is invertible if there exists an operator y ∈B(H) such that
xy = yx = 1. The resolvent set of x is
ρ(x) = λ ∈C the operator λ1 −x is invertible,
and its complement σ(x) = CKρ(x) is called the spectrum of x.
1Vector subspace closed under composition of operators and passing to the adjoint operator.
2Cf. [Eng, Corollary 3.6.3].

1.2 · Spectrum and Spectral Radius
5
1
It is known that the set of invertible operators is open (see below for an argument
proving this) and since ρ(x) is the pre-image of this set under the continuous map
C ∋λ 	−→λ1 −x ∈B(H),
we see that the resolvent set is open. Moreover, if λ0 ∈ρ(x) and λ ∈C satisﬁes
|λ −λ0| <
1
∥(λ01−x)−1∥,
then λ ∈ρ(x) and it is easy to see that
(λ1 −x)−1 =
∞

n=0
(λ0 −λ)n(λ01 −x)−n−1.
In particular the mapping ρ(x) ∋λ 	→(λ1 −x)−1 ∈B(H) called the resolvent of x is
holomorphic.
ⓘRemark 1.3 For any λ, μ ∈ρ(x) we have
(λ1 −x)−1 −(μ1 −x)−1 = (μ −λ)(λ1 −x)−1(μ1 −x)−1.
(1.2)
(in particular the values of the resolvent of x at different points of ρ(x) commute).
Indeed: the formula is obvious for λ = μ and for λ ̸= μ we easily check that
1
μ−λ
(λ1 −x)−1 −(μ1 −x)−1	(μ1 −x)(λ1 −x)
=
1
μ−λ

(λ1 −x)−1(μ1 −x) −1
	
(λ1 −x)
=
1
μ−λ
(λ1 −x)−1(μ −λ)1 + (λ1 −x)	 −1	(λ1 −x)
=
1
μ−λ
(μ −λ)(λ1 −x)−1 + 1 −1	(λ1 −x) = 1
and
(μ1 −x)(λ1 −x)
1
μ−λ
(λ1 −x)−1 −(μ1 −x)−1	
=
1
μ−λ(μ1 −x)

1 −(λ1 −x)(μ1 −x)−1	
=
1
μ−λ(μ1 −x)

1 −

(λ −μ)1 + (μ1 −x)
	
(μ1 −x)−1	
=
1
μ−λ(μ1 −x)

1 −(λ −μ)(μ1 −x)−1 + 1
	
= 1.
It follows that (μ1 −x)(λ1 −x) is invertible and its inverse is the operator
1
μ−λ

(λ1 −x)−1 −(μ1 −x)−1	
. Formula (1.2) is known as the resolvent identity or
the resolvent formula.

1
6
Chapter 1 • Spectrum of an Operator
Proposition 1.4 Let x, y ∈B(H). Then
σ(xy) ∪{0} = σ(yx) ∪{0}.
(1.3)
Proof
Let λ ∈ρ(yx)K{0}, so that the operator λ1 −yx is invertible. We have
(λ1 −xy)

1
λ

1 + x(λ1 −yx)−1y
	
= 1
λ

λ1 −xy + (λ1 −xy)x(λ1 −yx)−1y
	
= 1
λ

λ1 −xy + x(λ1 −yx)(λ1 −yx)−1y	
= 1
λ(λ1 −xy + xy) = 1
and

1
λ
1 + x(λ1 −yx)−1y	
(λ1 −xy)
= 1
λ

λ1 −xy + x(λ1 −yx)−1y(λ1 −xy)
	
= 1
λ

λ1 −xy + x(λ1 −yx)−1(λ1 −yx)y
	
= 1
λ(λ1 −xy + xy) = 1
which means that λ1 −xy is invertible with inverse 1
λ

1 + x(λ1 −yx)−1y
	
. In other
words λ ∈ρ(xy)K{0} and this shows that ρ(yx)K{0} ⊂ρ(xy)K{0}. By symmetry, also
ρ(xy)K{0} ⊂ρ(yx)K{0} and hence ρ(xy)K{0} = ρ(yx)K{0}. In other words σ(xy)∪{0} =
σ(yx) ∪{0}.
⊓⊔
ⓘRemark 1.5 By taking set difference of both sides of (1.3) with {0} we get another
useful expression of the same phenomenon:
σ(xy)K{0} = σ(yx)K{0}.
Proposition 1.6 For any x ∈B(H) we have λ ∈C |λ| > ∥x∥ ⊂ρ(x).
Proof
If |λ| > ∥x∥then the series
∞

n=0
λ−n−1xn = 1
λ
∞

n=0
λ−nxn
converges in B(H), because ∥λ−nxn∥≤

∥x∥
|λ|
n
. One easily checks that its sum is the inverse
of λ1 −x.
⊓⊔

1.2 · Spectrum and Spectral Radius
7
1
Rephrasing Proposition 1.6, for any x ∈B(H) we have
σ(x) = CKρ(x) ⊂CK

λ ∈C |λ| > ∥x∥

=

λ ∈C |λ| ≤∥x∥

,
and therefore the spectrum of x is a closed and bounded (hence compact) subset of C.
Theorem 1.7
For any x ∈B(H) we have
(1)
σ(x) is non-empty,
(2)
the sequence

∥xn∥
1
n 	
n∈N is convergent and
lim
n→∞∥xn∥
1
n = sup

|λ| λ ∈σ(x)

.
Proof
Deﬁne
α(x) = inf
n∈N ∥xn∥
1
n ,
x ∈B(H).
Take any ε > 0. Then there is a natural number nε ∈N such that ∥xnε∥
1
nε ≤α(x) + ε
or, in other words,
∥xnε∥≤α(x) + ε	nε.
Take now any n ∈N and divide it by nε with remainder, i.e. ﬁnd q, r ∈Z+ such that
n = qnε + r
and r < nε. Then we have
∥xn∥= ∥xqnε xr∥≤∥xnε ∥q∥x∥r ≤

α(x) + ε
	qnε∥x∥r =

α(x) + ε
	n−r∥x∥r.
Therefore
∥xn∥
1
n ≤α(x) + ε	1−r
n ∥x∥
r
n
which shows that
α(x) ≤lim inf
n→∞∥xn∥
1
n ≤lim sup
n→∞
∥xn∥
1
n ≤α(x) + ε.
As ε is arbitrary, we ﬁnd that the sequence

∥xn∥
1
n 	
n∈N is convergent (with limit α(x)).

1
8
Chapter 1 • Spectrum of an Operator
In particular, if x, y ∈B(H) commute then
α(xy) = lim
n→∞
(xy)n
1
n = lim
n→∞∥xnyn∥
1
n
≤lim
n→∞∥xn∥
1
n ∥yn∥
1
n = lim
n→∞∥xn∥
1
n lim
n→∞∥xn∥
1
n = α(x)α(y).
Now if |λ| > α(x) then the series
∞

n=0
∥xn∥
|λ|n converges, and therefore so does
∞

n=0
λ−nxn.
We easily check that its sum is the inverse of 1 −x
λ. It follows that λ1 −x is invertible and
we obtain
α(x) ≥sup

|λ| λ ∈σ(x).
(1.4)
For the proof of the reverse inequality and non-emptiness of the spectrum we need to
consider two cases.
Case 1 α(x) = 0. In this case x is not invertible (and so 0 ∈σ(x)). Indeed: if x were
invertible we would have
1 = α(1) = α(xx−1) ≤α(x)α(x−1) = 0.
Case 2 α(x) > 0. Let us assume that α(x) > sup

|λ| λ ∈σ(x)

. Since σ(x) is a compact
subset of C, there exists r ∈]0, α(x)[ with the property that
σ(x) ⊂

λ ∈C |λ| ≤r

.
Thus the set D =

λ ∈C |λ| > r

is contained in ρ(x). For any continuous functional ϕ on
B(H) the function
D ∋λ 	−→ϕ(λ1 −x)−1	 ∈C
is holomorphic. Moreover, for |λ| > α(x) we have
ϕ(λ1 −x)−1	 =
∞

n=0
λ−n−1ϕ(xn).

1.2 · Spectrum and Spectral Radius
9
1
This function vanishes at inﬁnity,3 so
f (μ) =
⎧
⎨
⎩
0,
μ = 0,
ϕ
 1
μ1 −x
	−1	
,
0 < |μ| < 1
r
deﬁnes a holomorphic function on D−1 =

μ ∈C |μ| < 1
r

with Taylor expansion around
zero given by
∞

n=0
μn+1ϕ(xn).
This expansion must converge on the whole disk D−1 and, in particular, for any μ ∈D−1
we have
lim
n→∞μn+1ϕ(xn) = 0.
Take now λ0 such that r < |λ0| < α(x). Then λ−1
0
∈D−1 and
lim
n→∞λ−n−1
0
ϕ(xn) = 0.
Consider the family (sequence) of continuous functionals on B(H)∗given by
B(H)∗∋ϕ 	−→λ−n−1
0
ϕ(xn) ∈C,
n ∈N.
By the Banach-Steinhaus theorem there exists a constant M < +∞such that
sup
n∈N
|λ0|−n−1∥xn∥≤M.
Thus
∥xn∥≤M|λ0|n+1,
n ∈N
and consequently
α(x) = lim
n→∞∥xn∥
1
n ≤lim
n→∞M
1
n |λ0|1+ 1
n = |λ0| < α(x).
3For |μ| > 1 we have

∞

n=0
(λμ)−n−1ϕ(xn)
 ≤∥ϕ∥
|μ|
∞

n=0
∥xn∥
|λ|n+1 |μ|−n ≤∥ϕ∥
|μ|
∞

n=0
∥xn∥
|λ|n+1 −−−−→
|μ|→∞0.
The series is convergent because |λ| > lim
n→∞∥xn∥
1
n , i.e. |λ|−1 is strictly smaller than the radius of convergence
R =

lim sup
n→∞
∥xn∥
1
n 	−1.

1
10
Chapter 1 • Spectrum of an Operator
This contradiction shows that it is not possible to have α(x) > sup

|λ| λ ∈σ(x)

. In other
words
α(x) ≤sup

|λ| λ ∈σ(x)

,
which together with (1.4) gives α(x) = sup |λ| λ ∈σ(x)

.
⊓⊔
For any x ∈B(H) the quantity
sup |λ| λ ∈σ(x)
is called the spectral radius of x and is denoted by |σ(x)|. Here are a few properties of
the spectral radius:
▬for any x we have |σ(x)| ≤∥x∥,
▬if x, y ∈B(H) commute then |σ(xy)| ≤|σ(x)||σ(y)|,
▬|σ(x∗)| = |σ(x)|.
The last property follows immediately from the fact that
σ(x∗) = σ(x) = λ λ ∈σ(x).
Proposition 1.8 Let x ∈B(H) and let p(λ) = α0 + α1λ + · · · + αnλn be a polynomial.
Deﬁne
p(x) = α01 + α1x + · · · + αnxn.
Then
σ

p(x)
	
= p

σ(x)
	
=

p(λ) λ ∈σ(x)

.
Proof
The statement is obvious for n = 0. Assume therefore that n ≥1. Take λ0 ∈σ(x), so that
λ01 −x is not invertible. Then the operator p(λ0)1 −p(x) cannot be invertible, as
p(λ0)1 −p(x) =
n

k=0
αk(λk
01 −xk)
=
n

k=1
αk(λk
01 −xk) = (λ01 −x)
n

k=1
αk
k−1

j=1
λk−j
0
xj−1.
and λ01 −x and
n
k=1
αk
k−1

j=1
λk−j
0
xj−1 commute.

1.3 · Spectrum in C*-Algebras
11
1
This shows that
p

σ(x)
	
⊂σ

p(x)
	
.
On the other hand, if μ ̸∈

p(λ)
λ ∈σ(x)

and λ1, . . . , λn are the zeros of the
polynomial μ −p(λ) then clearly λ1, . . . , λn ̸∈σ(x). Furthermore
μ −p(λ) = γ (λ1 −λ)m1 · · · (λn −λ)mn
for some m1, . . . , mn ∈N and γ ̸= 0, and therefore
μ1 −p(x) = γ (λ11 −x)m1 · · · (λn1 −x)mn.
Thus μ1 −p(x) is invertible (as a product of invertible operators) and this means that μ ̸∈
σp(x)	. We have therefore shown that
pσ(x)	 ⊃σp(x)	.
⊓⊔
1.3
Spectrum in C*-Algebras
Let A be a C∗-algebra with unit (examples being B(H) for a Hilbert space H or C(X) for
a compact space X, but these are far from exhaustive) and let a ∈A. Just as for elements
of B(H) we say that a is invertible if there exists b ∈A such that ab = ba = 1. We go
on to deﬁne the spectrum of a:
σ(a) =

λ ∈C the element λ1 −a is not invertible

.
Consider for example the C∗-algebra A = C(X) with X a compact space. Then it
is easy to see that the spectrum of an element f ∈A coincides with the range of the
function f .
Theorem 1.9
Let a be an element of a C∗-algebra with unit. Then
(1)
σ(a) is a non-empty compact subset of C contained in the disk with center 0 and
radius ∥a∥,
(2)
the sequence

∥an∥
1
n 	
n∈N is convergent and
lim
n→∞∥an∥
1
n = sup

|λ| λ ∈σ(a)

,
(Continued)

1
12
Chapter 1 • Spectrum of an Operator
Theorem 1.9 (continued)
(3)
for any b ∈A we have σ(ab) ∪{0} = σ(ba) ∪{0},
(4)
for any polynomial p ∈C[·] we have σ

p(a)
	
= p

σ(a)
	
.
The proofs of all statements in the above theorem can be carried out by substituting
A for B(H) in the proofs of Theorem 1.7 and Propositions 1.4 and 1.8.
Notes
Basics of the theory of operators on Hilbert spaces recalled in this chapter can be found
in every textbook on the subject, including almost all items from the bibliography listed
at the end of this book. More information on spectra of operators and elements of C∗-
algebras can be found e.g. in [Arv2, Chapters 1 and 2], [Ped, Chapter 4], [Mau, Chapter
VIII] as well as in many other books. A natural generalization of operator theory is
provided by the theory of Banach algebras and in particular of C∗-algebras ([Arv1, Zel]).
Within this approach many results can be obtained in a very elegant way, the price for
this being paid by way of making the presentation more abstract and using a number of
complicated structures. In this book, however, we aim to minimize the use of abstract
theory reserving the more sophisticated path for further investigations on the part of the
reader.
A wealth of great examples and exercises on the subject of spectra can be found in
[Hal, Sections 9, 10 and 11] and in problem sections of textbooks such as [Arv1, Arv2,
ReSi1, Rud2].

13
2
Continuous Functional Calculus
© Springer Nature Switzerland AG 2018
P. Sołtan, A Primer on Hilbert Space Operators, Compact Textbooks in Mathematics,
https://doi.org/10.1007/978-3-319-92061-0_2
In this chapter we will introduce by far the most important tool of the theory of operators
on Hilbert space, namely functional calculus for self-adjoint operators. We begin with
slightly more general considerations focused on normal operators which we will revisit
later in ▷Chap. 7.
An operator x ∈B(H) is called normal if x∗x = xx∗. Equivalently x is normal if
and only if for any ξ ∈H we have ∥xξ∥= ∥x∗ξ∥. Indeed: if x∗x = xx∗then
∥xξ∥2 = ⟨xξ xξ⟩= ξ x∗xξ = ξ xx∗ξ = x∗ξ x∗ξ = ∥x∗ξ∥2.
Conversely if ∥xξ∥2 = ∥x∗ξ∥2 for all ξ ∈H then the sesquilinear forms
(ξ,η) 	−→

ξ x∗xη

and
(ξ,η) 	−→

ξ xx∗η

coincide on pairs of vectors of the form (ξ,ξ), so by the polarization identity they are
equal. Consequently x∗x = xx∗.
An operator x ∈B(H) is self-adjoint when x = x∗. Clearly, a self-adjoint operator
is normal. Also any unitary operator, i.e. u ∈B(H) satisfying u∗u = uu∗= 1, is
normal.
Proposition 2.1 Let x ∈B(H) be a normal operator and let λ ∈C and ψ ∈H be such
that xψ = λψ.1 Then x∗ψ = λψ.
Proof
One easily checks that the operator λ1 −x is normal, and so
(λ1 −x∗)ψ
 =
(λ1 −x)∗ψ∥=
(λ1 −x)ψ∥= 0.
⊓⊔
1Restriction of a compact operator to an invariant subspace clearly is compact.

2
14
Chapter 2 • Continuous Functional Calculus
Corollary 2.2 Let x ∈B(H) be a normal operator and let λ, μ ∈σ(x) be different
eigenvalues of x. Then the eigenspaces of x for λ and μ are orthogonal.
Proof
Let ψ and ϕ be eigenvectors of x for the eigenvalues λ and μ respectively: xψ = λψ and
xϕ = μϕ. Using Proposition 2.1 we compute
μ ⟨ψ ϕ⟩= ⟨ψ xϕ⟩=

x∗ψ ϕ

=

λψ ϕ

= λ ⟨ψ ϕ⟩,
which shows that (λ −μ) ⟨ψ ϕ⟩= 0. As λ ̸= μ, we must have ⟨ψ ϕ⟩= 0.
⊓⊔
In particular eigenspaces of a self-adjoint operator for different eigenvalues also have
to be orthogonal.
Proposition 2.3 Let x ∈B(H). Then
(1)
if x is normal then |σ(x)| = ∥x∥,
(2)
if x is self-adjoint then σ(x) ⊂R.
Proof
Assume ﬁrst that x is normal. We have
∥x2∥2 =
(x2)∗(x2)
 = ∥x∗x∗xx∥
= ∥x∗xx∗x∥=
(x∗x)∗(x∗x)
 = ∥x∗x∥2 = ∥x∥4,
so that ∥x2∥= ∥x∥2. Since for any k ∈N the operator x2k is normal as well, for any n ∈N
we have
∥x2n∥=
(x2n−1)2 = ∥x2n−1∥2 = ∥x2n−2∥4 = · · · = ∥x∥2n.
In particular, the sequence ∥xn∥
1
n 	
n∈N has a subsequence which is constant and equal to
∥x∥. On the other hand
|σ(x)| = lim
n→∞∥xn∥
1
n .
Now let x be self-adjoint. Take any λ ∈σ(x) and write λ = α + iβ with α, β ∈R. For
n ∈N consider the operator xn = x −(α −inβ)1. We have i(n + 1)β ∈σ(xn), so that
(n + 1)2β2 ≤|σ(xn)|2 ≤∥xn∥2 = ∥xn∗xn∥
=
(x −(α + inβ)1	(x −(α −inβ)1	
=
(x −α1)2 + n2β21

≤
(x −α1)2 + n2β2
for all n. This means that β = 0 and consequently λ ∈R.
⊓⊔

Chapter 2 • Continuous Functional Calculus
15
2
Before stating the main theorem of this chapter let us recall that a ∗-isomorphism
is a bijective map between algebras with involution preserving addition, multiplication
and involution.
Theorem 2.4 (Continuous Functional Calculus)
Let x ∈B(H) be self-adjoint. Then there exists a unique map C

σ(x)
	
→B(H)
denoted by
C

σ(x)
	
∋f 	−→f (x) ∈B(H)
such that
▬if f is a polynomial function f (λ) = α0 + α1λ + · · · + αnλn then
f (x) = α01 + α1x + · · · + αnxn,
▬
f (x)
 = ∥f ∥∞for all f ∈Cσ(x)	.
Moreover the map f 	→f (x) is a ∗-isomorphism of the C∗-algebra Cσ(x)	 onto
C∗(x, 1).
Proof
Let P

σ(x)
	
be the set of polynomial functions on σ(x), i.e. restrictions of polynomials to
σ(x) and let  : C[·] →C

σ(x)
	
be the map p 	→p

σ(x). For a polynomial p ∈C[·] we
have
p(x)
 =
σp(x)	 = sup |μ| μ ∈σ

p(x)
	
= sup

|p(λ)| λ ∈σ(x)

=
(p)

∞.
Thus the mapping
C[·] ∋p 	−→p(x) ∈B(H)
factorizes through , i.e. there exists a linear  : P

σ(x)
	
→B(H) such that
p(x) = (p)	.
Moreover  is an isometry.
The space P

σ(x)
	
is dense in C

σ(x)
	
and its image under  is dense in the C∗-algebra
C∗(x, 1). Therefore  extends uniquely to an isometry from C

σ(x)
	
onto C∗(x, 1) which
we will from now on denote by f 	→f (x). It is clear that this map satisﬁes

2
16
Chapter 2 • Continuous Functional Calculus
▬if f is a polynomial function f (λ) = α0 + α1λ + · · · + αnλn then
f (x) = α01 + α1x + · · · + αnxn,
▬
f (x)
 = ∥f ∥∞for all f ∈C

σ(x)
	
,
and that these conditions determine this map uniquely.
The properties
(f + g)(x) = f (x) + g(x),
f, g ∈C

σ(x)
	
,
(fg)(x) = f (x)g(x),
f, g ∈C

σ(x)
	
,
(λf )(x) = λf (x),
λ ∈C, f ∈C

σ(x)
	
,
f (x) = f (x)∗,
f ∈Cσ(x)	
are easily checked on elements of Pσ(x)	 and for general continuous functions on σ(x)
we use approximation by polynomial functions. In other words f 	→f (x) is an isometric
∗-isomorphism of C

σ(x)
	
onto C∗(x, 1).
⊓⊔
ⓘRemark 2.5
(1)
Let x ∈B(H) be self-adjoint and let f be a continuous function on σ(x) which can be
uniformly approximated by polynomials without constant term. Then f (x) belongs to
C∗(x) which can be strictly smaller than C∗(x, 1).
(2)
If 0 ̸∈σ(x) (i.e. x is invertible) then any f ∈C

σ(x)
	
can be uniformly approximated
by polynomials without constant term. In particular if x is an invertible self-adjoint
operator then the constant function 1 on σ(x) can be uniformly approximated by
polynomials without constant term. Therefore 1 belongs to C∗(x) and consequently
C∗(x, 1) = C∗(x). Moreover, also the function
ı : σ(x) ∋λ 	−→λ−1 ∈C
can be uniformly approximated by polynomials without constant term. It is easy to see
that ı(x) = x−1, so x−1 ∈C∗(x).
(3)
Even when x is not self-adjoint, but 0 ̸∈σ(x) we can show that x−1 ∈C∗(x). Indeed:
the operator x∗x is self-adjoint and invertible with inverse x−1(x−1)∗. It follows from
(2) that x−1(x−1)∗belongs to C∗(x∗x) ⊂C∗(x). Therefore
x−1 = x−1(x−1)∗	x∗∈C∗(x).
Proposition 2.6 Let x and y be commuting self-adjoint operators on H. Then for any f ∈
C

σ(x)
	
and g ∈C

σ(y)
	
we have f (x)g(y) = g(y)f (x).

Chapter 2 • Continuous Functional Calculus
17
2
Proof
Let (fn)n∈N and (gn)n∈N be sequences of polynomials uniformly approximating f and g on
σ(x) and σ(y) respectively. It is clear that for any n we have fn(x)gn(y) = gn(y)fn(x) and
fn(x)gn(y) −−−→
n→∞f (x)g(y)
and
gn(y)fn(x) −−−→
n→∞g(y)f (x).
⊓⊔
ⓘRemark 2.7 Let x, y ∈B(H) and assume the x = x∗and xy = yx. Then for any
f ∈C

σ(x)
	
the operator f (x) also commutes with y. The proof follows the lines of
the proof of Proposition 2.6 .
Theorem 2.8 (Spectral Mapping Theorem)
Let x ∈B(H) be self-adjoint. Then for any f ∈Cσ(x)	 we have
σf (x)	 = f σ(x)	.
Proof
For any μ
μ1 −f (x) = (μ −f )(x).
Therefore μ1 −f (x) is invertible if and only if the function μ −f is an invertible element
of C

σ(x)
	
, i.e. is and only if μ ̸∈f

σ(x)
	
.
⊓⊔
ⓘRemark 2.9 Let x be a self-adjoint operator and assume that xn = 0 for some n ∈N.
Then σ(x) = {0}, because σ(xn) = {0} and σ(xn) = λn λ ∈σ(x). It follows that
∥x∥= |σ(x)| = 0, i.e. x = 0.
Proposition 2.10 Let x ∈B(H) be self-adjoint. Then for any real-valued g ∈C

σ(x)
	
the
operator g(x) is self-adjoint and for any f ∈C

g

σ(x)
		
we have
f g(x)	 = (f ◦g)(x).
Proof
Since Cσ(x)	 ∋g 	→g(x) ∈C∗(x, 1) is a ∗-isomorphism, g = g implies g(x)∗= g(x).
So let us ﬁx a real-valued g ∈C

σ(x)
	
and consider the mapping
Cgσ(x)		 ∋f 	−→(f ◦g)(x) ∈B(H).

2
18
Chapter 2 • Continuous Functional Calculus
It is easy to see that it is isometric and maps polynomial functions onto corresponding
polynomials in g(x). By uniqueness of the continuous functional calculus it must be equal to
the map f 	→f

g(x)
	
.
⊓⊔
Notes
It is difﬁcult to ﬁnd a more fundamental concept in the theory of operators on Hilbert
spaces than functional calculus and, in particular, the continuous functional calculus.
As we already mentioned earlier, it is the ﬁrst step in the development of the theory of
C∗-algebras and general operator algebras. The reader will ﬁnd plentiful exercises and
examples e.g. in [Arv1, Chapter 1], [Arv2, Chapter 2], [Hal, Section 15], [Ped, Sections
4.4 and 4.5], [ReSi1, Chapter VII], [Rud2, Chapters 10 and 12].
Let us also note that continuous functional calculus for self-adjoint operators can be
extended to a larger class of operators (namely the so called normal operators, see ▷
Sect. 4.6). We will do this in ▷Sect. 7.4.

19
3
Positive Operators
© Springer Nature Switzerland AG 2018
P. Sołtan, A Primer on Hilbert Space Operators, Compact Textbooks in Mathematics,
https://doi.org/10.1007/978-3-319-92061-0_3
One of the ﬁrst and, incidentally, very effective applications of functional calculus is
to take square roots of positive operators. In this chapter we will introduce positive
operators and related notions of a projection and a partial isometry. We will prove
existence and uniqueness of polar decomposition of bounded operators. We will also
brieﬂy investigate the partial order on operators deﬁned by the notion of a positive
operator. In particular we will show that any bounded monotonically increasing net
of self-adjoint operators has a supremum which is also the limit of the net in strong
topology.
3.1
Positive Operators
An operator x ∈B(H) is called positive if x is self-adjoint and σ(x) ⊂R+. In this
case we write x ≥0. The set of positive operators on H will be denoted by the symbol
B(H)+.
Theorem 3.1
Let x ∈B(H) be positive. Then there exists a unique positive a ∈B(H) such that
a2 = x.
Proof
The function f : λ 	→λ
1
2 is continuous on σ(x). Put a = f (x). Clearly
a2 = f (x)f (x) = x,
since f (λ)f (λ) = λ for all λ ∈σ(x). Moreover σ(a) = f

σ(x)
	
is contained in R+, so that
a ∈B(H)+.

3
20
Chapter 3 • Positive Operators
Now let b be a positive operator such that b2 = x. By Proposition 2.10 we have b =
f

g(b)
	
, where g(λ) = λ2 for all λ ∈R+. Therefore
b = f (b2) = f (x) = a.
⊓⊔
Let x ∈B(H) be a positive operator. The unique positive operator a such that
a2 = x is called the square root of x. It follows from the existence of square roots that
any positive operator is the square of a self-adjoint operator. Moreover, by the spectral
mapping theorem, the square of a self-adjoint operator y is positive, since its spectrum
consists of squares of elements of σ(y).
Proposition 3.2 Let x ∈B(H) be self-adjoint. Then there exists a unique pair (a, b) of
positive operators such that
x = a −b
and
ab = 0.
(3.1)
Proof
Consider the following two continuous functions on σ(x):
f (λ) =
⎧
⎨
⎩
λ,
λ ≥0,
0,
λ < 0
and
g(λ) =
⎧
⎨
⎩
0,
λ > 0,
−λ,
λ ≤0.
It is check that a = f (x) and b = g(x) satisfy the conditions (3.1).
On the other hand if a pair (a, b) of positive operators satisﬁes (3.1) then ﬁrst of all a and
b must commute:
ba = b∗a∗= (ab)∗= 0∗= 0 = ab.
It follows that also a
1
2 and b
1
2 commute (Proposition 2.6) and, moreover, a
1
2 b
1
2 = 0, since

a
1
2 b
1
2 	2 = ab = 0
(cf. Remark 2.9).
From this we obtain

a
1
2 + b
1
2 	2 = a + b,
so a + b is positive, as a square of a self-adjoint operator. Furthermore
(a + b)2 = (a −b)2 = x2,

3.1 · Positive Operators
21
3
which means that a+b is the unique square root of the positive operator x2, i.e. a+b = (x2)
1
2 .
Consequently
a = 1
2

(a + b) + (a −b)
	
= 1
2

(x2)
1
2 + x
	
= f (x)
and similarly
b = 1
2

(a + b) −(a −b)
	
= 1
2

(x2)
1
2 −x
	
= g(x).
⊓⊔
Operators a and b deﬁned in Proposition 3.2 are called the positive part and
negative part of the self-adjoint operator x. We denote them by the symbols x+ and
x−respectively. Note that x+ and x−belong to C∗(x).
Proposition 3.3 Let x ∈B(H). Then
(1)
x = 0 if and only if for any ξ ∈H we have ⟨ξ xξ⟩= 0,
(2)
x = x∗if and only if for any ξ ∈H we have ⟨ξ xξ⟩∈R.
Proof
Ad (1). It follows from the polarization formula that if ⟨ξ xξ⟩= 0 for all ξ then the
sesquilinear form
(ξ, η) 	−→⟨ξ xη⟩,
ξ, η ∈H
is the zero form, and so x = 0.
Ad (2). Consider two sesquilinear forms:
F1 : (ξ, η) 	−→⟨ξ xη⟩
and
F2 : (ξ, η) 	−→⟨xξ η⟩.
We have
F1(ξ, ξ) = ⟨ξ xξ⟩= ⟨ξ xξ⟩= ⟨xξ ξ⟩= F2(ξ, ξ),
because ⟨ξ xξ⟩∈R. It follows that F1 = F2, so that x is self-adjoint.
⊓⊔
Proposition 3.4 Let x ∈B(H). Then the following conditions are equivalent:
(1)
x is positive,
(2)
there exists a self-adjoint operator y such that x = y2,
(3)
there exists an operator z such that x = z∗z,
(4)
for any ξ ∈H we have ⟨ξ xξ⟩≥0.

3
22
Chapter 3 • Positive Operators
Proof
(1) ⇒(2) follows from Theorem 3.1: y = x
1
2 . The implication (2) ⇒(3) is obvious and so
is (3) ⇒(4): for any ξ we have
⟨ξ xξ⟩= ξ z∗zξ = ⟨zξ zξ⟩= ∥zξ∥2 ≥0.
(4) ⇒(1). Decompose x into its positive and negative part, x = x+ −x−, and let
f (λ) = λ
3
2 for λ ∈R+. Since x+x−= 0, for any ξ we have
0 ≤x−ξ x(x−ξ) = ξ (x−xx−)ξ) = ξ
x−(x+ −x−)x−	ξ)
= −

ξ (x−)3ξ

= −

x−ξ x−(x−ξ)

= −

x−ξ (x−)
1
2 (x−)
1
2 (x−ξ)

= −

f (x−)ξ f (x−)ξ ≤0.
It follows that

ξ (x−)3ξ

= 0 for all ξ, which by Proposition 3.3(1) means that (x−)3 = 0.
It follows now from Remark 2.9 that x−= 0. In particular x = x+ ≥0.
⊓⊔
In the terminology of quantum physics, for x ∈B(H) the quantity ⟨ξ xξ⟩is referred
to as the expectation value of x in the state determined by ξ (albeit this terminology
usually applies only to vectors ξ of norm 1). Proposition 3.4 says, among other things,
that an operator is positive if and only if its expectation values in all states are positive.
The notion of positivity for elements of B(H) allows us to deﬁne a partial order
relation of B(H): let x, y ∈B(H). We say that x dominates y if x −y ≥0. We
write this as x ≥y. Let us note for future reference that for any x ∈B(H) we have
x∗x ≤∥x∥21, The proof is based on a simple computation:
ξ x∗xξ = ∥xξ∥2 ≤∥x∥2∥ξ∥2 = ξ ∥x∥2ξ ,
ξ ∈H.
Moreover, if x∗x ≤1, then by the same computation ∥x∥≤1. In other words we have
the following:
Proposition 3.5 For any positive t ∈B(H)

t ≤1

⇐⇒

∥t∥≤1

.
Proposition 3.4 can be used to obtain information about the partial order on B(H)
both of geometric and algebraic nature:
Corollary 3.6 B(H)+ is a convex cone, i.e.
(1)
if x ∈B(H)+ and λ ∈R+ then λx ∈B(H)+
(2)
if x, y ∈B(H)+ then x + y ∈B(H)+,
(3)
B(H)+ ∩

−B(H)+
	
= {0}.
Moreover, if x ∈B(H)+ and y ∈B(H) then y∗xy ∈B(H)+.

3.1 · Positive Operators
23
3
Proof
The ﬁrst of the listed properties of B(H)+ follows immediately from the deﬁnitions, while the
second is a consequence of characterization of positivity given by point (4) of Proposition 3.4.
If x ∈B(H)+ ∩

−B(H)+
	
then σ(x) = {0}, and since x is self-adjoint, we get x = 0.
Let x ∈B(H)+ and y ∈B(H). Then for any ξ ∈H we have

ξ y∗xyξ

= ⟨yξ x(yξ)⟩≥0,
which means that y∗xy ≥0.
⊓⊔
Let us note here that functional calculus for self-adjoint operators is compatible
with the order structure on B(H) in the sense that if x ∈B(H) is self-adjoint and
f, g ∈C

σ(x)
	
satisfy f ≥g then f (x) ≥g(x) in B(H) because
f (x) −g(x) = (f −g)(x) = (f −g)
1
2 (x)	∗(f −g)
1
2 (x)	 ∈B(H)+.
Proposition 3.7 Let x, y ∈B(H)+ be such that 0 ≤x ≤y and assume that x is invertible.
Then y is invertible and y−1 ≤x−1.
Proof
The compact set σ(x) lies in [0, +∞[ and it does not contain 0. Therefore there exists δ > 0
such that σ(x) ⊂[δ, +∞[ . By functional calculus we immediately get x ≥δ1, and so
y ≥δ1. Thus, again by functional calculus, we ﬁnd that y is invertible.
Now multiplying both sides of the inequality y ≥x by y−1
2 from left and right and using
Corollary 3.6 we obtain
y−1
2 xy−1
2 ≤1
which, in particular, means that
y−1
2 xy−1
2  ≤1. Thus
x
1
2 y−1
2 2 =
y−1
2 xy−1
2  ≤1
and consequently
y−1
2 x
1
2  =

x
1
2 y−1
2 	∗ ≤1.
This, in turn, shows that

y−1
2 x
1
2 	∗
y−1
2 x
1
2 	
≤
y−1
2 x
1
2 21 ≤1
or in other words
x
1
2 y−1x
1
2 ≤1.

3
24
Chapter 3 • Positive Operators
Multiplying both sides of this inequality by x−1
2 from left and right we arrive at
y−1 ≤x−1.
⊓⊔
Taking roots of positive operators has many other applications. An example of such
an application is provided by the following useful proposition:
Proposition 3.8 Any x ∈B(H) is a linear combination of four unitary operators.
Proof
Writing
x = 1
2(x + x∗) + i 1
2i(x −x∗),
we express x as a linear combination of self-adjoint operators. Now any self-adjoint operator
y ∈B(H) of norm 1 can be written in the form
y = 1
2


y + i(1 −y2)
1
2 	
+

y −i(1 −y2)
1
2 	
.
The operators y ± i(1 −y2)
1
2 are unitary, since
y ± i(1 −y2)
1
2 	∗y ± i(1 −y2)
1
2 	
=

y ∓i(1 −y2)
1
2 	
y ± i(1 −y2)
1
2 	
= y2 + (1 −y2) = 1
and similarly y ± i(1 −y2)
1
2 	y ± i(1 −y2)
1
2 	∗= 1.
⊓⊔
3.2
Projections
A projection is an operator e ∈B(H) such that e = e2 and e = e∗. We are using the
term “projection” in a way which is slightly more restrictive than usual. More precisely,
the term “projection” is often taken to mean “idempotent operator”, i.e. an x ∈B(H)
such that x2 = x. We have chosen to use the more restrictive deﬁnition requiring
that all projection be self-adjoint, because the extra ﬂexibility of working with general
idempotents will not have any signiﬁcance for the topics considered in this book. We
leave it to the reader to check that an idempotent operator is self-adjoint if and only if
its kernel and range are orthogonal.
Any projection e is a positive operator of norm 1 or 0. Moreover the operator 1 −e
is also a projection. The set of all projections in B(H) will be denoted by Proj

B(H)
	
.
Note that an operator e ∈B(H) is a projection if and only if it is self-adjoint and
the two functions λ 	→λ2 and λ 	→λ coincide on σ(e). It follows that σ(e) ⊂{0, 1}.
Conversely, if e ∈B(H) is self adjoint and σ(e) ⊂{0, 1} then e2 = e precisely because
the functions λ 	→λ2 and λ 	→λ are equal on σ(e).

3.2 · Projections
25
3
Let e ∈B(H) be a projection. Then the subspace eH ⊂H is closed and (1 −e)H
is the orthogonal complement of eH. Of course for any closed subspace S ⊂H there
exists a unique projection e ∈B(H) such that S = eH. It is not hard to check that if e
and f are projections then e ≤f if and only if eH ⊂f H.
We say that two projections e1, e2 ∈B(H) are orthogonal if e1e2 = 0. This is
equivalent to the subspaces e1H and e2H being orthogonal. Let us also note that for any
two projections e and f the operator e + f is a projection if and only if e and f are
orthogonal.
With any operator x ∈B(H) we can associate two projections l(x) and r(x): l(x) is
deﬁned to be the projection onto the closure of xH, while r(x) is the projection onto the
orthogonal complement of ker x. We have
l(x)x = x = xr(x).
The projections l(x) and r(x) are respectively called the left support and the right
support of x.
Since for any x ∈B(H) we have (xH)⊥= ker x∗(⟨η xξ⟩= 0 for all ξ if and only
if ⟨x∗η ξ⟩= 0 for all ξ), it is easy to see that l(x) = r(x∗) (equivalently l(x∗) = r(x)
for all x). In particular if x = x∗then l(x) = r(x) and, in this case, the common value
of l(x) and r(x) is denoted by s(x) and called the support of x.
Lemma 3.9 For any x ∈B(H) we have ker x = ker x∗x.
Proof
It is clear that ker x ⊂ker x∗x. On the other hand, if ξ ∈ker x∗x then ⟨ξ x∗xξ⟩= 0, so
∥xξ∥2 = 0.
⊓⊔
Proposition 3.10 For x ∈B(H) we have r(x) = s(x∗x) and l(x) = s(xx∗).
Proof
Using Lemma 3.9 we see that
r(x) = projection onto (ker x)⊥
= projection onto (ker x∗x)⊥= r(x∗x) = s(x∗x)
and similarly
l(x) = projection onto xH = projection onto (ker x∗)⊥
= projection onto (ker xx∗)⊥= r(xx∗) = s(xx∗).
⊓⊔

3
26
Chapter 3 • Positive Operators
3.3
Partial Isometries
Proposition 3.11 Let v ∈B(H). Then the following conditions are equivalent:
(1)
v∗v is a projection,
(2)
vv∗v = v,
(3)
v∗vv∗= v∗,
(4)
vv∗is a projection.
Proof
(1) and (4) are equivalent by Proposition 1.4 and remarks at the beginning of ▷Sect. 3.2.
More precisely σ(v∗v) is contained in {0, 1} if and only if so is σ(vv∗), and furthermore
both v∗v and vv∗are self-adjoint. It follows that v∗v is a projection if and only if vv∗is a
projection.
(1) ⇒(2): the support of any projection e is equal to e. Therefore, setting e = v∗v we
obtain
v∗v = s(v∗v) = r(v)
by Proposition 3.10. In particular vv∗v = v.
(2) ⇒(3): taking adjoints of both sides of the equality vv∗v = v we arrive at v∗vv∗= v∗.
(3) ⇒(4): multiplying both sides of v∗vv∗= v∗by v from the left we get vv∗vv∗= vv∗,
i.e. the self-adjoint operator vv∗satisﬁes (vv∗)2 = vv∗.
⊓⊔
An operator v ∈B(H) is called a partial isometry if it satisﬁes the equivalent
conditions of Proposition 3.11. The projections v∗v and vv∗are referred to as the initial
projection and ﬁnal projection of the partial isometry v, while their ranges v∗vH and
vv∗H are respectively the initial subspace and ﬁnal subspace of v.
Proposition 3.12 An operator v ∈B(H) is a partial isometry if and only if there exists a
closed subspace S ⊂H such that
∥vξ∥=
⎧
⎨
⎩
∥ξ∥,
ξ ∈S,
0,
ξ ∈S⊥.
(3.2)
In this case S is the initial subspace of v and the ﬁnal subspace of v is vS.
Proof
Assume ﬁrst that v is a partial isometry and let S = v∗vH. Then S is a closed subspace and
for ξ ∈S
⟨vξ vξ⟩=

ξ v∗vξ

= ⟨ξ ξ⟩,

3.4 · Polar Decomposition
27
3
while for ξ ∈S⊥
⟨vξ vξ⟩= ξ v∗vξ = 0.
In other words we obtain (3.2).
Conversely, if v ∈B(H) is an operator satisfying (3.2) for some closed subspace S ⊂H
then clearly v∗vξ = 0 for ξ ∈S⊥. Moreover for ξ ∈S we have v∗vξ = ξ. Indeed: take any
η ∈H and let η = ηS + ηS⊥be the decomposition of η into components in S and in S⊥.
Then

η v∗vξ

=

ηS + ηS⊥v∗vξ

=

vηS + vηS⊥vξ

= ⟨vηS vξ⟩= ⟨ηS ξ⟩=

ηS + ηS⊥ξ

= ⟨η ξ⟩.
In the third equality of the above computation we used the fact that v maps S⊥to {0} and in
the fourth we used the property

vξ′ vξ = ξ′ ξ ,
ξ, ξ′ ∈S
which follows from the fact that v is isometric on S via the polarization identity.
⊓⊔
A partial isometry v on H whose initial subspace is H (i.e. v∗v = 1) is called an
isometry. This terminology is in agreement with the standard meaning of “isometry”, as
in this case v is an isometric mapping of H onto the subspace vH = vv∗H of H.
3.4
Polar Decomposition
Theorem 3.13
Let x ∈B(H). Then there exists a unique pair of operators (v, a) such that
(1)
x = va,
(2)
a is positive,
(3)
v∗v = s(a).
Proof
We begin by proving existence of a pair (v, a) satisfying conditions (1)–(3). Let a = (x∗x)
1
2 .
For any ξ ∈H we have
∥aξ∥2 =

(x∗x)
1
2 ξ (x∗x)
1
2 ξ

=

ξ x∗xξ

= ⟨xξ xξ⟩= ∥xξ∥2.
It follows that there exists a linear map v00 : aH →xH such that for any ξ ∈H
v00aξ = xξ.

3
28
Chapter 3 • Positive Operators
(indeed: if η ∈aH, then there exists ξ ∈H such that η = aξ and the vector xξ depends only
on η because if η = aξ′ for another ξ′ ∈H then ∥xξ′ −xξ∥=
x(ξ −ξ′)
 =
a(ξ −ξ′)
 =
∥η−η∥= 0). It is clear that v00 is an isometric map, and so it extends uniquely to an isometry
v0 : aH →H. Now let v be the partial isometry deﬁned as follows:
vξ =
⎧
⎨
⎩
v0ξ,
ξ ∈aH,
0,
ξ ∈(aH)⊥.
The operator v was deﬁned precisely so that
va = x.
Moreover v∗v is the projection onto the initial subspace of v, i.e. onto the closure of the range
of a. In other words
v∗v = l(a) = s(a),
because a is self-adjoint.
We now pass to the proof of uniqueness of the pair (v, a). Let (u, b) be a pair of operators
such that
▬x = ub,
▬b is positive,
▬u∗u = s(b).
Then
a2 = x∗x = bu∗ub = bs(b)b = b2,
so by uniqueness of square roots we get b = a. Now, since u is a partial isometry with initial
projection s(b) = s(a), its initial subspace must be aH. Therefore
uξ = 0,
ξ ∈(aH)⊥.
On the other hand, for η ∈H we have
u(aη) = xη = v0(aη),
so u coincides with v0 on aH. It follows that u = v.
⊓⊔
The decomposition x = va of x ∈B(H) obtained in Theorem 3.13 is called
the polar decomposition of x. The partial isometry v entering polar decomposition is
sometimes referred to as the phase of x, while the positive operator a is called the
modulus or absolute value of x and is denoted by the symbol |x|. Let us further note that
if x is self-adjoint then |x| = f (x), where f (λ) = |λ| for all λ ∈σ(x).

3.5 · Monotone Convergence of Operators
29
3
ⓘRemark 3.14 Let x ∈B(H) and let x = v|x| be the polar decomposition of x.
(1)
The phase v of x is unitary if and only if ker x = 0 and the range of x is dense in H.
(2)
We have
x∗= |x|v∗= s

|x|
	
|x|v∗= v∗v|x|v∗= v∗
v|x|v∗	
.
Moreover, the operator v|x|v∗is positive and it is not hard to check that
s

v|x|v∗	
= vs

|x|
	
v∗= vv∗vv∗= vv∗.
It follows that x∗= v∗v|x|v∗	 is the polar decomposition of x∗.
(3)
Assume that x is self-adjoint. Then |x| = x+ + x−and v = s(x+) −s(x−).
3.5
Monotone Convergence of Operators
In addition to metric topology deﬁned by the operator norm there are a number of other
useful topologies on B(H). On of them is the strong topology deﬁned by the family of
seminorms {pξ}ξ∈H, where
pξ(x) = ∥xξ∥,
x ∈B(H).
In this topology a net of operators (xi)i∈I converges to x ∈B(H) if and only if for any
ξ ∈H we have xiξ −→
i∈I xξ, i.e. the operators xi converge to x pointwise on H.
Theorem 3.15
Let (xi)i∈I be a net of self-adjoint operators such that

i ≽j

⇒

xi ≥xj

and assume that there exists a constant C > 0 such that ∥xi∥≤C for all i ∈I.
Then the net (xi)i∈I has a supremum (least upper bound) in B(H), i.e. there exists a
self-adjoint operator x such that x ≥xi for all i ∈I and any operator y such that
y ≥xi for all i ∈I satisﬁes y ≥x. Moreover, the net (xi)i∈I converges to x in strong
topology.
Proof
We begin by noticing that for any ζ ∈H the net
 ⟨ζ xiζ⟩	
i∈I is bounded and non-
decreasing, so it converges to its supremum
sup
i∈I
⟨ζ xiζ⟩= lim
i∈I ⟨ζ xiζ⟩.

3
30
Chapter 3 • Positive Operators
It follows that for each ξ, η ∈H the net
 ⟨ξ xiη⟩	
i∈I converges, as
⟨ξ xiη⟩= 1
4
3

k=0
ik 
η + ikξ xi(η + ikξ)

,
i ∈I.
We let
F(ξ, η) = lim
i∈I ⟨ξ xiη⟩,
ξ, η ∈H.
It is easy to see that F is a sesquilinear form which is bounded, since
F(ξ, η)
 =
 lim
i∈I ⟨ξ xiη⟩
 = lim
i∈I
 ⟨ξ xiη⟩
 ≤C∥ξ∥∥η∥,
ξ, η ∈H,
and therefore there exists a unique operator x ∈B(H) such that
⟨ξ xη⟩= F(ξ, η) = lim
i∈I ⟨ξ xiη⟩,
ξ, η ∈H.
The operator x is self-adjoint, since F(ξ, ξ) is real for any ξ (as a limit of real numbers,
cf. Proposition 3.3(2)). Moreover x = sup
i∈I
xi in the sense of partial order on B(H). Indeed:
for ξ ∈H we have
⟨ξ xξ⟩= lim
j∈I

ξ xjξ

= sup
j∈I

ξ xjξ

≥⟨ξ xiξ⟩,
i ∈I
which means that x ≥xi for all i ∈I. Furthermore, if y ≥xi for all i then for any ξ ∈H
we have
⟨ξ yξ⟩≥⟨ξ xiξ⟩,
i ∈I,
so that ⟨ξ yξ⟩≥sup
j∈I

ξ xjξ

= ⟨ξ xξ⟩. This means that y ≥x.
To see that (xi)i∈I converges to x in strong topology take any ξ ∈H. We have
∥xξ −xiξ∥2 =
(x −xi)ξ
2 =
(x −xi)
1
2 (x −xi)
1
2 ξ
2
≤
(x −xi)
1
2 2(x −xi)
1
2 ξ
2
=
(x −xi)
(x −xi)
1
2 ξ
2
≤2C
(x −xi)
1
2 ξ
2
= 2C

(x −xi)
1
2 ξ (x −xi)
1
2 ξ

= 2C ⟨ξ (x −xi)ξ⟩= 2C

F(ξ, ξ) −⟨ξ xiξ⟩
	
−−→
i∈I 0,
so xiξ −−→
i∈I xξ.
⊓⊔

3.5 · Monotone Convergence of Operators
31
3
Notes
In this chapter we have laid the groundwork for further development of operator theory.
A particularly crucial role in several of the following chapters will be played by
polar decomposition of operators. Numerous exercises and examples devoted to topics
mentioned above can be found in [Ped, Section 3.2], [ReSi1, Chapters VI and VII].

33
4
Spectral Theorems and Functional
Calculus
© Springer Nature Switzerland AG 2018
P. Sołtan, A Primer on Hilbert Space Operators, Compact Textbooks in Mathematics,
https://doi.org/10.1007/978-3-319-92061-0_4
One of the most important facts about operators on ﬁnite dimensional spaces equipped
with a scalar product is the spectral theorem which says that a self-adjoint operator m
can be written as a linear combination
m =
N

i=1
λiEi
(4.1)
of pairwise orthogonal projections
{E1, . . . , EN}
whose coefﬁcients {λ1, . . . , λN} are the (real) eigenvalues of m. As a consequence, for
any polynomial f ∈C[·] we have
f (m) =
N

i=1
f (λi)Ei.
(4.2)
Indeed: since E1, . . . , EN are pairwise orthogonal, for f (λ) = λn we obtain
f (m) =

N

i=1
λiEi
n
=
N

i1,...,in=1
λi1 . . . λinEi1 . . . Ein =
N

i=1
λm
i Ei
and the result for general f follows by linearity.
No doubt, in case of inﬁnite dimensional Hilbert spaces, the spectral theorem needs
to be appropriately reformulated. The search for an analog of the decomposition (4.1)
leads to the notion of a spectral measure which will be discussed in ▷Sect. 4.3. In this
new formulation the linear combination (4.1) is replaced by an appropriately deﬁned
integral.

4
34
Chapter 4 • Spectral Theorems and Functional Calculus
It turns out that some of the very useful forms of the spectral theorem generalize
not so much the equality (4.1), as (4.2). In other words the spectral theorem in one of
its forms deals with functional calculus. Functional calculus for continuous functions
on the spectrum of a self-adjoint operator was the focus of ▷Chap. 2. In this chapter
we will broaden the class of functions for which functional calculus can be deﬁned.
As an intermediate step we will prove yet another formulation of the spectral theorem,
namely we will show that a self-adjoint operator is unitarily equivalent to an operator of
multiplication by a function on an L2 space. Each of the above mentioned results can be
referred to as the spectral theorem and each has important and interesting consequences.
At the end of the chapter we will deﬁne holomorphic functional calculus and give a brief
account of functional calculus in C∗-algebras.
4.1
Multiplication Operators
Let (, μ) be a semiﬁnite measure space.1 Any f ∈L∞(,μ) deﬁnes a linear operator
Mf on L2(, μ):
(Mf ψ)(ω) = f (ω)ψ(ω),
ω ∈, ψ ∈L2(, μ).
The operator Mf is called the operator of multiplication by f (multiplication operator
for short). Clearly Mf is bounded and ∥Mf ∥≤∥f ∥∞.
Lemma 4.1 For f ∈L∞(, μ) we have
∥f ∥∞= inf c > 0 |f | ˙≤c.
Proof
By deﬁnition
∥f ∥∞=
inf
μ(K)=0 sup
ω∈
f (ω)
.
Let S =  sup
ω∈
|f (ω)| μ(K) = 0 and C = c > 0 |f | ˙≤c. We will show that inf C =
inf S.
Let s ∈S. Then there exists a measurable s ⊂ such that μ(Ks) = 0 and s =
sup
ω∈s
f (ω)
. Thus |f | ≤s on s which is of full measure and therefore s ∈C. It follows
that S ⊂C, and so inf S ≥inf C.
Let c ∈C. Then there is a measurable c ⊂ with μ(Kc) = 0 and |f | ≤c on c.
Thus s = sup
ω∈c
f (ω)
 ≤c. In other words for any c ∈C there exists s ∈S such that s ≤c,
which shows that inf C ≥inf S.
⊓⊔
1A measure space (, μ) is semiﬁnite if the measure μ is semiﬁnite, i.e. for any measurable  ⊂ such that
μ() > 0 there exists a measurable  ⊂ such that 0 < μ() + ∞.

4.1 · Multiplication Operators
35
4
Let us note that L∞(, μ) is a C∗-algebra with usual operations of addition and
multiplication and involution f 	→f .
Proposition 4.2 The map
L∞(, μ) ∋f 	−→Mf ∈B

L2(, μ)
	
is an isometric ∗-isomorphism onto its range.
Proof
The fact that f 	→Mf preserves algebraic operations (including the involution) is rather
obvious. We will check that the map in question is isometric. Let ψ ∈L2(, μ). For c ≥
∥f ∥∞we have c ˙≥|f |, so
∥f ψ∥2
2 =


|f |2|ψ|2 dμ ≤c2∥ψ∥2
2.
Therefore ∥Mf ∥≤c and consequently ∥Mf ∥≤∥f ∥∞by Lemma 4.1.
Conversely, if 0 < c < ∥f ∥∞then again by Lemma 4.1, the measure of the set

ω |f (ω)| ≥c

is non-zero. Thus there exists a measurable  ⊂ such that 0 < μ() <
+∞and |f | ≥c on . Let ψ =
1
√μ()χ. Then ∥ψ∥2 = 1 and
∥f ψ∥2
2 =
1
μ()


|f |2 dμ ≥c2,
so that ∥Mf ∥≥c. It follows that ∥Mf ∥≥∥f ∥∞.
⊓⊔
For a measurable function f :  →C we deﬁne the essential range of f as
Vess(f ) = λ ∈C for any neighborhood U of λ we have μf −1(U)	 > 0.
Note that if f ˙= g then Vess(f ) = Vess(g). Indeed: the condition that f ˙= g means that
f = g on certain measurable subset  ⊂ such that μ(K) = 0. Therefore for any
Borel subset A ⊂C
μf −1(A)	 = μf −1(A) ∩	 = μω ∈ f (ω) ∈A	
= μ

ω ∈ g(ω) ∈A
	
= μ

g−1(A) ∩
	
= μ

g−1(A)
	
.
It is also easy to check that Vess(f ) is a closed subset of C.
Theorem 4.3
Let f ∈L∞(, μ). Then σ(Mf ) = Vess(f ).

4
36
Chapter 4 • Spectral Theorems and Functional Calculus
Proof
Take a λ ∈CKVess(f ). Then there exists r > 0 such that the set

ω |λ −f (ω)| < r

has
measure 0, i.e.
λ −f (ω)
 ≥r almost everywhere on . Therefore the function
g(ω) =
1
λ−f (ω),
ω ∈
belongs to L∞(, μ) and it is clear that g is the inverse of λ −f . Thus the operator Mg is
the inverse of λ1 −Mf .
Conversely, let λ ∈Vess(f ). Then for any n the set
ω |λ −f (ω)| ≤1
n

has non-zero measure, and so there exists a measurable set n of ﬁnite and non-zero measure
such that |λ −f | ≤1
n on n. Let ψn =
1
√μ(n)χn. We have ∥ψn∥2 = 1 for all n and

λ −f (ω)
	
ψn(ω)
 ≤1
n
ψn(ω)
,
ω ∈,
so that
(λ1 −Mf )ψn∥2 ≤1
n. This, in turn, means that λ1 −Mf is not invertible, since if
y were the inverse of λ1 −Mf then we would have
1 =
y(λ1 −Mf )ψn

2 ≤∥y∥
(λ1 −Mf )ψn

2 −−−→
n→∞0.
⊓⊔
At some point later on the following fact will be needed:
Proposition 4.4 Let (, μ) be a semiﬁnite measure space and let f ∈L∞(, μ). Then
λ ∈C is an eigenvalue of the operator Mf ∈B

L2(, μ)
	
if and only if there exists a
measurable  ⊂ such that μ() > 0 and f ˙= λ on .
Proof
Assume there exists a set  with the properties listed in the formulation of the theorem.
Then it contains a measurable ′ such that 0 < μ(′) < +∞, and so ψ =
1
√
μ(′)χ′ is an
element of L2(, μ) such that ∥ψ∥2 = 1 and Mf ψ = λψ.
On the other hand, if there exists a non-zero ψ ∈L2(, μ) such that Mf ψ = λψ then
f ψ ˙= λψ. Let  =

ω ∈
ψ(ω) ̸= 0. Then we must have f ˙= λ on . Moreover
μ() > 0, since ψ ̸= 0.
⊓⊔
As is easily checked any operator Mf on L2(, μ) is normal and thus we
immediately have the following corollary:
Corollary 4.5 We have ∥Mf ∥= sup |λ| λ ∈Vess(f ).

4.1 · Multiplication Operators
37
4
Proof
∥Mf ∥= |σ(Mf )| = sup

|λ| λ ∈σ(Mf )

.
⊓⊔
ⓘRemark 4.6 Assume that Mf is self-adjoint (i.e. f is real-valued). Let g be a
continuous function on σ(Mf ) = Vess(f ). Then g(Mf ) = Mg◦f . Indeed: the mapping
C

σ(Mf )
	
∋g 	−→Mg◦f ∈B(H)
satisﬁes the conditions uniquely determining the continuous functional calculus for Mf
(the fact that it is isometric follows from Corollary 4.5).
Theorem 4.7
Let x ∈B(H) be a self-adjoint operator. Then there exists a semiﬁnite measure space
(, μ), an essentially bounded measurable real-valued function F on , and a unitary
operator
u : L2(, μ) −→H
such that
x = uMF u∗.
Proof
Let A =

f (x) f ∈C

σ(x)
	
. For a vector ξ ∈H we will denote by Aξ the subspace
f (x)ξ f ∈C

σ(x)
	
⊂H.
Let R be the family of orthonormal systems {ξi}i∈I in H such that Aξi ⊥Aξj for any
i, j ∈I with i ̸= j. We put a partial order on R via the relation of containment. By the
Kuratowski-Zorn lemma there exists a maximal element {ξj}j∈J of R.
Let us see that the subspace span
 
j∈J
Aξj

is dense in H. Indeed: if there were a vector
ξ with ∥ξ∥= 1 and ξ ⊥Aξj for all j then for any f, g ∈C

σ(x)
	
f (x)ξ g(x)ξj
 = ξ f (x)∗g(x)ξj
 = ξ (f g)(x)ξj
 = 0,
j ∈J,
and so the system {ξj}j∈J ∪{ξ} would also belong to R which would contradict the
maximality of {ξj}j∈J .
Put  = J ×σ(x). By considering on J the discrete topology we obtain a locally compact
topology on  (the product topology). Furthermore, let M be the family of subsets  ⊂

4
38
Chapter 4 • Spectral Theorems and Functional Calculus
such that for each j
j =

λ ∈σ(x) (j, λ) ∈

is a Borel subset of σ(x). Then M is a σ-algebra.2
For any j ∈J the map
C

σ(x)
	
∋f 	−→

ξj f (x)ξj

∈C
is a positive linear functional, so by the Riesz-Markov-Kakutani representation theorem there
exists a positive regular Borel measure μj on σ(x) such that
ξj f (x)ξj
 =

σ(x)
f dμj,
f ∈Cσ(x)	.
The measures {μj}j∈J allow us to deﬁne a measure μ on M: for  ∈M we put
μ() =

j∈J
μj(j ).
It is easy to see that μ is a semiﬁnite measure on  (all the measures μj are ﬁnite).
Moreover
▬ψ ∈L2(, μ) if and only if there exist j1, j2, . . . ∈J such that j ∈J K{j1, j2, . . . } we
have ψ(j, λ) = 0 for μj -almost all λ and
∞

n=1

σ(x)
ψ(jn, λ)
2dμjn(λ) < +∞,
▬the space Cc(), i.e. the space of continuous functions on  with compact support, is
dense in ∈L2(, μ).
We will now deﬁne the operator u ∈B

L2(, μ), H
	
. On the dense subspace Cc() we
put
uf =

j∈J
f (j, x)ξj ,
f ∈Cc()
2The fact that M is a σ-algebra is rather obvious. Moreover, it turns out that M is nothing else, but the σ-
algebra of Borel subsets of . Indeed: clearly any open subset of  belongs to M, so that M contains all
Borel sets. On the other hand if  is a Borel subset of  then for each j ∈J the set j can be identiﬁed with
 ∩

{j} × σ(x)
	
. This identiﬁcation comes from the homeomorphism
σ(x) ∋λ 	−→(j, λ) ∈{j} × σ(x),
which, of course, preserves the Borel structure. It follows that each j is a Borel subset of σ(x).

4.1 · Multiplication Operators
39
4
(the sum is ﬁnite, as the support of f is compact). Then for any f ∈Cc() we have
∥uf ∥2 =


j∈J
f (j, x)ξj

2
=

j∈J
f (j, x)ξj

i∈J
f (i, x)ξi

=

i,j∈J

f (j, x)ξj f (i, x)ξi

=

j∈J

f (j, x)ξj f (j, x)ξj

=

j∈J

ξj f (j, x)∗f (j, x)ξj

=

j∈J

ξj |f |2(j, x)ξj

=

j∈J

σ(x)
|f |2(j, λ) dμj (λ) =


|f |2 dμ = ∥f ∥2
2,
and consequently u extends to an isometry L2(, μ) →H.
Note that the range of u contains 
j∈J
Aξj which is linearly dense in H. This implies that
u is surjective and, hence, unitary.
Deﬁne F :  →C by
F(j, λ) = λ,
(j, λ) ∈.
Then F is bounded and continuous (so, in particular, measurable). Moreover, for any f ∈
Cc() ⊂L2(, μ) we have
u(MF f ) = u(Ff ) =

j∈J
(Ff )(j, x)ξj
=

j∈J
xf (j, x)ξj = x

j∈J
f (j, x)ξj = xuf.
By continuity we obtain uMF ψ
= xuψ for all ψ
∈L2(, μ), which means that
uMF u∗= x.
⊓⊔
Two operators x ∈B(H) and y ∈B(K) are unitarily equivalent if there exists
a unitary u ∈B(K, H) such that x = uyu∗. Theorem 4.7 says that any self-adjoint
operator is unitarily equivalent to an operator of multiplication by a bounded function
(even by one which is continuous on a locally compact topological space). It turns out
that analogous statement holds also for any normal operator (Theorem 7.6). Of course,
operators which are unitarily equivalent have identical spectra and share many other
properties. Also it is sometimes easy to answer questions about a given self-adjoint
operator using the fact that it is equivalent to a multiplication operator.
ⓘRemark 4.8
(1)
Let A ⊂B(H) be a ∗-algebra of operators. A vector ξ ∈H is cyclic for A if Aξ is
a dense subspace of H. Now if x ∈B(H) is a self-adjoint operator such that A =
C∗(x, 1) has a cyclic vector in H then by the reasoning in the proof of Theorem 4.7 we

4
40
Chapter 4 • Spectral Theorems and Functional Calculus
can show that x is unitarily equivalent to an operator of multiplication by the identity
function on σ(x).
(2)
Let x ∈B(H) and y ∈B(K) be self-adjoint and unitarily equivalent via u ∈B(K, H),
i.e. x = uyu∗. Then, as we already mentioned, we have σ(x) = σ(y) and for any
f ∈C

σ(x)
	
we have f (x) = uf (y)u∗. This follows immediately from the uniqueness
of continuous functional calculus.
4.2
Borel Functional Calculus
Let x ∈B(H) be a self-adjoint operator. In this section we will generalize the continuous
functional calculus for x to a wider class of functions, namely the bounded Borel
functions on σ(x). We begin with a proposition on automatic continuity of certain ∗-
homomorphisms.3
Proposition 4.9 Let K be a Hilbert space and let B be a Banach ∗-algebra with unit.
Consider a unital ∗-homomorphism  : B →B(K). Then  is a contraction.
Proof
Let b ∈B and λ ∈C be such that λ1 −b is invertible in B. Then λ1 −(b) is an invertible
operator. In particular, putting b∗b instead of b we obtain
σ(b∗b)	 ⊂λ ∈C λ1 −b∗b is not invertible in B
Therefore
(b)
2 =
(b)∗(b)
 =
(b∗b)
 =
σ(b∗b)	
≤sup |λ| λ1 −b∗b is not invertible in B ≤∥b∗b∥= ∥b∥2,
where the last equality follows from the fact that if |λ| > ∥b∗b∥then λ1 −b∗b is invertible
with
(λ1 −b∗b)−1 =
∞

n=0
λ−n−1(b∗b)n
(the series converges in the Banach algebra B). This argument shows that every unital ∗-
homomorphism from a Banach ∗-algebra to B(K) is contractive.
⊓⊔
Note that if X is a topological space then the set B(X) of bounded Borel functions
on X is a Banach ∗-algebra (in fact, a C∗-algebra) with natural operations of addition
and multiplication, involution f 	→f and the uniform norm ∥· ∥∞.
3A ∗-homomorphism is a linear, multiplicative and ∗-preserving map. A homomorphism  : A →B between
unital algebras is called unital when (1A) = 1B.

4.2 · Borel Functional Calculus
41
4
The extension of functional calculus for self-adjoint operators from the class of
continuous functions to bounded Borel functions will be based on Theorem 4.7 and
the observation made in Remark 4.6.
Theorem 4.10 (Borel Functional Calculus)
Let x ∈B(H) be a self-adjoint operator and denote by B

σ(x)
	
the ∗-algebra of
bounded Borel functions on σ(x). Then there exists a unique unital ∗-homomorphism
B

σ(x)
	
→B(H) denoted by
B

σ(x)
	
∋f 	−→f (x) ∈B(H)
such that
▬if f (λ) = λ for all λ ∈σ(x) then f (x) = x,
▬if (fn)n∈N is a uniformly bounded sequence of Borel functions converging point-
wise to f then fn(x) −−−→
n→∞f (x) in strong topology.
Moreover this homomorphism extends the isomorphism Cσ(x)	 →C∗(x, 1) given
by the continuous functional calculus.
Proof
The operator x is unitarily equivalent to an operator of multiplication by a Borel (in fact even
continuous) function F on a Hilbert space L2(, μ). Moreover the range of F is σ(x), so for
any bounded Borel function f on σ(x) the composition f ◦F is measurable (with respect to
the Borel structure on ) and bounded. Deﬁne
f (x) = uMf ◦F u∗,
f ∈B

σ(x)
	
.
It is clear that f 	→f (x) is a unital ∗-homomorphism and if f (λ) = λ for all λ ∈σ(x)
then f (x) = x. Incidentally, it is also clear that f 	→f (x) is a contraction, as
f (x)
 =
∥uMf ◦F u∗∥= ∥Mf ◦F ∥≤∥f ∥∞, so in this case we do not need to use Proposition 4.9.
Let (fn)n∈N be a bounded sequence of Borel functions on σ(x) converging pointwise to
f and take ξ ∈H. Setting ψ = u∗ξ and using the fact that u is isometric we obtain
fn(x)ξ −f (x)ξ
2 = ∥uM(fn−f )◦F u∗ξ∥2
=
uM(fn−f )◦F ψ
2
=
M(fn−f )◦F ψ
2
=


fn

F(ω)
	
−f

F(ω)
	2ψ(ω)
2 dμ(ω) −−−→
n→∞0
by the dominated convergence theorem.

4
42
Chapter 4 • Spectral Theorems and Functional Calculus
We have already established that the map B

σ(x)
	
∋f 	→f (x) ∈B(H) is a contractive
unital ∗-homomorphism and that it maps the identity function to x. It is therefore immediate
from the uniqueness of continuous functional calculus that it extends the latter.
Let us address the uniqueness of the homomorphism
B

σ(x)
	
∋f 	−→f (x) ∈B(H).
Let  : B

σ(x)
	
→B(H) be a unital ∗-homomorphism (which by Proposition 4.9 is
necessarily contractive) mapping the identity function to x and such that if (fn)n∈N is a
bounded sequence of Borel functions converging pointwise to f then (fn) converges to
(f ) in strong topology. It follows from the uniqueness of continuous functional calculus
that if f is continuous then (f ) = f (x).
For an open set  ⊂σ(x) choose a bounded sequence of continuous functions (fn)n∈N
converging pointwise to χ. Then for any ξ ∈H we have
χ(x)ξ = lim
n→∞fn(x)ξ = lim
n→∞(fn)ξ = (χ)ξ.
Thus the family
L =  ∈M (χ) = χ(x)
contains all open sets. This family is also a λ-system (see Appendix A.2):
(1)
 is open, so  ∈L,
(2)
if  ∈L then
(χ∁) = (χ −χ) = 1 −(χ) = 1 −χ(x) = χ∁(x)
which means that ∁∈L,
(3)
if (n)n∈N is a sequence of pairwise disjoint elements of L and  =
∞

n=1
n then
χ =
∞

n=1
χn = lim
N→∞
N

n=1
χn,
i.e. χ is a pointwise limit of the sequence
 N
n=1
χn

N∈N
and for any ξ ∈H
(χ)ξ = lim
N→∞
N

n=1
(χn)ξ = lim
N→∞
N

n=1
χn(x)ξ = χ(x)ξ.
Therefore  ∈L.
Since the family of all open subsets of σ(x) is a π-system, by Dynkin’s theorem on π- and
λ-systems (Theorem A.2), we have M ⊂L. Now any bounded Borel function is a pointwise

4.3 · Spectral Measures
43
4
limit of a bounded sequence of simple functions, so the homomorphisms  and f 	→f (x)
agree on all of B

σ(x)
	
.
⊓⊔
4.3
Spectral Measures
Let  be a set and let M be a σ-algebra of subsets of . A spectral measure on  is a
map E : M →Proj

B(H)
	
such that
▬E(∅) = 0, E() = 1,
▬for any 1, 2 ∈M we have E(1 ∩2) = E(1)E(2),
▬for pairwise disjoint 1, 2, . . . ∈M we have E
 ∞

n=1
n

=
∞

n=1
E(n).
The sum in the last condition is taken to mean the limit of ﬁnite sums in strong topology.
Note that it follows from the ﬁrst two conditions that projections corresponding to
disjoint sets are orthogonal and hence their sum is a projection.
Fundamental examples of spectral measures arise from self-adjoint operators: let
x ∈B(H) be self-adjoint, put  = σ(x) and let M be the σ-algebra of Borel subsets of
σ(x). Deﬁne
Ex : M ∋ 	−→χ(x) ∈Proj B(H)	.
(4.3)
Then Ex is a spectral measure. We will see later on that this measure determines x
uniquely.
Let E be a spectral measure on . Then for any ξ ∈H the formula
 	−→⟨ξ E()ξ⟩,
 ∈M
deﬁnes a ﬁnite (positive) measure on . We will denote this measure by the symbol
⟨ξ Eξ⟩, so that the integral of a function f with respect to this measure will be written
as


f d⟨ξ | Eξ⟩
or


f (ω) d⟨ξ | E(ω)ξ⟩.
Similarly, for ξ, η ∈H the mapping
⟨ξ Eη⟩:  	−→⟨ξ E()η⟩,
 ∈M
is a complex measure with ﬁnite total variation. Let us recall that the total variation of
a measure ν is the supremum of all sums of the form
N
n=1
ν(n)
, where {1, . . . , N}
is a ﬁnite partition of  into measurable sets. for ν = ⟨ξ Eη⟩the total variation is
bounded by ∥ξ∥∥η∥. Indeed: for any partition {1, . . . , N} there are complex numbers

4
44
Chapter 4 • Spectral Theorems and Functional Calculus
λ1, . . . , λN of modulus one such that
N

n=1
 ⟨ξ Eη⟩(n)
 =
N

n=1
 ⟨ξ E(n)η⟩
 =
N

n=1
λn ⟨ξ E(n)η⟩= ⟨ξ tη⟩,
where t
=
N
n=1
λnE(n). Since the projections E(1), . . . , E(N) are pairwise
orthogonal, we have
∥t∥2 = ∥t∗t∥=


N

n=1
λnE(n)

N

m=1
λmE(m)

=

N

m,n=1
λnλmE(n)E(m)
 =

N

n=1
E(n)
 = ∥1∥= 1
which shows that the total variation of ⟨ξ Eη⟩is not greater than ∥ξ∥∥η∥.
Let us notice further that for any bounded measurable function f on  the quantity


f (ω)d⟨ξ | E(ω)η⟩
is a sesquilinear form with respect to the variables (ξ,η) which is bounded by
∥ξ∥∥η∥∥f ∥∞. Consequently it deﬁnes a bounded operator xf ∈B(H) via

ξ xf η

=


f (ω)d⟨ξ | E(ω)η⟩,
ξ, η ∈H.
Theorem 4.11
The map f 	→xf
∈B(H) is a ∗-homomorphism from the algebra of bounded
measurable functions on  into B(H). Moreover, if (fn)n∈N is a uniformly bounded
sequence of functions converging pointwise to f then
xfn −−−→
n→∞xf
in strong topology.

4.3 · Spectral Measures
45
4
Proof
First let us notice that the map f 	→xf is a contraction for the norm ∥· ∥∞on bounded
measurable functions and the operator norm, since
∥xf ∥=
sup
∥ξ∥=∥η∥=1
 
ξ xf η  =
sup
∥ξ∥=∥η∥=1



f d⟨ξ | Eη⟩

≤sup

|f | ·

total variation of ⟨ξ Eη⟩	
≤sup

|f |.
Therefore it will be enough to prove multiplicativity
xf xg = xfg
for simple functions only, as they are uniformly dense in the set of bounded measurable
functions. Let
f =
N

n=1
αnχn,
g =
M

m=1
βmχm.
We have
xf xg =
 N

n=1
αnE(n)
  M

m=1
βmE(m)

=

m,n
αnβmE(n)E(m)
=

m,n
αnβmE(n ∩m) = xfg.
Analogous argument shows that xf = xf ∗.
Now let (fn)n∈N be a bounded sequence of measurable functions converging pointwise
to f . Then for any ξ ∈H
∥xfnξ −xf ξ∥2 =

ξ x|fn−f |2ξ

=


fn(ω) −f (ω)
2d⟨ξ | E(ω)ξ⟩−−−→
n→∞0
by the dominated converge theorem.
⊓⊔
Let us introduce the following notation for operators xf :
xf =


f (ω) dE(ω).
(4.4)
Let x ∈B(H) be self-adjoint and let Ex be the spectral measure on σ(x) deﬁned by
(4.3). Then it is easy to check that f 	→f (x) and f 	→xf agree on simple functions:

4
46
Chapter 4 • Spectral Theorems and Functional Calculus
for f =
N
n=1
λnχn both f (x) and xf are equal to
N

n=1
λnEx(n).
Since any Borel function is a pointwise limit of simple functions, we get f (x) = xf for
all f ∈B

σ(x)
	
, i.e.
f (x) =

σ(x)
f (λ) dEx(λ),
f ∈Bσ(x)	.
In particular for f (λ) = λ we have
x =

σ(x)
λ dEx(λ).
(4.5)
For a ﬁxed self-adjoint operator x ∈B(H) a spectral measure Ex such that (4.5)
holds is unique. To see that note that if
x =

σ(x)
λ dE(λ)
for some Borel spectral measure E on σ(x) then the mapping
B

σ(x)
	
∋f 	−→

σ(x)
f (λ) dE(λ)
satisﬁes the conditions uniquely deﬁning the Borel functional calculus for x. Therefore
for each bounded Borel function f we have

σ(x)
f (λ) dE(λ) = f (x) =

σ(x)
f (λ) dEx(λ).
Applying this to f = χ for an arbitrary Borel set  ⊂σ(x) we obtain
E() = Ex(),
so the two measures are equal.

4.4 · Holomorphic Functional Calculus
47
4
4.4
Holomorphic Functional Calculus
Let x ∈B(H) be an arbitrary operator. In particular, x is not assumed to be self-adjoint.
The algebra of functions holomorphic on a neighborhood of σ(x) will be denoted by the
symbol H σ(x)	.4
Let f ∈H σ(x)	 and let  be a positively oriented curve surrounding σ(x)
contained in the domain of holomorphy of f . Deﬁne
f (x) =
1
2πi


f (λ)(λ1 −x)−1dλ
(the integral is of a continuous Banach space-valued function over a compact set). As
usual, the value of the integral is independent of the choice of the curve . Moreover, it
is easy to see that f (x) commutes with x.
Theorem 4.12 (Holomorphic Functional Calculus)
Let x ∈B(H). Then
(1)
if f is a polynomial function f (λ) = α0 + α1λ + · · · + αnλn then
f (x) = α01 + α1x + · · · + αnxn,
(2)
the map H

σ(x)
	
∋f 	→f (x) ∈B(H) is a unital homomorphism.
Proof
Let us ﬁrst consider the case of f (λ) = λm for some m ∈Z+. Let  be a positively oriented
circle around 0 with radius r > ∥x∥. For λ ∈ we have
(λ1 −x)−1 =
∞

n=0
λ−n−1xn.
Therefore
f (x) =
1
2πi


f (λ)(λ1 −x)−1dλ
=
∞

n=0
1
2πi


λm−n−1xn dλ
=
∞

n=0

1
2πi


λm−n−1 dλ

xn = xm.
4More precisely, elements of H

σ(x)
	
are equivalence classes of the equivalence relation identifying functions
which coincide on some neighborhood of σ(x).

4
48
Chapter 4 • Spectral Theorems and Functional Calculus
As the map f 	→f (x) clearly is linear, we immediately infer that if f is a polynomial
f (λ) = α0 + α1λ + · · · + αnλn then
f (x) = α01 + α1x + · · · + αnxn.
Now we will show that the map f 	→f (x) is multiplicative. Let f, g ∈H

σ(x)
	
and let
 and ′ be curves around σ(x) contained within the intersection of domains of holomorphy
of f and g, and such that ′ lies outside of . Using the resolvent identity
(λ1 −x)−1 −(μ1 −x)−1 = (μ −λ)(λ1 −x)−1(μ1 −x)−1
(see Remark 1.3) we compute:
f (x)g(x) =
 1
2πi
	2
 

f (λ)(λ1 −x)−1dλ
 
′
g(μ)(μ1 −x)−1dμ

=  1
2πi
	2 


′
f (λ)g(μ)(λ1 −x)−1(μ1 −x)−1dμ dλ
=
 1
2πi
	2 


′
f (λ)g(μ)
μ−λ

(λ1 −x)−1 −(μ1 −x)−1	
dμ dλ
=
 1
2πi
	2 


′
f (λ)g(μ)
μ−λ
(λ1 −x)−1dμ dλ
−
 1
2πi
	2 


′
f (λ)g(μ)
μ−λ
(μ1 −x)−1dμ dλ
=
 1
2πi
	2 

f (λ)(λ1 −x)−1
 
′
g(μ)
μ−λ dμ

dλ
− 1
2πi
	2 
′
g(μ)(μ1 −x)−1
 

f (λ)
μ−λdλ




=0
dμ
=
 1
2πi
	2 

f (λ)(λ1 −x)−1
 
′
g(μ)
μ−λ dμ

dλ
=
1
2πi


f (λ)

1
2πi

′
g(μ)
μ−λ dμ

(λ1 −x)−1dλ
=
1
2πi


f (λ)g(λ)(λ1 −x)−1dλ = (fg)(x).
The indicated integral is equal to 0 because μ ∈′ and  lies inside ′, so we are integrating
a holomorphic function over a curve contractible within its domain of holomorphy.
⊓⊔

4.4 · Holomorphic Functional Calculus
49
4
Proposition 4.13 Let x ∈B(H). Then for any f
∈H

σ(x)
	
we have σ

f (x)
	
=
f

σ(x)
	
.
Proof
Take μ ∈CKf

σ(x)
	
. Then the function hμ : λ 	→

μ −f (λ)
	−1 is holomorphic on a
neighborhood of σ(x) and we have
hμ(x)

μ1 −f (x)
	
=

μ1 −f (x)
	
hμ(x) = 1,
so that μ ̸∈σ

f (x)
	
. In other words σ

f (x)
	
⊂f

σ(x)
	
.
Now let μ ∈f

σ(x)
	
. Then there exists λ0 ∈σ(x) such that μ = f (λ0) and
μ −f (λ) = f (λ0) −f (λ) = (λ0 −λ) f (λ0)−f (λ)
λ0−λ
= (λ0 −λ)g(λ),
(4.6)
where
g(λ) =
⎧
⎨
⎩
f (λ0)−f (λ)
λ0−λ
,
λ ̸= λ0,
f ′(λ0),
λ = λ0
belongs to H

σ(x)
	
. Applying both sides of (4.6) to x we obtain
μ1 −f (x) = (λ01 −x)g(x).
If the operator μ1 −f (x) were invertible, so would have to be λ01−x, as λ01−x and g(x)
commute. However, λ0 ∈σ(x), so it follows that μ ∈σ

f (x)
	
. This shows that f

σ(x)
	
⊂
σ

f (x)
	
.
⊓⊔
Proposition 4.14 Let x ∈B(H), g ∈H

σ(x)
	
and f ∈H

σ

g(x)
		
. Then
f

g(x)
	
= (f ◦g)(x)
Proof
Let  be a positively oriented curve surrounding σ(x) within domain of holomorphy of g
and let ′ be a positively oriented curve in the domain of holomorphy of f surrounding
σ

g(x)
	
= g

σ(x)
	
and lying outside the image of  under g. For μ ∈′ let hμ(λ) =
1
μ−g(λ). Then hμ is holomorphic on a neighborhood of σ(x) and hμ(x) =

μ1 −g(x)
	−1.
Thus
f

g(x)
	
=
1
2πi

′
f (μ)

μ1 −g(x)
	−1dμ
=
1
2πi

′
f (μ)hμ(x) dμ

4
50
Chapter 4 • Spectral Theorems and Functional Calculus
=
1
2πi

′
f (μ)

1
2πi


1
μ−g(λ)(λ1 −x)−1dλ

dμ
=
1
2πi



1
2πi

′
f (μ)
μ−g(λ) dμ

(λ1 −x)−1dλ
=
1
2πi


(f ◦g)(λ)(λ1 −x)−1dλ = (f ◦g)(x).
⊓⊔
Let D ⊂C be an open set and denote by D the set {z z ∈D}. Let f be a
holomorphic function on D. Then we can deﬁne a function 
f : D →C putting

f (z) = f (z),
z ∈D.
It is easy to check that 
f is holomorphic on D.
Proposition 4.15 Let x ∈B(H) and f ∈H σ(x)	. Then f (x)∗= 
f (x∗).
Proof
Choose a positively oriented curve  surrounding σ(x) within domain of holomorphy of f .
Denote by ′ the image of  under complex conjugation with negative orientation, and by 
the same curve with positive orientation we obtain
f (x)∗=

1
2πi


f (λ)(λ1 −x)−1dλ
∗
= −1
2πi


f (λ)(λ1 −x∗)−1dλ
= −1
2πi

−

′
f (μ)(μ1 −x∗)−1dμ

=
1
2πi



f (μ)(μ1 −x∗)−1dμ.
⊓⊔
Proposition 4.16 Let x ∈B(H) be self-adjoint. Then the holomorphic functional calculus
for x is the restriction to H

σ(x)
	
of the isomorphism
C

σ(x)
	
−→C∗(x, 1)
given by the continuous functional calculus.

4.4 · Holomorphic Functional Calculus
51
4
Proof
For a temporary distinction, denote the image of f
∈H

σ(x)
	
under holomorphic
functional calculus by (f ) instead of f (x), reserving the latter symbol for the image of
f under continuous functional calculus. For f ∈H

σ(x)
	
the operator (f ) is normal (by
Proposition 4.15), and so
(f )
 =
σ

(f )
	 = sup

|f (λ)| λ ∈σ(x)

.
It follows that H
σ(x)	 ∋f 	→(f ) extends uniquely to an isometry Cσ(x)	 →B(H)
mapping any polynomial p to p(x). But such a map must coincide with the continuous
functional calculus and hence both calculi must agree on H σ(x)	.
⊓⊔
Consider now the entire function exp. For any x ∈B(H) the operator exp(x) can be
written as the sum of the convergent series
exp(x) =
∞

m=0
1
m!xm
(this follows from the deﬁnition of holomorphic functional calculus and expansion of
exp in a power series). By standard manipulation performed on absolutely convergent
series we easily check that if x and y commute then:
exp(x) exp(y) =
 ∞

n=0
xn
n!
  ∞

m=0
ym
m!

=
∞

k=0
k

l=0
xl
l!
yk−l
(k−l)!
=
∞

k=0
1
k!
k

l=0
k
l

xlyk−l =
∞

k=0
(x+y)k
k!
= exp(x + y).
The general situation is described by the next theorem:
Theorem 4.17 (Lie-Trotter Formula)
Let x, y ∈B(H). Then
exp(x + y) = lim
n→∞
 exp  1
nx	 exp  1
ny		n.
Proof
For n ∈N denote
sn = exp
 1
n(x + y)
	
,
tn = exp
 1
nx
	
exp
 1
ny
	
.

4
52
Chapter 4 • Spectral Theorems and Functional Calculus
We have
∥sn∥=

∞

m=0
1
m!
1
nm (x + y)m
 ≤
∞

m=0
1
m!
1
nm

∥x∥+ ∥y∥
	m = exp

∥x∥+∥y∥
n

and
∥tn∥≤
 exp
 1
nx
	 exp
 1
ny
	 ≤exp

∥x∥
n

exp

∥y∥
n

= exp

∥x∥+∥y∥
n

.
Furthermore
∥sn −tn∥=

∞

m=0
1
m!
1
nm (x + y)m −
 ∞

k=0
1
k!
1
nk xk
 ∞

l=0
1
l!
1
nl yl

=
1 + 1
n(x + y) +
∞

m=2
1
m!
1
nm (x + y)m
−1 −1
nx −1
ny −
 ∞

k=1
1
k!
1
nk xk
 ∞

l=1
1
l!
1
nl yl

=

∞

m=2
1
m!
1
nm (x + y)m −
 ∞

k=1
1
k!
1
nk xk
 ∞

l=1
1
l!
1
nl yl

= 1
n2

∞

m=2
1
m!
1
nm−2 (x + y)m −
 ∞

k=1
1
k!
1
nk−1 xk
 ∞

l=1
1
l!
1
nl−1 yl

= const.
n2 .
Using this and the identity
sn
n −tn
n =
n−1

r=0
sr
n(sn −tn)tn−1−r
n
we obtain the following estimate:
∥sn
n −tn
n∥≤
n−1

r=0
∥sr
n∥∥sn −tn∥∥tn−1−r
n
∥
≤n

max

∥sn∥, ∥tn∥n
∥sn −tn∥≤const.
n
exp ∥x∥+ ∥y∥	

4.5 · Theorems of Fuglede and Putnam
53
4
and hence
lim
n→∞

exp
 1
nx
	
exp
 1
ny
		n = lim
n→∞tn
n = lim
n→∞sn
n
= lim
n→∞
 exp  1
n(x + y)		n = exp(x + y).
⊓⊔
4.5
Theorems of Fuglede and Putnam
Theorem 4.18 (Fuglede’s Theorem)
Let x and y be commuting elements of B(H). Assume further that x is normal. Then
yx∗= x∗y.
Proof
For λ ∈C and let
u(λ) = exp

λx∗−λx
	
.
Then u(λ) is a unitary operator, since we can easily check that u(λ)∗= u(−λ) for all λ and
u(λ)u(μ) = u(λ + μ),
λ, μ ∈C.
Moreover u(0) = 1 and
u(λ) = exp(λx∗) exp  −λx	 = exp  −λx	 exp(λx∗)
(as x is normal), so since x commutes with y, we see that
exp(−λx∗)y exp(λx∗) = exp(−λx∗) exp

λx
	
y exp

−λx
	
exp(λx∗)
= u(−λ)yu(λ).
Therefore the holomorphic function
h : C ∋λ 	−→exp(−λx∗)y exp(λx∗) ∈B(H)
is bounded by ∥y∥. By Liouville’s theorem it is constant:
exp(−λx∗)y exp(λx∗) = h(0) = y,
λ ∈C

4
54
Chapter 4 • Spectral Theorems and Functional Calculus
which can be rewritten as
y exp(λx∗) = exp(λx∗)y,
i.e.
∞

n=0
λn
n! y(x∗)n =
∞

n=0
λn
n! (x∗)ny.
Equality of convergent power series guarantees equality of all coefﬁcients, so in particular
yx∗= x∗y.
⊓⊔
Note that if x ∈B(H) is not normal then the conclusion of Theorem 4.18 fails
already for y = x.
Corollary 4.19 Let x1, x2, y ∈B(H). Assume that x1 and x2 are normal and that yx1 =
x2y. Then yx1∗= x2∗y.
Proof
Identifying operators on H ⊕H with 2 × 2 matrices over B(H) consider operators x and y
on H ⊕H given by
x =

x1 0
0 x2
 
and
y =

0 0
y 0
 
.
Then x is normal and we have yx = xy. By Fuglede’s theorem yx∗= x∗y which means that
yx1∗= x2∗y.
⊓⊔
We say that two operators x1, x2 ∈B(H) are similar if there exists an invertible
y ∈B(H) such that yx1y−1 = x2. Corollary 4.19 allows us to prove that similar normal
operators are, in fact, unitarily equivalent.
Corollary 4.20 (Putnam’s Theorem) Let x1, x2 ∈B(H) be normal. If x1 and x2 are similar
then they are unitarily equivalent.
Proof
There exists an invertible y ∈B(H) such that yx1y−1 = x2, i.e. yx1 = x2y. By the previous
corollary we have yx1∗= x2∗y which can be rewritten as
x1y∗= y∗x2.
From this we infer that
y∗yx1 = y∗x2y = x1y∗y,

4.6 · Functional Calculus in C*-algebras
55
4
and therefore also |y| = (y∗y)
1
2 commutes with x1 (cf. Remark 2.7). Let y = u|y| be
the polar decomposition of y. Since both y and |y| are invertible, u is an invertible partial
isometry. Hence u is unitary and, moreover, we have
ux1u∗= u|y||y|−1x1|y||y|−1u−1 = yx1y−1 = x2.
⊓⊔
Putnam’s theorem can be slightly strengthened in the following way: assume
x1, x2 ∈B(H) are normal and y ∈B(H) is such that yx1 = x2y. Then, precisely
as above we show that |y|x1 = x1|y|. Thus
x2u|y| = x2y = yx1 = u|x|x1 = ux1|y|.
(4.7)
Now if ker y = {0} then also ker |y| = {0} and |y|H = (ker y)⊥= H, so it follows
from (4.7) that x2u = ux1. If we additionally assume that the range of y is dense in H
then u is unitary (Remark 3.14(1)) and so it implements unitary equivalence of x1 and
x2. In other words we have:
Corollary 4.21 Let x1, x2 ∈B(H) be normal. If there exists y ∈B(H) such that yx1 = x2y,
ker y = {0} and yH = H then x1 and x2 are unitarily equivalent.
4.6
Functional Calculus in C*-algebras
Let A be a C∗-algebra with unit. An element a ∈A is called self-adjoint if a = a∗,
while we say that a is normal if aa∗= a∗a. Continuing the analogy with B(H) we say
that u ∈A is unitary if u∗u = uu∗= 1. Notice that if u ∈A is unitary and λ ∈σ(u)
(spectrum of a C∗-algebra element was deﬁned in ▷Sect. 1.3) then |λ| = 1. Indeed:
ﬁrst of all we have λ−1 ∈σ(u−1), since if λ−11 −u−1 were invertible then so would be
λ1 −u, as
(λ1 −u) −λ−1u−1(λ−11 −u−1)−1	
=

−λ−1u−1(λ−11 −u−1)−1	
(λ1 −u) = 1.
Furthermore, since λ−1 ∈σ(u∗) = σ(u) ⊂z ∈C |z| ≤1 and λ ∈z ∈C |z| ≤1,
we ﬁnd that |λ| = 1.
For any element a ∈A and a function f holomorphic on a neighborhood of σ(a)
we put
f (a) =
1
2πi


f (λ)(λ1 −a)−1dλ,

4
56
Chapter 4 • Spectral Theorems and Functional Calculus
where  is a positively oriented curve surrounding σ(a) contained within the domain
of holomorphy of f . This way we deﬁne a unital homomorphism from the algebra of
functions holomorphic on a neighborhood of σ(a) into A which maps polynomials onto
corresponding polynomials in a. Moreover, for a and f as above we have σ

f (a)
	
=
f

σ(a)
	
. Proofs of these facts are identical to those for A = B(H).
Proposition 4.22 Let a be an element of a unital C∗-algebra A. Then
(1)
if a is normal then |σ(a)| = ∥a∥,
(2)
if a is self-adjoint then σ(a) ⊂R.
Proof
The proof of (1) is established in exactly the same way as that of Proposition 2.3(1). Now
let a be self-adjoint. Then we easily check that the element u = exp(ia) is unitary. By
holomorphic functional calculus for a we see that λ ∈σ(a) implies exp(iλ) ∈σ(u), so that
 exp(iλ)
 = 1, and hence λ ∈R.
⊓⊔
Similarly as for holomorphic functions, we can also generalize the continuous
functional calculus for operators to self-adjoint elements of C∗-algebras:
Theorem 4.23
Let a ∈A be self-adjoint. Then there exists a unique map
C

σ(a)
	
∋f 	−→f (a) ∈A
such that
▬if f is a polynomial function f (λ) = α0 + α1λ + · · · + αnλn then
f (a) = α01 + α1a + · · · + αnan,
▬
f (a)
 = ∥f ∥∞for all f ∈C

σ(a)
	
.
Moreover, this map is a ∗-isomorphism of the C∗-algebra C

σ(a)
	
onto the smallest
closed ∗-subalgebra of A containing 1 and a.
The proof of Theorem 4.23 is fully analogous to that of existence and uniqueness of
continuous functional calculus for self-adjoint operators. We also have the following:
Proposition 4.24 Let A be a unital C∗-algebra and let a ∈A be self-adjoint. Then
(1)
if b is a self-adjoint element of A commuting with a then for any functions f ∈C

σ(a)
	
and g ∈C

σ(b)
	
we have f (a)g(b) = g(b)f (a),
(2)
if c ∈A commutes with a then for any f ∈C

σ(a)
	
we have f (a)c = cf (a),
(3)
for any f ∈C

σ(a)
	
we have σ

f (a)
	
= f

σ(a)
	
,
(4)
for any real-valued g ∈Cσ(a)	 the element g(a) ∈A is self-adjoint and for any
f ∈Cgσ(a)		 we have f g(a)	 = (f ◦g)(a).

4.6 · Functional Calculus in C*-algebras
57
4
As before, proofs of the facts listed above amount to repeating the arguments used
for self-adjoint operators on a Hilbert space.
An element a ∈A is called positive if a is self-adjoint and σ(a) is contained in
[0, +∞[. Using functional calculus we can easily show that any positive element has a
unique positive square root. The notion of a positive element introduces a partial order
on A: by deﬁnition a ≤b if and only if b −a is positive.
Proposition 4.25 Let a, b ∈A be elements such that 0 ≤a ≤b. Assume that a is invertible.
Then b is invertible and b−1 ≤a−1.
Once more the proof of this proposition is identical to that given for operators
(Proposition 3.7).
Notes
Further information on multiplication operators and Borel functional calculus can be
found in the textbooks [Arv2, ReSi1, Rud2] and in [Hal, Section 7]. A more general view
of holomorphic functional calculus from ▷Sect. 4.6 is presented in the monograph [Zel]
and in [Arv1]. There, the reader will also ﬁnd various examples and problems related to
this topic.
Theorem 4.7 as well as all results of ▷Sects. 4.2 and 4.3 for self-adjoint operators
can be extended to apply to all normal operators. As we already mentioned in ▷Chap. 2,
these extensions will be presented in ▷Sect. 7.4. Furthermore, functional calculus in C∗-
algebras also extends to all normal elements, so that Theorem 4.23 and Proposition 4.24
hold for normal elements without substantial changes. However, the proofs of these
results are best accomplished with techniques different from the ones used above for
self-adjoint elements.

59
5
Compact Operators
© Springer Nature Switzerland AG 2018
P. Sołtan, A Primer on Hilbert Space Operators, Compact Textbooks in Mathematics,
https://doi.org/10.1007/978-3-319-92061-0_5
In this chapter we will discuss the most fundamental results on compact operators on
Hilbert spaces. It is important to stress that analogous theory for operators on Banach
spaces is somewhat more complicated and, in particular, requires more considerations
of topological nature. The very deﬁnition of a compact operator between Banach spaces
is signiﬁcantly different from the one we will propose in the case of operators on a
Hilbert space. In the more general framework of Banach spaces the deﬁnition of a
compact operator amounts to the conclusion of Proposition 5.1. An interested reader
will ﬁnd more information on compact operators in any functional analysis textbook,
e.g. in [Rud2, Chapter 4].
5.1
Compact Operators on a Hilbert Space
We say that an operator x ∈B(H) is ﬁnite dimensional if its range is ﬁnite a dimensional
subspace of H. A compact operator on H is an element x ∈B(H) which is a norm limit
of ﬁnite dimensional operators. The sets of ﬁnite dimensional and compact operators
will be denoted by F(H) and B0(H) respectively. It is easy to check that both F(H)
and B0(H) are ideals in B(H), i.e. they are vector subspaces and the implications

x ∈F(H), y ∈B(H)

⇒

xy,yx ∈F(H)

and

x ∈B0(H), y ∈B(H)

⇒

xy,yx ∈B0(H)

hold.

5
60
Chapter 5 • Compact Operators
Any ﬁnite dimensional operator x is of the form
xξ =
N

n=1
αn(ξ)ψn,
ξ ∈H
for some ψ1, . . . , ψN ∈H (basis of the range of x) and continuous linear functionals
α1, . . . , αN on H. It follows that αi(ξ) = ⟨ϕi ξ⟩for some ϕ1, . . . , ϕn ∈H, so that
x =
N

n=1
ψn⟩⟨ϕn .
Thus
x∗=
N

n=1
ϕn⟩⟨ψn
is also ﬁnite dimensional, and hence the ideal F(H) is closed under the involution
of B(H). Consequently the ideal B0(H) is closed under taking adjoints, since if
x =
lim
n→∞xn and xn ∈F(H) for all n then x∗=
lim
n→∞xn∗∈B0(H). The ideal
B0(H) is moreover norm-closed. In particular if x ∈B0(H) is self-adjoint and f is
a continuous function on σ(x) which can be uniformly approximated by polynomials
without constant term then f (x) ∈B0(H).
Proposition 5.1 An operator x ∈B(H) is compact if and only if for any bounded set S ⊂H
the set x(S) is pre-compact.1
Proof
Let us denote the closed unit ball of H by the symbol H1. Clearly it is enough to prove that
x is compact if and only if x(H1) is a pre-compact set.
Let x be a compact operator and ﬁx ε > 0. There exists a sequence (xn)n∈N of ﬁnite
dimensional operators such that xn −−−→
n→∞x, and so there exists a ﬁnite dimensional operator
xn such that ∥x −xn∥< ε
2. The set xn(H1) is pre-compact (it is bounded and contained in a
ﬁnite dimensional subspace), so it has a ﬁnite ε
2-net {η1, . . . , ηN}. Now for ξ ∈H1 we have
∥xξ −ηk∥≤∥xξ −xnξ∥+ ∥xnξ −ηk∥,
k ∈{1, . . . , N}.
The term ∥xξ −xnξ∥is bounded by ε
2, and since xnξ belongs to xn(H1), there exists k0 ∈
{1, . . . , N} such that ∥xnξ −ηk0∥< ε
2. Thus ∥xξ −ηk0∥< ε, and so {η1, . . . , ηN} is an ε-net
for x(H1).
1A subset of a topological space is pre-compact if its closure is compact. A subset S of a complete metric space
is pre-compact if and only if for any ε > 0 there exists a ﬁnite family of balls with radius ε covering S. The
collection of centers of such balls is called an ε-net for S.

5.1 · Compact Operators on a Hilbert Space
61
5
Now suppose that x ∈B(H) is such that for any ε > 0 there is a ﬁnite ε-net {ηε
1, . . . , ηε
N}
for x(H1). Let pε be the projection onto the ﬁnite dimensional subspace
span{ηε
1, . . . , ηε
N}
and let xε = pεx. Then xε ∈F(H) and for any ξ ∈H1 there exists k such that
∥xξ −ηε
k∥< ε.
Therefore
∥xξ −xεξ∥=
(1 −pε)xξ
 ≤
(1 −pε)(xξ −ηε
k)
 +
(1 −pε)ηε
k

=
(1 −pε)(xξ −ηε
k)
 ≤∥1 −pε∥∥xξ −ηε
k∥< ε,
as the vector ηε
k is orthogonal to the range of the projection 1 −pε.
This way we have shown that for any ε there exists a ﬁnite dimensional operator within
distance less than ε of x. It follows easily from this that x is a norm limit of ﬁnite dimensional
operators.
⊓⊔
Let x ∈B(H) be compact and suppose that λ ∈σ(x) is a non-zero eigenvalue.
Then the eigenspace K = ξ ∈H
xξ = λξ for λ must be ﬁnite dimensional.
Indeed: the image under x of the bounded set K1 = ξ ∈K
∥ξ∥≤1 is the ball
ξ ∈K
∥ξ∥≤|λ| which is not pre-compact unless dim K < +∞. This shows, in
particular, that the operator 1 on an inﬁnite dimensional Hilbert space is not compact.
More generally a projection is compact if and only if it is ﬁnite dimensional. On the
other hand the next proposition says that there are in a sense many compact operators.
Proposition 5.2 For any Hilbert space H there exists a net of ﬁnite dimensional projections
converging to 1 in strong topology.
Proof
Let {ψi}i∈I be an orthonormal basis of H and let J be the set of ﬁnite subsets of I directed
by inclusion. For j ∈J let
pj =

i∈j
ψi⟩⟨ψi .
Then for any ξ ∈H we have ξ = 
i∈I
⟨ψi ξ⟩ψi and since the coefﬁcients of ξ in the basis
{ψi}i∈I are square-summable, we have
∥pjξ −ξ∥2 =

i∈I Kj
 ⟨ψi ξ⟩
2 −−→
j∈J 0.
⊓⊔

5
62
Chapter 5 • Compact Operators
5.2
Fredholm Alternative
Theorem 5.3
Let D be a connected open subset of C and let f : D →B(H) be a holomorphic
function all of whose values are compact operators. Then either
(a)
for any z ∈D the operator 1 −f (z) is not invertible
or
(b)
the operator 1 −f (z) is invertible for z belonging to DKS, where S is a subset
of D without an accumulation point in D; in this case for any z ∈S the equation
f (z)ψ = ψ has a non-zero solution.
Proof
We note ﬁrst that it is enough to prove that either (a) or (b) holds on a neighborhood of any
given z0 ∈D.
Fix z0 ∈D and let r > 0 be such that
Dr = z ∈C |z −z0| < r
is contained in D and z ∈Dr implies that
f (z)−f(z0)
 < 1
2. Let y be a ﬁnite dimensional
operator such that
f (z0) −y
 < 1
2. Then for any z ∈Dr we have
f (z) −y
 < 1, and so
1 −f (z) + y is invertible and the function
Dr ∋z 	−→

1 −f (z) + y
	−1
is holomorphic.
The operator y can be written as
y =
N

n=1
ψn⟩⟨ϕn
(5.1)
for some vectors ϕ1, . . . , ϕN, ψ1, . . . ψN
∈
H and we can assume that the system
{ψ1, . . . , ψN} is linearly independent. For z ∈Dr let
ϕn(z) =

1 −f (z) + y
	−1	∗ϕn
and
g(z) = y

1 −f (z) + y
	−1.

5.2 · Fredholm Alternative
63
5
Using (5.1) we ﬁnd that
g(z) =
N

n=1
ψn⟩⟨ϕn
1 −f (z) + y	−1
=
N

n=1
ψn

1 −f (z) + y
	−1	∗ϕn
=
N

n=1
ψn⟩⟨ϕn(z) .
(5.2)
It follows that for any z ∈Dr we have g(z)H ⊂yH.
It is clear that

1 −g(z)
	
1 −f (z) + y
	
= 1 −f (z) + y −y = 1 −f (z),
and since the operator 1 −f (z) + y is invertible for z ∈Dr, we see that
▬1 −f (z) is invertible if and only if 1 −g(z) is invertible,
▬the equation ψ = f (z)ψ has a non-zero solution (i.e. ker

1 −f (z)
	
̸= {0}) if and only
if the equation ϕ = g(z)ϕ has a non-zero solution (ker

1 −g(z)
	
̸= {0}).
Suppose that ϕ = g(z)ϕ. Then ϕ belongs to the range of g(z) which is contained in the
range of y, so that ϕ =
N
m=1
βmψm. In view of (5.2) we get
βn =
N

m=1
⟨ϕn(z) ψm⟩βm.
(5.3)
Conversely, if β1, . . . , βN satisfy (5.3) then ϕ =
N
m=1
βmψm is a solution to the equation
ϕ = g(z)ϕ. It follows that this equation has a non-zero solution if and only if
d(z) = det
⎛
⎜⎜⎝
⎡
⎢⎢⎣
1
...
1
⎤
⎥⎥⎦−
⎡
⎢⎢⎣
⟨ϕ1(z) ψ1⟩. . . ⟨ϕ1(z) ψN⟩
...
...
...
⟨ϕN(z) ψ1⟩. . . ⟨ϕN(z) ψN⟩
⎤
⎥⎥⎦
⎞
⎟⎟⎠= 0.
The function d is holomorphic on Dr, and consequently the set Sr =

z ∈Dr
d(z) = 0

either has no accumulation points in Dr or Sr = Dr.
Let us now investigate invertibility of 1 −g(z). For this we note that the equation

1 −g(z)
	
ϕ = ξ
(5.4)

5
64
Chapter 5 • Compact Operators
has a solution for any ξ ∈H if and only if the equation ϕ −g(z)ϕ = ζ has a solution for any
ζ in the range of g(z). Indeed: substituting
ϕ = ξ + ϕ′
(5.5)
in (5.4) we obtain
ξ + ϕ′ −g(z)ξ −g(z)ϕ′ = ξ,
hence
ϕ′ −g(z)ϕ′ = g(z)ξ.
(5.6)
If ϕ′ is a solution to this equation then ϕ = ξ + ϕ′ is a solution of (5.4), and conversely, if ϕ
satisﬁes (5.4) then ϕ′ = ϕ −ξ satisﬁes (5.6). Moreover, as ξ runs over all of H, the vector
ζ = g(z)ξ runs over the range of g(z). In other words, we can solve (5.4) for any ξ if and
only if d(z) ̸= 0. Summing up, for z ∈Dr
d(z) = 0 ⇐⇒

there exists ϕ ̸= 0 such that ϕ = g(z)ϕ

and
d(z) ̸= 0 ⇐⇒

for any ξ ∈H there exists ϕ such that

1 −g(z)
	
ϕ = ξ

.
Thus 1 −g(z) is either not invertible on all of Dr (when S = Dr) or Sr is a discrete
subset of Dr and 1 −g(z) is a bijection H →H for z ∈Dr KSr. In the latter case, for
z ∈Dr KSr we have a formula for (1 −g(z)
	−1, namely
(1 −g(z)
	−1ξ =

1 + 1 −g(z)	
yH
	−1g(z)

ξ
(cf. (5.5)) which shows that

1 −g(z)
	−1 is bounded.
⊓⊔
Corollary 5.4 (Fredholm Alternative) Let x ∈B0(H). Then either 1 −x is invertible or
the equation ψ = xψ has a non-zero solution.
Proof
Put D = C and f (z) = zx. Then the statement follows from Theorem 5.3 for z = 1.
⊓⊔
Corollary 5.5 (Riesz-Schauder Theorem) Let x ∈B0(H). Then the set σ(x) does not have
accumulation points other than possibly λ = 0. Moreover any non-zero element of σ(x) is
an eigenvalue of ﬁnite multiplicity.

5.2 · Fredholm Alternative
65
5
Proof
As in the proof of Corollary 5.4 we apply Theorem 5.3 to the function f (x) = zx on C. It
follows that the set
S =

z ∈C the equation zxψ = ψ has a non-zero solution

is discrete (it is not equal to C, as 0 ̸∈S). Moreover, for z outside of S the operator 1 −zx is
invertible, i.e. the operator
λ1 −x = λ1 −λ−1x	
is invertible provided λ ̸= 0 and λ lies outside the discrete set
S−1 = z−1 z ∈S ⊂CK{0},
and any λ ∈S−1 is an eigenvalue of x. The fact that non-zero eigenvalues of a compact
operator must have ﬁnite multiplicity has already been discussed at the end of ▷Sect. 5.1. ⊓⊔
Note that since a discrete subset of C is necessarily countable, spectrum of a compact
operator is a countable set.
Corollary 5.6 (Hilbert-Schmidt Theorem) Let x ∈B(H) be a compact normal operator.
Then there exists an orthonormal basis of H consisting of eigenvectors of x.
Proof
Write the spectrum of x as
σ(x) = {0} ∪{λ1, λ2, . . . },
where for any n ∈N we have λn ̸= 0. Let {ψ0
j }j∈J be an orthonormal basis of ker x and
for n ∈N let {ψn
k }k=1,...,dim ker(λn1−x) be an orthonormal basis of the (ﬁnite dimensional)
eigenspace of x for the eigenvalue λn. The union {ϕi}i∈I of all these bases is an orthonormal
system in H. Deﬁne the subspace S = span{ϕi i ∈I}.
Both x and x∗leave S invariant, and hence they also leave S⊥invariant (cf. Proposi-
tion 2.1). Furthermore the operator x

S⊥is compact, and consequently non-zero elements
of its spectrum must be eigenvalues. But all eigenvectors of x by deﬁnition belong to S,
so σx

S⊥
	 = {0}. As x

S⊥is also normal, we have x

S⊥= 0 because its spectral radius
is equal to 0. This, however, shows that S⊥consists solely of eigenvectors of x (for the
eigenvalue 0), so S⊥⊂S. It follows that S⊥= {0} or, in other words, S = H and we ﬁnd
that {ϕi}i∈I is an orthonormal basis of H.
⊓⊔

5
66
Chapter 5 • Compact Operators
Suppose a compact operator x has inﬁnite spectrum and let {λn}n∈N be the sequence
of all non-zero eigenvalues of x. Then λn −−−→
n→∞
0. Indeed: for any r > 0 the set

n |λn| > r

is ﬁnite because for any n we have |λn| ≤∥x∥, so that

λn
|λn| ≥r

is a sequence of elements of a compact set

z ∈C r ≤|z| ≤∥x∥

which cannot be
inﬁnite, since it does not have accumulation points.
Corollary 5.7 (Canonical Form of a Compact Operator) Let x ∈B(H) be a compact
operator. Then there exists a ﬁnite or countably inﬁnite set N and orthonormal systems
{ψn}n∈N and {ϕn}n∈N in H as well as a sequence {λn}n∈N of strictly positive numbers such
that
x =

n∈N
λn ϕn⟩⟨ψn ,
with the sum convergent in norm.
Proof
Let x = v|x| be the polar decomposition of x. Then the operator |x| = (x∗x)
1
2 is compact
and positive. Therefore there exists an orthonormal basis of H consisting of eigenvectors of
|x|. Let {ψn}n∈N be the subsystem of this basis consisting of eigenvectors corresponding to
non-zero eigenvalues. Then {ψn}n∈N is an orthonormal basis of  ker |x|	⊥. We have
|x| =

n∈N
λn ψn⟩⟨ψn
and the sum is norm convergent because for a ﬁnite F ⊂N we have

n∈F
λn ψn⟩⟨ψn = fF

|x|
	
,
where fF is the continuous function on σ|x|	 = {λn}n∈N given by
fF (λ) =
⎧
⎨
⎩
λ
λ ∈F,
0
λ ̸∈F
and fF converges uniformly to the identity function on σ|x|	 as F ranges over the directed
set of ﬁnite subsets of N (cf. remarks preceding Corollary 5.7).
The partial isometry v maps the subspace  ker |x|	⊥isometrically onto xH. Therefore
putting ϕn = vψn for all n ∈N we obtain another orthonormal system {ϕn}n∈N. Clearly
x = v

n∈N
λn ψn⟩⟨ψn =

n∈N
λn ϕn⟩⟨ψn .
⊓⊔

5.2 · Fredholm Alternative
67
5
Non-zero eigenvalues of |x| appearing in the canonical form of a compact operator
x are called the singular values of the operator x. Note that the orthonormal systems in
the canonical form of x are far from being unique.
Notes
The study of compact operators between Banach spaces constituted the foundation of
functional analysis and its applications with ﬁrst examples of such operators coming
from the theory of integral and differential equations. Examples of applications of the
theory of compact operators in these areas of mathematics can be found e.g. in [Mau,
Chapter VII], [Ped, Section 3.3], [ReSi1, Chapter VI], while interesting problems and
other examples concerning compact operators are available in the problem book [Hal].

69
6
The Trace
© Springer Nature Switzerland AG 2018
P. Sołtan, A Primer on Hilbert Space Operators, Compact Textbooks in Mathematics,
https://doi.org/10.1007/978-3-319-92061-0_6
We will now discuss the concept of the trace of an operator. This notion has applications
in quantum physics as well as in many problems of pure mathematics. One of them
concerns a precise description of the dual space of B0(H) which we will give in detail.
Analysis of the trace as an “unbounded linear functional” on B(H) leads to far reaching
generalizations in the theory of operator algebras (under the guise of theory of weights).
Our presentation of this topic will be based on the same foundations which underlie
those generalizations and can be treated as an introduction to more advanced techniques
of the theory of operator algebras.
6.1
Definition of the Trace
Let H be a Hilbert space and let {ξj}j∈J be an orthonormal basis of H. For a positive
t ∈B(H) deﬁne
Tr(t) =

j∈J
ξj tξj
 ∈[0, +∞].
Proposition 6.1 For any x ∈B(H) we have Tr(x∗x) = Tr(xx∗).
Proof
For each i ∈J we have

j∈J

ξi x∗ξj
 
ξj xξi

=

j∈J

xξi ξj
 
ξj xξi

=

xξi

j∈J

ξj xξi

ξj

= ⟨xξi xξi⟩=

ξi x∗xξi

,
(6.1)

6
70
Chapter 6 • The Trace
and hence
Tr(x∗x) =

i∈J

ξi x∗xξi

=

i∈J

j∈J

ξi x∗ξj
 
ξj xξi

.
Now, since

ξi x∗ξj
 
ξj xξi

=

xξi ξj
 
ξj xξi

=
 
ξj xξi
 2 ≥0,
we can change the order of summation and using the calculation (6.1) in the fourth step (this
time applying it to the sum over i and the operator x∗), we obtain
Tr(x∗x) =

i∈J

j∈J

ξi x∗ξj
 
ξj xξi

=

j∈J

i∈J

ξi x∗ξj
 
ξj xξi

=

j∈J

i∈J

ξj xξi
 
ξi x∗ξj

=

j∈J

ξj xx∗ξj

= Tr(xx∗).
⊓⊔
Corollary 6.2 Let u, t ∈B(H) with u unitary and t positive. Then
Tr(utu∗) = Tr(t).
Proof
Put x = ut
1
2 . Then
x∗x = t
1
2 u∗ut
1
2 = t
and
xx∗= ut
1
2 t
1
2 u∗= utu∗.
By Proposition 6.1 we have Tr(utu∗) = Tr(xx∗) = Tr(x∗x) = Tr(t).
⊓⊔
Corollary 6.3 Let {ηj}j∈J be another orthonormal basis of H and deﬁne
Tr′(t) =

j∈J

ηj tηj

,
t ∈B(H)+.
Then Tr′ = Tr.
Proof
There exists a unitary u ∈B(H) such that uηj = ξj for all j ∈J. Therefore
Tr′(t) =

j∈J

u∗ξj tu∗ξj

=

j∈J

ξj (utu∗)ξj

= Tr(utu∗) = Tr(t)

6.2 · Trace Class and Hilbert-Schmidt Operators
71
6
for any t ∈B(H)+.
⊓⊔
Corollary 6.3 shows that the function
Tr : B(H)+ ∋t 	−→

i∈I
⟨ξi tξi⟩∈[0, +∞]
does not depend on the choice of the orthonormal basis {ξi}i∈I of H. We call this
function the trace.
The following properties of the trace are immediate from its deﬁnition:
▬for t ∈B(H)+ and λ ∈R+ we have Tr(λt) = λ Tr(t),
▬if t, r ∈B(H)+ and t ≥r then Tr(t) ≥Tr(r),
▬for t, r ∈B(H)+ we have Tr(t + r) = Tr(t) + Tr(r),
with the last property following from standard facts about series with positive terms.
Proposition 6.4 For t ∈B(H)+ we have Tr(t) ≥∥t∥.
Proof
Put r = t
1
2 . We have ∥t∥= ∥r∗r∥= ∥r∥2. Take ε > 0 and let ψ ∈H be such that ∥ψ∥= 1
and
∥rψ∥> ∥r∥−ε.
Then
⟨ψ tψ⟩= ∥rψ∥2 > ∥r∥2 −2ε∥r∥+ ε2,
so that
⟨ψ tψ⟩> ∥t∥−2ε∥t∥
1
2 + ε2.
Now let us choose an orthonormal basis {ξj}j∈J of H such that ψ = ξj0 for some j0 ∈J.
Then
Tr(t) ≥⟨ψ tψ⟩> ∥t∥−2ε∥t∥
1
2 + ε2.
As ε > 0 is arbitrary, we obtain Tr(t) ≥∥t∥.
⊓⊔
6.2
Trace Class and Hilbert-Schmidt Operators
Deﬁne
B1(H) = span

t ∈B(H)+
Tr(t) < +∞

,
(6.2)
B2(H) =

t ∈B(H) Tr(t∗t) < +∞

.

6
72
Chapter 6 • The Trace
Elements of the subspace B1(H) ⊂B(H) are called the trace class operators, while
B2(H) is the set of Hilbert-Schmidt operators.
Before proceeding with analysis of the classes B1(H) and B2(H) let us note that for
any a,b ∈B(H) we have
ab = 1
4
3

k=0
ik(b + ik1)∗a(b + ik1).
(6.3)
Indeed:
3

k=0
ik(b + ik1)∗a(b + ik1) = (b + 1)∗a(b + 1)
+ i(b + i1)∗a(b + i1)
−(b −1)∗a(b −1)
−i(b −i1)∗a(b −i1)
= b∗ab + b∗a + ab + a
+ ib∗ab + ab + ib∗a + ia
−b∗ab + ab −b∗a −a
−ib∗ab −ib∗a + ab −ia = 4ab.
Lemma 6.5 Let x ∈B(H) be such that Tr |x|p	 < +∞for some p > 0. Then x ∈B0(H).
Proof
Let {ψj}j∈J be an orthonormal basis of H. For any ε > 0 there exists a ﬁnite subset Jε ⊂J
such that

j̸∈Jε
ψj |x|pψj
 < ε.
Let pε be the projection onto span{ψj j ∈Jε}. Then by Proposition 6.4 we have
|x|
p
2 −|x|
p
2 pε
2 =
|x|
p
2 (1 −pε)
2
=
(1 −pε)|x|p(1 −pε)

≤Tr

(1 −pε)|x|p(1 −pε)
	
=

j̸∈Jε

ψj |x|pψj

< ε.

6.2 · Trace Class and Hilbert-Schmidt Operators
73
6
The operator |x|
p
2 pε is ﬁnite dimensional, and consequently |x|
p
2 is compact. Now since
|x| = f

|x|
p
2 	
, where f (λ) = λ
2
p for all λ ∈σ

|x|
	
, it follows that also |x| ∈B0(H) and
ﬁnally, writing x in its polar decomposition, we obtain x = u|x| ∈B0(H).
⊓⊔
Application of Lemma 6.5 to the case p = 2 immediately yields the third inclusion
of the next theorem:
Theorem 6.6
We have
F(H) ⊂B1(H) ⊂B2(H) ⊂B0(H)
(6.4)
and each of these subsets is a self-adjoint ideal in B(H). Moreover
B1(H) = x ∈B(H) Tr |x|	 < +∞.
(6.5)
Proof
We begin by noticing that all sets in (6.4) are closed under taking adjoints. In ▷Sect. 5.1 we
indicated that F(H) and B0(H) are ideals in B(H).
We will now show that B1(H) is a right ideal in B(H). Take a positive a ∈B(H) such
that Tr(a) < +∞and let b ∈B(H). From (6.3) we know that
ab = 1
4
3

k=0
ikvk∗avk,
where vk = (b + ik1). For each k we have
Tr(vk∗avk) = Tr vk∗a
1
2 a
1
2 vk
	 = Tr (a
1
2 vk)∗(a
1
2 vk)	
= Tr

(a
1
2 vk)(a
1
2 vk)∗	
= Tr(a
1
2 vkvk∗a
1
2 )
≤Tr

∥vkvk∗∥a
	
= ∥vk∥2 Tr(a) < +∞,
and hence ab ∈B1(H). Since the space B1(H) is spanned by a as above, it is a right ideal in
B(H). As a self-adjoint subset of B(H) it must also be a left ideal.1
This immediately shows that B1(H) contains the set

x ∈B(H) Tr

|x|
	
< +∞

.
1Any right ideal J in B(H) closed under taking adjoints is also a left ideal: if x ∈J and y ∈B(H) then
yx = (x∗y∗)∗∈J.

6
74
Chapter 6 • The Trace
Indeed: if x ∈B(H) and Tr

|x|
	
< +∞then clearly |x| ∈B1(H) and writing x as x = u|x|
(polar decomposition) we ﬁnd that x ∈B1(H), as B1(H) is an ideal.
Conversely, if t ∈B1(H) then also |t| = u∗t belongs to B1(H) (here, again, t = u|t| is
the polar decomposition). This means that |t| can be written in the form
|t| =
n

i=1
αidi
for some α1, . . . , αn ∈C and positive operators d1, . . . , dn with ﬁnite trace. Since, as is
easily checked,
|t| ≤
n

i=1
|αi|di,
we have Tr

|t|
	
≤
n
i=1
|αi| Tr(di) < +∞, i.e. t ∈

x ∈B(H) Tr

|x|
	
< +∞

. This way
we proved (6.5).
We will now deal with the set B2(H). It follows from the identity
(a + b)∗(a + b) + (a −b)∗(a −b) = 2(a∗a + b∗b),
a, b ∈B(H)
that (a + b)∗(a + b) ≤2(a∗a + b∗b), and thus B2(H) is a vector subspace of B(H). B2(H)
is, moreover, a left ideal, since if t ∈B2(H) then for any s ∈B(H) we have
(st)∗(st) = t∗s∗st ≤∥s∥2t∗t,
so that Tr (st)∗(st)
	
≤∥s∥2 Tr(t∗t) < +∞, i.e. st ∈B2(H). As B2(H) is a self-adjoint
subset of B(H), it is also a right ideal.
Now let x ∈F(H). Then |x| is a positive ﬁnite dimensional operator.2 Therefore |x| has
ﬁnite trace and consequently |x| ∈B1(H). The latter set is an ideal, so x = u|x| ∈B1(H)
and we have proved that
F(H) ⊂B1(H).
To ﬁnish the proof we only need to show that B1(H) ⊂B2(H). Let x ∈B1(H). We have
x∗x = |x|2 = |x|
1
2 
|x|
1
2 	∗
|x|
1
2 	
|x|
1
2 ≤∥x∥|x|
1
2 |x|
1
2 = ∥x∥|x|.
Thus Tr(x∗x) ≤∥x∥Tr

|x|
	
< +∞, i.e. B1(H) ⊂B2(H).
⊓⊔
2 Let us write x in the form x =
N
i=1
ψi⟩⟨ϕi , with {ψ1, . . . , ψN} orthonormal. Then x∗x =
N
i=1
ϕi⟩⟨ϕi
is a positive operator on span{ϕ1, . . . , ϕN}. Let {ξ1, . . . , ξM} be an orthonormal basis of span{ϕ1, . . . , ϕN}
consisting of eigenvectors of x∗x. Then x∗x =
M

j=1
λj ξj
 
ξj
and by uniqueness of square roots we have
|x| =
M

j=1
-λj ξj

ξj .

6.2 · Trace Class and Hilbert-Schmidt Operators
75
6
ⓘRemark 6.7 We have

t ∈B(H)+
Tr(t) < ∞

= B1(H) ∩B(H)+. Indeed: it follows
from the deﬁnition (6.2) that

t ∈B(H)+
Tr(t) < ∞

⊂B1(H) ∩B(H)+.
On the other hand, if a ∈B1(H) ∩B(H)+ then a = |a| and
a ∈

x ∈B(H) Tr

|x|
	
< +∞

.
Therefore

t ∈B(H)+
Tr(t) < ∞

⊃B1(H) ∩B(H)+.
Proposition 6.8 The function B1(H) ∩B(H)+ ∋x 	→Tr(x) ∈R+ extends uniquely to a
linear functional on B1(H).
Proof
Since B1(H) = span B1(H) ∩B(H)+
	, it is enough to prove that an extension of Tr to
B1(H) exists. We will show that the formula
N

i=1
αixi 	−→
N

i=1
αi Tr(xi)
provides one. To see this it is enough to check that if
N
i=1
αixi = 0 (for some α1, . . . , αN ∈C
and x1, . . . , xN ∈B(H)+ with ﬁnite trace), then
N
i=1
αi Tr(xi) = 0.
Indeed: in this case we have
N

i=1
Re αi xi = 0
and
N

i=1
Im αi xi = 0.
Let {1, . . . , N} = A ∪B with A consisting of those i for which Re αi ≥0 and B of the
remaining elements of {1, . . . , N} (so that Re αi < 0 for i ∈B). Then

i∈A
Re αi xi =

i∈B
(−Re αi)xi
are linear combinations of positive operators with positive coefﬁcients. Thus from additivity
of the trace we obtain

i∈A
Re αi Tr(xi) =

i∈B
(−Re αi) Tr(xi),
i.e.
N

i=1
Re αi Tr(xi) = 0.

6
76
Chapter 6 • The Trace
Similarly we get
N
i=1
Im αi Tr(xi) = 0.
⊓⊔
Let x ∈B1(H). The value of the linear extension of Tr from B1(H) ∩B(H)+ to
B1(H) on x will also be called the trace of x and just like for positive operators, we will
also denote it by Tr(x). We will now show that the value of Tr(x) can be calculated by
the same formula as for positive operators.
Take any x ∈B1(H) and let {ξi}i∈I be an orthonormal basis of H. Using the polar
decomposition of x write x = u|x| = u|x|
1
2 |x|
1
2 . Then
 ⟨ξi xξi⟩
 =


|x|
1
2 u∗ξi |x|
1
2 ξi
 ≤
|x|
1
2 u∗ξi
|x|
1
2 ξi
.
Now, since

i∈I
|x|
1
2 ξi
2 = Tr

|x|
	
< +∞
and

i∈I
|x|
1
2 u∗ξi
2 = Tr u|x|u∗	 < +∞
(i.e. |x|
1
2 and |x|
1
2 u∗belong to B2(H)), we obtain

i∈I
 ⟨ξi xξi⟩
 ≤

i∈I
∥|x|
1
2 u∗ξi∥∥|x|
1
2 ξi∥
≤
 
i∈I
∥|x|
1
2 u∗ξi∥2
 1
2  
i∈I
∥|x|
1
2 ξi∥2
 1
2
< +∞.
It follows that the series 
i∈I
⟨ξi xξi⟩is absolutely convergent. Furthermore, because x
can be expressed as x =
N
k=1
αkxk, where α1, . . . , αN ∈C and the operators x1, . . . , xN
are positive with ﬁnite trace, we have

i∈I
⟨ξi xξi⟩=

i∈I

ξi
N

k=1
αkxkξi

=

i∈I
N

k=1
αk ⟨ξi xkξi⟩=
N

k=1
αk

i∈I
⟨ξi xkξi⟩,
and the last expression is independent of the choice of the basis {ξi}i∈I . This way we
have established the following:

6.2 · Trace Class and Hilbert-Schmidt Operators
77
6
Proposition 6.9 Let x ∈B1(H) and let {ξi}i∈I be an orthonormal basis of H. Then the
series

i∈I
⟨ξi xξi⟩
(6.6)
is absolutely convergent and its sum is independent of the choice of the basis {ξi}i∈I.
Since (6.6) is a linear functional on B1(H) which coincides with Tr(·) on B1(H) ∩
B(H)+, we see that
Tr(x) =

i∈I
⟨ξi xξi⟩
for any x ∈B1(H) and any orthonormal basis {ξi}i∈I of H.
ⓘRemark 6.10 It is worth remembering that if x ∈B(H) and for some orthonormal
basis {ξi}i∈I of H the series (6.6) converges (absolutely) it does not necessarily mean
that x ∈B1(H). For example let H be inﬁnite dimensional, choose an orthonormal
basis {ξi}i∈I of H and take u to be the unitary operator such that uξi = ξπ(i), where π is
a permutation of the set I with ﬁnite number of ﬁxed points. Then the series 
i∈I
⟨ξi uξi⟩
is absolutely convergent, but |u| = 1 has inﬁnite trace.
Consider now x, y ∈B2(H). In a way similar to the proof of formula (6.3), we can
prove the following analog of the polarization identity:
x∗y = 1
4
3

k=0
ik(y + ikx)∗(y + ikx).
(6.7)
As B2(H) is a vector subspace of B(H), we have y + ikx ∈B2(H), and consequently
Tr (y + ikx)∗(y + ikx)	 < +∞for each k. In particular x∗y belongs to B1(H).
Theorem 6.11
The ideal B2(H) is a Hilbert space with scalar product
⟨x y⟩Tr = Tr(x∗y),
x, y ∈B2(H).
(6.8)

6
78
Chapter 6 • The Trace
Proof
We already know that for x, y ∈B2(H) we have x∗y ∈B1(H). It follows that formula (6.8)
makes sense and deﬁnes a sesquilinear form (linear in y and anti-linear in x) on B2(H). This
form is hermitian, as
Tr(y∗x) =

i∈I
ψi y∗xψi
 =

i∈I
x∗yψi ψi
 =

i∈I
⟨ψi x∗yψi⟩= Tr(x∗y)
for any orthonormal basis {ψi}i∈I of H. Moreover, it is strictly positive, since
⟨x x⟩Tr = Tr(x∗x) ≥∥x∗x∥= ∥x∥2.
(6.9)
Let ∥· ∥2 denote the norm on B2(H) associated with ⟨· ·⟩Tr. It remains to prove that

B2(H), ∥·∥2
	
is a complete space. First note that if (xn)n∈N is a Cauchy sequence in B2(H)
then the inequality (6.9) shows that (xn)n∈N is also a Cauchy sequence for the operator norm.
Let x be the limit of (xn)n∈N in B(H).
In order to estimate ∥x −xn∥2 let us ﬁx an orthonormal basis {ψi}i∈I of H. Now
xm −−−−→
m→∞x in norm and therefore also in strong topology. Therefore, for a ﬁnite subset
I0 ⊂I we have

i∈I0
(x −xn)ψi
2 = lim
m→∞

i∈I0
(xm −xn)ψi
2
≤lim sup
m→∞

i∈I
(xm −xn)ψi
2 = lim sup
m→∞
∥xm −xn∥2
2.
It follows that
∥x −xn∥2
2 =
sup
I0⊂I
|I0|<+∞

i∈I0
(x −xn)ψi
2 ≤lim sup
m→∞
∥xm −xn∥2
2.
In particular x ∈B2(H) and x is the limit of (xn)n∈N in the norm ∥· ∥2.
⊓⊔
The norm
∥x∥2 =

Tr(x∗x)
	 1
2 ,
x ∈B2(H)
introduced in the proof of Theorem 6.11 is called the Hilbert-Schmidt norm.
Proposition 6.12 Let {ψi}i∈I be an orthonormal basis of H. Then the system of operators

ψi⟩
ψj

i,j∈I
(6.10)
is an orthonormal basis of the Hilbert space B2(H).

6.2 · Trace Class and Hilbert-Schmidt Operators
79
6
Proof
We easily check that the system (6.10) is orthonormal. Furthermore, for x ∈B2(H) we have

ψi⟩
ψj
x

Tr = Tr

ψj
⟨ψi x
	
=

k∈I

ψk
ψj

⟨ψi xψk

=

k∈I

ψi⟩ψj ψk xψk

=

ψi xψj
 .
Thus, if x is orthogonal to all elements of (6.10) then x = 0.
⊓⊔
Theorem 6.13
Assume that either
(a)
x, y ∈B2(H).
or
(b)
x ∈B1(H) and y ∈B(H)
Then
Tr(xy) = Tr(yx).
Proof
To prove the theorem under assumption (a) we will use formula (6.7). We have
Tr(x∗y) = 1
4
3

k=0
ik Tr (y + ikx)∗(y + ikx)	
= 1
4
3

k=0
ik Tr

(y + ikx)(y + ikx)∗	
= 1
4
3

k=0
ik Tr

(y∗−ikx∗)∗(y∗−ikx∗)
	
= 1
4
3

k=0
ik Tr

(−ik)(iky∗+ x∗)
	∗(−ik)(iky∗+ x∗)
	
= 1
4
3

k=0
ik Tr

ik(iky∗+ x∗)∗(−ik)(iky∗+ x∗)
	

6
80
Chapter 6 • The Trace
= 1
4
3

k=0
ik Tr (iky∗+ x∗)∗(iky∗+ x∗)	
= 1
4
3

k=0
ik Tr

(x∗+ iky∗)∗(x∗+ iky∗)
	
= Tr(yx∗)
and since B2(H) is closed under involution of B(H), we obtain Tr(xy) = Tr(yx) for all
x, y ∈B2(H).
On the other hand, with assumption (b) we can write x as a linear combination of positive
operators with ﬁnite trace. If z is such an operator then by the ﬁrst part of the theorem we
have
Tr(zy) = Tr

z
1
2 (z
1
2 y)	 = Tr (z
1
2 y)z
1
2 	
= Tr

z
1
2 (yz
1
2 )
	
= Tr

(yz
1
2 )z
1
2 	
= Tr(yz),
because z
1
2 , z
1
2 y and yz
1
2 belong to B2(H).
⊓⊔
Lemma 6.14 Let x ∈B1(H) and y ∈B(H). Then
 Tr(yx)
 ≤∥y∥Tr |x|	.
Proof
Let x = u|x| be the polar decomposition of x. Since Tr |x|	 < +∞, we see that |x|
1
2 ∈
B2(H). Now the Schwarz inequality (for the scalar product ⟨· ·⟩Tr) gives
 Tr(yx)
2 =
 Tr(yu|x|
1
2 |x|
1
2 )
2
=


|x|
1
2 u∗y∗|x|
1
2

Tr

≤
|x|
1
2 u∗y∗2
2
|x|
1
2 2
2
= Tr

yu|x|
1
2 |x|
1
2 u∗y∗	
Tr

|x|
	
= Tr

|x|
1
2 u∗y∗yu|x|
1
2 	
Tr

|x|
	
≤Tr

∥yu∥2|x|
1
2 |x|
1
2 	
Tr

|x|
	
≤∥y∥2 Tr

|x|
	2.
⊓⊔

6.2 · Trace Class and Hilbert-Schmidt Operators
81
6
Theorem 6.15
The ideal B1(H) ⊂B(H) is a Banach algebra with norm
∥x∥1 = Tr

|x|
	
,
x ∈B1(H).
Proof
Obviously we have ∥αx∥1 = |α|∥x∥1 for all x ∈B1(H) and α ∈C. Moreover, since
∥x∥1 = Tr |x|	 ≥
|x|
 = ∥x∥,
we see that ∥x∥1 = 0 implies x = 0.
Take x, y ∈B1(H) and let x + y = v|x + y| be the polar decomposition of x + y. Then
∥x + y∥1 = Tr

|x + y|
	
= Tr

v∗(x + y)
	
= Tr(v∗x) + Tr(v∗y) =
 Tr(v∗x) + Tr(v∗y)

≤
 Tr(v∗x)
 +
 Tr(v∗y)
 ≤∥v∗∥Tr |x|	 + ∥v∗∥Tr |y|	
≤∥x∥1 + ∥y∥1
by Lemma 6.14. This shows that ∥· ∥1 is a norm on B1(H).
Using a similar technique we prove submultiplicativity of ∥· ∥1: take x, y ∈B1(H) and
write the polar decomposition of xy as xy = u|xy|. We have
∥xy∥1 = Tr

u∗xy) =
 Tr(u∗xy)
 ≤∥u∗x∥Tr

|y|
	
≤∥x∥Tr

|y|
	
≤∥x∥1 Tr

|y|
	
= ∥x∥1∥y∥1.
Completeness of B1(H) follows from the next theorem.
⊓⊔
Theorem 6.16
For x ∈B1(H) deﬁne
ϕx : B0(H) ∋y 	−→Tr(xy) ∈C.
Then ϕx ∈B0(H)∗and x 	→ϕx is an isometry of B1(H) with the norm ∥· ∥1 onto
B0(H)∗.

6
82
Chapter 6 • The Trace
Proof
For x ∈B1(H) and y ∈B0(H) we have
ϕx(y)
 =
 Tr(xy)
 =
 Tr(yx)
 ≤∥y∥Tr

|x|
	
= ∥y∥∥x∥1,
so that ϕx ∈B0(H)∗and ∥ϕx∥≤∥x∥1.
Take ϕ ∈B0(H)∗. Then for s ∈B2(H) ⊂B0(H) we have
ϕ(s)
 ≤∥ϕ∥∥s∥≤∥ϕ∥∥s∥2,
and hence ϕ is a continuous linear functional on the Hilbert space B2(H). Thus there exists
x ∈B2(H) such that
ϕ(s) =

x∗s

Tr ,
s ∈B2(H).
Let x = v|x| be the polar decomposition of x. Take an orthonormal basis {ψj}j∈J of H and
for a ﬁnite J0 ⊂J let p0 be the projection onto span{ψj j ∈J0}. Then, using the fact that
x, p0 ∈B2(H) and Theorem 6.13, we compute

j∈J0

ψj |x|ψj

=


j∈J0

ψj |x|ψj
  =
 Tr(p0|x|)
 =
 Tr(p0v∗x)

=
 Tr(xp0v∗)
 =
ϕ(vp0)
 ≤∥ϕ∥∥vp0∥≤∥ϕ∥.
Now taking supremum over ﬁnite subsets J0 ⊂J, we ﬁnd that x ∈B1(H) and ∥x∥1 ≤∥ϕ∥.
As B2(H) is a dense subspace of B0(H) (it contains F(H)), we see that ϕ = ϕx. In
particular x 	→ϕx is a bijective isometry.
⊓⊔
The norm
∥x∥1 = Tr

|x|
	
,
x ∈B1(H)
is called the trace norm on B1(H).
The conclusion of Theorem 6.16 is a “non-commutative analog” of the well known
equality ℓ1 = c0∗. Similarly the “commutative” equality ℓ1∗= ℓ∞has a corresponding
result on the level of operators on H:
Theorem 6.17
For y ∈B(H) let
ψy : B1(H) ∋x 	−→Tr(yx) ∈C.
Then ψy ∈B1(H)∗and y 	→ψy is an isometry of B(H) onto B1(H)∗.

6.2 · Trace Class and Hilbert-Schmidt Operators
83
6
Proof
For x ∈B1(H) and y ∈B(H) we have
 Tr(yx)
 ≤∥y∥∥x∥1, so ψy ∈B1(H)∗and ∥ψy∥≤
∥y∥.
Let us take an arbitrary ψ ∈B1(H)∗. Now deﬁne a sesquilinear form F on H putting
F(η, ξ) = ψ

ξ⟩⟨η
	
,
ξ, η ∈H.
Then F is bounded3:
F(η, ξ)
 ≤∥ψ∥
 ξ⟩⟨η

1 = ∥ψ∥∥ξ∥∥η∥,
ξ, η ∈H,
and hence there exists y ∈B(H) such that
⟨η yξ⟩= F(η, ξ),
ξ, η ∈H.
Now let x ∈B1(H) be self-adjoint. Since x is compact (and self-adjoint), we can write
x in the form of a norm-convergent series
x =
∞

n=1
μn ψn⟩⟨ψn
(6.11)
for some orthonormal system {ψn}n∈N and a sequence (μn)n∈N of real numbers. By
considering an orthonormal basis obtained by completion of the system {ψn}n∈N we easily
see that
∞

n=1
|μn| = Tr

|x|
	
< +∞. It follows from this that the series (6.11) converges also
for the trace norm. Therefore
Tr(yx) =
∞

n=1
⟨ψn yxψn⟩=
∞

n=1
μn ⟨ψn yψn⟩
=
∞

n=1
μnF(ψn, ψn) =
∞

n=1
μnψ

ψn⟩⟨ψn
	
= ψ

∞

n=1
μn ψn⟩⟨ψn

= ψ(x)
3For ξ, η ∈H, η ̸= 0 we have
 ξ⟩⟨η
2 =

ξ⟩⟨η
	∗ξ⟩⟨η = η⟩⟨ξ · ξ⟩⟨η = ∥ξ∥2 η⟩⟨η = ∥ξ∥2∥η∥2 ζ⟩⟨ζ ,
where ζ =
1
∥η∥η. Thus
 ξ⟩⟨η
 = ∥ξ∥∥η∥ζ⟩⟨ζ and
  ξ⟩⟨η
 
1 = Tr
 ξ⟩⟨η
	
= ∥ξ∥∥η∥Tr

ζ⟩⟨ζ
	
= ∥ξ∥∥η∥.

6
84
Chapter 6 • The Trace
This means that ψ(x) = ψy(x) for all self-adjoint x ∈B1(H), and consequently ψ = ψy.
This way we have shown that
B(H) ∋y 	−→ψy ∈B1(H)∗
is a contractive bijection.
To see that ∥ψy∥= ∥y∥let us take ε > 0 and ξ ∈H of norm 1 satisfying ∥yξ∥> ∥y∥−ε.
Furthermore let φ =
1
∥yξ∥yξ. Now let us complete the orthonormal system {φ} to a basis
{φj}j∈J of H. Then, putting x = ξ⟩⟨φ , we have ∥x∥1 = 1 and, moreover,
ψy(x)
 =
 Tr(yx)
 =


j∈J

φj yxφj
 
≥
 ⟨φ yxφ⟩
 =
 ⟨φ yξ⟩

=
1
∥yξ∥⟨yξ yξ⟩= ∥yξ∥> ∥y∥−ε
which means that ∥ψy∥≥∥y∥.
⊓⊔
6.3
Hilbert-Schmidt Operators on L2
Let (, μ) be a σ-ﬁnite measure space such that the space L2(, μ) is separable and
let k ∈L2( × , μ ⊗μ). By Fubini’s theorem for almost all ω1 ∈ the function
k(ω1, ·) is square-integrable and integrating with over the variable ω1 the integral of the
square of the absolute value of this function we obtain


 

k(ω1, ω2)
2 dμ(ω2)

dμ(ω1) = ∥k∥2
2.
In particular, for any ψ ∈L2(, μ) the integral


k(ω1, ω2)ψ(ω2) dμ(ω2)
makes sense for almost all ω1 and the resulting function of ω1 satisﬁes





k(ω1, ω2)ψ(ω2) dμ(ω2)

2
dμ(ω1)
≤




k(ω1, ω2)
2 dμ(ω2)∥ψ∥2
2 dμ(ω1) = ∥k∥2
2∥ψ∥2
2.

6.3 · Hilbert-Schmidt Operators on L2
85
6
From this we infer that the formula
(tkψ)(ω1) =


k(ω1, ω2)ψ(ω2) dμ(ω2),
ω1 ∈
deﬁnes an element tkψ of L2(, μ) and the resulting map
tk : L2(, μ) ∋ψ 	−→tkψ ∈L2(, μ)
is linear and bounded with
∥tk∥≤∥k∥2.
(6.12)
The operator tk is called an integral operator, while the function k is the integral
kernel of the operator tk.
Theorem 6.18
The range of the map
L2( × , μ ⊗μ) ∋k 	−→tk ∈B

L2(, μ)
	
coincides with B2

L2(, μ)
	
and the resulting operator
L2( × , μ ⊗μ) −→B2
L2(, μ)	
is unitary.
Proof
Let {ϕi}i∈I be an orthonormal basis of L2(, μ). Then the system {ϕi ⊗ϕj}i,j∈I is an
orthonormal basis of
L2(, μ) ⊗L2(, μ) ∼= L2( × , μ ⊗μ)
(see Appendix A.3). This gives us a Fourier expansion
k =

i,j∈I
αi,jϕi ⊗ϕj.
Let I be the family of ﬁnite subsets of I. For A ∈I let
kA =

i,j∈A
αi,jϕi ⊗ϕj

6
86
Chapter 6 • The Trace
and consider the operator tkA. For each ψ ∈L2(, μ) we have
(tkAψ)(ω1) =

i,j∈A
αi,j


ϕj(ω2)ψ(ω2) dμ(ω2) ϕi(ω1),
which means that
tkA =

i,j∈A
αi,j| ϕi⟩⟨ϕj |.
In particular tkA ∈F

L2(, μ)
	
⊂B2

L2(, μ)
	
. Furthermore, it follows from the estimate
(6.12) that
∥tk −tkA∥= ∥tk−kA∥≤∥k −kA∥2 −−→
A∈I 0,
so that tk is a compact operator. In addition, for any s ∈I
tkϕs = lim
A∈I tkAϕs =

i∈I
αi,sϕi.
Thus
∥tkϕs∥2
2 =

i∈I
|αi,s|2
and
Tr(tk∗tk) =

s∈I
∥tkϕs∥2
2 =

i,s∈I
|αi,s|2 = ∥k∥2
2.
The above arguments show that k 	→tk is an isometry from L2( × , μ ⊗μ) into
B2

L2(, μ)
	
. Moreover, its range contains a dense subset F

L2(, μ)
	
, and therefore this
map must be unitary.
⊓⊔
Notes
Trace class and Hilbert-Schmidt operators are very useful objects both in pure mathe-
matics and in theoretical physics, where the duality between B1(H) and B(H) provides
a description of so called mixed states of a quantum system. As for other applications,
let us point out that Theorem 6.18 can be regarded as a criterion of compactness. More
precisely, if t is a bounded operator on L2(,μ) which can be written as an integral
operator with square-integrable kernel then t belongs to the class of Hilbert-Schmidt
operators and hence is compact. Examples and exercises related to the trace, trace class
operators and Hilbert-Schmidt operators can be found in [Mau, Chapter VII], [Ped,
Section 3.4], [ReSi1, Chapter VI] and the problem book [Hal].

87
7
Functional Calculus for Families
of Operators
© Springer Nature Switzerland AG 2018
P. Sołtan, A Primer on Hilbert Space Operators, Compact Textbooks in Mathematics,
https://doi.org/10.1007/978-3-319-92061-0_7
In this chapter we will extend functional calculus to families of commuting self-adjoint
operators. As an application of this extension we will be able to introduce in ▷Sect. 7.4
functional calculus for normal operators. This will be the only part of the book in which
we will require some results of the theory of Banach algebras, or more speciﬁcally,
C∗-algebras. These have been gathered in Appendix A.5.
7.1
Holomorphic Functional Calculus
Let a1, . . . , an ∈B(H) be pairwise commuting operators. For a function f holomorphic
on a neighborhood of
nŚ
i=1
σ(ai) in Cn we deﬁne
f (a1, . . . , an)
=  1
2πi
	n 
n
· · ·

1
f (λ1, . . . , λn)(λ11 −a1)−1 · · · (λn1 −an)−1dλ1 . . . dλn,
where 1, . . . , n are positively oriented curves (in C) such that for each i the curve i
surrounds σ(ai) and the product
nŚ
i=1
i lies in the domain of holomorphy of f . Of course
the value of the integral does not depend on the choice of the curves 1, . . . , n.
Just as in the case of a single operator, we will denote by H

nŚ
i=1
σ(ai)

the algebra
of functions holomorphic on a neighborhood of
nŚ
i=1
σ(ai).

7
88
Chapter 7 • Functional Calculus for Families of Operators
Theorem 7.1
The map
H

n
ą
i=1
σ(ai)

∋f 	−→f (a1, . . . , an) ∈B(H)
(7.1)
is a unital homomorphism.
Proof
It is clear that the map (7.1) is linear. Now we check that for any k ∈{1, . . . , n} and N ∈Z+
if f (λ1, . . . , λn) = λN
k then f (a1, . . . , an) = aN
k : choose 1, . . . , n, so that for each i the
curve i lies in

z ∈C |z| > ∥ai∥.
We have
 1
2πi
	n 
n
· · ·

1
λN
k (λ11 −a1)−1 · · · (λn1 −an)−1dλ1 . . . dλn
=  1
2πi
	n 
n
· · ·

1
λN
k

∞

i=0
λ−i−1
1
ai
1

· · ·

∞

i=0
λ−i−1
n
ai
n

dλ1 . . . dλn
=
.
j̸=k

1
2πi

j
∞

i=0
λ−i−1
j
ai
j dλj

·

1
2πi

k
∞

i=0
λN−i−1
j
ai
k dλk

=
.
j̸=k
 ∞

i=0
1
2πi

j
λ−i−1
j
dλj ai
j

·
 ∞

i=0
1
2πi

k
λN−i−1
j
dλk ai
k

= aN
k .
It remains to prove multiplicativity of the map (7.1). First we notice that resolvents of
commuting operators commute. To see this note that since a1, . . . , an pairwise commute, for
any λi ∈ρ(ai) the product of resolvents (λi1 −ai)−1 in arbitrary order is the inverse of
n/
i=1
(λi1 −ai). The remaining calculation is similar to the one carried out in the proof of
Theorem 4.12: let f, g ∈H
 nŚ
i=1
σ(ai)

and let 1, . . . , n and ′
1, . . . , ′
n be positively
oriented curves surrounding the spectra of σ(a1), . . . , σ(an) such that the sets
nŚ
i=1
i and
nŚ
i=1
′
i lie in the intersection of domains of holomorphy of f and g. Furthermore we ask that
for each i the curve ′
i lie outside of i.

7.1 · Holomorphic Functional Calculus
89
7
Using the resolvent identity (1.2) we compute
f (a1, . . . , an)g(a1, . . . , an)
=
 1
2πi
	n 
n
· · ·

1
f (λ1, . . . , λn)
n
.
i=1
(λi1 −ai)−1dλ1 . . . dλn
·
 1
2πi
	n 
′n
· · ·

′
1
g(μ1, . . . , μn)
n
.
j=1
(μj1 −aj)−1dμ1 . . . dμn
=  1
2πi
	2n 
n
· · ·

1

′n
· · ·

′
1
f (λ1, . . . , λn)g(μ1, . . . , μn)
n
.
i=1

(λi1 −ai)−1(μi1 −ai)−1	
dλ1 . . . dλn dμ1 . . . dμn
=  1
2πi
	2n 
n
· · ·

1

′n
· · ·

′
1
f (λ1, . . . , λn)g(μ1, . . . , μn)
n
.
i=1

1
μi−λi

(λi1 −ai)−1 −(μi1 −ai)−1	
dλ1 . . . dλn dμ1 . . . dμn.
The quantity
n
.
i=1

1
μi−λi
(λi1 −ai)−1 −(μi1 −ai)−1	
is a linear combination of terms which are products of a number of factors (λi1 −ai)−1 and
a number of factors of the form (μj 1 −aj )−1. For example if n = 3 we have
3
.
i=1

1
μi−λi
(λi1 −ai)−1 −(μi1 −ai)−1	
=
1
μ1−λ1
1
μ2−λ2
1
μ3−λ3

(λ11 −a1)−1(λ21 −a2)−1(λ31 −a3)−1
−(μ11 −a1)−1(λ21 −a2)−1(λ31 −a3)−1
−(λ11 −a1)−1(μ21 −a2)−1(λ31 −a3)−1
−(λ11 −a1)−1(λ21 −a2)−1(μ31 −a3)−1
+ (μ11 −a1)−1(μ21 −a2)−1(λ31 −a3)−1
+ (μ11 −a1)−1(λ21 −a2)−1(μ31 −a3)−1
+ (λ11 −a1)−1(μ21 −a2)−1(μ31 −a3)−1
−(μ11 −a1)−1(μ21 −a2)−1(μ31 −a3)−1	
.

7
90
Chapter 7 • Functional Calculus for Families of Operators
The curves 1, . . . , n and ′
1, . . . , ′
n are chosen so that the integral of any term containing
at least one (μi1 −ai)−1 is equal to 0. To see this, consider e.g. the term

3

2

1

′
3

′
2

′
1
f (λ1, λ2, λ3)g(μ1, μ2, μ3)
1
μ1−λ1
1
μ2−λ2
1
μ3−λ3
(μ11 −a1)−1(λ21 −a2)−1(λ31 −a3)−1dλ1dλ2dλ3dμ1dμ2dμ3
=

3

2

′
3

′
2

′
1
 
1
f (λ1,λ2,λ3)
μ1−λ1
dλ1

1
μ2−λ2
1
μ3−λ3 g(μ1, μ2, μ3)
(μ11 −a1)−1(λ21 −a2)−1(λ31 −a3)−1dλ2dλ3dμ1dμ2dμ3.
The integral

1
f (λ1,λ2,λ3)
μ1−λ1
dλ1 equals 0 because the function
λ1 	−→f (λ1,λ2,λ3)
μ1−λ1
is holomorphic in a contractible region containing the curve 1.
It follows that we can eliminate from the expression we established for f (a1, . . . , an)
g(a1, . . . , an) all terms containing at least one (μi1 −ai)−1. This way we obtain
f (a1, . . . , an)g(a1, . . . , an)
=
 1
2πi
	2n 
n
· · ·

1

′n
· · ·

′
1
f (λ1, . . . , λn)g(μ1, . . . , μn)
n
.
i=1
1
μi−λi
n
.
j=1
(λj1 −aj)−1dλ1 . . . dλndμ1 . . . dμn
=
 1
2πi
	n 
n
· · ·

1
f (λ1, . . . , λn)
 1
2πi
	n 
′n
· · ·

′
1
g(μ1,...,μn)
n/
i=1
(μi−λi)
dμ1 . . . dμn

n
.
j=1
(λj1 −aj)−1dλ1 . . . dλn
=  1
2πi
	n 
n
· · ·

1
f (λ1, . . . , λn)g(λ1, . . . , λn)
n
.
j=1
(λj1 −aj )−1dλ1 . . . dλn
= (fg)(a1, . . . , an)
by the multidimensional version of Cauchy’s formula.
⊓⊔
The holomorphic functional calculus for ﬁnite families of commuting self-adjoint
operators we deﬁned above has several properties analogous to those of functional

7.2 · Continuous Functional Calculus
91
7
calculus for one operator. The next lemma describes a weak version of the spectral
mapping theorem:
Lemma 7.2 Let a1, . . . , an ∈B(H) be pairwise commuting operators and let P be a
polynomial in n variables. Then
σ

P(a1, . . . , an)
	
⊂P

n
ą
i=1
σ(ai)

=

P(λ1, . . . , λn) λi ∈σ(ai), i = 1, . . . , n.
Proof
Take μ ̸∈P
 nŚ
i=1
σ(ai)

. Then the function
f (z1, . . . , zn) =

μ −P(z1, . . . , zn)
	−1
is holomorphic on a neighborhood of
nŚ
i=1
σ(ai) in Cn and we have

μ1 −P(a1, . . . , an)
	
f (a1, . . . , an) = f (a1, . . . , an)

μ1 −P(a1, . . . , an)
	
= 1.
Consequently μ ̸∈σ

P(a1, . . . , an)
	
.
⊓⊔
Lemma 7.2 will be of crucial importance in the next section where we deﬁne
continuous functional calculus for families of commuting self-adjoint operators.
7.2
Continuous Functional Calculus
Theorem 7.3
Let x1, . . . , xn ∈B(H) be pairwise commuting self-adjoint operators. Then there
exists a unique unital ∗-homomorphism
C

n
ą
i=1
σ(ai)

−→B(H),
denoted by f 	→f (x1, . . . , xn), such that if prj :
nŚ
i=1
σ(ai) →σ(aj) is the projection
onto jth coordinate then
prj(x1, . . . , xn) = xj ,
j = 1, . . . , n.

7
92
Chapter 7 • Functional Calculus for Families of Operators
Proof
If a ∗-homomorphism described in the theorem exists then it must assign the value
P(x1, . . . , xn) =

i1,...,in
αi1,...,inxi1
1 · · · xin
n
(7.2)
to the polynomial
P(λ1, . . . , λn) =

i1,...,in
αi1,...,inλi1
1 · · · λinn .
Let us, therefore, take (7.2) as the deﬁnition of P(x1, . . . , xn). It is easy to see that the
right hand side of (7.2) is a normal operator, and so, by Lemma 7.2
P(x1, . . . , xn)
 =
σ

P(x1, . . . , xn)
	
≤sup

|P(λ1, . . . , λn)| λi ∈σ(xi), i = 1, . . . , n

= ∥P∥∞,
(7.3)
where ∥· ∥∞denotes the uniform norm on C
 nŚ
i=1
σ(ai)

. In particular P(x1, . . . , xn)
depends only on the values of P on the set
nŚ
i=1
σ(ai).
It is immediate that the map
P 	−→P(x1, . . . , xn)
is a ∗-homomorphism and the estimate (7.3) shows that it extends uniquely to a ∗-
homomorphism C
 nŚ
i=1
σ(ai)

→B(H) satisfying the conditions of the theorem.
⊓⊔
7.3
Joint Spectrum
Consider a family x1, . . . , xn ∈B(H) of pairwise commuting self-adjoint operators and
the compact space X =
nŚ
i=1
σ(xi). Let
J = f ∈C(X) f (x1, . . . , xn) = 0.
Clearly J is an ideal in C(X). It is shown in Appendix A.5.2 that we can associate with
J a closed subset Y ⊂X such that
J = C0(XKY)
and
C(X)/J ∼= C(Y).
The mapping C(X) ∋f 	→f (x1, . . . , xn) factorizes through C(X)/J (since J is, by
deﬁnition, its kernel), and so we obtain an isometric unital ∗-homomorphism
C(Y) −→B(H)

7.4 · Functional Calculus for Normal Operators
93
7
which we call the continuous functional calculus for the operators x1, . . . , xn. The set
Y is the joint spectrum of the operators x1, . . . , xn which we denote by the symbol
σ(x1, . . . , xn).
Clearly, a point (μ1, . . . , μn) ∈
nŚ
i=1
σ(xi) lies outside of σ(x1, . . . , xn) if and only if
there exists a function f ∈C

nŚ
i=1
σ(xi)

such that
f (μ1, . . . , μn) ̸= 0
and
f (x1, . . . , xn) = 0.
7.4
Functional Calculus for Normal Operators
Let x ∈B(H). Deﬁne Re x = 1
2(x + x∗) and Im x = 1
2i(x −x∗). Then Re x and Im x
are self-adjoint and
x = Re x + i Im x.
(7.4)
The operators Re x and Im x are usually called the real part and imaginary part of x.
Moreover, (7.4) is clearly the unique way to write x as a sum of a self-adjoint operator
and an anti-self-adjoint operator (i.e. a self-adjoint operator multiplied by i). It is easy
to check that x is normal if and only if its real and imaginary parts commute.
Proposition 7.4 Let x ∈B(H) be a normal operator. Then
σ(x) =

a + ib (a, b) ∈σ(Re x, Im x)

.
(7.5)
Proof
Take (c, d) ̸∈σ(Re x, Im x). Then the function
f : (a, b) 	−→
1
(c+id)−(a+ib)
is continuous on σ(Re x, Im x) and it easily follows that the operator
(c + id)1 −x = (c + id)1 −(Re x + i Im x)
is invertible with inverse f (Re x, Im x). This proves the containment “⊂” in (7.5).
Let λ ∈ρ(x) and put r = Re λ, s = Im λ. Suppose further that (r, s) ∈σ(Re x, Im x).
For ε > 0 let f be a continuous function on σ(Re x, Im x) such that ∥f ∥∞≤1, f (r, s) = 1
and the support of f is contained in the set
(p, g) (p −r)2 + (q −s)2 ≤ε2.

7
94
Chapter 7 • Functional Calculus for Families of Operators
We have
f (Re x, Im x) = f (Re x, Im x)

(r + is)1 −x
	
(r + is)1 −x
	−1,
and hence
f (Re x, Im x)
 ≤
f (Re x, Im x)

(r + is)1 −x
	
(r + is)1 −x
	−1.
Note that
(r + is)1 −x = (r + is)1 −(Re x + i Im x) = g(Re x, Im x),
where g(p, q) = (r + is) −(p + iq). Therefore
f (Re x, Im x)(r + is)1 −x	 =
f (Re x, Im x)g(Re x, Im x)

=
(fg)(Re x, Im x)
 ≤∥fg∥∞≤ε
(as |g| ≤ε on the support of f ) and it follows that
f (Re x, Im x)
 ≤ε

(r + is)1 −x
	−1.
(7.6)
But the right hand side (7.6) is arbitrarily small (as we vary ε), while
f (Re x, Im x)
 ≥1,
because f (r, s) = 1. This contradiction shows that if λ = r + is ̸∈σ(x) then (r, s) ̸∈
σ(Re x, Im x) and we get the containment “⊃” in (7.5).
⊓⊔
Given a normal operator x ∈B(H) and a continuous function f on σ(x) we can
deﬁne
f (x) = ˘f (Re x,Im x),
where ˘f (u, v) = f (u + iv).
Corollary 7.5 Let x ∈B(H) be a normal operator. Then there exists a unique unital
∗-homomorphism Cσ(x)	 →B(H) denoted by
Cσ(x)	 ∋f 	−→f (x) ∈B(H)
such that if f (λ) = λ for all λ ∈σ(x) then f (x) = x. Moreover f 	→f (x) is an isometric
∗-isomorphism of Cσ(x)	 onto C∗(x, 1).
Proof
By uniqueness of the decomposition of x into its real and imaginary parts, the condition
f (x) = x for the identity function f (λ) = λ is equivalent to the condition that
f1(x) = Re x
and
f2(x) = Im x,

7.4 · Functional Calculus for Normal Operators
95
7
where f1 = Re f and f2 = Im f . The continuous functional calculus for the normal operator
x provides an isometric ∗-homomorphism
C

σ(Re x, Im x)
	
∋f 	−→f (Re x, Im x) ∈B(H)
(7.7)
satisfying this condition. Moreover, since polynomials in Re x and Im x span a dense
subalgebra of C

σ(Re x, Im x)
	
= C

σ(x)
	
, the condition determines the homomorphism
uniquely. Finally note that the range of (7.7) contains all polynomials in x and x∗. These are
dense in C∗(x, 1) and the range of a ∗-homomorphism between C∗-algebras is always closed
by Theorem A.12, so it follows that the range of (7.7) is C∗(x, 1).
⊓⊔
The ∗-isomorphism described in Corollary 7.5 is called the continuous functional
calculus for the normal operator x. In the same way as for self-adjoint operators we
prove the following properties of the continuous functional calculus:
▬the spectral mapping theorem: σf (x)	 = f σ(x)	 for any normal x ∈B(H) and
f ∈Cσ(x)	,
▬for any g ∈Cσ(x)	 the operator g(x) is normal and for f ∈Cσg(x)		 we have
f

g(x)
	
= (f ◦g)(x).
Using the isomorphism Cσ(x)	 ∋f 	→f (x) ∈C∗(x,1) we can immediately
prove an analog of Theorem 4.7 for normal operators:
Theorem 7.6
Let x ∈B(H) be a normal operator. Then there exist a semiﬁnite measure space
(, μ), an essentially bounded measurable function F on  and a unitary operator
u ∈B

L2(, μ), H
	
such that
x = uMF u∗.
The proof of Theorem 7.6 is identical to the proof of the analogous Theorem 4.7.
The key element is the possibility of applying functions continuous on σ(x) to x.
Theorem 7.6 allows us to extend the Borel functional calculus to the class of normal
operators:
Theorem 7.7
Let x ∈B(H) be a normal operator and denote by B

σ(x)
	
the algebra of bounded
Borel functions on σ(x). Then there exists a unique unital ∗-homomorphism B →
B(H) denoted by
B

σ(x)
	
∋f 	−→f (x) ∈B(H)
(Continued)

7
96
Chapter 7 • Functional Calculus for Families of Operators
Theorem 7.7 (continued)
such that
▬if f (λ) = λ for all λ ∈σ(x) then f (x) = x,
▬if (fn)n∈N is a uniformly bounded sequence of Borel functions converging point-
wise to f then fn(x) −−−→
n→∞f (x) in strong topology.
Moreover the above homomorphism extends the isomorphism C

σ(x)
	
→C∗(x, 1)
given by the continuous functional calculus.
Just as in the case of Theorem 7.6, the proof of Theorem 7.7 is merely a
repetition of the steps taken to prove the analogous statement for self-adjoint operators
(Theorem 4.10).
Let x ∈B(H) be a normal operator. The extension of functional calculus for normal
operators to all bounded Borel functions on σ(x) makes it possible to deﬁne the spectral
measure Ex associated to x by the formula
Ex() = χ(x),
 ∈M,
where M is the σ-algebra of Borel subsets of σ(x). It is not hard to show (again,
repeating the proof for self-adjoint operators, cf. ▷Sect. 4.3) that for f ∈Bσ(x)	
we have
f (x) =

σ(x)
f (λ) dEx(λ)
and, in particular,
x =

σ(x)
λ dEx(λ).
(7.8)
Finally, as is the case of self-adjoint operators, the spectral measure Ex such that (7.8)
holds is unique.
Notes
Functional calculus and other versions of the spectral theorem for normal operators
are usually introduced within the framework of Banach algebras and, in particular,
Gelfand’s theory of commutative Banach algebras ([Arv2, Chapters 1 and 2], [Mau,
Chapter VIII], [Ped, Chapter 4], [Rud2, Chapters 10 and 11], [Zel]). Particularly relevant
is the theory of commutative C∗-algebras with the famous theorem of Gelfand and
Naimark which says that any commutative C∗-algebra with unit is isometrically ∗-
isomorphic to an algebra of continuous functions on a uniquely determined compact
space.

7.4 · Functional Calculus for Normal Operators
97
7
Our approach does not fully avoid Banach algebras, but we minimize their use
favoring a more direct analysis of normal operators. Further developments include
functional calculus for families of commuting normal operators which is developed by
methods introduced in this chapter.

Part II
Unbounded Operators

101
8
Operators and Their Graphs
© Springer Nature Switzerland AG 2018
P. Sołtan, A Primer on Hilbert Space Operators, Compact Textbooks in Mathematics,
https://doi.org/10.1007/978-3-319-92061-0_8
Applications of operator theory in other branches of mathematics and in mathematical
physics very often involve operators which are not bounded. This poses numerous
difﬁculties whose source is, for the most part, the lack of useful algebraic structure on
the set of unbounded operators. Our presentation of the theory of unbounded operators
on a Hilbert space will focus on a few select issues and our preferred strategy for dealing
with them will be to reduce them to questions about bounded operators. We will begin
with some introductory information gathered in ▷Sect. 8.1. In the following chapters
we will introduce our key tool which we call the z-transform and later use this tool
to extend various versions of the spectral theorem to unbounded self-adjoint operators.
The ﬁnal chapters will be devoted to several classical topics like self-adjoint extensions
of symmetric operators and elements of the theory of one-parameter groups of unitary
operators.
8.1
Basics of Unbounded Operators
Let H be a Hilbert space. The space H ⊕H has a natural Hilbert space structure with
scalar product:

ξ
η
 
ψ
φ
 
= ⟨ξ ψ⟩+ ⟨η φ⟩,
ξ, ψ,η, φ ∈H.
In this part of the book we will look at operators on H from a slightly different
perspective than we have done so far. From now on a linear operator T on H will be
deﬁned on a vector subspace D(T ) ⊂H called the domain of the operator T . In other
words T is a linear map
T : D(T ) −→H.

8
102
Chapter 8 • Operators and Their Graphs
We will not be assuming that D(T )
=
H, but except for some very general
considerations and the material of ▷Sect. 11.2, we will be assuming that D(T ) is dense
in H. In the latter case we say that T is densely deﬁned.
The graph of the operator T is the subspace
G(T ) =
0
ψ
T ψ
 
ψ ∈D(T )
1
⊂H ⊕H.
We call T closed if the subspace G(T ) is closed in H ⊕H. Note that for any x ∈B(H)
we have D(x) = H and x is closed. Moreover, the closed graph theorem (Corollary A.7)
says that if T is closed and D(T ) = H then T is bounded.
The condition that an operator T be closed replaces to a certain extent the condition
of continuity. More precisely, it is easy to see that T is closed if and only if for any
sequence (ψn)n∈N of elements of D(T ) we have

lim
n→∞ψn = ψ, lim
n→∞T ψn = φ

⇒

ψ ∈D(T ), T ψ = φ

.
It is worthwhile to characterize subspaces which are graphs of operators:
Proposition 8.1 A subspace G ⊂H ⊕H is a graph of a linear operator if and only if it
does not contain non-zero vectors of the form

0
η
 
.
(8.1)
Proof
Clearly a graph of a linear map cannot contain such vectors. On the other hand, if G does not
contain non-zero vectors of the form (8.1) then the condition

ξ
η1
 
,

ξ
η2
 
∈G
implies η1 = η2, because G is a vector subspace. Therefore G is the graph of a map T deﬁned
on
D(T ) =
0
ξ ∈H
there exists η ∈H such that

ξ
η
 
∈G
1
by T ξ = η, where η is the unique vector such that
2 ξ
η
3
∈G. It is easy to check that this map
is linear.
⊓⊔
Vectors of the form (8.1) will be called vertical.

8.1 · Basics of Unbounded Operators
103
8
Let T be an operator on H. We say that T is closable if G(T ) is a graph of an
operator, i.e. when G(T ) does not contain non-zero vertical vectors. In this case the
operator whose graph is G(T ) is called the closure of T and is denoted by T .
Now if S and T are operators on H then S is an extension of T , or S contains T , if
G(T ) ⊂G(S). This means that D(T ) ⊂D(S) and for ψ ∈D(T ) we have Sψ = T ψ.
In this case we write T ⊂S. In particular, if T is closable then T is an extension of T :
T ⊂T .
Proposition 8.2 An operator T is closable if and only if for any sequence (ψn)n∈N of
elements of D(T ) we have

lim
n→∞ψn = 0, lim
n→∞T ψn = φ

⇒

φ = 0

.
(8.2)
Proof
If T is closable then condition (8.2) follows immediately from the fact that T is closed. On
the other hand, if G(T ) contains a non-zero vertical vector
2 0
η
3
∈G then there exists a
sequence (ψn)n∈N of elements of D(T ) such that
lim
n→∞ψn = 0
and
lim
n→∞T ψn = η ̸= 0.
⊓⊔
Proposition 8.3 Let T be an operator on H. Then T is densely deﬁned if and only if G(T )⊥
does not contain any non-zero vectors of the form

ξ
0
 
.
(8.3)
Proof
Suppose a non-zero vector ξ is orthogonal to D(T ). Then clearly the vector 2 ξ
0
3 is orthogonal
to G(T ). Conversely, the condition

ξ
0
 
⊥G(T )
implies that ξ is orthogonal to D(T ), so if ξ ̸= 0 then D(T ) is not dense in H.
⊓⊔
Vectors of the form (8.3) will be called horizontal. Propositions 8.1 and 8.3 yield the
following corollary:
Corollary 8.4 A subspace G ⊂H ⊕H is the graph of a closed densely deﬁned operator if
and only if G is closed, does not contain non-zero vertical vectors and G⊥does not contain
non-zero horizontal vectors.

8
104
Chapter 8 • Operators and Their Graphs
Let T be a closed operator. The graph G(T ) of T is then a closed subspace of H⊕H,
so it is itself a Hilbert space. Moreover, the map
D(T ) ∋ψ 	−→

ψ
T ψ
 
∈G(T )
is bijective. We can therefore transfer the Hilbert space structure of G(T ) onto D(T )
deﬁning the scalar product by
⟨ψ φ⟩T =

ψ
T ψ
 
φ
T φ
 
,
ψ, φ ∈D(T ).
The resulting norm on D(T ) is then given by
∥ψ∥T =
-
∥ψ∥2 + ∥T ψ∥2,
ψ ∈D(T )
and it is called the graph norm. With this norm D(T ) is a Hilbert space.
ⓘRemark 8.5 The graph norm can be deﬁned for any linear operator—not necessarily
closed one. In fact, it is easy to see that an operator T on H is closed if and only if D(T )
is complete in the graph norm.
As an application of Remark 8.5 we can consider a generalization of the notion of
a multiplication operator introduced in ▷Sect. 4.1. Let (, μ) be a semiﬁnite measure
space and let f be a measurable function on . Deﬁne Mf to be the operator on
L2(, μ) such that
D(Mf ) = ψ ∈L2(, μ) f ψ ∈L2(, μ)
and for ψ ∈D(Mf ) we have Mf ψ = f ψ.
Proposition 8.6 Mf is a closed operator. If f is ﬁnite almost everywhere then Mf is densely
deﬁned.
Proof
The graph norm on D(Mf ) is given by
∥ψ∥Mf =
 

|ψ|2 dμ +


|f |2|ψ|2 dμ
 1
2
=
 


1 + |f |2	
|ψ|2 dμ
 1
2
,
i.e. it coincides with the norm of the Hilbert space L2

, (1 + |f |2)μ
	
. Clearly ψ ∈D(Mf )
if and only if ψ ∈L2

, (1 + |f |2)μ
	
, so D(Mf ) is a Hilbert space in its graph norm.
Now let χn be the characteristic function of

ω ∈
|f (ω)| ≤n

. If f is ﬁnite
almost everywhere then the sequence of functions (χn)n∈N converges pointwise to 1 almost

8.2 · Adjoint Operator
105
8
everywhere. Moreover the range of each operator Mχn is contained in D(Mf ) and by the
dominated convergence theorem
∥φ −Mχnφ∥2 −−−→
n→∞0,
φ ∈L2(, μ).
It follows that D(Mf ) is dense in L2(, μ).
⊓⊔
8.2
Adjoint Operator
Let T be a densely deﬁned operator on H. Let G ⊂H ⊕H be a subspace deﬁned as
follows:
 
ξ
η
 
∈G

⇐⇒

∀ψ ∈D(T ) ⟨ξ T ψ⟩= ⟨η ψ⟩

.
(8.4)
Then G is a graph of an operator on H. Indeed: if 2 0
η
3 ∈G then η is orthogonal to D(T ),
and so η = 0.
The operator whose graph is G deﬁned by (8.4) is denoted by T ∗and we call it
the adjoint of T . Note that the description of continuous linear functionals on Hilbert
spaces shows that the domain of T ∗consists precisely of those vectors ξ for which the
functional
D(T ) ∋ψ 	−→⟨ξ T ψ⟩
is bounded.
We say that an operator T is self-adjoint if T
= T ∗. This equality means, in
particular, that D(T ) = D(T ∗). When T ⊂T ∗then T is called symmetric or hermitian.
Let us examine the graph of T ∗. We have
 
ξ
η
 
∈G(T ∗)

⇐⇒

∀ψ ∈D(T )

ξ
η
 
T ψ
−ψ
 
= 0

.
In other words
 
ξ
η
 
∈G(T ∗)

⇐⇒
 
ξ
η
 
⊥

0 1
−1 0
 
G(T )

,
i.e.
G(T ∗) =

0 1
−1 0
 
G(T )
⊥
=

0 1
−1 0
 

G(T )⊥	
(8.5)

8
106
Chapter 8 • Operators and Their Graphs
(the last equality follows from the fact that 2 0
1
−1 0
3 is a unitary operator on H ⊕H).
Since the orthogonal complement of any subset is closed, it follows that T ∗is always
closed. In particular a self-adjoint operator is automatically closed.
Proposition 8.7 A densely deﬁned operator T is closable if and only if T ∗is densely
deﬁned.
Proof
The operator T is closable if and only if G(T ) does not contain non-zero vertical vectors,
which is equivalent to
2 0
1
−1 0
3
G(T ) not containing non-zero horizontal vectors. However,

0
1
−1 0
 
G(T ) = G(T ∗)⊥,
so
2 0
1
−1 0
3
G(T ) does not contain non-zero horizontal vectors if and only if G(T ∗)⊥does not
contain non-zero horizontal vectors which, by Proposition 8.3, is equivalent to the fact that
D(T ∗) is dense.
⊓⊔
In particular, if T is closable then T ∗is densely deﬁned, so there exists the operator
(T ∗)∗which we usually denote by T ∗∗. We have
G(T ∗∗) =

0 1
−1 0
 
G(T ∗)⊥	 =

0 1
−1 0
  
0 1
−1 0
 
G(T )⊥	⊥

= G(T ).
Therefore T ∗∗= T .
Formula (8.5) and elementary properties of the orthogonal complement give the
following corollary:
Corollary 8.8 Let S and T be densely deﬁned operators on H such that T ⊂S. Then S∗⊂
T ∗.
It is important to note the crucial difference between the adjoint operator for bounded
and unbounded operators. In the former case we can always write
⟨ξ xη⟩= x∗ξ η ,
while in the latter, the formula
⟨φ T ψ⟩=

T ∗φ ψ

can be used only after making sure that φ ∈D(T ∗).

8.3 · Algebraic Operations
107
8
ⓘRemark 8.9 Let us bring attention to the following fact: a self-adjoint operator does not
have proper symmetric extensions. Indeed: if T = T ∗, T ⊂S and S ⊂S∗then
S ⊂S∗⊂T ∗= T ⊂S, so that S = T .
8.3
Algebraic Operations
Algebraic operations on unbounded operators can become rather technically involved.
Let T and S be operators on H. Then the sum S + T is deﬁned on the domain
D(S + T ) = D(S) ∩D(T )
and
(S + T )ψ = Sψ + T ψ,
ψ ∈D(S + T ).
Next we deﬁne the product (composition) ST setting
D(ST ) = ψ ∈D(T ) T ψ ∈D(S)
and
(ST )ψ = S(T ψ),
ψ ∈D(ST ).
It turns out that the sum or the product of densely deﬁned operators might not be densely
deﬁned (see [Kat, Chapter 6 §1.4] or [ReSi1, Section VIII.1]). Also the sum or product
of closed operators might fail to be closed (or even closable). Nevertheless, if x ∈B(H)
and T is densely deﬁned that, of course, T + x is densely deﬁned. Similarly, when
u ∈B(H) then uT is densely deﬁned and so is T u if u is invertible.
Proposition 8.10 Let T be a closed operator on H and let x ∈B(H). Then the operator
T + x is closed.
Proof
Let (ψn)n∈N be a sequence of elements of D(T + x) = D(T ) such that
ψn −−−→
n→∞ψ
and
T ψn + xψn −−−→
n→∞φ
for some ψ, φ ∈H. Clearly we then have T ψn −−−→
n→∞φ −xψ. As T is closed, we have
ψ ∈D(T ) and T ψ = φ −xψ. But this means that ψ ∈D(T + x) and (T + x)ψ = φ. In
particular T + x is closed.
⊓⊔
Proposition 8.11 Let T be a closed operator on H and let u ∈B(H). Then
(1)
T u is closed,
(2)
if u is invertible then uT is closed.

8
108
Chapter 8 • Operators and Their Graphs
Proof
Ad (1). Take a sequence (ψn)n∈N of elements of D(T u) and assume that
ψn −−−→
n→∞ψ
and
T uψn −−−→
n→∞φ.
Let ψ′
n = uψn. Then for each n we have ψ′
n ∈D(T ), ψ′
n −−−→
n→∞uψ and
T ψ′
n −−−→
n→∞φ.
As T is closed, it follows that uψ ∈D(T ) and T (uψ) = φ. In other words ψ ∈D(T u) and
(T u)ψ = φ which shows that T u is closed.
Ad (2). If (ψn)n∈N is a sequence of elements of D(uT ) = D(T ) such that
ψn −−−→
n→∞ψ
and
uT ψn −−−→
n→∞φ,
then the sequence (T ψn)n∈N satisﬁes
T ψn = u−1uT ψn −−−→
n→∞u−1φ.
Thus, by closedness of T , we have ψ ∈D(T ) and T ψ = u−1φ. In other words ψ ∈D(uT )
and uT ψ = φ, which means that uT is closed.
⊓⊔
Corollary 8.12 Let T be a closed operator on H and let x ∈B(H) be such that xH ⊂D(T ).
Then T x is bounded.
Proof
By Proposition 8.11(1) the operator T x is closed. Moreover D(T x) = H, so by the closed
graph theorem T x is bounded.
⊓⊔
Proposition 8.13 Let S and T be densely deﬁned operators on H such that ST is densely
deﬁned.1 Then T ∗S∗⊂(ST )∗.
Proof
Take ψ ∈D(T ∗S∗). Then for any ξ ∈D(ST ) we have
⟨ψ ST ξ⟩=

S∗ψ T ξ

=

T ∗S∗ψ ξ

,
since ψ ∈D(S∗) and S∗ψ ∈D(T ∗). The right hand side of the above equality is continuous
with respect to ξ, and so ψ ∈D

(ST )∗	 and (ST )∗ψ = T ∗S∗ψ.
⊓⊔
1Note that it does not follow from density of D(ST ) that the domain of S is dense. Consider e.g. T = 0.

8.3 · Algebraic Operations
109
8
Proposition 8.14 Let T be a densely deﬁned operator on H and let x ∈B(H). Then
(xT )∗= T ∗x∗.
Proof
We already know that T ∗x∗⊂(xT )∗. Take η ∈D

(xT )∗	
. Then for any ξ ∈D(T ) = D(xT )
we have
(xT )∗η ξ

= ⟨η (xT )ξ⟩= ⟨η x(T ξ)⟩=

x∗η T ξ

,
i.e. x∗η ∈D(T ∗) and T ∗(x∗η) = (xT )∗η. In other words η ∈D(T ∗x∗) and (T ∗x∗)η =
(xT )∗η, which means that (xT )∗⊂T ∗x∗.
⊓⊔
We also have additive analogs of Propositions 8.13 and 8.14:
Proposition 8.15
(1)
Let T and S be operators such that T + S is densely deﬁned. Then T and S are densely
deﬁned and T ∗+ S∗⊂(T + S)∗.
(2)
Let T be densely deﬁned and let x ∈B(H). Then (T + x)∗= T ∗+ x∗.
Proof
Ad (1). Clearly if D(T + S) = D(T ) ∩D(S) is dense in H then so are D(T ) and D(S). Let
φ ∈D(T ∗+ S∗) = D(T ∗) ∩D(S∗). Then for any ψ ∈D(T + S) we have
⟨φ (T + S)ψ⟩= ⟨φ T ψ⟩+ ⟨φ Sψ⟩= T ∗φ ψ + S∗φ ψ
= T ∗φ + S∗φ ψ = (T ∗+ S∗)φ ψ ,
so φ ∈D

(T + S)∗	 and (T + S)∗φ = T ∗φ + S∗φ.
Ad (2). We already know that (T + x)∗⊃T ∗+ x∗. Take η ∈D(T + x)∗	. Then the
functional
D(T + x) = D(T ) ∋ψ 	−→⟨η (T + x)ψ⟩∈C
is continuous, and consequently so is the functional
D(T ) ∋ψ 	−→⟨η T ψ⟩= ⟨η (T + x)ψ⟩−⟨η xψ⟩∈C
In other words η ∈D(T ∗). Using this fact we can compute
⟨η (T + x)ψ⟩= ⟨η T ψ⟩+ ⟨η xψ⟩= T ∗η ψ + x∗η ψ
= T ∗η + x∗η ψ = (T ∗+ x∗)η ψ ,
which shows that (T + x)∗⊂T ∗+ x∗.
⊓⊔

8
110
Chapter 8 • Operators and Their Graphs
8.4
Spectrum
Let T be a closed densely deﬁned operator on H. We say that T is invertible if T is
a bijection of D(T ) onto H. By the closed graph theorem the inverse bijection T −1 :
H →D(T ) is then bounded. The spectrum of the operator T is deﬁned in the same way
as for bounded operators:
σ(T ) =

λ ∈C λ1 −T is not invertible

.
Just as in the case of bounded operators, we put ρ(T ) = CKσ(T ) and call this set the
resolvent set of T .
Proposition 8.16 Let T be a closed densely deﬁned operator on H. Then σ(T ) is a closed
subset of C.
Proof
Take λ0 ∈ρ(T ). Then for any λ ∈C such that
|λ −λ0| <
(λ01 −T )−1−1
the series
∞

n=0
(λ0 −λ)n(λ01 −T )−n−1
converges in B(H) to a sum r. We will now check that r = (λ1 −T )−1, i.e.
(1)
for ψ ∈D(λ1 −T ) = D(T ) we have r(λ1 −T )ψ = ψ,
(2)
for ξ ∈H we have rξ ∈D(T ) and (λ1 −T )rξ = ξ.
Ad (1). Let ψ ∈D(T ). Then
(λ1 −T )ψ = (λ −λ0)ψ + (λ01 −T )ψ
and consequently
r(λ1 −T )ψ = −
∞

n=0
(λ −λ0)n+1(λ01 −T )−n−1ψ
+
∞

n=0
(λ −λ0)n(λ01 −T )−nψ = ψ.
Ad (2). For any n ∈Z+ we have (λ01 −T )−n−1ξ ∈D(T ), so putting
ξN =
N

n=0
(λ0 −λ)n(λ01 −T )−n−1ξ,

8.4 · Spectrum
111
8
we obtain a sequence (ξN)N∈N of elements of D(λ1 −T ) converging to rξ. Moreover
(λ1 −T )ξN =

(λ −λ0)1 + (λ01 −T )
	
ξN
= (λ −λ0)ξN +
N

n=0
(λ0 −λ)n(λ01 −T )−nξ
= (λ −λ0)ξN + (λ0 −λ)
N

n=0
(λ0 −λ)n−1(λ01 −T )−nξ
= (λ −λ0)ξN
+ (λ0 −λ)

1
λ0−λξ +
N−1

k=0
(λ0 −λ)k(λ01 −T )−k−1ξ

= (λ −λ0)ξN + (λ0 −λ)

1
λ0−λξ + ξN−1

= ξ + (λ −λ0)(ξN −ξN−1) −−−−→
N→∞ξ.
Thus, by closedness of (λ1 −T ), we have rξ ∈D(λ1 −T ) and (λ1 −T )rξ = ξ.
This way we showed that (λ1 −T ) is invertible, so λ ∈ρ(T ). It follows that ρ(T ) is an
open subset of C, an therefore σ(T ) = CKρ(T ) is closed.
⊓⊔
It is worth mentioning that one can construct examples of closed densely deﬁned
operators T with σ(T ) = ∅, as well as operators whose spectrum is all of C (see
e.g. [ReSi1, Example 5, p. 254]). It is also not hard to see that if u is unitary, then
σ(uT u∗) = σ(T ). Finally let us add that some authors prefer a slightly different
deﬁnition of the spectrum. In this other approach the spectrum of T is considered as
a subset of the Riemann sphere C and by deﬁnition contains the point ∞whenever T is
not bounded. This version of the spectrum is sometimes called the extended spectrum.
One of the beneﬁts of considering the extended spectrum is that it is always a non-empty
and compact subset of C, regardless whether the considered operator is bounded or not.
Notes
Fundamentals of the theory of unbounded operators on a Hilbert space presented above
are developed further in monographs such as [AkGl, Kat, Mau, ReSi1, ReSi2]. Moreover,
many textbooks of general functional analysis have separate sections dealing with
unbounded operators (e.g. [Ped, Chapter 5], [Rud2, Chapter 13]). Our intention in this
chapter was to introduce the reader to the topic reserving a more in-depth analysis of
several aspects of the theory for the following chapters. Many examples and exercises
can be found in textbooks and monographs mentioned above.

113
9
z-Transform
© Springer Nature Switzerland AG 2018
P. Sołtan, A Primer on Hilbert Space Operators, Compact Textbooks in Mathematics,
https://doi.org/10.1007/978-3-319-92061-0_9
This chapter will be devoted to developing an extremely useful tool for dealing with
unbounded operators, namely the so called z-transform. It was introduced in a context
much wider than the theory of operators on Hilbert spaces by S.L. Woronowicz (see
[Lan, WoNa]). As we already mentioned a couple of times, the z-transform is a way to
encode full information about a given closed densely deﬁned operator T in a bounded
operator zT . The procedure of passing from T to zT requires several preliminary results
which will be presented in ▷Sect. 9.1. As an illustration of the use of the z-transform
we will provide a simple proof of existence of polar decomposition of closed operators
given in ▷Sect. 9.3.
9.1
The Operator T ∗T
Let T be a closed operator on H. A subspace D ⊂D(T ) is called a core for T if T is
equal to the closure of the restriction T

D of T to D.
From now on assume that T is closed and densely deﬁned. Recall that
G(T )⊥=

0 1
−1 0
 
G(T ∗) =
0
T ∗φ
−φ
 
φ ∈D(T ∗)
1
.
It follows that for any
2 ξ
η
3
∈H ⊕H there exists ψ ∈D(T ) and φ ∈D(T ∗) such that

ξ
η
 
=

ψ
T ψ
 
+

T ∗φ
−φ
 
.
(9.1)
Proposition 9.1 For any ξ ∈H there exists a unique ψ ∈D(T ∗T ) such that ξ = (1 +
T ∗T )ψ. Moreover ∥ψ∥≤∥ξ∥.

9
114
Chapter 9 • z-Transform
Proof
Put η = 0 in (9.1). Then there exist ψ ∈D(T ) and φ ∈D(T ∗) such that

ξ
0
 
=

ψ
T ψ
 
+

T ∗φ
−φ
 
which means precisely that ξ = ψ + T ∗φ and φ = T ψ. In other words ψ ∈D(T ∗T ) and
ψ + T ∗T ψ = ξ.
We have
∥ξ∥2 = ψ + T ∗T ψ ψ + T ∗T ψ
= ⟨ψ ψ⟩+ T ∗T ψ ψ + ψ T ∗T ψ + T ∗T ψ T ∗T ψ
= ∥ψ∥2 + 2∥T ψ∥2 + ∥T ∗T ψ∥2 ≥∥ψ∥2.
The above estimate shows also that the vector ψ is uniquely determined by ξ. Indeed: if
ξ = ψ + T ∗T ψ = ψ′ + T ∗T ψ′ then
0 = (ψ −ψ′) + T ∗T (ψ −ψ′)
and we obtain ∥ψ −ψ′∥≤0, so that ψ = ψ′.
⊓⊔
It follows from Proposition 9.1 that
▬D(T ∗T ) ̸= {0},
▬the map
D(T ∗T ) ∋ψ 	−→ψ + T ∗T ψ ∈H
(9.2)
is a bijection which does not decrease the norm.
In particular, the map (1 + T ∗T )−1, i.e. the inverse of (9.2) is continuous and
(1 +
T ∗T )−1 ≤1.
Theorem 9.2
Let T be a closed densely deﬁned operator. Then
(1)
the operator T ∗T is closed,
(2)
D(T ∗T ) is a core for T .

9.2 · z-Transform of a Closed Operator
115
9
Proof
We begin with Statement (2). Suppose G

T

D(T ∗T )
	
is not dense in G(T ). This means that
there exists a non-zero φ ∈D(T ) such that the vector
2 φ
T φ
3 is orthogonal to GT

D(T ∗T )
	,
i.e.

φ
T φ
 
⊥

ψ
T ψ
 
,
ψ ∈D(T ∗T )
or, in other words,
⟨φ ψ⟩+ ⟨T φ T ψ⟩= 0,
ψ ∈D(T ∗T ).
This, however, means that
φ ψ + T ∗T ψ

= 0,
ψ ∈D(T ∗T ),
so that φ ⊥H. This contradiction shows that D(T ∗T ) is a core for T .
Statement (1) is proved as follows: the operator (1 + T ∗T )−1 is bounded and conse-
quently its graph is closed. Therefore the graph of 1 +T ∗T is closed, i.e. 1 +T ∗T is closed.
Finally T ∗T = (1 + T ∗T ) + (−1) is closed by Proposition 8.10.
⊓⊔
Corollary 9.3 Let T be a closed densely deﬁned operator on H. Then D(T ∗T ) is dense in
H.
Proof
A core of an operator is dense in its domain and T is assumed to be densely deﬁned.
⊓⊔
9.2
z-Transform of a Closed Operator
Throughout this section T will be a closed densely deﬁned operator on H.
Lemma 9.4 The operator (1 + T ∗T )−1 is positive.
Proof
Take ξ ∈H and let ψ ∈D(T ∗T ) be such that ξ = ψ + T ∗T ψ. Then

ξ (1 + T ∗T )−1ξ

=

ψ + T ∗T ψ (1 + T ∗T )−1(1 + T ∗T )ψ

=

ψ + T ∗T ψ ψ

= ⟨ψ ψ⟩+

T ∗T ψ ψ

= ∥ψ∥2 + ∥T ψ∥2 ≥0.
⊓⊔

9
116
Chapter 9 • z-Transform
Lemma 9.4 allows us to consider the operator (1 + T ∗T )−1
2 , i.e. the positive square
root of the positive operator (1 + T ∗T )−1. Note that its range is dense in H, as
(1 + T ∗T )−1
2 H ⊃(1 + T ∗T )−1
2 (1 + T ∗T )−1
2 H
= (1 + T ∗T )−1H = D(T ∗T )
and the operator T ∗T is densely deﬁned.
Theorem 9.5
Let T be a closed densely deﬁned operator on H. Then
(1)
(1 + T ∗T )−1
2 H = D(T ),
(2)
T (1 + T ∗T )−1
2 ∈B(H) and
T (1 + T ∗T )−1
2  ≤1.
Proof
Take η ∈H. Then (1 + T ∗T )−1η ∈D(T ∗T ) ⊂D(T ) and
T (1 + T ∗T )−1η
2 =

T (1 + T ∗T )−1η T (1 + T ∗T )−1η

=

(1 + T ∗T )−1η T ∗T (1 + T ∗T )−1η

≤

(1 + T ∗T )−1η (1 + T ∗T )(1 + T ∗T )−1η

=

(1 + T ∗T )−1η η

=

(1 + T ∗T )−1
2 η (1 + T ∗T )−1
2 η

=
(1 + T ∗T )−1
2 η
2.
Therefore, for vectors ξ of the form (1 + T ∗T )−1
2 η we have
T (1 + T ∗T )−1
2 ξ
 ≤∥ξ∥.
(9.3)
Now let ζ ∈H. Then there exists a sequence (ξn)n∈N of elements of the subspace (1 +
T ∗T )−1
2 H converging to ζ. It follows that
(1 + T ∗T )−1
2 ξn −−−→
n→∞(1 + T ∗T )−1
2 ζ.
Moreover, thanks to the estimate (9.3), we also have
T (1 + T ∗T )−1
2 ξn −T (1 + T ∗T )−1
2 ξm

=
T (1 + T ∗T )−1
2 (ξn −ξm)
 ≤∥ξn −ξm∥,

9.2 · z-Transform of a Closed Operator
117
9
which implies that the sequence

T (1 + T ∗T )−1
2 ξn
	
n∈N converges. This way, form
closedness of T we infer that (1 + T ∗T )−1
2 ζ ∈D(T ) and consequently
(1 + T ∗T )−1
2 H ⊂D(T ).
By Corollary 8.12, this shows that T (1 + T ∗T )−1
2
∈B(H) and (9.3) gives
T (1 +
T ∗T )−1
2  ≤1. Statement (2) is proved.
To ﬁnish the proof of (1) we have to show that D(T ) ⊂(1 + T ∗T )−1
2 H. Let us take any
ξ ∈D(T ). Since D(T ∗T ) is a core for T , there exists a sequence (ψn)n∈N of elements of
D(T ∗T ) such that
ψn −−−→
n→∞ξ
and
T ψn −−−→
n→∞T ξ.
Put φn = (1 + T ∗T )ψn. Then the sequence

(1 + T ∗T )−1
2 φn
	
n∈N converges, as
(1 + T ∗T )−1
2 (φn −φm)
2
=

(1 + T ∗T )−1
2 (φn −φm) (1 + T ∗T )−1
2 (φn −φm)

=

φn −φm (1 + T ∗T )−1(φn −φm)

= (1 + T ∗T )(ψn −ψm) ψn −ψm

= ∥ψn −ψm∥2 + ∥T ψn −T ψm∥2 −−−−−→
n,m→∞0.
It follows that
ξ = lim
n→∞ψn = lim
n→∞(1 + T ∗T )−1
2 (1 + T ∗T )−1
2 φn
= (1 + T ∗T )−1
2 lim
n→∞(1 + T ∗T )−1
2 φn ∈(1 + T ∗T )−1
2 H.
⊓⊔
The bounded operator T (1 + T ∗T )−1
2 is called the z-transform of T and is denoted
by the symbol zT . Let us note once more that for any closed densely deﬁned T we have
∥zT ∥≤1. In particular zT ∗zT ≤1, so that the operator 1 −zT ∗zT is positive.
The next theorem makes precise the claim that all information about T is contained
in zT .

9
118
Chapter 9 • z-Transform
Theorem 9.6
Let T be a closed densely deﬁned operator on H. Then
G(T ) =
0
(1 −zT ∗zT )
1
2 ξ
zT ξ
 
ξ ∈H
1
.
Proof
We have
G(T ) =
0
ψ
T ψ
 
ψ ∈D(T )
1
=
0
(1 −T ∗T )−1
2 ξ
T (1 −T ∗T )−1
2 ξ
 
ξ ∈H
1
=
0
(1 −T ∗T )−1
2 ξ
zT ξ
 
ξ ∈H
1
.
(9.4)
Now, remembering that for any ξ ∈H the vector (1 + T ∗T )−1ξ belongs to D(T ∗T ), we
compute
(1 + T ∗T )−1
2 ξ
2 =

(1 + T ∗T )−1
2 ξ (1 + T ∗T )−1
2 ξ

=

ξ (1 + T ∗T )−1ξ

=

(1 + T ∗T )−1ξ ξ

=

(1 + T ∗T )−1ξ (1 + T ∗T )(1 + T ∗T )−1ξ

=
(1 + T ∗T )−1ξ
2 +

(1 + T ∗T )−1ξ T ∗T (1 + T ∗T )−1ξ

=
(1 + T ∗T )−1ξ
2 +
T (1 + T ∗T )−1ξ
2
=
(1 + T ∗T )−1
2 (1 + T ∗T )−1
2 ξ
2
+
T (1 + T ∗T )−1
2 (1 + T ∗T )−1
2 ξ
2.
Therefore, setting ψ = (1 + T ∗T )−1
2 ξ we get
∥ψ∥2 =
(1 + T ∗T )−1
2 ψ
2 + ∥zT ψ∥2.
(9.5)
Such vectors ψ form a dense subset D(T ) of H, an consequently (9.5) holds for all ψ ∈H.

9.2 · z-Transform of a Closed Operator
119
9
It follows from (9.5) and the polarization formula that
⟨φ ψ⟩=

φ (1 + T ∗T )−1ψ

+

φ zT ∗zT ψ

,
ψ, φ ∈H.
This, in turn, means that
ψ = (1 + T ∗T )−1ψ + zT ∗zT ψ,
ψ ∈H,
so that
(1 + T ∗T )−1 = 1 −zT ∗zT .
(9.6)
Therefore (1 + T ∗T )−1
2 = (1 −zT ∗zT )
1
2 which, together with (9.4), yields
G(T ) =
0
(1 −zT ∗zT )
1
2 ξ
zT ξ
 
ξ ∈H
1
.
⊓⊔
Corollary 9.7 Let S and T be closed densely deﬁned operators on H. If zS = zT then
S = T .
Let us note here that if T is a closed densely deﬁned operator then zT satisﬁes
ker(1 −zT
∗zT ) = {0}.
Indeed: ker(1 −zT ∗zT ) = (1 −zT ∗zT )H	⊥and by (9.6) we have
(1 −zT
∗zT )H = (1 + T ∗T )−1H = D(T ∗T ),
so that

(1 −zT ∗zT )H
	⊥= {0}.
Lemma 9.8 Let z ∈B(H) be such that ∥z∥≤1. Then for any f ∈C([0, 1]) we have
f (z∗z)z∗= z∗f (zz∗)
and
zf (z∗z) = f (zz∗)z.
Proof
We have σ(z∗z), σ(zz∗) ⊂[0, 1]. Let (fn)n∈N be a sequence of polynomials converging
uniformly to f on [0, 1]. Then
fn(z∗z)z∗= z∗fn(zz∗),
n ∈N

9
120
Chapter 9 • z-Transform
and
fn(z∗z)z∗−−−→
n→∞f (z∗z)z∗,
z∗fn(zz∗) −−−→
n→∞z∗f (zz∗).
It follows that f (z∗z)z∗= z∗f (zz∗). The second formula is obtained from the ﬁrst one for
f by applying the involution.
⊓⊔
Theorem 9.9
An operator z ∈B(H) is a z-transform of a closed densely deﬁned operator T if and
only if z satisﬁes
∥z∥≤1
and
ker(1 −z∗z) = {0}.
Proof
We checked above that the conditions of the theorem are necessary for z to be a z-transform
of a closed densely deﬁned operator. Assume now that z ∈B(H) satisﬁes ∥z∥≤1 and
ker(1 −z∗z) = {0}. Put
G =
0
(1 −z∗z)
1
2 ξ
zξ
 
ξ ∈H
1
.
We will check that G is a graph of a closed densely deﬁned operator (see Corollary 8.4). To
that end let us deﬁne
Uz =

(1 −z∗z)
1
2
−z∗
z
(1 −zz∗)
1
2
 
∈B(H ⊕H).
Then Uz is unitary:
U∗
z Uz =

(1 −z∗z)
1
2
z∗
−z
(1 −zz∗)
1
2
 
(1 −z∗z)
1
2
−z∗
z
(1 −zz∗)
1
2
 
=

(1 −z∗z) + z∗z
z∗(1 −zz∗)
1
2 −(1 −z∗z)
1
2 z∗
(1 −zz∗)
1
2 z −z(1 −z∗z)
1
2
zz∗+ (1 −zz∗)
 
=

1 0
0 1
 

9.2 · z-Transform of a Closed Operator
121
9
by Lemma 9.8 applied to the function f (t) =
√
1 −t. Similarly
UzU∗
z =

(1 −z∗z)
1
2
−z∗
z
(1 −zz∗)
1
2
 
(1 −z∗z)
1
2
z∗
−z
(1 −zz∗)
1
2
 
=

(1 −z∗z) + z∗z
(1 −z∗z)
1
2 z∗−z∗(1 −zz∗)
1
2
z(1 −z∗z)
1
2 −(1 −zz∗)
1
2 z
zz∗+ (1 −zz∗)
 
=

1 0
0 1
 
.
Note further that
G = Uz
0
ξ
0
 
ξ ∈H
1
,
so that G is a closed subspace of H⊕H (as the image of one under a unitary map). We check
now that G does not contain non-zero vertical vectors: suppose
2 0
φ
3 ∈G. Then there exists
ξ ∈H such that

0
φ
 
=

(1 −z∗z)
1
2 ξ
zξ
 
.
This means that (1−z∗z)
1
2 ξ = 0, but this implies (1−z∗z)ξ = 0, so ξ ∈ker(1−z∗z) = {0}.
To see that G⊥does not contain non-zero horizontal vectors we note that
G⊥=

Uz
0
ξ
0
 
ξ ∈H
1 ⊥
= Uz
 0
ξ
0
 
ξ ∈H
1⊥
= Uz
0
0
η
 
η ∈H
1
=
0
−z∗η
(1 −zz∗)
1
2 η
 
η ∈H
1
.
Suppose that 2 φ
0
3 ∈G⊥. Then there exists η ∈H such that

φ
0
 
=

−z∗η
(1 −zz∗)
1
2 η
 
.
Therefore (1 −zz∗)
1
2 η = 0, so also (1 −zz∗)η = 0. In other words
zz∗η = η.

9
122
Chapter 9 • z-Transform
Multiplying this equality from the left by z∗gives z∗η ∈ker(1 −z∗z) = {0}, so φ =
−z∗η = 0.
⊓⊔
Repeating the reasoning of the proof of Theorem 9.9 we obtain the following fact:
for a closed densely deﬁned operator T on H we have
G(T )⊥=
0
−zT ∗ξ
(1 −zT zT ∗)
1
2 ξ
 
ξ ∈H
1
.
(9.7)
Indeed:
G(T ) =
0
ψ
T ψ
 
ψ ∈D(T )
1
= UzT
H ⊕{0}
	
,
where
UzT =

(1 −zT ∗zT )
1
2
−zT ∗
zT
(1 −zT zT ∗)
1
2
 
,
and H ⊕{0} =
2 ξ
0
3
ξ ∈H

. Since UzT is unitary (the argument for that is the
calculation from the proof of Theorem 9.9), we obtain
G(T )⊥=

UzT
H ⊕{0}	⊥
= UzT

H ⊕{0}	⊥
= UzT
{0} ⊕H	,
where {0} ⊕H denotes
2 0
η
3
ξ ∈H

. This immediately gives (9.7).
Proposition 9.10 Let T be closed densely deﬁned operator on H. Then zT ∗= zT ∗.
Proof
Using formula (9.7) we get
G(T ∗) =

0
1
−1 0
 
G(T )⊥
=

0
1
−1 0
 0
−zT ∗ξ
(1 −zT zT ∗)
1
2 ξ
 
ξ ∈H
1
=
0
(1 −zT zT ∗)
1
2 ξ
zT ∗ξ
 
ξ ∈H
1
.
It follows that zT ∗is the z-transform of T ∗.
⊓⊔
We end this section with a remark on how the z-transform behaves under unitary
equivalence:

9.3 · Polar Decomposition
123
9
ⓘRemark 9.11 Let H and K be Hilbert spaces and let T be a closed densely deﬁned
operator on H. Let u ∈B(H, K) be a unitary operator and let S = u∗T u, i.e.
D(S) =

ψ ∈K uψ ∈D(T )

=

u∗η η ∈D(T )

and S(u∗η) = u∗T η for all η ∈D(T ). Then S is a closed and densely deﬁned operator
on K and zS = u∗zT u. Indeed:
G(S) =
0
ψ
Sψ
 
ψ ∈D(S)
1
=
0
u∗η
u∗T η
 
η ∈D(T )
1
=
0
u∗(1 −zT ∗zT )
1
2 ξ
u∗zT ξ
 
ξ ∈H
1
=
0
u∗(1 −zT ∗zT )
1
2 uφ
u∗zT uφ
 
φ ∈K
1
=
0
(1 −z∗z)
1
2 φ
zφ
 
φ ∈K
1
with z = u∗zT u. In view of Corollary 9.7, this shows that zS = u∗zT u.
9.3
Polar Decomposition
An operator T on H is called positive if
⟨ξ T ξ⟩≥0,
ξ ∈D(T ).
Unlike in the case of bounded operators, positivity of an unbounded operator does not
imply its self-adjointness. However, for a closed densely deﬁned operator T the operator
T ∗T is always positive and self-adjoint.1
1It is easy to see that T ∗T is positive. To see that T ∗T is self-adjoint let a = (1 + T ∗T )−1. Then a is self-
adjoint, so
2 0
1
−1 0
3
G(a)⊥= G(a). Applying the unitary operator
2 0 1
1 0
3
to both sides of this equality we obtain

0 −1
1
0
 
G(1 + T ∗T )⊥= G(1 + T ∗T ),
which shows that S = 1 + T ∗T is self-adjoint. Thus, by Proposition 8.15(2) we get (T ∗T )∗= (S −1)∗=
S −1 = T ∗T .

9
124
Chapter 9 • z-Transform
Lemma 9.12 An operator T is positive if and only if
(1 −zT ∗zT )
1
2 zT ≥0.
In particular T is positive and self-adjoint if and only if zT ≥0.
Proof
A vector ψ belongs to D(T ) if and only if ψ is of the form (1 −zT ∗zT )
1
2 ξ for some ξ ∈H.
Therefore
⟨ψ T ψ⟩=

(1 −zT ∗zT )
1
2 ξ T (1 −zT ∗zT )
1
2 ξ

=

(1 −zT ∗zT )
1
2 ξ zT ξ

=

ξ (1 −zT ∗zT )
1
2 zT ξ

which proves the ﬁrst part of the lemma. Furthermore, T = T ∗if and only if zT = zT ∗, so
T is positive and self-adjoint if and only if zT = zT ∗and

(1 −zT ∗zT )
1
4 η zT (1 −zT ∗zT )
1
4 η

=

η (1 −zT ∗zT )
1
2 zT η

≥0,
η ∈H.
(9.8)
It is easy to see that the range of (1 −zT ∗zT )
1
4 is dense in H, and hence the condition (9.8)
is equivalent to
⟨ϕ zT ϕ⟩≥0,
ϕ ∈H,
i.e. zT ≥0.
⊓⊔
Theorem 9.13
Let T be a closed densely deﬁned operator on H. Then there exists a unique pair of
operators (u, K) such that
(1)
T = uK,
(2)
K is positive and self-adjoint,
(3)
u∗u is the projection onto the closure of the range of K.
Proof
Let zT = u|zT | be the polar decomposition of the bounded operator zT . Since
|zT |
 =
∥zT ∥≤1 and
ker 1 −|zT |∗|zT |
	
= ker(1 −zT ∗zT ),

9.3 · Polar Decomposition
125
9
the operator |zT | is the z-transform of some closed densely deﬁned operator K: |zT | = zK.
As |zT | is positive, we have K = K∗and K is positive. Also D(K) = D(T ), because
D(K) = (1 −zK∗zK)
1
2 H = (1 −|zT |∗|zT |)
1
2 H = (1 −zT ∗zT )
1
2 H = D(T ).
Moreover
G(K) =
0
(1 −zK∗zK)
1
2 ξ
zKξ
 
ξ ∈H
1
=
0
(1 −zT ∗zT )
1
2 ξ
|zT |ξ
 
ξ ∈H
1
(9.9)
and obviously
G(T ) =
0
(1 −zT ∗zT )
1
2 ξ
zT ξ
 
ξ ∈H
1
.
It follows that
G(T ) =

1 0
0 u
 
G(K),
i.e. T = uK.
Finally u∗u is the projection onto the closure of the range of |zT | and formula (9.9) shows
that the latter coincides with the range of K.
Let us now address the uniqueness of the pair (u, K). Let (v, D) be another pair such
that
▬T = vD,
▬D is positive and self-adjoint,
▬v∗v is the projection onto the closure of the range of D.
Then, on one hand, using Proposition 8.14 we obtain
T ∗T = (uK)∗(uK) = Ku∗uK = K2,
and on the other hand
T ∗T = (vD)∗(vD) = Dv∗vD = D2.
It follows that
zT = T (1 + T ∗T )−1
2 = T (1 + K2)−1
2 = T (1 + D2)−1
2

9
126
Chapter 9 • z-Transform
and consequently
uK(1 + K2)−1
2 = vD(1 + D2)−1
2
or, in other words,
uzK = vzD.
Applying the operation x 	→x∗x to both sides of this equality yields
zKu∗uzK = zDv∗vzD.
Since the range of the z-transform coincides with the range of the operator, we have u∗uzK =
zK and v∗vzD = zD and therefore
zK2 = zD2.
The operators zK and zD are positive, so by uniqueness of positive square roots we get
zK = zD and thus K = D.
The equality u = v follows now from uK = vK and the fact that u∗u = v∗v is the
projection onto the closure of the range of K in the same way as for bounded operators.
⊓⊔
The decomposition T
= uK of a closed densely deﬁned operator T obtained
in Theorem 9.13 is called the polar decomposition of T . The partial isometry u is
sometimes referred to as the phase of T , while the positive self-adjoint operator K is
called the modulus of absolute value of T and is denoted by the symbol |T |.
Notes
The concept of the z-transform was introduced for the ﬁrst time in a framework far more
general than the theory of operators on Hilbert spaces. Given any C∗-algebra A consider
a vector space E endowed with a right action of A and a “scalar product” with values
in A. The latter is a sesquilinear map ⟨· ·⟩: E × E →A possessing several properties
which guarantee that ⟨· ·⟩deﬁnes a norm on E in a way analogous to how it is deﬁned
on spaces with a genuine scalar product:
∥ξ∥E =
-
∥⟨ξ ξ⟩∥,
ξ ∈E
(for details see [Lan, Chapter 1]). If E is complete in this norm then it is called a
Hilbert C∗-module over A. In particular, Hilbert C∗-modules over A = C are nothing
else than Hilbert spaces. It turns out that many problems of pure mathematics require
the additional generality of Hilbert C∗-modules over non-trivial C∗-algebras instead of
Hilbert spaces.
A surprising feature of Hilbert C∗-modules is that not all linear operators on such
a module necessarily have an adjoint, even bounded ones. The situation becomes even

9.3 · Polar Decomposition
127
9
more complicated when we analyze unbounded operators. The notion of z-transform
turned out to be crucial for the development of the theory of operators on Hilbert C∗-
modules. This theory is described very thoroughly in the book [Lan]. Many interesting
analogies and differences between studying operators on Hilbert spaces and on Hilbert
C∗-modules are highlighted in the paper [WoNa].

129
10
Spectral Theorems
© Springer Nature Switzerland AG 2018
P. Sołtan, A Primer on Hilbert Space Operators, Compact Textbooks in Mathematics,
https://doi.org/10.1007/978-3-319-92061-0_10
Just as in the case of bounded operators, spectral theorem for unbounded operators
assumes various forms. We will begin with continuous functional calculus which can
be deﬁned exclusively using the z-transform. Next we will move on to Borel functional
calculus and ﬁnally assign to each self-adjoint operator its spectral measure and discuss
functional calculus for unbounded functions.
10.1 Continuous Functional Calculus
Let T be a self-adjoint operator on H. We will begin by deﬁning functional calculus for
bounded continuous functions. The space Cb(R) of bounded continuous functions on
R is a C∗-algebra with natural operations of addition and multiplications, the uniform
norm ∥· ∥∞and complex conjugation of functions as involution. Functional calculus
should be a unital ∗-homomorphism Cb(R) →B(H). Moreover, putting
ζ(t) =
t
√
1+t2 ,
t ∈R
we deﬁne a continuous and bounded function on R (in fact ζ is a homeomorphism
R →]−1, 1[) and we would like to have ζ(T ) = zT .
Since zT is a self-adjoint (bounded) operator, we can consider the map
Cb(R) ∋f 	−→(f ◦ζ −1)(zT )
which formally would satisfy our requirements. However, the function f ◦ζ −1 belongs
to Cb(]−1, 1[) while σ(zT ) ⊂[−1, 1]1 and hence the construction of continuous
functional calculus for T will have to be more involved.
1Moreover, one can show that if σ(zT ) ⊂]−1, 1[ then T is bounded.

10
130
Chapter 10 • Spectral Theorems
Theorem 10.1
Let T be a self-adjoint operator. Then there exists a unique unital ∗-homomorphism
Cb(R) →B(H) denoted by
Cb(R) ∋f 	−→f (T ) ∈B(H)
such that ζ(T ) = zT .
Proof
For any f ∈Cb(R) the function
]−1, 1[ ∋t 	−→f

ζ −1(t)
	
(1 −t2)
1
2
extends to a continuous function on [−1, 1]. Let us denote this extension by 
f . Now take
ξ ∈D(T ). Then there exists a unique η ∈H such that ξ = (1+T ∗T )−1
2 η = (1−zT ∗zT )
1
2 η
(see Eq. (9.6)). Consider the map
D(T ) ∋ξ 	−→
f (zT )η ∈H.
(10.1)
We will show that it is bounded. Indeed: the function 
f satisﬁes
 
f 
f
	
(t) =
 
f (t)
2 ≤∥f ∥2
∞(1 −t2),
t ∈[−1, 1].
Thus, using properties of continuous functional calculus for bounded self-adjoint operators,
we obtain

f (zT )∗
f (zT ) ≤∥f ∥2
∞(1 −zT ∗zT ).
Therefore
 
f (zT )η
2 =
 
f (zT )η 
f (zT )η

=

η 
f (zT )∗
f (zT )η

≤∥f ∥2
∞

η (1 −zT ∗zT )η

= ∥f ∥2
∞

(1 −zT ∗zT )
1
2 η (1 −zT ∗zT )
1
2 η

= ∥f ∥2
∞∥ξ∥2.
It follows that the map (10.1) extends to a bounded operator H →H with norm not larger
than ∥f ∥∞. Let us denote it by the symbol f (T ). Clearly the map f 	→f (T ) is linear and if
f is constant and equal to 1, then f (T ) = 1. We will now show that f (T )g(T ) = (fg)(T ).
To that end note that for any h ∈Cb(R) we have (by deﬁnition)
h(T )(1 −zT ∗zT )
1
2 φ = h(zT )φ,
φ ∈H,
(10.2)

10.1 · Continuous Functional Calculus
131
10
so that for any ξ ∈D(T ∗T ) = (1 −zT ∗zT )H
f (T )g(T )ξ = f (T )g(zT )(1 −zT ∗zT )φ
= f (T )g(T )(1 −zT ∗zT )
1
2 (1 −zT ∗zT )
1
2 φ
= f (T )g(zT )(1 −zT ∗zT )
1
2 φ
= f (T )(1 −zT ∗zT )
1
2g(zT )φ = 
f (zT )g(zT )φ,
where φ is the vector satisfying ξ = (1 −zT ∗zT )φ. Furthermore, for any t ∈]−1, 1[

f (t)g(t) = f

ζ −1(t)
	
(1 −t2)
1
2 g

ζ −1(t)
	
(1 −t2)
1
2
= (fg)ζ −1(t)	(1 −t2)
1
2 (1 −t2)
1
2 = (4
fg)(t)(1 −t2)
1
2 ,
and so
f (T )g(T )ξ = ( 
fg )(zT )(1 −zT ∗zT )
1
2 φ
= (fg)(T )(1 −zT ∗zT )
1
2 (1 −zT ∗zT )
1
2 φ
= (fg)(T )(1 −zT ∗zT )φ = (fg)(T )ξ.
This proves that f (T )g(T ) = (fg)(T ), because D(T ∗T ) is dense in H. Finally the equality
f (T ) = f (T )∗follows directly from the deﬁnition of the operator f (T ).
We have shown that f 	→f (T ) is a unital ∗-homomorphism from Cb(R) to B(H). Of
course, for f = ζ we have 
f (t) = t(1 −t2)
1
2 , so that for ξ = (1 −zT ∗zT )
1
2 η ∈D(T ) we
get
f (T )ξ = 
f (zT )η = zT (1 −zT ∗zT )
1
2 φ = zT ξ
which means that f (T ) = zT .
Let us now address the uniqueness of a homomorphism satisfying the condition of the
theorem. Let  : Cb(R) →B(H) be a unital ∗-homomorphism such that (ζ) = zT . Then
the values of  are uniquely determined on polynomials in ζ. Moreover, we know from
Proposition 4.9 (▷Sect. 4.2) that any unital ∗-homomorphism from a Banach ∗-algebra to
B(H) is continuous, so that the values of  are also uniquely determined on all functions of
the form ϕ ◦ζ with ϕ ∈C([−1, 1]). In other words, the condition that (ζ) = zT uniquely
determines values of  on all functions from Cb(R) possessing limits at ±∞.
We will see that this already determines the homomorphism  uniquely on all of Cb(R).
For f ∈Cb(R) deﬁne
fn(t) =
⎧
⎪⎪⎨
⎪⎪⎩
f (−n),
t < −n,
f (t),
−n ≤t ≤n,
f (n),
t > n,
t ∈R.

10
132
Chapter 10 • Spectral Theorems
We will prove that
(fn)ξ −−−→
n→∞(f )ξ,
ξ ∈D(T )
(10.3)
which guarantees that the operator (f ) is uniquely determined on a dense subset of H by
values of  on functions which have limits at ±∞. This, in turn, gives us uniqueness of
continuous functional calculus2
Let g(t) =

1 −ζ(t)2	 1
2 . Since values of  on polynomials in zT are uniquely
determined, we obtain
(g2) = 1 −zT ∗zT
and thus, by uniqueness of positive square roots, we get
(g) = (1 −zT ∗zT )
1
2 .
Now for ξ ∈D(T ) there exists a unique η ∈H such that ξ = (1 −zT ∗zT )
1
2 η, i.e.
ξ = (g)η
and it follows that
(fn)ξ = (fn)(g)η = (fng)η.
Finally we have fng −−−→
n→∞fg uniformly on R, because
(fng)(t) −(fg)(t)
 ≤2∥f ∥∞sup
|t|>n
g(t) −−−→
n→∞0,
and consequently (fng) −−−→
n→∞(fg) in B(H). Therefore
(fn)ξ = (fng)η −−−→
n→∞(fg)η = (f )ξ
and (10.3) is proved.
⊓⊔
2Clearly, since
(fn)
 < C for some constant C, we also have
(fn)ξ −−−→
n→∞(f )ξ,
ξ ∈H.
Indeed: ﬁx ξ ∈H and for ε > 0 choose ξ ′ ∈D(T ) such that ∥ξ −ξ ′∥<
ε
3C . Then
(fn)ξ −(f )ξ
 ≤
(fn)ξ −(fn)ξ ′ +
(fn)ξ ′ −(f )ξ ′ +
(f )ξ ′ −(f )ξ

≤C∥ξ −ξ ′∥+
(fn)ξ ′ −(f )ξ ′ + C∥ξ −ξ ′∥<
2ε
3M +
(fn)ξ ′ −(f )ξ ′.
Therefore, for n large enough, so that
(fn)ξ ′ −(f )ξ ′ <
ε
3C , the above estimate gives
(fn)ξ −
(f )ξ
 < ε.

10.1 · Continuous Functional Calculus
133
10
Lemma 10.2 Let f ∈Cb(R) be real-valued and such that f (t) ̸= 0 for all t ∈R. Then
ker f (T ) = {0}.
Proof
Denote
a = f (T ),
b = 
f (zT ),
c = (1 −zT ∗zT )
1
2 .
Let us ﬁrst see that ker b = {0}. For this we can assume that zT is an operator of multiplication
by a function on a Hilbert space L2(, μ), i.e. zT = Mg. Furthermore, since ker(1−zT 2) =
ker(1 −zT ∗zT ) = {0}, we have μω g(ω) = ±1	 = 0 (Proposition 4.4). The operator
b = 
f (zT ) is then the operator of multiplication by 
f ◦g. As 
f (t) ̸= 0 for t ∈]−1, 1[, we
get
μ

ω ( 
f ◦g)(ω) = 0
	
= 0
and it follows that ker b = {0} (again by Proposition 4.4).
By deﬁnition of functional calculus for T we have
acη = bη,
η ∈H,
i.e. ac = b. The operators a, b and c are self-adjoint, so
ca = (ac)∗= b∗= b = ac.
Thus b = ac = ca and consequently ker a ⊂ker b = {0}.
⊓⊔
Lemma 10.2 makes it simple to extend functional calculus of bounded continuous
functions to all continuous functions on R. For simplicity we will restrict attention to
real-valued functions. This will also make it easier to make a connection with Borel
functional calculus which will be presented in the next section.
Theorem 10.3
Let T be a self-adjoint operator. Then for any real-valued f ∈C(R) there exists a
unique closed densely deﬁned operator f (T ) such that zf (T ) = (ζ ◦f )(T ). Moreover
f (T ) is self-adjoint.
Proof
Let z = (ζ ◦f )(T ). We have ∥z∥≤∥ζ∥∞= 1 and ker(1 −z∗z) = {0} by Lemma 10.2, as
1 −z∗z = g(T ),

10
134
Chapter 10 • Spectral Theorems
where g(t) = 1 −ζ

f (t)
	2 > 0 for all t ∈R. It follows that z is a z-transform of a unique
closed densely deﬁned operator which we call f (T ). This operator is self-adjoint, because
z = z∗.
⊓⊔
10.2 Borel Functional Calculus
Let T be a self-adjoint operator on H. In view of Theorem 9.10, the z-transform zT of T
is a self-adjoint operator with spectrum contained in [−1, 1]. In particular zT is unitarily
equivalent to a multiplication operator (Theorem 4.7). This allows us to conclude the
following:
Theorem 10.4
Let T be a self-adjoint operator on H. Then there exist a semiﬁnite measure space
(, μ), a measurable real-valued function f on  and a unitary operator u ∈
B

L2(, μ), H
	
such that T = uMf u∗, i.e.
(1)
D(T ) =

uψ ψ ∈L2(, μ), f ψ ∈L2(, μ)

,
(2)
for uψ ∈D(T ) we have T uψ = uf ψ.
Moreover σ(T ) = Vess(f ).
Proof
Since zT is a self-adjoint operator, by Theorem 4.7 there exits a semiﬁnite measure
space (, μ), a measurable real-valued function F on  and a unitary operator u ∈
B

L2(, μ), H
	
such that zT
= uMF u∗. Consider the operator S = u∗T u. Then by
Remark 9.11 we have zS = u∗zT u = MF . It follows that
D(S) = (1 −zS∗zS)
1
2 φ φ ∈L2(, μ)

= (1 −MF 2)
1
2 φ φ ∈L2(, μ)
= M√
1−F 2φ φ ∈L2(, μ).
Note that since ker(1 −zS∗zS) = {0}, by Proposition 4.4 we have
√
1 −F 2 ̸= 0 almost
everywhere on . It follows that the function f =
F
√
1−F 2 is ﬁnite almost everywhere.
Moreover, for ψ =
√
1 −F 2φ ∈D(S) we have Sψ = Fφ = f ψ, so
S ⊂Mf .
Both S and Mf are self-adjoint, so by Remark 8.9 they are equal. It follows that T = uMf u∗.
Let us analyze the spectrum of T . We know that σ(T ) = σ(u∗T u) = σ(Mf ), so the
theorem will be proved when we show that σ(Mf ) = Vess(f ). Let λ ∈CKVess(f ). Then

10.2 · Borel Functional Calculus
135
10
there exits r > 0 such that

ω |λ −f (ω)| < r

is of measure zero. Therefore the function g =
1
λ−f belongs to L∞(, μ) and satisﬁes
∥g∥∞≤1
r . In particular the operator Mg is bounded. Furthermore
▬for ϕ ∈D(Mf ) we have (λ1 −Mf )ϕ = (λ −f )ϕ and this immediately shows that
Mg(λ1 −Mf )ϕ = ϕ,
▬for ψ ∈L2(, μ) we have Mgψ ∈D(Mf ), because
|fg| =

f
λ−f
 =
 f −λ+λ
λ−f
 =
λ
1
λ−f −1
 ≤|λ||g| + 1,
and so |fgψ| ≤|λ||g| + 1	|ψ|, i.e. fgψ ∈L2(, μ).
It follows that Mg = (λ1 −Mf )−1.
Conversely, if λ ∈Vess(f ) then for any n ∈N the set

ω |λ −f (ω)| ≤1
n

is of strictly positive measure and consequently it contains a subset n of strictly positive
and ﬁnite measure. Putting ψn =
1
√μ(n)χn we obtain a sequence of norm 1 vectors such
that ψn ∈D(Mf ) for all n, as |f | ≤|λ| + 1
n on n, and thus


|f ψn|2 dμ =
1
μ(n)

n
|f |2 dμ ≤

|λ| + 1
n
	2 < +∞.
It is easy to see that
(λ1−Mf )ψn

2 ≤1
n and hence there does not exist a bounded operator
a such that a(λ1 −Mf ) = 1, i.e. λ ∈σ(Mf ).
⊓⊔
As Theorem 10.4 says, any self-adjoint operator T is unitarily equivalent to an
operator of multiplication by a real-valued measurable function. In particular σ(T ) is
a non-empty subset of R.
As in the case of bounded operators, Theorem 10.4 allows us to extend functional
calculus for a self-adjoint operator from bounded continuous functions to bounded Borel
functions on R.
Theorem 10.5
Let T be a self-adjoint operator on H and let B(R) denote the set of bounded Borel
functions on R. Then there exists a unique unital ∗-homomorphism B(R) →B(H)
denoted by
B(R) ∋g 	−→g(T ) ∈B(H)
(Continued)

10
136
Chapter 10 • Spectral Theorems
Theorem 10.5 (continued)
such that
▬ζ(T ) = zT ,
▬if (gn)n∈N is a uniformly bounded sequence of Borel functions converging point-
wise to g then gn(T ) −−−→
n→∞g(T ) in strong topology.
Proof
Just as in the proof of the analogous statement for bounded operators, we use the fact that T is
unitarily equivalent to an operator of multiplication by a real-valued measurable function on
a Hilbert space L2(, μ) for some semiﬁnite measure space (, μ). In fact one can assume
that  is a locally compact topological space, μ is a Borel measure and f is Borel. Then for
any bounded Borel function g on R the function g ◦f is Borel and bounded on . For such
g we deﬁne g(T ) as uMg◦f u∗.
It follows immediately from this deﬁnition that g 	→g(T ) is a contractive unital ∗-
homomorphism and that
g(T )
 = ∥Mg◦f ∥= sup |λ| λ ∈Vess(g ◦f ) ≤∥g∥∞.
Furthermore, for g = ζ we have g(T ) = u∗M
f
√
1+f 2
u, i.e. g(T ) = zT (cf. proof of
Theorem 10.4 and Remark 9.11). Finally, if (gn)n∈N is a bounded sequence of Borel functions
converging pointwise to g and ξ ∈H then
gn(x)ξ −g(x)ξ
2 = ∥uM(gn−g)◦f u∗ξ∥2
=
M(gn−g)◦f u∗ξ
2
=


gn

f (ω)
	
−g

f (ω)
	2(u∗ξ)(ω)
2 dμ(ω) −−−→
n→∞0.
by the dominated convergence theorem.
The proof of uniqueness of the homomorphism
Bσ(x)	 ∋f 	−→f (x) ∈B(H)
follows the lines of the proof of the corresponding statement for bounded operators
(Theorem 4.10). We know that a unital ∗-homomorphism Cb(R) →B(H) mapping ζ to
zT is unique, so any unital ∗-homomorphism  : B(R) →B(H) satisfying (ζ) = zT
must coincide with the continuous functional calculus for T on Cb(R). Using this, just as in
the proof of Theorem 4.10, we show that the family
L =

 ∈M (χ) = χ(x)


10.3 · Spectral Measure
137
10
(1)
contains all open sets (in particular  ∈L),
(2)
is closed with respect to taking complements,
(3)
is closed with respect to countable unions of pairwise disjoint elements,
i.e. L is a λ-system (see Appendix A.2). Since the family of all open subsets of R is a π-
system, by Dynkin’s theorem on π- and λ-systems (Theorem A.2), the σ-algebra of all Borel
subsets of R is contained in L. Now any bounded Borel function is a pointwise limit of a
bounded sequence of simple Borel functions, so the homomorphisms  and f 	→f (x) must
agree on all of B

R
	
.
⊓⊔
10.3 Spectral Measure
Let T be a self-adjoint operator on H. Our aim in this section is to express T as an
integral of the function λ 	→λ with respect to certain spectral measure on R. So far we
have discussed such integrals only for bounded functions (▷Sect. 4.3) and now we will
deal with arbitrary Borel functions R →C. We will freely use concepts and notation
introduced in ▷Sect. 4.3.
Let E be a spectral measure on a measurable space (, M).
Lemma 10.6 For any ϕ, ψ ∈H and bounded measurable function g on  we have



g d⟨ϕ | Eψ⟩
 ≤∥ϕ∥
 

|g|2 d⟨ψ | Eψ⟩
 1
2
.
Proof
Let |⟨ϕ Eψ⟩| be the variation of the measure ⟨ϕ Eψ⟩.3 It follows from the Radon-Nikodym
theorem that there exists a measurable function u with values of modulus 1 such that
ug ⟨ϕ Eψ⟩= |g| |⟨ϕ Eψ⟩|.
3In ▷Sect. 4.2 we recalled the notion of total variation of a measure. Now the variation of a complex measure
ν deﬁned on a σ-algebra N is the map |ν| : N →[0 + ∞] deﬁned by
|ν|() = sup
6 N

n=1
ν(n)

7
,
 ∈N
with the supremum is taken over all measurable partitions of . Then |ν| is a measure and ν is absolutely
continuous with respect to |ν|. Also

8
f dν
 ≤
8
|f | d|ν|
for any integrable f .

10
138
Chapter 10 • Spectral Theorems
Therefore



g d⟨ϕ | Eψ⟩
 ≤


|g| d|⟨ϕ Eψ⟩|
=


ug d⟨ϕ | Eψ⟩=

ϕ xugψ

=
 
ϕ xugψ
  ≤∥ϕ∥∥xugψ∥,
and since
∥xugψ∥2 =

ψ x|ug|2ψ

=

ψ x|g|2ψ

=


|g|2 d⟨ψ | Eψ⟩,
we ﬁnd that



g d⟨ϕ | Eψ⟩
 ≤∥ϕ∥
 

|g|2 d⟨ψ | Eψ⟩
 1
2
.
⊓⊔
Before going on to deﬁne integrals of not necessarily bounded functions with respect
to spectral measures let us note that for bounded measurable functions f and g we have


gf d⟨ϕ | Eψ⟩=

ϕ xf xgψ

=

xf ϕ xgψ

=


g d⟨xf ϕ
 Eψ⟩,
which implies the following equality of complex measures:

xf ϕ Eψ

= f ⟨ϕ Eψ⟩.
(10.4)
Proposition 10.7 Let f be a measurable function  →C and deﬁne
Df =
6
ψ ∈H


|f |2 d⟨ψ | Eψ⟩< +∞
7
.
Then Df is a dense subspace of H.
Proof
For n ∈N let n = ω ∈ |f (ω)| ≤n. For ψ ∈E(n)H and any measurable  ⊂
we have
E()ψ = E()E(n)ψ = E( ∩n)ψ,
so that
⟨ψ Eψ⟩() = ⟨ψ E()ψ⟩= ⟨ψ E( ∩n)ψ⟩= ⟨ψ Eψ⟩( ∩n).

10.3 · Spectral Measure
139
10
Hence


|f |2 d⟨ψ | Eψ⟩=

n
|f |2 d⟨ψ | Eψ⟩≤n2∥ψ∥2 < +∞
and thus E(n)H ⊂Df for all n ∈N. On the other hand, since χn −−−→
n→∞1 pointwise, we
have E(n)ψ −−−→
n→∞ψ. It follows that Df is a dense subset of H.
In order to see that Df is a vector subspace, take ψ, ϕ ∈Df . Then for any  ∈M
E()(ψ + ϕ)
2 ≤
E()ψ
 +
E()ϕ
	2 ≤2
E()ψ
2 + 2
E()ϕ
2.
In other words
⟨ψ + ϕ E(ψ + ϕ)⟩≤2 ⟨ψ Eψ⟩+ 2 ⟨ϕ Eϕ⟩
which shows that ψ +ϕ ∈Df . The fact that Df is closed under scalar multiplication is clear.
⊓⊔
For a function f as in Proposition 10.7 we will now deﬁne an operator xf with
domain D(xf ) = Df . Let us take ψ ∈D(xf ) and ϕ ∈H. By Lemma 10.6 and
dominated convergence theorem, we have



f d⟨ϕ | Eψ⟩
 ≤∥ϕ∥
 

|f |2 d⟨ψ | Eψ⟩
 1
2
,
and consequently
ϕ 	−→


f d⟨ϕ | Eψ⟩
is a bounded liner functional on H. It follows that there exists a unique vector η such
that


f d⟨ϕ | Eψ⟩= ⟨ϕ η⟩.
We put xf ψ = η. The left hand side of the above expression is linear in ψ, so xf is a
densely deﬁned linear operator. Moreover, for f bounded, this deﬁnition of xf coincides
with the deﬁnition of xf given in Theorem 10.5 (see also ▷Sect. 4.3).
ⓘRemark 10.8 Let f1 and f2 be measurable functions  →C and let
ψ ∈D(xf1) ∩D(xf2) = Df1 ∩Df2. Then for any ϕ ∈H
ϕ xf1ψ + ϕ xf2ψ =


f1 d⟨ϕ | Eψ⟩+


f2 d⟨ϕ | Eψ⟩
=


(f1 + f2) d⟨ϕ | Eψ⟩=

ϕ xf1+f2ψ

,

10
140
Chapter 10 • Spectral Theorems
i.e. we have xf1ψ + xf2ψ = xf1+f2ψ.
Theorem 10.9
Let E be a spectral measure on (, M). Then
(1)
for any measurable function f :  →C the operator xf is closed,
(2)
for ψ ∈D(xf ) we have
∥xf ψ∥2 =


|f |2 d⟨ψ | Eψ⟩,
(10.5)
(3)
for any measurable f, g :  →C we have xf xg ⊂xfg and, moreover,
D(xf xg) = Dg ∩Dfg,
(4)
for any measurable f :  →C we have xf ∗= xf .
Proof
We will prove (2), (3) and (4). Statement (1) follows by applying (4) to f .
Let χn be the characteristic function of

ω ∈ |f (ω)| ≤n

and let fn = χnf . As fn is
bounded, we have Df −fn = Df . Furthermore, by the dominated convergence theorem, for
ψ ∈Df we have
xf ψ −xfnψ
2 ≤


|f −fn| d⟨ψ | Eψ⟩−−−→
n→∞0
(10.6)
(cf. Remark 10.8 and the paragraph preceding it). Since fn is bounded, we can perform the
following computation
xfnψ
2 =

ψ x|fn|2ψ

=


|fn|2 d⟨ψ | Eψ⟩,
and consequently (10.5) follows from the approximation (10.6) and (2) is proved.
Assume for the moment that f is bounded. Then Dg ⊂Dfg and for ψ ∈Dg, ϕ ∈H we
have

ϕ xf xgψ

=

xf ϕ xgψ

=


g d⟨xf ϕ | Eψ⟩=


fg d⟨ϕ | Eψ⟩=

ϕ xfgψ

by (10.4). This shows that for ψ ∈Dg (and f bounded) we have
xf xgψ = xfgψ,

10.3 · Spectral Measure
141
10
and consequently


|f |2 d⟨xgψ | Exgψ⟩= ∥xf xgψ∥2 = ∥xfgψ∥2
=


|fg|2 d⟨ψ | Eψ⟩,
ψ ∈Dg(T )	.
Now since the above formula holds for all bounded measurable functions, it also holds for
any measurable function f :  →C. Therefore xgψ belongs to D(xf ) = Df if and only if
ψ ∈Dfg, i.e.
D(xf xg) = Dg ∩Dfg.
This proves Statement (3).
For the proof of (4) we will once more use the approximation of f by the bounded
functions fn. Take ψ ∈Df and ϕ ∈Df = Df . Then

ϕ xf ψ

= lim
n→∞

ϕ xfnψ

= lim
n→∞

xfnϕ ψ

=

xf ϕ ψ

which shows that ϕ ∈D(xf ∗) and xf ∗ψ = xf ψ. In other words
xf ⊂xf ∗.
(10.7)
Now take ζ ∈D(xf ∗). By (3) we have xfn = xf xχn, so that
xχnxf ∗⊂(xf xχn)∗= xfn
∗= xfn,
as xχn is a self-adjoint operator. In particular
xχnxf ∗ζ = xfnζ,
n ∈N.
We have


|fn|2 d⟨ζ | Eζ⟩= ∥xfnζ∥2 = ∥xχnxf ∗ζ∥2
=


|χn|2 d⟨xf ∗ζ | Exf ∗ζ⟩
≤xf ∗ζ Exf ∗ζ () < +∞
and hence


|f |2 d⟨ζ | Eζ⟩< +∞.

10
142
Chapter 10 • Spectral Theorems
It follows that ζ ∈Df = D(xf ). This way we proved that D(xf ∗) ⊂D(xf ) which together
with (10.7) gives (4).
⊓⊔
Theorem 10.10
Let T be a self-adjoint operator. Then there exists a unique spectral measure ET on R
such that
T =

R
λ dET (λ).
Before proving Theorem 10.10 let us note that the result allows us to deﬁne
functional calculus for T for all (not necessarily bounded) Borel functions on R. More
precisely for a Borel function f : R →C we put
f (T ) =

R
f (λ) dE(λ).
(10.8)
In case f is bounded, formula (10.8) produces the image of f under functional calculus
for bounded Borel functions deﬁned in Theorem 10.5. Moreover, it follows easily form
Theorem 10.9(3) that if f and g are Borel functions R →C and g is bounded then
f (T )g(T ) = (fg)(T ). Indeed: we have
D

f (T )g(T )
	
= Dg ∩Dfg = H ∩Dfg = D

(fg)(T )
	
,
and therefore
g(T )f (T ) ⊂(gf )(T ) = (fg)(T ) = f (T )g(T ).
(10.9)
One cannot expect equality in (10.9), because e.g. if f (T ) is unbounded and g = 0,
then the domain of the left hand side is D

f (T )
	
, while the right hand side is deﬁned on
all of H.
Proof of Theorem 10.10
Let EzT be the spectral measure of the z-transform of T . Since σ(zT ) ⊂[−1, 1] we can treat
EzT as a Borel spectral measure on [−1, 1]. Moreover, we immediately see that since ±1 is
not an eigenvalue of zT , we have EzT

{±1}
	
= 0. In other words EzT is a spectral measure
on ]−1, 1[.
Let
S =
1
−1
μ
√
1−μ2 dEzT (μ).

10.3 · Spectral Measure
143
10
Let us check that S = T . Using the notation introduced above, we have S = xf , where
f (μ) =
μ
√
1−μ2 . Put g(μ) =
-
1 −μ2. Then
Sxg ⊂xfg =
1
−1
μ dEzT (μ) = zT
by Theorem 10.9(3). Moreover D(Sxg) = Dg ∩Dfg = H, as g and fg are bounded on
 = ]−1, 1[. This, in turn, means that
Sxg = zT .
(10.10)
Finally note that
xg = g(zT ) = (1 −zT 2)
1
2 ,
which shows that (10.10) is in fact
S(1 −zT 2)
1
2 = T (1 −zT 2)
1
2 .
In particular T ⊂S, and since S and T are self-adjoint, we obtain S = T by Remark 8.9.
Now let ET be the push-forward of EzT by the map ζ −1 : ]−1, 1[ →R, i.e.
ET (Δ) = EzT

ζ(Δ)
	
,
 ∈M,
where M is the σ-algebra of Borel subsets of R (in standard notation we write ET =
(ζ −1)∗EzT ). Then
T =
1
−1
μ
√
1−μ2 dEzT (μ) =
1
−1
ζ −1(μ) dEzT (μ) =

R
λ dET (λ).
We move on to the question of uniqueness of the spectral measure ET . Suppose that E
is a Borel spectral measure on R such that
T =

R
λ dE(λ).
Then zT = ζ(T ) =

R
λ
√
1+λ2 dE(λ). Now let E′ be the push-forward of E onto ]−1, 1[ by
the map ζ. Then
zT =
1
−1
μ dE′(μ).

10
144
Chapter 10 • Spectral Theorems
It follows from the uniqueness of the spectral measure of zT that E′ = EzT . Since ζ is a
homeomorphism, we obtain
E = (ζ −1)∗E′ = (ζ −1)∗EzT ,
so that E = ET .
⊓⊔
Let T be a self-adjoint operator and let f be a continuous real-valued function on R.
In ▷Sect. 10.1. we deﬁned f (T ) as the operator whose z-transform is (ζ◦f )(T ) (having
deﬁned bounded continuous functions of T in Theorem 10.1). The obvious question is
whether this operator is the same as f (T ) deﬁned by formula (10.8). The following
reasoning yields a positive answer to this question: let ET be the spectral measure of T
and take a real-valued f ∈C(R). Since

R
λ d(f∗ET )(λ) =

R
f (λ) dET (λ) = f (T ),
it follows from uniqueness of the spectral measure of f (T ) that Ef (T ) = f∗ET .
Therefore
zf (T ) =

R
ζ(μ) dEf (T )(μ) =

R
(ζ ◦f )(λ) dET (λ) = (ζ ◦f )(T )
where in the second equality we used a well-known property of a push-forward of
measure.
Consequently the z-transform of the operator f (T ) (deﬁned by formula (10.8)) is
the operator declared as the z-transform of f (T ) in Theorem 10.3.
Notes
Spectral theory of unbounded operators has numerous applications and the reader will
ﬁnd far reaching extensions of the basic material of this chapter e.g. in [AkGl, Chapter
VI], [Mau, Chapter VI], [ReSi1, Chapter VIII] and in selected chapters of [Ped, Rud2].
All of these textbooks and monographs contain many examples and exercises on the
subject.

145
11
Self-Adjoint Extensions of Symmetric
Operators
© Springer Nature Switzerland AG 2018
P. Sołtan, A Primer on Hilbert Space Operators, Compact Textbooks in Mathematics,
https://doi.org/10.1007/978-3-319-92061-0_11
Self-adjointness of certain operators is crucial in many applications (e.g. in quantum
physics or in partial differential equations). However, operators which naturally occur
in many problems turn out to be symmetric, but not necessarily self-adjoint. It is for
that reason that the problem of existence and classiﬁcation of self-adjoint extensions of
symmetric operators was one of the ﬁrst challenges of the theory of unbounded operators
on Hilbert spaces. In this chapter we will present the ﬁrst results on that topic.
11.1 Containment of Operators in Terms of z-Transforms
Theorem 11.1
Let S and T be densely deﬁned closed operators on H. Then T ⊂S if and only if
(1 −zSzS∗)
1
2 zT = zS(1 −zT ∗zT )
1
2 .
Proof
The relation T ⊂S means exactly that G(T ) ⊂G(S). Now the graphs of S and T have a
precise description in terms of their z-transforms given in Theorem 9.6:
G(T ) =
0
(1 −zT ∗zT )
1
2 ξ
zT ξ
 
ξ ∈H
1
,
G(S) =
0
(1 −zS∗zS)
1
2 ξ
zSξ
 
ξ ∈H
1
.
Moreover
G(T ) = UzT

H ⊕{0}
	
,
G(S) = UzS

H ⊕{0}
	
,

11
146
Chapter 11 • Self-Adjoint Extensions of Symmetric Operators
where
UzT =

(1 −zT ∗zT )
1
2
−zT ∗
zT
(1 −zT zT ∗)
1
2
 
,
UzS =

(1 −zS∗zS)
1
2
−zS∗
zS
(1 −zSzS∗)
1
2
 
are unitary operators on H ⊕H and H ⊕{0} denotes the subspace of horizontal vectors
0
ξ
0
 
ξ ∈H
1
⊂H ⊕H.
(cf. remarks following Theorem 9.9). It follows that G(T ) ⊂G(S) is equivalent to
UzT

H ⊕{0}
	
⊂UzS

H ⊕{0}
	
.
(11.1)
Applying UzS
∗to both sides of (11.1) we obtain
UzS
∗UzT

H ⊕{0}
	
⊂H ⊕{0}.
It is easy to see that the only operators on H ⊕H preserving the subspace H ⊕{0} are the
ones which in matrix notation have the form

• •
0 •
 
.
In particular, the condition T ⊂S is equivalent to vanishing of the lower left corner of the
matrix
UzS
∗UzT
=

(1 −zS∗zS)
1
2
−zS∗
zS
(1 −zSzS∗)
1
2
 ∗
(1 −zT ∗zT )
1
2
−zT ∗
zT
(1 −zT zT ∗)
1
2
 
=

(1 −zS∗zS)
1
2
zS∗
−zS
(1 −zSzS∗)
1
2
 
(1 −zT ∗zT )
1
2
−zT ∗
zT
(1 −zT zT ∗)
1
2
 
=

•
•
−zS(1 −zT ∗zT )
1
2 + (1 −zSzS∗)
1
2 zT •
 
In other words T ⊂S if and only if (1 −zSzS∗)
1
2 zT = zS(1 −zT ∗zT )
1
2 .
⊓⊔

11.2 · Cayley Transform
147
11
11.2 Cayley Transform
Before we continue, let us introduce a piece of notation which adds certain ﬂexibility
in dealing with partial isometries. Let v ∈B(H) be a partial isometry. We know form
Proposition 3.12 that there is a closed subspace S ⊂H such that vξ = 0 for ξ ∈S⊥
and ∥vξ∥= ∥ξ∥for ξ ∈S. We will denote by ˚v the operator v

S understood as an
operator on H with domain D(˚v) = S = v∗H. In particular we can speak of the graph
of ˚v as a subset of H ⊕H. In accordance with our previous conventions for x ∈B(H)
the operator ˚v + x is deﬁned on D(˚v + x) = D(˚v) = S. The operation v 	→˚v is a
bijection between the set of partial isometries on H and the set of isometric operators
deﬁned on closed subspaces of H.
From now on let T be a symmetric operator. We are interested in self-adjoint
extensions of T , i.e. operators S such that T ⊂S and S = S∗. Since self-adjoint
operators are closed and symmetric ones are closable (see Proposition 8.7), any self-
adjoint extension of T is an extension of T . We can therefore assume that T is closed.
It follows from Theorem 11.1 that
(1 −zT
∗zT )
1
2 zT = zT
∗(1 −zT
∗zT )
1
2 .
(11.2)
Deﬁne two operators
w± = zT ± i(1 −zT
∗zT )
1
2 .
Then w+ and w−are isometries:
w±
∗w± = zT
∗∓i(1 −zT
∗zT )
1
2 	zT ± i(1 −zT
∗zT )
1
2 	
= zT
∗zT ∓i

(1 −zT
∗zT )
1
2 zT −zT
∗(1 −zT
∗zT )
1
2 	
+ (1 −zT
∗zT ) = 1
by (11.2). Let W± = w±H and D± = W ⊥
± .
The subspaces D+ and D−are called the deﬁciency subspaces of T and their
dimensions n± = dimD± are the deﬁciency indices of T .
Proposition 11.2 We have D± = ker(T ∗∓i1).
Proof
Since D± = W ⊥
± , the condition ζ ∈D± means that

ζ zT ξ ± i(1 −zT ∗zT )
1
2 ξ

= 0,
ξ ∈H.
(11.3)
Taking into account the description of the graph of T in terms of zT given in Theorem 9.6,
we see that (11.3) is equivalent to
⟨ζ T ψ ± iψ⟩= 0,
ψ ∈D(T ),

11
148
Chapter 11 • Self-Adjoint Extensions of Symmetric Operators
which means precisely that ζ ∈D

(T ± i1)∗	
and (T ± i1)∗ψ = 0. By Proposition 8.15(2)
this amounts to ζ ∈ker(T ∗∓i1).
⊓⊔
Let cT = w−w+∗. Then cT is a partial isometry with initial subspace W+ and ﬁnal
subspace W−. The operator ˚
cT is called the Cayley transform of the closed symmetric
operator T .
Using once again the argument from the proof of Proposition 11.2 we easily obtain
G(˚
cT ) =
0
ϑ
w−w+∗ϑ
 
ϑ ∈W+
1
=
0
w+ξ
w−ξ
 
ξ ∈H
1
=
0
T ψ + iψ
T ψ −iψ
 
ψ ∈D(T )
1
=

i1 1
−i1 1
 
G(T )
and hence
G(T ) =

−i1 i1
1
1
 
G(˚
cT ).
In particular ˚
cT determines T .
As G(T ) is a graph of a densely deﬁned operator, by Propositions 8.3 and 8.1
G(T )⊥∩H ⊕{0}	 = G(T ) ∩{0} ⊕H	 = {0}.
Therefore, for any ξ ∈H we have
 
ξ
0
 
⊥

−i1 i1
1
1
 
G(˚
cT )

⇒

ξ = 0

.
(11.4)
The condition on the left hand side of (11.4) means

ξ
0
 
−i1 i1
1
1
 
ϑ
˚
cT ϑ
 
= 0,
ϑ ∈D(˚
cT )
which can be rewritten as

ξ (˚
cT −1)ϑ

= 0,
ϑ ∈W+.
In other words, a vector which is orthogonal to (˚
cT −1)W+ = (cT −1)cT ∗H must be
zero, i.e. the subspace (cT −1)cT ∗H is dense in H:
(cT −1)cT ∗H = H.
(11.5)

11.2 · Cayley Transform
149
11
Notice further, that it follows from (11.5) that ker(cT −1) = {0}. Indeed: noting
that for any partial isometry v we have ker

v∗(v −1)
	
= ker

v(v∗−1)
	
, we obtain
ker(cT −1) ⊂ker

cT ∗(cT −1)
	
= ker

cT (cT ∗−1)
	
=

(1 −cT )cT ∗H
	⊥= {0}.1
Theorem 11.3
The mapping T 	→cT is a bijection between the set of closed symmetric operators on
H and the set of partial isometries c ∈B(H) satisfying (c −1)c∗H = H.
Proof
We have already shown that if T is a closed symmetric operator then cT is a partial isometry
satisfying (11.5) and that the map T 	→cT is injective (in other words cT determines T ). It
remains to prove that if c is a partial isometry such that (c −1)c∗H = H then there exists a
closed symmetric operator T such that c = cT .
Let
G =

−i1 i1
1
1
 
G(˚c).
It is clear that G is a closed subspace of H ⊕H. By reversing the reasoning leading up to
condition (11.5), we obtain
 
ξ
0
 
⊥G

⇒

ξ = 0

.
More precisely, if

ξ
0
 
−i1 i1
1
1
 
ϑ
˚cϑ
 
= 0,
ϑ ∈D(˚c),
then
ξ ⊥(c −1)ϑ,
ϑ ∈c∗H,
i.e. ξ ⊥(c −1)c∗H and this implies ξ = 0. Similarly we check that also the condition
 
0
η
 
∈G

⇒

η = 0

1Triviality of the kernel of cT −1 follows also from the fact that G(T ) does not contain non-zero vertical
vectors, in a way similar to how we derived (11.5) from (11.4). It is not surprising that one of these conditions
implies the other, because T is symmetric, i.e.
G(T ) ⊂G(T ∗) =
2 0
1
−1 0
3
G(T )⊥.

11
150
Chapter 11 • Self-Adjoint Extensions of Symmetric Operators
holds. Indeed: if

0
η
 
=

−i1 i1
1
1
 
ϑ
˚cϑ
 
for some ϑ ∈D(˚c) then η = (1 +˚c)ϑ and (˚c −1)ϑ = 0. Thus
ϑ ∈ker(˚c−1) ⊂ker(c−1) ⊂kerc∗(c−1)	 = kerc(c∗−1)	 = (c−1)c∗H	⊥= {0}
(see remarks preceding the statement of the theorem) and consequently η = (1 +˚c)ϑ = 0.
This way we have shown that G is a graph of a closed densely deﬁned operator T
(Corollary 8.4).
Let us now look a the graph of T ∗:
G(T ∗) =

0
1
−1 0
 
G(T )⊥=

0 1
−1 0
  
−i1 i1
1
1
 
G(˚c)
⊥
=
 
0 1
−1 0
 
−i1 i1
1
1
 
G(˚c)
⊥
=
 
1
1
i1 −i1
 
G(˚c)
⊥
.
Now take an arbitrary
2 ξ
η
3
∈G(T ). Then there exists ϑ
∈D(˚c) such that
2 ξ
η
3
=
2 −i1 i1
1
1
32 ϑ
˚cϑ
3
and for any ϑ′ ∈D(˚c) we have

−i1 i1
1
1
 
ϑ
˚cϑ
 
1
1
i1 −i1
 
ϑ′
˚cϑ′
 
=

ϑ
˚cϑ
 
i1 1
−i1 1
 
1
1
i1 −i1
 
ϑ′
˚cϑ′
 
=

ϑ
˚cϑ
 
2i1
0
0 −2i1
 
ϑ′
˚cϑ′
 
= 2i ϑ ϑ′ −˚cϑ ˚cϑ′ 	 = 0,
as˚c preserves the scalar product on D(˚c). This proves that
G(T ) ⊂G(T ∗),
i.e. T is symmetric.
⊓⊔
ⓘRemark 11.4 Let c1 and c2 be partial isometries on H such that ˚
c1 ⊂˚
c2. Then if
(c1 −1)c1∗H = H then also (c2 −1)c2∗H = H. Indeed: we have
c2∗H = D(˚
c2) ⊃D(˚
c1) = c1∗H and for any ξ ∈D(˚
c1) we have
(c2 −1)ξ = (c1 −1)ξ. Therefore (c2 −1)c2∗H ⊃(c1 −1)c1∗H.

11.2 · Cayley Transform
151
11
Corollary 11.5 Fix a closed symmetric operator T . Then T ′ is a closed symmetric extension
of T if and only if ˚
cT ⊂˚
cT ′.
Proof
We already know that partial isometries c satisfying
(c −1)c∗H = H
are in bijection with closed symmetric operators and the operator corresponding to c is Tc
deﬁned by
G(Tc) =

−i1 i1
1
1
 
G(˚c).
(11.6)
Let s be a partial isometry such that ˚c ⊂˚s. Since (c −1)c∗H = H, Remark 11.4 shows
that also (s −1)s∗H = H. Furthermore, it is clear from formula (11.6) that the operator Ts
deﬁned by s satisﬁes G(Tc) ⊂G(Ts) or, in other words, Tc ⊂Ts.
⊓⊔
Theorem 11.6
Let T be a closed symmetric operator with deﬁciency subspaces D+ and D−. Let

D± =
0
φ
±iφ
 
φ ∈D±
1
.
Then
G(T ∗) = G(T ) ⊕
D+ ⊕
D−.
(11.7)
Proof
Let us ﬁrst check that the three subspaces on the right hand side of (11.7) are pairwise
orthogonal.
It is clear that for any ξ, η ∈H we have

ξ
iξ
 
η
−iη
 
= ⟨ξ η⟩+ ⟨iξ −iη⟩= 0,
and hence the subspaces 
D+ and 
D−are orthogonal.

11
152
Chapter 11 • Self-Adjoint Extensions of Symmetric Operators
Take ψ ∈D(T ) and φ ∈D± = ker(T ∗∓i1). Then

ψ
T ψ
 
φ
±iφ
 
= ⟨ψ φ⟩± i ⟨T ψ φ⟩
= ⟨ψ φ⟩± i ψ T ∗φ = ⟨ψ φ⟩± i ⟨ψ ± iφ⟩= 0
which shows that G(T ) is orthogonal to 
D+ and to 
D−.
As T is symmetric, we have G(T ) ⊂G(T ∗). Moreover 
D± ⊂G(T ∗) by deﬁnition of
these subspaces (D± are eigenspaces of T ∗). It remains to show that if a vector
2
ϕ
T ∗ϕ
3
∈
G(T ∗) is orthogonal to G(T ) ⊕
D+ ⊕
D−then ϕ = 0. Let us therefore take ϕ ∈D(T ∗) such
that

ϕ
T ∗ϕ
 
⊥G(T ) ⊕
D+ ⊕
D−.
Then for any ψ ∈D(T ) we have
0 =

ϕ
T ∗ϕ
 
ψ
T ψ
 
= ⟨ϕ ψ⟩+

T ∗ϕ T ψ

,
and so the functional
D(T ) ∋ψ 	−→

T ∗ϕ T ψ = −⟨ϕ ψ⟩
is continuous. It follows that T ∗ϕ ∈D(T ∗) and T ∗2ϕ = −ϕ, and hence
ϕ ∈D(T ∗+ i1)(T ∗−i1)
	
and
(T ∗+ i1)(T ∗−i1)ϕ = 0.
(11.8)
Put η = (T ∗−i1)ϕ, and note that it follows from (11.8) that η ∈D−. Now for any vector
η′ ∈D−we have
i

η′ η

= i

η′ (T ∗−i1)ϕ

=

−iη′ T ∗ϕ

+ i

η′ −iϕ

= −iη′ T ∗ϕ + η′ ϕ =

η′
−iη′
 
ϕ
T ∗ϕ
 
= 0,
because
2 η′
−iη′
3
∈
D−and we have assumed that
2
ϕ
T ∗ϕ
3
⊥
D−. Putting η′ = η we obtain
η = 0, and consequently T ∗ϕ = iϕ. This, in turn, means that ϕ ∈D+, i.e.
2
ϕ
T ∗ϕ
3
∈
D+.
However
2
ϕ
T ∗ϕ
3
is also orthogonal to 
D+, so that ϕ = 0.
⊓⊔

11.2 · Cayley Transform
153
11
From Theorem 11.6 we can immediately derive sufﬁcient and necessary conditions
for T to be self-adjoint.
Corollary 11.7 Let T be a closed symmetric operator. Then the following conditions are
equivalent:
(1)
T is self-adjoint,
(2)
D+ = D−= {0},
(3)
n+ = n−= 0,
(4)
the Cayley transform of T is a unitary operator.
Similarly from Corollaries 11.7 and 11.5 we infer the following:
Corollary 11.8 Let T be a closed symmetric operator. Then the following conditions are
equivalent:
(1)
T has a self-adjoint extension,
(2)
there exists a unitary operator D+ →D−,
(3)
n+ = n−.
Proof
Self-adjoint extensions of T are in bijection with unitary extensions of ˚
cT and such an
extension exists if and only if there is a unitary operator D+ →D−, i.e. if and only if
n+ = n−.
⊓⊔
Note that Corollary 11.8 not only provides information on existence of self-adjoint
extensions of a given symmetric operator T , but also on the number of such extensions.
More precisely, there are as many extensions of T as there are unitary operators D+ →
D−, i.e. inﬁnitely many in any non-trivial case. In other words, self-adjoint extensions
of T are parametrized by the unitary group U(n+).
ⓘRemark 11.9 A fully analogous analysis can be performed without the assumption that
T is closed. In that case one must manage without the useful tool in the form of the
z-transform, but the conclusion is practically the same as the results for closed
symmetric operators given in Corollaries 11.7 and 11.8. The main difference lies in the
fact that if T is not assumed to be closed, then it might happen that both deﬁciency
indices are zero, but T is still not self-adjoint. In this case the closure of T is self-adjoint
and we say that T is essentially self-adjoint.
We will end this section with a simple criterion for existence of self-adjoint
extensions of a given symmetric operator. Let us begin by recalling that a mapping
K : H →H is an anti-linear operator if it is additive:
K(ξ + η) = K(ξ) + K(η),
ξ, η ∈H

11
154
Chapter 11 • Self-Adjoint Extensions of Symmetric Operators
and we have
K(αξ) = αK(ξ),
α ∈C, ξ ∈H.
As for linear operators, we omit parentheses in the notation of an action of an anti-linear
operator on a vector, i.e. we write Kξ instead of K(ξ).
An anti-linear operator J : H →H is called anti-unitary if J is surjective and
⟨Jξ Jη⟩= ⟨η ξ⟩,
ξ, η ∈H
(it is equivalent to J being an isometry of H onto H). Finally an anti-unitary operator
is called an involution if J 2 = 1.
Proposition 11.10 Let T be a symmetric operator and let J be an anti-unitary involution
on H. Assume that JD(T )	 ⊂D(T ) and
T Jψ = JT ψ,
ψ ∈D(T ).
Then T has a self adjoint extension.
Proof
We have to show that the deﬁciency indices n± of T are equal. To that end we will check that
J maps D+ bijectively onto D−. The operator J is R-linear, so dimR D+ = dimR D−and
hence dim D+ = dim D−.
Let ξ ∈D± = ker(T ∗∓i1). Then for any ψ ∈D(T ) we have
⟨Jξ T ψ⟩=

Jξ J 2T ψ

= ⟨Jξ JT Jψ⟩= ⟨T Jψ ξ⟩
=

Jψ T ∗ξ

= ⟨Jψ ± iξ⟩= ±i ⟨Jψ ξ⟩
= ±i

Jψ J 2ξ

= ±i ⟨Jξ ψ⟩= ⟨∓iJξ ψ⟩,
and hence Jξ ∈D(T ∗) and T ∗Jξ = ∓iJξ. This shows that JD± ⊂D∓and it follows that
D−= J 2D−= J(JD−) ⊂JD+ ⊂D−.
Consequently JD+ = D−.
⊓⊔
11.3 Krein and Friedrichs Extensions
Let T be a densely deﬁned positive operator. Since for any ψ ∈D(T ) we have
⟨ψ T ψ⟩≥0, it follows that
⟨ψ T ψ⟩= ⟨T ψ ψ⟩,
ψ ∈D(T ).

11.3 · Krein and Friedrichs Extensions
155
11
Hence, using the polarization formula, we obtain
⟨ψ T φ⟩= ⟨T ψ φ⟩,
ψ, φ ∈D(T ),
so that T is symmetric. This section will be devoted to studying self-adjoint extensions
of positive operators. As we already mentioned in ▷Sect. 11.2, we can, without loss of
generality, assume that T is closed.
Now let T be positive and self-adjoint. Using spectral theory (or more precisely,
functional calculus) one can show that σ(T ) ⊂R+. However, this fact can be derived
using much more elementary methods (cf. ▷Sect. 9.1):
(A)
ker(T + 1) = {0}, because T ψ = −ψ for some ψ ∈D(T ) implies
0 = ⟨ψ T ψ⟩= −∥ψ∥2 ≤0,
i.e. ψ = 0.
(B)
The range of T + 1 is dense in H, as ξ ⊥(T + 1)H means that
⟨ξ (T + 1)ψ⟩,
ψ ∈D(T ),
i.e. D(T ) ∋ψ 	→⟨ξ T ψ⟩is a continuous linear functional and consequently
ξ ∈D(T ∗) = D(T ) and T ξ = T ∗ξ = −ξ. In other words ξ ∈ker(T + 1) = {0}.
(C)
For any ψ ∈D(T ) we have
(T + 1)ψ
2
= ∥T ψ∥2 + ⟨ψ T ψ⟩+ ⟨T ψ ψ⟩+ ∥ψ∥2 ≥∥ψ∥2.
(11.9)
In particular the range of T +1 is closed: if

(T +1)ψn
	
n∈N is a Cauchy sequence
then it follows from (11.9) that also (ψn)n∈N is a Cauchy sequence. Let φ =
lim
n→∞ψn. Then from closedness of T +1 we infer that lim
n→∞(T +1)ψn = (T +1)φ.
Summing up the above observations we see that T + 1 is a bijection D(T ) onto H
and the inverse operator (T +1)−1 is continuous (in fact it is a contraction). In particular
−1 ̸∈σ(T ). Furthermore, for any λ > 0 the operator 1
λT is positive and self-adjoint, so
−1 ̸∈σ
 1
λT
	
. It follows that −λ ̸∈σ(T ). This way we have shown that σ(T ) ⊂R+.
Lemma 11.11 Let K be a closed subspace of the Hilbert space H and let a ∈B(K), b ∈
B(K, K⊥) and c ∈B(K⊥). Then

a b∗
b c
 
≥0
(11.10)

11
156
Chapter 11 • Self-Adjoint Extensions of Symmetric Operators
in B(H) if and only if a ≥0 in B(K) and for any ε > 0 we have
c ≥b(a + ε1K)−1b∗
(11.11)
in B(K⊥).
Proof
Computing the expectation value
2 ξ
0
3 2 a b∗
b c
32 ξ
0
3
we easily check that for (11.10) to hold it
is necessary that a ≥0 in B(K).
Let pK ∈B(H) be the projection onto K. Then for any ε > 0 the operator εpK is
positive and εpK −−→
ε↘0
0 in strong topology (monotonically decreasing). It is clear that
(11.10) is equivalent to

a + ε1K b∗
b
c
 
≥0,
ε > 0.
(11.12)
Assume (11.12) holds. Then for any ε > 0 we have

ξ1
ξ2
 
a + ε1K b∗
b
c
 
ξ1
ξ2
 
≥0,
for arbitrary 2 ξ1
ξ2
3 ∈K ⊕K⊥. In other words
⟨ξ1 (a + ε1K)ξ1⟩+

ξ1 b∗ξ2
 + ⟨ξ2 bξ1⟩+ ⟨ξ2 cξ2⟩≥0,
ξ1 ∈K, ξ2 ∈K⊥.
Setting ξ1 = −(a + ε1K)−1b∗ξ2 we obtain

ξ2 −b(a + ε1K)−1b∗ξ2

+ ⟨ξ2 cξ2⟩≥0,
ξ2 ∈K⊥
which is exactly (11.11).
Now assume that a ≥0 and for any ε > 0 the relation (11.11) holds. We have

a + ε1K b∗
b
c
 
=

a + ε1K
b∗
b
b(a + ε1K)−1b∗
 
+

0
0
0 c −b(a + ε1K)−1b∗
 
and the element

0
0
0 c −b(a + ε1K)−1b∗
 

11.3 · Krein and Friedrichs Extensions
157
11
is obviously positive. Therefore, in order to prove (11.12), it is enough to show that for any
ε > 0 we have

a + ε1K
b∗
b
b(a + ε1K)−1b∗
 
≥0.
Writing A for a + ε1K we get

ξ1
ξ2
 
a + ε1K
b∗
b
b(a + ε1K)−1b∗
 
ξ1
ξ2
 
= ⟨ξ1 Aξ1⟩+

ξ1 b∗ξ2

+ ⟨ξ2 bξ1⟩+

ξ2 bA−1b∗ξ2

.
Assume for the moment that
ξ2 = bη + η′
(11.13)
with η′ ∈ker b∗= (bK)⊥. Then

ξ1
ξ2
 
a + ε1K
b∗
b
b(a + ε1K)−1b∗
 
ξ1
ξ2
 
= ⟨ξ1 Aξ1⟩+

ξ1 b∗bη + b∗η′
+ bη + η′ bξ1
 +

bη + η′ bA−1b∗(bη + η′)

= ⟨ξ1 Aξ1⟩+

ξ1 b∗bη + b∗η′
+ b∗bη + b∗η′ ξ1
 +

b∗bη + b∗η′ A−1(b∗bη + b∗η′)

= ⟨ξ1 Aξ1⟩+ ξ1 b∗bη + b∗bη ξ1
 +

b∗bη A−1b∗bη

=

ξ1 Aξ1 + b∗bη +

b∗bη ξ1 + A−1b∗bη

=

ξ1 A(ξ1 + A−1b∗bη)

+

b∗bη ξ1 + A−1b∗bη

=

Aξ1 ξ1 + A−1b∗bη

+

b∗bη ξ1 + A−1b∗bη

=

Aξ1 + b∗bη ξ1 + A−1b∗bη

=

A(ξ1 + A−1b∗bη) ξ1 + A−1b∗bη

=

ξ1 + A−1b∗bη A(ξ1 + A−1b∗bη)

≥0.

11
158
Chapter 11 • Self-Adjoint Extensions of Symmetric Operators
Now any vector ξ2 is a limit of vectors of the form (11.13), because K⊥is the direct sum
K⊥= bK ⊕ker b∗. This way we have shown that

ξ1
ξ2
 
a + ε1K
b∗
b
b(a + ε1K)−1b∗
 
ξ1
ξ2
 
≥0
for all
2 ξ1
ξ2
3
∈K ⊕K⊥.
⊓⊔
Corollary 11.12 Let H, K, a, b, c be as in Lemma 11.11. Then
0 ≤

a b∗
b c
 
≤1
(11.14)
if and only is 0 ≤a ≤1K and for any ε > 0 we have
b(a + ε1K)−1b∗≤c ≤1K⊥−b(1K −a + ε1K)−1b∗.
Proof
By Lemma 11.11 the ﬁrst inequality of (11.14) is equivalent to a ≥0 and b(a+ε1K)−1b∗≤
c for any ε > 0.
The second inequality of (11.14) is, in turn equivalent to
0 ≤

1K −a
−b∗
−b
1K⊥−c
 
(11.15)
and applying Lemma 11.11 to this case we ﬁnd that (11.15) is equivalent to a ≤1K and
1K⊥−c ≥b(1K −a + ε′1K)−1b∗for any ε′ > 0. The latter condition can be expressed
also as c ≤1K⊥−b(1K −a + ε′1K)−1b∗for any ε′ > 0. This way we proved that (11.14)
is equivalent to the condition that 0 ≤a ≤1K and
b(a + ε1K)−1b∗≤c ≤1K⊥−b(1K −a + ε′1K)−1b∗,
ε, ε′ > 0,
which is further equivalent to
b(a + ε1K)−1b∗≤c ≤1K⊥−b(1K −a + ε1K)−1b∗,
ε > 0.
⊓⊔
Now let T and S be positive and self-adjoint operators. We write T
≥S if
the bounded operators (T + 1)−1 and (S + 1)−1 satisfy (T + 1)−1 ≤(S + 1)−1
(cf. Proposition 3.7)

11.3 · Krein and Friedrichs Extensions
159
11
Theorem 11.13
Let T be a closed positive operator. Then there exist positive self-adjoint operators TK
and TF such that
(1)
T ⊂TK and T ⊂TF ,
(2)
a positive self-adjoint operator T is an extension of T if and only if TK ≤T ≤
TF .
Proof
Let K be the range of the operator T + 1. The arguments used to prove Statements (A) and
(C) preceding Lemma 11.11, show that K is a closed subspace of H and T + 1 is a bijection
of D(T ) onto K not decreasing the norm. It follows that the linear map
(T + 1)−1 : K −→D(T )
is continuous.
Let pK and pK⊥be the projections H →K and H →K⊥and deﬁne
a = pK(T + 1)−1 ∈B(K),
b = pK⊥(T + 1)−1 ∈B(K, K⊥).
Take an arbitrary ζ ∈K and let (T + 1)−1ζ = ξ. Writing both sides in the decomposition
H = K ⊕K⊥we have

aζ
bζ
 
=

ξ1
ξ2
 
,
since in this notation ζ = 2 ζ
0
3, we have
⟨ζ aζ⟩= ⟨ζ ξ1⟩=

ζ
0
 
ξ1
0
 
=

ζ
0
 
ξ1
ξ2
 
= ⟨ζ ξ⟩= ⟨(T + 1)ξ ξ⟩= ⟨ξ (T + 1)ξ⟩
= ∥ξ∥2 + ⟨ξ T ξ⟩≥∥ξ∥2 = ∥aζ∥2 + ∥bζ∥2,
because T is symmetric. In other words, we obtain a ≥a∗a + b∗b = a2 + b∗b which can
also be written as
a(1K −a) ≥b∗b.
(11.16)
Now let T be a positive and self-adjoint extension of T . Then (T + 1) ⊂(T + 1), and
it easily follows that
(T + 1)−1
K = (T + 1)−1.

11
160
Chapter 11 • Self-Adjoint Extensions of Symmetric Operators
In particular the matrix of the operator (T + 1)−1 corresponding to the decomposition H =
K ⊕K⊥must be of the form
(T + 1)−1 =

a b∗
b c
 
(11.17)
(b∗in the upper right corner is a consequence of self-adjointness of (T + 1)−1). Moreover,
since (T + 1)−1 is a positive contraction, we have
0 ≤

a b∗
b c
 
≤1,
so by Corollary 11.12
b(a + ε1K)−1b∗≤c ≤1K⊥−b(1K −a + ε1K)−1b∗
(11.18)
for all ε > 0. In particular, for T to have a positive self-adjoint extension T it is necessary
that
b(a + ε1K)−1b∗≤1K⊥−b(1K −a + ε1K)−1b∗,
ε > 0.
(11.19)
Fix ε > 0. The inequality in (11.19) is equivalent to
b

(a + ε1K)−1 + (1K −a + ε1K)−1	
b∗≤1K⊥.
(11.20)
Also, we have (a + ε1K)−1 + (1K −a + ε1K)−1 = f (a), where f (t) =
1
t+ε +
1
1−t+ε for
all t ∈[0, 1]. Moreover, since
f (t) =
1+2ε
(t+ε)(1−t+ε),
we can rewrite (11.20) as
(1 + 2ε)b

(a + ε1K)−1(1K −a + ε1K)−1	
b∗≤1K⊥
or, putting d = (a + ε1K)−1
2 (1K −a + ε1K)−1
2 , as
(1 + 2ε)bd∗db∗≤1K⊥.
(11.21)
To prove that (11.21) holds, we note ﬁrst that (11.16) is simply F(a) ≥b∗b, where
F(t) = t(1 −t) is a continuous function on [0, 1] of norm 1
4. Therefore b∗b ≤1
41K (see
Proposition 3.5) and consequently
1K ≥4b∗b ≥2b∗b.
(11.22)

11.3 · Krein and Friedrichs Extensions
161
11
Now, using (11.22), we compute
(a + ε1K)(1K −a + ε1K) = a(1K −a) + ε(1K −a) + ε21K
≥a(1K −a) + (ε + ε2)1K
≥b∗b + (ε + ε2)1K
≥b∗b + (ε + ε2)2b∗b
= (1 + 2ε)b∗b + ε2b∗b ≥(1 + 2ε)b∗b,
which can then be successively rewritten as d−1d∗−1 ≥(1 + 2ε)b∗b and then as 1K ≥
(1 + 2ε)db∗bd∗. This, in turn, means that
(1 + 2ε)db∗bd∗ ≤1. Thus
1 ≥(1 + 2ε)∥bd∗∥2 = (1 + 2ε)∥db∗∥2 = (1 + 2ε)∥bd∗db∗∥
which implies (11.21), and we have proved (11.19).
Now we notice that as ε ↘0, the left hand side of (11.19) is monotonically increasing,
while the right hand side is monotonically decreasing. Thus, by Theorem 3.15, the left hand
side has a supremum in and he right hand side an inﬁmum in B(K⊥) which are the limits of
either side in strong topology as ε ↘0. Deﬁne
cF = sup
ε>0
b(a + ε1K)−1b∗,
cK = inf
ε>0 1K⊥−b(1K −a + ε1K)−1b∗.
Then c ∈B(K⊥) satisﬁes (11.18) for all ε > 0 if and only if
cF ≤c ≤cK.
(11.23)
We will now show that the mapping T 	→c is an order reversing bijection between the
set of positive self-adjoint extensions of T and the set of c ∈B(K⊥) satisfying (11.23). We
already know that any positive self-adjoint extension T of T deﬁnes c satisfying (11.23) via
(11.17). Furthermore, if T and T ′ are positive self-adjoint extensions of T and c and c′ are
the corresponding operators on K⊥then

T ≥T ′ 
⇐⇒

(T + 1)−1 ≤(T ′ + 1)−1 
⇐⇒
 
a b∗
b c
 
≤

a b∗
b c′
 
⇐⇒
 
0
0
0 c′ −c
 
≥0

⇐⇒

c′ ≥c

.

11
162
Chapter 11 • Self-Adjoint Extensions of Symmetric Operators
Finally, if c ∈B(K⊥) satisﬁes (11.23) then
0 ≤

a b∗
b c
 
≤1
(by Corollary 11.12). Also, the range of
2 a b∗
b c
3
is dense in H, because

a b∗
b c
 
H =

a b∗
b c
 
(K ⊕K⊥) ⊃

a b∗
b c
 

K ⊕{0}	
=
0
aζ
bζ
 
ζ ∈K
1
= (T + 1)−1H = D(T ).
Hence ker
2 a b∗
b c
3
= {0}, and consequently
2 a b∗
b c
3−1 is a closed densely deﬁned operator.
Moreover, it is self-adjoint and positive. In fact it satisﬁes

a b∗
b c
 −1
≥1.
In particular
T =

a b∗
b c
 −1
−1
is positive and self-adjoint. Clearly T is an extension of T .
Let TK and TF be the positive self-adjoint extensions of T corresponding to c = cK and
c = cF respectively:
(TK + 1)−1 =

a b∗
b cK
 
,
(TF + 1)−1 =

a b∗
b cF
 
Then any positive self-adjoint extension T of T must satisfy
TK ≤T ≤TF
(11.24)
and any positive self-adjoint operator T satisfying (11.24) is an extension of T .
⊓⊔
Theorem 11.13 shows that any positive operator has self-adjoint extensions and that
among those which are positive there is a minimal and a maximal one (in the sense of
the partial order on positive operators). The extensions TK and TF are called respectively
the Krein extension and the Friedrichs extension of the positive operator T .

11.3 · Krein and Friedrichs Extensions
163
11
Notes
The reader will ﬁnd further information on self-adjoint extensions of symmetric
operators in [AkGl, Chapter VII], [Mau, Chapter V], [ReSi1, Chapter VIII], [ReSi2,
Chapter X]. The Krein and Friedrichs extensions are usually presented in the context
of quadratic forms on Hilbert spaces. This approach is taken e.g. in [Kat, Chapter 6],
[ReSi2, Chapter X]. The version of the theory presented above is less popular, but
requires fewer preliminary results and can be carried out using exclusively bounded
operators.

165
12
One-Parameter Groups of Unitary
Operators
© Springer Nature Switzerland AG 2018
P. Sołtan, A Primer on Hilbert Space Operators, Compact Textbooks in Mathematics,
https://doi.org/10.1007/978-3-319-92061-0_12
One of particularly fruitful applications of the theory of operators on Hilbert spaces
is in representation theory of topological groups. In this chapter we will study basic
properties of representation theory of the abelian group R.
A family (ut)t∈R of operators on H is called a strongly continuous one-parameter
group of unitary operators if
(1)
for any t ∈R the operator ut is unitary,
(2)
for all t, s ∈R we have ut+s = utus,
(3)
for any vector ψ ∈H the map
R ∋t 	−→utψ ∈H
(12.1)
is continuous.
In view of (2) condition (3) is equivalent to the fact that for any ψ ∈H the mapping
(12.1) is continuous at 0 ∈R.
Consider the following example: let H be a self-adjoint operator on H and put
ut = exp(−itH). It is easy to see that conditions (1) and (2) are satisﬁed. Condition (3)
follows from continuity of Borel functional calculus, because as t →0, the functions
λ 	→exp(−itλ) converge pointwise to the constant function 1 (and are all uniformly
bounded). It follows that (ut)t∈R is a strongly continuous one-parameter group of unitary
operators.
In order to shorten our notation we will from now on write e−itH instead of
exp(−itH).

12
166
Chapter 12 • One-Parameter Groups of Unitary Operators
12.1 Stone’s Theorem
Theorem 12.1
Let H be a self-adjoint operator on H and for t ∈R let ut = e−itH . Then
(1)
if ψ ∈D(H) then lim
t→0
i
t (utψ −ψ) = Hψ,
(2)
if the limit lim
t→0
i
t (utϕ −ϕ) exists then ϕ ∈D(H).
Proof
Ad (1). Take ψ ∈D(H). Then ψ = (1 + H 2)−1
2 ξ for some ξ ∈H and we have
i
t (utψ −ψ) = Ft(H)ξ,
where
Ft(λ) = i
t
e−itλ−1
λ
λ(1 + λ2)−1
2 .
The functions Ft are uniformly bounded and they converge pointwise to ζ (deﬁned at the
beginning of ▷Sect. 10.1), as t →0. Thus
lim
t→0
i
t (utψ −ψ) = zHξ = Hψ.
Ad (2). Let us deﬁne an operator 
H putting
D( 
H) =

ϕ ∈H the limit lim
t→0
i
t (utϕ −ϕ) exists

and for ϕ ∈D( 
H)

Hϕ = lim
t→0
i
t (utϕ −ϕ).
It is clear that 
H is a linear operator. Moreover H
⊂

H, so 
H is densely deﬁned.
Furthermore, for ϕ1, ϕ2 ∈D( 
H) the calculation

ϕ1 
Hϕ2

= lim
t→0

ϕ1 i
t (utϕ2 −ϕ2)

= lim
t→0
 
ϕ1 i
t utϕ2

−

ϕ1 i
t ϕ2
 	
= lim
t→0
 
−i
t ut ∗ϕ1 ϕ2

−

−i
t ϕ1 ϕ2
 	
= lim
t→0
 
−i
t u−tϕ1 ϕ2

−

−i
t ϕ1 ϕ2
 	
= lim
t→0

i
−t (u−tϕ1 −ϕ1) ϕ2

=  
Hϕ1 ϕ2


12.1 · Stone’s Theorem
167
12
shows that 
H is symmetric. By Remark 8.9 we have 
H = H.
⊓⊔
We can draw the following conclusion from Theorem 12.1: let H be a self-adjoint
operator and let ψ0 ∈D(H). Then the initial value problem
i d
dt = H,
(0) = ψ0
(12.2)
(with unknown function  : R →H) has a global solution. Indeed: deﬁning (t) =
e−itH ψ0 we obtain a continuous function  : R →H such that
▬(0) = ψ0,
▬ is differentiable at 0,
▬i d
dt

t=0 = Hψ0.
Moreover, for any t ∈R we have1
1
s

(t + s) −(t)
	
= e−itH 1
s

(s) −(0)
	
−−→
s→0 e−itH Hψ0
= He−itH ψ0
= H(t)
which means that  is differentiable everywhere and is the solution of the initial value
problem (12.2).
Furthermore, the solution of the problem (12.2) is unique. Indeed: if  : R →H is
a solution then putting f (t) =
(t) −(t)
2 we obtain a differentiable scalar-valued
function such that f (0) = 0 and
d
dt f (t) = d
dt ⟨(t) −(t) (t) −(t)⟩
= ⟨−iH(t) −iH(t) (t) −(t)⟩
+ ⟨(t) −(t) −iH(t) −iH(t)⟩= 0.
Thus (t) = (t) for all t. A similar reasoning is used in the prof of the next theorem.
Theorem 12.2 (Stone’s Theorem)
Let (ut)t∈R be a strongly continuous one-parameter group of unitary operators on H.
Then there exits a self-adjoint operator H on H such that ut = e−itH .
1Application of (10.9) to f (λ) = λ and g(λ) = e−itλ yields e−itH H
⊂He−itH . Moreover, using
Theorem 12.1(2) one can easily show that for any s we have e−isH 
D(H)
	
⊂D(H). It follows that
D

He−itH 	
= eitH D(H) = D(H), and consequently e−itH H = He−itH .

12
168
Chapter 12 • One-Parameter Groups of Unitary Operators
Proof
For ϕ ∈H and f ∈C∞
c (R) (smooth functions with compact support) deﬁne
ϕf =

R
f (t)utϕ dt
and let D = span

ϕf
ϕ ∈H, f ∈C∞
c (R)

. Now if (fn)n∈N is a sequence of smooth
functions of compact support such that for any n
▬supp fn ⊂
2
−1
n, 1
n
3
,
▬

R
fn(t)
 dt = 1
then for any ϕ ∈H
∥ϕfn −ϕ∥=


R
fn(t)utϕ dt −

R
fn(t)ϕ dt

=


R
fn(t)(utϕ −ϕ) dt

≤

R
fn(t)
∥utϕ −ϕ∥dt ≤sup
|t|≤1
n
∥utϕ −ϕ∥−−−→
n→∞0.
It follows that D is a dense subspace of H.
Note that if f ∈C∞
c (R) and we denote by fs the function t 	→f (t −s) then
usϕf = us

R
f (t)utϕ dt =

R
f (t)usutϕ dt
=

R
f (t)us+tϕ dt =

R
f (t −s)utϕ dt = ϕfs
which shows that the operators us preserve the subspace D. Furthermore, for ϕf ∈D we
have
1
s (usϕf −ϕf ) = 1
s
 
R
f (t −s)utϕ dt −

R
f (t)utϕ dt

=

R
f (t−s)−f (t)
s
utϕ dt −−→
s→0

R

−f ′(t)
	
utϕ dt = −ϕf ′,
because fs−f
s
−−→
s→0 −f ′ uniformly.
Deﬁne a linear operator H0 on H putting D(H0) = D and
H0φ = i lim
s→0
1
s (usφ −φ),
φ ∈D.
Notice that the range of H0 is contained in D and for any t ∈R we have H0ut = utH0.

12.1 · Stone’s Theorem
169
12
Now in the same way as in the proof of Theorem 12.1(2) we show that the operator H0
is symmetric: for φ, ψ ∈D we have
⟨ψ H0φ⟩= lim
s→0
i
s ⟨ψ usφ −φ⟩= lim
s→0
i
s ⟨ψ (us −1)φ⟩
= lim
s→0
−i
−s ⟨(u−s −1)ψ φ⟩= −i ⟨iH0ψ φ⟩= ⟨H0ψ φ⟩.
We will now show that H0 is essentially self-adjoint, i.e. H0 is self-adjoint. For this we
need to prove that ker(H0∗± i1) = {0} (see Corollary 11.7). Take η ∈ker(H0∗± i1). Then
for any φ ∈D(H0) we have
d
dt ⟨η utφ⟩= lim
s→0

η 1
s (ut+s −ut)φ

= lim
s→0

η ut 1
s (us −1)φ

= ⟨η ut(−i)H0φ⟩= −i ⟨η H0utφ⟩
= −i H0∗η utφ = −i ⟨∓iη utφ⟩= ± ⟨η utψ⟩.
(12.3)
This means that the scalar-valued function g : t 	→⟨η utφ⟩satisﬁes g′ = ±g, so that
g(t) = g(0)e±t,
t ∈R.
On the other hand
g(t)
 ≤∥η∥∥utφ∥= ∥η∥∥φ∥, so g must be constant and hence equal to
0. In particular
⟨η φ⟩= g(0) = 0.
Since this holds for all φ ∈D and D is dense in H, we obtain η = 0.
Put H = H0. Then H is a self-adjoint operator and we can consider the one-parameter
group

e−itH 	
t∈R. Take φ ∈D and let
ξ(t) = utφ −e−itH φ,
t ∈R.
Then for any t we have ξ(t) ∈D ⊂D(H) and a computation analogous to (12.3) shows that
d
dt ξ(t) = −iH0utφ + iHe−itH φ = −iHξ(t),
t ∈R.
Consequently
d
dt
ξ(t)
2 = d
dt ⟨ξ(t) ξ(t)⟩=  d
dt ξ(t) ξ(t) + ξ(t)
d
dt ξ(t)
= ⟨−iHξ(t) ξ(t)⟩+ ⟨ξ(t) −iHξ(t)⟩= 0

12
170
Chapter 12 • One-Parameter Groups of Unitary Operators
and hence the function t 	→
ξ(t)
 is constant. On the other hand ξ(0) = 0, so we get
ξ(t) = 0 for all t, i.e.
utφ = e−itH φ,
t ∈R, φ ∈D.
Now the density of D in H implies that ut = e−itH for all t ∈R.
⊓⊔
Let (ut)t∈R be a strongly continuous one-parameter group of unitary operators on
H. The self-adjoint operator H such that ut = e−itH for all t is obviously unique and
we call it the inﬁnitesimal generator of the group (ut)t∈R.
12.2 Trotter Formula
Let H be a self-adjoint operator. Recall that D(H) is a Hilbert space with the graph
norm:
∥ψ∥H =
-
∥ψ∥2 + ∥Hψ∥2,
ψ ∈D(H).
We also know that for any ξ ∈H the function R ∋t 	→e−itH ξ ∈H is continuous and
if ψ ∈D(H) then for any t
e−itH ψ ∈D(H)
and the function R ∋t 	→e−itH ψ ∈D(H) is continuous for the norm ∥· ∥H . Indeed: it
is enough to show continuity at zero (cf. ▷Sect. 12.1) and this, in light of the fact that
He−itH = e−itH H, follows from the following computation
e−itH ψ−ψ
2
H =
e−itH ψ −ψ
2 +
He−itH ψ −ψ	2
=
e−itH ψ −ψ
2 +
e−itH Hψ −Hψ
2 −−→
t→0 0.
Theorem 12.3 (Trotter Formula)
Let H and K be self-adjoint operators and assume that H + K is self-adjoint. Then
for any t ∈R

e−i t
n H e−i t
n K	n −−−→
n→∞e−it(H+K)
in strong topology.

12.2 · Trotter Formula
171
12
Proof
For t ̸= 0 let
F(t) = 1
t

e−itH e−itK −e−it(H+K)	
.
Now for any ξ ∈H the function t 	→F(t)ξ is continuous on RK{0}, because the maps
1 : t 	−→1
t e−it(H+K)ξ
and
2 : t 	−→1
t e−itKξ
are continuous and we have
1
t e−itH e−itKξ = e−itH 2(t).
Therefore for t, t′ ∈RK{0}
 1
t e−itH e−itKξ −1
t e−it′H e−it′Kξ

=
e−itH 2(t) −e−it′H 2(t′)

≤
e−itH 2(t) −e−itH 2(t′)
 +
e−itH 2(t′) −e−it′H 2(t′)

=
2(t) −2(t′)
 +
e−i(t−t′)H 2(t′) −2(t′)
 −−→
t→t′ 0.
It is moreover clear that
lim
t→±∞F(t)ξ = 0.
Let us denote the domain D(H + K) = D(H) ∩D(K) by D. We will check that for
ψ ∈D we also have
lim
t→0 F(t)ψ = 0.
Indeed: we have
F(t)ψ = 1
t

e−itH e−itKψ −ψ
	
−1
t

e−it(H+K)ψ −ψ
	
= e−itH 1
t
e−itKψ −ψ	 + 1
t
e−itH ψ −ψ	 −1
t
e−it(H+K)ψ −ψ	
and since
lim
t→0
1
t
e−it(H+K)ψ −ψ	 = −i(H + K)ψ,
lim
t→0
1
t

e−itH ψ −ψ
	
= −iHψ,
lim
t→0
1
t

e−itKψ −ψ
	
= −iKψ,

12
172
Chapter 12 • One-Parameter Groups of Unitary Operators
we ﬁnd that
lim
t→0 F(t)ψ = −iHψ −iKψ −

−i(H + K)
	
ψ = 0.
In particular for ψ ∈D w can put F(0)ψ = 0 and this way we obtain a family F(t)	
t∈R of
linear maps D →H such that the function t 	→F(t)ψ is continuous. Moreover
lim
t→0 F(t)ψ =
lim
t→±∞F(t)ψ = 0.
(12.4)
Consider on D the norm ∥·∥H+K in which this space is a Hilbert space. Since ∥·∥H+K ≥
∥· ∥, we see that all operators F(t) are continuous from D (with the norm ∥· ∥H+K) to H. It
follows from continuity of t 	→F(t)ψ and (12.4) that for any ψ ∈D the set
F(t)ψ t ∈R
is bounded. Therefore, by the Banach-Steinhaus theorem, there exists a constant M such
that
F(t)
 ≤M for all t ∈R, where by
F(t)
 we mean the norm of an operator

D, ∥· ∥H+K
	
→H. In other words, for any ψ ∈D and t ∈R we have
F(t)ψ
 ≤M∥ψ∥H+K.
Fix a ψ ∈D and let
C =

e−is(H+K)ψ s ∈[−1, 1]

.
As we explained before formulating the theorem, the function
s 	−→e−is(H+K)ψ
is continuous R →

D, ∥· ∥H+K
	
and hence C is compact in

D, ∥· ∥H+K
	
.
Take now ε > 0 and let φ1, . . . , φN be an
ε
2M -net in C. For any η ∈C there exists i such
that ∥η −φi∥H+K <
ε
2M . Furthermore, there exists δ > 0 such that for |t| < δ we have
F(t)φj
 < ε
2,
j = 1, . . . , N,
and therefore
F(t)η
 ≤
F(t)η −F(t)φi
 +
F(t)φi
 ≤M∥η −φi∥H+K +
F(t)φi
 < ε
which shows that the functions

ψ 	→F(t)ψ
	
t∈[−1,1] converge to zero uniformly on C, as
t →0.
In other words, for a ﬁxed ψ ∈D the quantity
F(t)e−is(H+K)ψ


12.2 · Trotter Formula
173
12
tends to 0, as t →0, uniformly in s ∈[−1, 1].
Now the identity

e−i t
n H e−i t
n K	nψ −e−it(H+K)ψ
=


e−i t
n H e−i t
n K	n −

e−i t
n (H+K)	n
ψ
=
n−1

m=0
e−i t
n H e−i t
n K	ne−i t
n H e−i t
n K −e−i t
n (H+K)	e−i t
n (H+K)	n−1−mψ
implies that

e−i t
n H e−i t
n K	nψ −e−it(H+K)ψ

≤n
max
0≤m≤n−1

e−i t
n H e−i t
n K −e−i t
n (H+K)	
e−i t(n−1−m)
n
(H+K)ψ

= |t|
max
0≤m≤n−1
F t
n
	e−i t(n−1−m)
n
(H+K)ψ

≤|t| max
|s|<|t|
F
 t
n
	
e−is(H+K)ψ
 −−−→
n→∞0
which shows that

e−i t
n H e−i t
n K	nψ −−−→
n→∞e−it(H+K)ψ
(12.5)
for ψ ∈D. Since

e−i t
n H e−i t
n K	nψ
 = 1 for all n, it follows that we have (12.5) for all
ψ ∈H.
⊓⊔
Notes
Stone’s theorem and Trotter formula are standard tools of the theory of operators on
Hilbert spaces often applied e.g. in mathematical physics, but also in theory of group
representation and many other branches of mathematics. These applications and their
far reaching generalizations can be found, among others, in [Kat, Chapter 9], [Mau,
Chapter X], [ReSi1, Chapter VIII], [ReSi2, Chapter X].

175
Appendix A
© Springer Nature Switzerland AG 2018
P. Sołtan, A Primer on Hilbert Space Operators, Compact Textbooks in Mathematics,
https://doi.org/10.1007/978-3-319-92061-0
A.1
Banach-Steinhaus Theorem
Theorem A.1
Let X be a Banach space and Y a normed space. Let T ⊂B(X, Y) be a family of
operators such that for each x ∈X the set

T x T ∈T
 is bounded. Then there exists
a constant M > 0 such that for any T ∈T we have ∥T ∥≤M.
Proof
For x ∈X let us denote
M(x) = sup

∥T x∥T ∈T

.
Suppose that sup

∥T ∥T ∈T

= +∞. Then there exists a sequence (Tn)n∈N of elements
of T and a sequence (yn)n∈N of unit vectors in X such that
∥Tnyn∥> 4n,
n ∈N.
Putting xn =
1
2n yn we obtain a sequence (xn)n∈N converging to zero and such that for all n
we have ∥Tnxn∥> 2n.
We will now choose a strictly increasing sequence of natural numbers (nk)k∈N so that for
all k ∈N
⎧
⎪⎪⎨
⎪⎪⎩
∥Tnk+1xnk+1∥> 1 + k +
k
j=1
M(xnj ),
∥xnk+1∥<
1
2k+1

max

∥Tnj ∥j = 1, . . . , k
−1
.

176
APPENDIX A
We put n1 = 1 and once n1, . . . , np have been chosen, we use the facts that xn −−−→
n→∞0 and
∥Tnxn∥−−−→
n→∞+∞to choose np+1 in such a way that np+1 > np and
⎧
⎪⎪⎨
⎪⎪⎩
∥Tnp+1xnp+1∥> 1 + p +
p
j=1
M(xnj ),
∥xnp+1∥<
1
2p+1

max ∥Tnj ∥j = 1, . . . , p−1
.
In particular, since ∥Tnyn∥> 4n, we have ∥Tn∥≥4n for all n, and hence
max

∥Tnj ∥j = 1, . . . , k

> 1.
Consequently for any j
∥xnj ∥< 1
2j

max

∥Tns ∥s = 1, . . . , j −1
−1
< 1
2j .
It follows that
∞

j=1
∥xnj ∥< +∞, so that the series
∞

j=1
xnj converges to some x ∈X.
Now we have
∥Tnk+1x∥=

∞

j=1
Tnk+1xnj
 =

k

j=1
Tnk+1xnj + Tnk+1xnk+1 +
∞

j=k+2
Tnk+1xnj

=
Tnk+1xnk+1 −

−
k

j=1
Tnk+1xnj −
∞

j=k+2
Tnk+1xnj

≥∥Tnk+1xnk+1∥−

k

j=1
Tnk+1xnj +
∞

j=k+2
Tnk+1xnj

> 1 + k +
k

j=1
M(xj) −

k

j=1
Tnk+1xnj +
∞

j=k+2
Tnk+1xnj

≥1 + k +
k

j=1
M(xj) −

k

j=1
Tnk+1xnj
 −

∞

j=k+2
Tnk+1xnj

≥1 + k +
k

j=1
M(xj) −
k

j=1
∥Tnk+1xnj ∥−
∞

j=k+2
∥Tnk+1∥∥xnj ∥.
The last sum on the right hand side is smaller than
∞

j=k+2
1
2j < 1, because for j ≥k + 2 we
have
∥xnj ∥< 1
2j

max

∥Tnj ∥j = 1, . . . , j −1
−1
≤1
2j
1
∥Tnk+1∥.

APPENDIX A
177
Furthermore the sum
k
j=1
∥Tnk+1xnj ∥is majorized by
k
j=1
M(xj). This shows that ∥Tnk+1x∥>
k, which contradicts boundedness of the set

T x T ∈T

and consequently shows that
sup

∥T ∥T ∈T

< +∞.
⊓⊔
A.2
Dynkin’s Theorem
Let  be a set. A family P of subsets of  is called a π-system if it is closed under ﬁnite
intersections. Furthermore, a family L of subsets of  is a λ-system if the following
conditions are satisﬁed:
1.
 ∈L,
2.
if  ∈L then ∁∈L,
3.
if (n)n∈N is a sequence of pairwise disjoint elements of L then
∞

n=1
n ∈L.
Theorem A.2 (Dynkin’s Theorem on π- and λ-Systems)
Let P be a π-system and L a λ-system of subsets of some set . Assume that P ⊂L.
Then the σ-algebra generated by P is contained in L.
ⓘRemark A.3 Before proving Theorem A.2 let us note that a λ-system is a σ-algebra if
and only if it is also a π-system. Indeed: on one hand, if L is a σ-algebra, then it is a
π-system. On the other hand, if L is a λ-system and a π-system at the same time then
for any sequence (n)n∈N of elements of L the sets
n = n K
 n−1
9
k=1
k

= n ∩(1 ∩· · · ∩n−1)∁
also belong to L. Moreover (n)n∈N are pairwise disjoint and
∞
9
n=1
n =
∞
9
n=1
n ∈L.
This shows that L is closed under arbitrary countable unions of its elements, i.e. it is a
σ-algebra.
Proof of Theorem A.2
Denote by λ(P) the smallest λ-system containing the family P and by σ(P) the smallest
σ-algebra containing P. Clearly λ(P) ⊂σ(P). We will show that
λ(P) = σ(P),
(A.1)
and hence we will have σ(P) ⊂L, because λ(P) ⊂L.

178
APPENDIX A
To prove (A.1) one needs to show that λ(P) is a σ-algebra. In view of Remark A.3 we
have see that λ(P) is a π-system (is closed under intersections).
Fix  ∈λ(P) and let
L =

 ⊂  ∩ ∈λ(P)

.
We will check that L is a λ-system:
(1)
we have  ∩ =  ∈λ(P), and so  ∈L,
(2)
if  ∈L then
∁∩ = ∁∪∁	 ∩ = ( ∩)∁∩
=

( ∩) ∪∁	∁∈λ(P),
because  ∩ and ∁are disjoint elements of λ(P),
(3)
if (n)n∈N is a sequence of pairwise disjoint elements of L then
 ∞
9
n=1
n

∩ =
∞
9
n=1
(n ∩) ∈λ(P),
as the latter is a countable union of disjoint elements of λ(P).
Now since P is closed under ﬁnite intersections, for any  ∈P we have P ⊂L, and
as L is a λ-system, we also have λ(P) ⊂L. In other words, for  ∈λ(P) and  ∈P we
have  ∩ ∈λ(P).
This, in turn, means that P ⊂L for any  ∈λ(P) and consequently
λ(P) ⊂L.
(A.2)
Now we notice that (A.2) says that λ(P) is a family closed under ﬁnite intersections.
⊓⊔
A.3
Tensor Product of Hilbert Spaces
Let H and K be Hilbert spaces. Their tensor product as vector spaces will be denoted
by H ⊗alg K. We will prove that there exists a scalar product on H ⊗alg K such that
⟨ψ1 ⊗ϕ1 ψ2 ⊗ϕ2⟩= ⟨ψ1 ψ2⟩⟨ϕ1 ϕ2⟩,
ψ1, ψ2 ∈H, ϕ1, ϕ2 ∈K.
Fix ψ1 ∈H and ϕ1 ∈K and consider the mapping
H × K ∋(ψ2, ϕ2) 	−→⟨ψ1 ψ2⟩⟨ϕ1 ϕ2⟩.

APPENDIX A
179
It is a bi-linear functional, and so it determines a unique linear functional ψ1,ϕ1 on
H ⊗alg K. Let E be the space of anti-linear functionals on H ⊗alg K. Then the map
H × K ∋(ψ1, ϕ1) 	−→ψ1,ϕ1 ∈E
is bi-linear and consequently it deﬁnes a linear  : H ⊗alg K →E such that

(ψ1 ⊗ϕ1)
	
(ψ2 ⊗ϕ2) = ψ1,ϕ1(ψ2 ⊗ϕ2)
= ⟨ψ1 ψ2⟩⟨ϕ1 ϕ2⟩= ⟨ψ2 ψ1⟩⟨ϕ2 ϕ1⟩.
Now for ξ,η ∈H ⊗alg K let us put
⟨ξ η⟩= (ξ)(η) = (ξ)(η).
(A.3)
It is clear that ⟨· ·⟩is a sesquilinear from. Moreover, taking ξ = ψ1⊗ϕ1 and η = ψ2⊗ϕ2
we obtain
⟨ψ1 ⊗ϕ1 ψ2 ⊗ϕ2⟩= ⟨ψ1 ψ2⟩⟨ϕ1 ϕ2⟩,
ψ1, ψ2 ∈H, ϕ1, ϕ2 ∈K.
Now if
ξ =
N

i=1
ξ 1
i ⊗ξ 2
i ,
η =
M

j=1
η1
j ⊗η2
j,
then
⟨ξ η⟩= (ξ)(η) = 

N

i=1
ξ 1
i ⊗ξ 2
i
 M

j=1
η1
j ⊗η2
j

=
N

i=1
M

j=1
(ξ 1
i ⊗ξ 2
i )(η1
j ⊗η2
j)
=
N

i=1
M

j=1

η1
j ξ 1
i
 
η2
j ξ 2
i

=
N

i=1
M

j=1

ξ 1
i η1
j
 
ξ 2
i η2
j

.
This immediately shows that
⟨η ξ⟩= ⟨ξ η⟩,
ξ,η ∈H ⊗alg K.

180
APPENDIX A
Furthermore, for
ξ =
N

i=1
ξ 1
i ⊗ξ 2
i
we can always assume that the vectors ξ 2
1 , . . . , ξ 2
N are orthonormal (by applying the
Gram-Schmidt orthogonalization process), so if ξ ̸= 0 then
⟨ξ ξ⟩=
N

i=1
∥ξ i
1∥2 > 0.
This means that (A.3) deﬁnes a scalar product on H ⊗alg K. Moreover, it is clear that the
condition
⟨ψ1 ⊗ϕ1 ψ2 ⊗ϕ2⟩= ⟨ψ1 ψ2⟩⟨ϕ1 ϕ2⟩,
ψ1, ψ2 ∈H, ϕ1, ϕ2 ∈K
determines this scalar product uniquely.
This way H ⊗alg K becomes a normed space and we will denote by H ⊗K its
completion. Clearly H ⊗K is a Hilbert space and we call it the tensor product of the
Hilbert spaces H and K.
Let {ψi}i∈I and {ϕj}j∈J be orthonormal bases in H and K respectively. Then the
system
{ψi ⊗ϕj}i∈I, j∈J
is orthonormal and it spans a dense subspace of H ⊗K. It follows that it is an
orthonormal basis of H ⊗K.
Let (, μ) and (,ν) be σ-ﬁnite measure spaces such that the Hilbert spaces H =
L2(, μ) and K = L2(, ν) are separable. Choose orthonormal bases {ψi}i∈N and
{ϕj}j∈N of H and K. Then the system of functions
 ×  ∋(ω, λ) 	−→ψi(ω)ϕj(λ),
i, j ∈N
(A.4)
is orthonormal in L2( × , μ ⊗ν). We will show that it forms an orthonormal basis
of this space. Take f ∈L2( × , μ ⊗ν) and suppose that

×
f (ω, λ)ψi(ω)ϕj(λ) dμ(ω)dν(λ) = 0
for all i and j. Notice that since |f |2 is integrable over  × , the function f (ω, ·)
belongs to L2(, ν) for almost all λ. Therefore we can write
0 =


 

f (ω, λ)ψi(ω)dμ(ω)

ϕj(λ) dν(λ) =


⟨f (·, λ) ψi⟩ϕj(λ) dν(λ).

APPENDIX A
181
Since this holds for all j, the function λ 	→⟨f (·, λ) ψi⟩is equal to zero almost
everywhere, i.e. on Ki for some i of measure zero. This means that for λ ∈
K
 ∞

i=1
i

the function f (·, λ) is zero almost everywhere on . Consequently f
is equal to zero almost everywhere on  × .
Since

ψi ⊗ϕj}i,j∈N is an orthonormal basis of H ⊗K and (A.4) is an orthonormal
basis of L2( × , μ ⊗ν), we can deﬁne an operator
u : L2(, μ) ⊗L2(, ν) −→L2( × , μ ⊗ν)
mapping each ψi ⊗ϕj to the function
 ×  ∋(ω, λ) 	−→ψi(ω)ϕj(λ) ∈C.
As u maps an orthonormal basis onto an orthonormal basis, it is unitary. This proves the
following:
Proposition A.4 Let (, μ) and (, ν) be σ-ﬁnite measure spaces such that the Hilbert
spaces H = L2(, μ) and K = L2(, ν) are separable. Then the operator
L2(, μ) ⊗L2(, ν) −→L2( × , μ ⊗ν)
mapping ψ ⊗ϕ to the function
 ×  ∋(ω, λ) 	−→ψ(ω)ϕ(λ) ∈C
is unitary.
A.4
Open Mapping Theorem
In the formulation and proofs of all statements below we will use the convention of
Banach space theory according to which the closed unit ball in a Banach space X is
denoted by X1. Also the closed ball with center 0 and radius r in X will be denoted by
Xr.
Theorem A.5 (Open Mapping Theorem)
Let X and Y be Banach spaces and let T ∈B(X, Y) be surjective. Then T is an open
mapping.

182
APPENDIX A
Proof
We will show that T (X1) contains a neighborhood of 0 ∈Y. For any n ∈N deﬁne a new
norm ∥· ∥n on Y setting
∥y∥n = inf

∥u∥X + n∥v∥Y u ∈X, v ∈Y, y = v + T u

.
Furthermore let
Z = f : N →Y sup
n∈N
f (n)

n < +∞.
With the norm
∥f ∥Z = sup
n∈N
f (n)

n,
f ∈Z
the vector space Z becomes a Banach space.1
Deﬁne a sequence (Sn)n∈N of bounded operators from Y to Z:
(Sny)(m) =
⎧
⎨
⎩
y,
m = n,
0,
m ̸= n.
We have ∥Sny∥Z = ∥y∥n for all y ∈Y.
Take y ∈Y and n ∈N. Since y = y + T 0, we see that
∥y∥n ≤n∥y∥Y,
while by surjectivity of T we can choose x ∈X such that y = 0 + T x, and hence
∥y∥n ≤∥x∥X.
The latter estimate does not depend on n, so for any y the set {Sny n ∈N} is bounded in Z.
Thus, by the Banach-Steinhaus theorem, there exists a constant M > 0 such that ∥Sn∥≤M
for all n.
Now ﬁx δ ∈
3
0, 1
M
2
. We will show that T (X1) contains the open ball
BY(δ) =

y ∈Y ∥y∥Y < δ

.
Let y ∈BY(δ). Then for any n we have
∥y∥n = ∥Sny∥Z ≤M∥y∥Y < Mδ < 1.
1However, completeness of Z will not be relevant.

APPENDIX A
183
It follows that for any n there are un ∈X and vn ∈Y such that y = vn + T un and
∥un∥X + n∥vn∥Y < 1.
In particular ∥vn∥Y <
1
n, and consequently T un −−−→
n→∞
y. Moreover, for any n we have
∥un∥X < 1, so y ∈T (X1).
We now proceed to show that it follows from BY(δ) ⊂T (X1) that BY
 δ
2
	
⊂T (X1). Let
y ∈BY
 δ
2
	
. We know that y ∈T

X 1
2
	
, so there exists x1 ∈X 1
2 such that ∥y −T x1∥Y < δ
4.
Furthermore since y −T x1 ∈BY
 δ
4
	
, there exists x2 ∈X 1
4 such that
(y −T x1) −T x2

Y <
δ
8. Continuing this procedure we obtain a sequence (xn)n∈N such that for any n we have
∥xn∥X < 1
2n and
y −
n

k=1
T xk

Y
<
δ
2n+1 ,
n ∈N.
It follows that y =
∞

k=1
T xk = T
 ∞

k=1
xk

.
This way we proved that for any x0 ∈X the image of a closed ball with center x0 under
T contains an open ball with center T x0. It now easily follows that T is an open map.
⊓⊔
Corollary A.6 Let T ∈B(X, Y) be a bijection. Then the inverse of T is bounded.
Proof
The operator T is an open map, because it is surjective. It follows that T −1 is continuous. ⊓⊔
Corollary A.7 (Closed Graph Theorem) Let T : X →Y be a linear map such that the
graph of T , i.e. the set
G(T ) =
0
x
T x
 
x ∈X
1
is closed in X ⊕Y. Then T is bounded.
Proof
The closed subspace G(T ) ⊂X ⊕Y is a Banach space (e.g. with the norm
2 x
T x
3 =
max

∥x∥, ∥T x∥

, cf. ▷Sect. 8.1). Let PX and PY be the maps
PX : G(T ) ∋

x
T x
 
	−→x ∈X,
PY : G(T ) ∋

x
T x
 
	−→T x ∈X.

184
APPENDIX A
PX and PY are obviously continuous. Moreover PX is a bijection, and hence an invertible
operator: P −1
X
∈B

X, G(T )
	
. Therefore
T = PYP −1
X
is continuous.
⊓⊔
A.5
Quotient Spaces and Algebras
A.5.1 Quotients of Banach Spaces
Let X be a Banach space and let S be a closed subspace of X. The so called quotient
norm on the quotient vector space X/S is deﬁned as
∥x + S∥X/S = inf
u∈S ∥x + u∥X,
x ∈X.
Let us check that this expression does, in fact, deﬁne a norm:
▬obviously we have
α(x + S)

X/S = |α|∥x + S∥X/S,
▬for x, y ∈X
(x + S) + (y + S)

X/S = ∥x + y + S∥X/S
= inf
u∈S ∥x + y + u∥X = inf
u,v∈S ∥x + y + u + v∥X
≤inf
u,v∈S

∥x + u∥X + ∥y + v∥X
	
=

inf
u∈S ∥x + u∥X

+

inf
v∈S ∥y + v∥X

= ∥x + S∥X/S + ∥y + S∥X/S,
▬if ∥x + S∥X/S = 0 then for any n there exists un ∈S such that
x −(−un)

X = ∥x + un∥X ≤1
n,
so that it follows from closedness of S that x ∈S, i.e. x + S = 0.
Furthermore X/S with the norm deﬁned above is a Banach space. To prove this let
us ﬁrst notice that the quotient map
q : X −→X/S
is obviously a contraction. Now let (xn + S)n∈N be a Cauchy sequence in X/S. Choose
a subsequence (xnk)k∈N of (xn)n∈N such that
(xnk + S) −(xnk+1 + S)

X/S < 1
2k .
(A.5)

APPENDIX A
185
Then let us deﬁne a sequence (uk)k∈N of elements of S as follows: we put u1 = 0 and
choose u2 such that
∥xn1 −xn2 + u2∥X ≤∥xn1 −xn2 + S∥X/S + 1
2.
Next we select u3 such that
(xn2 + u2) −(xn3 + u3)

X ≤∥xn2 −xn3 + S∥X/S + 1
22
etc. The procedure yields (uk)k∈N such that
(xnk + uk) −(xnk+1 + uk+1)

X ≤∥xnk −xnk+1 + S∥X/S + 1
2k ,
k ∈N.
Now thanks to the estimate (A.5), we have
(xnk + uk) −(xnk+1 + uk+1)

X <
1
2k−1 ,
k ∈N,
so that (xnk + uk)k∈N is a Cauchy sequence in X (as the sequence of norms ∥xnk +
uk∥X
	
k∈N is summable). Let x0 be its limit. Then clearly xnk + S = q(xnk + uk) −−−→
k→∞
q(x0) = x0+S, because the map q is continuous. But (xn+S)n∈N is a Cauchy sequence,
so once we found it to have a convergent subsequence (with limit x0 + S), it also must
converge:
xn + S −−−→
n→∞x0 + S.
In particular X/S is a Banach space.
Theorem A.8
Let X and Y be Banach spaces and T ∈B(X, Y). Put S = ker T . Then the canonical
map T : X/S →Y making the diagram
X
q
B
B
B
B
B
B
B
B
T
 Y
X/S
T
}
}
}
}
}
}
}
}
commutative is bounded with ∥T ∥= ∥T ∥.

186
APPENDIX A
Proof
Take x ∈X and u ∈S. Then
∥T x∥Y =
T (x + u)

Y ≤∥T ∥∥x + u∥X,
and hence
∥T x∥Y ≤∥T ∥inf
u∈S ∥x + u∥X = ∥T ∥∥x + S∥X/S.
Of course T (x + S) = T (qx) = T x, so that ∥T ∥≤∥T ∥. On the other hand, for any ε > 0
there exists xε ∈X such that ∥xε∥X = 1 and ∥T x∥Y > ∥T ∥−ε. Thus we have
T (xε + S)

Y = ∥T xε∥Y > ∥T ∥−ε,
and also ∥xε + S∥X/S ≤∥xε∥X = 1. It follows that ∥T ∥≥∥T ∥.
⊓⊔
Let us note that the closed graph theorem can be used to show that if the range of T
in Theorem A.8 is additionally assumed to be closed then T is an isomorphism of X/S
onto T X (see Corollaries A.6 and A.7).
A.5.2 Ideals and Quotients of C∗-Algebras
Let A be a C∗-algebra. A left ideal in A is a subspace L ⊂A such that

y ∈L, x ∈A

⇒

xy ∈L

.
Similarly a subspace R ⊂A is a right ideal if

y ∈R, x ∈A

⇒

yx ∈R

.
It is easy to see that L is a left ideal if and only if the set
L∗= y∗y ∈L
is a right ideal. An ideal is two-sided if it is both a left ideal and a right one.2
2Generally, the terms “ideal” and “two-sided ideal” are used as synonyms.

APPENDIX A
187
Theorem A.9
Let A be a C∗-algebra with unit3and let L ⊂A be a left ideal (not necessarily closed).
Then there exists a net (ei)i∈I of elements of L such that
(1)
for any i ∈I we have 0 ≤ei ≤1,
(2)
i ≼j implies ei ≤ej,
(3)
for any a ∈L we have ∥a −aei∥−−→
i∈I 0.
Proof
Denote by I the set of pairs (n, F) such that n ∈N and F is a ﬁnite subset of L. We introduce
a partial order on I by declaring that (n, F) ≼(n′, F ′) whenever n ≤n′ and F ⊂F ′. For
i = (n, F) ∈I we put
vi =

b∈F
b∗b,
ei =
 1
n1 + vi
	−1vi.
In other words
ei = fn(vi),
where fn(t) =
t
1
n +t and since 0 ≤fn ≤1 for all n, we have 0 ≤ei ≤1.
Take i, j ∈I such that i = (n, F) ≼j = (n′, F ′). Then vi ≤vj, so that
 1
n + vi
	−1 ≥
 1
n + vj
	−1
(A.6)
by Proposition 4.25. On the other hand, since for all t ∈R+ we have
1
n
 1
n + t
	−1 ≥1
n′
 1
n′ + t
	−1,
also the inequality
1
n
 1
n + vj
	−1 ≥1
n′
 1
n′ + vj
	−1
(A.7)
must hold. Putting together (A.6) and (A.7) we obtain
1
n
 1
n + vi
	−1 ≥1
n
 1
n + vj
	−1 ≥1
n′
 1
n′ + vj
	−1,
3The assumption of A being unital is not crucial for this theorem (nor for any of the remaining results of this
section), but it makes the proof less cumbersome and Statement (1) easier to express.

188
APPENDIX A
and hence
1 −1
n
 1
n + vi
	−1 ≤1 −1
n′
 1
n′ + vj
	−1.
(A.8)
But
ei =
 1
n1 + vi
	−1vi =
 1
n1 + vi
	−1 1
n1 + vi −1
n1
	
= 1 −1
n
 1
n + vi
	−1
(A.9)
and similarly ej = 1 −1
n
 1
n + vj
	−1, so (A.8) means that ei ≤ej .
Finally let us take a ∈L and consider i = (n, F) such that a ∈F. Thanks to (A.9) we
have

b∈F

b(1 −ei)
	∗
b(1 −ei)
	
= (1 −ei)vi(1 −ei) = 1
n2
 1
n + vi
	−2vi ≤
1
4n1,
because
 1
n + t
	−2t ≤n
4 for all t ∈R+. Consequently

a(1 −ei)
	∗
a(1 −ei)
	
≤

b∈F

b(1 −ei)
	∗
b(1 −ei)
	
≤
1
4n1,
and this gives
∥a −aei∥2 =
a(1 −ei)	∗a(1 −ei)	 ≤1
4n.
It follows that ∥a −aei∥−−−→
n→∞0.
⊓⊔
The net (ei)i∈I constructed in Theorem A.9 is an example of an approximate unit
for the left ideal L.
Corollary A.10 Let J be a closed ideal in a unital C∗-algebra A. Then J is self-adjoint.
Proof
Let (ei)i∈I be an approximate unit for J. Then for any a ∈J we have
a = lim
i∈I aei.
Now, since the ideal J is two sided, for any i we have eia∗∈J and consequently
a∗= lim
i∈I eia∗
belongs to the closed subset J.
⊓⊔
Proposition A.11 Let J be a closed ideal in a unital C∗-algebra A. Then the quotient space
A/J with quotient norm is a C∗-algebra.

APPENDIX A
189
Proof
Since J is a self-adjoint subset (and a two-sided ideal), it is clear that the quotient space is a
unital ∗-algebra. Furthermore, as J is a closed subspace, the quotient space A/J is a Banach
space with the quotient norm
∥a + J∥= inf
u∈J ∥a + u∥,
a ∈A.
Moreover, the quotient norm satisﬁes
(a + J)(b + J)
 ≤∥a + J∥∥b + J∥,
a, b ∈A
and
∥a∗+ J∥= ∥a + J∥,
a ∈A.
The latter of these properties is obvious, while the former is a consequence of the fact that if
ε > 0 and u, v ∈J are such that
∥a + u∥≤∥a + J∥+ ε
and
∥b + v∥≤∥b + J∥+ ε
then
∥ab + J∥≤∥ab + av + ub + uv∥=
(a + u)(b + v)

≤∥a + u∥∥b + v∥≤∥a + J∥∥b + J∥+ ε

∥a + J∥+ ∥b + J∥+ ε
	
.
It remains to show that for any a ∈A we have the inequality ∥a + J∥2 ≤∥a∗a + J∥. Let
(ei)i∈I be an approximate unit for J. It is clear that
∥a + J∥≤∥a −aei∥,
i ∈I,
because aei ∈J, and hence
∥a + J∥≤inf
i∈I ∥a −aei∥.
On the other hand, for any u ∈J we have
∥a + u∥≥
(a + u)(1 −ei)
,
since ∥1 −ei∥≤1. Therefore
∥a + u∥≥lim inf
i∈I
(a + u)(1 −ei)
 = lim inf
i∈I
(a −aei) + (u −uei)

= lim inf
i∈I
(a −aei)
 ≥inf
i∈I
(a −aei)
,

190
APPENDIX A
where in the ﬁrst equality we used the fact that u −uei −−→
i∈I 0. As a result we get
∥a + J∥= inf
i∈I ∥a −aei∥,
a ∈A.
Using this we compute:
∥a + J∥2 = inf
i∈I
a(1 −ei)
2 = inf
i∈I
(1 −ei)a∗a(1 −ei)

≤inf
i∈I
a∗a(1 −ei)
 = ∥a∗a + J∥.
⊓⊔
The ﬁrst part of the next theorem is a simple generalization of Proposition 4.9 from
▷Sect. 4.2.
Theorem A.12
Let A and B be unital C∗-algebras and let
 : A −→B
be a unital ∗-homomorphism. Then  is a contraction and (A) is a unital C∗-
subalgebra4of B. If  is injective then it is isometric.
Proof
Clearly for any a ∈A the spectrum of the element (a) in B is contained in the spectrum
of a in the algebra A. Now if a is self-adjoint then ∥a∥is equal to |σ(a)| and
(a)
 equals
σ

(a)
	. Therefore
(a)
 ≤∥a∥. Now for an arbitrary b ∈A, putting a = b∗b, we
obtain
(b)∥2 =
(b∗b)
 =
(a)
 ≤∥a∥= ∥b∗b∥= ∥b∥2
and consequently  is a contraction.
Assume now that  is injective. In light of the reasoning above, to see that  is an
isometry, it is enough to prove that it preserves norms of self-adjoint elements. This, in turn,
will follow once we establish that for a = a∗we have σ

(a)
	
= σ(a). We already know
that σ

(a)
	
⊂σ(a), so suppose that σ

(a)
	
⫋σ(a). Then there exists a continuous
function f on σ(a) such that f ̸= 0, but f = 0 on σ

(a)
	
. We have
f

(a)
	
= 

f (a)
	
,
4Closed ∗-subalgebra.

APPENDIX A
191
because this holds for polynomials and  is continuous. However, since f = 0 on σ

(a)
	
we ﬁnd that f (a) ∈ker  = {0}. In other words f (a) = 0 which in view of Theorem 4.23
means that f = 0. The resulting contradiction shows that σ

(a)
	
= σ(a).
Coming back to the case of possibly non-injective  we will prove that the range of  is
closed. Indeed: we can express  as the composition of the quotient map A →A/ ker  and
the canonical isomorphism  of A/ ker  onto (A) ⊂B. The map  is an injective unital
∗-homomorphism from the C∗-algebra A/ ker  to the C∗-algebra B, so it is isometric and
the range of an isometry is closed.
⊓⊔
ⓘRemark A.13 An important consequence of the fact that injective ∗-homomorphisms
are isometric is the uniqueness of the norm on a C∗-algebra (formally speaking we only
proved this for unital algebras). This follows by noting that the identity map must then
be isometric for any two C∗-norms on a given C∗-algebra.
Let us consider now a special case, where the arbitrary unital C∗-algebra A is
replaced by the algebra C(X) of continuous functions on a compact topological space
X. Let J be a closed ideal in C(X). Furthermore let
Y =

x ∈X f (x) = 0 for all f ∈J

.
Then Y is a closed subset of X, since
Y =
:
f ∈J
f −1(0).
Note that the set XKY is in a natural way a locally compact topological space.
Indeed: any compact space is a Tikhonov space, so for any x0 ∈XKY there exists a
continuous function f on X such that f

Y = 0 and f (x0) = 1. Then for any compact
neighborhood N of x0 in X the set
x ∈X f (x) ≥1
2
 ∩N
is a compact neighborhood of x0 in XKY.
Denote by C0(XKY) the algebra whose elements are all continuous functions on
X vanishing on the subset Y. With norm inherited from C(X) the algebra C0(XKY)
becomes a C∗-algebra (without unit). Moreover, it is easy to see that C0(XKY) is
naturally isomorphic to the algebra of continuous functions on the topological space
XKY which vanish at inﬁnity, i.e. such f that for any δ > 0 the set

x ∈XKY |f (x)| ≥
δ

is compact in XKY.
Clearly J ⊂C0(XKY). Furthermore
▬for any x ∈XKY there exists f ∈J such that f (x) ̸= 0,
▬for any x1, x2 ∈XKY there exists f ∈J such that f (x1) ̸= f (x2) (indeed: there
exists 
f ∈J such that 
f (x1) ̸= 0 and there is g ∈C(X) such that g(x1) = 1,
g(x2) = 0; it follows that f = 
f g satisﬁes f ∈J and f (x1) = g(x1) ̸= 0 = f (x2)).

192
APPENDIX A
Therefore it follows from the Stone-Weierstrass theorem for locally compact spaces that
J = C0(XKY).
Theorem A.14
Denote J = C0(XKY). Then the map
C(X)/J ∋f + J 	−→f

Y ∈C(Y)
is an isometric ∗-isomorphism C(X)/C0(XKY) onto C(Y).
Proof
The map C(X)/J ∋f + J 	→f

Y is a unital ∗-homomorphism which is one-to-one (by
deﬁnition) and surjective (by Tietze’s theorem). Isomorphisms of C∗-algebras are isometric.
⊓⊔

193
Index of Notation
H
Hilbert space
H1
closed unit ball in H
H ⊕K
direct sum of Hilbert spaces
H ⊕{0}
space of horizontal vectors
{0} ⊕H
space of vertical vectors
H ⊗alg K
algebraic tensor product
H ⊗K
tensor product of Hilbert spaces
span S
linear hull of a set S
spanS
closed linear hull of a set S
⟨· ·⟩
scalar product
⟨· ·⟩Tr
scalar product on the space of Hilbert-Schmidt operators
⟨ψ
“bra” operator deﬁned by vector ψ
ψ⟩
“ket” operator deﬁned by vector ψ
Tr
trace
B(H)
space of bounded operators on H
B(H,K)
space of bounded operators H →K
B(H)+
set of positive operators
Proj B(H)	
projections acting on a Hilbert space H
B0(H)
space of compact operators on H
B1(H)
space of trace class operators on H
B2(H)
space of Hilbert-Schmidt operators on H
F(H)
set of ﬁnite dimensional operators on H
1
identity operator, unit of a C∗-algebra
C(X)
space of continuous functions on X
C0(XKY)
space of continuous functions on XKY vanishing at inﬁnity
Cb(X)
space of bounded continuous functions on X
Cc(X)
space of continuous functions on X with compact support
C∞
c (R)
space of smooth functions on R with compact support
∥· ∥∞
uniform norm
B(X)
space of bounded Borel functions on X
C[·]
space of polynomials with complex coefﬁcients
X1 (Xr)
closed unit ball of radius 1 (radius r) in a Banach space X
∥· ∥X/S
quotient norm
H (D)
space of functions holomorphic on a neighborhood of a set D

integral over a closed oriented curve
L2(, μ)
space of square-integrable functions on 
L∞(, μ)
space of essentially bounded functions on 
∥· ∥2
norm in L2 space, Hilbert-Schmidt norm
∥· ∥1
trace norm
© Springer Nature Switzerland AG 2018
P. Sołtan, A Primer on Hilbert Space Operators, Compact Textbooks in Mathematics,
https://doi.org/10.1007/978-3-319-92061-0

194
Index of Notation
Mf
operator of multiplication by f
Vess(f )
essential range of f
f ˙= g
equality almost everywhere
f ˙≤g
inequality almost everywhere
χ
characteristic function of 
∁
complement of 
μ ⊗ν
tensor product of measures (product measure)
C∗(x)
C∗-algebra generated by x
C∗(x,1)
C∗-algebra generated by x and 1
σ(x)
spectrum of x
|σ(x)|
spectral radius of x
ρ(x)
resolvent set of x
σ(x1, . . . , xn) joint spectrum of x1, . . . , xn
l(x)
left support of x
r(x)
right support of x
s(x)
support of x
Re x, Im x
real and imaginary parts of x
|x|
modulus of x
x
1
2
square root of x
x+, x−
positive and negative parts of x

σ(x)
λ dEx(λ)
expression of x as a spectral integral
xf
integral of f with respect to a spectral measure
⟨ξ Eξ⟩
positive measure associated to spectral measure E
⟨ξ Eη⟩
complex measure associated to spectral measure E
D(T )
domain of T
G(T )
graph of T
T
closure of T
∥· ∥T
graph norm
T ∗
adjoint operator
ζ
the function t 	→
t
√
1+t2
zT
z-transform of T
T ⊂S
containment of operators
˚v
isometric operator deﬁned by partial isometry v
˚
cT
Cayley transform of T
D±
deﬁciency subspaces
n±
deﬁciency indices

195
References
[AkGl] N.I. Akhiezer, I.M. Glazman, Theory of Linear Operators in Hilbert Space (Dover
Publications, Mineola, 1993)
[Arv1] W. Arveson, An Invitation to C∗-Algebras (Springer, New York, 1976)
[Arv2] W. Arveson, A Short Course of Spectral Theory (Springer, New York, 2002)
[Eng] R. Engelking, General Topology (Heldermann Verlag, Berlin, 1989)
[Hal] P. Halmos, A Hilbert Space Problem Book (Springer, New York, 1982)
[Kat] T. Kato, Perturbation Theory for Linear Operators (Springer, Berlin, 1980)
[Lan] E.C. Lance, Hilbert C∗-Modules. A Toolkit for Operator Algebraists (Cambridge University
Press, Cambridge, 1995)
[Mau] K. Maurin, Methods of Hilbert Spaces (Polish Scientiﬁc Publishers, Warsaw, 1972)
[Ped] G.K. Pedersen, Analysis Now (Springer, New York, 1995)
[ReSi1] M. Reed, B. Simon, Methods of Modern Mathematical Physics I. Functional Analysis
(Academic Press, London, 1980)
[ReSi2] M. Reed, B. Simon, Methods of Modern Mathematical Physics II. Fourier Analysis,
Self-Adjointness (Academic Press, London, 1980)
[Rud1] W. Rudin, Real and Complex Analysis (McGraw-Hill, New York, 1987)
[Rud2] W. Rudin, Functional Analysis (McGraw-Hill, New York, 1991)
[WoNa] S.L. Woronowicz, K. Napiórkowski, Operator theory in the C∗-algebra framework.
Rep. Math. Phys. 31, 353–371 (1991)
[Zel] W. ˙Zelazko, Banach Algebras (Polish Scientiﬁc Publishers, Warsaw, 1973)
© Springer Nature Switzerland AG 2018
P. Sołtan, A Primer on Hilbert Space Operators, Compact Textbooks in Mathematics,
https://doi.org/10.1007/978-3-319-92061-0

197
Index
absolute value of an operator, 28, 126
adjoint of an unbounded operator, 105
anti-linear operator, 153
anti-unitary operator, 154
approximate unit, 188
Banach
algebra, 3, 81
∗-algebra, 4
Banach-Steinhaus theorem, 175
Borel functional calculus, 41, 95, 135, 142
C∗-algebra, 4
canonical form of a compact operator, 66
Cayley transform, 148
closable operator, 103
closed
graph theorem, 183
operator, 102
closure of an operator, 103, 106
compact operator, 59
containment of operators, 103, 145
continuous functional calculus, 15, 56, 91, 93, 95,
129
core for an operator, 113
cyclic vector, 39
deﬁciency
index, 147
subspace, 147
domain of an operator, 101
Dynkin’s theorem, 42, 137, 177
eigenspaces of a compact operator, 61
eigenvalues of a compact operator, 65
ε-net, 60
essentially self-adjoint operator, 153
essential range, 35
expectation value, 22, 156
extended spectrum, 111
extension
Friedrichs, 162
Krein, 162
of an operator, 103
self-adjoint, 147, 151
symmetric, 107
ﬁnal
projection, 26
subspace, 26
ﬁnite dimensional operator, 59
formula
Lie-Trotter, 51
polarization, ix
resolvent, 5, 48, 89
Trotter, 170
Fredholm alternative, 62, 64
Friedrichs extension, 162
Fuglede’s theorem, 53
functional calculus
Borel
for normal operators, 95
for self-adjoint operators, 41, 135, 142
continuous
for elements of a C∗-algebra, 56
for families of operators, 91, 93
for normal operators, 95
for self-adjoint operators, 15, 129
holomorphic, 47
for elements of a C∗-algebra, 56
for families of operators, 87
function vanishing at inﬁnity, 191
Gelfand-Naimark theorem, 96
generator of a one-parameter group, 170
graph
of adjoint operator, 105
norm, 104
of an operator, 102, 183
group
one-parameter, 165
generator of, 170
U(n), 153
Hilbert-Schmidt
norm, 78
© Springer Nature Switzerland AG 2018
P. Sołtan, A Primer on Hilbert Space Operators, Compact Textbooks in Mathematics,
https://doi.org/10.1007/978-3-319-92061-0

198
Index
operator, 72
on L2, 84
theorem, 65
holomorphic functional calculus, 47, 56, 87
∗-homomorphism, 40
horizontal vector, 103
ideal, 59, 186
left, 73, 186
right, 73, 186
two-sided, 186
imaginary part of an operator, 93
inﬁnitesimal generator, 170
initial
projection, 26
subspace, 26
integral
kernel, 85
operator, 85
invertible
element of a C∗-algebra, 11
operator, 4
unbounded operator, 110
involution, 3, 154
isometry, 27
partial, 26
∗-isomorphism, 15
joint spectrum, 93
Krein extension, 162
λ-system, 177
left ideal, 73, 186
left support of an operator, 25
Lie-Trotter formula, 51
measure
push-forward of, 143
semiﬁnite, 34
spectral, 43, 137
of a normal operator, 96
of a self-adjoint operator, 43, 46
total variation of, 43
variation of, 137
modulus of an operator, 28, 126
multiplication operator, 34, 104
norm, 36
spectrum of, 35, 134
norm
graph, 104
Hilbert-Schmidt, 78
of a multiplication operator, 36
quotient, 184
trace, 82
normal
element of a C∗-algebra, 55
operator, 13
one-parameter group, 165
generator of, 170
open mapping theorem, 181
operator
anti-linear, 153
anti-unitary, 154
bounded
absolute value of, 28
left support of, 25
modulus of, 28
phase of, 28
polar decomposition of, 28
resolvent of, 5
right support of, 25
self-adjoint, 13
spectral radius of, 10
spectrum of, 4
closable, 103
closed, 102
closure of, 103, 106
compact, 59
canonical form of, 66
diagonalization, 65
eigenspaces of, 61
eigenvalues of, 65
spectrum of, 64
densely deﬁned, 102
domain of, 101
essentially self-adjoint, 153
extension of, 103
ﬁnite dimensional, 59
graph of, 102
Hilbert-Schmidt, 72
on L2, 84
integral, 85
invertible, 4
of multiplication, 34, 104
norm, 36
spectrum of, 35

Index
199
normal, 13
spectral measure of, 96
positive, 19, 21, 123
square root of, 20
self-adjoint, 13, 105
negative part, 21
positive part, 21
real and imaginary parts, 93
spectral measure of, 43, 46, 142
support of, 25
similar, 54
symmetric, 105, 147
Cayley transform of, 148
deﬁciency indices of, 147
deﬁciency subspaces of, 147
self-adjoint extension of, 147, 151
trace class, 72
unbounded, 101
absolute value of, 126
adjoint of, 105
core for, 113
invertible, 110
modulus of, 126
phase of, 126
polar decomposition of, 126
positive, 123
resolvent set of, 110
self-adjoint, 105
spectrum of, 110
z-transform of, 117
unitary, 13
unitarily equivalent, 39
partial isometry, 26
partial order
on B(H), 22
on positive self-adjoint operators, 158
phase
of a bounded operator, 28
of an unbounded operator, 126
π-system, 177
polar decomposition
of a bounded operator, 28
of an unbounded operator, 126
polarization formula, ix
positive
element of a C∗-algebra, 57
operator, 19, 21, 123
projection, 24
initial, ﬁnal, 26
ψ⟩, ix
⟨ψ , ix
push-forward of measure, 143
Putnam’s theorem, 54
quotient
Banach space, 184, 185
C∗-algebra, 189
norm, 184
real part of an operator, 93
resolvent
identity, formula, 5, 48, 89
set
of a bounded operator, 4
of an unbounded operator, 110
Riesz-Schauder theorem, 64
right ideal, 73, 186
right support of an operator, 25
scalar product, ix
self-adjoint
element of a C∗-algebra, 55
operator, 13, 105
self-adjoint extension, 147, 151
semiﬁnite measure space, 34
singular value, 67
spectral
mapping theorem, 17, 91, 95
measure, 43, 137
of a normal operator, 96
of a self-adjoint operator, 43, 46, 142
radius, 10
spectrum
of a bounded operator, 4
of a compact operator, 64
of an element of a C∗-algebra, 11
extended, 111
joint, 93
of multiplication operator, 35, 134
square root of a positive operator, 20
Stone’s theorem, 167
strong topology, 29
subspace
initial, ﬁnal, 26
support of a self-adjoint operator, 25
symmetric operator, 105, 147
deﬁciency
indices of, 147
subspaces of, 147

200
Index
tensor product
algebraic, 178
of Hilbert spaces, 180
theorem
Banach-Steinhaus, 175
closed graph, 183
Dynkin’s, 42, 137, 177
Fuglede’s, 53
Gelfand-Naimark, 96
Hilbert-Schmidt, 65
open mapping, 181
Putnam’s, 54
Riesz-Schauder, 64
spectral mapping, 17, 91, 95
Stone’s, 167
total variation of a measure, 43
trace, 69
class operator, 72
norm, 82
of a positive operator, 71
of a trace class operator, 76
Trotter formula, 170
two-sided ideal, 186
unit
approximate, 188
of a C∗-algebra, 3
unital homomorphism, 40
unitary
element of a C∗-algebra, 55
equivalence, 39
operator, 13
value
expectation, 22, 156
singular, 67
variation
of a measure, 137
total, 43
vector
cyclic, 39
horizontal, 103
vertical, 102
vertical vector, 102
z-transform, 117

